<div class="container">

<table style="width: 100%;"><tr>
<td>get_Muller_df</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a data frame from which to create a Muller plot</h2>

<h3>Description</h3>

<p>Create a data frame from which to create a Muller plot
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_Muller_df(
  edges,
  pop_df,
  cutoff = 0,
  start_positions = 0.5,
  threshold = NA,
  add_zeroes = NA,
  smooth_start_points = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>edges</code></td>
<td>
<p>Dataframe comprising an adjacency matrix, or tree of class "phylo"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_df</code></td>
<td>
<p>Dataframe with column names "Identity", "Population", and either "Generation" or "Time"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Numeric cutoff; genotypes that never become more abundant than this value are omitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_positions</code></td>
<td>
<p>Numeric value between 0 and 1 that determines the times at which genotypes are assumed to have arisen (see examples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Depcrecated (use cutoff instead, but note that "threshold" omitted genotypes that never become more abundant than *twice* its value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_zeroes</code></td>
<td>
<p>Deprecated (now always TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth_start_points</code></td>
<td>
<p>Deprecated (now always TRUE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dataframe that can be used as input in Muller_plot and Muller_pop_plot.
</p>


<h3>Author(s)</h3>

<p>Rob Noble, <a href="mailto:robjohnnoble@gmail.com">robjohnnoble@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>Muller_plot</code> <code>Muller_pop_plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># by default, all genotypes are included, 
# but one can choose to omit genotypes with max frequency &lt; cutoff:
Muller_df &lt;- get_Muller_df(example_edges, example_pop_df, cutoff = 0.01)

# the genotype names can be arbitrary character strings instead of numbers:
example_edges_char &lt;- example_edges
example_edges_char$Identity &lt;- paste0("foo", example_edges_char$Identity, "bar")
example_edges_char$Parent &lt;- paste0("foo", example_edges_char$Parent, "bar")
example_pop_df_char &lt;- example_pop_df
example_pop_df_char$Identity &lt;- paste0("foo", example_pop_df_char$Identity, "bar")
Muller_df &lt;- get_Muller_df(example_edges_char, example_pop_df_char, cutoff = 0.01)

# the genotype names can also be factors (which is the default for strings in imported data):
example_edges_char$Identity &lt;- as.factor(example_edges_char$Identity)
example_edges_char$Parent &lt;- as.factor(example_edges_char$Parent)
example_pop_df_char$Identity &lt;- as.factor(example_pop_df_char$Identity)
Muller_df &lt;- get_Muller_df(example_edges_char, example_pop_df_char, cutoff = 0.01)

# to see the effect of changing start_positions, compare these two plots:
edges1 &lt;- data.frame(Parent = c(1,2,1), Identity = 2:4)
pop1 &lt;- data.frame(Time = rep(1:4, each = 4), 
                    Identity = rep(1:4, times = 4),
                    Population = c(1, 0, 0, 0, 
                                   2, 2, 0, 0, 
                                   4, 8, 4, 0, 
                                   8, 32, 32, 16))
df0 &lt;- get_Muller_df(edges1, pop1, start_positions = 0)
df1 &lt;- get_Muller_df(edges1, pop1, start_positions = 1)
Muller_plot(df0)
Muller_plot(df1)

</code></pre>


</div>