<div class="container">

<table style="width: 100%;"><tr>
<td>Hyperbolic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hyperbolic Distribution</h2>

<h3>Description</h3>

<p>Density function, distribution function, quantiles and
random number generation for the hyperbolic distribution
with parameter vector <code>param</code>. Utility routines are included for
the derivative of the density function and to find suitable break
points for use in determining the distribution function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dhyperb(x, mu = 0, delta = 1, alpha = 1, beta = 0,
        param = c(mu, delta, alpha, beta))
phyperb(q, mu = 0, delta = 1, alpha = 1, beta = 0,
        param = c(mu, delta, alpha, beta),
        lower.tail = TRUE, subdivisions = 100,
        intTol = .Machine$double.eps^0.25,
        valueOnly = TRUE, ...)
qhyperb(p, mu = 0, delta = 1, alpha = 1, beta = 0,
        param = c(mu, delta, alpha, beta),
        lower.tail = TRUE, method = c("spline", "integrate"),
        nInterpol = 501, uniTol = .Machine$double.eps^0.25,
        subdivisions = 100, intTol = uniTol, ...)
rhyperb(n, mu = 0, delta = 1, alpha = 1, beta = 0,
        param = c(mu, delta, alpha, beta))
ddhyperb(x, mu = 0, delta = 1, alpha = 1, beta = 0,
         param = c(mu, delta, alpha, beta))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>Vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p><code class="reqn">\mu</code> is the location parameter. By default this is
set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p><code class="reqn">\delta</code> is the scale parameter of the distribution.
A default value of 1 has been set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p><code class="reqn">\alpha</code> is the tail parameter, with a default
value of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p><code class="reqn">\beta</code> is the skewness parameter, by default
this is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Parameter vector taking the form
<code>c(mu, delta, alpha, beta)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character. If <code>"spline"</code> quantiles are found from a
spline approximation to the distribution function. If
<code>"integrate"</code>, the distribution function used is always obtained
by integration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>Logical. If <code>lower.tail = TRUE</code>, the cumulative
density is taken from the lower tail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdivisions</code></td>
<td>
<p>The maximum number of subdivisions used to
integrate the density and determine the accuracy of the distribution
function calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intTol</code></td>
<td>
<p>Value of <code>rel.tol</code> and hence <code>abs.tol</code> in
calls to <code>integrate</code>. See <code>integrate</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valueOnly</code></td>
<td>
<p>Logical. If <code>valueOnly = TRUE</code> calls to
<code>pghyp</code> only return the value obtained for the integral.
If <code>valueOnly = FALSE</code> an estimate of the
accuracy of the numerical integration is also returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nInterpol</code></td>
<td>
<p>Number of points used in <code>qghyp</code> for cubic
spline interpolation of the distribution function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniTol</code></td>
<td>
<p>Value of <code>tol</code> in
calls to <code>uniroot</code>. See <code>uniroot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passes arguments to <code>uniroot</code>. See <b>Details</b>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The hyperbolic distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{1}{2\delta\sqrt{1+\pi^2}K_1(\zeta)} %
    e^{-\zeta[\sqrt{1+\pi^2}\sqrt{1+(\frac{x-\mu}{\delta})^2}-%
    \pi\frac{x-\mu}{\delta}]}</code>
</p>

<p>where <code class="reqn">K_1()</code> is the modified Bessel function of the
third kind with order 1.
</p>
<p>A succinct description of the hyperbolic distribution is given in
Barndorff-Nielsen and Blæsild (1983). Three different
possible parameterizations are described in that paper. A fourth
parameterization is given in Prause (1999). All use location and scale
parameters <code class="reqn">\mu</code> and <code class="reqn">\delta</code>. There are two other
parameters in each case.
</p>
<p>Use <code>hyperbChangePars</code> to convert from the
<code class="reqn">(\pi, \zeta)</code> <code class="reqn">(\phi, \gamma)</code> or
<code class="reqn">(\xi, \chi)</code> parameterizations to the
<code class="reqn">(\alpha, \beta)</code> parameterization used above.
</p>
<p>Each of the functions are wrapper functions for their equivalent
generalized hyperbolic counterpart. For example, <code>dhyperb</code> calls
<code>dghyp</code>. See <code>dghyp</code>.
</p>
<p>The hyperbolic distribution is a special case of the generalized
hyperbolic distribution (Barndorff-Nielsen and Bæsild
(1983)). The generalized hyperbolic distribution can be represented as
a particular mixture of the normal distribution where the mixing
distribution is the generalized inverse Gaussian.  <code>rhyperb</code> uses
this representation to generate observations from the hyperbolic
distribution. Generalized inverse Gaussian observations are obtained
via the algorithm of Dagpunar (1989).</p>


<h3>Value</h3>

<p><code>dhyperb</code> gives the density, <code>phyperb</code> gives the distribution
function, <code>qhyperb</code> gives the quantile function and <code>rhyperb</code>
generates random variates. An estimate of the accuracy of the
approximation to the distribution function may be found by setting
<code>accuracy = TRUE</code> in the call to <code>phyperb</code> which then returns
a list with components <code>value</code> and <code>error</code>.
</p>
<p><code>ddhyperb</code> gives the derivative of <code>dhyperb</code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Ai-Wei Lee, Jennifer Tso, Richard Trendall</p>


<h3>References</h3>

<p>Barndorff-Nielsen, O. and Blæsild, P (1983).
Hyperbolic distributions.
In <em>Encyclopedia of Statistical Sciences</em>,
eds., Johnson, N. L., Kotz, S. and Read, C. B., Vol. 3,
pp. 700–707. New York: Wiley.
</p>
<p>Dagpunar, J.S. (1989).
An easily implemented generalized inverse Gaussian generator
<em>Commun. Statist. -Simula.</em>,
<b>18</b>, 703–710.
</p>
<p>Prause, K. (1999) <em>The generalized hyperbolic models: Estimation,
financial derivatives and risk measurement.</em> PhD Thesis, Mathematics
Faculty, University of Freiburg.
</p>


<h3>See Also</h3>

<p><code>safeIntegrate</code>,
<code>integrate</code> for its shortfalls, <code>splinefun</code>,
<code>uniroot</code> and <code>hyperbChangePars</code> for changing
parameters to the <code class="reqn">(\alpha,\beta)</code>
parameterization, <code>dghyp</code> for the generalized hyperbolic
distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R">param &lt;- c(0, 2, 1, 0)
hyperbRange &lt;- hyperbCalcRange(param = param, tol = 10^(-3))
par(mfrow = c(1, 2))
curve(dhyperb(x, param = param), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Density of the\n Hyperbolic Distribution")
curve(phyperb(x, param = param), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Distribution Function of the\n Hyperbolic Distribution")
dataVector &lt;- rhyperb(500, param = param)
curve(dhyperb(x, param = param), range(dataVector)[1], range(dataVector)[2],
      n = 500)
hist(dataVector, freq = FALSE, add =TRUE)
title("Density and Histogram\n of the Hyperbolic Distribution")
DistributionUtils::logHist(dataVector, main =
        "Log-Density and Log-Histogram\n of the Hyperbolic Distribution")
curve(log(dhyperb(x, param = param)), add = TRUE,
      range(dataVector)[1], range(dataVector)[2], n = 500)
par(mfrow = c(2, 1))
curve(dhyperb(x, param = param), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Density of the\n Hyperbolic Distribution")
curve(ddhyperb(x, param = param), from = hyperbRange[1], to = hyperbRange[2],
      n = 1000)
title("Derivative of the Density\n of the Hyperbolic Distribution")
</code></pre>


</div>