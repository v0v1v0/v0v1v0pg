<div class="container">

<table style="width: 100%;"><tr>
<td>GMPR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Geometric Mean of Pairwise Ratios (GMPR) Normalization for Zero-inflated Count Data
</h2>

<h3>Description</h3>

<p>A robust normalization method for zero-inflated count data such as microbiome sequencing data. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">GMPR(OTUmatrix, min_ct = 2, intersect_no = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>OTUmatrix</code></td>
<td>

<p>An OTU count table, where OTUs are arranged in rows and samples in columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_ct</code></td>
<td>

<p>The minimal number of OTU counts. Only those OTU pairs with at least <code>min_ct</code> counts are 
considered in the ratio calculation.   The default is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intersect_no</code></td>
<td>

<p>The minimal number of shared OTUs between samples. Only those sample pairs sharing at least <code>intersect_no</code> OTUs 
are considered in geometric mean calculation. The default is 4.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Normalization is a critical step in microbiome sequencing data analysis to account for variable library sizes.
Microbiome data contains a vast number of zeros, which makes the traditional RNA-Seq normalization methods unstable. 
The proposed  GMPR normalization remedies this problem by switching the two steps in DESeq2 normalization:
</p>
<p>First, to calculate rij, the median count ratio of nonzero counts between samples:
rij=median(cki/ckj) (k in 1:OTU_number and cki, ckj is the non-zero count of the kth OTU)
</p>
<p>Second, to calculate the size factor si for a given sample i:
si=geometric_mean(rij)
</p>


<h3>Value</h3>

<p>A vector of GMPR size factor for each sample.
</p>


<h3>Author(s)</h3>

<p>Jun Chen and Lujun Zhang
</p>


<h3>References</h3>

<p>Li Chen, James Reeve, Lujun Zhang, Shenbing Huang, and Jun Chen. 2018. GMPR: A robust normalization method for zero-inflated count
data with application to microbiome sequencing data. PeerJ, 6, e4600.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(throat.otu.tab)
size.factor &lt;- GMPR(t(throat.otu.tab))
</code></pre>


</div>