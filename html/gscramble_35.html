<div class="container">

<table style="width: 100%;"><tr>
<td>segments2markers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Map alleles from scrambled founders to the sampled segments from a GSP.</h2>

<h3>Description</h3>

<p>Map alleles from scrambled founders to the sampled segments from a GSP.
</p>


<h3>Usage</h3>

<pre><code class="language-R">segments2markers(
  Segs,
  Im,
  Mm,
  G,
  preserve_haplotypes = FALSE,
  preserve_individuals = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Segs</code></td>
<td>
<p>the simulated segments. A tibble like that returned from
<code>segregate()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Im</code></td>
<td>
<p>the individual meta data, like that in <code>I_meta</code>. A tibble with
columns <code>group</code> and <code>indiv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mm</code></td>
<td>
<p>the marker meta data formatted like that in <code>M_meta</code>. A tibble
with columns <code>chrom</code>, <code>pos</code>, and <code>variant_id</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>the marker genotype data as a matrix like <code>Geno</code>.  This is
a character matrix.  Each row is an individual, and each pair of columns are the
alleles at a locus.  Thus it is N x 2L where N is the number of individuals
and L is the number of markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preserve_haplotypes</code></td>
<td>
<p>If TRUE then the Geno data is assumed phased
(first allele at an individual on one haplotype and second allele on the
other) and those haplotypes are preserved in this permutation of
genomic material amongst the founders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preserve_individuals</code></td>
<td>
<p>If TRUE then whole individuals are permuted
around the data set and the two gene copies at each locus are randomly
permuted within each individual.  If <code>preserve_individuals = "BY_CHROM"</code>,
then the the two copies of each chromosome in an individual are permuted
together.  Thus a permuted individual may have two copies of one chromosome
from one individual, and two copies of another chromosome from a different
individual.  (If <code>preserve_haplotypes = TRUE</code> then
the gene copies are not permuted within individuals. You should only ever
use <code>preserve_haplotypes = TRUE</code> if you have phased data.)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with three components:
</p>

<ul>
<li> <p><code>ret_geno</code>: A character matrix where each row is an individual and each pair of
columns are the alleles at a locus, thus it is N x 2L where N is the number of
individuals and L is the number of markers.
</p>
</li>
<li> <p><code>ret_ids</code>: A tibble providing the individual meta data with columns <code>groups</code> and <code>indiv</code>.
</p>
</li>
<li> <p><code>hyb_Qs</code>: A tibble of the admixture Q values.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">#### First, get input segments for the function ####
# We construct an example here where we will request segregation
# down a GSP with two F1s and F1B backcrosses between two hypothetical
# populations, A and B.
set.seed(5)
gsp_f1f1b &lt;- create_GSP("A", "B", F1 = TRUE, F1B = TRUE)

# We will imagine that in our marker data there are three groups
# labelled "Pop1", "Pop2", and "Pop3", and we want to create the F1Bs with backcrossing
# only to Pop3.
reppop &lt;- tibble::tibble(
    index = as.integer(c(1, 1, 2, 2)),
    pop = c("A", "B", "A", "B"),
    group = c("Pop3", "Pop1", "Pop3", "Pop2")
)

# combine those into a request
request &lt;- tibble::tibble(
   gpp = list(gsp_f1f1b),
   reppop = list(reppop)
)

# now segegate segments.  Explicitly pass the markers
# in M_meta so that the order of the markers is set efficiently.
segs &lt;- segregate(request, RecRates, M_meta)

#### Now, use segs in an example with segments2markers() ####
# this uses several package data objects that are there for examples
# and illustration.
s2m_result &lt;- segments2markers(segs, I_meta, M_meta, Geno)
</code></pre>


</div>