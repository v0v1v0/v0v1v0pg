<div class="container">

<table style="width: 100%;"><tr>
<td>stepCriterion.lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable Selection in Normal Linear Models</h2>

<h3>Description</h3>

<p>Performs variable selection in normal linear models using a hybrid versions of forward stepwise and backward stepwise.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lm'
stepCriterion(
  model,
  criterion = c("bic", "aic", "adjr2", "prdr2", "cp", "p-value"),
  direction = c("forward", "backward"),
  levels = c(0.05, 0.05),
  trace = TRUE,
  scope,
  force.in,
  force.out,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of the class <em>lm</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>an (optional) character string indicating the criterion which should be used to compare the candidate models. The available options are: AIC ("aic"), BIC ("bic"), adjusted R-squared ("adjr2"), predicted R-squared ("prdr2"), Mallows' CP ("cp") and <em>p</em>-value of the F test ("p-value"). As default, <code>criterion</code> is set to "bic".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>an (optional) character string indicating the type of procedure which should be used. The available options are: hybrid backward stepwise ("backward") and hybrid forward stepwise ("forward"). As default, <code>direction</code> is set to "forward".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>an (optional) two-dimensional vector of values in the interval <code class="reqn">(0,1)</code> indicating the levels at which the variables should in and out from the model. This is only appropiate if <code>criterion</code>="p-value". As default, <code>levels</code> is set to <code>c(0.05,0.05)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>an (optional) logical switch indicating if should the stepwise reports be printed. As default, <code>trace</code> is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope</code></td>
<td>
<p>an (optional) list containing components <code>lower</code> and <code>upper</code>, both formula-type objects, indicating the range of models which should be examined in the stepwise search. As default, <code>lower</code> is a model with no predictors and <code>upper</code> is the linear predictor of the model in <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.in</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in all models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.out</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in no models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. For example, <code>k</code>, that is, the magnitude of the penalty in the AIC/QICu, which by default is set to 2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The "hybrid forward stepwise" algorithm starts with the
simplest model (which may be chosen at the argument <code>scope</code>, and
As default, is a model whose parameters in the linear predictor,
except the intercept, if any, are set to 0), and then the candidate
models are built by hierarchically including effects in the linear
predictor, whose "relevance" and/or "importance" in the model fit is
assessed by comparing nested models (that is, by comparing the models
with and without the added effect) using a criterion previously
specified. If an effect is added to the equation, this strategy may
also remove any effect which, according to the previously specified
criteria, no longer provides an improvement in the model fit. That
process continues until no more effects are included or excluded. The
"hybrid backward stepwise" algorithm works similarly.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
<td style="text-align: left;">
<code>initial</code> </td>
<td style="text-align: left;">  a character string indicating the linear predictor of the "initial model",</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>direction</code> </td>
<td style="text-align: left;">  a character string indicating the type of procedure which was used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>criterion</code> </td>
<td style="text-align: left;"> a character string indicating the criterion used to compare the candidate models,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>final</code> </td>
<td style="text-align: left;"> a character string indicating the linear predictor of the "final model",</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>final.fit</code> </td>
<td style="text-align: left;"> an object of class <code>lm</code> with the results of the fit to the data of the "final model",</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>James G., Witten D., Hastie T., Tibshirani R. (2013, page 210) An Introduction to Statistical Learning with Applications in R, Springer, New York.
</p>


<h3>See Also</h3>

<p>stepCriterion.glm, stepCriterion.overglm, stepCriterion.glmgee
</p>
<p>stepCriterion.glm, stepCriterion.overglm, stepCriterion.glmgee
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example 1: New York air quality measurements
fit1 &lt;- lm(log(Ozone) ~ Solar.R + Temp + Wind, data=airquality)
scope=list(lower=~1, upper=~Solar.R*Temp*Wind)
stepCriterion(fit1, direction="forward", criterion="adjr2", scope=scope)
stepCriterion(fit1, direction="forward", criterion="bic", scope=scope)
stepCriterion(fit1, direction="forward", criterion="p-value", scope=scope)

###### Example 2: Fuel consumption of automobiles
fit2 &lt;- lm(mpg ~ log(hp) + log(wt) + qsec, data=mtcars)
scope=list(lower=~1, upper=~log(hp)*log(wt)*qsec)
stepCriterion(fit2, direction="backward", criterion="bic", scope=scope)
stepCriterion(fit2, direction="forward", criterion="cp", scope=scope)
stepCriterion(fit2, direction="backward", criterion="prdr2", scope=scope)

###### Example 3: Credit card balance
Credit &lt;- ISLR::Credit
fit3 &lt;- lm(Balance ~ Cards + Age + Rating + Income + Student + Limit, data=Credit)
stepCriterion(fit3, direction="forward", criterion="prdr2")
stepCriterion(fit3, direction="forward", criterion="cp")
stepCriterion(fit3, direction="forward", criterion="p-value")

</code></pre>


</div>