<div class="container">

<table style="width: 100%;"><tr>
<td>nls_test_problem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieve an NLS test problem</h2>

<h3>Description</h3>

<p>Fetches the model definition and model data required to solve a single NLS test problem with <code>gsl_nls</code>
(or <code>nls</code> if the model is defined as a formula). Use <code>nls_test_list</code> to
list the names of the available NLS test problems.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nls_test_problem(name, p = NA, n = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Name of the NLS test problem, as returned in the <code>"name"</code> column of <code>nls_test_list</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of parameters in the NLS test problem constrained by the <code>check</code> condition returned by <code>nls_test_list</code>.
If <code>NA</code> (default), the default number of parameters as listed by <code>nls_test_list</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of residuals in the NLS test problem constrained by the <code>check</code> condition returned by <code>nls_test_list</code>.
If <code>NA</code> (default), the default number of residuals as listed by <code>nls_test_list</code> is used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If the model is defined as a formula, a list of class <code>"nls_test_formula"</code> with elements:
</p>

<ul>
<li> <p><code>data</code> a data.frame with <code>n</code> rows containing the data (predictor and response values) used in the regression problem.
</p>
</li>
<li> <p><code>fn</code> a formula defining the test problem model.
</p>
</li>
<li> <p><code>start</code> a named vector of length <code>p</code> with suggested starting values for the parameters.
</p>
</li>
<li> <p><code>target</code> a named vector of length <code>p</code> with the certified target values for the parameters corresponding to the
<em>best-available</em> solutions.
</p>
</li>
</ul>
<p>If the model is defined as a function, a list of class <code>"nls_test_function"</code> with elements:
</p>

<ul>
<li> <p><code>fn</code> a function defining the test problem model. <code>fn</code> takes a vector of parameters
of length <code>p</code> as its first argument and returns a numeric vector of length <code>n</code>.
<code>fn</code>
</p>
</li>
<li> <p><code>y</code> a numeric vector of length <code>n</code> containing the response values.
</p>
</li>
<li> <p><code>start</code> a numeric named vector of length <code>p</code> with suggested starting values for the parameters.
</p>
</li>
<li> <p><code>jac</code> a function defining the analytic Jacobian matrix of the model <code>fn</code>. <code>jac</code>
takes a vector of parameters of length <code>p</code> as its first argument and returns an <code>n</code> by <code>p</code> dimensional matrix.
</p>
</li>
<li> <p><code>target</code> a numeric named vector of length <code>p</code> with the certified target values for the parameters, or a vector of
<code>NA</code>'s if no target solution is available.
</p>
</li>
</ul>
<h3>Note</h3>

<p>For several problems the optimal least-squares objective of the target solution can be obtained at multiple different parameter locations.
</p>


<h3>References</h3>

<p>D.M. Bates and Watts, D.G. (1988). <em>Nonlinear Regression Analysis and Its Applications</em>, Wiley, ISBN: 0471816434.
</p>
<p>J.J. Mor√©, Garbow, B.S. and Hillstrom, K.E. (1981). <em>Testing unconstrained optimization software</em>, ACM Transactions on Mathematical Software, 7(1), 17-41.
</p>


<h3>See Also</h3>

<p><code>nls_test_list</code>
</p>
<p><a href="https://www.itl.nist.gov/div898/strd/nls/nls_main.shtml">https://www.itl.nist.gov/div898/strd/nls/nls_main.shtml</a>
</p>
<p><a href="https://people.math.sc.edu/Burkardt/f_src/test_nls/test_nls.html">https://people.math.sc.edu/Burkardt/f_src/test_nls/test_nls.html</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## example regression problem
ratkowsky2 &lt;- nls_test_problem(name = "Ratkowsky2")
with(ratkowsky2,
     gsl_nls(
       fn = fn,
       data = data,
       start = start
     )
)

## example optimization problem
rosenbrock &lt;- nls_test_problem(name = "Rosenbrock")
with(rosenbrock,
     gsl_nls(
       fn = fn,
       y = y,
       start = start,
       jac = jac
     )
)
</code></pre>


</div>