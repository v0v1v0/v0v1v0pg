<div class="container">

<table style="width: 100%;"><tr>
<td>groupedSurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute the Efficient Score Statistic for the Grouped Survival Model
</h2>

<h3>Description</h3>

<p>A method to compute the efficient score statistic for a grouped survival model. The function supports zero, single, or multiple covariates as dictated by the input data. The function can take either a <code>gwaa.data</code> object or a standard <code>data.frame</code> or <code>matrix</code> as input. If more than one variable of interest is provided, the efficient score will be computed for each one separately. For each variable tested, the function returns the unadjusted marginal asymptotic p-value, as well as the family-wise error rate (FWER, Bonferroni correction) adjusted p-value and local false-discovery rates (FDR, Storey's Q-values).
</p>


<h3>Usage</h3>

<pre><code class="language-R">  groupedSurv(x, Z=NULL, GenABEL.data=NULL, alpha, theta=NULL, 
    gtime, delta, beta=0, nCores=1, reScore=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector, <code>data.frame</code>, or <code>matrix</code> of numeric variables of interest for each sample. Alternatively, if a <code>gwaa.data</code> object is given for <code>GenABEL.data</code>, this argument may be a vector of strings corresponding to column names in <code>GenABEL.data@gtdata</code> to use as variables of interest, set <code>NULL</code> will use all the variables in <code>GenABEL.data@gtdata</code> as variables of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Optional <code>data.frame</code> or <code>matrix</code> of numeric covariate values for each sample. Alternatively, if a <code>gwaa.data</code> object is given for <code>GenABEL.data</code>, this argument may be a vector of strings corresponding to column names in <code>GenABEL.data@phdata</code> to use as covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GenABEL.data</code></td>
<td>
<p>Optional <code>gwaa.data</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Vector of baseline survival rates for each time interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Optional vector of estimated nuisance parameters for the covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gtime</code></td>
<td>
<p>Vector of observed survival times for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Vector of event indicators for each sample: 1 indicates observed event, 0 indicates censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Scalar for the parameter of interest. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCores</code></td>
<td>
<p>Integer representing the number of cores to be used for multi-threaded computation. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reScore</code></td>
<td>
<p>Boolean indicating whether to return the full efficient scores matrix. Default is <code>FALSE</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>reScore=FALSE</code>, the function returns a <code>data.frame</code> with one row for each variables of interest and four columns: <code>stat</code>, the efficient score statistic, <code>pvalue</code>, unadjusted p-value, <code>FWER</code>, the family-wise error rate adjusted p-value (Bonferroni correction), and <code>FDR</code>, the local false-discovery rate (Storey's Q-value). If <code>reScore=TRUE</code>, a <code>list</code> is returned. The first element is the <code>data.frame</code> of efficient score statistics and p-values, and the second is a matrix of contributions of each sample to the efficient score statistics of each variable of interest. Rows correspond to samples, and columns correspond to the variables of interest.
</p>


<h3>References</h3>

<p>Bonferroni, C.E. (1935). Il calcolo delle assicurazioni su gruppi di teste. Studi in Onore del Professore Salvatore Ortu Carbon, 13-60.<br>
Storey, J.D. (2003). The positive false discovery rate: a Bayesian interpretation and the q-value. Annals of Statistics, 31:6, 2013-2035.<br>
Storey, J.D., Taylor, J.E., and Siegmund, D. (2004). Strong control, conservative point estimation and simultaneous conservative consistency of false discovery rates: a unified approach. Journal of the Royal Statistical Society Series B-Statistical Methodology, 66, 187-205<br></p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate dummy data
set.seed(111)
n &lt;- 1000

# effect size
beta &lt;- 0.4

# covariate parameters
theta &lt;- c(0.2, 0.2)

# variable of interest associated with outcome
MAF &lt;- 0.05
x &lt;- matrix(rbinom(n, 2, MAF), ncol = 1)

# covariate data (centered at 0)
z1 &lt;- rnorm(n)
z2 &lt;- rbinom(n, 1, 0.5) - 0.5
Z  &lt;- matrix(cbind(z1, z2), ncol = 2)

# continuous survival time
lam0 &lt;- 1
cmax &lt;- 3
lami &lt;- lam0 * exp(x*beta + Z[,1]*theta[1]+Z[,2]*theta[2])
stime &lt;- rexp(n, lami)
ctime &lt;- runif(n, 0, cmax)
delta &lt;- stime &lt; ctime
otime &lt;- pmin(stime, ctime)

# additional variables of interest
xMore &lt;- matrix(rbinom(n*100, 2, MAF), ncol = 100)
xMore &lt;- cbind(x, xMore)

# number of observation times
ntps &lt;- 5

# number of intervals
r &lt;- ntps + 1

# last observation time
maxbreakq &lt;- 0.85
maxbreak &lt;- qexp(maxbreakq, lam0)

# grouped failure times
breaks &lt;- (1:ntps) * (maxbreak/ntps)
gtime &lt;- findInterval(otime, breaks) + 1
delta[gtime == r] &lt;- FALSE
dctime &lt;- findInterval(ctime, breaks) + 1
delta[gtime == dctime] &lt;- FALSE
delta &lt;- as.numeric(delta)
gtime[which(gtime == r)] &lt;- Inf

# estimate nuisance parameters
#thetaest &lt;- thetaEst(Z, gtime, delta)

# compute efficient score statistics
# eff &lt;- groupedSurv(x=xMore, Z=Z, alpha=thetaest$alpha, theta=thetaest$theta,
#		gtime=gtime, delta=delta, beta=0, nCores=1)
# head(eff)
</code></pre>


</div>