<div class="container">

<table style="width: 100%;"><tr>
<td>Families</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Families for GAMLSS models
</h2>

<h3>Description</h3>

<p>The package provides some pre-defined GAMLSS families, e.g.
<code>NBionomialLSS</code>. Objects of the class <code>families</code> provide a
convenient way to specify GAMLSS distributions to be fitted by one of
the boosting algorithms implemented in this package. By using the
function <code>Families</code>, a new object of the class <code>families</code>
can be generated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">############################################################
# Families for continuous response

# Gaussian distribution
GaussianLSS(mu = NULL, sigma = NULL,
            stabilization = c("none", "MAD", "L2"))

# Student's t-distribution
StudentTLSS(mu = NULL, sigma = NULL, df = NULL,
            stabilization = c("none", "MAD", "L2"))

############################################################
# Families for continuous non-negative response

# Gamma distribution
GammaLSS(mu = NULL, sigma = NULL,
         stabilization = c("none", "MAD", "L2"))

############################################################
# Families for fractions and bounded continuous response

# Beta distribution
BetaLSS(mu = NULL, phi = NULL,
        stabilization = c("none", "MAD", "L2"))

############################################################
# Families for count data

# Negative binomial distribution
NBinomialLSS(mu = NULL, sigma = NULL,
             stabilization = c("none", "MAD", "L2"))

# Zero-inflated Poisson distribution
ZIPoLSS(mu = NULL, sigma = NULL,
        stabilization = c("none", "MAD", "L2"))

# Zero-inflated negative binomial distribution
ZINBLSS(mu = NULL, sigma = NULL, nu = NULL,
        stabilization = c("none", "MAD", "L2"))

############################################################
# Families for survival models (accelerated failure time
# models) for data with right censoring

# Log-normal distribution
LogNormalLSS(mu = NULL, sigma = NULL,
             stabilization = c("none", "MAD", "L2"))

# Log-logistic distribution
LogLogLSS(mu = NULL, sigma = NULL,
          stabilization = c("none", "MAD", "L2"))

# Weibull distribution
WeibullLSS(mu = NULL, sigma = NULL,
           stabilization = c("none", "MAD", "L2"))

############################################################
# Constructor function for new GAMLSS distributions
Families(..., qfun = NULL, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> sub-families to be passed to constructor. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qfun</code></td>
<td>
<p> quantile function. This function can for example be used
to compute (marginal) prediction intervals. See
<code>predint</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p> name of the families. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> offset value for mu. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p> offset value for sigma. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p> offset value for phi. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p> offset value for df. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p> offset value for nu. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stabilization</code></td>
<td>
<p> governs if the negative gradient should be
standardized in each boosting step. It can be either "none", 
"MAD" or "L2". See also Details below.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The arguments of the families are the offsets for each distribution
parameter. Offsets can be either scalar, a vector with length equal to
the number of observations or <code>NULL</code> (default). In the latter
case, a scalar offset for this component is computed by minimizing the
risk function w.r.t. the corresponding distribution parameter (keeping
the other parameters fixed).
</p>
<p>Note that <code>gamboostLSS</code> is not restricted to three components but
can handle an arbitrary number of components (which, of course,
depends on the GAMLSS distribution). However, it is important that the
names (for the offsets, in the sub-families etc.) are chosen
<em>consistently</em>.
</p>
<p>The <code>ZIPoLSS</code> families can be used to fit zero-inflated Poisson
models. Here, <code>mu</code> and <code>sigma</code> refer to the location
parameter of the Poisson component (with log link) and the mean of the
zero-generating process (with logit link), respectively.
</p>
<p>Similarly, <code>ZINBLSS</code> can be used to fit zero-inflated negative
binomial models. Here, <code>mu</code> and <code>sigma</code> refer to the
location and scale parameters (with log link) of the negative binomial
component of the model. The zero-generating process (with logit link)
is represented by <code>nu</code>.
</p>
<p>The <code>Families</code> function can be used to implements a new GAMLSS
distribution which can be used for fitting by <code>mboostLSS</code>.
Thereby, the function builds a list of sub-families, one for each
distribution parameter. The sub-families themselves are objects of the
class <code>boost_family</code>, and can be constructed via the function
<code>Family</code> of the <code>mboost</code> Package.
</p>
<p>Arguments to be passed to <code>Family</code>: The <code>loss</code> for every
distribution parameter (contained in objects of class
<code>boost_family</code>) is the negative log-likelihood of the
corresponding distribution. The <code>ngradient</code> is the negative
partial derivative of the loss function with respect to the
distribution parameter. For a two-parameter distribution (e.g. mu and
sigma), the user therefore has to specify two sub-families with
<code>Family</code>. The <code>loss</code> is basically the same function
for both paramters, only <code>ngradient</code> differs. Both sub-families
are passed to the <code>Families</code> constructor, which returns an object
of the class <code>families</code>.
</p>
<p>To (potentially) stabilize the model estimation by standardizing the
negative gradients one can use the argument <code>stabilization</code> of
the families. If <code>stabilization = "MAD"</code>, the negative gradient
is divided by its (weighted) median absolute deviation </p>
<p style="text-align: center;"><code class="reqn">median_i
  (|u_{k,i} - median_j(u_{k,j})|)</code>
</p>
<p> in each boosting step. See Hofner et 
al. (2016) for details. An alternative is <code>stabilization = "L2"</code>, where the gradient is divided by its (weighted) mean L2 norm. This results in negative gradient vectors (and hence also updates) of similar size for each distribution parameter, but also for every boosting iteration.  
</p>


<h3>Value</h3>

<p>An object of class <code>families</code>.
</p>


<h3>Author(s)</h3>

<p><code>BetaLSS</code> for boosting beta regression was implmented by Florian
Wickler.
</p>


<h3>References</h3>

<p>B. Hofner, A. Mayr, M. Schmid (2016). gamboostLSS: An R Package for
Model Building and Variable Selection in the GAMLSS Framework.
Journal of Statistical Software, 74(1), 1-31.
</p>
<p>Available as <code>vignette("gamboostLSS_Tutorial")</code>.
</p>
<p>Mayr, A., Fenske, N., Hofner, B., Kneib, T. and Schmid, M. (2012):
Generalized additive models for location, scale and shape for
high-dimensional data - a flexible approach based on boosting. Journal
of the Royal Statistical Society, Series C (Applied Statistics) 61(3):
403-427.
</p>
<p>Rigby, R. A. and D. M. Stasinopoulos (2005). Generalized additive
models for location, scale and shape (with discussion). Journal of the
Royal Statistical Society, Series C (Applied Statistics), 54, 507-554.
</p>


<h3>See Also</h3>

<p><code>as.families</code> for applying GAMLSS distributions provided
in the framework of the <code>gamlss</code> package.
</p>
<p>The functions <code>gamboostLSS</code> and <code>glmboostLSS</code>
can be used for model fitting.
</p>
<p>See also the corresponding constructor function
<code>Family</code> in <code>mboost</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example to define a new distribution:
## Students t-distribution with two parameters, df and mu:

## sub-Family for mu
## -&gt; generate object of the class family from the package mboost
newStudentTMu  &lt;- function(mu, df){

    # loss is negative log-Likelihood, f is the parameter to be fitted with
    # id link -&gt; f = mu
    loss &lt;- function(df,  y, f) {
        -1 * (lgamma((df + 1)/2)  - lgamma(1/2) -
              lgamma(df/2) - 0.5 * log(df) -
              (df + 1)/2 * log(1 + (y - f)^2/(df )))
    }
    # risk is sum of loss
    risk &lt;- function(y, f, w = 1) {
        sum(w * loss(y = y, f = f, df = df))
    }
    # ngradient is the negative derivate w.r.t. mu (=f)
    ngradient &lt;- function(y, f, w = 1) {
        (df + 1) * (y - f)/(df  + (y - f)^2)
    }

    # use the Family constructor of mboost
    mboost::Family(ngradient = ngradient, risk = risk, loss = loss,
                   response = function(f) f,
                   name = "new Student's t-distribution: mu (id link)")
}

## sub-Family for df
newStudentTDf &lt;- function(mu, df){

    # loss is negative log-Likelihood, f is the parameter to be fitted with
    # log-link: exp(f) = df
    loss &lt;- function( mu, y, f) {
        -1 * (lgamma((exp(f) + 1)/2)  - lgamma(1/2) -
              lgamma(exp(f)/2) - 0.5 * f -
              (exp(f) + 1)/2 * log(1 + (y - mu)^2/(exp(f) )))
    }
    # risk is sum of loss
    risk &lt;- function(y, f, w = 1) {
        sum(w * loss(y = y, f = f,  mu = mu))
    }
    # ngradient is the negative derivate of the loss w.r.t. f
    # in this case, just the derivative of the log-likelihood 
    ngradient &lt;- function(y, f, w = 1) {
        exp(f)/2 * (digamma((exp(f) + 1)/2) - digamma(exp(f)/2)) -
            0.5 - (exp(f)/2 * log(1 + (y - mu)^2 / (exp(f) )) -
                   (y - mu)^2 / (1 + (y - mu)^2 / exp(f)) * (exp(-f) + 1)/2)
    }
    # use the Family constructor of mboost
    mboost::Family(ngradient = ngradient, risk = risk, loss = loss,
                   response = function(f) exp(f),
                   name = "Student's t-distribution: df (log link)")
}

## families object for new distribution
newStudentT &lt;- Families(mu= newStudentTMu(mu=mu, df=df),
                        df=newStudentTDf(mu=mu, df=df))

### Do not test the following code per default on CRAN as it takes some time to run:
### usage of the new Student's t distribution:
library(gamlss)   ## required for rTF
set.seed(1907)
n &lt;- 5000
x1  &lt;- runif(n)
x2 &lt;- runif(n)
mu &lt;- 2 -1*x1 - 3*x2
df &lt;- exp(1 + 0.5*x1 )
y &lt;- rTF(n = n, mu = mu, nu = df)

## model fitting
model &lt;- glmboostLSS(y ~ x1 + x2, families = newStudentT,
                     control = boost_control(mstop = 100),
                     center = TRUE)
## shrinked effect estimates
coef(model, off2int = TRUE)

## compare to pre-defined three parametric t-distribution:
model2 &lt;- glmboostLSS(y ~ x1 + x2, families = StudentTLSS(),
                      control = boost_control(mstop = 100),
                      center = TRUE)
coef(model2, off2int = TRUE)

## with effect on sigma:
sigma &lt;- 3+ 1*x2
y &lt;- rTF(n = n, mu = mu, nu = df, sigma=sigma)
model3 &lt;- glmboostLSS(y ~ x1 + x2, families = StudentTLSS(),
                      control = boost_control(mstop = 100),
                      center = TRUE)
coef(model3, off2int = TRUE)


</code></pre>


</div>