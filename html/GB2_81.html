<div class="container">

<table style="width: 100%;"><tr>
<td>CompoundFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting the Compound Distribution based on the GB2 by the Method of Maximum Likelihood Estimation
</h2>

<h3>Description</h3>

<p>Calculates the log-likelihood, the score functions of the log-likelihood, the weighted mean of scores, and fits the parameters of the Compound Distribution based on the GB2.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vofp.cgb2(pl)
pofv.cgb2(vl)
logl.cgb2(fac, pl, w=rep(1, dim(fac)[1]))
scores.cgb2(fac, pl, w=rep(1, dim(fac)[1]))
ml.cgb2(fac, pl0, w=rep(1, dim(fac)[1]), maxiter=100, fnscale=length(w)) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pl0</code></td>
<td>
<p>numeric; vector of initial proportions defining the number of components and the weight of each component density in the decomposition. Sums to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p>numeric; vector of fitted proportions. Sums to one. If <code>pl</code> is equal to <code>pl0</code>, we obtain the GB2 distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fac</code></td>
<td>
<p>numeric; matrix of Gamma factors (output of <code>fac.cgb2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vl</code></td>
<td>
<p>numeric; vector of parameters. Its length is equal to the length of <code>pl</code> - 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>numeric; vector of weights of length the number of rows of the matrix <code>fac</code>. By default <code>w</code> is a vector of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>numeric; maximum number of iterations to perform. By default <code>maxiter</code> = 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fnscale</code></td>
<td>
<p>numeric; an overall scaling parameter used in the function <code>optim</code>. By default it is equal to the length of the vector of weights <code>w</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are only <code class="reqn">L-1</code> parameters to estimate, because the probabilities <code class="reqn">p_\ell</code> sum to 1 (L is the dimension of the vector of probailities <code class="reqn">p_\ell</code>). Knowing this, we change the parameters <code class="reqn">p_\ell</code> to <code class="reqn">v_\ell=log(p_\ell/p_L), \ \ell= 1, ..., L-1</code>. This calculation is done through the function <code>vofp.cgb2</code>. <code>pofv.cgb2</code> calculates the <code class="reqn">p_\ell</code> in function of the given <code class="reqn">v_\ell</code>.
We express the log-likelihood as a weighted mean of <code class="reqn">log(f) = log(\sum(p_\ell f_\ell)</code>, evaluated at the data points, where <code class="reqn">f</code> is the GB2 compound density. If the weights are not available, then we suppose that <code>w</code> <code class="reqn">= 1</code>. Analogically, the scores are obtained as weighted sums of the first derivatives of the log-likelihood, with respect to the parameters <code class="reqn">v_\ell, \ \ell=1, ..., L-1</code>, evaluated at the data points.  Function <code>ml.cgb2</code> performs maximum likelihood estimation through the general-purpose optimization function <code>optim</code> from package <code>stats</code>. The considered method of optimization is BFGS.
</p>


<h3>Value</h3>

<p><code>vofp.cgb2</code> returns a vector of length <code class="reqn">L-1</code>, where <code class="reqn">L</code> is the length of the vector <code class="reqn">p_\ell</code>. 
<code>pofv.cgb2</code> returns a vector of length <code class="reqn">\ell</code>. 
<code>logl.cgb2</code> returns the value of the pseudo log-likelihood. 
<code>scores.cgb2</code> returns a vector of the weighted mean of the scores of length <code class="reqn">L-1</code>. 
<code>ml.cgb2</code> returns a list containing two objects - the vector of fitted proportions <code class="reqn">\hat{p_\ell}</code> and the output of the BFGS fit.
</p>


<h3>Author(s)</h3>

<p>Monique Graf and Desislava Nedyalkova
</p>


<h3>See Also</h3>

<p><code>optim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# GB2 parameters:
a &lt;- 4
b &lt;- 1950
p &lt;- 0.8
q &lt;- 0.6

# Proportions defining the component densities:
pl0 &lt;- rep(1/3,3)

# Mixture probabilities
pl &lt;- c(0.1,0.8,0.1)

# Random generation:
n &lt;- 10000
set.seed(12345)
x &lt;- rcgb2(n,a,b,p,q,pl0,pl,decomp="l")

# Factors in component densities
fac &lt;- fg.cgb2(x,a,b,p,q, pl0,decomp="l")

# Estimate the mixture probabilities:
estim &lt;- ml.cgb2(fac,pl0)

# estimated mixture probabilities:
estim[[1]]
#[1] 0.09724319 0.78415797 0.11859883

## End(Not run)
</code></pre>


</div>