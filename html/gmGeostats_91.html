<div class="container">

<table style="width: 100%;"><tr>
<td>fit_lmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit an LMC to an empirical variogram</h2>

<h3>Description</h3>

<p>Fit a linear model of coregionalisation to an empirical variogram
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_lmc(v, ...)

## S3 method for class 'gstatVariogram'
fit_lmc(
  v,
  g,
  model,
  fit.ranges = FALSE,
  fit.lmc = !fit.ranges,
  correct.diagonal = 1,
  ...
)

## Default S3 method:
fit_lmc(v, g, model, ...)

## S3 method for class 'logratioVariogram'
fit_lmc(v, g, model, ...)

## S3 method for class 'logratioVariogramAnisotropy'
fit_lmc(v, g, model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>empirical variogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>spatial data object, containing the original data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>LMC or variogram model to fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.ranges</code></td>
<td>
<p>logical, should ranges be modified? (default=FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.lmc</code></td>
<td>
<p>logical, should the nugget and partial sill matrices be modified (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct.diagonal</code></td>
<td>
<p>positive value slightly larger than 1, for multiplying the direct variogram
models and reduce the risk of numerically negative eigenvalues</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Method fit_lmc.gstatVariogram is a wrapper around <code>gstat::fit.lmc()</code>, that calls this function
and gives the resulting model its appropriate class (c("variogramModelList", "list")).
Method fit_lmc.default returns the fitted lmc (this function currently uses gstat as a
calculation machine, but this behavior can change in the future)
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>gstatVariogram</code>: wrapper around gstat::fit.lmc method
</p>
</li>
<li> <p><code>default</code>: flexible wrapper method for any class for which methods
for <code>as.gstatVariogram()</code>, <code>as.gstat()</code> and <code>as.variogramModel()</code> exist.
In the future there may be direct specialised implementations not depending on
package gstat.
</p>
</li>
<li> <p><code>logratioVariogram</code>: method for logratioVariogram wrapping compositions::fit.lmc.
In the future there may be direct specialised implementations,
including anisotropy (not yet possible).
</p>
</li>
<li> <p><code>logratioVariogramAnisotropy</code>: method for logratioVariogram with anisotropry
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">data("jura", package = "gstat")
X = jura.pred[,1:2]
Zc = jura.pred[,7:13]
gg = make.gmCompositionalGaussianSpatialModel(Zc, X, V="alr", formula = ~1)
vg = variogram(gg)
md = gstat::vgm(model="Sph", psill=1, nugget=1, range=1.5)
gg = fit_lmc(v=vg, g=gg, model=md)
variogramModelPlot(vg, model=gg)
</code></pre>


</div>