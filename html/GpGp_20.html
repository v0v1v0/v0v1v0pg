<div class="container">

<table style="width: 100%;"><tr>
<td>exponential_spheretime_warp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Deformed exponential covariance function on sphere</h2>

<h3>Description</h3>

<p>From a matrix of longitudes, latitudes, times, and a vector covariance parameters of the form
(variance, range_1, range_2, nugget, &lt;5 warping parameters&gt;), return the square matrix of
all pairwise covariances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exponential_spheretime_warp(covparms, lonlattime)

d_exponential_spheretime_warp(covparms, lonlattime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>covparms</code></td>
<td>
<p>A vector with covariance parameters
in the form (variance, range_1, range_2, nugget, &lt;5 warping parameters&gt;). 
range_1 is a spatial range parameter that assumes that the sphere 
has radius 1 (units are radians). range_2 is a temporal range parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lonlattime</code></td>
<td>
<p>A matrix with <code>n</code> rows and three columns: longitudes in (-180,180),
latitudes in (-90,90), and times.
Each row of lonlattime describes a point on the sphere x time.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with <code>n</code> rows and <code>n</code> columns, with the i,j entry
containing the covariance between observations at <code>lonlat[i,]</code> and
<code>lonlat[j,]</code>.
</p>


<h3>Functions</h3>


<ul><li> <p><code>d_exponential_spheretime_warp()</code>: Derivatives with respect to parameters
</p>
</li></ul>
<h3>Warpings</h3>

<p>The function first calculates the (x,y,z) 3D coordinates, and then "warps"
the locations to <code class="reqn">(x,y,z) + \Phi(x,y,z)</code>, where <code class="reqn">\Phi</code> is a warping
function composed of gradients of spherical harmonic functions of degree 2.
See Guinness (2019, "Gaussian Process Learning via Fisher Scoring of 
Vecchia's Approximation") for details.
The warped locations are input into <code>exponential_spacetime</code>. The function
does not do temporal warping.
</p>


</div>