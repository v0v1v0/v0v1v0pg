<div class="container">

<table style="width: 100%;"><tr>
<td>orlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting multivariate regression models with order restrictions</h2>

<h3>Description</h3>

<p>This is a modification of the <code>lm</code> function, fitting (multivariate) linear models with order constraints on the model coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">orlm(formula, data, constr, rhs, nec, control = orlmcontrol())

## S3 method for class 'formula'
orlm(formula, data, constr, rhs, nec,
  control = orlmcontrol())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula" (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which lm is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constr</code></td>
<td>
<p>matrix with constraints; with rows as constraint definition, columns should be in line with the parameters of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhs</code></td>
<td>
<p>vector of right hand side elements; <code class="reqn">Constr \; \theta \geq rhs</code>; number should equal the number of rows of the constr matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nec</code></td>
<td>
<p>number of equality constraints; a numeric value treating the first nec constr rows as equality constraints, or a logical vector with <code>TRUE</code> for equality- and <code>FALSE</code> for inequality constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control arguments; see <code>orlmcontrol</code> for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The contraints in the hypothesis of interest are defined by <code class="reqn">Constr</code>, <code class="reqn">rhs</code>, and <code class="reqn">nec</code>. The first <code class="reqn">nec</code> constraints are the equality contraints: <code class="reqn">Constr[1:nec, 1:tk] \theta = rhs[1:nec]</code>; and the remaing ones are the inequality contraints: <code class="reqn">Constr[nec+1:c_m, 1:tk] \theta \geq rhs[nec+1:c_m]</code>.
Two requirements should be met:
</p>

<ol>
<li>
<p> The first <code class="reqn">nec</code> constraints must be the equality contraints (i.e., <code class="reqn">Constr[1:nec, 1:tk] \theta = rhs[1:nec]</code>) and the remaining ones the inequality contraints (i.e., <code class="reqn">Constr[nec+1:c_m, 1:tk] \theta \geq rhs[nec+1:c_m]</code>).
</p>
</li>
<li>
<p> When <code class="reqn">rhs</code> is not zero, <code class="reqn">Constr</code> should be of full rank (after discarding redundant restrictions).
</p>
</li>
</ol>
<h3>Value</h3>

<p>an object of class orlm
</p>


<h3>References</h3>


<ul>
<li>
<p> Kuiper R.M., Hoijtink H., Silvapulle M.J. (2011). An Akaike-type Information Criterion for Model Selection Under Inequality Constraints. <em>Biometrika</em>, <b>98</b>, 495â€“501.
</p>
</li>
<li>
<p> Kuiper R.M., Hoijtink H., Silvapulle M.J. (2012). Generalization of the Order-Restricted Information Criterion for Multivariate Normal Linear Models. <em>Journal of Statistical Planning and Inference</em>, <b>142</b>, 2454-2463. doi:10.1016//j.jspi.2012.03.007.
</p>
</li>
<li>
<p> Kuiper R.M. and Hoijtink H. (submitted). A Fortran 90 Program for the Generalization of the Order-Restricted Information Criterion. Journal of Statictical Software.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>solve.QP</code>, <code>goric</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">########################
## Artificial example ##
########################
n &lt;- 10
m &lt;- c(1,2,1,5)
nm &lt;- length(m)
dat &lt;- data.frame(grp=as.factor(rep(1:nm, each=n)),
                  y=rnorm(n*nm, rep(m, each=n), 1))

# unrestricted linear model
cm1 &lt;- matrix(0, nrow=1, ncol=4)
fm1 &lt;- orlm(y ~ grp-1, data=dat, constr=cm1, rhs=0, nec=0)

# order restriction (increasing means)
cm2 &lt;- rbind(c(-1,1,0,0),
             c(0,-1,1,0),
             c(0,0,-1,1))
fm2 &lt;- orlm(y ~ grp-1, data=dat, constr=cm2,
            rhs=rep(0,nrow(cm2)), nec=0)

# order restriction (increasing at least by delta=1)
fm3 &lt;- orlm(y ~ grp-1, data=dat, constr=cm2,
            rhs=rep(1,nrow(cm2)), nec=0)

# larger than average of the neighboring first 2 parameters
cm4 &lt;- rbind(c(-0.5,-0.5,1,0),
             c(0,-0.5,-0.5,1))
fm4 &lt;- orlm(y ~ grp-1, data=dat, constr=cm4,
            rhs=rep(0,nrow(cm4)), nec=0)

# equality constraints (all parameters equal)
fm5 &lt;- orlm(y ~ grp-1, data=dat, constr=cm2,
            rhs=rep(0,nrow(cm2)), nec=nrow(cm2))
            
# alternatively
fm5 &lt;- orlm(y ~ grp-1, data=dat, constr=cm2,
            rhs=rep(0,nrow(cm2)), nec=c(TRUE,TRUE,TRUE))
            
# constraining the 1st and the 4th parameter
# to their true values, and the 2nd and 3rd between them
cm6 &lt;- rbind(c( 1,0,0,0),
             c(-1,1,0,0),
             c(0,-1,0,1),
             c(-1,0,1,0),
             c(0,0,-1,1),
             c(0,0, 0,1))
fm6 &lt;- orlm(y ~ grp-1, data=dat, constr=cm6,
            rhs=c(1,rep(0,4),5), nec=c(TRUE,rep(FALSE,4),TRUE))
            
            
###############################################################
## Example from Kuiper, R.M. and Hoijtink, H. (Unpublished). ##
## A Fortran 90 program for the generalization of the        ##
## order restricted information criterion.                   ##
###############################################################

# constraint definition
cmat &lt;- cbind(diag(3), 0) + cbind(0, -diag(3))
constr &lt;- kronecker(diag(3), cmat)

# no effect model
(fm0 &lt;- orlm(cbind(SDH, SGOT, SGPT) ~ dose-1, data=vinylidene,
             constr=constr, rhs=rep(0, nrow(constr)), nec=nrow(constr)))

# order constrained model (increasing serum levels with increasing doses)
fm1 &lt;- orlm(cbind(SDH, SGOT, SGPT) ~ dose-1, data=vinylidene,
            constr=constr, rhs=rep(0, nrow(constr)), nec=0)
summary(fm1)

# unconstrained model
(fmunc &lt;- orlm(cbind(SDH, SGOT, SGPT) ~ dose-1, data=vinylidene,
               constr=matrix(0, nrow=1, ncol=12), rhs=0, nec=0))
</code></pre>


</div>