<div class="container">

<table style="width: 100%;"><tr>
<td>GeoWLS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>WLS of Random Fields</h2>

<h3>Description</h3>

<p>the function returns the parameters' estimates of a random field obtained by 
the weigthed least squares estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GeoWLS(data, coordx, coordy=NULL, coordt=NULL, coordx_dyn=NULL, corrmodel, 
             distance="Eucl", fixed=NULL, grid=FALSE, maxdist=NULL,neighb=NULL,
             maxtime=NULL,  model='Gaussian', optimizer='Nelder-Mead',
             numbins=NULL, radius=6371, start=NULL, weighted=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector (a single spatial realisation)  or a (<code class="reqn">d \times d</code>)-matrix (a single spatial realisation on regular grid)
or an (<code class="reqn">d \times d \times n</code>)-array (<code class="reqn">n</code> iid spatial realisations on regular grid) or a
(<code class="reqn">t \times d</code>)-matrix (a single spatial-temporal realisation) or an (<code class="reqn">d \times d \times t \times n </code>)-array
(a single spatial-temporal realisation on regular grid). See <code>GeoFit</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx</code></td>
<td>
<p>A numeric (<code class="reqn">d \times 2</code>)-matrix (where
<code>d</code> is the number of spatial sites) giving 2-dimensions of spatial coordinates or a numeric <code class="reqn">d</code>-dimensional vector giving
1-dimension of spatial coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordy</code></td>
<td>
<p>A numeric vector giving 1-dimension of
spatial coordinates; <code>coordy</code> is interpreted only if <code>coordx</code> is a numeric
vector or <code>grid=TRUE</code> otherwise it will be ignored. Optional argument, the default is <code>NULL</code> then <code>coordx</code> is expected to
be numeric a (<code class="reqn">d \times 2</code>)-matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordt</code></td>
<td>
<p>A numeric vector giving 1-dimension of
temporal coordinates. Optional argument, the default is <code>NULL</code> then a spatial random field is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx_dyn</code></td>
<td>
<p>A list of <code class="reqn">m</code> numeric (<code class="reqn">d_t \times 2</code>)-matrices
containing dynamical (in time) spatial coordinates. Optional argument, the default is <code>NULL</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrmodel</code></td>
<td>
<p>String; the name of a correlation model, for the
description (see <code>GeoFit</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>String; the name of the spatial distance. The default is <code>Eucl</code>,
the euclidean distance. See the Section <b>Details</b>
of <code>GeoFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A named list giving the values of the parameters that
will be considered as known values. The listed parameters for a
given correlation function will be not estimated, i.e. if
<code>list(nugget=0)</code> the nugget effect is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical; if <code>FALSE</code> (the default) the data
are interpreted as a vector or a (<code class="reqn">n \times d</code>)-matrix,
instead if <code>TRUE</code> then (<code class="reqn">d \times d
      \times n</code>)-matrix is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>A numeric value denoting the maximum distance, see
<b>Details</b> in <code>GeoFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighb</code></td>
<td>
<p>Numeric; an optional positive integer indicating the 
order of neighborhood. See <b>Details</b> and <code>GeoFit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>Numeric; an optional positive value indicating the maximum
temporal lag considered.See <b>Details</b> and <code>GeoFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>String; the type of random field. <code>Gaussian</code> is the default, see
<code>GeoFit</code> for the different types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>String; the optimization algorithm
(see <code>optim</code> for details). 'Nelder-Mead' is the
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numbins</code></td>
<td>
<p>A numeric value denoting the numbers of bins, see the
Section <b>Details</b></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Numeric; a value indicating  the radius of the sphere when using the great circle distance.
Default value is the radius of the earth in Km (i.e. 6371)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named list with the initial values of the
parameters that are used by the numerical routines in maximization
procedure. <code>NULL</code> is the default (see <code>GeoFit</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Logical; if <code>TRUE</code> then the weighted least square
estimator is considered. If <code>FALSE</code> (the
default) then the classic least square is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The  <code>numbins</code> parameter indicates the number of adjacent
intervals to consider in order to grouped distances with which to
compute the (weighted) lest squares.
</p>
<p>The <code>maxdist</code> parameter indicates the maximum distance below which
the shorter distances will be considered in the calculation of
the (weigthed) least squares.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>WLS</code>.
An object of class <code>WLS</code> is a list containing
at most the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>Adjacent intervals of grouped distances;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bint</code></td>
<td>
<p>Adjacent intervals of grouped temporal separations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>The centers of the bins;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx</code></td>
<td>
<p>The vector or matrix of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordy</code></td>
<td>
<p>The vector of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordt</code></td>
<td>
<p>The vector of temporal coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>A string that denotes if convergence is reached;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrmodel</code></td>
<td>
<p>The correlation model;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The vector or matrix of data;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The type of spatial distance;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>The vector of fixed parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>The number of iteration used by the numerical routine;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>The maximum spatial distance used for the calculation of the variogram used in least square estimation.
If no spatial distance is specified then it is NULL;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>The maximum temporal distance used for the calculation of the variogram used in least square estimation.
If no temporal distance is specified then it is NULL;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>Extra message passed from the numerical routines;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The type of random fields;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numcoord</code></td>
<td>
<p>The number of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numtime</code></td>
<td>
<p>The number the temporal realisations of the random field;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>The vector of  parameters' estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variograms</code></td>
<td>
<p>The empirical spatial variogram;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variogramt</code></td>
<td>
<p>The empirical temporal variogram;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variogramst</code></td>
<td>
<p>The empirical spatial-temporal variogram;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>A logical value indicating if its the weighted
method;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wls</code></td>
<td>
<p>The value of the least squares at the minimum.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Moreno Bevilacqua, <a href="mailto:moreno.bevilacqua89@gmail.com">moreno.bevilacqua89@gmail.com</a>,<a href="https://sites.google.com/view/moreno-bevilacqua/home">https://sites.google.com/view/moreno-bevilacqua/home</a>,
Víctor Morales Oñate, <a href="mailto:victor.morales@uv.cl">victor.morales@uv.cl</a>, <a href="https://sites.google.com/site/moralesonatevictor/">https://sites.google.com/site/moralesonatevictor/</a>,
Christian", Caamaño-Carrillo, <a href="mailto:chcaaman@ubiobio.cl">chcaaman@ubiobio.cl</a>,<a href="https://www.researchgate.net/profile/Christian-Caamano">https://www.researchgate.net/profile/Christian-Caamano</a>
</p>


<h3>References</h3>

<p>Cressie, N. A. C. (1993) <em>Statistics for Spatial Data</em>. New York:
Wiley.
</p>
<p>Gaetan, C. and Guyon, X. (2010) <em>Spatial Statistics and Modelling</em>.
Spring Verlang, New York.
</p>


<h3>See Also</h3>

<p><code>GeoFit</code>, <code>optim</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(GeoModels)


# Set the coordinates of the sites:

set.seed(211)
x &lt;- runif(200, 0, 1)
set.seed(98)
y &lt;- runif(200, 0, 1)
coords &lt;- cbind(x,y)

################################################################
###
### Example 1. Least square fitting of a Gaussian random field
### with exponential correlation.
###
###############################################################

# Set the model's parameters:
corrmodel &lt;- "Exponential"
mean &lt;- 0
sill &lt;- 1
nugget &lt;- 0
scale &lt;- 0.15/3
param &lt;- list(mean=0,sill=sill, nugget=nugget, scale=scale)
# Simulation of the Gaussian random field:
set.seed(2)
data &lt;- GeoSim(coordx=coords, corrmodel=corrmodel, param=param)$data

fixed=list(nugget=0,mean=mean)
start=list(scale=scale,sill=sill)
# Least square fitting of the random field:
fit &lt;- GeoWLS(data=data,coordx=coords, corrmodel=corrmodel,
         fixed=fixed,start=start,maxdist=0.5)

# Results:
print(fit)

</code></pre>


</div>