<div class="container">

<table style="width: 100%;"><tr>
<td>GLSME-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Least Squares with Measurement Error</h2>

<h3>Description</h3>

<p>The code fits the general linear model with correlated data and
observation error in both dependent and independent variables. The code fits the
model 
</p>
<p style="text-align: center;"><code class="reqn">y = D\beta + r, r \sim N(0,V), V = \sigma^{2} T + V_{e} + Var[U\beta|D],</code>
</p>

<p>where <code>y</code> is a vector of observed response variables, <code>D</code> is an observed design matrix, 
<code class="reqn">\beta</code>
is a vector of regression parameters to be estimated, 
<code class="reqn">\sigma^{2}</code><code>T</code> is a matrix representing the true residual
variance, <code class="reqn">V_{e}</code> is a matrix
of known measurement variance in the response variable, and <code>Var[U</code><code class="reqn">\beta</code><code>|D]</code> is a matrix
representing effects of measurement error in the predictor variables (see Hansen and Bartoszek 2012).
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> GLSME</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.0.5</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2019-09-15</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
<td style="text-align: left;">
LazyLoad: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The code fits the general linear model with correlated data and
observation error in both dependent and independent variables. The code fits the
model 
</p>
<p style="text-align: center;"><code class="reqn">y = D\beta + r, r \sim N(0,V), V = \sigma^{2}T + V_{e} + Var[U\beta|D],</code>
</p>

<p>where <code>y</code> is a vector of observed response variables, <code>D</code> is an observed design matrix, 
<code class="reqn">\beta</code>
is a vector of regression parameters to be estimated, 
<code class="reqn">\sigma^{2}</code><code>T</code> is a matrix representing the true residual
variance, <code class="reqn">V_{e}</code> is a matrix
of known measurement variance in the response variable, and <code>Var[U</code><code class="reqn">\beta</code><code>|D]</code> is a matrix
representing effects of measurement error in the predictor variables (see Hansen and Bartoszek 2012).
</p>
<p>The estimation function is <code>GLSME</code>. It is an iterated (if the variance parameters are unknown)
generalized least squares estimation procedure. 
</p>
<p>The motivation for the approach is that the observations and errors are correlated due
to an underlying phylogeny but the program allows for any dependence structure. 
</p>
<p>In the <code>mvSLOUCH</code> package an alternative method of correcting 
for observation error is used. The error variance-covariance matrix enters
the likelihood function by being added to the biological variance-covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Krzysztof Bartoszek
Maintainer: &lt;bartoszekkj@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bartoszek, K. and Pienaar, J. and Mostad. P. and Andersson, S. and Hansen, T. F. (2012)
A phylogenetic comparative method for studying  multivariate adaptation.
Journal of Theoretical Biology 314:204-215.
</p>
<p>Hansen, T.F. (1997) 
Stabilizing selection and the comparative analysis of adaptation. 
Evolution 51:1341-1351.
</p>
<p>Hansen, T.F. and Bartoszek, K. (2012)
Interpreting the evolutionary regression: the interplay between observational and biological errors in phylogenetic comparative studies.
Systematic Biology 61(3):413-425.
</p>
<p>Hansen, T.F. and Pienaar, J. and Orzack, S.H. (2008) 
A comparative method for studying adaptation to randomly evolving environment. 
Evolution 62:1965-1977.
</p>


<h3>See Also</h3>

<p><code>mvSLOUCH</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">n&lt;-3 ## number of species
apetree&lt;-ape::rtree(n)
### Define Brownian motion parameters to be able to simulate data under the Brownian motion model.
BMparameters&lt;-list(vX0=matrix(0,nrow=2,ncol=1),Sxx=rbind(c(1,0),c(0.2,1)))
### Now simulate the data and remove the values corresponding to the internal nodes.
xydata&lt;-mvSLOUCH::simulBMProcPhylTree(apetree,X0=BMparameters$vX0,Sigma=BMparameters$Sxx)
xydata&lt;-xydata[(nrow(xydata)-n+1):nrow(xydata),]

x&lt;-xydata[,1]
y&lt;-xydata[,2]

yerror&lt;-diag((stats::rnorm(n,mean=0,sd=0.1))^2) #create error matrix
y&lt;-mvtnorm::rmvnorm(1,mean=y,sigma=yerror)[1,]
xerror&lt;-diag((stats::rnorm(n,mean=0,sd=0.1))^2) #create error matrix
x&lt;-mvtnorm::rmvnorm(1,mean=x,sigma=xerror)[1,]
GLSME(y=y, CenterPredictor=TRUE, D=cbind(rep(1, n), x), Vt=ape::vcv(apetree), 
Ve=yerror, Vd=list("F",ape::vcv(apetree)), Vu=list("F", xerror))
</code></pre>


</div>