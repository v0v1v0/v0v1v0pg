<div class="container">

<table style="width: 100%;"><tr>
<td>pulkroben</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pulkstenis-Robinson Test for Categorical Response Models</h2>

<h3>Description</h3>

<p>This provides a post estimation goodness-of-fit test for
the ordinal response models. Supported models include the proportional odds,
adjacent-category, and constrained continuation-ratio models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pulkroben(model, test = c("chisq", "deviance"), tables = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a model object or data.frame of observed and estimated
values. The following class of objects can be directly passed to the
<code>pulkroben</code> function: vglm(), serp(), polr(), and clm(). Other class of
objects require providing a data.frame of observed and predicted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>chooses between the chi-squared and the deviance test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>
<p>Default to FALSE. When TRUE, both the observed and the
expected frequency tables are printed alongside test results.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Pulkstenis-Robinson test groups the observations using the covariate
patterns obtained from the categorical covariates. Each covariate pattern
is subsequently split in two based on the median ordinal scores. The test
statistic (chi-sq or deviance) is obtaned using the tabulated observed and
estimated frequencies. Assuming c is the number of covariate patterns, r the
number of response categories and k the number of categorical variables in
the model, the test statistic approximates the chi-sq distribution with
(2c - 1)(r - 1) - k - 1 degrees of freedom (Pulkstenis and Robinson (2004)).
As recommended in Fagerland and Hosmer (2016, 2017), this test should
be compared with the Hosmer-Lemeshow and the Lipsitz tests.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>realized value of the chi-square or deviance statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>a table of the observed frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>a table of the estimated frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>percentage of estimated frequencies greater than one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>a character vector of the type of test statistic used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>
<p>a TRUE or FALSE logical vector.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Pulkstenis, E. and Robinson, T. J. (2004). Goodness-of-fit tests for ordinal
response regression models. <em>Statistics in Medicine</em> 23, 999-1014.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2016). Tests for goodness of fit in
ordinal logistic regression models. <em>Journal of Statistical
Computation and Simulation</em>, 86, 3398-3418.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2017). How to test for goodness of fit
in ordinal logistic regression models. <em>Stata Journal</em>, 17, 668-686.
</p>


<h3>See Also</h3>

<p><code>hosmerlem</code>, <code>lipsitz</code>, <code>brant.test</code>,
<code>LR.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
require(VGAM)

set.seed(1)
n &lt;- 200
y &lt;- ordered(rbinom(n, 2, 0.5))
x1 &lt;- factor(rbinom(n, 1, 0.7))
x2 &lt;- runif(n)

## proportional odds model
vg &lt;- vglm(y ~ x1 + x2, model = TRUE,
           family = cumulative(link = "logitlink", parallel = TRUE))
pulkroben(vg, tables = TRUE)

## adjacent category model
ac &lt;- update(vg, family = acat(parallel = TRUE))
pulkroben(ac, tables = TRUE)

## continuation ratio model
cr &lt;- update(vg, family = cratio(parallel = TRUE))
pulkroben(cr, tables = TRUE)

</code></pre>


</div>