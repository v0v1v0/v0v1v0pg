<div class="container">

<table style="width: 100%;"><tr>
<td>text_transform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform text transformations with a custom function</h2>

<h3>Description</h3>

<p>Text transforming in <strong>gt</strong> is the act of modifying formatted strings in
targeted cells. <code>text_transform()</code> provides the most flexibility of all the
<code style="white-space: pre;">⁠text_*()⁠</code> functions in their family of functions. With it, you target the
cells to undergo modification in the <code>locations</code> argument while also
supplying a function to the <code>fn</code> argument. The function given to <code>fn</code> should
ideally at the very least take <code>x</code> as an input (it stands for the character
vector that is essentially the targeted cells) and return a character vector
of the same length as the input. Using the construction <code>function(x) { .. }</code>
for the function is recommended.
</p>


<h3>Usage</h3>

<pre><code class="language-R">text_transform(data, fn, locations = cells_body())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><em>The gt table data object</em>
</p>
<p><code style="white-space: pre;">⁠obj:&lt;gt_tbl&gt;⁠</code> // <strong>required</strong>
</p>
<p>This is the <strong>gt</strong> table object that is commonly created through use of the
<code>gt()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p><em>Function for text transformation</em>
</p>
<p><code style="white-space: pre;">⁠&lt;function&gt;⁠</code> // <strong>required</strong>
</p>
<p>The function to use for text transformation. It should include <code>x</code> as an
argument and return a character vector of the same length as the input <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>
<p><em>Locations to target</em>
</p>
<p><code>&lt;locations expressions&gt;</code> // <em>default:</em> <code>cells_body()</code>
</p>
<p>The cell or set of cells to be associated with the text transformation.
Only <code>cells_column_spanners()</code>, <code>cells_column_labels()</code>,
<code>cells_row_groups()</code>, <code>cells_stub()</code>, and <code>cells_body()</code> can
be used here. We can enclose several of these calls within a <code>list()</code> if we
wish to make the transformation happen at different locations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gt_tbl</code>.
</p>


<h3>Examples</h3>

<p>Use a subset of the <code>sp500</code> dataset to create a <strong>gt</strong> table. Transform the
text in the <code>date</code> column using a function supplied to <code>text_transform()</code>
(via the <code>fn</code> argument). Note that the <code>x</code> in the <code style="white-space: pre;">⁠fn = function (x)⁠</code> part
consists entirely of ISO 8601 date strings (which are acceptable as input to
<code>vec_fmt_date()</code> and <code>vec_fmt_datetime()</code>).
</p>
<div class="sourceCode r"><pre>sp500 |&gt;
  dplyr::slice_head(n = 10) |&gt;
  dplyr::select(date, open, close) |&gt;
  dplyr::arrange(-dplyr::row_number()) |&gt;
  gt() |&gt;
  fmt_currency() |&gt;
  text_transform(
    fn = function(x) {
      paste0(
        "&lt;strong&gt;",
        vec_fmt_date(x, date_style = "m_day_year"),
        "&lt;/strong&gt;",
        "&amp;mdash;W",
        vec_fmt_datetime(x, format = "w")
      )
    },
    locations = cells_body(columns = date)
  ) |&gt;
  cols_label(
    date = "Date and Week",
    open = "Opening Price",
    close = "Closing Price"
  )
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_text_transform_1.png" alt="This image of a table was generated from the first code example in the `text_transform()` help file." style="width:100%;"><p>Let's use a summarized version of the <code>gtcars</code> dataset to create a <strong>gt</strong>
table. First, the numeric values in the <code>n</code> column are formatted as
spelled-out numbers with <code>fmt_spelled_num()</code>. The output values are indeed
spelled out but exclusively with lowercase letters. We actually want these
words to begin with a capital letter and end with a period. To make this
possible, <code>text_transform()</code> will be used since it can modify
already-formatted text. Through the <code>fn</code> argument, we provide a custom
function that uses R's <code>toTitleCase()</code> operating on <code>x</code> (the numbers-as-text
strings) within <code>paste0()</code> so that a period can be properly placed.
</p>
<div class="sourceCode r"><pre>gtcars |&gt;
  dplyr::filter(ctry_origin %in% c("Germany", "Italy", "Japan")) |&gt;
  dplyr::count(mfr, ctry_origin, sort = TRUE) |&gt;
  dplyr::arrange(ctry_origin) |&gt;
  gt(rowname_col = "mfr", groupname_col = "ctry_origin") |&gt;
  cols_label(n = "No. of Entries") |&gt;
  tab_stub_indent(rows = everything(), indent = 2) |&gt;
  cols_align(align = "center", columns = n) |&gt;
  fmt_spelled_num() |&gt;
  text_transform(
    fn = function(x) {
      paste0(tools::toTitleCase(x), ".")
    },
    locations = cells_body(columns = n)
  )
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_text_transform_2.png" alt="This image of a table was generated from the second code example in the `text_transform()` help file." style="width:100%;"><p>There may be occasions where you'd want to remove all text. Here in this
example based on the <code>pizzaplace</code> dataset, we generate a <strong>gt</strong> table that
summarizes an entire year of data by colorizing the daily sales revenue.
Individual cell values are not needed here (since the encoding by color
suffices), so, <code>text_transform()</code> is used to turn every value to an empty
string: <code>""</code>.
</p>
<div class="sourceCode r"><pre>pizzaplace |&gt;
  dplyr::group_by(date) |&gt;
  dplyr::summarize(rev = sum(price)) |&gt;
  dplyr::ungroup() |&gt;
  dplyr::mutate(
    month = lubridate::month(date, label = TRUE),
    day_num = lubridate::mday(date)
  ) |&gt;
  dplyr::select(-date) |&gt;
  tidyr::pivot_wider(names_from = month, values_from = rev) |&gt;
  gt(rowname_col = "day_num") |&gt;
  data_color(
    method = "numeric",
    palette = "wesanderson::Zissou1",
    na_color = "white"
  ) |&gt;
  text_transform(
    fn = function(x) "",
    locations = cells_body()
  ) |&gt;
  opt_table_lines(extent = "none") |&gt;
  opt_all_caps() |&gt;
  cols_width(everything() ~ px(35)) |&gt;
  cols_align(align = "center")
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_text_transform_3.png" alt="This image of a table was generated from the third code example in the `text_transform()` help file." style="width:100%;"><h3>Function ID</h3>

<p>4-4
</p>


<h3>Function Introduced</h3>

<p><code>v0.2.0.5</code> (March 31, 2020)
</p>


<h3>See Also</h3>

<p>Other text transforming functions: 
<code>text_case_match()</code>,
<code>text_case_when()</code>,
<code>text_replace()</code>
</p>


</div>