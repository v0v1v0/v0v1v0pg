<div class="container">

<table style="width: 100%;"><tr>
<td>groupbn_refinement</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>groupbn_refinement

</h2>

<h3>Description</h3>

<p>Adaptive Refinement of a group Bayesian Network
using hierarchical Clustering
</p>


<h3>Usage</h3>

<pre><code class="language-R">groupbn_refinement(res, hierarchy, refinement.part="mb", restart=0, perturb=1,
max.step=10, max.min=Inf, R=100,
return.all=FALSE, arc.thresh=NULL, debug=FALSE, seed=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>an object of class groupbn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierarchy</code></td>
<td>
<p>a cluster object from ClustOfVar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refinement.part</code></td>
<td>
<p>"mb", "mb2", "arc.confid" or "all", selects if the refinement steps should be done only within the markov blanket of the target variable (mb), within the second-order markov blanket (mb2), in all clusters with an arcconfidence to target &gt;0 (arc.confid) or within all clusters (all). Default: "mb"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restart</code></td>
<td>
<p>a positive integer number, the number of restarts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perturb</code></td>
<td>
<p>a positive integer number, the number of perturbations (splits) in each restart</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.step</code></td>
<td>
<p>a positive integer number, the maximal number of refinement steps, default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.min</code></td>
<td>
<p>a positive integer number, the maximal run time in minutes, default is unlimited</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of bootstrap replicates for model averaging, default is 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.all</code></td>
<td>
<p>a boolean, if TRUE, the output is a whole list of group models, if FALSE, the output is only the best-scoring model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arc.thresh</code></td>
<td>
<p>threshold for bootstrap arcs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>a boolean,
if TRUE, debugging messages are printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a random seed number</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Based on a variable grouping, data are aggregated and a Bayesian network is learned. The target variable is kept separated during this procedure, so that the resulting network model can be used for risk prediction and classification. Starting from a coarse group network, groups are iteratively refined to smaller groups. The heuristic refinement happens downwards along the dendrogram, and stops, if it no longer improves the predictive performance of the model. The refinement part is implemented using a hill-climbing procedure.
</p>


<h3>Value</h3>

<p>returns an object of class groupbn





</p>


<h3>Author(s)</h3>

<p>Ann-Kristin Becker

</p>


<h3>References</h3>

<p>Becker A-K, DÃ¶rr M, Felix SB, Frost F, Grabe HJ, Lerch MM, et al. (2021) From heterogeneous healthcare data to disease-specific biomarker networks: A hierarchical Bayesian network approach. PLoS Comput Biol 17(2): e1008735. https://doi.org/10.1371/journal.pcbi.1008735</p>


<h3>See Also</h3>

<p><code>groupbn</code>
<code>groupbn.output.table</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">#load example data
data(wine)
wine.test&lt;-wine[wine$Soil%in%c("Reference", "Env1"),1:29]
wine.test$Soil&lt;-factor(wine.test$Soil)
levels(wine.test$Soil)&lt;-c("0", "1")

#cluster data
hierarchy&lt;-hclustvar(X.quanti=wine.test[,3:29], X.quali=wine.test[,1:2])

#Learn group network among 5 clusters with "Soil" as target variable
wine.groupbn&lt;-groupbn(hierarchy, k=5, target="Soil", separate=NULL,
X.quanti=wine.test[,3:29], X.quali=wine.test[,1:2], seed=321)

#Do one refinement step
#Set max.step higher to optimize completely
wine.groupbn.refined&lt;-groupbn_refinement(wine.groupbn, hierarchy,
refinement.part="mb", max.step = 1, seed=321)

#Plot refined network
plot(wine.groupbn.refined)
</code></pre>


</div>