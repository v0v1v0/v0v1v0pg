<div class="container">

<table style="width: 100%;"><tr>
<td>glm2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting Generalized Linear Models
</h2>

<h3>Description</h3>

<p>Fits generalized linear models using the same model specification as <code>glm</code> in the <b>stats</b> package, but with a modified default fitting method. The method provides greater stability for models that may fail to converge using <code>glm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm2(formula, family = gaussian, data, weights, subset, na.action, 
     start = NULL, etastart, mustart, offset, control = list(...), 
     model = TRUE, method = "glm.fit2", x = FALSE, y = TRUE, 
     singular.ok = TRUE, contrasts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etastart</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mustart</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>as for <code>glm</code> except by default <code>control</code> is passed to <code>glm.fit2</code> instead of <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>as for <code>glm</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>the method used in fitting the model. The default method <code>"glm.fit2"</code> uses iteratively reweighted least squares with 
modified step-halving that forces the deviance to decrease at each iteration; see help documentation for <code>glm.fit2</code>. As in <code>glm</code>, the alternative method <code>"model.frame"</code> returns the model frame and does no fitting.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>

<p>as for <code>glm</code>. NB this is ignored (and defaults to <code>TRUE</code>) for R versions &lt; 3.5.0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>as for <code>glm</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>glm2</code> is a modified version of <code>glm</code> in the <b>stats</b> package. It fits generalized linear models using the same model specification as <code>glm</code>. It is identical to <code>glm</code> except for minor modifications to change the default fitting method. The default method uses a stricter form of step-halving to force the deviance to decrease at each iteration and is implemented in <code>glm.fit2</code>. Like <code>glm</code>, user-supplied fitting functions can be used with <code>glm2</code> by passing a function or a character string naming a function to the <code>method</code> argument. See Marschner (2011) for a discussion of the need for a modified fitting method. 
</p>


<h3>Value</h3>

<p>The value returned by <code>glm2</code> has exactly the same documentation as the value returned by <code>glm</code>, except for:
</p>
<table><tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>the name of the fitter function used, which by default is <code>"glm.fit2"</code>.
</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p><code>glm2</code> uses the code from <code>glm</code>, whose authors are listed in the help documentation for the <b>stats</b> package. Modifications to this code were made by Ian Marschner.
</p>


<h3>References</h3>

<p>Marschner, I.C. (2011) glm2: Fitting generalized linear models with convergence problems. The R Journal, Vol. 3/2, pp.12-15.
</p>


<h3>See Also</h3>

<p><code>glm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(glm2)
data(crabs)
data(heart)

#==========================================================
# EXAMPLE 1: logistic regression null model
# (behaviour of glm and glm2 for different starting values)
#==========================================================

y &lt;- c(1,1,1,0)
# intercept estimate = log(0.75/0.25) = 1.098612

#--- identical behaviour ---#
fit1 &lt;- glm(y ~ 1, family=binomial(link="logit"),
	control=glm.control(trace=TRUE))
fit2 &lt;- glm2(y ~ 1, family=binomial(link="logit"),
	control=glm.control(trace=TRUE))
print.noquote(c(fit1$coef,fit2$coef))

#--- convergence via different paths ---#
fit1 &lt;- glm(y ~ 1, family=binomial(link="logit"),start=-1.75,
	control=glm.control(trace=TRUE))
fit2 &lt;- glm2(y ~ 1, family=binomial(link="logit"),start=-1.75,
	control=glm.control(trace=TRUE))
print.noquote(c(fit1$coef,fit2$coef))

#--- divergence of glm to infinite estimate ---#
fit1 &lt;- glm(y ~ 1, family=binomial(link="logit"),start=-1.81)
fit2 &lt;- glm2(y ~ 1, family=binomial(link="logit"),start=-1.81)
print.noquote(c(fit1$coef,fit2$coef))


#=======================================================================
# EXAMPLE 2: identity link Poisson (successful boundary convergence
# using 4 identical approaches in glm and glm2 with the method argument) 
#=======================================================================

satellites &lt;- crabs$Satellites
width.shifted &lt;- crabs$Width - min(crabs$Width)
dark &lt;- crabs$Dark
goodspine &lt;- crabs$GoodSpine

fit1 &lt;- glm(satellites ~ width.shifted + factor(dark) + factor(goodspine), 
 family = poisson(link="identity"), start = rep(1,4))

fit2 &lt;- glm2(satellites ~ width.shifted + factor(dark) + factor(goodspine), 
 family = poisson(link="identity"), start = rep(1,4))

fit1.eq &lt;- glm2(satellites ~ width.shifted + factor(dark) + factor(goodspine), 
 family = poisson(link="identity"), start = rep(1,4), method = "glm.fit")

fit2.eq &lt;- glm(satellites ~ width.shifted + factor(dark) + factor(goodspine), 
 family = poisson(link="identity"), start = rep(1,4), method = "glm.fit2")

noquote(c("deviances: ",fit1$dev,fit2$dev,fit1.eq$dev,fit2.eq$dev))
noquote(c("converged: ",fit1$conv,fit2$conv,fit1.eq$conv,fit2.eq$conv))
noquote(c("boundary:  ",fit1$bound,fit2$bound,fit1.eq$bound,fit2.eq$bound))

#===================================================================
# EXAMPLE 3: identity link Poisson (periodic non-convergence in glm)
#===================================================================

R1 &lt;- crabs$Rep1
satellites &lt;- crabs$Satellites[R1]
width.shifted &lt;- crabs$Width[R1] - min(crabs$Width)
dark &lt;- crabs$Dark[R1]
goodspine &lt;- crabs$GoodSpine[R1]

fit1 &lt;- glm(satellites ~ width.shifted + factor(dark) + factor(goodspine), 
 family = poisson(link="identity"), start = rep(1,4), 
 control = glm.control(trace=TRUE))

fit2 &lt;- glm2(satellites ~ width.shifted + factor(dark) + factor(goodspine), 
 family = poisson(link="identity"), start = rep(1,4), 
 control = glm.control(trace=TRUE))

noquote(c("deviances: ",fit1$dev,fit2$dev))
noquote(c("converged: ",fit1$conv,fit2$conv))

#===============================================================
# EXAMPLE 4: log link binomial (periodic non-convergence in glm)
#===============================================================

patients &lt;- heart$Patients
deaths &lt;- heart$Deaths
agegroup &lt;- heart$AgeGroup
severity &lt;-heart$Severity
delay &lt;- heart$Delay
region &lt;- heart$Region
start.p &lt;- sum(deaths)/sum(patients)

fit1 &lt;- glm(cbind(deaths,patients-deaths) ~ factor(agegroup) + factor(severity)
 + factor(delay) + factor(region), family = binomial(link="log"), 
 start = c(log(start.p), rep(0,8)), control = glm.control(trace=TRUE,maxit=100))

fit2 &lt;- glm2(cbind(deaths,patients-deaths) ~ factor(agegroup) + factor(severity)
 + factor(delay) + factor(region), family = binomial(link="log"), 
 start = c(log(start.p), rep(0,8)), control = glm.control(trace=TRUE))

noquote(c("deviances: ",fit1$dev,fit2$dev))
noquote(c("converged: ",fit1$conv,fit2$conv))

#====================================================================
# EXAMPLE 5: identity link Poisson (aperiodic non-convergence in glm)
#====================================================================

R2 &lt;- crabs$Rep2
satellites &lt;- crabs$Satellites[R2]
width.shifted &lt;- crabs$Width[R2] - min(crabs$Width)
dark &lt;- crabs$Dark[R2]
goodspine &lt;- crabs$GoodSpine[R2]

fit1 &lt;- glm(satellites ~ width.shifted + factor(dark) + factor(goodspine), 
 family = poisson(link="identity"), start = rep(1,4), 
 control = glm.control(trace=TRUE))

fit2 &lt;- glm2(satellites ~ width.shifted + factor(dark) + factor(goodspine), 
 family = poisson(link="identity"), start = rep(1,4), 
 control = glm.control(trace=TRUE))

noquote(c("deviances: ",fit1$dev,fit2$dev))
noquote(c("converged: ",fit1$conv,fit2$conv))

</code></pre>


</div>