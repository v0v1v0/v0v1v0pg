<div class="container">

<table style="width: 100%;"><tr>
<td>prepare_orthogonal_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare orthogonal matrix</h2>

<h3>Description</h3>

<p>Calculate the orthogonal matrix <code>U_Gamma</code> for decomposition in
<a href="https://arxiv.org/abs/2004.03503">Theorem 1 from references</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prepare_orthogonal_matrix(perm, perm_size = NULL, basis = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>
<p>An object of a <code>gips_perm</code> or anything
a <code>gips_perm()</code> can handle. It can also be of a <code>gips</code> class,
but it will be interpreted as the underlying <code>gips_perm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm_size</code></td>
<td>
<p>Size of a permutation.
Required if <code>perm</code> is neither <code>gips_perm</code> nor <code>gips</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>A matrix with basis vectors in COLUMNS. Identity by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given X - a matrix invariant under the permutation <code>perm</code>. Call Gamma
the permutations cyclic group: <code class="reqn">\Gamma = &lt;perm&gt; = \{perm, perm^2, ...\}</code>.
</p>
<p>Then, <code class="reqn">U_\Gamma</code> is such an orthogonal matrix, which block-diagonalizes X.
</p>
<p>To be more precise, the matrix <code>t(U_Gamma) %*% X %*% U_Gamma</code> has a
block-diagonal structure, which is ensured by
<a href="https://arxiv.org/abs/2004.03503">Theorem 1 from references</a>.
</p>
<p>The formula for <code>U_Gamma</code> can be found in
<a href="https://arxiv.org/abs/2004.03503">Theorem 6 from references</a>.
</p>
<p>A nice example is demonstrated in the <strong>Block Decomposition - [1], Theorem 1</strong>
section of <code>vignette("Theory", package="gips")</code> or its
<a href="https://przechoj.github.io/gips/articles/Theory.html">pkgdown page</a>.
</p>


<h3>Value</h3>

<p>A square matrix of size <code>perm_size</code> by <code>perm_size</code> with
columns from vector elements <code class="reqn">v_k^{(c)}</code> according to
<a href="https://arxiv.org/abs/2004.03503">Theorem 6 from references</a>.
</p>


<h3>References</h3>

<p>Piotr Graczyk, Hideyuki Ishi, Bartosz Kołodziejek, Hélène Massam.
"Model selection in the space of Gaussian models invariant by symmetry."
The Annals of Statistics, 50(3) 1747-1774 June 2022.
<a href="https://arxiv.org/abs/2004.03503">arXiv link</a>;
<a href="https://doi.org/10.1214/22-AOS2174">doi:10.1214/22-AOS2174</a>
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>project_matrix()</code> - A function used in examples
to show the properties of <code>prepare_orthogonal_matrix()</code>.
</p>
</li>
<li> <p><strong>Block Decomposition - [1], Theorem 1</strong> section of
<code>vignette("Theory", package = "gips")</code> or its
<a href="https://przechoj.github.io/gips/articles/Theory.html">pkgdown page</a> -
A place to learn more about the math behind the <code>gips</code> package
and see more examples of <code>prepare_orthogonal_matrix()</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">gperm &lt;- gips_perm("(1,2,3)(4,5)", 5)
U_Gamma &lt;- prepare_orthogonal_matrix(gperm)

number_of_observations &lt;- 10
X &lt;- matrix(rnorm(5 * number_of_observations), number_of_observations, 5)
S &lt;- cov(X)
X &lt;- project_matrix(S, perm = gperm) # this matrix in invariant under gperm

block_decomposition &lt;- t(U_Gamma) %*% X %*% U_Gamma
round(block_decomposition, 5) # the non-zeros only on diagonal and [1,2] and [2,1]
</code></pre>


</div>