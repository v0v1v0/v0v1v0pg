<div class="container">

<table style="width: 100%;"><tr>
<td>weighted.median</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Median and Quantiles</h2>

<h3>Description</h3>

<p>Compute the median or quantiles a set of numbers which have weights
associated with them.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weighted.median(x, w, na.rm = TRUE, type = 2)

weighted.quantile(x, w, probs = seq(0, 1, 0.25), na.rm = TRUE, type = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a numeric vector of weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>a logical indicating whether to ignore <code>NA</code> values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Integer specifying the rule for calculating the median or
quantile, corresponding to the rules available for <code>stats:quantile()</code>.
The only valid choices are type=1, 2 or 4. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>probabilities for which the quantiles should be computed, a
numeric vector of values between 0 and 1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>i</code>th observation <code>x[i]</code> is treated as having a weight proportional to
<code>w[i]</code>.
</p>
<p>The weighted median is a value <code>m</code> such that the total weight of data less
than or equal to <code>m</code> is equal to half the total weight. More generally, the
weighted quantile with probability <code>p</code> is a value <code>q</code> such that the total
weight of data less than or equal to <code>q</code> is equal to <code>p</code> times the total
weight.
</p>
<p>If there is no such value, then
</p>

<ul>
<li>
<p> if <code>type = 1</code>, the next largest value is returned (this is the
right-continuous inverse of the left-continuous cumulative distribution
function);
</p>
</li>
<li>
<p> if <code>type = 2</code>, the average of the two surrounding values is returned
(the average of the right-continuous and left-continuous inverses);
</p>
</li>
<li>
<p> if <code>type = 4</code>, linear interpolation is performed.
</p>
</li>
</ul>
<p>Note that the default rule for <code>weighted.median()</code> is <code>type = 2</code>, consistent
with the traditional definition of the median, while the default for
<code>weighted.quantile()</code> is <code>type = 4</code>.
</p>


<h3>Value</h3>

<p>A numeric vector.
</p>


<h3>Source</h3>

<p>These functions are adapted from their homonyms developed by Adrian
Baddeley in the <code>spatstat</code> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- 1:20
w &lt;- runif(20)
weighted.median(x, w)
weighted.quantile(x, w)
</code></pre>


</div>