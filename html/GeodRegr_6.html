<div class="container">

<table style="width: 100%;"><tr>
<td>geo_reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gradient descent for (robust) geodesic regression</h2>

<h3>Description</h3>

<p>Finds <code class="reqn">\mathrm{argmin}_{(p,V)\in M\times (T_pM) ^ n}\sum_{i=1} ^ {N}
\rho(d(\mathrm{Exp}(p,Vx_i),y_i))</code> through a gradient descent algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">geo_reg(
  manifold,
  x,
  y,
  estimator,
  c = NULL,
  p_tol = 1e-05,
  V_tol = 1e-05,
  max_iter = 1e+05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>manifold</code></td>
<td>
<p>Type of manifold (<code>'euclidean'</code>, <code>'sphere'</code>,
<code>'hyperbolic'</code>, or <code>'kendall'</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector, matrix, or data frame of independent variables; for
matrices and data frames, the rows and columns represent the subjects and
independent variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix or data frame whose columns represent points on the
manifold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>M-type estimator (<code>'l2'</code>, <code>'l1'</code>, <code>'huber'</code>,
or <code>'tukey'</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>Multiplier of <code class="reqn">\sigma</code>, the square root of the variance, used in
the cutoff parameter for the <code>'huber'</code> and <code>'tukey'</code> estimators;
should be <code>NULL</code> for the <code>'l2'</code> or <code>'l1'</code> estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_tol</code></td>
<td>
<p>Termination condition for the distance between consecutive
updates of <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V_tol</code></td>
<td>
<p>Termination condition for the distance between columns of
consecutive updates of <code>V</code>, parallel transported to be in the same
tangent space. Can be a vector of positive real numbers for each
independent variable or a single positive number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of gradient descent steps before ending the
algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each column of <code>x</code> should be centered to have an average of 0 for the
quickest and most accurate results. If all of the elements of a column of
<code>x</code> are equal, the resulting vector will consist of <code>NA</code>s. In the
case of the <code>'sphere'</code>, an error will be raised if all points are on a
pair of antipodes.
</p>


<h3>Value</h3>

<p>A named list containing </p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector representing the estimate
of the initial point on the manifold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>a matrix representing the
estimate of the initial velocities for each independent variable; the
columns represent the independent variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>number of
gradient descent steps taken.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ha-Young Shin
</p>


<h3>References</h3>

<p>Fletcher, P. T. (2013). Geodesic regression and the theory of
least squares on Riemannian manifolds. International Journal of Computer
Vision, 105, 171-185.
</p>
<p>Kim, H. J., Adluru, N., Collins, M. D., Chung, M. K., Bendin, B. B.,
Johnson, S. C., Davidson, R. J. and Singh, V. (2014). Multivariate general
linear models (MGLM) on Riemannian manifolds with applications to
statistical analysis of diffusion weighted images. 2014 IEEE Conference on
Computer Vision and Pattern Recognition, 2705-2712.
</p>
<p>Shin, H.-Y. and Oh H.-S. (2020). Robust Geodesic Regression.
&lt;arXiv:2007.04518&gt;
</p>


<h3>See Also</h3>

<p><code>intrinsic_location</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># an example of multiple regression with two independent variables, with 64
# data points

x &lt;- matrix(runif(2 * 64), ncol = 2)
x &lt;- t(t(x) - colMeans(x))
y &lt;- matrix(0L, nrow = 4, ncol = 64)
for (i in 1:64) {
  y[, i] &lt;- exp_map('sphere', c(1, 0, 0, 0), c(0, runif(1), runif(1),
      runif(1)))
}
geo_reg('sphere', x, y, 'tukey', c = are_nr('tukey', 2, 6))

</code></pre>


</div>