<div class="container">

<table style="width: 100%;"><tr>
<td>envelope.glm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normal QQ-plot with simulated envelope of residuals in Generalized Linear Models</h2>

<h3>Description</h3>

<p>Produces a normal QQ-plot with simulated envelope of residuals for generalized linear models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'glm'
envelope(
  object,
  rep = 25,
  conf = 0.95,
  type = c("quantile", "deviance", "pearson"),
  standardized = FALSE,
  plot.it = TRUE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of the class <em>glm</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>an (optional) positive integer which allows to specify the number of replicates which should be used to build the simulated envelope. As default, <code>rep</code> is set to 25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>an (optional) value in the interval (0,1) indicating the confidence level which should be used to build the pointwise confidence intervals, which form the envelope. As default, <code>conf</code> is set to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an (optional) character string indicating the type of residuals which should be used. The available options are: randomized quantile ("quantile"), deviance ("deviance") and pearson ("pearson") residuals. As default, <code>type</code> is set to "quantile".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardized</code></td>
<td>
<p>an (optional) logical switch indicating if the residuals should be standardized by dividing by the square root of <code class="reqn">(1-h)</code>, where <code class="reqn">h</code> is a measure of leverage. As default, <code>standardized</code> is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the normal QQ-plot with simulated envelope of residuals is required or just the data matrix in which it is based. As default, <code>plot.it</code> is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identify</code></td>
<td>
<p>an (optional) positive integer indicating the number of individuals to identify on the QQ-plot with simulated envelope of residuals. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example,  <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In order to construct the simulated envelope, <code>rep</code> independent realizations of the response variable for each individual are simulated, which is
done by considering (1) the model assumption about the distribution of the response variable; (2) the estimation of the linear predictor parameters; and (3)
the estimation of the dispersion parameter. Each time, the vector of observed responses is replaced with one of the simulated samples, re-fitting the interest
model <code>rep</code> times. For each <code class="reqn">i=1,2,...,n</code>, where <code class="reqn">n</code> is the number of individuals in the sample, the <code class="reqn">i</code>-th order statistic of the
<code>type</code>-type residuals is computed and then sorted for each replicate, giving a random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order statistic. In
other words, the simulated envelope is comprised of the quantiles (1 - <code>conf</code>)/2 and (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the
<code class="reqn">i</code>-th order statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>.
</p>


<h3>Value</h3>

<p>A matrix with the following four columns:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>Lower limit</code> </td>
<td style="text-align: left;"> the quantile (1 - <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
<td style="text-align: left;">
                   </td>
<td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Median</code> </td>
<td style="text-align: left;"> the quantile 0.5 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Upper limit</code> </td>
<td style="text-align: left;"> the quantile (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
<td style="text-align: left;">
                   </td>
<td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Residuals</code> </td>
<td style="text-align: left;"> the observed <code>type</code>-type residuals,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Atkinson A.C. (1985) <em>Plots, Transformations and Regression</em>. Oxford University Press, Oxford.
</p>
<p>Davison A.C., Gigli A. (1989) Deviance Residuals and Normal Scores Plots. <em>Biometrika</em> 76, 211-221.
</p>
<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em> 5, 236-244.
</p>
<p>Pierce D.A., Schafer D.W. (1986) Residuals in Generalized Linear Models. <em>Journal of the American Statistical Association</em> 81, 977-986.
</p>
<p>Wei B.C. (1998). <em>Exponential Family Nonlinear Models</em>. Springer, Singapore.
</p>


<h3>See Also</h3>

<p>envelope.lm, envelope.gnm, envelope.overglm
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example 1:
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
fit1 &lt;- glm(death ~ age*inh_inj + tbsa*inh_inj, family=binomial("logit"), data=burn1000)
envelope(fit1, rep=50, conf=0.95, type="pearson", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Fuel consumption of automobiles
Auto &lt;- ISLR::Auto
fit2 &lt;- glm(mpg ~ horsepower*weight, family=inverse.gaussian("log"), data=Auto)
envelope(fit2, rep=50, conf=0.95, type="pearson", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Skin cancer in women
data(skincancer)
fit3 &lt;- glm(cases ~ city + ageC, offset=log(population), family=poisson, data=skincancer)
envelope(fit3, rep=100, conf=0.95, type="quantile", col="red", pch=20,col.lab="blue",
         col.axis="blue",col.main="black",family="mono",cex=0.8)

###### Example 4: Self diagnozed ear infections in swimmers
data(swimmers)
fit4 &lt;- glm(infections ~ frequency + location, family=poisson(log), data=swimmers)
envelope(fit4, rep=100, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 5: Agents to stimulate cellular differentiation
data(cellular)
fit5 &lt;- glm(cbind(cells,200-cells) ~ tnf + ifn, family=binomial(logit), data=cellular)
envelope(fit5, rep=100, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>


</div>