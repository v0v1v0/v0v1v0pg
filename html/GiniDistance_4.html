<div class="container">

<table style="width: 100%;"><tr>
<td>dCor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distance Covariance and Correlation Statistics</h2>

<h3>Description</h3>

<p>Computes distance covariance and correlation statistics, in which Xs are quantitative and Ys are categorical and return the measures of dependence.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">  dCor(x, y, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> label of data or univariate response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> exponent on Euclidean distance, in (0,2]</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample size (number of rows) of the data must agree with the length of the label vector, and samples must not contain missing values. Arguments
<code>x</code>, <code>y</code> are treated as data and labels.
</p>
<p><code>dCor</code> calls <code>dcor</code> function from energy package which computes the distance correlation between X and Y where both are numerical variables. If Y is categorical,  the set difference metric on the support of <code class="reqn">Y</code> is used. That is, <code class="reqn">d(y, y^\prime) =|y-y^\prime|:=  I(y\neq y^\prime),</code>
where <code class="reqn">I (\cdot)</code> is the indicator function. Then the sample distance correlation between data and labels is computed as follows. 
</p>
<p>Let <code class="reqn">A=(a_{ij})</code> be a symmetric, <code class="reqn">n \times n</code>, centered distance matrix of sample <code class="reqn">\mathbf x_1,\cdots, \mathbf x_n</code>. The <code class="reqn">(i,j)</code>-th entry of <code class="reqn">A</code> is <code class="reqn">a_{ij}-\frac{1}{n-2}a_{i\cdot}-\frac{1}{n-2}a_{\cdot j} + \frac{1}{(n-1)(n-2)}a_{\cdot \cdot}</code> if <code class="reqn">i \neq j</code> and 0 if <code class="reqn">i=j</code>,
where <code class="reqn">a_{ij} = \|\mathbf x_i-\mathbf x_j\|^{\alpha}</code>, <code class="reqn">a_{i\cdot} = \sum_{j=1}^n a_{ij}</code>, <code class="reqn">a_{\cdot j} = \sum_{i=1}^n a_{ij}</code>, and <code class="reqn">a_{\cdot \cdot}=\sum_{i,j=1}^n a_{ij}</code>. Similarly, using the set difference metric, a symmetric, <code class="reqn">n \times n</code>, centered distance matrix is calculated for samples <code class="reqn">y_1,\cdots, y_n</code> and denoted by <code class="reqn">B = (b_{ij})</code>. Unbiased estimators of <code class="reqn">\mbox{dCov}(\mathbf X,Y;\alpha)</code>, <code class="reqn">\mbox{dCov}(\mathbf X, \mathbf X;\alpha)</code> and <code class="reqn">\mbox{dCov}(\mathbf Y, \mathbf Y;\alpha)</code>  are given  respectively as,  <code class="reqn">\frac{1}{n(n-3)}\sum_{i\ne j}A_{ij}B_{ij}</code>, <code class="reqn">\frac{1}{n(n-3)}\sum_{i\ne j}A_{ij}^2</code> and <code class="reqn">\frac{1}{n(n-3)}\sum_{i\ne j}B_{ij}^2</code>. Then the distance correlation is 
</p>
<p style="text-align: center;"><code class="reqn">{dCor}(\mathbf{X}, Y; \alpha) = \frac{\mbox{ dCov}(\mathbf{X}, Y, \alpha)}{ \sqrt{\mbox{ dCov}(\mathbf{X},\mathbf{X};\alpha)} \sqrt{\mbox{ dCov}(Y,Y)}}.</code>
</p>



<h3>Value</h3>

<p><code>dCor</code> returns the sample distance variance of <code>x</code>, distance variance of <code>y</code>, distance covariance of <code>x</code> and <code>y</code> and distance correlation of <code>x</code>, <code>y</code>. 
</p>


<h3>References</h3>

<p>Lyons, R. (2013). Distance covariance in metric spaces. The Annals of Probability, 41 (5), 3284-3305. 
</p>
<p>Szekely, G. J., Rizzo, M. L. and Bakirov, N. (2007). Measuring and testing dependence by correlation of distances. Annals of Statistics, 35 (6), 2769-2794. 
</p>
<p>Rizzo, M.L. and Szekely, G.J., (2017). Energy: E-Statistics: Multivariate Inference via the Energy of Data (R Package), Version 1.7-0.
</p>


<h3>See Also</h3>

<p><code>dCov</code>  <code>KdCov</code>  <code>KdCor</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">  x &lt;- iris[,1:4]
  y &lt;- unclass(iris[,5])
  dCor(x, y, alpha = 1)
</code></pre>


</div>