<div class="container">

<table style="width: 100%;"><tr>
<td>convol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kernel convolution</h2>

<h3>Description</h3>

<p>Calculates the convolution of data with a kernel function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">convol(x, h = 1, grid = NULL, y = 1, w = 1, p = 2, q = 2,
       product = TRUE, sort = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>n x d matrix, data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>scalar or 1 x d, bandwidth(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>m x d matrix, where to calculate the convolution (default = x)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>n x c matrix, optional responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>scalar or  n x 1 or 1 x m or n x m, optional weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer or text, see <code>kernel.function</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>integer, see <code>kernel.function</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>product</code></td>
<td>
<p>(if d&gt;1) product or spherical kernel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>logical, TRUE if data need to be sorted</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The kernel convolution which is calculated is
<code class="reqn">\sum_i K_h(x_i - grid_{j})\,y_i\,w_{ij}</code> for
<code class="reqn">i=1,...,n</code> and <code class="reqn">j=1,...,m</code>. The kernel function is determined
by the kernel parameters p and q, see
<code>kernel.function</code>. The default kernel is the biweight
(quartic) kernel function.   Note that the DLL requires the data matrix
to be sorted by its first column.
</p>


<h3>Value</h3>

<p>m x c matrix
</p>


<h3>Author(s)</h3>

<p>Marlene Mueller</p>


<h3>See Also</h3>

<p><code>kernel.function</code>, <code>kde</code>, <code>kreg</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  n &lt;- 100
  x &lt;- rnorm(n)
  convol(x,h=0.8,grid=-3:3)/n  ## estimates density of x at points -3:3
</code></pre>


</div>