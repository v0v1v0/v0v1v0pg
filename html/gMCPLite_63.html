<div class="container">

<table style="width: 100%;"><tr>
<td>hGraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create multiplicity graphs using ggplot2</h2>

<h3>Description</h3>

<p>Plots a multiplicity graph defined by user inputs.
The graph can also be used with the gMCP package to evaluate a set of
nominal p-values for the tests of the hypotheses in the graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hGraph(
  nHypotheses = 4,
  nameHypotheses = paste("H", (1:nHypotheses), sep = ""),
  alphaHypotheses = 0.025/nHypotheses,
  m = matrix(array(1/(nHypotheses - 1), nHypotheses^2), nrow = nHypotheses) -
    diag(1/(nHypotheses - 1), nHypotheses),
  fill = 1,
  palette = grDevices::gray.colors(length(unique(fill)), start = 0.5, end = 0.8),
  labels = LETTERS[1:length(unique(fill))],
  legend.name = " ",
  legend.position = "none",
  halfWid = 0.5,
  halfHgt = 0.5,
  trhw = 0.1,
  trhh = 0.075,
  trprop = 1/3,
  digits = 5,
  trdigits = 2,
  size = 6,
  boxtextsize = 4,
  legend.textsize = size * 2.5,
  arrowsize = 0.02,
  radianStart = if ((nHypotheses)%%2 != 0) {
     pi * (1/2 + 1/nHypotheses)
 } else
    {
     pi * (1 + 2/nHypotheses)/2
 },
  offset = pi/4/nHypotheses,
  xradius = 2,
  yradius = xradius,
  x = NULL,
  y = NULL,
  wchar = "\u03b1"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nHypotheses</code></td>
<td>
<p>number of hypotheses in graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nameHypotheses</code></td>
<td>
<p>hypothesis names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaHypotheses</code></td>
<td>
<p>alpha-levels or weights for ellipses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>square transition matrix of dimension 'nHypotheses'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>grouping variable for hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>colors for groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>text labels for groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.name</code></td>
<td>
<p>text for legend header</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>text string or x,y coordinates for legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>halfWid</code></td>
<td>
<p>half width of ellipses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>halfHgt</code></td>
<td>
<p>half height of ellipses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trhw</code></td>
<td>
<p>transition box width</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trhh</code></td>
<td>
<p>transition box height</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trprop</code></td>
<td>
<p>proportion of transition arrow length where transition box is placed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of digits to show for alphaHypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trdigits</code></td>
<td>
<p>digits displayed for transition weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>text size in ellipses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxtextsize</code></td>
<td>
<p>transition text size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.textsize</code></td>
<td>
<p>legend text size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrowsize</code></td>
<td>
<p>size of arrowhead for transition arrows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radianStart</code></td>
<td>
<p>radians from origin for first ellipse; nodes spaced equally in clockwise order with centers on an ellipse by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>rotational offset in radians for transition weight arrows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xradius</code></td>
<td>
<p>horizontal ellipse diameter on which ellipses are drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yradius</code></td>
<td>
<p>vertical ellipse diameter on which ellipses are drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x coordinates for hypothesis ellipses if elliptical arrangement is not wanted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>y coordinates for hypothesis ellipses if elliptical arrangement is not wanted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wchar</code></td>
<td>
<p>character for alphaHypotheses in ellipses; defaults to the Unicode escape sequence <code>\u03b1</code> (Greek letter alpha).
See <a href="https://en.wikipedia.org/wiki/List_of_Unicode_characters">list of Unicode characters</a> for a more comprehensive character list.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See vignette **Multiplicity graphs formatting using ggplot2**
for explanation of formatting.
</p>


<h3>Value</h3>

<p>A 'ggplot' object with a multi-layer multiplicity graph
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Use Cairo PDF device for better Unicode character support
# when checking the package. Needed for R &gt;= 4.4.0.
if (names(dev.cur()) == "pdf") {
  fn &lt;- attr(.Device, "filepath")
  fn0 &lt;- "gMCPLite-Ex.pdf"
  if (!is.null(fn) &amp;&amp; fn == fn0) {
    dv &lt;- cairo_pdf(fn0)
    on.exit(dev.off(dv), add = TRUE)
  }
}

# Defaults: note clockwise ordering
hGraph(5)
# Add colors (default is 3 gray shades)
hGraph(3,fill=1:3)
# Colorblind palette
cbPalette &lt;- c("#999999", "#E69F00", "#56B4E9", "#009E73",
               "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
hGraph(6,fill=as.factor(1:6),palette=cbPalette)
# Use a hue palette
hGraph(4,fill=factor(1:4),palette=scales::hue_pal(l=75)(4))
# different alpha allocation, hypothesis names and transitions
alphaHypotheses &lt;- c(.005,.007,.013)
nameHypotheses &lt;- c("ORR","PFS","OS")
m &lt;- matrix(c(0,1,0,
              0,0,1,
              1,0,0),nrow=3,byrow=TRUE)
hGraph(3,alphaHypotheses=alphaHypotheses,nameHypotheses=nameHypotheses,m=m)
# Custom position and size of ellipses, change text to multi-line text
# Adjust box width
# add legend in middle of plot
hGraph(3,x=sqrt(0:2),y=c(1,3,1.5),size=6,halfWid=.3,halfHgt=.3, trhw=0.6,
       palette=cbPalette[2:4], fill = c(1, 2, 2),
       legend.position = c(.6,.5), legend.name = "Legend:", labels = c("Group 1", "Group 2"),
       nameHypotheses=c("H1:\n Long name","H2:\n Longer name","H3:\n Longest name"))

</code></pre>


</div>