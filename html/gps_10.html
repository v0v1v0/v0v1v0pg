<div class="container">

<table style="width: 100%;"><tr>
<td>GramBS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Gram matrix of B-splines
</h2>

<h3>Description</h3>

<p>Compute the Gram matrix <code class="reqn">\bm{G}</code>, i.e., the matrix of inner products between B-splines <code class="reqn">b_1(x), b_2(x), \ldots</code>. Precisely, its element is <code class="reqn">G_{uv} = \int b_u(x)b_v(x)\textrm{d}x</code>. Such matrix is useful for estimating functional linear models.
</p>
<p>The Gram matrix of differentiated B-splines gives the derivative penalty matrix <code class="reqn">\bm{S}</code> for O-splines. Precisely, its element is <code class="reqn">S_{uv} = \int b_u^{(m)}(x)b_v^{(m)}(x)\textrm{d}x</code>. Such matrix is straightforward to compute using the results of <code>SparseD</code>; see Examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GramBS(xt, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xt</code></td>
<td>
<p>full knot sequence for ordinary B-splines (<code>length(xt) &gt;= 2 * d</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>B-spline order (<code class="reqn">d \ge 2</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A sparse matrix of "dsCMatrix" class.
</p>


<h3>Author(s)</h3>

<p>Zheyuan Li <a href="mailto:zheyuan.li@bath.edu">zheyuan.li@bath.edu</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(gps)
require(Matrix)

## 11 domain knots at equal quantiles of Beta(3, 3) distribution
xd &lt;- qbeta(seq.int(0, 1, by = 0.1), 3, 3)
## full knots (with clamped boundary knots) for constructing cubic B-splines
xt &lt;- c(0, 0, 0, xd, 1, 1, 1)
## compute Gram matrix of B-splines
G &lt;- GramBS(xt, d = 4)
round(G, digits = 3)

## Gram matrix of differentiated B-splines, i.e., a derivative penalty matrix
## compute derivative penalty matrices of all orders (m = NULL in SparseD)
D &lt;- SparseD(xt, d = 4, gps = FALSE)
S &lt;- lapply(D, crossprod)
lapply(S, round, digits = 1)
</code></pre>


</div>