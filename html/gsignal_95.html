<div class="container">

<table style="width: 100%;"><tr>
<td>filter.sgolayFilter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Savitzky-Golay filtering</h2>

<h3>Description</h3>

<p>Filter a signal with a Savitzky-Golay FIR filter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'sgolayFilter'
filter(filt, x, ...)

sgolayfilt(x, p = 3, n = p + 3 - p%%2, m = 0, ts = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filt</code></td>
<td>
<p>Filter characteristics, usually the result of a call to
<code>sgolay</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the input signal to be filtered, specified as a vector or as a
matrix. If <code>x</code> is a matrix, each column is filtered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments (ignored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Polynomial filter order; must be smaller than <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Filter length; must a an odd positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Return the m-th derivative of the filter coefficients. Default: 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>Scaling factor. Default: 1</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Savitzky-Golay smoothing filters are typically used to "smooth out" a noisy
signal whose frequency span (without noise) is large. They are also called
digital smoothing polynomial filters or least-squares smoothing filters.
Savitzky-Golay filters perform better in some applications than standard
averaging FIR filters, which tend to filter high-frequency content along with
the noise. Savitzky-Golay filters are more effective at preserving high
frequency signal components but less successful at rejecting noise.
</p>
<p>Savitzky-Golay filters are optimal in the sense that they minimize the
least-squares error in fitting a polynomial to frames of noisy data.
</p>


<h3>Value</h3>

<p>The filtered signal, of the same dimensions as the input signal.
</p>


<h3>Author(s)</h3>

<p>Paul Kienzle, <a href="mailto:pkienzle@users.sf.net">pkienzle@users.sf.net</a>.<br>
Conversion to R Tom Short,<br>
adapted by Geert van Boxtel, <a href="mailto:G.J.M.vanBoxtel@gmail.com">G.J.M.vanBoxtel@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code>sgolay</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compare a 5 sample averager, an order-5 butterworth lowpass
# filter (cutoff 1/3) and sgolayfilt(x, 3, 5), the best cubic
# estimated from 5 points.
bf &lt;- butter(5, 1/3)
x &lt;- c(rep(0, 15), rep(10, 10), rep(0, 15))
sg &lt;- sgolayfilt(x)
plot(sg, type="l", xlab = "", ylab = "")
lines(filtfilt(rep(1, 5) / 5, 1, x), col = "red") # averaging filter
lines(filtfilt(bf, x), col = "blue")              # butterworth
points(x, pch = "x")                              # original data
legend("topleft", c("sgolay (3,5)", "5 sample average", "order 5
Butterworth", "original data"), lty=c(1, 1, 1, NA),
pch = c(NA, NA, NA, "x"), col = c(1, "red", "blue", 1))

</code></pre>


</div>