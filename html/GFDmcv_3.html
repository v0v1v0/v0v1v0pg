<div class="container">

<table style="width: 100%;"><tr>
<td>GFDmcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inference for four multivariate coefficients of variation</h2>

<h3>Description</h3>

<p>The function <code>GFDmcv()</code> calculates the Wald-type statistic for global null hypotheses 
and max-type statistics for multiple local null hypotheses, both in terms of the four variants 
of the multivariate coefficient of variation. Respective <code class="reqn">p</code>-values
are obtained by a <code class="reqn">\chi^2</code>-approximation, a pooled bootstrap strategy and a pooled permutation approach (only for the
Wald-type statistic), respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GFDmcv(
  x,
  h_mct,
  h_wald,
  alpha = 0.05,
  n_perm = 1000,
  n_boot = 1000,
  parallel = FALSE,
  n_cores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of length <code class="reqn">k</code> with elements being <code class="reqn">n_i\times d</code> matrices of data, <code class="reqn">i=1,\dots,k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_mct</code></td>
<td>
<p>a <code class="reqn">r\times k</code> contrast matrix <code class="reqn">\mathbf{H}</code> of full row rank for multiple contrast tests. 
Remember to specify it correctly taking into account the order of elements of the list <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_wald</code></td>
<td>
<p>a <code class="reqn">q\times k</code> contrast matrix <code class="reqn">\mathbf{H}</code> of full row rank for the Wald-type tests. 
Remember to specify it correctly taking into account the order of elements of the list <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a significance level (then <code>1-alpha</code> is the confidence level).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_perm</code></td>
<td>
<p>a number of permutation replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_boot</code></td>
<td>
<p>a number of bootstrap replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>a logical indicating whether to use parallelization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>if <code>parallel = TRUE</code>, a number of processes used in parallel computation. 
Its default value means that it will be equal to a number of cores of a computer used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>GFDmcv()</code> calculates the Wald-type statistic for global null hypotheses of the form
</p>
<p style="text-align: center;"><code class="reqn"> \mathcal H_0: \mathbf{H} (C_1,\ldots,C_k)^\top = \mathbf{0}\,\,\text{and}\,\,\mathcal H_0: \mathbf{H} (B_1,\ldots,B_k)^\top = \mathbf{0},</code>
</p>

<p>where <code class="reqn">\mathbf{H}</code> is a contrast matrix reflecting the research question of interest and
<code class="reqn">C_i</code> (<code class="reqn">B_i</code>) are the subgroup-specific MCVs (and their reciprocal) by Reyment (1960, RR), Van Valen (1974, VV), 
Voinov and Nikulin (1996, VN) or Albert and Zhang (2010, AZ), respectively. 
We refer to the function <code>e_mcv()</code> for the detailed definitions of the different
variants. The <code class="reqn">p</code>-value of the Wald-type statistic relies on a <code class="reqn">\chi^2</code>-approximation,
a (pooled) bootstrap or permutation approach.
</p>
<p>Furthermore, the function <code>GFDmcv()</code> calculates a max-type test statistic for the multiple
comparison of <code class="reqn">q</code> local null hypotheses:
</p>
<p style="text-align: center;"><code class="reqn"> \mathcal H_{0,\ell}: \mathbf{h_\ell}^\top \mathbf{C} = \mathbf{0}\,\,
 \text{or}\,\,\mathcal H_{0,\ell}: \mathbf{h_\ell}^\top \mathbf{B} = \mathbf{0}, \,\,\ell=1,\ldots,q,</code>
</p>

<p>where <code class="reqn">\mathbf{C}=(C_1,\ldots,C_k)^\top</code> and  <code class="reqn">\mathbf{B}=(B_1,\ldots,B_k)^\top</code>. The <code class="reqn">p</code>-values are determined by a Gaussian approximation and a bootstrap approach, respectively.
In addition to the local test decisions, multiple adjusted confidence intervals for the contrasts <code class="reqn">\mathbf{h_{\ell}^{\top}\pmb{C}}</code> and
<code class="reqn">\mathbf{h_{\ell}^{\top}\pmb{B}}</code>, respectively, are calculated.
</p>
<p>Please have a look on the plot and summary functions designed for this package. They can be used
to simplify the output of <code>GFDmcv()</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>gfdmcv</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>overall_res</code></td>
<td>
<p>a list of two elements representing the results for testing
the global null hypothesis. The first one is a matrix <code>test_stat</code> of the
test statistics, while the second is a matrix <code>p_values</code> of the respective <code class="reqn">p</code>-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mct_res</code></td>
<td>
<p>all results of MCT tests for particular hypothesis in <code>h_mct</code>, i.e., 
the estimators and simultaneous confidence intervals for <code class="reqn">\mathbf{h_{\ell}^{\top}\pmb{C}}</code> and 
for <code class="reqn">\mathbf{h_{\ell}^{\top}\pmb{B}}</code>, the test statistics and critical values as well as the decisions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_mct</code></td>
<td>
<p>an argument <code>h_mct</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_wald</code></td>
<td>
<p>an argument <code>h_wald</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>an argument <code>alpha</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Albert A., Zhang L. (2010) A novel definition of the multivariate coefficient of variation. Biometrical Journal 52:667-675.
</p>
<p>Ditzhaus M., Smaga L. (2022) Permutation test for the multivariate coefficient of variation in factorial designs. 
Journal of Multivariate Analysis 187, 104848.
</p>
<p>Ditzhaus M., Smaga L. (2023) Inference for all variants of the multivariate coefficient of variation in factorial designs. Preprint https://arxiv.org/abs/2301.12009.
</p>
<p>Reyment R.A. (1960) Studies on Nigerian Upper Cretaceous and Lower Tertiary Ostracoda: part 1. 
Senonian and Maastrichtian Ostracoda, Stockholm Contributions in Geology, vol 7.
</p>
<p>Van Valen L. (1974) Multivariate structural statistics in natural history. Journal of Theoretical Biology 45:235-247.
</p>
<p>Voinov V., Nikulin M. (1996) Unbiased Estimators and Their Applications, Vol. 2, Multivariate Case. Kluwer, Dordrecht.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Some of the examples may run some time.

# one-way analysis for MCV and CV
# d &gt; 1 (MCV)
data_set &lt;- lapply(list(iris[iris$Species == "setosa", 1:3],
                        iris[iris$Species == "versicolor", 1:3],
                        iris[iris$Species == "virginica", 1:3]),
                   as.matrix)
# estimators and confidence intervals of MCVs and their reciprocals
lapply(data_set, e_mcv)
# contrast matrices
k &lt;- length(data_set)
# Tukey's contrast matrix
h_mct &lt;- contr_mat(k, type = "Tukey")
# centering matrix P_k
h_wald &lt;- contr_mat(k, type = "center")

# testing without parallel computing
res &lt;- GFDmcv(data_set, h_mct, h_wald)
summary(res, digits = 3)
oldpar &lt;- par(mar = c(4, 5, 2, 0.3))
plot(res)
par(oldpar)

# testing with parallel computing
library(doParallel)
res &lt;- GFDmcv(data_set, h_mct, h_wald, parallel = TRUE, n_cores = 2)
summary(res, digits = 3)
oldpar &lt;- par(mar = c(4, 5, 2, 0.3))
plot(res)
par(oldpar)

# two-way analysis for CV (based on the example in Ditzhaus and Smaga, 2022)
library(HSAUR)
data_set &lt;- lapply(list(BtheB$bdi.pre[BtheB$drug == "No" &amp; BtheB$length == "&lt;6m"],
                        BtheB$bdi.pre[BtheB$drug == "No" &amp; BtheB$length == "&gt;6m"],
                        BtheB$bdi.pre[BtheB$drug == "Yes" &amp; BtheB$length == "&lt;6m"],
                        BtheB$bdi.pre[BtheB$drug == "Yes" &amp; BtheB$length == "&gt;6m"]), 
                   as.matrix)
# estimators and confidence intervals of CV and its reciprocal
lapply(data_set, e_mcv)

# interaction
h_mct &lt;- contr_mat(4, type = "Tukey")
h_wald &lt;- kronecker(contr_mat(2, type = "center"), 
                    contr_mat(2, type = "center"))
res &lt;- GFDmcv(data_set, h_mct, h_wald)
summary(res, digits = 3)
oldpar &lt;- par(mar = c(4, 6, 2, 0.1))
plot(res)
par(oldpar)

# main effect drug
h_mct &lt;- matrix(c(1, 1, -1, -1), nrow = 1)
h_wald &lt;- kronecker(contr_mat(2, type = "center"), 0.5 * matrix(1, 1, 2))
res &lt;- GFDmcv(data_set, h_mct, h_wald)
summary(res, digits = 3)
oldpar &lt;- par(mar = c(4, 6, 2, 0.1))
plot(res)
par(oldpar)

# main effect length
h_mct &lt;- matrix(c(1, -1, 1, -1), nrow = 1)
h_wald &lt;- kronecker(0.5 * matrix(1, 1, 2), contr_mat(2, type = "center"))
res &lt;- GFDmcv(data_set, h_mct, h_wald)
summary(res, digits = 3)
oldpar &lt;- par(mar = c(4, 6, 2, 0.1))
plot(res)
par(oldpar)

</code></pre>


</div>