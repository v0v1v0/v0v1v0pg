<div class="container">

<table style="width: 100%;"><tr>
<td>lkjcorr_marginal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Marginal distribution of a single correlation from an LKJ distribution</h2>

<h3>Description</h3>

<p>Marginal distribution for the correlation in a single cell from a correlation
matrix distributed according to an LKJ distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dlkjcorr_marginal(x, K, eta, log = FALSE)

plkjcorr_marginal(q, K, eta, lower.tail = TRUE, log.p = FALSE)

qlkjcorr_marginal(p, K, eta, lower.tail = TRUE, log.p = FALSE)

rlkjcorr_marginal(n, K, eta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Dimension of the correlation matrix. Must be greater than or equal to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>Parameter controlling the shape of the distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code> otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length
is taken to be the number required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The LKJ distribution is a distribution over correlation matrices with a single parameter, <code class="reqn">\eta</code>.
For a given <code class="reqn">\eta</code> and a <code class="reqn">K \times K</code> correlation matrix <code class="reqn">R</code>:
</p>
<p style="text-align: center;"><code class="reqn">R \sim \textrm{LKJ}(\eta)</code>
</p>

<p>Each off-diagonal entry of <code class="reqn">R</code>, <code class="reqn">r_{ij}: i \ne j</code>, has the
following marginal distribution (Lewandowski, Kurowicka, and Joe 2009):
</p>
<p style="text-align: center;"><code class="reqn">\frac{r_{ij} + 1}{2} \sim \textrm{Beta}\left(\eta - 1 + \frac{K}{2}, \eta - 1 + \frac{K}{2}\right)
</code>
</p>

<p>In other words, <code class="reqn">r_{ij}</code> is marginally distributed according to the above Beta
distribution scaled into <code class="reqn">(-1,1)</code>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>dlkjcorr_marginal</code> gives the density
</p>
</li>
<li> <p><code>plkjcorr_marginal</code> gives the cumulative distribution function (CDF)
</p>
</li>
<li> <p><code>qlkjcorr_marginal</code> gives the quantile function (inverse CDF)
</p>
</li>
<li> <p><code>rlkjcorr_marginal</code> generates random draws.
</p>
</li>
</ul>
<p>The length of the result is determined by <code>n</code> for <code>rlkjcorr_marginal</code>, and is the maximum of the lengths of
the numerical arguments for the other functions.
</p>
<p>The numerical arguments other than <code>n</code> are recycled to the length of the result. Only the first elements
of the logical arguments are used.
</p>


<h3>References</h3>

<p>Lewandowski, D., Kurowicka, D., &amp; Joe, H. (2009). Generating random correlation matrices based on vines
and extended onion method. <em>Journal of Multivariate Analysis</em>, 100(9), 1989â€“2001.
<a href="https://doi.org/10.1016/j.jmva.2009.04.008">doi:10.1016/j.jmva.2009.04.008</a>.
</p>


<h3>See Also</h3>

<p><code>parse_dist()</code> and <code>marginalize_lkjcorr()</code> for parsing specs that use the
LKJ correlation distribution and the <code>stat_slabinterval()</code> family of stats for visualizing them.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)
library(ggplot2)

theme_set(theme_ggdist())

expand.grid(
  eta = 1:6,
  K = 2:6
) %&gt;%
  ggplot(aes(y = ordered(eta), dist = "lkjcorr_marginal", arg1 = K, arg2 = eta)) +
  stat_slab() +
  facet_grid(~ paste0(K, "x", K)) +
  scale_y_discrete(limits = rev) +
  labs(
    title = paste0(
      "Marginal correlation for LKJ(eta) prior on different matrix sizes:\n",
      "dlkjcorr_marginal(K, eta)"
    ),
    subtitle = "Correlation matrix size (KxK)",
    y = "eta",
    x = "Marginal correlation"
  ) +
  theme(axis.title = element_text(hjust = 0))

</code></pre>


</div>