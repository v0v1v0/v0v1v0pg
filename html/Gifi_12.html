<div class="container">

<table style="width: 100%;"><tr>
<td>morals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multiple Regression (MORALS). 
</h2>

<h3>Description</h3>

<p>Fits multiple regression within the Gifi framework.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">morals(x, y, xknots = knotsGifi(x, "Q"), yknots = knotsGifi(y, "Q"), xdegrees = 2, 
ydegrees = 2, xordinal = TRUE, yordinal = TRUE, xties = "s", yties = "s", xmissing = "m", 
ymissing = "m", xactive = TRUE, xcopies = 1, itmax = 1000, eps = 1e-6, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector or data frame with predictor variables (all numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector with response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xknots</code></td>
<td>
<p>Knots specification for predictors (see <code>knotsGifi</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yknots</code></td>
<td>
<p>Knots specification for response (see <code>knotsGifi</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdegrees</code></td>
<td>
<p>Degree specification for predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydegrees</code></td>
<td>
<p>Degree specification for response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xordinal</code></td>
<td>
<p>Whether predictors should be considered as ordinal or not. Alternatively, one can specify a boolean vector of length m denoting which variables should be ordinally restricted or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yordinal</code></td>
<td>
<p>Whether response should be considered as ordinal or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xties</code></td>
<td>
<p>How predictor ties should be handled: primary (<code>"p"</code>), secondary (<code>"s"</code>), or tertiary (<code>"t"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yties</code></td>
<td>
<p>How response ties should be handled: primary (<code>"p"</code>), secondary (<code>"s"</code>), or tertiary (<code>"t"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmissing</code></td>
<td>
<p>How missing predictor values should be handled: multiple (<code>"m"</code>), single (<code>"s"</code>), or average (<code>"a"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymissing</code></td>
<td>
<p>How missing response values should be handled: multiple (<code>"m"</code>), single (<code>"s"</code>), or average (<code>"a"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xactive</code></td>
<td>
<p>Which predictors should be active or inactive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcopies</code></td>
<td>
<p>Number of copies for each predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmax</code></td>
<td>
<p>Maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Convergence criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Iteration printout</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fits MORALS as described in De Leeuw et al. (2017). 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rhat</code></td>
<td>
<p>Induced correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objectscores</code></td>
<td>
<p>Object scores (rows)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xhat</code></td>
<td>
<p>Optimally transformed predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat</code></td>
<td>
<p>Optimally transformed response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ypred</code></td>
<td>
<p>Predicted (fitted) values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yres</code></td>
<td>
<p>Residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smc</code></td>
<td>
<p>Squared multiple correlation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntel</code></td>
<td>
<p>Number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Loss function value</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Gifi, A. (1990). Nonlinear Multivariate Analysis. New York: Wiley.
</p>
<p>De Leeuw, J., Mair, P., Groenen, P. J. F. (2017). Multivariate Analysis with Optimal Scaling. 
</p>


<h3>See Also</h3>

<p><code>homals</code>, <code>princals</code>, <code>plot.morals</code></p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- scale(as.matrix(seq(0, pi, length = 20)), scale = FALSE)
y &lt;- scale(as.matrix(sin(x)), scale = FALSE)
fitxy &lt;- morals(x, y, xknots = knotsGifi(x, "E"), xdegrees = 2)
plot(fitxy, main = c("x", "y"))
plot(fitxy, plot.type = "resplot")

plot(fitxy$xhat, fitxy$yhat)
lines(fitxy$xhat, fitxy$ypred)

plot(x, fitxy$yhat)
lines(x, fitxy$ypred)
</code></pre>


</div>