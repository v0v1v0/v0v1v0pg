<div class="container">

<table style="width: 100%;"><tr>
<td>getTheta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>getTheta
Updates theta. Vectorized but only updates observations that have not converged.</h2>

<h3>Description</h3>

<p>getTheta
Updates theta. Vectorized but only updates observations that have not converged.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getTheta(
  spt,
  f0,
  mu,
  sampprobs,
  ySptIndex,
  thetaStart = NULL,
  thetaControl = theta.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spt</code></td>
<td>
<p>Support of the observed response variable. (This is the set of
unique values observed, not the set of all possible values.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f0</code></td>
<td>
<p>Values of the baseline distribution corresponding to the values of spt</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The fitted mean for each observation. Note these values must lie
strictly within the range of the support.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampprobs</code></td>
<td>
<p>Matrix of sampling probabilities. The number of rows should
equal the number of observations, and the number of columns should equal
the number of unique observed support points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ySptIndex</code></td>
<td>
<p>Vector containing index of each obervation's response value
within the <code>spt</code> vector. This is only needed to calculate the log-likelihood
after each update.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaStart</code></td>
<td>
<p>Vector of starting values. One value per observation. If
<code>NULL</code>, zero is used as the starting value for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaControl</code></td>
<td>
<p>Object of class <code>thetaControl</code>, which is a list of
control arguments returned by the <code>thetaControl</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing the following:
</p>

<ul>
<li> <p><code>theta</code> Updated values.
</p>
</li>
<li> <p><code>fTilt</code> Matrix containing the exponentially tilted distribution for each
observation, i.e. f(y|X=x). Each column corresponds to an observation and sums to one.
</p>
</li>
<li> <p><code>bPrime</code> Vector containing the mean of the exponentially tilted distribution
for each observation. Should match <code>mu</code> argument very closely.
</p>
</li>
<li> <p><code>bPrime2</code> Vector containing the variance of the exponentially tilted
distribution for each observation.
</p>
</li>
<li> <p><code>fTiltSW</code> Matrix containing the exponentially tilted distribution for each
observation, conditional on that observation being sampled, i.e. f(y|X=x, S=1).
If <code>sampprobs=NULL</code>, then <code>fTiltSW</code> matches <code>fTilt</code>.
</p>
</li>
<li> <p><code>bPrimeSW</code> Vector containing the mean for each observation, conditional
on that observation being sampled. If <code>sampprobs=NULL</code>, then <code>bPrimeSW</code>
matches <code>bPrime</code>.
</p>
</li>
<li> <p><code>bPrime2SW</code> Vector containing the variance for each observation, conditional
on that observation being sampled. If <code>sampprobs=NULL</code>, then <code>bPrime2SW</code>
matches <code>bPrime2</code>.
</p>
</li>
<li> <p><code>llik</code> Semiparametric log-likelihood, evaluated at the current beta
and f0 values. If sampling weights are used, then the log-likelihood is conditional
on each observation being sampled.
</p>
</li>
<li> <p><code>conv</code> Convergence indicator.
</p>
</li>
<li> <p><code>iter</code> Number of iterations until convergence was reached.
</p>
</li>
</ul>
</div>