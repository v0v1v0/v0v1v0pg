<div class="container">

<table style="width: 100%;"><tr>
<td>gmrfdpcountPost</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run a Bayesian functional data model under an instrinsic GMRF prior whose precision
parameters employ a DP prior for a COUNT data response type where:
y ~ poisson(E*exp(Psi))
Psi ~ N(gamma,tau_e^-1)
which is a Poisson-lognormal model</h2>

<h3>Description</h3>

<p>An internal function to <code>gmrfdpgrow</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">gmrfdpcountPost(
  y,
  E,
  ksi,
  ipr,
  C,
  D,
  q_order,
  q_type,
  n.iter,
  n.burn,
  n.thin,
  M_init,
  w_star,
  q_shape,
  q_rate,
  tau_shape,
  tau_rate,
  dp_shape,
  dp_rate,
  nu,
  Rep,
  progress,
  jitter,
  kappa_fast,
  stable_launch
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An <em>N x T</em> matrix of N observations of <em>T x 1</em> functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>A multivariate offset variable, specified as an <em>N x T</em> matrix, in the case
that <code>y</code> is of type count data.  The offset will be used to model the <code>y</code>
as under a poisson lognormal where <code>y ~ Pois(E*exp(Psi))</code>.  Defaults to <code>NULL</code>,
in which case the response type is assumed continuous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ksi</code></td>
<td>
<p>An <em>N x P</em> matrix of N observations of P predictors to be used
in prior probability of co-clustering of set of N, T x 1 observations. 
Defaults to <code>ksi = NULL</code> such that predictors are not used to a priori
determine co-clustering probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipr</code></td>
<td>
<p>An optional input vector of inclusion probabilities for each observation unit in the case
the observed data were acquired through an informative sampling design, so that unbiased
inference about the population requires adjustments to the observed sample.  Defaults to
<code>ipr = rep(1,nrow(y))</code> indicating an iid sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>A list object of length, <code>K</code>, the number of iGMRF precision terms.
Each entry contains a <em>T x T</em> normalized adjacency matrix.  The diagonal entries are
<code>0</code> and row <code>i</code> contains the weight for each entry <code>!=i</code> divided by the sum
of the weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A <em>K x T</em> matrix, where <code>K</code> denotes the number of iGMRF terms.
Row <code>k</code> contains the <code>T</code> elements of the diagonal of the term-<code>k</code>
precision matrix, <code>Q_k</code>.
Will increase with order and be equal, except for boundary corrections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_order</code></td>
<td>
<p>An integer vector where each entry contains the order of the associated <code>K</code>
iGMRF precision terms
matrix of Euclidean distances associated to each seasonal covariance term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_type</code></td>
<td>
<p>A vector of length <code>K</code>, the number of iGMRF precision terms, with each entry 
indicating whether the associated term is a trend (<code>"tr"</code>) or 
seasonality (<code>"sn"</code>) term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>The number of MCMC sampling iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.burn</code></td>
<td>
<p>The number of warm-up iterations to discard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>The interval or step size of post-burn-in samples to return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_init</code></td>
<td>
<p>Starting value of number of clusters for sampling cluster assignments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_star</code></td>
<td>
<p>Integer value denoting the number of cluster locations to sample ahead of 
observations in the auxiliary Gibbs sampler used to sample the number of clusters
and associated cluster assignments.  A higher value reduces samplin auto-correlation, 
but increases computational burden.  Defaults to <code>w_star = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_shape</code></td>
<td>
<p>The shape parameter of the Gamma base distribution for the <code>kappa_star</code>
locations used to sample the DP prior on the <code>P</code> GP covariance parameters, 
<code>kappa</code>, for each experimental unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_rate</code></td>
<td>
<p>The rate parameter of the Gamma base distribution for the <code>kappa_star</code>
locations used to sample the DP prior on the <code>P</code> GP covariance parameters, 
<code>kappa</code>, for each experimental unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau_shape</code></td>
<td>
<p>The value (in (0,infty)) for the shape hyperparameter for the Gamma prior on the error
precision parameter. Defaults to <code>tau_shape = 1.0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau_rate</code></td>
<td>
<p>The rate parameter of the Gamma prior distribution on <code>tau_e</code>. 
Defaults to <code>tau_rate = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp_shape</code></td>
<td>
<p>The shape parameter for the <code class="reqn">\Gamma</code> prior on the DP concentration parameter.
The rate parameter is set of <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp_rate</code></td>
<td>
<p>The rate parameter for the <code class="reqn">\Gamma</code> prior on the DP concentration parameter. 
Default value is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>The degree of freedom parameter for the Huang and Wand prior on precision
matrix locations, <code>Lambda_star</code>, in the case that predictors, <code>ksi</code>,
are entered to instantiate a predictor-dependent prior for co-clustering.
Default value is <code>4</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rep</code></td>
<td>
<p>The number of times to draw samples of the <code>N x T</code> log-mean
parameters, <code>Psi</code>, for each MCMC iteration
under a Poisson-lognormal model when the response
type for <code>y</code> is count (not continuous)
Default value is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>An indicator in <code>{0,1}</code> denoting whether to display a progress bar during model execution.
<code>progress = 1</code> displays a progress bar. Defaults to <code>progress = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>A scalar double indicating amount of jitter to subract from the posterior 
rate and shape hyperparameters of <code>tau_e</code> to stabilize computation.  
Defaults to <code>jitter = 0.0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa_fast</code></td>
<td>
<p>Boolean for whether to generate rate hyperparameter from full conditionals
versus joint Gaussian (on random effects, <code>bb</code>, given <code>kappa</code>.  The
former is faster, but numerically less stable. 
Defaults to <code>kappa_fast = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stable_launch</code></td>
<td>
<p>A boolean indicator on whether to generate initial values for
<code>N x T</code> log-mean, <code>Psi</code>, when <code>y</code> are count data from a Gaussian
prior distribution, which can induce numerical launch instabilities, or whether 
to initialize as <code>y/E</code> (where missing values in <code>y</code> are imputed).
Defaults to <code>stable_launch = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>res A list object containing MCMC runs for all model parameters.
</p>


<h3>Note</h3>

<p>Intended as an internal function for <code>gmrfdpgrow</code>
</p>


<h3>Author(s)</h3>

<p>Terrance Savitsky <a href="mailto:tds151@gmail.com">tds151@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>gpdpgrow</code>
</p>


</div>