<div class="container">

<table style="width: 100%;"><tr>
<td>sim.char</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> simulate character evolution </h2>

<h3>Description</h3>

<p>simulating evolution of discrete or continuous characters on a phylogenetic tree
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.char(phy, par, nsim = 1, model = c("BM", "speciational", "discrete"), root = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of class 'phylo'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>matrix describing model (either vcv matrix or Q matrix) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p> number of simulations to run </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a model from which to simulate data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>starting state (value) at root</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function simulates either discrete or continuous data on a phylogenetic tree. The model variable 
determines the type of simulation to be run. There are three options: <code>discrete</code>, which evolves
characters under a continuous time Markov model, and two continuous models, <code>BM</code> and <code>speciational</code>.
The <code>BM</code> model is a constant rate Brownian-motion model, while <code>speciational</code> is a Brownian model on a tree
where all branches have the same length.  The <code>model.matrix</code> parameter gives the structure of the model, 
and should be either a transition matrix, Q, for the <code>discrete</code> model, or a trait variance-covariance 
matrix for <code>BM</code> or <code>speciational</code> models.  For discrete models, multiple characters may be simulated 
if <code>model.matrix</code> is given as a list of Q matrices (see <b>Examples</b>). For continuous models, multivariate characters can be simulated, 
with their evolution goverened by a covariance matrix specified in the <code>model.matrix</code>. 
</p>


<h3>Value</h3>

<p>An array of simulated data, either two or three-dimensional, is returned. 
The first dimension is the number of taxa, the second the number of characters, and the third the 
number of simulated data sets.
</p>


<h3>Author(s)</h3>

<p> LJ Harmon </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
geo &lt;- get(data(geospiza))

## Continuous character -- univariate
usims &lt;- sim.char(geo$phy, 0.02, 100)

## Use a simulated dataset in fitContinuous()
fitC &lt;- fitContinuous(geo$phy, usims[,,1], model="BM", control=list(niter=10), ncores=2)

## Continuous character -- multivariate
s &lt;- ratematrix(geo$phy, geo$dat)
csims &lt;- sim.char(geo$phy, s, 100)

## Discrete character -- univariate
q &lt;- list(rbind(c(-.5, .5), c(.5, -.5)))
dsims &lt;- sim.char(geo$phy, q, model="discrete", n=10)

## Use a simulated dataset in fitDiscrete()
fitD &lt;- fitDiscrete(geo$phy, dsims[,,1], model="ER", niter=10, ncores=2)

## Discrete character -- multivariate
qq &lt;- list(rbind(c(-.5, .5), c(.5, -.5)), rbind(c(-.05, .05), c(.05, -.05)))
msims &lt;- sim.char(geo$phy, qq, model="discrete", n=10)

## End(Not run)
  
</code></pre>


</div>