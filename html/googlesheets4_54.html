<div class="container">

<table style="width: 100%;"><tr>
<td>sheet_write</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Over)write new data into a Sheet</h2>

<h3>Description</h3>

<p>This is one of the main ways to write data with googlesheets4. This function
writes a data frame into a (work)sheet inside a (spread)Sheet. The target
sheet is styled as a table:
</p>

<ul>
<li>
<p> Special formatting is applied to the header row, which holds column
names.
</p>
</li>
<li>
<p> The first row (header row) is frozen.
</p>
</li>
<li>
<p> The sheet's dimensions are set to "shrink wrap" the <code>data</code>.
</p>
</li>
</ul>
<p>If no existing Sheet is specified via <code>ss</code>, this function delegates to
<code>gs4_create()</code> and the new Sheet's name is randomly generated. If that's
undesirable, call <code>gs4_create()</code> directly to get more control.
</p>
<p>If no <code>sheet</code> is specified or if <code>sheet</code> doesn't identify an existing sheet,
a new sheet is added to receive the <code>data</code>. If <code>sheet</code> specifies an existing
sheet, it is effectively overwritten! All pre-existing values, formats, and
dimensions are cleared and the targeted sheet gets new values and dimensions
from <code>data</code>.
</p>
<p>This function goes by two names, because we want it to make sense in two
contexts:
</p>

<ul>
<li> <p><code>write_sheet()</code> evokes other table-writing functions, like
<code>readr::write_csv()</code>. The <code>sheet</code> here technically refers to an individual
(work)sheet (but also sort of refers to the associated Google
(spread)Sheet).
</p>
</li>
<li> <p><code>sheet_write()</code> is the right name according to the naming convention used
throughout the googlesheets4 package.
</p>
</li>
</ul>
<p><code>write_sheet()</code> and <code>sheet_write()</code> are equivalent and you can use either one.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sheet_write(data, ss = NULL, sheet = NULL)

write_sheet(data, ss = NULL, sheet = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame. If it has zero rows, we send one empty pseudo-row
of data, so that we can apply the usual table styling. This empty row goes
away (gets filled, actually) the first time you send more data with
<code>sheet_append()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ss</code></td>
<td>
<p>Something that identifies a Google Sheet:
</p>

<ul>
<li>
<p> its file id as a string or <code>drive_id</code>
</p>
</li>
<li>
<p> a URL from which we can recover the id
</p>
</li>
<li>
<p> a one-row <code>dribble</code>, which is how googledrive
represents Drive files
</p>
</li>
<li>
<p> an instance of <code>googlesheets4_spreadsheet</code>, which is what <code>gs4_get()</code>
returns
</p>
</li>
</ul>
<p>Processed through <code>as_sheets_id()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheet</code></td>
<td>
<p>Sheet to write into, in the sense of "worksheet" or "tab". You can identify a sheet by name, with a string, or by position, with a number.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The input <code>ss</code>, as an instance of <code>sheets_id</code>
</p>


<h3>See Also</h3>

<p>Other write functions: 
<code>gs4_create()</code>,
<code>gs4_formula()</code>,
<code>range_delete()</code>,
<code>range_flood()</code>,
<code>range_write()</code>,
<code>sheet_append()</code>
</p>
<p>Other worksheet functions: 
<code>sheet_add()</code>,
<code>sheet_append()</code>,
<code>sheet_copy()</code>,
<code>sheet_delete()</code>,
<code>sheet_properties()</code>,
<code>sheet_relocate()</code>,
<code>sheet_rename()</code>,
<code>sheet_resize()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
df &lt;- data.frame(
  x = 1:3,
  y = letters[1:3]
)

# specify only a data frame, get a new Sheet, with a random name
ss &lt;- write_sheet(df)
read_sheet(ss)

# clean up
googledrive::drive_trash(ss)

# create a Sheet with some initial, placeholder data
ss &lt;- gs4_create(
  "sheet-write-demo",
  sheets = list(alpha = data.frame(x = 1), omega = data.frame(x = 1))
)

# write df into its own, new sheet
sheet_write(df, ss = ss)

# write mtcars into the sheet named "omega"
sheet_write(mtcars, ss = ss, sheet = "omega")

# get an overview of the sheets
sheet_properties(ss)

# view your magnificent creation in the browser
gs4_browse(ss)

# clean up
gs4_find("sheet-write-demo") %&gt;%
  googledrive::drive_trash()

</code></pre>


</div>