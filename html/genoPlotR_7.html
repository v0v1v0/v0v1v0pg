<div class="container">

<table style="width: 100%;"><tr>
<td>dna_seg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
DNA segment (dna_seg) class and class functions
</h2>

<h3>Description</h3>

<p>A DNA segment is a collection of genes or elements along a genome, to
be represented on a map. These functions are class functions to
create, convert and test dna_seg objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dna_seg(x, ...)
as.dna_seg(df, col = "blue", fill = "blue", lty = 1, lwd = 1,
           pch = 8, cex = 1, gene_type = "arrows")
is.dna_seg(dna_seg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A <code>data.frame</code> or <code>list</code> that can be coerced to a data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments further passed to <code>as.dna_seg</code> (see below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>A data frame representing the <code>dna_seg</code> object. See details for
necessary columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>Either a color vector of the same length as <code>df</code> or of length
one, to be applied to the whole object. Will be passed to
corresponding <code>grob</code> object. Default to blue.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>

<p>Either a fill vector of the same length as <code>df</code> or of length
one, to be applied to the whole object. Will be passed to
corresponding <code>grob</code> object. Default to <code>blue</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>A vector of the same length as <code>df</code> or of length one, giving
the line type around the objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>Same as <code>lty</code>, giving the line width.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>

<p>Same as <code>lty</code>, giving the character representing each
object. Goes with <code>gene_type</code> points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>

<p>Same as <code>lty</code>, giving the character size representing each
object. Goes with <code>gene_type</code> points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_type</code></td>
<td>

<p>Vector of the same length as <code>df</code> or of length one, giving the
type of representation of each object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dna_seg</code></td>
<td>

<p>Object to test.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Objects to be converted needs to have their first 4 columns named 
<code>name</code>, <code>start</code>, <code>end</code> and <code>strand</code>. Extra columns
with names <code>col</code>, <code>lty</code>, <code>lwd</code>, <code>pch</code>, <code>cex</code>,
<code>gene_type</code> will be used in the plotting process. Other extra
columns will be kept in the object, but not used.
</p>
<p><code>dna_seg</code> tries to build a dna_seg object from a data frame or a
list. 
</p>
<p><code>as.dna_seg</code> tries to build a dna_seg object from a data frame.
</p>
<p>Read functions such as <code>read_dna_seg_from_tab</code> and
<code>read_dna_seg_from_ptt</code> also return dna_seg objects.  
</p>


<h3>Value</h3>

<p>A comparison object for <code>comparison</code> and
<code>as.comparison</code>. DNA seg objects are also of class
<code>data.frame</code>. They contain the following columns: <code>name</code>,
<code>start</code>, <code>end</code>, <code>strand</code>, <code>col</code>, <code>lty</code>, <code>lwd</code>,
<code>pch</code>, <code>cex</code>, <code>gene_type</code>.
</p>
<p>A logical for <code>is.comparison</code>.
</p>


<h3>Author(s)</h3>

<p>Lionel Guy
</p>


<h3>See Also</h3>

<p><code>read_dna_seg_from_tab</code>,
<code>read_dna_seg_from_ptt</code>, <code>gene_types</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate data
names1 &lt;- c("feat1", "feat2", "feat3")
starts1 &lt;- c(2, 1000, 1050)
ends1 &lt;- c(600, 800, 1345)
strands1 &lt;- c("-", -1, 1)
cols1 &lt;- c("blue", "grey", "red")

## create data.frame
df1 &lt;- data.frame(name=names1, start=starts1, end=ends1,
                  strand=strands1, col=cols1)

## with dna_seg
dna_seg1 &lt;- dna_seg(df1)
dna_seg1
as.dna_seg(df1)

## test
is.dna_seg(dna_seg1)

## directly readable with read_dna_seg_from_tab
## Not run: 
write.table(x=dna_seg1, file="dna_seg1.tab", quote=FALSE,
            row.names=FALSE, sep="\t")

## End(Not run)

## with only one gene and with list, or two, and merging with c.dna_seg
gene2a &lt;- dna_seg(list(name="feat1", start=50, end=900, strand="-", col="blue"))
genes2b &lt;- dna_seg(data.frame(name=c("feat2", "feat3"), start=c(800, 1200),
                              end=c(1100, 1322), strand=c("+", 1),
                              col=c("grey", "red"),
                              fill=c("transparent", "grey"),
                              gene_type=c("arrows", "blocks")))
dna_seg2 &lt;- c(gene2a, genes2b)

## test
is.dna_seg(dna_seg2)

## reading from file
dna_seg3_file &lt;- system.file('extdata/dna_seg3.tab', package = 'genoPlotR')
dna_seg3 &lt;- read_dna_seg_from_tab(dna_seg3_file)
is.dna_seg(dna_seg3)

</code></pre>


</div>