<div class="container">

<table style="width: 100%;"><tr>
<td>demCreditPolicy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A Disequilibrium Model with Credit</h2>

<h3>Description</h3>

<p>These are some examples to illustrate that credit policies may lead to business cycles.
When the firm's profit rate is high, the laborer lends labor or labor income to the firm; when the firm's profit rate is low, the firm repays the loan with products.
</p>


<h3>Usage</h3>

<pre><code class="language-R">demCreditPolicy(...)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to the function sdm2.</p>
</td>
</tr></table>
<h3>Examples</h3>

<pre><code class="language-R">
dst.firm &lt;- node_new("output",
  type = "CD", alpha = 1.2,
  beta = c(0.5, 0.5),
  "prod", "lab"
)

dst.consumer &lt;- node_new("utility",
  type = "Leontief", a = 1,
  "prod"
)

f &lt;- function(policy = NULL) {
  ge &lt;- sdm2(
    A = list(dst.firm, dst.consumer),
    B = matrix(c(
      1, 0,
      0, 1
    ), 2, 2, TRUE),
    S0Exg = matrix(c(
      NA, NA,
      NA, 100
    ), 2, 2, TRUE),
    names.commodity = c("prod", "lab"),
    names.agent = c("firm", "consumer"),
    ts = TRUE,
    policy = policy,
    numberOfPeriods = 200,
    maxIteration = 1,
    priceAdjustmentVelocity = 0.05
  )

  matplot(ge$ts.z, type = "o", pch = 20)
  ge
}

## no credit policy
ge &lt;- f()

## credit policy
policy.credit &lt;- function(time, state) {
  profit.rate &lt;- state$p[1] / sum(state$last.A[, 1] * state$p) - 1

  if (profit.rate &gt; 0.01) {
    state$S[2, 2] &lt;- 50
    state$S[2, 1] &lt;- 50
  } else if (profit.rate &lt; -0.01) {
    state$S[1, 2] &lt;- state$S[1, 1] * 0.5
    state$S[1, 1] &lt;- state$S[1, 1] * 0.5
  }

  state
}

de &lt;- f(policy = policy.credit)

#### an example with 3 firms.
policy.credit &lt;- function(time, state) {
  if (time &lt;= 10) {
    return(state)
  }
  profit.rate &lt;- state$p[1] / sum(state$last.A[, 1] * state$p) - 1

  if (profit.rate &gt; 0.01) {
    state$S[3, 1] &lt;- 30
    # state$S[3, 1:3] &lt;- 10
    state$S[3, 4] &lt;- 70
  } else if (profit.rate &lt; -0.01) {
    state$S[1, 4] &lt;- state$S[1, 1] * 0.3
    state$S[1, 1] &lt;- state$S[1, 1] * 0.7
  }

  state
}

f &lt;- function(policy = NULL,
              numberOfPeriods = 50) {
  ge &lt;- sdm2(
    A = function(state) {
      a.firm.prod &lt;- CD_A(alpha = 1, Beta = c(0, 0.5, 0.5, 0), state$p)
      a.firm.cap1 &lt;- c(1, 0, 0.1, 0)
      a.firm.cap2 &lt;- c(0, 0, 0.1, 1)
      a.consumer &lt;- c(1, 0, 0, 0)
      cbind(a.firm.prod, a.firm.cap1, a.firm.cap2, a.consumer)
    },
    B = matrix(c(
      1, 0, 0, 0,
      0, 0, 1, 0,
      0, 0, 0, 0,
      0, 1, 0, 0
    ), 4, 4, TRUE),
    S0Exg = {
      tmp &lt;- matrix(NA, 4, 4)
      tmp[3, 4] &lt;- 100
      tmp
    },
    names.commodity = c("prod", "cap2", "lab", "cap1"),
    names.agent = c("firm.prod", "firm.cap1", "firm.cap2", "consumer"),
    numeraire = "lab",
    maxIteration = 1,
    numberOfPeriods = numberOfPeriods,
    ts = TRUE,
    p0 = c(4.191, 4.391, 1, 4.291),
    # The equilibrium output of firm.prod is 45.64.
    z0 = c(50, 21.78, 21.78, 23.86),
    policy = policy
  )

  matplot(ge$ts.z, type = "o", pch = 20)
  ge
}

## a disequilibrium path
de &lt;- f(numberOfPeriods = 500)

## a spot market clearing path converging to equilibrium
ge &lt;- f(
  policy = policyMarketClearingPrice,
  numberOfPeriods = 40
)
ge$p
ge$z

## a spot market clearing path with persisting fluctuations
de &lt;- f(policy = list(
  policy.credit,
  policyMarketClearingPrice
))

</code></pre>


</div>