<div class="container">

<table style="width: 100%;"><tr>
<td>GET.distrequal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical n sample test of correspondence of distribution functions</h2>

<h3>Description</h3>

<p>Compare the distributions of two (or more) samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GET.distrequal(
  x,
  stat = "ECDF",
  nsim,
  r = seq(min(unlist((lapply(x, min)))), max(unlist((lapply(x, max)))), length = 100),
  tau = seq(0.1, 0.9, length = 100),
  contrasts = FALSE,
  GET.args = NULL,
  density.args = NULL,
  approxfun.args = NULL,
  rq.args = NULL,
  savefuns = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A list of numeric vectors, one for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>Character string indicating which test statistic to be used. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of random permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The sequence of argument values at which the test functions are to be compared.
The default is 100 equally spaced values between the minimum and maximum over all groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The sequence of argument values for the QR test statistic.
The default values are 100 equally spaced values between 0.1 and 0.9.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>Logical. FALSE and TRUE specify the two test functions as described in
description part of this help file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GET.args</code></td>
<td>
<p>A named list of additional arguments to be passed to <code>global_envelope_test</code>,
e.g. <code>typeone</code> specifies the type of multiple testing control, FWER or FDR.
See <code>global_envelope_test</code> for the defaults and available options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.args</code></td>
<td>
<p>A named list of additional arguments to be passed for the estimation of the test statistic <code>"DEN"</code>.
For more details see <code>density</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approxfun.args</code></td>
<td>
<p>A named list of additional arguments to be passed for the estimation of the the test statistic <code>"QQ"</code>.
For more details see <code>approxfun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rq.args</code></td>
<td>
<p>A named list of additional arguments to be passed for the estimation of the test statistic <code>"QR"</code>.
For more details see the function <code>rq</code> of <span class="pkg">quantreq</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savefuns</code></td>
<td>
<p>Logical. If TRUE, then the functions from permutations are saved to the attribute
simfuns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>global_envelope_test</code>.
For example, the type of multiple testing control, FWER or FDR must be set by <code>typeone</code>.
And, if <code>typeone = "fwer"</code>, the type of the global envelope can be chosen by
specifying the argument <code>type</code>. See <code>global_envelope_test</code>
for the defaults and available options.
(The test here uses <code>alternative="two.sided"</code> and <code>nstep=1</code> (when relevant),
but all the other specifications are to be given in <code>...</code>.)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A global envelope test can be performed to investigate whether the n distribution functions
differ from each other and how do they differ. This test is a generalization of
the two-sample Kolmogorov-Smirnov test with a graphical interpretation.
We assume that the observations in the sample <code class="reqn">i</code> are an i.i.d. sample from the distribution
<code class="reqn">F_i(r), i=1, \dots, n,</code>
and we want to test the hypothesis
</p>
<p style="text-align: center;"><code class="reqn">F_1(r)= \dots = F_n(r).</code>
</p>

<p>If <code>contrasts = FALSE</code> (default), then the default test statistic ("ECDF") is taken to be
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{T} = (\hat{F}_1(r), \dots, \hat{F}_n(r))</code>
</p>

<p>where <code class="reqn">\hat{F}_i(r) = (\hat{F}_i(r_1), \dots, \hat{F}_i(r_k))</code>
is the ecdf of the <code class="reqn">i</code>th sample evaluated at argument values
<code class="reqn">r = (r_1,\dots,r_k)</code>.
</p>
<p>Another possibility is given by <code>stat = "DIFF"</code>, and then the test statistic is
still based on the ECDFs and constructed from all pairwise differences,
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{T} = (\hat{F}_1(r)-\hat{F}_2(r), \hat{F}_1(r)-\hat{F}_3(r), \dots, \hat{F}_{n-1}(r)-\hat{F}_n(r))</code>
</p>

<p>The choices <code>contrasts = TRUE</code> and <code>stat = "ECDF"</code> lead to the same test statistic.
For other (or multiple) values of <code>stat</code>, the argument <code>contrasts</code> is ignored.
</p>
<p>All the options as the test statistics are the following:
</p>

<ol>
<li> <p><code>"ECDF"</code>: The ECDFs of the n-samples, as specified above
</p>
</li>
<li> <p><code>"DIFF"</code>: The pairwise differences between the ECDFs, as specified above
</p>
</li>
<li> <p><code>"DEN"</code>: The kernel estimated density functions of the n-samples as the test statistic
</p>
</li>
<li> <p><code>"QQ"</code>: The pairwise comparisons of empirical quantiles
</p>
</li>
<li> <p><code>"SHIFT"</code> The de-trended QQ-plot (shift plot)
</p>
</li>
<li> <p><code>"QR"</code>: The quantile regression process, i.e. the <code class="reqn">\beta</code>-coefficients of the quantile regression.
By default, the reference category of this test statistic is the first sample.
</p>
</li>
</ol>
<p>The test statistics are described in detail in Konstantinou et al. (2024).
</p>
<p>The simulations under the null hypothesis that the distributions are the same are obtained
by permuting the individuals of the groups. The default number of permutation, if <code>nsim</code> is not specified,
is <code class="reqn">n \cdot 1000-1</code> for the case <code>contrasts = FALSE</code> and
<code class="reqn">(n \cdot (n-1)/2) \cdot 1000 - 1</code> for the case <code>contrasts = TRUE</code>,
where <code class="reqn">n</code> is the length of <code class="reqn">x</code>.
</p>


<h3>References</h3>

<p>Konstantinou K., Mrkvička T. and Myllymäki M. (2024) Graphical n-sample tests of correspondence of distributions. arXiv:2403.01838 [stat.ME] https://doi.org/10.48550/arXiv.2403.01838
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require("fda", quietly=TRUE)) {
  # Heights of boys and girls at age 10
  f.a &lt;- growth$hgtf["10",] # girls at age 10
  m.a &lt;- growth$hgtm["10",] # boys at age 10
  # Empirical cumulative distribution functions
  plot(ecdf(f.a))
  plot(ecdf(m.a), col='grey70', add=TRUE)
  # Create a list of the data
  fm.list &lt;- list(Girls=f.a, Boys=m.a)
  
  res &lt;- GET.distrequal(fm.list)
  plot(res)
  # If you want to change the labels:
  plot(res, scales = "free", labels = c("Girls", "Boys"))
  # If you want to change the x-label (y-label similarly):
  require("ggplot2")
  myxlab &lt;- substitute(paste(italic(i), " (", j, ")", sep = ""),
                       list(i = "x", j = "Height in cm"))
  plot(res, scales = "free") + xlab(myxlab)
  # Use instead the test statistics QQ and DEN
  res &lt;- GET.distrequal(fm.list, stat = c("QQ", "DEN"))
  plot(res, scales = "free")
  
  

  # Heights of boys and girls at age 14
  f.a &lt;- growth$hgtf["14",] # girls at age 14
  m.a &lt;- growth$hgtm["14",] # boys at age 14
  # Empirical cumulative distribution functions
  plot(ecdf(f.a))
  plot(ecdf(m.a), col='grey70', add=TRUE)
  # Create a list of the data
  fm.list &lt;- list(Girls=f.a, Boys=m.a)
  
  res &lt;- GET.distrequal(fm.list)
  plot(res) + xlab(myxlab)
  res &lt;- GET.distrequal(fm.list, stat = c("QQ", "DEN"))
  plot(res, scales = "free") + xlab(myxlab)
  
  
}
if(require("datasets", quietly=TRUE)) {
  data("iris")
  virginica &lt;- subset(iris, Species == "virginica")
  setosa &lt;- subset(iris, Species == "setosa")
  versicolor &lt;- subset(iris, Species == "versicolor")
  
  res &lt;- GET.distrequal(x = list(virginica = virginica$Sepal.Length,
                                 setosa = setosa$Sepal.Length,
                                 versicolor = versicolor$Sepal.Length),
                        stat =  c("QQ", "DEN"))
  plot(res, scales = "free", ncol = 3)
  
  
}
</code></pre>


</div>