<div class="container">

<table style="width: 100%;"><tr>
<td>constrained</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Precision Matrix with Known Graph</h2>

<h3>Description</h3>

<p>Compute the maximum likelihood estimate of the precision matrix,
given a known graphical structure (i.e., an adjacency matrix).
This approach was originally described in "The Elements of Statistical Learning"
(see pg. 631, Hastie et al. 2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">constrained(Sigma, adj)

mle_known_graph(Sigma, adj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>Covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>Adjacency matrix that encodes the constraints,
where a zero indicates that element should be zero.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following:
</p>

<ul>
<li>
<p><strong>Theta</strong>: Inverse of the covariance matrix (precision matrix)
</p>
</li>
<li>
<p><strong>Sigma</strong>: Covariance matrix.
</p>
</li>
<li>
<p><strong>wadj</strong>: Weighted adjacency matrix, corresponding
to the partial correlation network.
</p>
</li>
</ul>
<h3>Note</h3>

<p>The algorithm is written in <code>c++</code>, and should scale to high dimensions
nicely.
</p>
<p>Note there are a variety of algorithms for this purpose. Simulation
studies indicated that this approach is both accurate and computationally
efficient (HFT therein, Emmert-Streib et al. 2019)
</p>


<h3>References</h3>

<p>Emmert-Streib F, Tripathi S, Dehmer M (2019).
“Constrained covariance matrices with a biologically realistic structure: Comparison of methods for generating high-dimensional Gaussian graphical models.”
<em>Frontiers in Applied Mathematics and Statistics</em>, <b>5</b>, 17.<br><br> Hastie T, Tibshirani R, Friedman J (2009).
<em>The elements of statistical learning: data mining, inference, and prediction</em>.
Springer Science \&amp; Business Media.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# data
y &lt;- ptsd

# fit model
fit &lt;- ggmncv(cor(y), n = nrow(y),
              penalty = "lasso",
              progress = FALSE)

# set negatives to zero (sign restriction)
adj_new &lt;- ifelse( fit$P &lt;= 0, 0, 1)

check_zeros &lt;- TRUE

# track trys
iter &lt;- 0

# iterate until all positive
while(check_zeros){
  iter &lt;- iter + 1
  fit_new &lt;- constrained(cor(y), adj = adj_new)
  check_zeros &lt;- any(fit_new$wadj &lt; 0)
  adj_new &lt;- ifelse( fit_new$wadj &lt;= 0, 0, 1)
}



# alias

# data
y &lt;- ptsd

# nonreg (lambda = 0)
fit &lt;- ggmncv(cor(y), n = nrow(y),
              lambda = 0,
              progress = FALSE)

# set values less than |0.1| to zero
adj_new &lt;- ifelse( abs(fit$P) &lt;= 0.1, 0, 1)

# mle given the graph
mle_known_graph(cor(y), adj_new)

</code></pre>


</div>