<div class="container">

<table style="width: 100%;"><tr>
<td>gamselBayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian generalized additive model selection including a fast variational option</h2>

<h3>Description</h3>

<p>Selection of predictors and the nature of their impact on the mean response (linear versus non-linear) is a fundamental problem in regression analysis. This function uses the generalized additive models framework for estimating predictors effects. An approximate Bayesian inference approach and has two options for achieving this: (1) Markov chain Monte Carlo and (2) mean field variational Bayes.</p>


<h3>Usage</h3>

<pre><code class="language-R">gamselBayes(y,Xlinear  = NULL,Xgeneral = NULL,method = "MCMC",lowerMakesSparser = NULL,   
            family = "gaussian",verbose = TRUE,control = gamselBayes.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector containing the response data. If 'family = "gaussian"' then the response data are modelled as being continuous with a Gaussian distribution. If 'family = "binomial"' then the response data must be binary with 0/1 coding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xlinear</code></td>
<td>
<p>Data frame with number of rows equal to the length of <code>y</code>. Each column contains data for a predictor which potentially has a linear or zero effect, but not a nonlinear effect. Binary predictors must be inputted through this matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xgeneral</code></td>
<td>
<p>A data frame with number of rows equal to the length of <code>y</code>. Each column contains data for a predictor which potentially has a linear, nonlinear or zero effect. Binary predictors cannot be inputted through this matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string for specifying the method to be used:<br>
"MCMC" = Markov chain Monte Carlo,<br>
"MFVB" = mean field variational Bayes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerMakesSparser</code></td>
<td>
<p>A threshold parameter between 0 and 1, which is such that lower values lead to sparser fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Character string for specifying the response family:<br>
"gaussian" = response assumed to be Gaussian with constant variance,<br>
"binomial" = response assumed to be binary.<br>
The default is "gaussian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean variable for specifying whether or not progress messages are printed to the console. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Function for controlling the spline bases, Markov chain Monte Carlo sampling, mean field variational Bayes and other specifications.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generalized additive model selection via approximate Bayesian inference is provided. Bayesian mixed model-based penalized splines with spike-and-slab-type coefficient prior distributions are used to facilitate fitting and selection. The approximate Bayesian inference engine options are: (1) Markov chain Monte Carlo and (2) mean field variational Bayes. Markov chain Monte Carlo has better Bayesian inferential accuracy, but requires a longer run-time. Mean field variational Bayes is faster, but less accurate. The methodology is described in He and Wand (2021) &lt;arXiv:2201.00412&gt;. 
</p>


<h3>Value</h3>

<p>An object of class <code>gamselBayes</code>, which is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the value of <code>method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the value of <code>family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xlinear</code></td>
<td>
<p>the inputted design matrix containing predictors that can only have linear effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xgeneral</code></td>
<td>
<p>the inputted design matrix containing predictors that are potentially have non-linear effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rangex</code></td>
<td>
<p>the value of the control parameter <code>rangex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intKnots</code></td>
<td>
<p>the value of the control parameter <code>intKnots</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncateBasis</code></td>
<td>
<p>the value of the control parameter <code>truncateBasis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numBasis</code></td>
<td>
<p>the value of the control parameter <code>numBasis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMC</code></td>
<td>
<p>a list such that each component is the retained Markov chain Monte Carlo (MCMC)sample for a model parameter. The components are:<br><code>beta0</code> = overall intercept.<br><code>betaTilde</code> = linear component coefficients without multiplication by the <code>gammaBeta</code> values.<br><code>gammaBeta</code> = linear component coefficients spike-and-slab auxiliary indicator variables.<br><code>sigmaBeta</code> = standard deviation of the linear component coefficients.<br><code>rhoBeta</code> = the Bernoulli distribution probability parameter of the linear component coefficients spike-and-slab auxiliary indicator variables.<br><code>uTilde</code> = spline basis function coefficients without multiplication by the <code>gammaUMCMC</code> values. The MCMC samples are stored in a list. Each list component corresponds to a predictor that is treated as potentially having a non-linear effect, and is a matrix with columns corresponding to the spline basis function coefficients for that predictor and rows corresponding to the retained MCMC samples.<br><code>gammaU</code> = spline basis coefficients spike-and-slab auxiliary indicator variables.  The MCMC samples are stored in a list. Each list component corresponds to a predictor that is treated as potentially having a non-linear effect, and is a matrix with columns corresponding to the spline basis function coefficients for that predictor and rows corresponding to the retained MCMC samples.<br><code>rhoU</code> = the Bernoulli distribution probability parameters of the spline basis component coefficients spike-and-slab auxiliary indicator variables. The MCMC samples are stored in a matrix. Each column corresponds to a predictor that is treated as potentially having a non-linear effect. The rows of the matrix correspond to the retained MCMC samples.<br><code>sigmaEps</code> = error standard deviation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MFVB</code></td>
<td>
<p>a list such that each component is the mean field variational Bayes approximate posterior density function, or q-density, parameters. The components are:<br><code>beta0</code> = a vector with 2 entries, consisting of the mean and variance of the Univariate Normal q-density of the overall intercept.<br><code>betaTilde</code> = a two-component list containing the Multivariate Normal q-density parameters of linear component coefficients without multiplication by the means of the <code>gammaBeta</code> q-densities. The list components are: <code>mu.q.betaTilde</code>, the mean vector; <code>Sigma.q.betaTilde</code>, the covariance matrix.<br><code>gammaBeta</code> = a vector containing the Bernoulli q-density means of the linear component coefficients spike-and-slab auxiliary indicator variables.<br><code>sigmaBeta</code> = a vector with 2 entries, consisting of the Inverse Gamma q-density shape and rate parameters of the variance of the linear component coefficients.<br><code>rhoBeta</code> = a vector with 2 entries, consisting of the Beta q-density shape parameters of the Bernoulli probability parameter of the linear component coefficients spike-and-slab auxiliary indicator variables.<br><code>uTilde</code> = a two-component list containing the Multivariate Normal q-density parameters of the spline basis function coefficients without multiplication by the means of the <code>gammaU</code> q-densities. The list components are: <code>mu.q.uTilde</code>, the mean vectors for each predictor that is treated as potentially having a non-linear effect; <code>sigsq.q.uTilde</code>, the diagonal entries of the covariance matrices of each predictor that is treated as potentially having a non-linear effect.<br><code>gammaU</code> = a list containing the q-density means of the spline basis coefficients spike-and-slab auxiliary indicator variables. Each list component corresponds to a predictor that is treated as potentially having a non-linear effect.<br><code>rhoU</code> = a two-component list with components <code>A.q.rho.u</code> and <code>B.q.rho.u</code>. The <code>A.q.rho.u</code> list component is a vector of Beta q-density first (one plus the power of rho) shape parameters corresponding to the spline basis coefficients spike-and-slab auxiliary indicator variables for each predictor that is treated as potentially having a non-linear effect. The <code>B.q.rho.u</code> list component is a vector of Beta q-density second (one plus the power of 1-rho) shape parameters corresponding to the spline basis coefficients spike-and-slab auxiliary indicator variables for each predictor that is treated as potentially having a non-linear effect.<br><code>sigmaEps</code> = a vector with 2 entries, consisting of the Inverse Gamma q-density shape and rate parameters of the error variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effectTypeHat</code></td>
<td>
<p>an array of character strings, with entry either "zero", "linear" or "nonlinear", signifying the estimated effect type for each candidate predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanXlinear</code></td>
<td>
<p>an array containing the sample means of each column of <code>Xlinear</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdXlinear</code></td>
<td>
<p>an array containing the sample standard deviations of each column of <code>Xlinear</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanXgeneral</code></td>
<td>
<p>an array containing the sample means of each column of <code>Xgeneral</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdXgeneral</code></td>
<td>
<p>an array containing the sample standard deviations of each column of <code>Xgeneral</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Virginia X. He <a href="mailto:virginia.x.he@student.uts.edu.au">virginia.x.he@student.uts.edu.au</a> and Matt P. Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a></p>


<h3>References</h3>

<p>Chouldechova, A. and Hastie, T. (2015). Generalized additive model selection. &lt;arXiv:1506.03850v2&gt;.
</p>
<p>He, V.X. and Wand, M.P. (2021). Bayesian generalized additive model selection including a fast variational option. &lt;arXiv:2021.PLACE-HOLDER&gt;. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(gamselBayes) 

# Generate some simple regression-type data:

set.seed(1) ; n &lt;- 1000 ; x1 &lt;- rbinom(n,1,0.5) ; 
x2 &lt;- runif(n) ; x3 &lt;- runif(n) ; x4 &lt;- runif(n)
y &lt;- x1 + sin(2*pi*x2) - x3 + rnorm(n)
Xlinear &lt;- data.frame(x1) ; Xgeneral &lt;- data.frame(x2,x3,x4)

# Obtain a gamselBayes() fit for the data, using Markov chain Monte Carlo:

fitMCMC &lt;- gamselBayes(y,Xlinear,Xgeneral)
summary(fitMCMC) ; plot(fitMCMC) ; checkChains(fitMCMC)

# Obtain a gamselBayes() fit for the data, using mean field variational Bayes:

fitMFVB &lt;- gamselBayes(y,Xlinear,Xgeneral,method = "MFVB")
summary(fitMFVB) ; plot(fitMFVB)

if (require("Ecdat"))
{
   # Obtain a gamselBayes() fit for data on schools in California, U.S.A.:

   Caschool$log.avginc &lt;- log(Caschool$avginc)
   mathScore &lt;- Caschool$mathscr
   Xgeneral &lt;- Caschool[,c("mealpct","elpct","calwpct","compstu","log.avginc")]

   # Obtain a gamselBayes() fit for the data, using Markov chain Monte Carlo:

   fitMCMC &lt;- gamselBayes(y = mathScore,Xgeneral = Xgeneral)
   summary(fitMCMC) ; plot(fitMCMC) ; checkChains(fitMCMC)

   # Obtain a gamselBayes() fit for the data, using mean field variational Bayes:

   fitMFVB &lt;- gamselBayes(y = mathScore,Xgeneral = Xgeneral,method = "MFVB")
   summary(fitMFVB) ; plot(fitMFVB)
}
</code></pre>


</div>