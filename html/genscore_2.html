<div class="container">

<table style="width: 100%;"><tr>
<td>avgrocs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Takes the vertical average of ROC curves.</h2>

<h3>Description</h3>

<p>Takes the vertical average of ROC curves using algorithm 3 from Fawcett (2006). The resulting ROC curve preserves the average AUC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">avgrocs(rocs, num_true_edges, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rocs</code></td>
<td>
<p>A list of ROC curves, each of which is a matrix with two columns corresponding to the true positive and false positive rates, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_true_edges</code></td>
<td>
<p>A positive integer, the number of true edges</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A positive integer, the dimension</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The averaged ROC curve, a matrix with 2 columns and <code>(p^2-p-num_true_edges+1)</code> rows.
</p>


<h3>References</h3>

<p>Fawcett T (2006).
“An introduction to ROC analysis.”
<em>Pattern Recognition Letters</em>, <b>27</b>(8), 861–874.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 40
p &lt;- 50
mu &lt;- rep(0, p)
tol &lt;- 1e-8
domain &lt;- make_domain("R+", p=p)
K &lt;- cov_cons(mode="sub", p=p, seed=1, spars=0.2, eig=0.1, subgraphs=10)
true_edges &lt;- which(abs(K) &gt; tol &amp; diag(p) == 0)
dm &lt;- 1 + (1-1/(1+4*exp(1)*max(6*log(p)/n, sqrt(6*log(p)/n))))
ROCs &lt;- list()
old.par &lt;- par(mfrow=c(2,2), mar=c(5,5,5,5))
for (i in 1:3){
  set.seed(i)
  x &lt;- tmvtnorm::rtmvnorm(n, mean = mu, sigma = solve(K),
         lower = rep(0, p), upper = rep(Inf, p), algorithm = "gibbs",
         burn.in.samples = 100, thinning = 10)
  est &lt;- estimate(x, setting="gaussian", elts=NULL, domain=domain, centered=TRUE,
           symmetric="symmetric", lambda_length=100, mode="min_pow",
           param1=1, param2=3, diag=dm)
  # Apply tp_fp to each estimated edges set for each lambda
  TP_FP &lt;- t(sapply(est$edgess, function(edges){tp_fp(edges, true_edges, p)}))
  ROCs[[i]] &lt;- TP_FP
  plot(c(), c(),  ylim=c(0,1), xlim=c(0,1), cex.lab=1,
    main=paste("ROC, trial ",i,", AUC ",round(AUC(TP_FP),4),sep=""),
    xlab="False Positives", ylab="True Positives")
  points(TP_FP[,2], TP_FP[,1], type="l")
  points(c(0,1), c(0,1), type = "l", lty = 2)
}
average_ROC &lt;- avgrocs(ROCs, length(true_edges), p)
plot(c(), c(),  ylim=c(0,1), xlim=c(0,1), cex.lab=1,
  main=paste("Average ROC, AUC",round(AUC(average_ROC),4)),
  xlab="False Positives", ylab="True Positives")
points(average_ROC[,2], average_ROC[,1], type="l")
points(c(0,1), c(0,1), type = "l", lty = 2)
par(old.par)
</code></pre>


</div>