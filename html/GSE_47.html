<div class="container">

<table style="width: 100%;"><tr>
<td>partial.mahalanobis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partial Square Mahalanobis Distance</h2>

<h3>Description</h3>

<p>Computes the partial square Mahalanobis distance for all observations in x. 
Let <code class="reqn">\mathbf{x} = (x_{i1},...,x_{ip})'</code> be a p-dimensional random vector and 
<code class="reqn">\mathbf{u} = (u_{i1},...,u_{ip})'</code> be a p-dimensional vectors of zeros and ones indicating which entry is missing:
0 as missing and 1 as observed. Then partial mahalanobis distance is given by:
</p>
<p><code class="reqn"> d(\mathbf{x, u, m, \Sigma}) = (\mathbf{x^{(u)}} - \mathbf{m^{(u)}})' (\mathbf{\Sigma^{(u)}})^{-1}(\mathbf{x^{(u)}} - \mathbf{m^{(u)}})</code>.
</p>
<p>With no missing data, this function is equivalent to mahalanobis distance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">partial.mahalanobis(x, mu, Sigma)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame. May contain missing values, but cannot contain columns with completely missing entries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>location estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>scatter estimate. Must be positive definite</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An S4 object of class <code>CovRobMiss-class</code>.
The output S4 object contains the following slots:
</p>

<table>
<tr>
<td style="text-align: left;">
	<code>mu</code> </td>
<td style="text-align: left;"> Estimated location. Can be accessed via <code>getLocation</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
	<code>S</code> </td>
<td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code>getScatter</code>. </td>
</tr>
<tr>
<td style="text-align: left;"> 
	<code>pmd</code> </td>
<td style="text-align: left;"> Squared partial Mahalanobis distances. Can be accessed via <code>getDist</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
	<code>pmd.adj</code> </td>
<td style="text-align: left;"> Adjusted squared partial Mahalanobis distances. Can be accessed via <code>getDistAdj</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
	<code>pu</code> </td>
<td style="text-align: left;"> Dimension of the observed entries for each case. Can be accessed via <code>getDim</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
	<code>call</code> </td>
<td style="text-align: left;"> Object of class <code>"language"</code>. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
	<code>x</code> </td>
<td style="text-align: left;"> Input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
	<code>p</code> </td>
<td style="text-align: left;"> Column dimension of input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
	<code>estimator</code>
</td>
<td style="text-align: left;"> Character string of the name of the estimator used. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
	</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## suppose we would like to compute pmd for an MLE
x &lt;- matrix(rnorm(1000),100,10)
U &lt;- matrix(rbinom(1000,1,0.1),100,10)
x &lt;- x * ifelse(U==1,NA,1)
## compute MLE (i.e. EM in this case)
res &lt;- CovEM(x)
## compute pmd
res.pmd &lt;- partial.mahalanobis(x, mu=getLocation(res), S=getScatter(res))
summary(res.pmd)
plot(res.pmd, which="index")

## End(Not run)
</code></pre>


</div>