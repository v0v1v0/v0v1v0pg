<div class="container">

<table style="width: 100%;"><tr>
<td>fitDagLatent</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Gaussian DAG models with one latent variable</h2>

<h3>Description</h3>

<p>Fits by maximum likelihood a Gaussian DAG model where one of the nodes
of the graph is latent and it is marginalised over.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitDagLatent(amat, Syy, n, latent, norm = 1, seed,
             maxit = 9000, tol = 1e-06, pri = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amat</code></td>
<td>
<p>a square matrix with dimnames representing
the adjacency matrix of the DAG.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Syy</code></td>
<td>
<p>a symmetric positive definite matrix,
with dimnames, the sample covariance
matrix of the observed variables.
The set of the observed nodes of the graph must be a subset
of the set of the names of the variables in <code>Syy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a positive integer, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latent</code></td>
<td>
<p>the name of the latent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>an integer, the kind of normalization of the latent
variable.
If <code>norm=1</code>, the latent is scaled to have unit variance. If
<code>norm=2</code>, the latent is scaled to have unit partial variance
given its parents.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer, used by <code>set.seed</code> to specify a random
starting point of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an integer denoting the maximum number of iterations
allowed for the EM algorithm. If the convergence criterion is not
satisfied within maxit iterations the algorithms stops and a warning
message is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a small real value, denoting the tolerance used in testing convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pri</code></td>
<td>
<p>logical, if <code>pri=TRUE</code> then the value of the deviance at
each iteration is printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the EM algorithm used see Kiiveri (1987).  
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Shat</code></td>
<td>

<p>the fitted covariance matrix of all the variables
including the latent one. The latent variable is the last.
If <code>norm=1</code> then the variance of the latent variable
is constrained to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ahat</code></td>
<td>

<p>a square matrix of the fitted regression coefficients. The entry
<code>Ahat[i,j]</code> is minus the regression coefficient of variable
<code>i</code> in the regression equation <code>j</code>. Thus there is
a non zero partial regression coefficient <code>Ahat[i,j]</code>
corresponding to each non zero value  <code>amat[j,i]</code> in
the adjacency matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dhat</code></td>
<td>

<p>a vector containing the partial variances of each
variable given the parents. If <code>norm=2</code> then the
partial variance of the latent variable is constrained to 1. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev</code></td>
<td>

<p>the ‘deviance’ of the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>the degrees of freedom of the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>

<p>the number of EM algorithm iterations at convergence.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Giovanni M. Marchetti</p>


<h3>References</h3>

<p>Kiiveri,H. T. (1987). An incomplete data approach to the
analysis of covariance structures. <em>Psychometrika</em>, 52, 4,
539–554.
</p>
<p>Joreskog, K.G. and Goldberger, A.S. (1975). Estimation of a model
with multiple indicators and multiple causes of a single latent
variable.
<em>Journal of the American Statistical Association</em>, 10, 631–639.
</p>


<h3>See Also</h3>

<p><code>fitDag</code>, <code>checkIdent</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## data from Joreskog and Goldberger (1975)
V &lt;- matrix(c(1,     0.36,   0.21,  0.10,  0.156, 0.158,
              0.36,  1,      0.265, 0.284, 0.192, 0.324,
              0.210, 0.265,  1,     0.176, 0.136, 0.226,
              0.1,   0.284,  0.176, 1,     0.304, 0.305, 
              0.156, 0.192,  0.136, 0.304, 1,     0.344,
              0.158, 0.324,  0.226, 0.305, 0.344, 1),     6,6)
nod &lt;- c("y1", "y2", "y3", "x1", "x2", "x3")
dimnames(V) &lt;- list(nod,nod)
dag &lt;- DAG(y1 ~ z, y2 ~ z, y3 ~ z, z ~ x1 + x2 + x3, x1~x2+x3, x2~x3) 
fitDagLatent(dag, V, n=530, latent="z", seed=4564)
fitDagLatent(dag, V, n=530, latent="z", norm=2, seed=145)
</code></pre>


</div>