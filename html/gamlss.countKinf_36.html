<div class="container">

<table style="width: 100%;"><tr>
<td>KIBNB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>K-inflated Beta Negative Binomial distributions for fitting a GAMLSS model
</h2>

<h3>Description</h3>

<p>The function <code>KIBNB</code> defines the K-inflated  Beta Negative Binomial distribution, a four  parameter distribution, for a
<code>gamlss.family</code> object to be used in GAMLSS fitting  using the function <code>gamlss()</code>.The functions <code>dKIBNB</code>, <code>pKIBNB</code>,
<code>qKIBNB</code> and <code>rKIBNB</code> define the density, distribution function, quantile function and random generation for the K-inflated Beta Negative Binomia, <code>KIBNB()</code>, distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
 KIBNB(mu.link = "log", sigma.link = "log", nu.link = "log",
            tau.link = "logit", kinf="K")

dKIBNB(x, mu = 1, sigma = 1, nu = 1, tau = 0.1, kinf=0, log = FALSE)

pKIBNB(q, mu = 1, sigma = 1, nu = 1, tau = 0.1, kinf=0, lower.tail = TRUE,
            log.p = FALSE)

qKIBNB(p, mu = 1, sigma = 1, nu = 1, tau = 0.1, kinf=0, lower.tail = TRUE,
            log.p = FALSE, max.value = 10000)

rKIBNB(n, mu = 1, sigma = 1, nu = 1, tau = 0.1, kinf=0, max.value = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu.link</code></td>
<td>
<p> Defines the <code>mu.link</code>, with "log" link as the default for the mu parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.link</code></td>
<td>
<p>Defines the  <code>sigma.link</code>, with "log" link as the default for the sigma parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu.link</code></td>
<td>
<p>Defines the <code>nu.link</code>, with "log" link as the default for the nu parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.link</code></td>
<td>
<p>Defines the <code>tau.link</code>, with "logit" link as the default for the tau parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> vector of (non-negative integer) quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of positive means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of positive despersion parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>vector of nu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>vector of inflated point probability </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random values to return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinf</code></td>
<td>
<p> defines inflated point in generating K-inflated distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log,log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.value</code></td>
<td>
<p> a constant, set to the default value of 10000 for how far the algorithm should look for q</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The  definition for the K-inflated Beta Negative Binomial distribution.
</p>


<h3>Value</h3>

<p>The functions <code>KIBNB</code> return a <code>gamlss.family</code> object which can be used to fit K-inflated Beta Negative Binomial distribution in the <code>gamlss()</code> function.
</p>


<h3>Author(s)</h3>

<p>Saeed Mohammadpour &lt;<a href="mailto:s.mohammadpour1111@gamlil.com">s.mohammadpour1111@gamlil.com</a>&gt;, Mikis Stasinopoulos &lt;<a href="mailto:d.stasinopoulos@londonmet.ac.uk">d.stasinopoulos@londonmet.ac.uk</a>&gt;
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion),<em>Appl. Statist.</em>,<b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2006) Instructions on how to use the GAMLSS package in R. Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>
<p>Rigby, R. A. and Stasinopoulos D. M. (2010) The gamlss.family distributions, (distributed with this package or see<a href="http://www.gamlss.org/">http://www.gamlss.org/</a>)
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>, Chapman and Hall/CRC.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>, Chapman and Hall/CRC.
</p>
<p>Najafabadi, A. T. P. and MohammadPour, S. (2017). A k-Inflated Negative Binomial Mixture Regression Model: Application to Rate-Making Systems. Asia-Pacific Journal of Risk and Insurance, 12.
</p>


<h3>See Also</h3>

<p><code>gamlss.family</code>, <code>KIBNB</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">#-------------------------------------------------------------------------------

KIBNB() # gives information about the default links for the  Beta Negative Binomial distribution
#-------------------------------------------------------------------------------

# generate zero inflated Beta Negative Binomial distribution
gen.Kinf(family=BNB, kinf=0)

# generate random sample from zero inflated Beta Negative Binomial distribution
x&lt;-rinf0BNB(1000,mu=1, sigma=.5, nu=.2, tau=.2)

# fit the zero inflated Beta Negative Binomial distribution using gamlss
data&lt;-data.frame(x=x)
## Not run: 
gamlss(x~1, family=inf0BNB, data=data)
histDist(x, family=inf0BNB)
## End(Not run)
#-------------------------------------------------------------------------------

# generated one inflated Beta Negative Binomial distribution
gen.Kinf(family=BNB, kinf=1)

# generate random sample from one inflated Beta Negative Binomial distribution
x&lt;-rinf1BNB(1000,mu=1, sigma=.5, nu=.2, tau=.2)

# fit the one inflated Beta Negative Binomial distribution using gamlss
data&lt;-data.frame(x=x)
## Not run: 
gamlss(x~1, family=inf1BNB, data=data)
histDist(x, family=inf1BNB)
## End(Not run)
#-------------------------------------------------------------------------------

mu=4; sigma=.5; nu=.2; tau=.2;
par(mgp=c(2,1,0),mar=c(4,4,4,1)+0.1)

#plot the pdf using plot
plot(function(x) dinf1BNB(x, mu=mu, sigma=sigma, nu=nu, tau=tau), from=0, to=20,
n=20+1, type="h",xlab="x",ylab="f(x)",cex.lab=1.5)
#-------------------------------------------------------------------------------

#plot the cdf using plot
cdf &lt;- stepfun(0:19, c(0,pinf1BNB(0:19, mu=mu, sigma=sigma, nu=nu, tau=tau)), f = 0)
plot(cdf, xlab="x", ylab="F(x)", verticals=FALSE, cex.points=.8, pch=16, main="",cex.lab=1.5)
#-------------------------------------------------------------------------------

#plot the qdf using plot
invcdf &lt;- stepfun(seq(0.01,.99,length=19), qinf1BNB(seq(0.1,.99,length=20),mu, sigma), f = 0)
plot(invcdf, ylab=expression(x[p]==F^{-1}(p)), do.points=FALSE,verticals=TRUE,
     cex.points=.8, pch=16, main="",cex.lab=1.5, xlab="p")
#-------------------------------------------------------------------------------

# generate random sample
Ni &lt;- rinf1BNB(1000, mu=mu, sigma=sigma, nu=nu, tau=tau)
 hist(Ni,breaks=seq(min(Ni)-0.5,max(Ni)+0.5,by=1),col="lightgray", main="",cex.lab=2)
barplot(table(Ni))
#-------------------------------------------------------------------------------
</code></pre>


</div>