<div class="container">

<table style="width: 100%;"><tr>
<td>gemOLG_PublicFirm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Some Examples of (Timeline) OLG Models with Production and Public Firms</h2>

<h3>Description</h3>

<p>Some examples of (timeline) OLG models with production and public firms (see <cite>gemIntertemporal_PublicFirm</cite>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gemOLG_PublicFirm(...)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to the function sdm2.</p>
</td>
</tr></table>
<h3>See Also</h3>

<p><cite>gemIntertemporal_PublicFirm</cite>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
ng &lt;- 8 # the number of generations
alpha.firm &lt;- 2 # the efficient parameter of firms
beta.prod.firm &lt;- 0.5 # the product (i.e. capital) share parameter of firms
beta.consumer &lt;- c(1 / 3, 1 / 3, 1 / 3) # the share parameter of consumers
gr.laborer &lt;- 0 # the population growth rate
labor.first &lt;- c(50, 50, 0) # the labor supply of the first generation
# the labor supply of the last generation.
labor.last &lt;- 50 * (1 + gr.laborer)^((ng - 1):(ng + 1))
y1 &lt;- 100 # the initial product supply

policy.PublicFirm &lt;- function(state) {
  for (k in 1:(ng + 1)) {
    state$S[k + 1, k + 1] &lt;- state$S[k + 1, k]
    state$S[k + 1, k] &lt;- 0
  }
  state
}

f &lt;- function(policy = policy.PublicFirm) {
  names.commodity &lt;- c(paste0("prod", 1:(ng + 2)), paste0("lab", 1:(ng + 2)))
  names.agent &lt;- c(paste0("firm", 1:(ng + 2)), paste0("consumer", 1:ng))

  n &lt;- length(names.commodity) # the number of commodity kinds
  m &lt;- length(names.agent) # the number of agent kinds

  # the exogenous supply matrix.
  S0Exg &lt;- matrix(NA, n, m, dimnames = list(names.commodity, names.agent))
  for (k in 1:(ng - 1)) {
    S0Exg[paste0("lab", k:(k + 2)), paste0("consumer", k)] &lt;-
      labor.first * (1 + gr.laborer)^(k - 1)
  }
  S0Exg[paste0("lab", ng:(ng + 2)), paste0("consumer", ng)] &lt;- labor.last
  S0Exg["prod1", "firm1"] &lt;- y1

  B &lt;- matrix(0, n, m, dimnames = list(names.commodity, names.agent))
  for (k in 1:(ng + 1)) {
    B[paste0("prod", k + 1), paste0("firm", k)] &lt;- 1
  }

  dstl.consumer &lt;- list()
  for (k in 1:ng) {
    dstl.consumer[[k]] &lt;- node_new(
      "util",
      type = "CD", alpha = 1,
      beta = beta.consumer,
      paste0("prod", k:(k + 2))
    )
  }

  dstl.firm &lt;- list()
  for (k in 1:(ng + 2)) {
    dstl.firm[[k]] &lt;- node_new(
      "prod",
      type = "CD", alpha = alpha.firm,
      beta = c(beta.prod.firm, 1 - beta.prod.firm),
      paste0("prod", k), paste0("lab", k)
    )
  }

  ge &lt;- sdm2(
    A = c(dstl.firm, dstl.consumer),
    B = B,
    S0Exg = S0Exg,
    names.commodity = names.commodity,
    names.agent = names.agent,
    numeraire = "lab1",
    priceAdjustmentVelocity = 0.05,
    policy = policy
  )

  cat("ge$p:\n")
  print(ge$p)
  cat("ge$z:\n")
  print(ge$z)
  invisible(ge)
}

ge &lt;- f()

# the growth rates of prices
growth_rate(ge$p[paste0("prod", 1:ng)]) + 1
growth_rate(ge$p[paste0("lab", 1:ng)]) + 1

##
labor.first &lt;- c(100 / 3, 100 / 3, 100 / 3) # the labor supply of the first generation
ge &lt;- f()

##
tax.rate &lt;- 0.1
policy.PublicFirm.Tax &lt;- function(state) {
  for (k in 1:(ng + 1)) {
    state$S[k + 1, k + 1] &lt;- state$S[k + 1, k] * (1 - tax.rate)
    state$S[k + 1, k + ng] &lt;- state$S[k + 1, k] * tax.rate
    state$S[k + 1, k] &lt;- 0
  }
  state
}

ge &lt;- f(policy.PublicFirm.Tax)

##
beta.consumer &lt;- c(1 / 2, 1 / 2, 0) # the share parameter of consumers
labor.first &lt;- c(90, 10, 0) # the labor supply of the first generation
ge &lt;- f()

</code></pre>


</div>