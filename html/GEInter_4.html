<div class="container">

<table style="width: 100%;"><tr>
<td>bic.PTReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BIC for PTReg</h2>

<h3>Description</h3>

<p>Selects a point along the regularization path of a fitted <code>PTReg</code> object according to
the BIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bic.PTReg(
  G,
  E,
  Y,
  lambda1_set,
  lambda2_set,
  gamma1,
  gamma2,
  max_init,
  h = NULL,
  tau = 0.4,
  mu = 2.5,
  family = c("continuous", "survival")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Input matrix of <code>p</code> genetic (G) measurements consisting of <code>n</code> rows.
Each row is an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Input matrix of <code>q</code> environmental (E) risk factors. Each row is an
observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response variable. A quantitative vector for <code>family="continuous"</code>.
For <code>family="survival"</code>, <code>Y</code> should be a two-column matrix with the first column being
the log(survival time) and the second column being the censoring indicator. The indicator is a
binary variable, with "1" indicating dead, and "0" indicating right censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1_set</code></td>
<td>
<p>A user supplied lambda sequence for minimax concave penalty (MCP)
accommodating main G effect selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2_set</code></td>
<td>
<p>A user supplied lambda sequence for MCP accommodating interaction selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma1</code></td>
<td>
<p>The regularization parameter of the MCP penalty corresponding to G effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma2</code></td>
<td>
<p>The regularization parameter of the MCP penalty corresponding to G-E interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_init</code></td>
<td>
<p>The number of initializations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>The number of the trimmed samples if the parameter <code>mu</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The threshold value used in stability selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The parameter for screening outliers with extreme absolute residuals if the number of
the trimmed samples <code>h</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Response type of <code>Y</code> (see above).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with S3 class <code>"bic.PTReg"</code> is returned, which is a list with the ingredients of the BIC fit.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call that produced this object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The matrix of the coefficients for main E effects, each column corresponds to one
combination of (lambda1,lambda2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The coefficients for main G effects and G-E interactions, each column corresponds to
one combination of (lambda1,lambda2). For each column, the first element is the first G effect and
the second to (<code>q+1</code>) elements are the interactions for the first G factor, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Matrix of the intercept estimate, each column corresponds to one combination of
(lambda1,lambda2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The number of nonzeros for each value of (lambda1,lambda2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>Bayesian Information Criterion for each value of (lambda1,lambda2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The same as input <code>family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept_estimate</code></td>
<td>
<p>Final intercept estimate using Bayesian Information Criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_estimate</code></td>
<td>
<p>Final alpha estimate using Bayesian Information Criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_estimate</code></td>
<td>
<p>Final beta estimate using Bayesian Information Criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_combine</code></td>
<td>
<p>Matrix of (lambda1, lambda2), with the first column being the values of
lambda1, the second being the values of lambda2.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Yaqing Xu, Mengyun Wu, Shuangge Ma, and Syed Ejaz Ahmed.
<em>Robust gene-environment interaction analysis using penalized trimmed regression. Journal of
Statistical Computation and Simulation, 88(18):3502-3528, 2018.</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sigmaG&lt;-AR(rho=0.3,p=30)
sigmaE&lt;-AR(rho=0.3,p=3)
set.seed(300)
G=MASS::mvrnorm(150,rep(0,30),sigmaG)
EC=MASS::mvrnorm(150,rep(0,2),sigmaE[1:2,1:2])
ED = matrix(rbinom((150),1,0.6),150,1)
E=cbind(EC,ED)
alpha=runif(3,0.8,1.5)
beta=matrix(0,4,30)
beta[1,1:4]=runif(4,1,1.5)
beta[2,c(1,2)]=runif(2,1,1.5)
lambda1_set=lambda2_set=c(0.2,0.25,0.3,0.35,0.4,0.5)


#continuous response with outliers/contaminations in response variable
y1=simulated_data(G,E,alpha,beta,error=c(rnorm(140),rcauchy(10,0,5)),family="continuous")
fit1&lt;-bic.PTReg(G,E,y1,lambda1_set,lambda2_set,gamma1=6,gamma2=6,
max_init=50,tau=0.6,mu=2.5,family="continuous")
coefficients1=coefficients(fit1)
y_predict=predict(fit1,E,G)
plot(fit1)

# survival with Normal error
y2=simulated_data(G,E,alpha,beta,rnorm(150,0,1),family="survival",0.7,0.9)
fit2&lt;-bic.PTReg(G,E,y2,lambda1_set,lambda2_set,gamma1=6,gamma2=6,
max_init=50,tau=0.6,mu=2.5,family="survival")
coefficients2=coefficients(fit2)
y_predict=predict(fit2,E,G)
plot(fit2)

</code></pre>


</div>