<div class="container">

<table style="width: 100%;"><tr>
<td>ggoutlier_geoKNN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GGoutlieR with the geographical KNN approach</h2>

<h3>Description</h3>

<p>identify samples genetically different from K nearest geographical neighbors (geographical KNN). For the details of the outlier detection approach, please see the supplementary material of Chang and Schmid 2023 (doi:https://doi.org/10.1101/2023.04.06.535838)
</p>


<h3>Usage</h3>

<pre><code class="language-R">ggoutlier_geoKNN(
  geo_coord,
  gen_coord,
  min_nn_dist = 100,
  k = NULL,
  klim = c(3, 50),
  s = 100,
  make_fig = FALSE,
  plot_dir = ".",
  w_power = 1,
  p_thres = 0.05,
  n = 10^6,
  multi_stages = TRUE,
  maxIter = NULL,
  keep_all_stg_res = FALSE,
  warning_minR2 = 0.9,
  cpu = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geo_coord</code></td>
<td>
<p>matrix or data.frame with two columns. The first column is longitude and the second one is latitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen_coord</code></td>
<td>
<p>matrix. A matrix of "coordinates in a genetic space". Users can provide ancestry coefficients or eigenvectors for calculation. If, for example, ancestry coefficients are given, each column corresponds to an ancestral population. Samples are ordered in rows as in 'geo_coord'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_nn_dist</code></td>
<td>
<p>numeric. A minimal geographical distance for searching KNNs. Neighbors of a focal sample within this distance will be excluded from the KNN searching procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer. Number of the nearest neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>klim</code></td>
<td>
<p>vector. A range of K to search for the optimal number of nearest neighbors. The default is 'klim = c(3, 50)'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>integer. A scalar of geographical distance. The default 's=100' scales the distance to a unit of 0.1 kilometer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>make_fig</code></td>
<td>
<p>logic. If 'make_fig = TRUE', plots for diagnosing GGoutlieR analysis will be generated and saved to 'plot_dir'. The default is 'FALSE'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_dir</code></td>
<td>
<p>string. The path to save plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_power</code></td>
<td>
<p>numeric. A value controlling the power of distance weight in geographical KNN prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_thres</code></td>
<td>
<p>numeric. A significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric. A number of random samples to draw from the null distribution for making a graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi_stages</code></td>
<td>
<p>logic. A multi-stage test will be performed if is 'TRUE' (the default is 'TRUE').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>numeric. Maximal iteration number of multi-stage KNN test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_all_stg_res</code></td>
<td>
<p>logic. Results from all iterations of the multi-stage test will be retained if it is'TRUE'. (the default is 'FALSE')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warning_minR2</code></td>
<td>
<p>numeric. The prediction accuracy of KNN is evaluated as R^2 to assess the violation of isolation-by-distance expectation. If any R^2 is larger than 'warning_minR2', a warning message will be reported at the end of your analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpu</code></td>
<td>
<p>integer. Number of CPUs to use for searching the optimal K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logic. If 'verbose = FALSE', 'ggoutlier' will suppress printout messages.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of 'list' including five items. 'statistics' is a 'data.frame' consisting of the 'D genetics' ("Dg") values, p values and a column of logic values showing if a sample is an outlier or not. 'threshold' is a 'data.frame' recording the significance threshold. 'gamma_parameter' is a vector recording the parameter of the heuristic Gamma distribution. 'knn_index' and 'knn_name' are a 'data.frame' recording the K nearest neighbors of each sample.
</p>


</div>