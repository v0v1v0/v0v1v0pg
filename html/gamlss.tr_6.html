<div class="container">

<table style="width: 100%;"><tr>
<td>trun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a Truncate Distribution from a gamlss.family</h2>

<h3>Description</h3>

<p>This function can be used to fit truncated distributions. It takes as an argument an existing GAMLSS family distribution and 
a parameter vector,  of the type c(left.value, right.value), and  generates a <code>gamlss.family</code> object which then can be used to fit 
a truncated distribution.    
</p>


<h3>Usage</h3>

<pre><code class="language-R">trun(par = c(0), family = "NO",  type = c("left", "right", "both"), name = "tr", 
        local = TRUE, delta=NULL, varying = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p> a vector with one (for <code>"left"</code> or <code>"right"</code> truncation) or two elements for <code>"both"</code>. When the argument <code>varying = TRUE</code> then <code>par</code> can be a vector or a matrix with two columns respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>an existing <code>gamlss.family</code> distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>what type of truncation is required, <code>left</code>, <code>right</code> or <code>both</code>. If <code>both</code> the <code>par</code> should be a vector of length two. (the default is left truncation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>a character string to be added to name of the created object i.e. with <code>family=TF</code> and <code>name=trZero</code> the <code>gamlss.family</code> object will be called <code>TFtrZero</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local</code></td>
<td>
<p>if TRUE the function will try to find the environment of <code>gamlss</code> to generate the <code>d</code> and <code>p</code> functions required for the fitting, if FALSE the functions will be generated in the global environment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the delta increment used in the numerical derivatives</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varying</code></td>
<td>
<p>whether the truncation  varies for diferent observations. This can be usefull in regression analysis. If <code>varying = TRUE</code> then <code>par</code> should be an n-length vector for <code>type</code> equal <code>"left"</code> and <code>"right"</code> and an n by 2 matrix for <code>type="both"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra arguments </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is created to help the user to fit a truncated form of existing <code>gamlss</code> distribution.
It does this by taking an existing <code>gamlss.family</code> and changing some of the components of the distribution to help the fitting process. 
It particular it i) creates a pdf (<code>d</code>) and a cdf (<code>p</code>) function within <code>gamlss</code>, 
ii) changes  the global deviance function <code>G.dev.incr</code>, the first derivative functions (see note below) and the quantile residual function.   
</p>


<h3>Value</h3>

<p>It returns a <code>gamlss.family</code> object which has all the components needed for fitting a distribution in <code>gamlss</code>. 
</p>


<h3>Note</h3>

<p>This function is experimental and could be changed. The function <code>trun</code>  changes 
the first derivatives of the original gamlss family <code>d</code> function to numerical derivatives 
for the new truncated <code>d</code> function. The default increment <code>delta</code>,
for this numerical derivatives function, is <code>eps * pmax(abs(x), 1)</code> where 
<code>eps&lt;-sqrt(.Machine$double.eps)</code>.  The default <code>delta</code> could be inappropriate 
for specific applications and can be overwritten by using the argument <code>delta</code>.</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Bob Rigby</p>


<h3>References</h3>

<p> Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).</p>


<h3>See Also</h3>

<p><code>trun.d</code>, <code>trun.p</code>, <code>trun.q</code>, <code>trun.r</code>,  <code>gen.trun</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># generate a left truncated zero t family
gen.trun(0,family="TF")
# take a random sample of 1000 observations
sam&lt;-rTFtr(1000,mu=10,sigma=5, nu=5 )
hist(sam)
# fit the distribution to the data
mod1&lt;-gamlss(sam~1, family=trun(0,TF))
mod1
# now create a gamlss.family object before the fitting 
Ttruc.Zero&lt;- trun(par=0,family=TF, local=FALSE)
mod2&lt;-gamlss(sam~1, family=Ttruc.Zero)
# now check the sensitivity of delta 
Ttruc.Zero&lt;- trun(par=0,family=TF, local=FALSE, delta=c(0.01,0.01, 0.01))
mod3&lt;-gamlss(sam~1, family=Ttruc.Zero)
</code></pre>


</div>