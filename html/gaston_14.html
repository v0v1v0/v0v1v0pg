<div class="container">

<table style="width: 100%;"><tr>
<td>bed.loadings</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> SNP loadings </h2>

<h3>Description</h3>

<p> Compute the loadings corresponding to given PCs. </p>


<h3>Usage</h3>

<pre><code class="language-R"> bed.loadings(x, pc) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A <code>bed.matrix</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p> A matrix with Principal Components in columns </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p> A matrix with the corresponding loadings in columns. </p>


<h3>Author(s)</h3>

<p> Herv√© Perdry and Claire Dandine-Roulland </p>


<h3>Examples</h3>

<pre><code class="language-R"># load chr2 data set (~10k SNPs in low LD)
x &lt;- read.bed.matrix( system.file("extdata", "chr2.bed", package="gaston") )

# Compute Genetic Relationship Matrix
standardize(x) &lt;- "p"
K &lt;- GRM(x)

# Eigen decomposition
eiK &lt;- eigen(K)
# deal with small negative eigen values
eiK$values[ eiK$values &lt; 0 ] &lt;- 0

# Note: the eigenvectors are normalized, to compute 'true' PCs
# multiply them by the square root of the associated eigenvalues
PC &lt;- sweep(eiK$vectors, 2, sqrt(eiK$values), "*")

# Compute loadings for the 2 first PCs 
# one can use PC[,1:2] instead of eiK$vectors[,1:2] as well
L &lt;- bed.loadings(x, eiK$vectors[,1:2])
dim(L)
head(L)

# the loadings are normalized
colSums(L**2)

# Verify that these are loadings
head( (x %*% L) / sqrt(ncol(x)-1) )
head( PC[,1:2] )

</code></pre>


</div>