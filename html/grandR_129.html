<div class="container">

<table style="width: 100%;"><tr>
<td>PlotHeatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create heatmaps from grandR objects</h2>

<h3>Description</h3>

<p>Convenience method to compare among more two variables (slot data or analyses results).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotHeatmap(
  data,
  type = DefaultSlot(data),
  columns = NULL,
  genes = NULL,
  summarize = NULL,
  transform = "Z",
  cluster.genes = TRUE,
  cluster.columns = FALSE,
  label.genes = NULL,
  xlab = NULL,
  breaks = NULL,
  colors = NULL,
  title = NULL,
  return.matrix = FALSE,
  na.to = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the grandR object that contains the data to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Either a mode.slot (see details) or a regex to be matched against analysis names. Can also be a vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>a vector of columns (either condition/cell names if the type is a mode.slot, or names in the output table from an analysis; use Columns(data,&lt;analysis&gt;) to learn which columns are available); all condition/cell names if NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes</code></td>
<td>
<p>the genes to be included in the plot (default: all genes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summarize</code></td>
<td>
<p>Should replicates by summarized? Can only be specified if columns is NULL; either a summarization matrix (GetSummarizeMatrix) or TRUE (in which case GetSummarizeMatrix(data) is called)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>apply a transformation to the selected data; can be a function, or a character (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.genes</code></td>
<td>
<p>should genes be clustered?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.columns</code></td>
<td>
<p>should samples (or cells) be clustered?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.genes</code></td>
<td>
<p>should genes be labeled?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>The names to show at the x axis (only works if type is a single slot)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>vector of color breaks; can be NULL (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>an RColorBrewer palette name; can be NULL (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>the title for the plot; can be NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.matrix</code></td>
<td>
<p>if TRUE, return a list containing the data matrix and the heatmap instead of the heatmap alone</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.to</code></td>
<td>
<p>convert NA values in the matrix to this value immediately before computing the heatmap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters forwarded to Heatmap</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is just a convenience function which
</p>

<ol>
<li>
<p>Calls GetTable with the parameter <code>type,columns,summarize,genes</code>
</p>
</li>
<li>
<p>Transforms the returned table using the <code>transform</code> parameter
</p>
</li>
<li>
<p>Determines reasonable colors using <code>breaks</code> and <code>colors</code>
</p>
</li>
<li>
<p>and then calls ComplexHeatmap::Heatmap
</p>
</li>
</ol>
<p><code>type</code> and <code>columns</code> can refer to values from data slots values from analyses (and can be mixed).
If there are types from both data and analyses, columns must be NULL.
Otherwise columns must either be condition/cell names (if type refers to one or several data slots), or regular expressions
to match against the names in the analysis tables.
</p>
<p>Columns definitions for data slots can be given as a logical, integer or character vector representing a selection of the columns (samples or cells).
The expression is evaluated in an environment having the <code>Coldata</code>, i.e. you can use names of <code>Coldata</code> as variables to
conveniently build a logical vector (e.g., columns=Condition=="x").
</p>
<p>To refer to data slots, the mode.slot syntax can be used: Each name is either a data slot, or one of (new,old,total)
followed by a dot followed by a slot. For new or old, the data slot value is multiplied by ntr or 1-ntr. This can be used e.g. to obtain the <em>new counts</em>.
</p>
<p>The transform parameter either is a function that transforms a matrix (which can conveniently be done using the Transform.XXX functions described next), or
a character (which must be the XXX to find such a function). Available data transformations are
</p>

<ul>
<li>
<p>transform=Transform.Z() or transform="Z": compute z scores for each row (see Transform.Z)
</p>
</li>
<li>
<p>transform=Transform.VST() or transform="VST": do a variance stabilizing transformation (see Transform.VST)
</p>
</li>
<li>
<p>transform=Transform.logFC() or transform="logFC": compute log2 fold changes to one or several reference columns; which must be defined via parameters (see Transform.logFC)
</p>
</li>
<li>
<p>transform=Transform.no() or transform="no": do not transform (see Transform.no)
</p>
</li>
</ul>
<p>Reasonable coloring is chosen depending on the value distribution in the matrix. If the values are zero centered (e.g. z scores or most often log fold changes), then
by default the 50
quantile with the larger value. The breaks are -q90,q50,0,q50,q90, and, by default, the red to blue "RdBu" palette from RColorBrewer is taken. If the values are not zero centered,
the 5
</p>
<p>xlab can be given as a character vector or an expression that evaluates into a character vector.
The expression is evaluated in an environment having the <code>Coldata</code>, i.e. you can use names of <code>Coldata</code> as variables.
</p>


<h3>Value</h3>

<p>a ComplexHeatmap object
</p>


<h3>See Also</h3>

<p>GetTable,Heatmap
</p>


</div>