<div class="container">

<table style="width: 100%;"><tr>
<td>test_genesets_gsea</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GSEA as implemented in the fgsea R package</h2>

<h3>Description</h3>

<p>In most cases, it's more convenient to call the more generic <code>test_genesets</code> function which also deals with multiple-testing correction (per geneset source)
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_genesets_gsea(
  genesets,
  genelist,
  score_type = NULL,
  parallel_threads = 1L,
  gseaParam = 1,
  nPermSimple = 50000,
  gsea_genelist_col = NULL,
  gsea_scoretype = NULL,
  random_seed = 123
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genesets</code></td>
<td>
<p>data.frame/tibble with geneset and gene columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genelist</code></td>
<td>
<p>data.frame/tibble with gene and score columns. Should contain columns gene and either pvalue or effectsize, depending on <code>score_type</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score_type</code></td>
<td>
<p>how to compute gene scores? options: "pvalue", "effectsize", "custom".
Option "pvalue" uses -log10 transformed values from the pvalue column in <code>genelist</code>.
Option "effectsize" uses values from the effectsize column in <code>genelist</code> as-is.
Option "custom" expects 2 additional parameters; <code>gsea_genelist_col</code> should be a column name in <code>genelist</code> to be used for fGSEA (values used as-is), <code>gsea_scoretype</code> should be the respective value for the fGSEA scoreType parameter ('pos', 'neg' or 'std)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel_threads</code></td>
<td>
<p>number of threads to use for parallel processing. Set to 0 to automatically select all available processors/cores, set to 1 to disable (default) or to N to use N processes.
Note that multiprocessing sometimes breaks on RStudio + Windows, hence this parameter is set to 1 to disable multiprocessing by default for now</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gseaParam</code></td>
<td>
<p>passed to <code>fgsea::fgsea()</code>, from manual: "GSEA parameter value, all gene-level statis are raised to the power of 'gseaParam' before calculation of GSEA enrichment scores.". default = 1. Further comments by fGSEA author at https://github.com/ctlab/fgsea/issues/45</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPermSimple</code></td>
<td>
<p>passed to <code>fgsea::fgsea()</code>, from manual: "Number of permutations in the simple fgsea implementation for preliminary estimation of P-values.". default = 50000 in this R package but 1000 by default in fGSEA v1.22.0; we observed much better accuracy in null simulations when increasing this from default 1k to 10k and further minor improvement towards 50k, hence the latter is our default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gsea_genelist_col</code></td>
<td>
<p>optional, only used for <code>score_type</code> "custom"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gsea_scoretype</code></td>
<td>
<p>optional, only used for <code>score_type</code> "custom"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_seed</code></td>
<td>
<p>the random seed that is passed to <code>set.seed()</code> in order to ensure fgsea results are reproducible. default: 123</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>input <code>genesets</code> table with results in the "pvalue", "score_type" and "gsea_nes" columns
</p>


<h3>See Also</h3>

<p><code>test_genesets</code>
</p>


</div>