<div class="container">

<table style="width: 100%;"><tr>
<td>cols_add</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add one or more columns to a <strong>gt</strong> table</h2>

<h3>Description</h3>

<p>We can add new columns to a table with <code>cols_add()</code> and it works quite a bit
like <code>dplyr::mutate()</code> does. The idea is that you supply name-value pairs
where the name is the new column name and the value part describes the data
that will go into the column. The latter can: (1) be a vector where the
length of the number of rows in the data table, (2) be a single value
(which will be repeated all the way down), or (3) involve other columns in
the table (as they represent vectors of the correct length). The new columns
are added to the end of the column series by default but can instead be added
internally by using either the <code>.before</code> or <code>.after</code> arguments. If entirely
empty (i.e., all <code>NA</code>) columns need to be added, you can use any of the <code>NA</code>
types (e.g., <code>NA</code>, <code>NA_character_</code>, <code>NA_real_</code>, etc.) for such columns.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cols_add(.data, ..., .before = NULL, .after = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p><em>The gt table data object</em>
</p>
<p><code style="white-space: pre;">⁠obj:&lt;gt_tbl&gt;⁠</code> // <strong>required</strong>
</p>
<p>This is the <strong>gt</strong> table object that is commonly created through use of the
<code>gt()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><em>Cell data assignments</em>
</p>
<p><code style="white-space: pre;">⁠&lt;multiple expressions&gt;⁠</code> // (or, use <code>.list</code>)
</p>
<p>Expressions for the assignment of cell values to the new columns.
Name-value pairs, in the form of <code style="white-space: pre;">⁠&lt;column&gt; = &lt;value vector&gt;⁠</code> will work, so
long as any <code style="white-space: pre;">⁠&lt;column&gt;⁠</code> value does not already exist in the table. The
<code style="white-space: pre;">⁠&lt;value vector&gt;⁠</code> may be an expression that uses one or more column names in
the table to generate a vector of values. Single values in <code style="white-space: pre;">⁠&lt;value vector&gt;⁠</code>
will be repeated down the new column. A vector where the length is exactly
the number of rows in the table can also be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.before, .after</code></td>
<td>
<p><em>Column used as anchor</em>
</p>
<p><code style="white-space: pre;">⁠&lt;column-targeting expression&gt;⁠</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>A single column-resolving expression or column index can be given to either
<code>.before</code> or <code>.after</code>. The column specifies where the new columns should be
positioned among the existing columns in the input data table. While select
helper functions such as <code>starts_with()</code> and <code>ends_with()</code> can be used for
column targeting, it's recommended that a single column name or index be
used. This is to ensure that exactly one column is provided to either of
these arguments (otherwise, the function will be stopped). If nothing is
provided for either argument then any new column will be placed at the end
of the column series.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gt_tbl</code>.
</p>


<h3>Targeting the column for insertion with <code>.before</code> or <code>.after</code>
</h3>

<p>The targeting of a column for insertion is done through the <code>.before</code> or
<code>.after</code> arguments (only one of these options should be be used). While
<strong>tidyselect</strong>-style expressions or indices can used to target a column, it's
advised that a single column name be used. This is to avoid the possibility
of inadvertently resolving multiple columns (since the requirement is for a
single column).
</p>


<h3>Examples</h3>

<p>Let's take a subset of the <code>exibble</code> dataset and make a simple <strong>gt</strong> table
with it (using the <code>row</code> column for labels in the stub). We'll add a single
column to the right of all the existing columns and call it <code>country</code>. This
new column needs eight values and these will be supplied when using
<code>cols_add()</code>.
</p>
<div class="sourceCode r"><pre>exibble |&gt;
  dplyr::select(num, char, datetime, currency, group) |&gt;
  gt(rowname_col = "row") |&gt;
  cols_add(
    country = c("TL", "PY", "GL", "PA", "MO", "EE", "CO", "AU")
  )
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_cols_add_1.png" alt="This image of a table was generated from the first code example in the `cols_add()` help file." style="width:100%;"><p>We can add multiple columns with a single use of <code>cols_add()</code>. The columns
generated can be formatted and otherwise manipulated just as any column could
be in a <strong>gt</strong> table. The following example extends the first one by adding
more columns and immediately using them in various function calls like
<code>fmt_flag()</code> and <code>fmt_units()</code>.
</p>
<div class="sourceCode r"><pre>exibble |&gt;
  dplyr::select(num, char, datetime, currency, group) |&gt;
  gt(rowname_col = "row") |&gt;
  cols_add(
    country = c("TL", "PY", "GL", "PA", "MO", "EE", "CO", "AU"),
    empty = NA_character_,
    units = c(
      "k m s^-2", "N m^-2", "degC", "m^2 kg s^-2",
      "m^2 kg s^-3", "/s", "A s", "m^2 kg s^-3 A^-1"
    ),
    big_num = num ^ 3
  ) |&gt;
  fmt_flag(columns = country) |&gt;
  sub_missing(columns = empty, missing_text = "") |&gt;
  fmt_units(columns = units) |&gt;
  fmt_scientific(columns = big_num)
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_cols_add_2.png" alt="This image of a table was generated from the second code example in the `cols_add()` help file." style="width:100%;"><p>In this table generated from a portion of the <code>towny</code> dataset, we add two
new columns (<code>land_area</code> and <code>density</code>) through a single use of <code>cols_add()</code>.
The new <code>land_area</code> column is a conversion of land area from square
kilometers to square miles and the <code>density</code> column is calculated by through
division of <code>population_2021</code> by that new <code>land_area</code> column. We hide the
now unneeded <code>land_area_km2</code> with <code>cols_hide()</code> and also perform some column
labeling and adjustments to column widths with <code>cols_label()</code> and
<code>cols_width()</code>.
</p>
<div class="sourceCode r"><pre>towny |&gt;
  dplyr::select(name, population_2021, land_area_km2) |&gt;
  dplyr::filter(population_2021 &gt; 100000) |&gt;
  dplyr::slice_max(population_2021, n = 10) |&gt;
  gt() |&gt;
  cols_add(
    land_area = land_area_km2 / 2.58998811,
    density = population_2021 / land_area
  ) |&gt;
  fmt_integer() |&gt;
  cols_hide(columns = land_area_km2) |&gt;
  cols_label(
    population_2021 = "Population",
    density = "Density, {{*persons* / sq mi}}",
    land_area ~ "Area, {{mi^2}}"
  ) |&gt;
  cols_width(everything() ~ px(120))
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_cols_add_3.png" alt="This image of a table was generated from the third code example in the `cols_add()` help file." style="width:100%;"><p>It's possible to start with an empty table (i.e., no columns and no rows) and
add one or more columns to that. You can, for example, use <code>dplyr::tibble()</code>
or <code>data.frame()</code> to create a completely empty table. The first <code>cols_add()</code>
call for an empty table can have columns of arbitrary length but subsequent
uses of <code>cols_add()</code> must adhere to the rule of new columns being the same
length as existing.
</p>
<div class="sourceCode r"><pre>dplyr::tibble() |&gt;
  gt() |&gt;
  cols_add(
    num = 1:5,
    chr = vec_fmt_spelled_num(1:5)
  )
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_cols_add_4.png" alt="This image of a table was generated from the fourth code example in the `cols_add()` help file." style="width:100%;"><p>Tables can contain no rows, yet have columns. In the following example, we'll
create a zero-row table with three columns (<code>num</code>, <code>chr</code>, and <code>ext</code>) and
perform the same <code>cols_add()</code>-based addition of two columns of data. This is
another case where the function allows for arbitrary-length columns (since
always adding zero-length columns is impractical). Furthermore, here we can
reference columns that already exist (<code>num</code> and <code>chr</code>) and add values to
them.
</p>
<div class="sourceCode r"><pre>dplyr::tibble(
  num = numeric(0),
  chr = character(0),
  ext = character(0)
) |&gt;
  gt() |&gt;
  cols_add(
    num = 1:5,
    chr = vec_fmt_spelled_num(1:5)
  )
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_cols_add_5.png" alt="This image of a table was generated from the fifth code example in the `cols_add()` help file." style="width:100%;"><p>We should note that the <code>ext</code> column did not receive any values from
<code>cols_add()</code> but the table was expanded to having five rows nonetheless. So,
each cell of <code>ext</code> was by necessity filled with an <code>NA</code> value.
</p>


<h3>Function ID</h3>

<p>5-7
</p>


<h3>Function Introduced</h3>

<p><code>v0.10.0</code> (October 7, 2023)
</p>


<h3>See Also</h3>

<p>Other column modification functions: 
<code>cols_align()</code>,
<code>cols_align_decimal()</code>,
<code>cols_hide()</code>,
<code>cols_label()</code>,
<code>cols_label_with()</code>,
<code>cols_merge()</code>,
<code>cols_merge_n_pct()</code>,
<code>cols_merge_range()</code>,
<code>cols_merge_uncert()</code>,
<code>cols_move()</code>,
<code>cols_move_to_end()</code>,
<code>cols_move_to_start()</code>,
<code>cols_nanoplot()</code>,
<code>cols_unhide()</code>,
<code>cols_units()</code>,
<code>cols_width()</code>
</p>


</div>