<div class="container">

<table style="width: 100%;"><tr>
<td>glmbb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>All Hierarchical or Graphical Models for Generalized Linear Model</h2>

<h3>Description</h3>

<p>Find all hierarchical submodels of specified GLM with
information criterion (AIC, BIC, or AICc) within specified cutoff
of minimum value.  Alternatively, all such graphical models.
Use branch and bound algorithm so we do not have to fit all
models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glmbb(big, little = ~ 1, family = poisson, data,
    criterion = c("AIC", "AICc", "BIC"), cutoff = 10,
    trace = FALSE, graphical = FALSE, BIC.option = c("length", "sum"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>big</code></td>
<td>
<p>an object of class <code>"formula"</code> specifying
the largest model to be considered.  Model specified must be hierarchical.
(See also <code>glm</code> and <code>formula</code> and
‘Details’ section below.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>little</code></td>
<td>
<p>a formula specifying the smallest model to be considered.
The response may be omitted and if not omitted is ignored (the response
is taken from <code>big</code>).  Default is <code>~ 1</code>. Model specified must
be nested within the model specified by <code>big</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a description of the error distribution and link
function to be used in the model.  This can be a
character string naming a family function, a family function or the
result of a call to a family function.  (See <code>family</code>
for details of family functions.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame)
containing the variables in the models.  If not found in <code>data</code>, the
variables are taken from <code>environment(big)</code>,
typically the environment from which <code>glmbb</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>a character string specifying the information criterion,
must be one of <code>"AIC"</code> (Akaike Information Criterion, the default),
<code>"BIC"</code> (Bayes Information Criterion) or <code>"AICc"</code> (AIC corrected
for sample size).   See section on AICc below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>a nonnegative real number. This function finds all
hierarchical models that are submodels of <code>big</code> and supermodels of
<code>little</code> with information criterion less than or equal to the
cutoff plus the minimum information criterion over all these models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>logical.  Emit debug info if <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graphical</code></td>
<td>
<p>logical.  If <code>TRUE</code> search only over graphical models
rather than hierarchical models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC.option</code></td>
<td>
<p>a character string specifying the sample size <code class="reqn">n</code>
to be used in calculating BIC (ignored if <code>criterion ! = "BIC"</code>),
must be either <code>"length"</code> or <code>"sum"</code> meaning either the
length of the response vector (or number of rows if the response
“vector” is actually a matrix) or the sum of the response
(number of individuals classified if we are doing categorical
data analysis).  See section about BIC below.  May be abbreviated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional named or unnamed arguments to be passed
to <code>glm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Typical value for <code>big</code> is something like <code>foo ~ bar * baz * qux</code>
where <code>foo</code> is the response variable (or matrix when family is
<code>binomial</code> or <code>quasibinomial</code>,
see <code>glm</code>) and <code>bar</code>, <code>baz</code>, and <code>qux</code>
are all the predictors that are considered for inclusion in models.
</p>
<p>A model is hierarchical if it includes all lower-order interactions for each
term.  This is automatically what formulas with all variables connected by
stars (<code>*</code>) do, like the example above.
But other specifications are possible.
For example, <code>foo ~ (bar + baz + qux)^2</code> specifies the model with all
main effects, and all two-way interactions, but no three-way interaction,
and this is hierarchical.
</p>
<p>A model <code class="reqn">m_1</code> is nested within a model <code class="reqn">m_1</code> if all terms
in <code class="reqn">m_1</code> are also terms in <code class="reqn">m_2</code>.  The default little model
<code>~ 1</code> is nested within every model except those specified to have
no intercept by <code>0 +</code> or some such (see <code>formula</code>).
</p>
<p>The interaction graph of a model is the undirected graph whose node set is
the predictor variables in the model and whose edge set has one edge for each
pair of variables that are in an interaction term.  A clique in a graph is
a maximal complete subgraph.  A model is graphical if it is hierarchical
and has an interaction term for the variables in each clique.
When <code>graphical = TRUE</code> only graphical models are considered.
</p>


<h3>Value</h3>

<p>An object of class <code>"glmbb"</code> containing at least the following
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the model frame, a data frame containing all the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>little</code></td>
<td>
<p>the argument <code>little</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>big</code></td>
<td>
<p>the argument <code>big</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>the argument <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the argument <code>cutoff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>an R environment object containing all of the fits done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.crit</code></td>
<td>
<p>the minimum value of the criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graphical</code></td>
<td>
<p>the argument <code>graphical</code>.</p>
</td>
</tr>
</table>
<h3>BIC</h3>

<p>It is unclear what the sample size, the <code class="reqn">n</code> in the BIC penalty
<code class="reqn">n \log(p)</code> should be.  Before version 0.4 of this package
the BIC was taken to be the result of applying R generic function <code>BIC</code>
to the fitted object produced by R function <code>glm</code>.  This is generally
wrong whenever we think we are doing categorical data analysis
(Raftery, 1986; Kass and Raftery, 1995).  Whether we consider the sampling
scheme to be Poisson, multinomial, or product multinomial (and binomial
is a special case of product multinomial) the sample size is the total
number of individuals classified and is the only thing that is
considered as going to infinity in the usual asymptotics for categorical
data analysis.  This the option <code>BIC.option = "sum"</code> should always
be used for categorical data analysis.
</p>


<h3>AICc</h3>

<p>AICc was derived by Hurvich and Tsai only for normal response models.
Burnham and Anderson (2002, p. 378) recommend it for other models when
no other small sample correction is known, but this is not backed up
by any theoretical derivation.
</p>


<h3>References</h3>

<p>Burnham, K. P. and Anderson, D. R. (2002)
<em>Model Selection and Multimodel Inference: A Practical
Information-Theoretic Approach</em>, second edition.
Springer, New York.
</p>
<p>Hand, D. J. (1981)
Branch and bound in statistical data analysis.
<em>The Statistician</em>, <b>30</b>, 1–13.
</p>
<p>Hurvich, C. M. and Tsai, C.-L. (1989)
Regression and time series model selection in small samples.
<em>Biometrika</em>, <b>76</b>, 297–307.
</p>
<p>Kass, R. E. and Raftery, A. E. (1995)
Bayes factors.
<em>Journal of the American Statistical Association</em>,
<b>90</b>, 773–795.
</p>
<p>Raftery, A. E. (1986)
A note on Bayes factors for log-linear contingency table models
with vague prior information.
<em>Journal of the Royal Statistical Society, Series B</em>,
<b>48</b>, 249–250.
</p>


<h3>See Also</h3>

<p><code>family</code>,
<code>formula</code>,
<code>glm</code>,
<code>isGraphical</code>,
<code>isHierarchical</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(crabs)
gout &lt;- glmbb(satell ~ (color + spine + width + weight)^3,
    criterion = "BIC", data = crabs)
summary(gout)
</code></pre>


</div>