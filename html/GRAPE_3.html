<div class="container">

<table style="width: 100%;"><tr>
<td>makeGRAPE_psMat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Pathway Space Matrix</h2>

<h3>Description</h3>

<p>Represents new samples as vectors of pathway scores relative to reference samples
</p>


<h3>Usage</h3>

<pre><code class="language-R">makeGRAPE_psMat(refge, newge, pathway_list, w = w_quad)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>refge</code></td>
<td>
<p>Gene expression matrix of reference samples. Rows are genes, columns are samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newge</code></td>
<td>
<p>Gene expression matrix of new samples. Rows are genes, columns are samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathway_list</code></td>
<td>
<p>List of pathways. Each pathway is a character vector consisting of gene names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Weight function. Default is quadratic weight function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Vector of pathway scores of each sample in newmat.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#' ### Make pathway scores mat
set.seed(10)
### 50 reference samples
refge &lt;- matrix(rnorm(10*50),nrow=10,ncol=50); rownames(refge) &lt;- paste0("g",1:10)
refge[c(2,5,8),] &lt;- matrix(rnorm(3*50,mean=2,sd=2))
refge[c(3,4,7),] &lt;- matrix(rnorm(3*50,mean=4,sd=4))
### 6 new samples
newge &lt;- matrix(rnorm(10*6),nrow=10,ncol=6); rownames(newge) &lt;- paste0("g",1:10)
newge[c(2:7),] &lt;- matrix(rnorm(6*6,mean=3,sd=1))
newge[c(1,9),] &lt;- matrix(rnorm(2*6,mean=5,sd=3))
pathway_list &lt;- list(set1=paste0("g",1:4),set2=paste0("g",5:10),set3=paste0("g",c(1,4,8:10)))
psmat &lt;- makeGRAPE_psMat(refge,newge,pathway_list)
# &gt; psmat
# [,1]     [,2]     [,3]     [,4]     [,5]     [,6]
# set1 2.397426 1.406275 2.516492 2.358809 2.555109 2.358809
# set2 0.670354 3.245575 3.962389 2.670354 1.741150 1.579646
# set3 1.536017 2.167373 2.167373 2.167373 2.148305 1.809322
</code></pre>


</div>