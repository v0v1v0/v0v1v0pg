<div class="container">

<table style="width: 100%;"><tr>
<td>TwoDimSFS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TwoDimSFS</h2>

<h3>Description</h3>

<p>This function calculates a two-dimensional site frequency spectrum from a VCF file for two populations. It processes the file in batches for efficient memory usage.
The user can decide between a folded or unfolded spectrum.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TwoDimSFS(
  vcf_path,
  pop1_individuals,
  pop2_individuals,
  folded = FALSE,
  batch_size = 10000,
  threads = 1,
  write_log = FALSE,
  logfile = "log.txt",
  exclude_ind = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vcf_path</code></td>
<td>
<p>Path to the VCF file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop1_individuals</code></td>
<td>
<p>Vector of individual names belonging to the first population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop2_individuals</code></td>
<td>
<p>Vector of individual names belonging to the second population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folded</code></td>
<td>
<p>Logical, deciding if folded (TRUE) or unfolded (FALSE) SFS is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>The number of variants to be processed in each batch
(default of 10,000 should be suitable for most use cases).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>Number of threads to use for parallel processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write_log</code></td>
<td>
<p>Logical, indicating whether to write progress logs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logfile</code></td>
<td>
<p>Path to the log file where progress will be logged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_ind</code></td>
<td>
<p>Optional vector of individual IDs to exclude from the analysis.
If provided, the function will remove these individuals from the genotype matrix
before applying the custom function. Default is NULL, meaning no individuals are excluded.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Two-dimensional site frequency spectrum as a matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">vcf_file &lt;- system.file("tests/testthat/sim.vcf.gz", package = "GenoPop")
index_file &lt;- system.file("tests/testthat/sim.vcf.gz.tbi", package = "GenoPop")
pop1_individuals &lt;- c("tsk_0", "tsk_1", "tsk_2")
pop2_individuals &lt;- c("tsk_3", "tsk_4", "tsk_5")
sfs_2d &lt;- TwoDimSFS(vcf_file, pop1_individuals, pop2_individuals, folded = TRUE)

</code></pre>


</div>