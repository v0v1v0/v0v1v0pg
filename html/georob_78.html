<div class="container">

<table style="width: 100%;"><tr>
<td>plot.georob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Methods for Class <code>georob</code>
</h2>

<h3>Description</h3>

<p>The <code>plot</code> and <code>lines</code> methods for class
<code>georob</code> plot the variogram model, estimated by (robust) restricted
maximum likelihood.
<code>plot.georob</code> computes and plots in addition the
sample variogram of the (robust) regression residuals and can be used to
generate residual diagnostics plots (Tukey-Anscombe plot, normal QQ plots
of residuals and random effects).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'georob'
plot(x, what = c( "variogram", "covariance", "correlation",
    "ta", "sl", "qq.res", "qq.ranef" ), add = FALSE, lag.dist.def,
    xy.angle.def = c(0, 180), xz.angle.def = c(0, 180), max.lag = Inf,
    estimator = c("mad", "qn", "ch", "matheron"), mean.angle = TRUE,
    level = what != "ta", smooth = what == "ta" || what == "sl",
    id.n = 3, labels.id = names(residuals(x)), cex.id = 0.75,
    label.pos = c(4,2), col, pch, xlab, ylab, main, lty = "solid", ...)

## S3 method for class 'georob'
lines(x, what = c("variogram", "covariance", "correlation"),
    from = 1.e-6, to, n = 501, xy.angle = 90, xz.angle = 90,
    col = 1:length(xy.angle), pch = 1:length(xz.angle), lty = "solid", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>georob</code>, see <code>georobObject</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>a character keyword for the quantity that should be displayed.
Possible values are:
</p>

<ul>
<li> <p><code>"variogram"</code>: the variogram
</p>
</li>
<li> <p><code>"covariance"</code>: the covariance function
</p>
</li>
<li> <p><code>"correlation"</code>: the correlation function
</p>
</li>
<li> <p><code>"scale-location"</code>: square root of absolute regression
residuals plotted against fitted values (Scale-Location plot)
</p>
</li>
<li> <p><code>"ta"</code>: regression residuals plotted against fitted values
(Tukey-Anscombe plot)
</p>
</li>
<li> <p><code>"qq.res"</code>: normal Q-Q plot of standardized errors
<code class="reqn">\hat{\varepsilon}</code>
</p>
</li>
<li> <p><code>"qq.ranef"</code>: normal Q-Q plot of standardized random
effects <code class="reqn">\hat{B}</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>a logical scalar controlling whether a new plot should be
generated (<code>FALSE</code>, default) or whether the information should be
added to the current plot (<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.dist.def</code></td>
<td>
<p>an optional numeric scalar defining a constant bin
width for grouping the lag distances or an optional numeric vector with
the upper bounds of a set of contiguous bins for computing the sample
variogram of the regression residuals, see
<code>sample.variogram</code>.  If missing then the sample variogram is
not computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy.angle.def</code></td>
<td>
<p>an numeric vector defining angular classes in the
horizontal plane for computing directional variograms.
<code>xy.angle.def</code> must contain an ascending sequence of azimuth angles
in degrees from north (positive clockwise to south), see
<code>sample.variogram</code>.  Omnidirectional variograms are computed
with the default <code>c(0,180)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xz.angle.def</code></td>
<td>
<p>an numeric vector defining angular classes in the
<code class="reqn">x</code>-<code class="reqn">z</code>-plane for computing directional variograms.
<code>xz.angle.def</code> must contain an ascending sequence of angles in
degrees from zenith (positive clockwise to nadir), see
<code>sample.variogram</code>.  Omnidirectional variograms are computed
with the default <code>c(0,180)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.lag</code></td>
<td>
<p>a positive numeric defining the largest lag distance for
which semi-variances should be computed (default no restriction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>a character keyword defining the estimator for computing
the sample variogram.  Possible values are:
</p>

<ul>
<li> <p><code>"qn"</code>: Genton's robust
<code>Qn</code>-estimator (default, <cite>Genton, 1998</cite>),
</p>
</li>
<li> <p><code>"mad"</code>: Dowd's robust MAD-estimator (<cite>Dowd, 1984</cite>),
</p>
</li>
<li> <p><code>"matheron"</code>: non-robust method-of-moments estimator,
</p>
</li>
<li> <p><code>"ch"</code>: robust Cressie-Hawkins estimator (<cite>Cressie and
Hawkins, 1980</cite>).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.angle</code></td>
<td>
<p>a logical scalar controlling whether the mean lag
vector (per combination of lag distance and angular class) is computed
from the mean angles of all the lag vectors falling into a given class
(<code>TRUE</code>, default) or from the mid-angles of the respective angular
classes (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an integer giving the level for extracting the residuals
from <code>object</code> for <code>what = "ta"</code> or <code>what = "qq.res"</code>.
<code>level = 0</code> (default for <code>what == "ta"</code>) extracts the
regression residuals <code class="reqn">\widehat{B}(\boldsymbol{s}) +
  \widehat{\varepsilon}(\boldsymbol{s})</code> and <code>level = 1</code> (default for <code>what ==
  "qq.res"</code>) only the estimated errors
<code class="reqn">\widehat{\varepsilon}(\boldsymbol{s})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>a logical scalar controlling whether a
<code>loess.smooth</code> is added to the Tukey-Anscombe plot
(default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.n</code></td>
<td>
<p>a numeric with the number of points to be labelled in each
plot, starting with the most extreme (see
<code>plot.lmrob</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels.id</code></td>
<td>
<p>a vector of labels, from which the labels for extreme
points will be chosen (see <code>plot.lmrob</code>).
<code>NULL</code> uses observation numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.id</code></td>
<td>
<p>a numeric with the magnification of point labels (see
<code>plot.lmrob</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.pos</code></td>
<td>
<p>a numeric for positioning of labels, for the left half
and right half of the graph respectively (see
<code>plot.lmrob</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>a numeric with the minimal lag distance for plotting
variogram models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>a numeric with the maximum lag distance for plotting variogram
models (default: largest lag distance of current plot).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a positive integer specifying the number of equally spaced lag
distances for which semi-variances are evaluated in plotting variogram
models (default <code>501</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy.angle</code></td>
<td>
<p>a numeric (vector) with azimuth angles (in degrees,
clockwise positive from north) in <code class="reqn">x</code>-<code class="reqn">y</code>-plane for which
semi-variances should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xz.angle</code></td>
<td>
<p>a numeric (vector) with angles in <code class="reqn">x</code>-<code class="reqn">z</code>-plane (in
degrees, clockwise positive from zenith to south) for which semi-variances
should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>an optional vector with colours of points and curves to
distinguish items relating to different azimuth angles in
<code class="reqn">x</code>-<code class="reqn">y</code>-plane.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>an optional vector with symbols for points and curves to
distinguish items relating to different azimuth angles in
<code class="reqn">x</code>-<code class="reqn">z</code>-plane.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type for plotting variogram models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, main</code></td>
<td>
<p>plot annotation, see
<code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to
<code>plot.sample.variogram</code>, <code>loess.smooth</code>
and graphical methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The method <code>plot.georob</code> returns no value, it is called for its side
effects.
</p>
<p>The method <code>lines.georob</code> is called for its side effects and returns
the value <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>See Also</h3>

<p><code>georobPackage</code> for a description of the model and a brief summary of the algorithms;
</p>
<p><code>georob</code> for (robust) fitting of spatial linear models;
</p>
<p><code>georobObject</code> for a description of the class <code>georob</code>;
</p>
<p><code>profilelogLik</code> for computing profiles of Gaussian likelihoods;
</p>

<p><code>control.georob</code> for controlling the behaviour of <code>georob</code>;
</p>
<p><code>georobModelBuilding</code> for stepwise building models of class <code>georob</code>;
</p>
<p><code>cv.georob</code> for assessing the goodness of a fit by <code>georob</code>;
</p>
<p><code>georobMethods</code> for further methods for the class <code>georob</code>;
</p>
<p><code>predict.georob</code> for computing robust Kriging predictions;
</p>

<p><code>lgnpp</code> for unbiased back-transformation of Kriging prediction
of log-transformed data;
</p>
<p><code>georobSimulation</code> for simulating realizations of a Gaussian process
from model fitted by <code>georob</code>; and finally
</p>
<p><code>sample.variogram</code> and <code>fit.variogram.model</code>
for robust estimation and modelling of sample variograms.
</p>


<h3>Examples</h3>

<pre><code class="language-R">################
## meuse data ##
################
data(meuse)

## Gaussian REML fit
r.logzn.reml &lt;- georob(log(zinc) ~ sqrt(dist), data = meuse, locations = ~ x + y,
    variogram.model = "RMexp",
    param = c(variance = 0.15, nugget = 0.05, scale = 200),
    tuning.psi = 1000)
summary(r.logzn.reml, correlation = TRUE)
plot(r.logzn.reml, lag.dist.def = seq(0, 2000, by = 100))

## robust REML fit
if(interactive()){
  ## example is run only in interactive session because cpu times exceeds 5 s
  r.logzn.rob &lt;- update(r.logzn.reml, tuning.psi = 1)

  summary(r.logzn.rob, correlation = TRUE)
  lines(r.logzn.rob, col = "red")
}
</code></pre>


</div>