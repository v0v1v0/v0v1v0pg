<div class="container">

<table style="width: 100%;"><tr>
<td>ggperio</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare a ggplot object to represent periodogram data</h2>

<h3>Description</h3>

<p>This function summarises periodogram data (containing periodograms of multiple individual),
to show period on the <code>x</code> axis, and power (or equivalent) on the <code>y</code> axis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ggperio(data, mapping = aes(x = period, y = power), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>behavr::behavr table containing the data and metadata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>default list of aesthetic mappings to use for plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>ggplot2::ggplot()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An initial ggplot object that can be further edited.
</p>


<h3>References</h3>


<ul><li>
<p> The relevant <a href="https://rethomics.github.io/ggetho.html#periodograms">rethomic tutorial section</a>
</p>
</li></ul>
<h3>See Also</h3>


<ul>
<li> <p>ggetho to plot time series
</p>
</li>
<li> <p>geom_peak to draw peaks on a periodogram
</p>
</li>
<li> <p>zeitgebr::periodogram to compute periodograms in a first place
</p>
</li>
<li> <p>ggspectro to visualise spectrograms
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
require(zeitgebr)
# We make toy data
metadata &lt;- data.table(id = sprintf("toy_experiment|%02d", 1:40),
                       region_id = 1:40,
                       condition = c("A", "B"),
                       sex = c("M", "M", "F", "F"))
dt &lt;- toy_activity_data(metadata, seed = 107)
# We shift period of the group "A" by 0.01
dt[, t := ifelse(xmv(condition) == "A", t, t * 1.01)]
# We  compute a periodogram for each individual
per_dt &lt;- periodogram(moving, dt, FUN = chi_sq_periodogram)

# Then we display them as an average
out &lt;- ggperio(per_dt, aes(y = power, colour = condition))
out +  stat_pop_etho()

out &lt;- ggperio(per_dt, aes(y = power - signif_threshold, colour = condition))
out +  stat_pop_etho()
out &lt;- ggperio(per_dt, aes(y = power - signif_threshold, colour = condition))
out +  stat_pop_etho() + facet_wrap( ~ id, labeller = id_labeller)

</code></pre>


</div>