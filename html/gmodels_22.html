<div class="container">

<table style="width: 100%;"><tr>
<td>glh.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test a General Linear Hypothesis for a Regression Model</h2>

<h3>Description</h3>

<p>Test, print, or summarize a general linear hypothesis for a regression model
</p>


<h3>Usage</h3>

<pre><code class="language-R">glh.test(reg, cm, d = rep(0, nrow(cm)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reg</code></td>
<td>
<p>Regression model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cm</code></td>
<td>
<p>contrast matrix <code>C</code> .  Each row specifies a linear combination of the
coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>vector <code>d</code> specifying the null hypothesis values for each linear
combination</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Test the general linear hypothesis <code class="reqn">C \hat{\beta} = d </code> for the regression model <code>reg</code>.
</p>
<p>The test statistic is obtained from the formula:
</p>
<p style="text-align: center;"><code class="reqn">
 f = \frac{(C \hat{\beta} - d)' ( C (X'X)^{-1} C' ) (C \hat{\beta} - d) / r }{ 
     SSE / (n-p) } 
 </code>
</p>

<p>where
</p>

<ul>
<li> <p><code>r</code> is the number of contrasts contained in <code>C</code>, and
</p>
</li>
<li> <p><code>n-p</code> is the model degrees of freedom.
</p>
</li>
</ul>
<p>Under the null hypothesis, <code>f</code> will follow a F-distribution with <code>r</code> and <code>n-p</code>
degrees of freedom
</p>


<h3>Value</h3>

<p>Object of class <code>c("glh.test","htest")</code> with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>Function call that created the object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic </code></td>
<td>
<p>F statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>vector containing the numerator (r) and
denominator (n-p) degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>computed estimate for each row of <code>cm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>d</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>description of the method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>name of the model given for <code>reg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p>matrix specifying the general linear hypotheis (<code>cm</code>)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>When using treatment contrasts (the default) the first level of the
factors are subsumed into the intercept term.  The estimated model
coefficients are then contrasts versus the first level. This should be taken
into account when forming contrast matrixes, particularly when computing
contrasts that include 'baseline' level of factors.
</p>
<p>See the comparison with <code>fit.contrast</code> in the examples below.
</p>


<h3>Author(s)</h3>

<p>Gregory R. Warnes <a href="mailto:greg@warnes.net">greg@warnes.net</a>
</p>


<h3>References</h3>

<p>R.H. Myers, Classical and Modern Regression with Applications,
2nd Ed, 1990, p. 105
</p>


<h3>See Also</h3>

<p><code>fit.contrast()</code>, <code>estimable()</code>, <code>stats::contrasts()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# fit a simple model
y &lt;- rnorm(100)
x &lt;-  cut(rnorm(100, mean=y, sd=0.25),c(-4,-1.5,0,1.5,4))
reg &lt;- lm(y ~ x)
summary(reg)

# test both group 1 = group 2  and group 3 = group 4
# *Note the 0 in the column for the intercept term*

C &lt;- rbind( c(0,-1,0,0), c(0,0,-1,1) )
ret &lt;- glh.test(reg, C)
ret  # same as 'print(ret) '
summary(ret)

# To compute a contrast between the first and second level of the factor
# 'x' using 'fit.contrast' gives:

fit.contrast( reg, x,c(1,-1,0,0) )
	
# To test this same contrast using 'glh.test', use a contrast matrix
# with a zero coefficient for the intercept term.  See the Note section,
# above, for an explanation.

C &lt;- rbind( c(0,-1,0,0) )
glh.test( reg, C )

</code></pre>


</div>