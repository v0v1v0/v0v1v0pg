<div class="container">

<table style="width: 100%;"><tr>
<td>frank.fanova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank envelope F-test</h2>

<h3>Description</h3>

<p>A one-way functional ANOVA based on the rank envelope applied to F values
</p>


<h3>Usage</h3>

<pre><code class="language-R">frank.fanova(
  nsim,
  curve_set,
  groups,
  variances = "equal",
  test.equality = c("mean", "var", "cov"),
  cov.lag = 1,
  savefuns = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of random permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve_set</code></td>
<td>
<p>The original data (an array of functions) provided as a
<code>curve_set</code> object or a <code>fdata</code> object of <span class="pkg">fda.usc</span>.
The curve set should include the argument values for the functions in the component <code>r</code>, and
the observed functions in the component <code>obs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>The original groups (a factor vector representing the assignment to groups).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variances</code></td>
<td>
<p>Either "equal" or "unequal". If "equal", then the traditional F-values are used.
If "unequal", then the corrected F-values are used. The current implementation uses
<code>lm</code> to get the corrected F-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.equality</code></td>
<td>
<p>A character with possible values <code>mean</code> (default), <code>var</code> and
<code>cov</code>. If <code>mean</code>, the functional ANOVA is performed to compare the means in the groups.
If <code>var</code>, then the equality of variances of the curves in the groups is tested by performing
the graphical functional ANOVA test on the functions
</p>
<p style="text-align: center;"><code class="reqn">Z_{ij}(r) = T_{ij}(r) - \bar{T}_j(r).</code>
</p>

<p>If <code>cov</code>, then the equality of lag <code>cov.lag</code> covariance is tested by performing the fANOVA with
</p>
<p style="text-align: center;"><code class="reqn">W_{ij}(r) = \sqrt{|V_{ij}(r)|\cdot sign(V_{ij}(r))},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">V_{ij}(r) = (T_{ij}(r) - \bar{T}_j(r))((T_{ij}(r+s) - \bar{T}_j(r+s))).</code>
</p>

<p>See Mrkvicka et al. (2020) for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.lag</code></td>
<td>
<p>The lag of the covariance for testing the equality of covariances,
see <code>test.equality</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savefuns</code></td>
<td>
<p>Logical. If TRUE, then the functions from permutations are saved to the attribute
simfuns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>global_envelope_test</code>.
For example, the type of multiple testing control, FWER or FDR must be set by <code>typeone</code>.
And, if <code>typeone = "fwer"</code>, the type of the global envelope can be chosen by
specifying the argument <code>type</code>. See <code>global_envelope_test</code>
for the defaults and available options.
(The test here uses <code>alternative="two.sided"</code> and <code>nstep=1</code> (when relevant),
but all the other specifications are to be given in <code>...</code>.)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test assumes that there are <code class="reqn">J</code> groups which contain
<code class="reqn">n_1,\dots,n_J</code> functions
<code class="reqn">T_{ij}, i=\dots,J, j=1,\dots,n_j</code>.
The functions should be given in the argument x, and the groups in the argument groups.
The test assumes that there exists non random functions <code class="reqn">\mu(r)</code> and
<code class="reqn">\mu_i(r)</code> such that
</p>
<p style="text-align: center;"><code class="reqn">T_{ij}(r) =\mu(r) + \mu_i(r) + e_{ij}(r), i=1, \dots, J, j=1, \dots , n_j</code>
</p>

<p>where <code class="reqn">e_{ij}(r)</code> are independent and normally distributed.
The test vector is
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{T} = (F(r_1), F(r_2), \dots , F(r_K)),</code>
</p>

<p>where <code class="reqn">F(r_i)</code> stands for the F-statistic. The simulations are performed by
permuting the test functions. Further details can be found in Mrkvička et al. (2020).
</p>
<p>The argument <code>variances="equal"</code> means that equal variances across groups are assumed.
The correction for unequal variances can be done by using the corrected F-statistic
(option <code>variances="unequal"</code>).
</p>
<p>Unfortunately this test is not able to detect which groups are different from each other.
</p>


<h3>References</h3>

<p>Mrkvička, T., Myllymäki, M., Jilek, M. and Hahn, U. (2020) A one-way ANOVA test for functional data with graphical interpretation. Kybernetika 56 (3), 432-458. doi: 10.14736/kyb-2020-3-0432
</p>


<h3>See Also</h3>

<p>graph.fanova
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("rimov")
groups &lt;- factor(c(rep(1, times=12), rep(2, times=12), rep(3, times=12)))
res &lt;- frank.fanova(nsim = 2499, curve_set = rimov, groups = groups)

plot(res)

data("imageset3")
res2 &lt;- frank.fanova(nsim = 19, # Increase nsim for serious analysis!
                     curve_set = imageset3$image_set,
                     groups = imageset3$Group)
plot(res2)
plot(res2, fixedscales=FALSE)
</code></pre>


</div>