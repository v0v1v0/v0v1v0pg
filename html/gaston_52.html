<div class="container">

<table style="width: 100%;"><tr>
<td>lmm.restricted.likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Likelihood of a linear mixed model </h2>

<h3>Description</h3>

<p>Compute the Restricted or the Full Likelihood of a linear mixed model.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> 
 lmm.restricted.likelihood(Y, X = matrix(1, nrow = length(Y)), K, tau, s2)
 lmm.profile.restricted.likelihood(Y, X = matrix(1, nrow = length(Y)), K, h2) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> Phenotype vector </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> Covariable matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p> A positive definite matrix or a <code>list</code> of such matrices </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p> Value(s) of parameter(s) <code class="reqn">\tau</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>  Value of parameter <code class="reqn">\sigma^2</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>  Value(s) of heritability  </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Theses function respectively compute the Restricted and the Profile Likelihood under the linear 
mixed model
</p>
<p style="text-align: center;"><code class="reqn"> Y = X\beta + \omega_1 + \ldots + \omega_k + \varepsilon </code>
</p>

<p>with <code class="reqn"> \omega_i \sim N(0,\tau_i K_i) </code> for <code class="reqn"> i \in 1, \dots,k </code> and
<code class="reqn"> \varepsilon \sim N(0,\sigma^2 I_n) </code>.
</p>
<p>The variance matrices <code class="reqn">K_1</code>, ..., <code class="reqn">K_k</code>, are specified through the parameter <code>K</code>.
The parameter <code>tau</code> should be a vector of length <code class="reqn">k</code>.
</p>
<p>The function <code>lmm.restricted.likelihood</code> computes the restricted
likelihood for the given values of <code class="reqn">\tau</code> and <code class="reqn">\sigma^2</code>.
Whenever <code class="reqn">k = 1</code>, it is similar to <code>lmm.diago.likelihood(tau, s2, Y = Y, X = X, eigenK = eigen(K))</code> 
which should be prefered (with a preliminary computation of <code>eigen(K)</code>).
</p>
<p>The function <code>lmm.profile.restricted.likelihood</code> computes a profile restricted
likelihood: the values of <code class="reqn">\tau</code> and <code class="reqn">\sigma^2</code> which
maximizes the likelihood are computed under the constraint 
<code class="reqn"> {\tau \over \tau + \sigma^2 } = h^2 </code>, 
and the profiled likelihood value for these parameters is computed.
Whenever <code class="reqn">k = 1</code>, it is similar to <code>lmm.diago.likelihood(h2 = h2, Y = Y, X = X, eigenK = eigen(K))</code>. 
</p>


<h3>Value</h3>

<p>The restricted likelihood value.
</p>


<h3>Author(s)</h3>

<p> Herv√© Perdry and Claire Dandine-Roulland </p>


<h3>See Also</h3>

 <p><code>lmm.diago.likelihood</code>, <code>lmm.diago</code>, <code>lmm.aireml</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data
data(AGT)
x &lt;- as.bed.matrix(AGT.gen, AGT.fam, AGT.bim)

# Compute Genetic Relationship Matrix and its eigen decomposition
K &lt;- GRM(x)
eiK &lt;- eigen(K)

# simulate a phenotype
set.seed(1)
y &lt;- 1 + lmm.simu(tau = 1, sigma2 = 2, eigenK = eiK)$y

# compute restricted likelihood for tau = 0.2 and s2 = 0.8
lmm.restricted.likelihood(y, K=K, tau = 0.2, s2 = 0.8)

# compute profile restricted likelihood for h2 = 0.2
lmm.profile.restricted.likelihood(y, K=K, h2 = 0.2)

# identity with the values computed with the diagonalisation trick
lmm.diago.likelihood(tau = 0.2, s2 = 0.8, Y = y, eigenK = eiK)
lmm.diago.likelihood(h2 = 0.2, Y = y, eigenK = eiK)
</code></pre>


</div>