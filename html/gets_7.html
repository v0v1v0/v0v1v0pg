<div class="container">

<table style="width: 100%;"><tr>
<td>blocksFun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Block-based General-to-Specific (GETS) modelling </h2>

<h3>Description</h3>

<p>Auxiliary function (i.e. not intended for the average user) that enables block-based GETS-modelling with user-specified estimator, diagnostics and goodness-of-fit criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blocksFun(y, x, untransformed.residuals=NULL, blocks=NULL,
  no.of.blocks=NULL, max.block.size=30, ratio.threshold=0.8,
  gets.of.union=TRUE, force.invertibility=FALSE,
  user.estimator=list(name="ols"), t.pval=0.001, wald.pval=t.pval,
  do.pet=FALSE, ar.LjungB=NULL, arch.LjungB=NULL, normality.JarqueB=NULL,
  user.diagnostics=NULL, gof.function=list(name="infocrit"),
  gof.method=c("min", "max"), keep=NULL, include.gum=FALSE,
  include.1cut=FALSE, include.empty=FALSE, max.paths=NULL,
  turbo=FALSE, parallel.options=NULL, tol=1e-07, LAPACK=FALSE,
  max.regs=NULL, print.searchinfo=TRUE, alarm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector (with no missing values, i.e. no non-numeric 'holes') </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>matrix</code>, or a <code>list</code> of matrices </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>untransformed.residuals</code></td>
<td>
<p><code>NULL</code> (default) or, when <code>ols</code> is used with <code>method=6</code> in <code>user.estimator</code>, a numeric vector containing the untransformed residuals </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks</code></td>
<td>
<p><code>NULL</code> (default) or a <code>list</code> of lists with vectors of integers that indicate how blocks should be put together. If <code>NULL</code>, then the block composition is undertaken automatically by an internal algorithm that depends on <code>no.of.blocks</code>, <code>max.block.size</code> and <code>ratio.threshold</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.of.blocks</code></td>
<td>
<p><code>NULL</code> (default) or <code>integer</code>. If <code>NULL</code>, then the number of blocks is determined automatically by an internal algorithm </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.block.size</code></td>
<td>
<p><code>integer</code> that controls the size of blocks </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.threshold</code></td>
<td>
<p><code>numeric</code> between 0 and 1 that controls the minimum ratio of variables in each block to total observations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gets.of.union</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> (default), then GETS modelling is undertaken of the union of retained variables. Otherwise it is not </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.invertibility</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, then the x-matrix is ensured to have full row-rank before it is passed on to <code>getsFun</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user.estimator</code></td>
<td>
<p><code>list</code>, see <code>getsFun</code> for the details </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.pval</code></td>
<td>
<p><code>numeric</code> value between 0 and 1. The significance level used for the two-sided coefficient significance t-tests </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wald.pval</code></td>
<td>
<p><code>numeric</code> value between 0 and 1. The significance level used for the Parsimonious Encompassing Tests (PETs) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.pet</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, then a Parsimonious Encompassing Test (PET) against the GUM is undertaken at each variable removal for the joint significance of all the deleted regressors along the current GETS path. If <code>FALSE</code>, then a PET is not undertaken at each removal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.LjungB</code></td>
<td>
<p>a two element <code>vector</code>, or <code>NULL</code>. In the former case, the first element contains the AR-order, the second element the significance level. If <code>NULL</code>, then a test for autocorrelation in the residuals is not conducted </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arch.LjungB</code></td>
<td>
<p>a two element <code>vector</code>, or <code>NULL</code>. In the former case, the first element contains the ARCH-order, the second element the significance level. If <code>NULL</code>, then a test for ARCH in the residuals is not conducted </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normality.JarqueB</code></td>
<td>
<p><code>NULL</code> or a <code>numeric</code> value between 0 and 1. In the latter case, a test for non-normality in the residuals is conducted using a significance level equal to<br><code>normality.JarqueB</code>. If <code>NULL</code>, then no test for non-normality is conducted </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user.diagnostics</code></td>
<td>
<p><code>NULL</code> (default) or a <code>list</code> with two entries, <code>name</code> and <code>pval</code>. See <code>getsFun</code> for the details </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof.function</code></td>
<td>
<p><code>list</code>. The first item should be named <code>name</code> and contain the name (a character) of the Goodness-of-Fit (GOF) function used. Additional items in the list <code>gof.function</code> are passed on as arguments to the GOF-function. . See <code>getsFun</code> for the details </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof.method</code></td>
<td>
<p><code>character</code>. Determines whether the best Goodness-of-Fit is a minimum (default) or maximum </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p><code>NULL</code> (default), <code>vector</code> of integers or a <code>list</code> of vectors of integers. In the latter case, the number of vectors should be equal to the number of matrices in <code>x</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.gum</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, then the GUM (i.e. the starting model) is included among the terminal models </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.1cut</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, then the 1-cut model is added to the list of terminal models </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.empty</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, then the empty model is added to the list of terminal models </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.paths</code></td>
<td>
<p><code>NULL</code> (default) or <code>integer</code> greater than 0. If <code>NULL</code>, then there is no limit to the number of paths. If <code>integer</code> (e.g. 1), then this integer constitutes the maximum number of paths searched (e.g. a single path) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>turbo</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, then (parts of) paths are not searched twice (or more) unnecessarily in each GETS modelling. Setting <code>turbo</code> to <code>TRUE</code> entails a small additional computational costs, but may be outweighed substantially if estimation is slow, or if the number of variables to delete in each path is large </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.options</code></td>
<td>
<p><code>NULL</code> or <code>integer</code> that indicates the number of cores/threads to use for parallel computing (implemented w/<code>makeCluster</code> and <code>parLapply</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p><code>numeric</code> value, the tolerance for detecting linear dependencies in the columns of the variance-covariance matrix when computing the Wald-statistic used in the Parsimonious Encompassing Tests (PETs), see the <code>qr.solve</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAPACK</code></td>
<td>
<p>currently not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.regs</code></td>
<td>
<p><code>integer</code>. The maximum number of regressions along a deletion path. Do not alter unless you know what you are doing! </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.searchinfo</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> (default), then a print is returned whenever simiplification along a new path is started </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alarm</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, then a sound or beep is emitted (in order to alert the user) when the model selection ends </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>blocksFun</code> undertakes block-based GETS modelling by a repeated but structured call to <code>getsFun</code>. For the details of how to user-specify an estimator via <code>user.estimator</code>, diagnostics via
<code>user.diagnostics</code> and a goodness-of-fit function via <code>gof.function</code>, see documentation of <code>getsFun</code> under "Details".
</p>
<p>The algorithm of <code>blocksFun</code> is similar to that of <code>isat</code>, but more flexible. The main use of <code>blocksFun</code> is the creation of user-specified methods that employs block-based GETS modelling, e.g. indicator saturation techniques.
</p>


<h3>Value</h3>

<p> A <code>list</code> with the results of the block-based GETS-modelling. </p>


<h3>Author(s)</h3>

<p>Genaro Sucarrat, with contributions from Jonas kurle, Felix Pretis and James Reade <br></p>


<h3>References</h3>

<p>F. Pretis, J. Reade and G. Sucarrat (2018): 'Automated General-to-Specific (GETS) Regression Modeling and Indicator Saturation for Outliers and Structural Breaks'. Journal of Statistical Software 86, Number 3, pp. 1-44
</p>
<p>G. sucarrat (2020): 'User-Specified General-to-Specific and Indicator Saturation Methods'.  The R Journal 12 issue 2, pp. 388-401, <a href="https://journal.r-project.org/archive/2021/RJ-2021-024/">https://journal.r-project.org/archive/2021/RJ-2021-024/</a>
</p>


<h3>See Also</h3>

<p><code>getsFun</code>, <code>ols</code>, <code>diagnostics</code>, <code>infocrit</code> and <code>isat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## more variables than observations:
y &lt;- rnorm(20)
x &lt;- matrix(rnorm(length(y)*40), length(y), 40)
blocksFun(y, x)

## 'x' as list of matrices:
z &lt;- matrix(rnorm(length(y)*40), length(y), 40)
blocksFun(y, list(x,z))

## ensure regressor no. 3 in matrix no. 2 is not removed:
blocksFun(y, list(x,z), keep=list(integer(0), 3))

</code></pre>


</div>