<div class="container">

<table style="width: 100%;"><tr>
<td>nordr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonlinear Ordinal Regression Models</h2>

<h3>Description</h3>

<p><code>nordr</code> fits arbitrary nonlinear regression functions (with logistic
link) to ordinal response data by proportional odds, continuation ratio, or
adjacent categories.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nordr(y = NULL, distribution = "proportional", mu = NULL,
  linear = NULL, pmu = NULL, pintercept = NULL, weights = NULL,
  envir = parent.frame(), print.level = 0, ndigit = 10,
  gradtol = 1e-05, steptol = 1e-05, fscale = 1, iterlim = 100,
  typsize = abs(p), stepmax = 10 * sqrt(p %*% p))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of ordinal responses, integers numbered from zero to one
less than the number of categories or an object of class, <code>response</code>
(created by <code>restovec</code>) or <code>repeated</code> (created by
<code>rmna</code>) or <code>lvna</code>). If the
<code>repeated</code> data object contains more than one response variable, give
that object in <code>envir</code> and give the name of the response variable to be
used here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>The ordinal distribution: proportional odds,
continuation ratio, or adjacent categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>User-specified function of <code>pmu</code>, and possibly <code>linear</code>,
giving the logistic regression equation. This must contain the first
intercept. It may contain a linear part as the second argument to the
function. It may also be a formula beginning with ~, specifying a logistic
regression function for the location parameter, either a linear one using
the Wilkinson and Rogers notation or a general function with named unknown
parameters. If it contains unknown parameters, the keyword <code>linear</code> may
be used to specify a linear part. If nothing is supplied, the location is
taken to be constant unless the linear argument is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear</code></td>
<td>
<p>A formula beginning with ~ in W&amp;R notation, specifying the
linear part of the logistic regression function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmu</code></td>
<td>
<p>Vector of initial estimates for the regression parameters,
including the first intercept. If <code>mu</code> is a formula with unknown
parameters, their estimates must be supplied either in their order of
appearance in the expression or in a named list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pintercept</code></td>
<td>
<p>Vector of initial estimates for the contrasts with the
first intercept parameter (difference in intercept for successive
categories): two less than the number of different ordinal values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weight vector for use with contingency tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndigit</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fscale</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typsize</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepmax</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Nonlinear regression models can be supplied as formulae where parameters are
unknowns in which case factor variables cannot be used and parameters must
be scalars. (See <code>finterp</code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the maximum likelihood estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class nordr is returned that contains all of the relevant
information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code>finterp</code>, <code>fmr</code>,
<code>glm</code>, <code>glmm</code>,
<code>gnlmm</code>, <code>gnlr</code>,
<code>gnlr3</code>, <code>nlr</code>,
<code>ordglm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# McCullagh (1980) JRSS B42, 109-142
# tonsil size: 2x3 contingency table
y &lt;- c(0:2,0:2)
carrier &lt;- c(rep(0,3),rep(1,3))
carrierf &lt;- gl(2,3,6)
wt &lt;- c(19,29,24,
	497,560,269)
pmu &lt;- c(-1,0.5)
mu &lt;- function(p) c(rep(p[1],3),rep(p[1]+p[2],3))
# proportional odds
# with mean function
nordr(y, dist="prop", mu=mu, pmu=pmu, weights=wt, pintercept=1.5)
# using Wilkinson and Rogers notation
nordr(y, dist="prop", mu=~carrierf, pmu=pmu, weights=wt, pintercept=1.5)
# using formula with unknowns
nordr(y, dist="prop", mu=~b0+b1*carrier, pmu=pmu, weights=wt, pintercept=1.5)
# continuation ratio
nordr(y, dist="cont", mu=mu, pmu=pmu, weights=wt, pintercept=1.5)
# adjacent categories
nordr(y, dist="adj", mu=~carrierf, pmu=pmu, weights=wt, pintercept=1.5)
#
# Haberman (1974) Biometrics 30, 589-600
# institutionalized schizophrenics: 3x3 contingency table
y &lt;- rep(0:2,3)
fr &lt;- c(43,6,9,
	16,11,18,
	3,10,16)
length &lt;- gl(3,3)
## Not run: 
# fit continuation ratio model with nordr and as a logistic model
nordr(y, mu=~length, weights=fr, pmu=c(0,-1.4,-2.3), pint=0.13,
	dist="cont")
	
## End(Not run)
# logistic regression with reconstructed table
frcr &lt;- cbind(c(43,16,3,49,27,13),c(6,11,10,9,18,16))
lengthord &lt;- gl(3,1,6)
block &lt;- gl(2,3)
summary(glm(frcr~lengthord+block,fam=binomial))
# note that AICs and deviances are different

</code></pre>


</div>