<div class="container">

<table style="width: 100%;"><tr>
<td>position_strand</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stack features</h2>

<h3>Description</h3>

<p><code>position_strand()</code> offsets forward feats upward and reverse feats downward.
<code>position_pile()</code> stacks overlapping feats upward. <code>position_strandpile()</code>
stacks overlapping feats up-/downward based on their strand.
<code>position_sixframe()</code> offsets the feats based on their strand and reading
frame.
</p>


<h3>Usage</h3>

<pre><code class="language-R">position_strand(offset = 0.1, flip = FALSE, grouped = NULL, base = offset/2)

position_pile(offset = 0.1, gap = 1, flip = FALSE, grouped = NULL, base = 0)

position_strandpile(
  offset = 0.1,
  gap = 1,
  flip = FALSE,
  grouped = NULL,
  base = offset * 1.5
)

position_sixframe(offset = 0.1, flip = FALSE, grouped = NULL, base = offset/2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Shift overlapping feats up/down this much on the y-axis. The
y-axis distance between two sequences is 1, so this is usually a small
fraction, such as 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p>stack downward, and for stranded versions reverse upward.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouped</code></td>
<td>
<p>if TRUE feats in the same group are stacked as a single
feature. Useful to move CDS and mRNA as one unit. If NULL (default) set to
TRUE if data appears to contain gene-ish features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>How to align the stack relative to the sequence. 0 to center the
lowest stack level on the sequence, 1 to put forward/reverse sequence one
half offset above/below the sequence line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap</code></td>
<td>
<p>If two feats are closer together than this, they will be stacked.
Can be negative to allow small overlaps. NA disables stacking.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggproto object to be used in <code>geom_gene()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(patchwork)
p &lt;- gggenomes(emale_genes) %&gt;%
  pick(3:4) + geom_seq()

f0 &lt;- tibble::tibble(
  seq_id = pull_seqs(p)$seq_id[1],
  start = 1:20 * 1000,
  end = start + 2500,
  strand = rep(c("+", "-"), length(start) / 2)
)

sixframe &lt;- function(x, strand) as.character((x %% 3 + 1) * strand_int(strand))

p1 &lt;- p + geom_gene()
p2 &lt;- p + geom_gene(aes(fill = strand), position = "strand")
p3 &lt;- p + geom_gene(aes(fill = strand), position = position_strand(flip = TRUE, base = 0.2))
p4 &lt;- p + geom_gene(aes(fill = sixframe(x, strand)), position = "sixframe")
p5 &lt;- p %&gt;% add_feats(f0) + geom_gene() + geom_feat(aes(color = strand))
p6 &lt;- p %&gt;% add_feats(f0) + geom_gene() + geom_feat(aes(color = strand), position = "strandpile")
p1 + p2 + p3 + p4 + p5 + p6 + plot_layout(ncol = 3, guides = "collect") &amp; ylim(2.5, 0.5)

</code></pre>


</div>