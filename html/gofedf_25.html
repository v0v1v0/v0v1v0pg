<div class="container">

<table style="width: 100%;"><tr>
<td>testGLMGamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply Goodness of Fit Test to the Residuals of a Generalized Linear Model with Gamma Link Function</h2>

<h3>Description</h3>

<p><code>testGLMGamma</code> is used to check the validity of Gamma assumption for the response variable when
fitting generalized linear model. Common link functions in <code>glm</code> can be used here.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testGLMGamma(
  x,
  y,
  fit = NULL,
  l = "log",
  hessian = FALSE,
  start.value = NULL,
  control = NULL,
  method = "cvm"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>is either a numeric vector or a design matrix. In the design matrix, rows indicate observations and columns
presents covariats.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>is a vector of numeric values with the same number of observations or number of rows as x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>is an object of class <code>glm</code> and its default value is NULL. If a fit of class <code>glm</code> is provided,
the arguments <code>x</code>, <code>y</code>, and <code>l</code> will be ignored. We recommend using <code>glm2</code> function from
<code>glm2</code> package since it provides better convergence while optimizing the likelihood to estimate
coefficients of the model by IWLS method. It is required to return design matrix by <code>x</code> = <code>TRUE</code> in
<code>glm</code> or <code>glm2</code> function. For more information on how to do this, refer to the help
documentation for the <code>glm</code> or <code>glm2</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>a character vector indicating the link function that should be used for Gamma family. Some common
link functions for Gamma family are 'log' and 'inverse'. For more details see <code>make.link</code> from stats
package in R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>logical. If <code>TRUE</code> the Fisher information matrix is estimated by the observed Hessian Matrix based on
the sample. If <code>FALSE</code> (the default value) the Fisher information matrix is estimated by the variance of the
observed score matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.value</code></td>
<td>
<p>a numeric value or vector. This is the same as <code>start</code> argument in <code>glm</code> or
<code>glm2</code>. The value is a starting point in iteratively reweighted least squares (IRLS) algorithm for
estimating the MLE of coefficients in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of parameters to control the fitting process in <code>glm</code> or <code>glm2</code> function.
For more details, see <code>glm.control</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which goodness-of-fit statistic is to be computed. The default value is
'cvm' for the Cramer-von-Mises statistic. Other options include 'ad' for the Anderson-Darling statistic, and 'both'
to compute both cvm and ad.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of three containing the following components:
</p>

<ul>
<li>
<p> Statistic: the value of goodness-of-fit statistic.
</p>
</li>
<li>
<p> p-value: the approximate p-value for the goodness-of-fit test based on empirical distribution function.
if method = 'cvm' or method = 'ad', it returns a numeric value for the statistic and p-value. If method = 'both', it
returns a numeric vector with two elements and one for each statistic.
</p>
</li>
<li>
<p> converged: logical to indicate if the IWLS algorithm have converged or not.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
n &lt;- 50
p &lt;- 5
x &lt;- matrix( rnorm(n*p, mean = 10, sd = 0.1), nrow = n, ncol = p)
b &lt;- runif(p)
e &lt;- rgamma(n, shape = 3)
y &lt;- exp(x %*% b) * e
testGLMGamma(x, y, l = 'log')
myfit &lt;- glm(y ~ x, family = Gamma('log'), x = TRUE, y = TRUE)
testGLMGamma(fit = myfit)
</code></pre>


</div>