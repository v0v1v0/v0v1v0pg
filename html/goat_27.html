<div class="container">

<table style="width: 100%;"><tr>
<td>plot_volcano</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>For each provided geneset, a volcano plot of all genelist log2fc and p-values with respective geneset constituents highlighted</h2>

<h3>Description</h3>

<p>For each provided geneset, a volcano plot of all genelist log2fc and p-values with respective geneset constituents highlighted
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_volcano(
  x,
  genelist,
  plot = TRUE,
  topn_labels = 0,
  color_default = "#B0B0B0",
  color_highlight = "#ef5350",
  color_label = "#000000",
  pointsize = 2,
  pointalpha = 0.75,
  labelsize = 7
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a subset of the results from <code>test_genesets</code> function, see example</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genelist</code></td>
<td>
<p>input genelist, must contain columns 'gene', 'log2fc' and 'pvalue_adjust' (not! log transformed). If parameter topn_labels is provided, also include a character column 'symbol' that contains gene names/symbols/labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>TRUE</code>, will directly show the plots. if <code>FALSE</code>, returns a list of ggplot objects corresponding to rows in the input <code>result</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topn_labels</code></td>
<td>
<p>for how many genes that overlap between genelist and a geneset should we plot the gene symbol? This requires a column 'symbol' in the genelist parameter (default: 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_default</code></td>
<td>
<p>color for genes that are not part of a geneset (default: grey)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_highlight</code></td>
<td>
<p>color used to highlight geneset constituents (default: red)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_label</code></td>
<td>
<p>provided that topn_labels is set, this is the color of the text labels (default: black)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointsize</code></td>
<td>
<p>size of the dots, this parameter is passed to geom_point (default: 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointalpha</code></td>
<td>
<p>alpha of the dots, this parameter is passed to geom_point (default: 0.75)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelsize</code></td>
<td>
<p>provided that topn_labels is set, this is the text size (in pt) for the labels (default: 7)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>plot==FALSE</code>, a list of ggplot2 objects. Otherwise, does not return any value
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# note; this example downloads data when first run, and typically takes ~60seconds

# store the downloaded files in the following directory. Here, the temporary file
# directory is used. Alternatively, consider storing this data in a more permanent location.
# e.g. output_dir="~/data/goat" on unix systems or output_dir="C:/data/goat" on Windows
output_dir = tempdir()

## first run the default example from test_genesets() to obtain geneset results
datasets = download_goat_manuscript_data(output_dir)
genelist = datasets$`Wingo 2020:mass-spec:PMID32424284`
genesets_asis = download_genesets_goatrepo(output_dir)
genesets_filtered = filter_genesets(genesets_asis, genelist)
result = test_genesets(genesets_filtered, genelist, method = "goat",
  score_type = "effectsize", padj_method = "bonferroni", padj_cutoff = 0.05)

## example 1; select top10 GO CC terms from the geneset testing results
result_subset = result |&gt; filter(source == "GO_CC") |&gt; arrange(pvalue) |&gt; head(n = 10)
pdf(paste0(output_dir, "/volcano_CC_top10.pdf"), width = 4, height = 4)
plot_volcano(result_subset, genelist)
dev.off()

## example 2;, select small genesets that are significant and have
## near-exclusive enrichment in either up up/down-regulated genes
# first, add geneset directionality scores to our results
result = score_geneset_directionality(result, genelist)
# next, subset the geneset result table
result_subset = result |&gt;
  filter(signif &amp; ngenes &lt;= 50 &amp; abs(score_directionality_rank) &gt; 0.6) |&gt;
  arrange(pvalue_adjust)
# finally, create plots. Note that the genelist contains a column 'symbol'
# which we use here to print labels for the topN genes per plotted geneset
pdf(paste0(output_dir, "/volcano_signif_ngenes50_directionality06.pdf"), width = 4, height = 4)
plot_volcano(result_subset, genelist, topn_labels = 10)
dev.off()

</code></pre>


</div>