<div class="container">

<table style="width: 100%;"><tr>
<td>qpgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile Penalized Generalized Estimating Equations with Auto Selected Penalty level</h2>

<h3>Description</h3>

<p>This function automatically select the penalty level by going through a list
of lambdas, and select the best level of penalty with high-dimensional BIC
(HBIC) or cross-validation (CV).
</p>


<h3>Usage</h3>

<pre><code class="language-R">qpgee(
  x,
  y,
  tau = 0.5,
  method = "HBIC",
  ncore = 1,
  nobs = rep(1, length(y)),
  correlation = "exchangeable",
  lambda = NULL,
  intercept = FALSE,
  f0 = NULL,
  betaint = NULL,
  max_it = 100,
  cutoff = 10^-1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The quantile to be estimated (default is 0.5, the median).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The criterion to select level of penalty. Currently it only
supports "HBIC".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore</code></td>
<td>
<p>A numeric value specifying how many core to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>A numeric vector indicating the number of observations per subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>A string specifying the working correlation structure.
Options include "exchangeable" (Exchangeable), "AR1" (Autoregressive),
"Tri" (Tri-diagonal), and "exchangeable" (Independent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A vector of penalty parameter for regularization. If not provided,
a grid will be provided by this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Whether to include an intercept when estimating.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f0</code></td>
<td>
<p>estimated conditional error distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaint</code></td>
<td>
<p>Initial values for the beta coefficients. If NULL,
non-longitudinal quantile regression is used for initialization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_it</code></td>
<td>
<p>Maximum number of iterations (default is 100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Threshold for coefficient shrinkage (default is 0.1).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Estimated beta coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Fitted values of the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Estimated working correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_selected</code></td>
<td>
<p>Indices of selected predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcl</code></td>
<td>
<p>Mean check loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hbic</code></td>
<td>
<p>Hannan-Quinn Information Criterion value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge</code></td>
<td>
<p>Boolean indicating whether the algorithm converged.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Example usage:

sim_data &lt;- generateData(nsub = 20, nobs = rep(10, 20),  p = 20,
                         beta0 = c(rep(1,5),rep(0,15)), rho = 0.1, correlation = "AR1",
                          dis = "normal", ka = 1)

X=sim_data$X
y=sim_data$y

#fit qpgee with auto selected lambda
qpgee.fit = qpgee(X,y,tau=0.5,nobs=rep(10, 20),ncore=1)
qpgee.fit$beta

</code></pre>


</div>