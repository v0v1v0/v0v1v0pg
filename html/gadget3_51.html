<div class="container">

<table style="width: 100%;"><tr>
<td>action_time</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gadget3 timekeeping actions</h2>

<h3>Description</h3>

<p>Add timekeeping to a g3 model
</p>


<h3>Usage</h3>

<pre><code class="language-R">g3a_time(
        start_year,
        end_year,
        step_lengths = c(12),
        final_year_steps = quote( length(step_lengths) ),
        project_years = g3_parameterized("project_years", value = 0, optimise = FALSE),
        retro_years = g3_parameterized("retro_years", value = 0, optimise = FALSE),
        run_at = g3_action_order$time)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>start_year</code></td>
<td>

<p>Year model run will start.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_year</code></td>
<td>

<p>After this year, model run will stop.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step_lengths</code></td>
<td>

<p>Either an MFDB time grouping, e.g. <code>mfdb::mfdb_timestep_quarterly</code>, or a
vector of step lengths which should should sum to 12,
for example, <code>c(3,3,3,3)</code> for quarterly steps within a year.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_year_steps</code></td>
<td>

<p>Number of steps of final year to include. Either as an integer or quoted
code, in which case it will be calcuated when the model runs.
For example:
</p>

<dl>
<dt><code>0</code></dt>
<dd>
<p>Model stops before the start of <var>end_year</var> (it is exclusive)</p>
</dd>
<dt><code>length(step_lengths)</code></dt>
<dd>
<p>Model stops at the end of <var>end_year</var> (it is inclusive)</p>
</dd>
<dt><code>2</code></dt>
<dd>
<p>Model stops at the second step of <var>end_year</var>, mid-year if <var>step_lengths</var> is quarterly</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>project_years</code></td>
<td>

<p>Number of years to continue running after the "end" of the model. Must be <code>&gt;= 0</code>
</p>
<p>Defaults to an unoptimized <code>project_years</code> parameter, set to 0 (i.e. no projection).
Generally, you would change this parameter in the parameter template, rather than changing here.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retro_years</code></td>
<td>

<p>Adjust <var>end_year</var> to finish model early. Must be <code>&gt;= 0</code>
Can be used in conjunction with <var>project_years</var> to project instead.
</p>
<p>The true end year of the model will be <code>end_year - retro_years + project_years</code>.
</p>
<p>Defaults to an unoptimized <code>retro_years</code> parameter, set to 0.
Generally, you would change this parameter in the parameter template, rather than changing here.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_at</code></td>
<td>

<p>Integer order that actions will be run within model, see <code>g3_action_order</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The actions will define the following variables in your model:
</p>

<dl>
<dt><var>cur_time</var></dt>
<dd>
<p>Current iteration of model, starts at 0 and increments until finished</p>
</dd>
<dt><var>cur_step</var></dt>
<dd>
<p>Current step within individual year</p>
</dd>
<dt><var>cur_step_size</var></dt>
<dd>
<p>Proportion of year this step contains, e.g. quarterly = 3/12</p>
</dd>
<dt><var>cur_year</var></dt>
<dd>
<p>Current year</p>
</dd>
<dt><var>cur_step_final</var></dt>
<dd>
<p>TRUE iff this is the final step of the year</p>
</dd>
<dt><var>cur_year_projection</var></dt>
<dd>
<p>TRUE iff we are currently projecting past <var>end_year</var></p>
</dd>
<dt><var>total_steps</var></dt>
<dd>
<p>Total # of iterations (including projection) before model stops</p>
</dd>
<dt><var>total_years</var></dt>
<dd>
<p>Total # of years (including projection) before model stops</p>
</dd>
</dl>
<h3>Value</h3>



<h4>g3a_time</h4>

<p>An action (i.e. list of formula objects) that will...</p>

<ol>
<li>
<p>Define <var>cur_*</var> variables listed above
</p>
</li>
<li>
<p>If we've reached the end of the model, return <var>nll</var>
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R"># Run model 2000..2004, in quarterly steps
time_action &lt;- g3a_time(
    start_year = 2000,
    end_year = 2004,
    c(3, 3, 3, 3))
</code></pre>


</div>