<div class="container">

<table style="width: 100%;"><tr>
<td>getResidualCor.gllvm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract residual correlations from gllvm object</h2>

<h3>Description</h3>

<p>Calculates the residual correlation matrix for gllvm model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gllvm'
getResidualCor(object, adjust = 1, site.index = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class 'gllvm'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>The type of adjustment used for  negative binomial and binomial distribution when computing residual correlation matrix. Options are 0 (no adjustment), 1 (the default adjustment) and 2 (alternative adjustment for NB distribution). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site.index</code></td>
<td>
<p>A site index used used in the calculation of a GLLVM with quadratic response model, for which the residual correlations are calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Residual correlation matrix is calculated based on the residual covariance matrix, see details from <code>getResidualCov.gllvm</code>.
</p>


<h3>Author(s)</h3>

<p>Francis K.C. Hui, Jenni Niku, David I. Warton
</p>


<h3>Examples</h3>

<pre><code class="language-R">#'# Extract subset of the microbial data to be used as an example
data(microbialdata)
y &lt;- microbialdata$Y[, order(colMeans(microbialdata$Y &gt; 0), 
                     decreasing = TRUE)[21:40]]
fit &lt;- gllvm(y, family = poisson())
fit$logL
cr &lt;- getResidualCor(fit)
cr[1:5,1:5]
## Not run: 
# Load a dataset from the mvabund package
data(antTraits)
y &lt;- as.matrix(antTraits$abund)
# Fit gllvm model
fit &lt;- gllvm(y = y, family = poisson())
# residual correlations:
cr &lt;- getResidualCor(fit)
# Plot residual correlations:
install.packages("corrplot", "gclus")
library(corrplot)
library(gclus)
corrplot(cr[order.single(cr), order.single(cr)], diag = F,
  type = "lower", method = "square", tl.cex = 0.8, tl.srt = 45, tl.col = "red")
  
## End(Not run)

</code></pre>


</div>