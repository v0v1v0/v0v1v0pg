<div class="container">

<table style="width: 100%;"><tr>
<td>bGAMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Generalized Semiparametric Mixed-Effects Models</h2>

<h3>Description</h3>

<p>Fit a semiparametric mixed model or a generalized semiparametric mixed model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bGAMM(fix=formula, add=formula, rnd=formula, 
      data, lambda, family = NULL, control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fix</code></td>
<td>
<p>a two-sided linear formula object describing the
fixed-effects part of the model, with the response on the left of a
<code>~</code> operator and the terms, separated by <code>+</code> operators, on
the right. For categorical covariables use <code>as.factor(.)</code> in the formula. 
Note, that the corresponding dummies are treated as a group and are updated blockwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>a one-sided linear formula object describing the
additive part of the model, with the additive terms on the right side of a
<code>~</code> operator, separated by <code>+</code> operators. The smooth terms 
are expanded in B-spline basis functions, with a difference penalty apllied on adjacent spline coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd</code></td>
<td>
<p>a two-sided linear formula object describing the
random-effects part of the model, with the grouping factor on the left of a
<code>~</code> operator and the random terms, separated by <code>+</code> operators, on
the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data frame containing the variables named in
<code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the smoothing parameter that controls the smoothness of the additive terms. 
The optimal smoothing parameter is a tuning parameter of the procedure that has to be determined, 
e.g. by use of information criteria or cross validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>a GLM family, see <code>glm</code> and
<code>family</code>. If <code>family</code> is missing then a
linear mixed model is fit; otherwise a generalized linear mixed
model is fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to replace the default values returned by the function <code>bGAMMControl</code>. Defaults to an empty list.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Generic functions such as <code>print</code>, <code>predict</code>, <code>summary</code> and <code>plot</code> have methods to show the results of the fit. 
The <code>predict</code> function uses also estimates of random effects for prediction, if possible (i.e. for known subjects of the grouping factor).
The <code>plot</code> function shows the estimated smooth functions. Single functions can be specified by a suitable vector in the <code>which</code> argument. 
Default is <code>which=Null</code> and all smooth functions (up to a maximum of nine) are shown.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a list containing an image of the <code>bGLMM</code> call that produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a vector containing the estimated fixed effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranef</code></td>
<td>
<p>a vector containing the estimated random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline.weights</code></td>
<td>
<p>a vector containing the estimated spline coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StdDev</code></td>
<td>
<p>a scalar or matrix containing the estimates of the random effects standard deviation or variance-covariance parameters, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>a vector of fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>estimated scale parameter, if <code>overdispersion=TRUE</code> is used. Otherwise, it is equal to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HatMatrix</code></td>
<td>
<p>hat matrix corresponding to the final fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC</code></td>
<td>
<p>a matrix containing the evaluated information criterion for the different covariates (columns) and for each boosting iteration (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC_sel</code></td>
<td>
<p>a vector containing the evaluated information criterion for the selected covariate at different boosting iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>components</code></td>
<td>
<p>a vector containing the selected components at different boosting iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>number of optimal boosting steps with respect to AIC or BIC, respectively, if <code>OPT=TRUE</code>. Otherwise, <code>opt</code> is equal to the number of iterations.
Note, that the boosting algorithm is also stopped, if it has converged with respect to the parameter estimates <code>[coefficients,ranef]</code> or with respect to the <code>IC_sel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Deltamatrix</code></td>
<td>
<p>a matrix containing the estimates of fixed and random effects (columns) for each boosting iteration (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_long</code></td>
<td>
<p>a list containing the estimates of the random effects standard deviation or variance-covariance parameters, respectively, for each boosting iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixerror</code></td>
<td>
<p>a vector with standrad errors for the fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranerror</code></td>
<td>
<p>a vector with standrad errors for the random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smootherror</code></td>
<td>
<p>a matrix with pointwise standard errors for the smooth function estimates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andreas Groll <a href="mailto:andreas.groll@stat.uni-muenchen.de">andreas.groll@stat.uni-muenchen.de</a>
</p>


<h3>References</h3>

<p>Groll, A. and G. Tutz (2012). Regularization for Generalized Additive Mixed Models by Likelihood-Based Boosting. 
<em>Methods of Information in Medicine</em> 51(2), 168â€“177.
</p>


<h3>See Also</h3>

<p><code>bGAMMControl</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
data("soccer")

gamm1 &lt;- bGAMM(points ~ ball.possession + tackles,
         ~ transfer.spendings + transfer.receits 
         + unfair.score + ave.attend + sold.out,
         rnd = list(team=~1), data = soccer, lambda = 1e+5,
         family = poisson(link = log), control = list(steps=200, overdispersion=TRUE,
         start=c(1,rep(0,25))))

plot(gamm1)

# see also demo("bGAMM-soccer")
</code></pre>


</div>