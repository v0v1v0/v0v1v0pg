<div class="container">

<table style="width: 100%;"><tr>
<td>gof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combining function for tests</h2>

<h3>Description</h3>

<p><code>gof</code> computes for a given dataset and based on the choices of
the user different tests for different copulae. If copulae are given, all
the implemented tests for those copulae are calculated. If tests are given,
all the implemented copulae for every test are used. If both copulae and
tests are given, all possible combinations are calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gof(
  x,
  priority = "copula",
  copula = NULL,
  tests = NULL,
  customTests = NULL,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  MJ = 100,
  dispstr = "ex",
  m = 1,
  delta.J = 0.5,
  nodes.Integration = 12,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priority</code></td>
<td>
<p>A character string which is either <code>"tests"</code> or
<code>"copula"</code>. <code>"tests"</code> indicates that all implemented tests are
performed for all copulae which the tests share. These are e.g.
<code>"normal"</code> and <code>"clayton"</code>. If <code>"copula"</code> is chosen, 
all copula are chosen and only the tests are performend which these copula 
share. If one of the arguments <code>tests</code> or <code>copula</code> is not 
<code>NULL</code>, then <code>priority</code> doesn't affect the choice of the copulae 
and tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>A character vector which indicates the copula to test for.
Possible are <code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"huslerReiss"</code>, <code>"tawn"</code>, <code>"tev"</code>, <code>"fgm"</code> and 
<code>"plackett"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tests</code></td>
<td>
<p>A character vector which indicates the tests to use. Possible
choices are the individual tests implemented in this package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>customTests</code></td>
<td>
<p>A character vector which indicates the customized test to
use, if any. The test has to be loaded into the workspace. Currently the
function containing the test has to have 2 arguments, the first one for the
dataset and the second one for the copula to test for. The arguments have to
be named "x" and "copula" respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>The copulae parameters to use for each test, if it shall not be
estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The degrees of freedom, if not meant to be estimated. Only
necessary if tested for <code>"t"</code>-copula. For the <code>"gofPIOSTn"</code> test
the entry is limited to 60 degrees of freedom for computational reasons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated. For the <code>"gofPIOSTn"</code> test the estimate is limited to 60
degrees of freedom for computational reasons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p>The vector of control parameters to flip the copula 
by 90, 180, 270 degrees clockwise. Only applicable for bivariate copula. 
Default is 0 and possible inputs are 0, 90, 180, 270 and NULL. One can either
specify one flip degree which will be applied on all copulae or choose
an individual flip for each copula in which case the input has to be a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The amount of bootstrap rounds to be performed by each test.
Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MJ</code></td>
<td>
<p>Just for the test gofKernel. Size of bootstrapping sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are "ex" for exchangeable and "un" for unstructured, see package
<code>copula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Length of blocks. Only necessary if the test <code>gofPIOSTn</code> is
part of <code>tests</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.J</code></td>
<td>
<p>Scaling parameter for the matrix of smoothing parameters.
Only necessary if the test <code>gofKernel</code> is part of <code>tests</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes.Integration</code></td>
<td>
<p>Number of knots of the bivariate Gauss-Legendre
quadrature. Only necessary if the test <code>gofKernel</code> is part of
<code>tests</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If a character vector is given for the argument <code>copula</code> and nothing
for <code>tests</code>, then all tests are performed for which the given copulae
are implemented. If <code>tests</code> contains a character vector of tests and
<code>copula = NULL</code>, then this tests will be performed for all implemented
copulae. If character vectors are given for <code>copula</code> and <code>tests</code>,
then the tests are performed with the given copulae. If <code>tests = NULL</code>
and <code>copula = NULL</code>, then the argument <code>priority</code> catches in and
defines the procedure.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>
<p>Note that this function does not display <code>warning()</code> messages. Due to
the large amount of tests run at once, the messages are not tracable to the
situation when they appeared. Hence they are omitted for this function.
</p>


<h3>Value</h3>

<p>A list containing several objects of <code>class</code> gofCOP with the
following components for each copulae </p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character which
informs about the performed analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>the method used to estimate the margin distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.margins</code></td>
<td>
<p>the parameters of the estimated margin distributions.
Only applicable if the margins were not specified as <code>"ranks"</code> or
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>dependence parameters of the copulae</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula. Only applicable for
t-copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values and test statistics
of the hybrid and the individual tests</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
data(IndexReturns2D)

gof(IndexReturns2D, priority = "tests", copula = "normal", 
tests = c("gofRosenblattSnB", "gofRosenblattSnC"), M = 5)

</code></pre>


</div>