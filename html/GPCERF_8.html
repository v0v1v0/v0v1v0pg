<div class="container">

<table style="width: 100%;"><tr>
<td>compute_posterior_m_nn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate posterior means for nnGP model</h2>

<h3>Description</h3>

<p>Calculates the posterior mean of a point on the CERF based on the nnGP model.
This function also returns the weights assigned to all nearest neighbors when
calculating the posterior mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_posterior_m_nn(
  hyperparam,
  w,
  gps_w,
  obs_ord,
  y_obs_ord,
  kernel_fn = function(x) exp(-x^2),
  n_neighbor = 10,
  block_size = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hyperparam</code></td>
<td>
<p>A set of hyperparameters in the GP model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A scaler representing the exposure level for the point of interest
on the CERF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gps_w</code></td>
<td>
<p>The GPS for all samples when their exposure levels are set
at <code>w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_ord</code></td>
<td>
<p>A matrix of two columns. First column is the observed
exposure levels of all samples; second is the GPS at the observed exposure
levels. The rows are in ascending order for the first column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_obs_ord</code></td>
<td>
<p>A vector of observed outcome values. The vector is ordered
as <code>obs_ord</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_fn</code></td>
<td>
<p>The covariance function of the GP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_neighbor</code></td>
<td>
<p>The number of nearest neighbors on one side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_size</code></td>
<td>
<p>Number of samples included in a computation block.
Mainly used to balance the speed and memory requirement.
Larger <code>block_size</code> is faster, but requires more memory.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>TODO: The first column is the selected index and the second column is weight.
A two-column matrix. The first column is the weights assigned to each
nearest neighbor. The second column is the corresponding observed outcome
value. The weight in the last row of this matrix is NA and the observed
outcome value is the estimated posterior mean of the CERF at point <code>w</code>,
which is the weighted sum of all observed outcome values of the neighbors.
</p>


</div>