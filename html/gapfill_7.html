<div class="container">

<table style="width: 100%;"><tr>
<td>EstimateQuantile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Quantile of a Missing Value</h2>

<h3>Description</h3>

<p>Helper function for <code>Predict</code>.
The function estimates the quantile of the missing value at position <code>mp</code> from the
data <code>a</code> relative to its image a[,,mp[3],mp[4]].
</p>


<h3>Usage</h3>

<pre><code class="language-R">EstimateQuantile(a, mp, nQuant, predictionInterval = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Numeric array with 4 dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mp</code></td>
<td>
<p>Integer vector of length 4 indexing the position of the
missing value to predict.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nQuant</code></td>
<td>
<p>Integer vector of length 1. Minimum number of non-missing values in <code>a[mp[1], mp[2],,]</code> required to estimate the quantile.
If <code>a[mp[1], mp[2],,]</code> contains less non-missing values, the neighboring values of <code>a[mp[1], mp[2],,]</code> are also taken into account.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictionInterval</code></td>
<td>
<p>Logical vector of length 1.
If <code>TRUE</code>, the estimated quantile together with lower and upper bounds of an approximate 90% uncertainty interval
is returned.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>predictionInterval</code> is <code>FALSE</code>, a numeric vector of length 1 being the estimated quantile of the missing value
<code>a[mp[1], mp[2], mp[3], mp[4]]</code> is returned.
Otherwise, a numeric vector of length 3 containing the estimated quantile and the lower and upper bounds of an
approximate 90% uncertainty interval is returned.
</p>


<h3>Author(s)</h3>

<p>Florian Gerber, <a href="mailto:flora.fauna.gerber@gmail.com">flora.fauna.gerber@gmail.com</a>.
</p>


<h3>References</h3>

<p>F. Gerber, R. de Jong, M. E. Schaepman, G. Schaepman-Strub, and R. Furrer (2018)
in IEEE Transactions on Geoscience and Remote Sensing, pp. 1-13, doi: <a href="https://doi.org/10.1109/TGRS.2017.2785240">10.1109/TGRS.2017.2785240</a>.
</p>


<h3>See Also</h3>

<p><code>Predict</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">a &lt;- Subset(data = ndvi, mp = c(1, 3, 1, 2), i = 0)
EstimateQuantile(a = a, mp = attr(a, "mp"), nQuant = 2)

</code></pre>


</div>