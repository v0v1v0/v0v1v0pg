<div class="container">

<table style="width: 100%;"><tr>
<td>gfm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Factor Model</h2>

<h3>Description</h3>

<p>This function is to implement the generalized factor model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  gfm(XList, types, q=10, offset=FALSE, dc_eps=1e-4, maxIter=30,
                verbose = TRUE, algorithm=c("VEM", "AM"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>XList</code></td>
<td>
<p>a list consisting of matrices with the same rows n, and different columns (p1,p2, ..., p_d),observational mixed data matrix list, d is the types of variables, p_j is the dimension of varibles with the j-th   type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>types</code></td>
<td>
<p>a d-dimensional character vector, specify the type of variables. For example, <code>types=c('gaussian','poisson', 'binomial')</code>, implies the  components of <code>XList</code> are matrices with continuous, count and binomial values, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a positive integer or empty, specify the number of factors, defualt as 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>a logical value, whether add an offset term (the total counts for each row in the count component of XList) when there are Poisson variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dc_eps</code></td>
<td>
<p>a positive real, specify the relative tolerance of objective function in the algorithm. Optional parameter with default as <code>1e-4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>a positive integer, specify the times of iteration. Optional parameter with default as 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value with TRUE or FALSE, specify whether ouput the information in iteration process, (optional) default as TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>a string, specify the algorithm to be used for fitting model. Now it supports two algorithms: variational EM (VEM) and alternate maximization (AM) algorithm, default as VEM. Empirically, we observed that VEM is more robust than AM to the high noise data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function also has the MATLAB version at <a href="https://github.com/feiyoung/MGFM/blob/master/gfm.m">https://github.com/feiyoung/MGFM/blob/master/gfm.m</a>.
</p>


<h3>Value</h3>

<p>return a list with class name 'gfm' and including following components,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>hH</code></td>
<td>
<p>a n*q matrix, the estimated factor matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hB</code></td>
<td>
<p>a p*q matrix, the estimated loading matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmu</code></td>
<td>
<p>a p-dimensional vector, the estimated intercept terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a real number, the value of objective function when the convergence achieves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>an integer, the used or estimated factor number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>history</code></td>
<td>
<p>a list including the following 7 components: (1)dB: the varied quantity of B in each iteration; (2)dH: the varied quantity of H in each iteration; (3)dc: the varied quantity of the objective function in each iteration; (4)c: the objective value in each iteration; (5) realIter: the real iterations to converge; (6)maxIter: the tolerance of maximum iterations; (7)elapsedTime: the elapsed time.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Liu Wei
</p>


<h3>References</h3>

<p><a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.2021.1999818?journalCode=uasa20">Liu, W., Lin, H., Zheng, S., &amp; Liu, J. (2021). Generalized factor model for ultra-high dimensional correlated variables with mixed types. Journal of the American Statistical Association, (just-accepted), 1-42.</a>
</p>
<p>Bai, J. and Liao, Y. (2013). Statistical inferences using large esti-
mated covariances for panel data and factor models.
</p>


<h3>See Also</h3>

<p>nothing
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## mix of normal and Poisson

dat &lt;- gendata(seed=1, n=60, p=60, type='norm_pois', q=2, rho=2)
## we set maxIter=2 for example.
gfm2 &lt;- gfm(dat$XList,  dat$types,  q=2, verbose = FALSE, maxIter=2)
measurefun(gfm2$hH, dat$H0, type='ccor')
measurefun(gfm2$hB, dat$B0, type='ccor')
</code></pre>


</div>