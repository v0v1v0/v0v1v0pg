<div class="container">

<table style="width: 100%;"><tr>
<td>plot_ggoutlier</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize GGoutlieR results on a geographical map</h2>

<h3>Description</h3>

<p>Visualize geo-genetic patterns of outliers with their K nearest neighbors
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_ggoutlier(
  ggoutlier_res,
  geo_coord,
  anc_coef = NULL,
  gen_coord = NULL,
  pie_color = NULL,
  map_color = "black",
  p_thres = NULL,
  color_res = 10,
  dot_cex = NULL,
  map_type = c("geographic_knn", "genetic_knn", "both"),
  select_xlim = c(-180, 180),
  select_ylim = c(-90, 90),
  plot_xlim = NULL,
  plot_ylim = NULL,
  only_edges_in_xylim = TRUE,
  pie_r_scale = 1,
  map_resolution = "medium",
  show_knn_pie = FALSE,
  which_sample = NULL,
  add_benchmark_graph = TRUE,
  adjust_p_value_projection = FALSE,
  linewidth_range = c(0.5, 3),
  plot_labels = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ggoutlier_res</code></td>
<td>
<p>output of 'ggoutlier'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geo_coord</code></td>
<td>
<p>matrix or data.frame with two columns. The first column is longitude and the second one is latitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anc_coef</code></td>
<td>
<p>matrix. A matrix of ancestry coefficients with samples ordered by rows. Ancestry coefficients are used to make pie charts on a geographical map. This argument is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen_coord</code></td>
<td>
<p>matrix. A matrix of "coordinates in a genetic space". It should be identical to the 'gen_coord' used for running 'ggoutlier'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie_color</code></td>
<td>
<p>string. Colors of pie charts. colors are automatically assigned if 'pie_color = NULL' (which is the default). This argument is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_color</code></td>
<td>
<p>string. Colors of map contours. The default is 'map_color = "black"'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_thres</code></td>
<td>
<p>numeric. A value of significant level. Only outliers (p values less than 'p_thres') are mapped on a geographical map if 'p_thres' is provided (the default is 'NULL'). This argument is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_res</code></td>
<td>
<p>integer. The resolution of color scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dot_cex</code></td>
<td>
<p>numeric. The size of dots denoting the positions of samples on a geographical map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_type</code></td>
<td>
<p>string. The type of plot to draw. It can be '"geographic_knn"', '"genetic_knn"' and '"both"'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_xlim</code></td>
<td>
<p>vector. Values controlling longitude boundaries of a window to select outliers to present on a geographical map. The default is 'select_xlim = c(-180,180)'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_ylim</code></td>
<td>
<p>vector. Values controlling latitude boundaries of a window to select outliers to present on a geographical map. The default is 'select_ylim = c(-90,90)'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_xlim</code></td>
<td>
<p>vector. Values controlling longitude boundaries of a map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_ylim</code></td>
<td>
<p>vector. Values controlling latitude boundaries of a map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only_edges_in_xylim</code></td>
<td>
<p>logic. only the edges with starting points within the given 'select_xlim' and 'select_ylim' will display on a geographical map. If 'FALSE', the edges out of the given boundaries will be removed from your plot. The default is 'TRUE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie_r_scale</code></td>
<td>
<p>numeric. A scale controlling the radius of pie charts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_resolution</code></td>
<td>
<p>a character string. The resolution of the geographical map. See details of the 'scale' argument in the manual of 'rnaturalearth::ne_countries()'. The default is 'map_resolution = "medium"'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_knn_pie</code></td>
<td>
<p>logic. If 'TRUE', the ancestry coefficients of K nearest neighbors of significant samples will display on the map. The default is 'FALSE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_sample</code></td>
<td>
<p>a string vector of sample ID(s). If users want to only show specific sample(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_benchmark_graph</code></td>
<td>
<p>logic. If 'TRUE', a benchmark graph with only pie charts of ancestry coefficients for comparison with the outlier graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust_p_value_projection</code></td>
<td>
<p>logic. If 'TRUE', the function will perform KNN prediction by forcing K=1 and compute new p-values for visualization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linewidth_range</code></td>
<td>
<p>numeric. A vector of two values. It is used to control the minimal and maximal width of KNN network on the geographical map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_labels</code></td>
<td>
<p>character. A string of labels for plots. The default is 'plot_labels = "auto"'. This parameter is for 'cowplot::plot_grid'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Red links on the map denote individual pairs that are genetically similar but geographically remote.
The color depth and thickness of red links are proportional to -log10(p) based on the empirical Gamma distribution obtained from 'detect_outlier_in_GeneticSpace'.
Blue links on the map denote individual pairs that are genetically different but geographically close.
The color depth and thickness of blue links are proportional to -log10(p) based on the empirical Gamma distribution obtained from 'detect_outlier_in_GeoSpace'
</p>


<h3>Value</h3>

<p>ggplot object. The plot is geographical map(s) with colored lines showing sample pairs with unusual geo-genetic associations.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(GGoutlieR)
data("ipk_anc_coef") # get ancestry coefficients
data("ipk_geo_coord") # get geographical coordinates
data(ggoutlier_example) # get an example output of ggoutlier
## Not run: 
plot_ggoutlier(ggoutlier_res = ggoutlier_example,
               gen_coord = ipk_anc_coef,
               geo_coord = ipk_geo_coord,
               p_thres = 0.025,
               map_type = "both",
               select_xlim = c(-20,140),
               select_ylim = c(10,62),
               plot_xlim = c(-20,140),
               plot_ylim = c(10,62),
               pie_r_scale = 1.8,
               map_resolution = "medium")
               
## End(Not run)

</code></pre>


</div>