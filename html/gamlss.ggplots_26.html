<div class="container">

<table style="width: 100%;"><tr>
<td>fitted_centiles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting centile (growth) curves
</h2>

<h3>Description</h3>

<p>The function <code>fitted_centiles()</code> plots centiles curves for distributions belonging to the GAMLSS family of distributions. The plot is equivalent to the standard plot of <code>gamlss:::centiles()</code> without a legend.
</p>
<p>The function <code>fitted_centiles_legend()</code> plots centiles curves for distributions belonging to the GAMLSS family of distributions and it is  equivalent to the standard plot of <code>gamlss:::centiles()</code> with a legend. The function  is slower than <code>fitted_centiles()</code> since in order to plot the legend the data have to expanded.  
</p>
<p>The function <code>model_centiles()</code> plots centile curves for more than one model.  There is no equivalent  plot in the original GAMLSS centile plots  but it perform the same function as <code>gamlss:::centiles.com()</code>  which compares centiles from different models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitted_centiles(obj, xvar, 
               cent = c(99.4, 98, 90, 75, 50, 25, 10, 2, 0.4), 
               points = TRUE, point.col = "gray", 
               point.size = 1, line.size = 0.8, 
               line.col = hcl.colors(lc, palette = "Dark 2"), 
               line.type = rep(1, length(cent)),
               xlab = NULL, ylab = NULL, title, ...)
               
fitted_centiles_legend(obj, xvar, 
               cent = c(99.4, 98, 90, 75, 50, 25, 10, 2, 0.4),   
               points = TRUE, point.col = "gray", point.size = 1, 
               line.size = 0.8, line.col = hcl.colors(ncent, 
               palette = "Dark 2"), line.type = rep(1, length(cent)),               
               show.legend = TRUE, save.data = FALSE, title, 
               xlab = NULL, ylab = NULL, ...)               

model_centiles(obj, ..., cent = c(97, 90, 75, 50, 25, 10, 3), 
               xvar, xlab = "age", points = TRUE, 
               point.col = gray(0.8), 
               point.size = 0.05, line.size = 0.7, 
               line.col = hcl.colors(ncent,palette = "Dark 2"), 
               ncol = 2, nrow = ceiling(nnames/ncol),  in.one = FALSE,
               title)               
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a fitted gamlss object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>the (unique) explanatory variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cent</code></td>
<td>
<p>a vector with elements the % centile values for which the centile curves have to be evaluated (note that the order is from the highest to the lowest so legend and  the plots are maching)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>whether to plot the points (<code>TRUE</code>) of the data or not (<code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.col</code></td>
<td>
<p>the colour of the points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.size</code></td>
<td>
<p>the zize of the points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.size</code></td>
<td>
<p>the sized of the centile lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>the colour of the  centile lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.type</code></td>
<td>
<p>the type of line (different types of lines for each centile are working with <code>fitted_centiles_legend</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>the label of the x-axis variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>the label of the resposnse variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.one</code></td>
<td>
<p>whether the <code>model_centile</code> plot should be one or multiple</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>the title if need it otherwise a dfault title is pronted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.legend</code></td>
<td>
<p>whether to show the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.data</code></td>
<td>
<p>whether to save the <code>data.frame</code> of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>
<p>the number of rows in the <code>model_centiles()</code> plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>the number of columns in the <code>model_centiles()</code> plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra  arguments for <code>fitted_centiles()</code>, and <code>fitted_centiles.legend()</code> and extra models for <code>model_centiles()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Centiles are calculated using the fitted values in <code>obj</code> and <code>xvar</code> must
correspond exactly to the predictor in <code>obj</code> to plot correctly.
</p>


<h3>Value</h3>

<p>A plot is created 
</p>


<h3>Warning </h3>

<p>This function is appropriate only when one continuous explanatory variable is fitted in the model</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda de Bastiani
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

   <p><code>centiles</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
data(abdom)
h&lt;-gamlss(y~pb(x), sigma.formula=~pb(x), family=BCTo, data=abdom) 
h1 &lt;- gamlss(y~pb(x), sigma.formula=~pb(x), family=LO, data=abdom) 
fitted_centiles(h)
fitted_centiles_legend(h)
model_centiles(h, h1)

</code></pre>


</div>