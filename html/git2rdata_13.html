<div class="container">

<table style="width: 100%;"><tr>
<td>meta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimize an Object for Storage as Plain Text and Add Metadata</h2>

<h3>Description</h3>

<p>Prepares a vector for storage. When relevant, <code>meta()</code> optimizes the object
for storage by changing the format to one which needs less characters. The
metadata stored in the <code>meta</code> attribute, contains all required information to
back-transform the optimized format into the original format.
</p>
<p>In case of a data.frame, <code>meta()</code> applies itself to each of the columns. The
<code>meta</code> attribute becomes a named list containing the metadata for each column
plus an additional <code>..generic</code> element. <code>..generic</code> is a reserved name for
the metadata and not allowed as column name in a <code>data.frame</code>.
</p>
<p><code>write_vc()</code> uses this function to prepare a dataframe for storage.
Existing metadata is passed through the optional <code>old</code> argument. This
argument intended for internal use.
</p>


<h3>Usage</h3>

<pre><code class="language-R">meta(x, ...)

## S3 method for class 'character'
meta(x, na = "NA", optimize = TRUE, ...)

## S3 method for class 'factor'
meta(x, optimize = TRUE, na = "NA", index, strict = TRUE, ...)

## S3 method for class 'logical'
meta(x, optimize = TRUE, ...)

## S3 method for class 'POSIXct'
meta(x, optimize = TRUE, ...)

## S3 method for class 'Date'
meta(x, optimize = TRUE, ...)

## S3 method for class 'data.frame'
meta(
  x,
  optimize = TRUE,
  na = "NA",
  sorting,
  strict = TRUE,
  split_by = character(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to the methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na</code></td>
<td>
<p>the string to use for missing values in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimize</code></td>
<td>
<p>If <code>TRUE</code>, recode the data to get smaller text files.
If <code>FALSE</code>, <code>meta()</code> converts the data to character.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>An optional named vector with existing factor indices.
The names must match the existing factor levels.
Unmatched levels from <code>x</code> will get new indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strict</code></td>
<td>
<p>What to do when the metadata changes. <code>strict = FALSE</code>
overwrites the data and the metadata with a warning listing the changes,
<code>strict = TRUE</code> returns an error and leaves the data and metadata as is.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorting</code></td>
<td>
<p>an optional vector of column names defining which columns to
use for sorting <code>x</code> and in what order to use them.
The default empty <code>sorting</code> yields a warning.
Add <code>sorting</code> to avoid this warning.
Strongly recommended in combination with version control.
See <code>vignette("efficiency", package = "git2rdata")</code> for an illustration of
the importance of sorting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split_by</code></td>
<td>
<p>An optional vector of variables name to split the text files.
This creates a separate file for every combination.
We prepend these variables to the vector of <code>sorting</code> variables.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the optimized vector <code>x</code> with <code>meta</code> attribute.
</p>


<h3>Note</h3>

<p>The default order of factor levels depends on the current locale.
See <code>Comparison</code> for more details on that.
The same code on a different locale might result in a different sorting.
<code>meta()</code> ignores, with a warning, any change in the order of factor levels.
Add <code>strict = FALSE</code> to enforce the new order of factor levels.
</p>


<h3>See Also</h3>

<p>Other internal: 
<code>is_git2rdata()</code>,
<code>is_git2rmeta()</code>,
<code>print.git2rdata()</code>,
<code>summary.git2rdata()</code>,
<code>upgrade_data()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">meta(c(NA, "'NA'", '"NA"', "abc\tdef", "abc\ndef"))
meta(1:3)
meta(seq(1, 3, length = 4))
meta(factor(c("b", NA, "NA"), levels = c("NA", "b", "c")))
meta(factor(c("b", NA, "a"), levels = c("a", "b", "c")), optimize = FALSE)
meta(factor(c("b", NA, "a"), levels = c("a", "b", "c"), ordered = TRUE))
meta(
  factor(c("b", NA, "a"), levels = c("a", "b", "c"), ordered = TRUE),
  optimize = FALSE
)
meta(c(FALSE, NA, TRUE))
meta(c(FALSE, NA, TRUE), optimize = FALSE)
meta(complex(real = c(1, NA, 2), imaginary = c(3, NA, -1)))
meta(as.POSIXct("2019-02-01 10:59:59", tz = "CET"))
meta(as.POSIXct("2019-02-01 10:59:59", tz = "CET"), optimize = FALSE)
meta(as.Date("2019-02-01"))
meta(as.Date("2019-02-01"), optimize = FALSE)
</code></pre>


</div>