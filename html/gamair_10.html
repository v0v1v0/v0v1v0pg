<div class="container">

<table style="width: 100%;"><tr>
<td>ch1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Code for Chapter 1: Linear Models</h2>

<h3>Description</h3>

<p>R code from Chapter 1 of the second edition of ‘Generalized Additive Models: An Introduction with R’ is in the examples section below.
</p>


<h3>Author(s)</h3>

<p>Simon Wood &lt;simon@r-project.org&gt;
</p>
<p>Maintainer: Simon Wood &lt;simon@r-project.org&gt;
</p>


<h3>References</h3>

<p>Wood, S.N. (2017) <em>Generalized Additive Models: An Introduction with R</em>, CRC
</p>


<h3>See Also</h3>

<p><code>mgcv</code>, <code>ch1.solutions</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(gamair); library(mgcv)

## 1.1.2
data(hubble)
hub.mod &lt;- lm(y ~ x - 1, data=hubble)
summary(hub.mod)
plot(fitted(hub.mod),residuals(hub.mod),xlab="fitted values",
     ylab="residuals")
hub.mod1 &lt;- lm(y ~ x - 1,data=hubble[-c(3,15),])
summary(hub.mod1)
plot(fitted(hub.mod1),residuals(hub.mod1),
     xlab="fitted values",ylab="residuals")
hubble.const &lt;- c(coef(hub.mod),coef(hub.mod1))/3.09e19
age &lt;- 1/hubble.const
age/(60^2*24*365)

## 1.1.3
cs.hubble &lt;- 163000000
t.stat &lt;- (coef(hub.mod1)-cs.hubble)/vcov(hub.mod1)[1,1]^0.5
pt(t.stat,df=21)*2 # 2 because of |T| in p-value defn.

sigb &lt;- summary(hub.mod1)$coefficients[2]
h.ci &lt;- coef(hub.mod1)+qt(c(0.025,0.975),df=21)*sigb
h.ci
h.ci &lt;- h.ci*60^2*24*365.25/3.09e19 # convert to 1/years
sort(1/h.ci)

## 1.5.1
data(sperm.comp1)
pairs(sperm.comp1[,-1])
sc.mod1 &lt;- lm(count~time.ipc+prop.partner,sperm.comp1)
model.matrix(sc.mod1)
par(mfrow=c(2,2))  # split the graphics device into 4 panels
plot(sc.mod1)      # (uses plot.lm as sc.mod1 is class `lm')
sperm.comp1[9,]
sc.mod1
sc.mod2 &lt;- lm(count~time.ipc+I(prop.partner*time.ipc),
              sperm.comp1)

## 1.5.2
summary(sc.mod1)

## 1.5.3
sc.mod3 &lt;- lm(count~prop.partner,sperm.comp1)
summary(sc.mod3)
sc.mod4 &lt;- lm(count~1,sperm.comp1) # null model
AIC(sc.mod1,sc.mod3,sc.mod4)

## 1.5.4
data(sperm.comp2)
sc2.mod1 &lt;- lm(count~f.age+f.height+f.weight+m.age+m.height+
               m.weight+m.vol,sperm.comp2)
plot(sc2.mod1)
summary(sc2.mod1)
sc2.mod2 &lt;- lm(count~f.age+f.height+f.weight+m.height+
               m.weight+m.vol,sperm.comp2)
summary(sc2.mod2)
sc2.mod7 &lt;- lm(count~f.weight,sperm.comp2)
summary(sc2.mod7)
sc &lt;- sperm.comp2[-19,]
sc3.mod1 &lt;- lm(count~f.age+f.height+f.weight+m.age+m.height+
               m.weight+m.vol,sc)
summary(sc3.mod1)
sperm.comp1$m.vol &lt;-
   sperm.comp2$m.vol[sperm.comp2$pair%in%sperm.comp1$subject]
sc1.mod1 &lt;- lm(count~m.vol,sperm.comp1)
summary(sc1.mod1)

## 1.5.5
sc.c &lt;- summary(sc1.mod1)$coefficients
sc.c   # check info extracted from summary
sc.c[2,1]+qt(c(.025,.975),6)*sc.c[2,2]

## 1.5.6
df &lt;- data.frame(m.vol=c(10,15,20,25))
predict(sc1.mod1,df,se=TRUE)

## 1.5.7
set.seed(1); n &lt;- 100; x &lt;- runif(n)
z &lt;- x + rnorm(n)*.05
y &lt;- 2 + 3 * x + rnorm(n)
summary(lm(y~z))
summary(lm(y~x+z))

## 1.6.4
z &lt;- c(1,1,1,2,2,1,3,3,3,3,4)
z
z &lt;- as.factor(z)
z
x &lt;- c("A","A","C","C","C","er","er")
x
x &lt;- factor(x)
x
PlantGrowth$group
# PlantGrowth$group &lt;- as.factor(PlantGrowth$group)
pgm.1 &lt;- lm(weight ~ group,data=PlantGrowth)
plot(pgm.1)
summary(pgm.1)
pgm.0 &lt;- lm(weight~1,data=PlantGrowth)
anova(pgm.0,pgm.1)

</code></pre>


</div>