<div class="container">

<table style="width: 100%;"><tr>
<td>gsheet2tbl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Download Google sheet as a table</h2>

<h3>Description</h3>

<p>This is a convenience function, designed to download a table quickly and conveniently.
If you experience any unexpected results, or you want more reliability or control (e.g. for a production situation), then I'd recommend you parse manually using one of the constructions in the examples:
</p>

<ul>
<li>
<p><code>read.csv(text=gsheet2text(url, format='csv'), stringsAsFactors=FALSE)</code>
</p>
</li>
<li>
<p>
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">gsheet2tbl(url, sheetid = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>url</code></td>
<td>
<p>the google sheet url</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheetid</code></td>
<td>
<p>the index of the sheet to be downloaded. If you use the direct sheet URL, rather than the share by link, this will automatically be extracted. 
Otherwise, the first sheet will be downloaded by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Google sheet must have 'share by link' turned on.
</p>
<p>If the package <code>readr</code> is available, then it will be used. 
This can produce slightly different, but normally better, parsings.
</p>


<h3>See Also</h3>

<p><code>gsheet2text</code> to download as plain text
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Download a sheet
url &lt;- 'docs.google.com/spreadsheets/d/1I9mJsS5QnXF2TNNntTy-HrcdHmIF9wJ8ONYvEJTXSNo'
a &lt;- gsheet2tbl(url)

# Download the second sheet, using the direct url
url &lt;- 'docs.google.com/spreadsheets/d/1I9mJsS5QnXF2TNNntTy-HrcdHmIF9wJ8ONYvEJTXSNo#gid=850032961'
b &lt;- gsheet2tbl(url)

# To download a sheet with more control, use the following:
url &lt;- 'docs.google.com/spreadsheets/d/1I9mJsS5QnXF2TNNntTy-HrcdHmIF9wJ8ONYvEJTXSNo'
read.csv(text=gsheet2text(url, format='csv'), stringsAsFactors=FALSE)

# Or, with readr:
if(requireNamespace('readr', quietly=TRUE)){
  library(readr)
  read_csv(construct_download_url(url), col_types = cols(
    mpg = col_double(),
    cyl = col_integer(),
    disp = col_double(),
    hp = col_integer(),
    drat = col_double(),
    wt = col_double(),
    qsec = col_double(),
    vs = col_integer(),
    am = col_integer(),
    gear = col_integer(),
    carb = col_integer()
  ))
}

</code></pre>


</div>