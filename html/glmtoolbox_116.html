<div class="container">

<table style="width: 100%;"><tr>
<td>zero.excess</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for zero-excess in Count Regression Models</h2>

<h3>Description</h3>

<p>Allows to assess if the observed number of zeros is significantly higher than expected according to the fitted count regression model (poisson or negative binomial).
</p>


<h3>Usage</h3>

<pre><code class="language-R">zero.excess(
  object,
  alternative = c("excess", "lack", "both"),
  method = c("boot", "naive"),
  rep = 100,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of the class <code>glm</code>, for poisson regression models, or an object of the class <code>overglm</code>, for negative binomial regression models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>an (optional) character string indicating the alternative hypothesis. There are three options: excess of zeros ("excess"), lack of zeros ("lack"), and both ("both"). As a default, <code>type</code> is set to "excess".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>an (optional) character string indicating the method to calculate the mean and variance of the difference between observed and estimated expected number of zeros. There are two options: parametric bootstrapping ("boot") and naive ("naive"). As a default, <code>type</code> is set to "boot".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>an (optional) positive integer which allows to specify the number of replicates which should be used by the parametric bootstrapping. As a default, <code>rep</code> is set to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As a default, <code>verbose</code> is set to TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to the formulated count regression model, we have that <code class="reqn">Y_i\sim P(y;\mu_i,\phi)</code>
for <code class="reqn">i=1,\ldots,n</code> are independent variables. Consequently, the expected number of zeros can
be estimated by <code class="reqn">P(0;\hat{\mu}_i,\hat{\phi})</code> for <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">\hat{\mu}_i</code>
and <code class="reqn">\hat{\phi}</code> represent the estimates of <code class="reqn">\mu_i</code> and <code class="reqn">\phi</code>, respectively, obtained
from the fitted model. Thus, the statistical test can be defined as the standardized difference
between the observed and (estimated) expected number of zeros. The standard normal distribution
tends to be the distribution of that statistic when the sample size, <code class="reqn">n</code>, tends to infinity.
In He, Zhang, Ye, and Tang (2019), the above approach is called a naive test since it ignores the
sampling variation associated with the estimated model parameters. To correct this, parametric
bootstrapping is used to estimate the mean and variance of the difference between the (estimated)
expected and observed number of zeros.
</p>


<h3>Value</h3>

<p>A matrix with 1 row and the following columns:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>Observed</code> </td>
<td style="text-align: left;"> the observed number of zeros,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Expected</code>
</td>
<td style="text-align: left;"> the expected number of zeros,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>z-value</code>
</td>
<td style="text-align: left;"> the value of the statistical test,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>p.value</code>
</td>
<td style="text-align: left;"> the p-value of the statistical test.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>He Hua, Zhang Hui, Ye Peng, Tang Wan (2019) A test of inflated zeros
for Poisson regression models, <em>Statistical Methods in Medical Research</em> 28,
1157-1169.
</p>


<h3>See Also</h3>

<p>overglm, zeroinf
</p>


<h3>Examples</h3>

<pre><code class="language-R">####### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- glm(infections ~ frequency + location, family=poisson, data=swimmers)
zero.excess(fit1,rep=50)
fit2 &lt;- overglm(infections ~ frequency + location, family="nb1", data=swimmers)
zero.excess(fit2,rep=50)

####### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit1 &lt;- glm(art ~ fem + kid5 + ment, family=poisson, data=bioChemists)
zero.excess(fit1,rep=50)
fit2 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1", data=bioChemists)
zero.excess(fit2,rep=50)
####### Example 3: Roots Produced by the Columnar Apple Cultivar Trajan
data(Trajan)
fit1 &lt;- glm(roots ~ photoperiod, family=poisson, data=Trajan)
zero.excess(fit1,rep=50)
fit2 &lt;- overglm(roots ~ photoperiod, family="nbf", data=Trajan)
zero.excess(fit2,rep=50)

</code></pre>


</div>