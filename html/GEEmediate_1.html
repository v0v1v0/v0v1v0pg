<div class="container">

<table style="width: 100%;"><tr>
<td>GEEmediate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mediation Analysis for Generalized Linear Models Using the Difference Method</h2>

<h3>Description</h3>

<p>Estimation of natural direct and indirect effects for generalized linear models. The function utilizes a data-duplication algorithm to fit
marginal and conditional GLMs in a way that allow for consistent variance estimation. The function
produces point estimates, confidence intervals and p-values for the natural indirect effect and the mediation proportion
</p>


<h3>Usage</h3>

<pre><code class="language-R">GEEmediate(
  formula,
  exposure,
  mediator,
  df,
  family = gaussian,
  corstr = "independence",
  conf.level = 0.95,
  surv = F,
  pres = "sep",
  niealternative = "two-sided",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula expression as for
other regression models, of the form response ~ predictors. See the documentation of <code>lm</code> and <code>formula</code> for details.
predictors should include exposure/treatment and mediator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exposure</code></td>
<td>
<p>The exposure (string).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mediator</code></td>
<td>
<p>The mediator (string).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>A name of a data frame where all variables mentioned in formula are stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A <code>family</code> object to be used in gee: a list of functions and expressions for defining link and variance functions
see the gee documentation. Default is gaussian. See also <code>gee</code> and <code>glm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>A working correlation structure. See <code>gee</code> and <code>glm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confidence level for all confidence intervals (default 0.95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv</code></td>
<td>
<p>Is the outcome survival (not supported)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pres</code></td>
<td>
<p>Presentation of the coefficient tables. "tog" for a single table, "sep" for two separated tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niealternative</code></td>
<td>
<p>Alternative hypothesis for testing that the nie=0. Either "two-sided" (default) or
"one-sided" for alternative nie&gt;0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments for the <code>gee</code> call.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GEE.fit</code></td>
<td>
<p>Results of fitting the GEE for the duplicated data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nie</code></td>
<td>
<p>The natural indirect effect estimate. NIE and NDE are reported on the coefficient scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nie.pval</code></td>
<td>
<p>P-value for tesing mediation using the NIE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nde</code></td>
<td>
<p>The natural direct effect estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nie.ci</code></td>
<td>
<p>Confidence interval in for the NIE in confidence level conf.level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pm</code></td>
<td>
<p>The mediation proportion estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pm.pval</code></td>
<td>
<p>P-value for tesing one-sided mediation using the mediation proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pm.ci</code></td>
<td>
<p>Confidence interval for the mediation proportion in confidence level conf.level.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Nevo, Liao and Spiegelman, <em>Estimation and infernece for the mediation proportion</em>, International Journal of Biostatistics (2017+)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
SimNormalData &lt;- function(n,beta1.star = 1, p = 0.3, rho =0.4, inter =  0)
{
 beta2 &lt;- (p/rho)*beta1.star
 beta1 &lt;- (1-p)*beta1.star
 XM &lt;- MASS::mvrnorm(n, mu = c(0,0), Sigma = matrix(c(1,rho,rho,1),2,2))
 X &lt;- XM[,1]
 M &lt;- XM[,2]
 beta &lt;- c(inter, beta1, beta2)
 print(beta)
 Y &lt;- cbind(rep(1,n),XM)%*%beta+rnorm(n,0,sd = 1)
 return(data.frame(X = X, M = M, Y = Y))
}
set.seed(314)
df &lt;- SimNormalData(500)
GEEmediate(Y ~ X + M, exposure = "X", mediator = "M", df = df)

## End(Not run)


</code></pre>


</div>