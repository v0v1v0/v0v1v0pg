<div class="container">

<table style="width: 100%;"><tr>
<td>ordgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GEE for Clustered Ordinal Responses</h2>

<h3>Description</h3>

<p>Produces an object of class ‘geese’ which is a
Generalized Estimating Equation fit of the clustered ordinal
data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ordgee(
  formula = formula(data),
  ooffset = NULL,
  id,
  waves = NULL,
  data = parent.frame,
  subset = NULL,
  na.action = na.omit,
  contrasts = NULL,
  weights = NULL,
  z = NULL,
  mean.link = "logit",
  corstr = "independence",
  control = geese.control(...),
  b = NA,
  alpha = NA,
  scale.fix = TRUE,
  scale.val = 1,
  int.const = TRUE,
  rev = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula expression as for <code>glm</code>, of the form
<code>response ~ predictors</code>. See the documentation of lm and
formula for details. As for glm, this specifies the linear
predictor for modelling the mean. A term of the form
<code>offset(expression)</code> is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ooffset</code></td>
<td>
<p>vector of offset for the odds ratio model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector which identifies the clusters.  The length of
‘id’ should be the same as the number of observations.  Data
are assumed to be sorted so that observations on a cluster are
contiguous rows for all entities in the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waves</code></td>
<td>
<p>an integer vector which identifies components in
clusters. The length of <code>waves</code> should be the same as the
number of observation.  components with the same <code>waves</code>
value will have the same link functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame in which to interpret the
variables occurring in the <code>formula</code>, along with the
<code>id</code> and <code>n</code> variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>expression saying which subset of the rows of the
data should be used in the fit.  This can be a logical vector
(which is replicated to have length equal to the number of
observations), or a numeric vector indicating which observation
numbers are to be included, or a character vector of the row
names to be included.  All observations are included by
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function to filter missing data.  For <code>gee</code>
only <code>na.omit</code> should be used here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>a list giving contrasts for some or all of the
factors appearing in the model formula.  The elements of the
list should have the same name as the variable and should be
either a contrast matrix (specifically, any full-rank matrix
with as many rows as there are levels in the factor), or else a
function to compute such a matrix given the number of levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the
fitting process. The length of <code>weights</code> should be the
same as the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a design matrix for the odds ratio model. The number of
rows of z is </p>
<p style="text-align: center;"><code class="reqn">c^2 \sum n_i(n_i - 1)/2,</code>
</p>
<p> where <code class="reqn">n_i</code> is
the cluster size, and <code class="reqn">c</code> is the number of categories minus
1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.link</code></td>
<td>
<p>a character string specifying the link function
for the means. The following are allowed: <code>"logit"</code>,
<code>"probit"</code>, and <code>"cloglog"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>a character string specifying the log odds. The
following are allowed: <code>"independence"</code>,
<code>"exchangeable"</code>, <code>"unstructured"</code>, and
<code>"userdefined"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of iteration and algorithmic constants. See
<code>geese.control</code> for their names and default
values. These can also be set as arguments to <code>geese</code>
itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>an initial estimate for the mean parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>an initial estimate for the odds ratio parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.fix</code></td>
<td>
<p>a logical variable indicating if scale is fixed;
it is set at TRUE currently (it can not be FALSE yet!).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.val</code></td>
<td>
<p>this argument is ignored currently.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.const</code></td>
<td>
<p>a logical variable; if true, the intercepts are
constant, and if false, the intercepts are different for
different components in the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rev</code></td>
<td>
<p>a logical variable. For example, for a three level
ordered response Y = 2, the accumulated indicator is coded as
(1, 0, 0) if true and (0, 1, 1) if false.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>"geese"</code> representing the fit.
</p>


<h3>Author(s)</h3>

<p>Jun Yan <a href="mailto:jyan.stat@gmail.com">jyan.stat@gmail.com</a>
</p>


<h3>References</h3>

<p>Heagerty, P.J. and Zeger, S.L. (1996) Marginal
regression models for clustered ordinal measurements.
<em>JASA</em>, <b>91</b> 1024–1036.
</p>


<h3>See Also</h3>

<p><code>glm</code>, <code>lm</code>, <code>geese</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(respdis)
resp.l &lt;- reshape(respdis, varying =list(c("y1", "y2", "y3", "y4")),
                  v.names = "resp", direction = "long")
resp.l &lt;- resp.l[order(resp.l$id, resp.l$time),]
fit &lt;- ordgee(ordered(resp) ~ trt, id=id, data=resp.l, int.const=FALSE)
summary(fit)

data(ohio)
ohio$resp &lt;- ordered(as.factor(ohio$resp))
fit &lt;- ordgee(resp ~ age + smoke + age:smoke, id = id, data=ohio)
summary(fit)

</code></pre>


</div>