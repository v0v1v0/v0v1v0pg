<div class="container">

<table style="width: 100%;"><tr>
<td>clyap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Solve continuous-time Lyapunov equations</h2>

<h3>Description</h3>

<p><code>clyap</code> solve the continuous-time Lyapunov equations
</p>
<p style="text-align: center;"><code class="reqn">BX + XB' + C=0</code>
</p>

<p>Using the Bartels-Stewart algorithm with Hessenbergâ€“Schur
decomposition. Optionally the Hessenberg-Schur
decomposition can be returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clyap(B, C, Q = NULL, all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Square matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Square matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Square matrix, the orthogonal matrix used
to transform the original equation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>
<p>logical</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the matrix <code>Q</code> is set then the matrix <code>B</code>
is assumed to be in upper quasi-triangular form
(Hessenberg-Schur canonical form),
as required by LAPACK subroutine <code>DTRSYL</code> and <code>Q</code> is
the orthogonal matrix associated with the Hessenberg-Schur form
of <code>B</code>.
Usually the matrix <code>Q</code> and the appropriate form of <code>B</code>
are obtained by a first call to <code>clyap(B, C, all = TRUE)</code>
</p>
<p><code>clyap</code> uses lapack subroutines:
</p>

<ul>
<li> <p><code>DGEES</code>
</p>
</li>
<li> <p><code>DTRSYL</code>
</p>
</li>
<li> <p><code>DGEMM</code>
</p>
</li>
</ul>
<h3>Value</h3>

<p>The solution matrix <code>X</code> if <code>all = FALSE</code>. If
<code>all = TRUE</code> a list with components <code>X</code>, <code>B</code>
and <code>Q</code>. Where <code>B</code> and <code>Q</code> are the
Hessenberg-Schur form of the original matrix <code>B</code>
and the orthogonal matrix that performed the transformation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">B &lt;- matrix(data = rnorm(9), nrow = 3)
## make B negative diagonally dominant, thus stable:
diag(B) &lt;- - 3 * max(B) 
C &lt;- diag(runif(3))
X &lt;- clyap(B, C)
## check X is a solution:
max(abs(B %*% X + X %*% t(B) + C)) 
</code></pre>


</div>