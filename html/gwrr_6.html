<div class="container">

<table style="width: 100%;"><tr>
<td>gwr.vdp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Collinearity diagnostics for geographically weighted regression
</h2>

<h3>Description</h3>

<p>Uses the collinearity diagnostic tools of variance-decomposition proportions and condition indexes for
geographically weighted regression (GWR) models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gwr.vdp(form, locs, data, phi, kernel = "exp", sel.ci = 30, sel.vdp = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>

<p>A regression model forumula, as in the functions lm and glm
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locs</code></td>
<td>

<p>A matrix of spatial coordinates of data points, where the x coordinate is first, then the y coordinate;
coordinates are assumed to not be latitude and longitude, as Euclidean distance is calculated from coordinates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame with data to fit model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>

<p>The kernel bandwidth used in the GWR model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>

<p>The kernel weighting function used in the GWR model, either exp or gauss; exp is the default
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.ci</code></td>
<td>

<p>The threshold value to use for the condition index to indicate observations with a collinearity issue;
indexes above this value will be flagged; the default is 30
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.vdp</code></td>
<td>

<p>The threshold value to use for the variance-decomposition proportion to indicate observations with a collinearity issue;
proportions above this value will be flagged; the default is 0.5
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the variance-decomposition proportions and the condition indexes for the 
weighted design matrix used in a GWR model. The kernel function and bandwidth used to estimate the 
GWR model must be input to this function. Observations with a large condition index and relatively
large variance-decomposition proportions for more than one regression term indicate an issue with 
collinearity.
</p>


<h3>Value</h3>

<p>A list with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>condition </code></td>
<td>
<p>Largest condition index for each observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vdp </code></td>
<td>
<p>Variance-decomposition proportions for the largest variance component for each observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag.cond </code></td>
<td>
<p>True if largest condition index exceeds threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag.vdp </code></td>
<td>
<p>True if variance-decomposition proportions for more than one term exceed threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag.cond.vdp </code></td>
<td>
<p>True if condition index and variance-decompostion proportions exceed thresholds</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Wheeler
</p>


<h3>References</h3>

<p>Wheeler DC (2007) Diagnostic tools and a remedial method for collinearity in geographically weighted regression.
Environment and Planning A, 39: 2464-2481 
</p>


<h3>See Also</h3>

<p><code>gwr.bw.est</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(columbus)
locs &lt;- cbind(columbus$x, columbus$y)
col.bw &lt;- gwr.bw.est(crime ~ income + houseval, locs, columbus, "exp")
col.vdp &lt;- gwr.vdp(crime ~ income + houseval, locs, columbus, col.bw$phi, "exp")
hist(col.vdp$condition)
</code></pre>


</div>