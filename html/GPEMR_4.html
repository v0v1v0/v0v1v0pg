<div class="container">

<table style="width: 100%;"><tr>
<td>simulated_function</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate and Estimate Parameters of Growth Models</h2>

<h3>Description</h3>

<p>This function simulates data for independent trajectories based on specified growth models and estimates the model parameters.
The simulation can be performed for several models, including Logistic, Exponential, Theta-logistic, Von Bertalanffy, and Gompertz.
It also allows for calculation of global and local parameter estimates using the negative log-likelihood function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulated_function(
  time_points = 1:10,
  n = 10,
  window_size = 3,
  model,
  parameter,
  sigma2 = 2,
  rho = 0.5,
  x_0 = 10,
  cov = FALSE,
  Plot_est = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time_points</code></td>
<td>
<p>A numeric vector representing the time points for which the data should be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer specifying the number of independent trajectories to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_size</code></td>
<td>
<p>An integer specifying the window size for local estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A character string specifying the growth model to use. Options include 'Logistic', 'Exponential', 'Theta-logistic', 'Von-bertalanffy', and 'Gompertz'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>A list of model-specific parameters required for the mean function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>A numeric value for the variance of the process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A numeric value for the correlation coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_0</code></td>
<td>
<p>A numeric value for the initial state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>A logical value indicating whether to print the covariance matrix. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Plot_est</code></td>
<td>
<p>A logical value indicating whether to plot the parameter estimates. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function first checks if the parameters are provided as a list. It then calculates the mean function based on the specified model and forms the covariance matrix. Multivariate normal data for the specified number of trajectories is generated using the mvtnorm::rmvnorm function. The negative log-likelihood function is defined and minimized using the optim function to estimate global parameters. Local parameter estimation is performed using a sliding window approach.
</p>
<p>The available models are:
</p>

<ul>
<li>
<p> Logistic: Requires parameters r (growth rate) and K (carrying capacity).
</p>
</li>
<li>
<p> Exponential: Requires parameter r (growth rate).
</p>
</li>
<li>
<p> Theta-logistic: Requires parameters r (growth rate), theta, and K (carrying capacity).
</p>
</li>
<li>
<p> Von-bertalanffy: Requires parameters r (growth rate) and K (asymptotic size).
</p>
</li>
<li>
<p> Gompertz: Requires parameters b and c.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list containing the simulated data, global parameter estimates, global covariance matrix, local parameter estimates, and optionally local covariance matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R">res &lt;- simulated_function(
 model = 'Logistic',
 parameter = list(r = 0.2, K = 100),
 cov = TRUE,
 Plot_est = TRUE)

</code></pre>


</div>