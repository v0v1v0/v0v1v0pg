<div class="container">

<table style="width: 100%;"><tr>
<td>cr_build_yaml_secrets</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an availableSecrets entry for build yaml</h2>

<h3>Description</h3>

<p>This creates the availabelSecrets entry for Builds so they can use Secret Manager environment arguments in the builds.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cr_build_yaml_secrets(
  secretEnv,
  secret,
  version = "latest",
  projectId = cr_project_get()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>secretEnv</code></td>
<td>
<p>The name of the secretEnv that will be referred to in the build steps e.g. <code>'GH_TOKEN'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>secret</code></td>
<td>
<p>The secret data name in Secret Manager</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>The version of the secret</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projectId</code></td>
<td>
<p>The project to get the Secret from</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>To download from Secret Manager to a file in a dedicated buildstep see cr_buildstep_secret.
</p>
<p><a href="https://cloud.google.com/build/docs/securing-builds/use-secrets">Using secrets from Secret Manager</a>
</p>
<p>Other Cloud Build functions: 
<code>Build()</code>,
<code>RepoSource()</code>,
<code>Source()</code>,
<code>StorageSource()</code>,
<code>cr_build_artifacts()</code>,
<code>cr_build_list()</code>,
<code>cr_build_logs()</code>,
<code>cr_build_make()</code>,
<code>cr_build_status()</code>,
<code>cr_build_targets()</code>,
<code>cr_build_upload_gcs()</code>,
<code>cr_build_wait()</code>,
<code>cr_build_write()</code>,
<code>cr_build_yaml_artifact()</code>,
<code>cr_build_yaml()</code>,
<code>cr_build()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
cr_build_yaml_secrets("GH_TOKEN", "github_token")

s1 &lt;- cr_build_yaml_secrets("USERNAME", "my_username")
s2 &lt;- cr_build_yaml_secrets("PASSWORD", "my_password")

# use one $ in scripts to use the secretEnv (will be replaced by $$)
cr_build_yaml(
  steps = cr_buildstep(
    "docker",
    entrypoint = "bash",
    args = c(
      "-c",
      "docker login --username=$USERNAME --password=$PASSWORD"
    ),
    secretEnv = c("USERNAME", "PASSWORD")
  ),
  availableSecrets = list(s1, s2)
)
</code></pre>


</div>