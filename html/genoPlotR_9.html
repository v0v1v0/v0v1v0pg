<div class="container">

<table style="width: 100%;"><tr>
<td>auto_annotate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Auto-annotate dna_segs
</h2>

<h3>Description</h3>

<p>Annotate dna_segs in a smart way. This is especially designed for
<code>dna_seg</code>s read from genbank or embl files, but can be extended for
other uses. In short, it produces annotations from <code>dna_seg</code>s, grouping
the tags for operons (atpA, atpB, atC) into one tag (atpA-C), and
similarly for numbered genes (bep1-9).
</p>


<h3>Usage</h3>

<pre><code class="language-R">auto_annotate(dna_seg, locus_tag_pattern=NULL, names=dna_seg$gene,
              keep_genes_only=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dna_seg</code></td>
<td>

<p>A <code>dna_seg</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locus_tag_pattern</code></td>
<td>

<p><code>NULL</code> by default. A character giving a pattern, that is used
to simplify names. Specially useful to transform long locus tags
into numbers (e.g. Eco003456 becomes 3456).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>

<p>A character vector with as many elements as there are rows in the
<code>dna_seg</code>. By default, the <code>gene</code> column of the
<code>dna_seg</code> is taken. Gives the names to be summarized.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_genes_only</code></td>
<td>

<p>A logical, <code>TRUE</code> by default. If set, the genes that have a
name that is "-" or empty are not annotated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed to <code>annotation</code> function, like
<code>rot</code> or <code>color</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>annotation</code> object.
</p>


<h3>Author(s)</h3>

<p>Lionel Guy
</p>


<h3>See Also</h3>

<p><code>annotation</code>, <code>dna_seg</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Prepare dna_seg
names &lt;- paste("Eco", sprintf("%04d", 1:20), sep="")
gene &lt;- c("-", "atpC", "atpB", "atpA", "atp2", 
          "-", "-", "cda1", "cda2", "cda3",
          "vcx23", "vcx22", "vcx21", "cde20",
          "-", "gfrU", "gfrT", "gfrY", "gfrX", "gfrW")
ds &lt;- dna_seg(data.frame(name=names, start=(1:20)*3, end=(1:20)*3+2,
                         strand=rep(1, 20), gene=gene,
                         stringsAsFactors=FALSE))
## Original annotation
annot1 &lt;- annotation(x1=middle(ds), text=ds$gene, rot=30)
## auto_annotate with various options
annot2 &lt;- auto_annotate(ds)
annot3 &lt;- auto_annotate(ds, keep_genes_only=FALSE, rot=45)
annot4 &lt;- auto_annotate(ds, keep_genes_only=FALSE,
                        locus_tag_pattern="Eco", col="red")
## Plot
plot_gene_map(list(ds, ds, ds, ds),
              annotations=list(annot1, annot2, annot3, annot4))

</code></pre>


</div>