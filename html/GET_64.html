<div class="container">

<table style="width: 100%;"><tr>
<td>rank_envelope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The rank envelope test</h2>

<h3>Description</h3>

<p>The rank envelope test, p-values and global envelopes.
The test corresponds to the global envelope test that can be carriet out by
<code>global_envelope_test</code> by specifying the <code>type</code> for which the options
<code>"rank"</code>, <code>"erl"</code>, <code>"cont"</code> and <code>"area"</code> are available. The last
three are modifications of the first one to treat the ties in the extreme rank ordering
used in <code>"rank"</code>. This function is kept for historical reasons.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rank_envelope(curve_set, type = "rank", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>curve_set</code></td>
<td>
<p>A <code>curve_set</code> object, or an <code>envelope</code> object of
<span class="pkg">spatstat</span>. If an envelope object is given, it must contain the summary
functions from the simulated patterns which can be achieved by setting
savefuns = TRUE when calling the function of <span class="pkg">spatstat</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of the global envelope with current options for "rank", "erl", "cont" and "area".
If "rank", the global rank envelope accompanied by the p-interval is given (Myllymäki et al., 2017).
If "erl", the global rank envelope based on extreme rank lengths accompanied by the extreme rank
length p-value is given (Myllymäki et al., 2017, Mrkvička et al., 2018). See details and additional
sections thereafter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>global_envelope_test</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>"rank"</code> envelope test is a completely non-parametric test, which provides
the 100(1-alpha)% global envelope for the chosen test function T(r) on
the chosen interval of distances and associated p-values.
The other three types are solutions to break the ties in the extreme ranks
on which the <code>"rank"</code> envelope test is based on.
</p>
<p>Note: The method to break ties for the global <code>type = "rank"</code> envelope
(Myllymäki et al., 2017) can be done by the argument <code>ties</code> with default
to <code>ties = "erl"</code> corresponding to the extreme rank length breaking of ties.
In this case the global envelope corresponds to the extreme rank measure.
If instead choosing <code>type</code> to be <code>"erl"</code>, <code>"cont"</code> or <code>"area"</code>,
then the global envelope corresponds to these measures.
</p>


<h3>Value</h3>

<p>An object of class <code>global_envelope</code> of <code>combined_global_envelope</code>
which can be printed and plotted directly. See <code>global_envelope_test</code> for more details.
</p>


<h3>Number of simulations</h3>

<p>The global <code>"erl"</code>, <code>"cont"</code>, <code>"area"</code> envelope tests allow 
in principle a lower number of simulations to be used than the global <code>"rank"</code> test
based on extreme ranks.
However, if feasible, we recommend some thousands of simulations in any case to achieve
a good power and repeatability of the test.
For the global <code>"rank"</code> envelope test, Myllymäki et al. (2017) recommended to use
at least 2500 simulations for testing at the significance level alpha = 0.05 for single
function tests, experimented with summary functions for point processes.
</p>


<h3>References</h3>

<p>Myllymäki, M., Mrkvička, T., Grabarnik, P., Seijo, H. and Hahn, U. (2017). Global envelope tests for spatial point patterns. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 79: 381–404. doi: 10.1111/rssb.12172
</p>
<p>Mrkvička, T., Myllymäki, M. and Hahn, U. (2017). Multiple Monte Carlo testing, with applications in spatial point processes. Statistics &amp; Computing 27 (5): 1239-1255. doi: 10.1007/s11222-016-9683-9
</p>
<p>Mrkvička, T., Myllymäki, M., Jilek, M. and Hahn, U. (2020) A one-way ANOVA test for functional data with graphical interpretation. Kybernetika 56 (3), 432-458. doi: 10.14736/kyb-2020-3-0432
</p>


<h3>See Also</h3>

<p><code>global_envelope_test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See ?global_envelope_test for more examples

## Testing complete spatial randomness (CSR)
#-------------------------------------------
if(require("spatstat.explore", quietly=TRUE)) {
  X &lt;- unmark(spruces)
  nsim &lt;- 2499 # Number of simulations
  
  # Generate nsim simulations under CSR, calculate centred L-function for the data and simulations
  env &lt;- envelope(X, fun="Lest", nsim=nsim, savefuns=TRUE,
                  correction="translate", transform=expression(.-r),
                  simulate=expression(runifpoint(ex=X)))
  # The rank envelope test
  res &lt;- rank_envelope(env)
  # Plot the result.
  plot(res)

  ## Advanced use:
  # Choose the interval of distances [r_min, r_max] (at the same time create a curve_set from 'env')
  curve_set &lt;- crop_curves(env, r_min=1, r_max=7)
  # Do the rank envelope test
  res &lt;- rank_envelope(curve_set); plot(res)
}
</code></pre>


</div>