<div class="container">

<table style="width: 100%;"><tr>
<td>choose_optimal_reference</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select the optimal reference for full alignments of peak lists</h2>

<h3>Description</h3>

<p>Full alignments of peak lists require the specification of a fixed reference to which all other samples are aligned to. This function provides an simple algorithm to find the most suitable sample among a dataset. The so defined reference can be used for full alignments using <code>linear_transformation</code>. The functions is evoked internally by <code>align_chromatograms</code> if no reference was specified by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">choose_optimal_reference(data = NULL, rt_col_name = NULL, sep = "\t")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataset containing peaks that need to be aligned and matched. For every peak a arbitrary number of numerical variables can be included (e.g. peak height, peak area) in addition to the mandatory retention time. The standard format is a tab-delimited text file according to the following layout: (1) The first row contains sample names, the (2) second row column names of the corresponding peak lists. Starting with the third row, peak lists are included for every sample that needs to be incorporated in the dataset. Here, a peak list contains data for individual peaks in rows, whereas columns specify variables in the order given in the second row of the text file. Peak lists of individual samples are concatenated horizontally and need to be of the same width (i.e. the same number of columns in consistent order). Alternatively, the input may be a list of data frames. Each data frame contains the peak data for a single individual. Variables (i.e.columns) are named consistently across data frames. The names of elements in the list are used as sample identifiers. Cells may be filled with numeric or integer values but no factors or characters are allowed. NA and 0 may be used to indicate empty rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rt_col_name</code></td>
<td>
<p>A character giving the name of the column containing the retention times. The decimal separator needs to be a point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>The field separator character. The default is tab separated (<code>sep = '\t'</code>).
See the "sep" argument in <code>read.table</code> for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Every sample is considered in determining the optimal reference in comparison to all other samples by estimating the similarity to all other samples. For a reference-sample pair, the deviation in retention times between all reference peaks and the always nearest peak in the sample is summed up and divided by the number of reference peaks. The calculated value is a similarity score that converges to zero the more similar reference and sample are. For every potential reference, the median score of all pair-wise comparisons is used as a similarity proxy. The optimal sample is then defined by the minimum value among these scores. This functions is used internally in <code>align_chromatograms</code> to select a reference if non was specified by the user.
</p>


<h3>Value</h3>

<p>A list with following elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>Name of the sample with the highest average similarity to all other samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>Median number of shared peaks with other samples</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Martin Stoffel (martin.adam.stoffel@gmail.com) &amp; Meinolf Ottensmann (meinolf.ottensmann@web.de)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1.) input is a list
## using a list of samples
data("peak_data")
## subset for faster processing
peak_data &lt;- peak_data[1:3]
choose_optimal_reference(peak_data, rt_col_name = "time")

</code></pre>


</div>