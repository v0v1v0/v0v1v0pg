<div class="container">

<table style="width: 100%;"><tr>
<td>significantTau</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute (Pre-Whitened) Kendall's <code class="reqn">\tau</code>
</h2>

<h3>Description</h3>

<p>Apply the Mann-Kendall trend test (Mann, 1945) to a series of observations
and return Kendall's <code class="reqn">\tau</code> (Kendall, 1938) based on a predefined
significance level. In contrast to other readily available implementations,
it is up to the user to decide whether or not to apply pre-whitening as
described in the <strong>zyp</strong> package vignette (Bronaugh and Werner, 2013).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'numeric'
significantTau(
  x,
  p = 0.001,
  prewhitening = TRUE,
  method = c("yuepilon", "zhang"),
  df = FALSE
)

## S4 method for signature 'RasterStackBrick'
significantTau(
  x,
  p = 0.001,
  prewhitening = TRUE,
  method = c("yuepilon", "zhang"),
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Either a <code>Raster*</code> object or a <code>numeric</code> vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p><code>numeric</code>, defaults to <code>0.001</code>. Significance level to be
tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prewhitening</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> (default), pre-whitening
is applied prior to the Mann-Kendall trend test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>character</code>. The prewhitening method to apply, see
<code>zyp.trend.vector</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p><code>logical</code>, defaults to <code>FALSE</code>. If <code>TRUE</code>, a
<code>data.frame</code> holding the value of Kendall's <code class="reqn">\tau</code> and the referring
significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p><code>character</code>. Optional output filename.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>writeRaster</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If available, the function will automatically use open multi-core clusters
for parallel processing (see <code>beginCluster</code> and Examples).
</p>


<h3>Value</h3>


<ul>
<li>
<p><code>numeric</code> input: If <code>df = FALSE</code> (default), a single
<code>numeric</code> or <code>logical</code> (i.e., <code>NA</code>) depending on whether or
not 'p' was exceeded; else a <code>data.frame</code> with Kendall's <code class="reqn">\tau</code> and
the corresponding significance level.
</p>
</li>
<li>
<p><code>RasterStackBrick</code> input: A <code>RasterLayer</code> with values of
Kendall's <code class="reqn">\tau</code>. Values exceeding the specified 'p' are discarded.
</p>
</li>
</ul>
<h3>References</h3>

<p>Kendall, M.G. (1938). A new measure of rank correlation. <em>Biometrika</em>
30(1/2), 81-93, doi: 10.2307/2332226.
</p>
<p>Mann, H.B. (1945). Nonparametric tests against trend. <em>Econometrica</em>
13(3), 245-259, doi: 10.2307/1907187.
</p>
<p>Zhang, X., Vincent, L.A., Hogg, W.D. and A. Niitsoo (2000). Temperature and
Precipitation Trends in Canada during the 20th Century. <em>Atmosphere-Ocean</em>
38(3), 395-429, <a href="https://doi.org/10.1080/07055900.2000.9649654">doi:10.1080/07055900.2000.9649654</a>.
</p>
<p>Yue, S., Pilon, P., Phinney, B. and G. Cavadias (2002). The influence of
autocorrelation on the ability to detect trend in hydrological series.
<em>Hydrological Processes</em> 16, 1807-1829,<a href="https://doi.org/10.1002/hyp.1095">doi:10.1002/hyp.1095</a>.
</p>


<h3>See Also</h3>

<p><code>MannKendall</code>, <code>zyp.trend.vector</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example taken from ?Kendall::MannKendall
library(Kendall)
data(PrecipGL)
plot(PrecipGL)

## Mann-Kendall trend test without pre-whitening
x &lt;- as.numeric(PrecipGL)
significantTau(x, p = 0.001, prewhitening = FALSE, df = TRUE)

## Mann-Kendall trend test with pre-whitening
significantTau(x, p = 0.001, prewhitening = TRUE, df = TRUE)

#############################################################################
### use case: significant mann-kendall trends in ndvi3g.v0          #########
#############################################################################

## Not run: 
## Sample data from 1982 to 2013
data("kili3g.v0")
rst &lt;- kili3g.v0[[13:nlayers(kili3g.v0)]]

## Remove seasonal signal
library(remote)
dsn &lt;- deseason(rst, cycle.window = 24)

## Apply trend-free pre-whitened Mann-Kendall test (note that
## non-significant pixels are set to NA)
trd1 &lt;- significantTau(dsn, p = 0.01, prewhitening = TRUE)
plot(trd1)

## Or, alternatively, use multi-core functionality
cores &lt;- parallel::detectCores() - 1
if (require(snow)) {
  beginCluster(cores)
  trd2 &lt;- significantTau(dsn, p = 0.01, prewhitening = TRUE)
  endCluster()
}

## End(Not run)

</code></pre>


</div>