<div class="container">

<table style="width: 100%;"><tr>
<td>sim.data.ts.single</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Generate single-level simulation data
</h2>

<h3>Description</h3>

<p> This function generates a single-level dataset with given parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.data.ts.single(n, Z, A, B, C, Sigma, W, Delta = NULL, p = NULL, nburn = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> an integer indicating the length of the time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p> a vector of treatment/exposure assignment at each time point.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p> a numeric value of model coefficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p> a numeric value of model coefficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p> a numeric value of model coefficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p> a 2 by 2 matrix, is the covariance matrix of the two Gaussian white noise processes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p> a <code class="reqn">2p</code> by 2 matrix, is the transition matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p> a 2 by 2 matrix, is the covariance matrix of the initial condition. Default is <code>NULL</code>, will be the same as <code>Sigma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> a numeric value indicating the order of the vector autoregressive (VAR) model. Default is <code>NULL</code>, will be calculated based on <code>W</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p> a integer indicating the number of burning sample. Default is 100.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The single level GMA model is
</p>
<p style="text-align: center;"><code class="reqn">M_{t}=Z_{t}A+E_{1t},</code>
</p>

<p style="text-align: center;"><code class="reqn">R_{t}=Z_{t}C+M_{t}B+E_{2t},</code>
</p>

<p>and for stochastic processes <code class="reqn">(E_{1t},E_{2t})</code>,
</p>
<p style="text-align: center;"><code class="reqn">E_{1t}=\sum_{j=1}^{p}\omega_{11_{j}}E_{1,t-j}+\sum_{j=1}^{p}\omega_{21_{j}}E_{2,t-j}+\epsilon_{1t},</code>
</p>

<p style="text-align: center;"><code class="reqn">E_{2t}=\sum_{j=1}^{p}\omega_{12_{j}}E_{1,t-j}+\sum_{j=1}^{p}\omega_{22_{j}}E_{2,t-j}+\epsilon_{2t}.</code>
</p>

<p><code>Sigma</code> is the covariance matrix of the Gaussian white noise <code class="reqn">(\epsilon_{1t},\epsilon_{2t})</code>, and <code>Delta</code> is the covariance matrix of <code class="reqn">(\epsilon_{10},\epsilon_{20})</code>. <code>W</code> is the transition matrix with element <code class="reqn">\omega</code>'s.
</p>


<h3>Value</h3>

<p> The function returns a list with two data frames. One is the data with variables <code>Z</code>, <code>M</code> and <code>R</code>; one is the data frame of <code class="reqn">(E_{1t},E_{2t})</code>.
</p>


<h3>Author(s)</h3>

<p> Yi Zhao, Brown University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
Xi Luo, Brown University, <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao, Y., &amp; Luo, X. (2017). <em>Granger Mediation Analysis of Multiple Time Series with an Application to fMRI.</em> arXiv preprint arXiv:1709.05328.
</p>


<h3>Examples</h3>

<pre><code class="language-R">###################################################
# Generate a single-level dataset

# covariance matrix of errors
delta&lt;-0.5
Sigma&lt;-matrix(c(1,2*delta,2*delta,4),2,2)

# model coefficients
A0&lt;-0.5
B0&lt;--1
C0&lt;-0.5

# number of time points
n&lt;-500

# generate a treatment assignment vector
set.seed(1000)
Z&lt;-matrix(rbinom(n,size=1,prob=0.5),n,1)

# VAR(1) model
p&lt;-1

# Delta and W matrices
Delta&lt;-matrix(c(2,delta*sqrt(2*8),delta*sqrt(2*8),8),2,2)
W&lt;-matrix(c(-0.809,0.154,-0.618,-0.5),2,2)

# number of burning samples
nburn&lt;-1000

set.seed(1000)
data.single&lt;-sim.data.ts.single(n,Z,A0,B0,C0,Sigma,W,Delta,p=p,nburn=nburn)
###################################################
</code></pre>


</div>