<div class="container">

<table style="width: 100%;"><tr>
<td>plot_maturity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot maturity ogive</h2>

<h3>Description</h3>

<p>Plots an estimate of length or age at 50% mature for a dataset
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_maturity(
  dt,
  length = "length",
  maturity = "maturity",
  sex = "sex",
  split.by.sex = FALSE,
  female.sex = "F",
  male.sex = "M",
  length.unit = "cm",
  length.bin.width = 2,
  bootstrap.n = NA,
  force.zero.group.length = NA,
  force.zero.group.strength = NA,
  force.zero.group.n = NA,
  force.zero.group.cv = 0,
  xlab = "Total length",
  base_size = 8,
  legend.position = "bottom",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>A data.frame, tibble or data.table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>Character argument giving the name of the length (or age) column in <code>dt</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maturity</code></td>
<td>
<p>Character argument giving the name of the maturity column in <code>dt</code>. Should be either logical (<code>TRUE == mature, FALSE == immature</code>) or integer (<code>1 == mature, 0 == immature</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sex</code></td>
<td>
<p>Character argument giving the name of the sex column in <code>dt</code>. Ignored if <code>split.by.sex == FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.by.sex</code></td>
<td>
<p>Logical indicating whether the result should be split by sex.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>female.sex, male.sex</code></td>
<td>
<p>A character or integer denoting female and male sex in the <code>sex</code> column of <code>dt</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.unit</code></td>
<td>
<p>A character argument giving the unit of <code>length</code>. Will be used in the labels of the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length.bin.width</code></td>
<td>
<p>Numeric specifying the increment (delta length) by which length data should be binned to calculate maturity proportions. Use <code>NULL</code> to remove from the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap.n</code></td>
<td>
<p>Integer defining the number of bootstrap replicates to be used to calculate 95% confidence intervals for the mean 50% mature estimate. If <code>NA</code> (default), the confidence intervals are calculated from the glm object without boostrapping. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.zero.group.length</code></td>
<td>
<p>Numeric indicating the length to which 0-group (all immatures) should be forced. Use <code>NA</code> ignore the forcing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.zero.group.strength</code></td>
<td>
<p>Numeric indicating how many percent of total fish should be added to the specified <code>force.zero.group.length</code>. Cannot be used simultaneously with <code>force.zero.group.n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.zero.group.n</code></td>
<td>
<p>Numeric indicating how many observations should be added to the specified <code>force.zero.group.length</code>. If <code>split.by.sex = TRUE</code>, use a named vector of length two with names referring to <code>female.sex</code> and <code>male.sex</code>. Cannot be used simultaneously with <code>force.zero.group.strength</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.zero.group.cv</code></td>
<td>
<p>Numeric indicating the coefficient of variation for the forced 0-group (all immature) length. Resulting lengths will be randomly generated from a normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Character giving the x-axis label without unit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_size</code></td>
<td>
<p>Base size parameter for ggplot. See ggtheme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>Position of the ggplot legend as a character. See ggtheme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to geom_density_ridges.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The 95% confidence intervals for the mean 50% mature estimate are calculated using the glm function by default. This routine might not be optimal when zero group fish are added. Hence, the function contains an option to bootstrap confidence intervals using <em>the same number of data than observations</em> (i.e. excluding the added data from the number of randomly resampled rows). Adding an integer to the <code>bootstrap.n</code> argument turns on this feature. Note that the confidence intervals calculated this way tend to be narrower than the <code>glm()</code> confidence intervals.
</p>


<h3>Value</h3>

<p>Returns a ggplot2 or tibble depending on the <code>plot</code> argument showing the maturity ogives.
</p>


<h3>Author(s)</h3>

<p>Mikko Vihtakari // Institute of Marine Research.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simple L50 plot
data(survey_ghl)
plot_maturity(survey_ghl, length = "length", maturity = "maturity")

# Bootstrapped CIs are narrower than the glm ones
plot_maturity(survey_ghl, bootstrap.n = 10)

# A50 plot, split by sex
plot_maturity(survey_ghl, length = "age", length.unit = "years",
xlab = "Age", length.bin.width = 1, split.by.sex = TRUE)$plot

# Add juveniles
plot_maturity(survey_ghl, length = "age", length.unit = "years",
xlab = "Age", length.bin.width = 1, split.by.sex = TRUE,
force.zero.group.length = 0,
force.zero.group.strength = 100)$plot

</code></pre>


</div>