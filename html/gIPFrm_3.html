<div class="container">

<table style="width: 100%;"><tr>
<td>g.ipf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generalized Iterative Proportional Fitting for Relational Models
</h2>

<h3>Description</h3>

<p><code>g.ipf</code> computes the maximum likelihood estimates of the cell frequencies and of the model 
parameters under a relational model specified by a model matrix.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">g.ipf(ModelMatrix, ObsTable, tol, estimand, adjustment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ModelMatrix </code></td>
<td>
<p>an <code>I</code> by <code>J</code> model matrix of a relational model. Here
<code>I</code> is the number of observations and <code>J</code> is the number of generating subsets.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ObsTable </code></td>
<td>
<p>a vector of observed cell frequencies of length <code>I</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol </code></td>
<td>
<p>tolerance used in stopping criteria.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimand </code></td>
<td>
<p>set to <code>"probabilities"</code> in the case of multinomial 
sampling; set to <code>"intensities"</code> in the case of Poisson sampling.   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustment </code></td>
<td>
<p>set to <code>"grid"</code> if a grid is 
used to update the adjustment factor; set to <code>"bisection"</code> if the bisection method is used to update the 
adjustment factor; 
set to <code>"none"</code> if <code>estimand</code> is <code>"intensities"</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model.matrix </code></td>
<td>
<p>the model matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed.data </code></td>
<td>
<p>the vector of observed cell frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values </code></td>
<td>
<p>the maximum likelihood estimates of the cell frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimated.total </code></td>
<td>
<p>the sum of the estimated cell frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustment.for.total </code></td>
<td>
<p>the estimated total divided by the observed total.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustment.for.subsets </code></td>
<td>
<p>the adjustment factor for the subset sums.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.parameters </code></td>
<td>
<p>the maximum likelihood estimates for model parameters on the multiplicative scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degrees.of.freedom </code></td>
<td>
<p>the degrees of freedom of the relational model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq.statistic </code></td>
<td>
<p>Pearson's chi-squared statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.chisq </code></td>
<td>
<p>the p-value, based on Pearson's chi-squared statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.likelihood.ratio.statistic </code></td>
<td>
<p>the log likelihood ratio statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.log.likelihood.ratio.statistic </code></td>
<td>
<p>the p-value, based on the log likelihood ratio statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bregman.statistic </code></td>
<td>
<p>the Bregman statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.Bregman.statistic </code></td>
<td>
<p>the p-value, based on the Bregman statistic.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Anna Klimova, Tamas Rudas</p>


<h3>References</h3>

<p>A.Klimova, T.Rudas, A.Dobra,
Relational models for contingency tables. 
J. Multivariate Anal., 2012, 104, 159–173. 
</p>
<p>A.Klimova, T.Rudas, 
Iterative proportional scaling for curved exponential families. 
Scand. J. Statist., 2015, 42, 832–847. 
</p>
<p>A. Klimova, Coordinate-Free Exponential Families on Contingency Tables. PhD thesis. Advisers: Tamas Rudas and Thomas Richardson.
</p>
<p>A.Agresti, Categorical Data Analysis. Wiley, New York, 1990.
</p>
<p>J.Aitchison, S.D.Silvey, Maximum-likelihood estimation procedures and associated tests of significance.
J. Roy. Statist. Soc. Ser.B, 1960, 22, 154–171.
</p>
<p>G.Kawamura, T.Matsuoka, T.Tajiri, M.Nishida, M.Hayashi,
Effectiveness of a sugarcane-fish combination as bait in trapping swimming crabs.
Fisheries Research, 1995, 22, 155–160.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Multiplicative model from Aitchison and Silvey (1960)

A = matrix(c(1, 0, 0, 1, 0, 1, 1, 
             0, 1, 0, 1, 1, 0, 1,
             0, 0, 1, 0, 1, 1, 1), byrow=TRUE, nrow=3) ## the model matrix 

y = c(46,24,7,15,3,4,1) ## the observed data

g.ipf(A, y, 1e-6, "probabilities", "bisection")
g.ipf(A, y, 1e-4, "probabilities", "grid")



### Bait study in swimming crabs, see Kawamura at al. (1995) :  

A = matrix(c(1,1,0,1,0,1), 2,3,byrow=TRUE) ## the model matrix

y1 = c(36,2,11)  ## the observed data for Charybdis japonica
y2 = c(71,3,44)  ## the observed data for Portunuspelagicus 

## If the model is for intensities, the adjustemnt factor is equal to one;
## the adjustment parameter is redundant.

g.ipf(A, y1, 1e-6, "intensities", "none")
g.ipf(A, y2, 1e-6, "intensities", "none")



</code></pre>


</div>