<div class="container">

<table style="width: 100%;"><tr>
<td>phenoregressor.BGLR.multikinships</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-matrix GBLUP using BGLR</h2>

<h3>Description</h3>

<p>This regressor implements Genomic BLUP using Bayesian methods from BGLR package,
but allows to use more than one covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phenoregressor.BGLR.multikinships(
  phenotypes,
  genotypes = NULL,
  covariances,
  extraCovariates,
  type = "RKHS",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phenotypes</code></td>
<td>
<p>phenotypes, a numeric array (n x 1), missing values are predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>added for compatibility with the other GROAN regressors, must be NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariances</code></td>
<td>
<p>square matrix (n x n) of covariances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraCovariates</code></td>
<td>
<p>the extra covariance matrices to be added in the GBLUP model,
collated in a single matrix-like structure, with optionally first column
as an ignored intercept (supported for compatibility). See details, below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character literal, one of the following: FIXED (Flat prior), BRR (Gaussian prior),
BL (Double-Exponential prior), BayesA (scaled-t prior),
BayesB (two component mixture prior with a point of mass at zero and a scaled-t slab),
BayesC (two component mixture prior with a point of mass at zero and a Gaussian slab),
RKHS (Gaussian processes, default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra parameters are passed to <code>BGLR</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In its simplest form, GBLUP is defined as:
</p>
<p style="text-align: center;"><code class="reqn">y = 1\mu + Z u + e</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">var(y) =  K \sigma_u^2 + I\sigma_e^2</code>
</p>

<p>Where <code class="reqn">\mu</code> is the overall mean, <code class="reqn">K</code> is the incidence matrix
relating individual weights <code class="reqn">u</code> to <code class="reqn">y</code>, and <code class="reqn">e</code> is a
vector of residuals with zero mean and covariance matrix <code class="reqn">I\sigma_e^2</code>
</p>
<p>It is possible to extend the above model to include different types of
kinship matrices, each capturing different links between genotypes and phenotypes:
</p>
<p style="text-align: center;"><code class="reqn">y = 1\mu + Z1 u1 + Z2 u2 + \dots + e</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">var(y) =  K1 \sigma_u1^2 + K2 \sigma_u2^2 + \dots + I\sigma_e^2</code>
</p>

<p>This function receives the first kinship matrix <code class="reqn">K1</code> via the <code>covariances</code>
argument and an arbitrary number of extra matrices via the <code>extraCovariates</code>
built as follow:
</p>
<pre>#given the following defined variables
y = &lt;some values, Nx1 array&gt;
K1 = &lt;NxN kinship matrix&gt;
K2 = &lt;another NxN kinship matrix&gt;
K3 = &lt;a third NxN kinship matrix&gt;

#invoking the multi kinship GBLUP
y_hat = phenoregressor.BGLR.multikinships(
  phenotypes = y,
  covariances = K1,
  extraCovariates = cbind(K2, K3)
)
</pre>


<h3>Value</h3>

<p>The function returns a list with the following fields:
</p>

<ul>
<li> <p><code>predictions</code> : an array of (n) predicted phenotypes, with NAs filled and all other positions repredicted (useful for calculating residuals)
</p>
</li>
<li> <p><code>hyperparams</code> : empty, returned for compatibility
</p>
</li>
<li> <p><code>extradata</code>   : list with information on trained model, coming from <code>BGLR</code>
</p>
</li>
</ul>
<h3>See Also</h3>

<p>BGLR
</p>
<p>Other phenoRegressors: 
<code>phenoRegressor.BGLR()</code>,
<code>phenoRegressor.RFR()</code>,
<code>phenoRegressor.SVR()</code>,
<code>phenoRegressor.dummy()</code>,
<code>phenoRegressor.rrBLUP()</code>
</p>


</div>