<div class="container">

<table style="width: 100%;"><tr>
<td>GeoCV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>n-fold  kriging Cross-validation</h2>

<h3>Description</h3>

<p>The procedure use the <code>GeoKrig</code> or <code>GeoKrigloc</code> function to compute n-fold  kriging cross-validation using informations from a <code>GeoFit</code> object.  The function returns some prediction scores.</p>


<h3>Usage</h3>

<pre><code class="language-R">GeoCV(fit, K=100, estimation=TRUE, optimizer=NULL,
     lower=NULL, upper=NULL, n.fold=0.05,local=FALSE,
    neighb=NULL, maxdist=NULL,maxtime=NULL,sparse=FALSE,
    type_krig="Simple", which=1, parallel=FALSE, ncores=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>An object of class
<code>GeoFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of iterations in cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation</code></td>
<td>
<p>Logical; if <code>TRUE</code> then  an estimation is performed at each iteration and the estimates are used in the prediction. 
Otherwise the estimates in the object fit are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>The type of optimization algorithm if estimation is  <code>TRUE</code>. See  <code>GeoFit</code> for details.
If NULL then  the optimization algorithm of the object fit is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>An optional named list giving the values  for the lower bound of the space parameter
when the optimizer is  <code>L-BFGS-B</code> or <code>nlminb</code>  or <code>optimize</code> if estimation is  <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>An optional named list giving the values  for the upper bound of the space parameter
when the optimizer is  <code>L-BFGS-B</code> or <code>nlminb</code>  or <code>optimize</code> if estimation is  <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.fold</code></td>
<td>
<p>Numeric; the percentage of data to be deleted (and predicted) in the cross-validation procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local</code></td>
<td>
<p>Logical; If local is TRUE, then local kriging is performed. The default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighb</code></td>
<td>
<p>Numeric; an optional positive integer indicating the 
order of neighborhood if local kriging is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>Numeric; an optional positive value indicating the distance in the spatial neighborhood
if local kriging is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>Numeric; an optional positive value indicating the distance in the temporal neighborhood
if local kriging is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>Logical; if <code>TRUE</code> kriging and simulation are computed with sparse matrices algorithms 
using spam package. Default is FALSE. It should be used with compactly supported covariances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_krig</code></td>
<td>
<p>String; the type of kriging. If <code>Simple</code> (the
default) then simple kriging is performed. If <code>Optim</code> then optimal kriging is performed for some non-Gaussian RFs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Numeric; In the case of bivariate  cokriging it indicates which variable to predict.
It can be 1 or 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical; if <code>TRUE</code> then 
the estimation step is  parallelized 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Numeric; number of cores involved in parallelization.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object  containing the following informations:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>predicted</code></td>
<td>
<p>A list  of  the predicted values   in the CV procedure;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_to_pred</code></td>
<td>
<p>A list  of  the data to predict  in the CV procedure;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mae</code></td>
<td>
<p>The vector of mean  absolute error in the CV procedure;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mad</code></td>
<td>
<p>The vector of median  absolute error in the CV procedure;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brie</code></td>
<td>
<p>The vector of brie score in the CV procedure;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmse</code></td>
<td>
<p>The vector of root mean  squared error in the CV procedure;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lscore</code></td>
<td>
<p>The vector of log-score in the CV procedure;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crps</code></td>
<td>
<p>The vector of continuous ranked probability score  in the CV procedure;</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Moreno Bevilacqua, <a href="mailto:moreno.bevilacqua89@gmail.com">moreno.bevilacqua89@gmail.com</a>,<a href="https://sites.google.com/view/moreno-bevilacqua/home">https://sites.google.com/view/moreno-bevilacqua/home</a>,
Víctor Morales Oñate, <a href="mailto:victor.morales@uv.cl">victor.morales@uv.cl</a>, <a href="https://sites.google.com/site/moralesonatevictor/">https://sites.google.com/site/moralesonatevictor/</a>,
Christian", Caamaño-Carrillo, <a href="mailto:chcaaman@ubiobio.cl">chcaaman@ubiobio.cl</a>,<a href="https://www.researchgate.net/profile/Christian-Caamano">https://www.researchgate.net/profile/Christian-Caamano</a>
</p>


<h3>See Also</h3>

<p><code>GeoKrig</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">  
 library(GeoModels)

################################################################
########### Examples of spatial kriging ############
################################################################

model="Gaussian"
set.seed(79)
x = runif(400, 0, 1)
y = runif(400, 0, 1)
coords=cbind(x,y)
# Set the exponential cov parameters:
corrmodel = "GenWend"
mean=0; sill=5; nugget=0
scale=0.2;smooth=0;power2=4

param=list(mean=mean,sill=sill,nugget=nugget,scale=scale,smooth=smooth,power2=power2)

# Simulation of the spatial Gaussian random field:
data = GeoSim(coordx=coords, corrmodel=corrmodel,
              param=param)$data

## estimation with pairwise likelihood
fixed=list(nugget=nugget,smooth=0,power2=power2)
start=list(mean=0,scale=scale,sill=1)
I=Inf
lower=list(mean=-I,scale=0,sill=0)
upper=list(mean= I,scale=I,sill=I)
# Maximum pairwise likelihood fitting :
fit = GeoFit(data, coordx=coords, corrmodel=corrmodel,model=model,
                    likelihood='Marginal', type='Pairwise',neighb=3,
                    optimizer="nlminb", lower=lower,upper=upper,
                    start=start,fixed=fixed)

#a=GeoCV(fit,K=100,estimation=TRUE,parallel=TRUE) 
#a$rmse
</code></pre>


</div>