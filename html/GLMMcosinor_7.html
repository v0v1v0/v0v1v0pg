<div class="container">

<table style="width: 100%;"><tr>
<td>fit_model_and_process</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the cosinor GLMM model using the output from
<code>update_formula_and_data()</code> and a new formula</h2>

<h3>Description</h3>

<p>Fit the cosinor GLMM model using the output from
<code>update_formula_and_data()</code> and a new formula
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_model_and_process(obj, formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Output from <code>update_formula_and_data()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A (optionally) new formula to use when fitting the cosinor
model (maybe with random effects) or other covariates found in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional additional arguments passed to <code>glmmTMB::glmmTMB()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a fitted cosinor model as a <code>cglmm</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Use vitamind data but add a "patient" identifier used as a random effect
vitamind2 &lt;- vitamind
vitamind2$patient &lt;- sample(
  LETTERS[1:5],
  size = nrow(vitamind2), replace = TRUE
)

# Use update_formula_and_data() to perform wrangling steps of cglmm()
# without yet fitting the model
data_and_formula &lt;- update_formula_and_data(
  data = vitamind2,
  formula = vit_d ~ X + amp_acro(time,
    group = "X",
    period = 12
  )
)

# print formula from above
data_and_formula$newformula

# fit model while adding random effect to cosinor model formula.
mod &lt;- fit_model_and_process(
  obj = data_and_formula,
  formula = update.formula(
    data_and_formula$newformula, . ~ . + (1 | patient)
  )
)

mod
mod$fit # printing the `glmmTMB` model within shows Std.Dev. of random effect
</code></pre>


</div>