<div class="container">

<table style="width: 100%;"><tr>
<td>bnlr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binomial Nonlinear Regression Models</h2>

<h3>Description</h3>

<p><code>bnlr</code> fits user-specified nonlinear regression equations to binomial
data with various link functions (<code>logit</code>, <code>probit</code>, <code>comp
log log</code>, <code>log log</code>, <code>Cauchy</code>, <code>Student t</code>, <code>stable</code>, or
<code>mixture</code>). The mixture link is a logistic link with extra probability
mass for <code>y=0</code> and <code>y=n</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bnlr(y = NULL, link = "logit", mu = NULL, linear = NULL,
  pmu = NULL, pshape = NULL, wt = 1, envir = parent.frame(),
  print.level = 0, typsize = abs(p), ndigit = 10, gradtol = 1e-05,
  stepmax = 10 * sqrt(p %*% p), steptol = 1e-05, iterlim = 100,
  fscale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A two column matrix of binomial data or censored data or an object
of class, <code>response</code> (created by <code>restovec</code>) or
<code>repeated</code> (created by <code>rmna</code> or
<code>lvna</code>). If the <code>repeated</code> data object contains
more than one response variable, give that object in <code>envir</code> and give
the name of the response variable to be used here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>A character string containing the name of the link function. The
<code>Student t</code>, <code>stable</code>, and <code>mixture</code> links contain an unknown
parameter to be estimated, respectively the logarithm of the degrees of
freedom, the tail parameter transformed by log(tail/(2-tail)), and logit of
the mixture probability, so that they lie on the whole real line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A user-specified function of <code>pmu</code>, and possibly
<code>linear</code>, giving the regression equation for the location. This may
contain a linear part as the second argument to the function. It may also be
a formula beginning with ~, specifying either a linear regression function
for the location parameter in the Wilkinson and Rogers notation or a general
function with named unknown parameters. If it contains unknown parameters,
the keyword <code>linear</code> may be used to specify a linear part. If nothing
is supplied, the location is taken to be constant unless the linear argument
is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear</code></td>
<td>
<p>A formula beginning with ~ in W&amp;R notation, specifying the
linear part of the regression function for the location parameter or list of
two such expressions for the location and/or shape parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmu</code></td>
<td>
<p>Vector of initial estimates for the location parameters. If
<code>mu</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pshape</code></td>
<td>
<p>If the <code>link</code> is <code>Student t</code>, an initial estimate of
the degrees of freedom; if it is <code>stable</code>, an estimate of the tail
parameter; if it is <code>mixture</code>, an estimate of the mixture probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>Weight vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typsize</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndigit</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepmax</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fscale</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Nonlinear regression models can be supplied as formulae where parameters are
unknowns in which case factor variables cannot be used and parameters must
be scalars. (See <code>finterp</code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the maximum likelihood estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class <code>gnlm</code> is returned that contains all of the
relevant information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code>finterp</code>, <code>glm</code>,
<code>gnlr</code>, <code>gnlr3</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# assay to estimate LD50
y &lt;- c(9,9,10,4,1,0,0)
y &lt;- cbind(y,10-y)
dose &lt;- log10(100/c(2.686,2.020,1.520,1.143,0.860,0.647,0.486))

summary(glm(y~dose, family=binomial))
bnlr(y, mu=~dose, pmu=c(1,1))
summary(glm(y~dose, family=binomial(link=probit)))
bnlr(y, link="probit", mu=~dose, pmu=c(1,1))
## Not run: 
bnlr(y, link="log log", mu=~dose, pmu=c(1,1))
bnlr(y, link="comp log log", mu=~dose, pmu=c(1,1))
bnlr(y, link="Cauchy", mu=~dose, pmu=c(60,-30))
bnlr(y, link="Student", mu=~dose, pmu=c(60,-30), pshape=0.1)
bnlr(y, link="stable", mu=~dose, pmu=c(20,-15), pshape=0, stepmax=1)
bnlr(y, link="mixture", mu=~dose, pmu=c(60,-30), pshape=-2.5)
#
mu &lt;- function(p) -p[1]*(log10(p[2])-dose)
bnlr(y, mu=mu, pmu=c(1,100))
bnlr(y, link="probit", mu=mu, pmu=c(1,100))

## End(Not run)
</code></pre>


</div>