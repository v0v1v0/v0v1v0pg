<div class="container">

<table style="width: 100%;"><tr>
<td>prof.dev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting the Profile Deviance for one of the Parameters in a GAMLSS model</h2>

<h3>Description</h3>

<p>This functions plots the profile deviance of one of the (four) parameters in a GAMLSS model. It can be used if one 
of the parameters <code>mu</code>, <code>sigma</code>, <code>nu</code> or <code>tau</code> is a constant (not a function of explanatory variables) to obtain 
a profile confidence intervals. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">prof.dev(object, which = NULL, min = NULL, max = NULL, 
        step = NULL, length = 7, startlastfit = TRUE, 
        plot = TRUE, perc = 95, col="darkgreen")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A fitted GAMLSS model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>which parameter to  get the profile deviance e.g. <code>which="tau"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min</code></td>
<td>
<p>the minimum value for the parameter e.g. <code>min=1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>the maximum value for the parameter e.g.  <code>max=20</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>how often to evaluate the global deviance (defines the step length of the grid for the parameter) e.g. <code>step=1</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>the length if step is not set, default equal 7</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startlastfit</code></td>
<td>
<p>whether to start fitting from the last fit or not, default value is <code>startlastfit=TRUE</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to plot, <code>plot=TRUE</code> or save the results, <code>plot=FALSE</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc</code></td>
<td>
<p>what % confidence interval is required </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>The colour of the profile line</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function can be use to provide likelihood based confidence intervals for a parameter for which a constant model (i.e. no explanatory model) is fitted and
consequently for checking the adequacy of a particular values of the parameter. This can be used to check the adequacy of one distribution (e.g. Box-Cox Cole and Green) 
nested within another (e.g. Box-Cox power exponential). For example one can test whether a Box-Cox Cole and Green (Box-Cox-normal) distribution 
or a Box-Cox power exponential is appropriate by plotting the profile of the parameter <code>tau</code>. 
A profile deviance showing support for  <code>tau=2</code> indicates adequacy of the Box-Cox Cole and Green (i.e. Box-Cox normal) distribution.      
</p>


<h3>Value</h3>

<p>Return a profile plot (if the argument <code>plot=TRUE</code>) and an <code>ProfLikelihood.gamlss</code> object if saved.  The object contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>the values at the grid where the parameter was evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>the function which approximates the points using splines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min</code></td>
<td>
<p>the minimum values in the grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>te maximum values in the grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.value</code></td>
<td>
<p>the value of the parameter maximising the Profile deviance (or GAIC) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>the profile confidence interval (if global deviance is used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>which criterion was used</p>
</td>
</tr>
</table>
<h3>Warning </h3>

<p>A dense grid (i.e. small step) evaluation of the global deviance can take a long time, so start with a sparse grid (i.e. large step) 
and decrease  gradually the step length for more accuracy. </p>


<h3>Author(s)</h3>

<p>Calliope Akantziliotou, Mikis Stasinopoulos and Bob Rigby</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code>gamlss</code>,  <code>prof.term</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(abdom)
h&lt;-gamlss(y~pb(x), sigma.formula=~pb(x), family=BCT, data=abdom) 
prof.dev(h,"nu",min=-2.000,max=2)
rm(h)
## End(Not run)
</code></pre>


</div>