<div class="container">

<table style="width: 100%;"><tr>
<td>gplsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to fit generalized partially linear single-index models via penalized splines</h2>

<h3>Description</h3>

<p>This function employs penalized spline (P-spline) to estimate generalized
partially linear single index models, which extend the generalized linear
models to include nonlinear effect for some predictors.
</p>
<p>This function add formula interface to gplsim function
</p>


<h3>Usage</h3>

<pre><code class="language-R">gplsim(...)

## Default S3 method:
gplsim(
  Y = Y,
  X = X,
  Z = Z,
  family = gaussian(),
  penalty = TRUE,
  profile = TRUE,
  user.init = NULL,
  bs = "ps",
  ...
)

## S3 method for class 'formula'
gplsim(
  formula,
  data,
  family = gaussian(),
  penalty = TRUE,
  profile = TRUE,
  user.init = NULL,
  bs = "ps",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>includes optional arguments user can pass to <code>mgcv::gam</code> or <code>glm</code>, such as <code>k</code>, which is the dimension of the basis of the smooth term and <code>m</code>, which is the order of the penalty for the smooth term. Others include:
<code>scale</code> The optional argument scale is a numeric indicator with a default value set to -1. Any negative value including -1 indicates that the scale of response distribution is unknown, thus need to be estimated. Another option is 0 signaling scale of 1 for Poisson and binomial distribution and unknown for others. Any positive value will be taken as the known scale parameter.
<code>smooth_selection</code> The optional argument smooth_selection is another character variable that specifies the criterion used in the selection of a smoothing parameter. The supported criteria include "GCV.Cp","GACV.Cp", "ML","P-ML", "P-REML" and "REML", while the default criterion is "GCV.Cp".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response variable, should be a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Single index covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Partially linear covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A <code>family</code> object: a list of functions and expressions
for defining <code>link</code> and <code>variance</code> functions.
Families supported are <code>binomial</code>, <code>gaussian</code>.
The default family is <code>gaussian</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Whether use penalized splines or un-penalized splines to fit the model. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profile</code></td>
<td>
<p>profile is a logical variable that indicates whether the algorithm with profile likelihood or algorithm with NLS procedure should be used. The default algorithm is set to algorithm with profile likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user.init</code></td>
<td>
<p>The user.init is a numeric vector of the same length as the dimensionality of single index predictors. The users can use this argument to pass in any appropriate user-defined initial single-index coefficients based on prior information or domain knowledge. The default value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs</code></td>
<td>
<p>bs is a character variable that specifies the spline basis in the estimation of unknown univariate function of single index. Default is P-splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A model formula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data matrix containing the variables in the formula.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For formula method, see ?gplsim.formula
</p>


<h3>Value</h3>

<p>theta  Estimation of Theta
</p>
<p>coefficients  the coefficients of the fitted model. Parametric coefficients are first, followed by coefficients for each spline term in turn.
</p>
<p>... See GAM object
</p>
<p>theta  Estimation of Theta
</p>
<p>coefficients  the coefficients of the fitted model. Parametric coefficients are first, followed by coefficients for each spline term in turn.
</p>
<p>... See GAM object
</p>


<h3>Examples</h3>

<pre><code class="language-R"># parameter settings
n=200
true.theta = c(1, 1, 1)/sqrt(3)
# Gaussian case
# This function generate a plain sin bump model with gaussian response.
data &lt;- generate_data(n,true.theta=true.theta,family="gaussian")
y=data$Y       # continous response
X=data$X       # single index term ;
Z=data$Z       # partially linear term ;

result &lt;- gplsim(y,X,Z,family = gaussian)
result$theta
result$coefficients
summary(result)


#plot the estimated single index function curve
plot_si(result)
</code></pre>


</div>