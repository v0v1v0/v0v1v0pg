<div class="container">

<table style="width: 100%;"><tr>
<td>create_U</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate tumor clone frequencies in samples</h2>

<h3>Description</h3>

<p>This function calculates the frequencies of each clone in a set of samples, given the global clone proportions in the tumor and their spatial distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">create_U(B, clone_proportions, density_coords, m, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A matrix representing the mutation relationships between the nodes in the phylogenetic tree (B matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clone_proportions</code></td>
<td>
<p>A data frame with two columns: 'clone_idx', which contains the clone identifiers, and 'proportion', which contains the proportions of each clone in the tumor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_coords</code></td>
<td>
<p>A data frame where each column represents the density of a clone at different spatial coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>An integer representing the number of samples taken from the tumor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector representing the spatial coordinates.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix where each row corresponds to a sample, and each column corresponds to a clone. The value at the i-th row and j-th column is the frequency of the j-th clone in the i-th sample.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate the frequencies of each clone in 10 samples taken from a tumor represented by the B 
# matrix B_mat, with global clone proportions clone_proportions, spatial distribution 
# density_coords, and spatial coordinates x

# Create random topology
B &lt;- create_B(20, 3)

# Assign proportions to each clone following a neutral evolution model
clone_proportions &lt;- calc_clone_proportions(B, "neutral")

# Place clones in 1D space
clones_space &lt;- place_clones_space(B)
density_coords &lt;- clones_space$spatial_coords
domain &lt;- clones_space$x

# Create U matrix with parameter m=4
U &lt;- create_U(B = B, clone_proportions = clone_proportions, 
              density_coords = density_coords, m = 4, x = domain)
</code></pre>


</div>