<div class="container">

<table style="width: 100%;"><tr>
<td>gr_test_vars</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test hydrograph changes</h2>

<h3>Description</h3>

<p>Use this function to test interannual changes or hydrograph separation variables returned by <code>gr_summarize()</code>. Pettitt test is used to detect the change year â€” i.e. the year which divides the time series into the statistically most differing samples. Student (Welch) and Fisher tests are used to estimate the significance of mean and variance differences of these samples. Theil-Sen test calculates the trend slope value. Mann-Kendall test is performed to reveal the significance of the trend.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gr_test_vars(df, ..., year = NULL, exclude = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p><code>data.frame</code> as produced by <code>gr_summarize()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Names of the tested variables (quoted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>Integer value of year used to divide series in two samples compared by Student and Fisher tests. Defaults to <code>NULL</code> which means that the year is calculated automatically by Pettitt test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>Integer vector of years to be excluded from tests.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Number of observations formally required for various tests: Pettitt &gt; 0, Mann-Kendall &gt; 2, Theil-Sen &gt; 1, Student &gt; 1, Fisher &gt; 1.
</p>


<h3>Value</h3>

<p><code>list</code> of testing results with following elements:</p>

<table>
<tr>
<td style="text-align: left;">
   <strong>Element</strong> </td>
<td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>ptt</code> </td>
<td style="text-align: left;"> Pettitt tests for change year </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>mkt</code> </td>
<td style="text-align: left;"> Mann-Kendall test for trend significance </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>tst</code> </td>
<td style="text-align: left;"> Theil-Sen test for slope estimation </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>ts_fit</code> </td>
<td style="text-align: left;"> Theil-Sen linear model fit </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>tt</code> </td>
<td style="text-align: left;"> Student (Welch) test for significance of mean differences between two periods </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>ft</code> </td>
<td style="text-align: left;"> Fisher test for significance of variance differences between two periods </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>year</code> </td>
<td style="text-align: left;"> Integer value of year used to divide series in two samples compared by Student and Fisher tests </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>maxval</code> </td>
<td style="text-align: left;"> Maximum value for the variable along the full time series </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>fixed_year</code> </td>
<td style="text-align: left;"> Boolean <code>TRUE</code> or <code>FALSE</code> value indicating if the year was fixed </td>
</tr>
<tr>
<td style="text-align: left;">
   <code>pvalues</code> </td>
<td style="text-align: left;"> p-values of all tests summarized as a single table for all variables </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">library(grwat)

data(spas) # example Spas-Zagorye data is included with grwat package

# separate
sep = gr_separate(spas, params = gr_get_params(reg = 'center'))

# summarize from 1965 to 1990
vars = gr_summarize(sep, 1965, 1990)

# test all variables
tests = gr_test_vars(vars)

# view Pettitt test for Qygr
tests$ptt$Qygr

# view Fisher test for Q30s
tests$ft$Q30s

# test only Qygr and Q30s using 1978 as fixed year and excluding 1988-1991 yrs
gr_test_vars(vars, Qygr, Q30s, year = 1978, exclude = 1981:1983)
</code></pre>


</div>