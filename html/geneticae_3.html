<div class="container">

<table style="width: 100%;"><tr>
<td>GGEmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Site Regression model</h2>

<h3>Description</h3>

<p>The Site Regression model (also called genotype +
genotype-by-environment (GGE) model) is a powerful tool for effective
analysis and interpretation of data from multi-environment trials in
breeding programs. There are different functions in R to fit the SREG model,
such as the <code>GGEModel</code> from the
<a href="https://CRAN.R-project.org/package=GGEBiplots">GGEBiplots package</a>.
However, this function has the following improvements: </p>
 <ul>
<li>
<p>Includes recently published robust versions of the SREG model (Angelini et
al., 2022). </p>
</li>
<li>
<p> It can be used for data from trials with repetitions
(there is no need to calculate means beforehand). </p>
</li>
<li>
<p> Other variables not
used in the analysis can be present in the dataset.</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">GGEmodel(
  Data,
  genotype = "gen",
  environment = "env",
  response = "yield",
  rep = NULL,
  model = "SREG",
  SVP = "symmetrical"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>dataframe with genotypes, environments, repetitions (if any) and
the phenotypic trait of interest. Additional variables that will not be used
in the model may be present in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype</code></td>
<td>
<p>column name for genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment</code></td>
<td>
<p>column name for environments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>column name for the phenotypic trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>column name for replications. If this argument is NULL, there are
no replications in the data. Defaults to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>method for fitting the SREG model: '"SREG"','"CovSREG"','"hSREG"'
or '"ppSREG"' (see References). Defaults to '"SREG"'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SVP</code></td>
<td>
<p>method for singular value partitioning. Either '"row"', '"column"',
or '"symmetrical"'. Defaults to '"symmetrical"'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A linear model by robust regression using an M estimator proposed by
Huber (1964, 1973) fitted by iterated re-weighted least squares, in
combination with three robust SVD/PCA procedures, resulted in a total of
three robust SREG alternatives. The robust SVD/PCA considered were:
</p>
 <ul>
<li>
<p> CovSREG: robust PCA that is obtained by replacing the
classical estimates of location and covariance by their robust analogues
using Minimum Regularized Covariance Determinant (MRCD) approach; </p>
</li>
<li>
<p>hSREG: robust PCA method that tries to combine the advantages of both
approaches, PCA based on a robust covariance matrix and based on projection
pursuit; </p>
</li>
<li>
<p> ppSREG: robust PCA that uses the projection pursuit and
directly calculates the robust estimates of the eigenvalues and eigenvectors
without going through robust covariance estimation. It is a very attractive
method for bigdata situations, which are very common in METs (a few
genotypes tested in a large number of environments), as the principal
components can be calculated sequentially. </p>
</li>
</ul>
<h3>Value</h3>

<p>A list of class <code>GGE_Model</code> containing: </p>
<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>SREG model
version.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordgenotype</code></td>
<td>
<p>plotting coordinates for each genotype in
every component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordenviroment</code></td>
<td>
<p>plotting coordinates for each
environment in every component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvalues</code></td>
<td>
<p>vector of eigenvalues
for each component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vartotal</code></td>
<td>
<p>overall variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varexpl</code></td>
<td>
<p>percentage of variance explained by each component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelgen</code></td>
<td>
<p>genotype names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelenv</code></td>
<td>
<p>environment names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>scaled and centered input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SVP</code></td>
<td>
<p>name of SVP method.</p>
</td>
</tr>
</table>
<p>A biplot of class <code>ggplot</code>
</p>


<h3>References</h3>

<p>Julia Angelini, Gabriela Faviere, Eugenia Bortolotto, Gerardo
Domingo Lucio Cervigni &amp; Marta Beatriz Quaglino (2022) Handling outliers in
multi-environment trial data analysis: in the direction of robust SREG
model, Journal of Crop Improvement, DOI: 10.1080/15427528.2022.2051217
</p>


<h3>Examples</h3>

<pre><code class="language-R"> library(geneticae)

 # Data without replication
 library(agridat)
 data(yan.winterwheat)
 GGE1 &lt;- GGEmodel(yan.winterwheat, genotype="gen", environment="env", response="yield")

 # Data with replication
 data(plrv)
 GGE2 &lt;- GGEmodel(plrv, genotype = "Genotype", environment = "Locality",
                  response = "Yield", rep = "Rep")

</code></pre>


</div>