<div class="container">

<table style="width: 100%;"><tr>
<td>BCPE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Box-Cox Power Exponential distribution for fitting a GAMLSS</h2>

<h3>Description</h3>

<p>This function defines the Box-Cox Power Exponential distribution, a four parameter distribution, for a <code>gamlss.family</code> object to be used for a  
GAMLSS fitting using the function <code>gamlss()</code>.  
</p>
<p>The functions <code>dBCPE</code>, 
<code>pBCPE</code>, <code>qBCPE</code> and <code>rBCPE</code> define the density, distribution function, quantile function and random
generation for the Box-Cox Power Exponential distribution. 
</p>
<p>The function <code>checkBCPE</code> (very old) can be used, typically when a BCPE model is fitted, to check whether there exit a turning point 
of the distribution close to zero. It give the number of values of the response below their minimum turning point and also 
the maximum probability of the lower tail below minimum turning point.  
</p>
<p>[The function <code>Biventer()</code> is the original version of the function suitable only for the untruncated BCPE distribution.] See Rigby and Stasinopoulos (2003) for details.
</p>
<p>The function <code>BCPEo</code> is identical to <code>BCPE</code> but with log link for mu.    
</p>


<h3>Usage</h3>

<pre><code class="language-R">BCPE(mu.link = "identity", sigma.link = "log", nu.link = "identity",
          tau.link = "log")
BCPEo(mu.link = "log", sigma.link = "log", nu.link = "identity", 
          tau.link = "log")
BCPEuntr(mu.link = "identity", sigma.link = "log", nu.link = "identity", 
          tau.link = "log")
dBCPE(x, mu = 5, sigma = 0.1, nu = 1, tau = 2, log = FALSE)
pBCPE(q, mu = 5, sigma = 0.1, nu = 1, tau = 2, lower.tail = TRUE, log.p = FALSE)
qBCPE(p, mu = 5, sigma = 0.1, nu = 1, tau = 2, lower.tail = TRUE, log.p = FALSE)          
rBCPE(n, mu = 5, sigma = 0.1, nu = 1, tau = 2)
dBCPEo(x, mu = 5, sigma = 0.1, nu = 1, tau = 2, log = FALSE)
pBCPEo(q, mu = 5, sigma = 0.1, nu = 1, tau = 2, lower.tail = TRUE, 
       log.p = FALSE)
qBCPEo(p, mu = 5, sigma = 0.1, nu = 1, tau = 2, lower.tail = TRUE, 
       log.p = FALSE)          
rBCPEo(n, mu = 5, sigma = 0.1, nu = 1, tau = 2)
checkBCPE(obj = NULL, mu = 10, sigma = 0.1, nu = 0.5, tau = 2,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu.link</code></td>
<td>
<p> Defines the <code>mu.link</code>, with "identity" link as the default for the <code>mu</code> parameter. Other links are "inverse", "log" and "own"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.link</code></td>
<td>
<p> Defines the  <code>sigma.link</code>, with "log" link as the default for the <code>sigma</code> parameter. Other links are "inverse", "identity" and "own"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu.link</code></td>
<td>
<p>Defines the  <code>nu.link</code>, with "identity" link as the default for the <code>nu</code> parameter. Other links are "inverse", "log" and "own"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.link</code></td>
<td>
<p>Defines the  <code>tau.link</code>, with "log" link as the default for the <code>tau</code> parameter. Other links are "logshifted", "identity" and "own"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of location parameter values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of scale parameter values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>vector of <code>nu</code> parameter values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>vector of <code>tau</code> parameter values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p> logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x] </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a gamlss BCPE family object  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The probability density function of the untrucated Box Cox Power Exponential distribution, (<code>BCPE.untr</code>), is defined as 
</p>
<p style="text-align: center;"><code class="reqn">f(y|\mu,\sigma,\nu,\tau)=\frac{y^{\nu-1} \tau \exp[-\frac{1}{2}|\frac{z}{c}|^\tau]}{\mu^{\nu} \sigma c  2^{(1+1/\tau)} \Gamma(\frac{1}{\tau})}</code>
</p>

<p>where <code class="reqn">c = [ 2^{(-2/\tau)}\Gamma(1/\tau)/\Gamma(3/\tau)]^{0.5}</code>,
where if <code class="reqn">\nu \neq 0</code> then <code class="reqn">z=[(y/\mu)^{\nu}-1]/(\nu \sigma)</code>
else <code class="reqn">z=\log(y/\mu)/\sigma</code>, 
for <code class="reqn">y&gt;0</code>, <code class="reqn">\mu&gt;0</code>, <code class="reqn">\sigma&gt;0</code>, <code class="reqn">\nu=(-\infty,+\infty)</code> and <code class="reqn">\tau&gt;0</code> see pp. 450-451 of Rigby et al. (2019).  
</p>
<p>The Box-Cox Power Exponential, <code>BCPE</code>, adjusts the above density <code class="reqn">f(y|\mu,\sigma,\nu,\tau)</code> for the 
truncation resulting from the condition <code class="reqn">y&gt;0</code>. See Rigby and Stasinopoulos (2003) for details.   
</p>


<h3>Value</h3>

<p><code>BCPE()</code>  returns a <code>gamlss.family</code> object which can be used to fit a Box Cox Power Exponential distribution in the <code>gamlss()</code> function. 
<code>dBCPE()</code> gives the density, <code>pBCPE()</code> gives the distribution
function, <code>qBCPE()</code> gives the quantile function, and <code>rBCPE()</code>
generates random deviates. 
</p>


<h3>Warning </h3>

<p>The <code>BCPE.untr</code> distribution may be unsuitable for some combinations of the parameters (mainly for large <code class="reqn">\sigma</code>) 
where the integrating constant is less than 0.99. A warning will be given if this is the case.
</p>
<p>The <code>BCPE</code> distribution is suitable for all combinations of the parameters within their ranges [i.e. <code class="reqn">\mu&gt;0,\sigma&gt;0, \nu=(-\infty,\infty) {\rm and} \tau&gt;0</code> ]
</p>


<h3>Note</h3>

<p><code class="reqn">\mu</code>, is the median of the distribution, <code class="reqn">\sigma</code> is approximately the coefficient of variation (for small <code class="reqn">\sigma</code> and moderate <code>nu&gt;0</code>), 
<code class="reqn">\nu</code> controls the skewness and <code class="reqn">\tau</code> the kurtosis of the distribution </p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Calliope Akantziliotou</p>


<h3>References</h3>

 
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A. and Stasinopoulos, D. M. (2004). Smooth centile curves for skew and kurtotic data modelled using the Box-Cox Power
Exponential distribution. <em>Statistics in Medicine</em>, <b>23</b>: 3053-3076.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC, <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>.
An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://doi.org/10.18637/jss.v023.i07">doi:10.18637/jss.v023.i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code>gamlss.family</code>, <code>BCT</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># BCPE()   #
# library(gamlss) 
# data(abdom)
#h&lt;-gamlss(y~cs(x,df=3), sigma.formula=~cs(x,1), family=BCPE, data=abdom) 
#plot(h)
plot(function(x)dBCPE(x, mu=5,sigma=.5,nu=1, tau=3), 0.0, 15, 
 main = "The BCPE  density mu=5,sigma=.5,nu=1, tau=3")
plot(function(x) pBCPE(x, mu=5,sigma=.5,nu=1, tau=3), 0.0, 15, 
 main = "The BCPE  cdf mu=5, sigma=.5, nu=1, tau=3")
</code></pre>


</div>