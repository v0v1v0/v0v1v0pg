<div class="container">

<table style="width: 100%;"><tr>
<td>swp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sweep operator</h2>

<h3>Description</h3>

<p>Sweeps a covariance matrix with respect to a subset of indices. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">swp(V, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>a symmetric positive definite matrix, the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a subset of indices of the columns of <code>V</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sweep operator has been introduced by Beaton (1964) as a tool for
inverting symmetric matrices (see Dempster, 1969).
</p>


<h3>Value</h3>

<p>a square matrix <code>U</code> of the same order as <code>V</code>. If <code>a</code> is
the complement of <code>b</code>, then <code>U[a,b]</code> is the matrix of
regression coefficients of <code>a</code> given <code>b</code> and <code>U[a,a]</code>
is the corresponding covariance matrix of the residuals.
</p>
<p>If <code>b</code> is empty the function returns <code>V</code>.
</p>
<p>If <code>b</code> is the vector <code>1:nrow(V)</code> (or its permutation) then
the function returns the opposite of the inverse of <code>V</code>.
</p>


<h3>Author(s)</h3>

<p>Giovanni M. Marchetti</p>


<h3>References</h3>

<p>Beaton, A.E. (1964). <em>The use of special matrix operators
in statistical calculus</em>. Ed.D. thesis, Harvard
University. Reprinted as Educational Testing Service Research Bulletin
64-51. Princeton.
</p>
<p>Dempster, A.P. (1969). <em>Elements of continuous multivariate
analysis</em>.  Reading: Addison-Wesley.
</p>


<h3>See Also</h3>

<p><code>fitDag</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## A very simple example
V &lt;- matrix(c(10, 1, 1, 2), 2, 2)
swp(V, 2)
</code></pre>


</div>