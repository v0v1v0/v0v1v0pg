<div class="container">

<table style="width: 100%;"><tr>
<td>find_lambda_by_sparsity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Optimal Lambda by Sparsity Level</h2>

<h3>Description</h3>

<p>This function performs a grid search over a range of lambda values to identify
the lambda that achieves a desired level of sparsity in the precision matrix
estimated by Graphical Lasso. Sparsity is defined as the proportion of zero
elements (excluding the diagonal) in the precision matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_lambda_by_sparsity(
  s,
  lambda_grid,
  desired_sparsity,
  mtol = 1e-04,
  maxIterations = 10000,
  ltol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>The sample covariance matrix of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_grid</code></td>
<td>
<p>A numeric vector of lambda values to be tested in the grid search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>desired_sparsity</code></td>
<td>
<p>The target sparsity level as a proportion of zero elements
in the precision matrix. This should be a value between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtol</code></td>
<td>
<p>The convergence threshold for Graphical Lasso optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIterations</code></td>
<td>
<p>The maximum number of iterations for Graphical Lasso optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltol</code></td>
<td>
<p>The tolerance for determining whether elements are considered zero
when calculating sparsity.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components:
- <code>best_lambda</code>: the lambda value that results in sparsity closest to the desired level.
- <code>best_sparsity_difference</code>: the smallest difference between achieved and desired sparsity.
- <code>actual_sparsity</code>: a numeric vector of actual sparsity levels for each lambda tested.
- <code>lambda_grid</code>: the vector of lambda values tested.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a sparse covariance matrix
values &lt;- c(160, 50)
n &lt;- values[1]
p &lt;- values[2]
s &lt;- generate_sparse_cov_matrix(n, p, standardize = TRUE, sparse_rho = 0, scale_power = 0)

# Define a sequence of lambda values for the grid search
lambda_find &lt;- c(0.1, 0.2, 0.3, 0.4)

# Perform a grid search to find the lambda value
# that results in a precision matrix with approximately 80% sparsity
lambda_results &lt;- find_lambda_by_sparsity(s, lambda_find, desired_sparsity = 0.8)

# Inspect the optimal lambda value
optimal_lambda &lt;- lambda_results$best_lambda

# Inspect the sparsity levels for each lambda tested
sparsity_levels &lt;- lambda_results$actual_sparsity

</code></pre>


</div>