<div class="container">

<table style="width: 100%;"><tr>
<td>gpdpPost</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run a Bayesian functional data model under a GP prior whose parameters employ a DP prior</h2>

<h3>Description</h3>

<p>An internal function to <code>gpdpgrow</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpdpPost(
  y,
  ipr,
  Omega_t,
  Omega_s,
  gp_mod,
  jitter,
  gp_shape,
  gp_rate,
  noise_shape,
  noise_rate,
  lower,
  upper,
  w_star,
  w,
  n_slice_iter,
  y_index,
  n.iter,
  n.burn,
  n.thin,
  n.tune,
  M_init,
  dp_shape,
  dp_rate,
  progress
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>An <em>N x T</em> matrix of N observations of <em>T x 1</em> functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipr</code></td>
<td>
<p>An optional input vector of inclusion probabilities for each observation unit in the case
the observed data were acquired through an informative sampling design, so that unbiased
inference about the population requires adjustments to the observed sample.  Defaults to
<code>ipr = rep(1,nrow(y))</code> indicating an iid sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega_t</code></td>
<td>
<p>A <em>T x T</em> matrix of squared Eucidean distances for <code>T</code> time points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega_s</code></td>
<td>
<p>A <code>list</code> object of length <code>L_s</code>, where each contains the <em>T x T</em>
matrix of Euclidean distances associated to each seasonal covariance term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp_mod</code></td>
<td>
<p>An <em>L x 1</em> numeric vector denoting the selected covariance function for each
of <code>L</code> terms.  <code>gp_mod = 1</code> is <code>"rq"</code>.  <code>gp_mod = 2</code> is <code>"se"</code>.
<code>gp_mod = 3</code> is <code>"sn"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>Numeric value added to diagonals of GP covariance matrix to stabilize inversion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp_shape</code></td>
<td>
<p>The shape parameter of the Gamma base distribution for the <code>kappa_star</code>
locations used to sample the DP prior on the <code>P</code> GP covariance parameters, 
<code>kappa</code>, for each experimental unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp_rate</code></td>
<td>
<p>The rate parameter of the Gamma base distribution for the <code>kappa_star</code>
locations used to sample the DP prior on the <code>P</code> GP covariance parameters, 
<code>kappa</code>, for each experimental unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise_shape</code></td>
<td>
<p>The shape parameter of the Gamma base distribution on <code>tau_e</code>, the
model noise precision parameter. Defaults to <code>noise_shape = 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise_rate</code></td>
<td>
<p>The rate parameter of the Gamma base distribution on <code>tau_e</code>, the model
noise precision parameter.  Defaults to <code>noise_rate = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Minimum in range of support for GP covariance parameters, <code>kappa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Maximum in range of support for GP covariance parameters, <code>kappa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_star</code></td>
<td>
<p>Tuning parameter for number of locations to sample not linked to observations
in the auxiliary Gibbs sampler for cluster assignments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Tuning parameter for slice sampling interval width used for GP 
covariance parameters, <code>kappa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_slice_iter</code></td>
<td>
<p>Maximum number of steps to widen slice samplind width for
GP covariance parameters, <code>kappa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_index</code></td>
<td>
<p>List object where each contains index of time points to use in <code>n</code>
progressively coarser distribution for sampling <code>kappa</code> in tempered update steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>The number of MCMC sampling iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.burn</code></td>
<td>
<p>The number of warm-up iterations to discard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.thin</code></td>
<td>
<p>The interval or step size of post-burn-in samples to return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tune</code></td>
<td>
<p>The number of tuning iterations to update the slice sampler width, <code>w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_init</code></td>
<td>
<p>Starting value of number of clusters for sampling cluster assignments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp_shape</code></td>
<td>
<p>The shape parameter for the <code class="reqn">\Gamma</code> prior on the DP concentration parameter.
The rate parameter is set of <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp_rate</code></td>
<td>
<p>The rate parameter for the <code class="reqn">\Gamma</code> prior on the DP concentration parameter. 
Default value is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>An indicator in <code>{0,1}</code> denoting whether to display a progress bar during model execution.
<code>progress = 1</code> displays a progress bar. Defaults to <code>progress = 1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>res A list object containing MCMC runs for all model parameters.
</p>


<h3>Note</h3>

<p>Intended as an internal function for <code>gpdpgrow</code>
</p>


<h3>Author(s)</h3>

<p>Terrance Savitsky <a href="mailto:tds151@gmail.com">tds151@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>gpdpgrow</code>
</p>


</div>