<div class="container">

<table style="width: 100%;"><tr>
<td>gen_structured_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation Scenario from Bhatnagar et al. (2018+) ggmix paper</h2>

<h3>Description</h3>

<p>Function that generates data of the different simulation studies
presented in the accompanying paper. This function requires the
<code>popkin</code> and <code>bnpsd</code> package to be installed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gen_structured_model(
  n,
  p_design,
  p_kinship,
  k,
  s,
  Fst,
  b0,
  nPC = 10,
  eta,
  sigma2,
  geography = c("ind", "1d", "circ"),
  percent_causal,
  percent_overlap,
  train_tune_test = c(0.6, 0.2, 0.2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_design</code></td>
<td>
<p>number of variables in X_test, i.e., the design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_kinship</code></td>
<td>
<p>number of variable in X_kinship, i.e., matrix used to
calculate kinship</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of intermediate subpopulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>the desired bias coefficient, which specifies sigma indirectly.
Required if sigma is missing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fst</code></td>
<td>
<p>The desired final FST of the admixed individuals. Required if
sigma is missing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>the true intercept parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPC</code></td>
<td>
<p>number of principal components to include in the design matrix
used for regression adjustment for population structure via principal
components. This matrix is used as the input in a standard lasso regression
routine, where there are no random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>the true eta parameter, which has to be <code>0 &lt; eta &lt; 1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>the true sigma2 parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geography</code></td>
<td>
<p>the type of geography for simulation the kinship matrix.
"ind" is independent populations where every individuals is actually
unadmixed, "1d" is a 1D geography and "circ" is circular geography.
Default: "ind". See the functions in the <code>bnpsd</code> for details on how
this data is actually generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent_causal</code></td>
<td>
<p>percentage of <code>p_design</code> that is causal. must be
<code class="reqn">0 \leq percent_causal \leq 1</code>. The true regression coefficients are
generated from a standard normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percent_overlap</code></td>
<td>
<p>this represents the percentage of causal SNPs that
will also be included in the calculation of the kinship matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>train_tune_test</code></td>
<td>
<p>the proportion of sample size used for training tuning
parameter selection and testing. default is 60/20/20 split</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The kinship is estimated using the <code>popkin</code> function from the
<code>popkin</code> package. This function will multiple that kinship matrix by 2
to give the expected covariance matrix which is subsequently used in the
linear mixed models
</p>


<h3>Value</h3>

<p>A list with the following elements </p>
<dl>
<dt>ytrain</dt>
<dd>
<p>simulated
response vector for training set</p>
</dd> <dt>ytune</dt>
<dd>
<p>simulated response vector
for tuning parameter selection set</p>
</dd> <dt>ytest</dt>
<dd>
<p>simulated response vector
for test set</p>
</dd> <dt>xtrain</dt>
<dd>
<p>simulated design matrix for training
set</p>
</dd>
<dt>xtune</dt>
<dd>
<p>simulated design matrix for tuning parameter selection
set</p>
</dd>
<dt>xtest</dt>
<dd>
<p>simulated design matrix for testing set</p>
</dd>
<dt>xtrain_lasso</dt>
<dd>
<p>simulated design matrix for training set for lasso
model. This is the same as xtrain, but also includes the nPC principal
components</p>
</dd> <dt>xtune_lasso</dt>
<dd>
<p>simulated design matrix for tuning parameter
selection set for lasso model. This is the same as xtune, but also includes
the nPC principal components</p>
</dd>
<dt>xtest</dt>
<dd>
<p>simulated design matrix for
testing set for lasso model. This is the same as xtest, but also includes
the nPC principal components</p>
</dd> <dt>causal</dt>
<dd>
<p>character vector of the names
of the causal SNPs</p>
</dd> <dt>beta</dt>
<dd>
<p>the vector of true regression coefficients</p>
</dd>
<dt>kin_train</dt>
<dd>
<p>2 times the estimated kinship for the training set
individuals</p>
</dd> <dt>kin_tune_train</dt>
<dd>
<p>The covariance matrix between the tuning
set and the training set individuals</p>
</dd> <dt>kin_test_train</dt>
<dd>
<p>The covariance
matrix between the test set and training set individuals</p>
</dd>
<dt>Xkinship</dt>
<dd>
<p>the matrix of SNPs used to estimate the kinship matrix</p>
</dd>
<dt>not_causal</dt>
<dd>
<p>character vector of the non-causal SNPs</p>
</dd> <dt>PC</dt>
<dd>
<p>the
principal components for population structure adjustment</p>
</dd> </dl>
<h3>See Also</h3>

<p><code>admix_prop_1d_linear</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">admixed &lt;- gen_structured_model(n = 100,
                                p_design = 50,
                                p_kinship = 5e2,
                                geography = "1d",
                                percent_causal = 0.10,
                                percent_overlap = "100",
                                k = 5, s = 0.5, Fst = 0.1,
                                b0 = 0, nPC = 10,
                                eta = 0.1, sigma2 = 1,
                                train_tune_test = c(0.8, 0.1, 0.1))
names(admixed)
</code></pre>


</div>