<div class="container">

<table style="width: 100%;"><tr>
<td>fit_abundances</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a unimodal or multimodal gambin model to a species abundance distribution</h2>

<h3>Description</h3>

<p>Uses maximum likelihood methods to fit the GamBin model (with a given number of modes) to binned
species abundances. To control for the effect of sample size, the abundances
may be subsampled prior to fitting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_abundances(abundances, subsample = 0, no_of_components = 1, cores = 1)

fitGambin(abundances, subsample = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>abundances</code></td>
<td>
<p>Either a vector of abundances of all species in the sample/community; or the result of <code>create_octaves</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsample</code></td>
<td>
<p>The number of individuals to sample from the community before fitting the GamBin model.
If subsample == 0 the entire community is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_of_components</code></td>
<td>
<p>Number of components (i.e. modes) to fit.The default (no_of_components == 1) fits the standard
unimodal gambin model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>No of cores to use when fitting. Use <code>parallel::detectCores()</code> to
detect the number of cores on your machine.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The gambin distribution is fit to the number of species in abundance octaves,
as specified by the <code>create_octaves</code> function. Because the shape of species abundance
distributions depend on sample size, abundances of different communities should be compared
on equally large samples. The sample size can be set by the <code>subsample</code> parameter.
To estimate <code>alpha</code> from a standardised sample, the function must be run several
times; see the examples. The <code>no_of_components</code> parameter enables multimodal gambin
distributions to be fitted. For example, setting <code>no_of_components</code> equal to 2, the bimodal
gambin model is fitted. When a multimodal gambin model is fitted (with g modes), the return values are the alpha
parameters of the g different component distributions, the max octave values for the g component distributions 
(as the max octave values for the g-1 component distributions are allowed to vary), and the and the weight parameter(s) 
which denote the fraction of objects within each g component distribution. When fitting multimodal gambin models
(particularly on large datasets), the optimisation algorithm can be slow. In such cases, the process
can be speeded up by using the <code>cores</code> parameter to enable parallel computing.
</p>
<p>The <code>plot</code> method creates a barplot showing the observed number of
species in octaves, with the fitted GamBin distribution shown as black dots.
The <code>summary.gambin</code> method provides additional useful information such
as confidence intervals around the model parameter estimates.
</p>


<h3>Value</h3>

<p>The <code>fit_abundances</code> function returns an object of class <code>gambin</code>, with the <code>alpha</code>,
<code>w</code>
and <code>MaxOctave</code> parameters of the gambin mixture distribution,
the likelihood of the fit, and the empirical distribution over octaves.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(moths)
fit = fit_abundances(moths)
barplot(fit)
lines(fit, col=2)
summary(fit)
# gambin parameters based on a standardized sample size of 1000 individuals
stand_fit &lt;- replicate(20, fit_abundances(moths, 1000)$alpha) #may take a while on slower computers
print(c(mean = mean(stand_fit), sd = sd(stand_fit)))
# a bimodal gambin model
biMod &lt;- fit_abundances(moths, no_of_components = 2)
</code></pre>


</div>