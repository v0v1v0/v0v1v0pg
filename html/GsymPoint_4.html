<div class="container">

<table style="width: 100%;"><tr>
<td>gsym.point</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Construction of confidence intervals for the Generalized Symmetry point and its accuracy measures through two methods
</h2>

<h3>Description</h3>

<p>gsym.point is used to construct confidence intervals for the Generalized Symmetry point and its accuracy measures (sensitivity and specificity) for a continuous diagnostic test using two methods: the Generalized Pivotal Quantity (GPQ) method and the Empirical Likelihood (EL) method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsym.point (methods, data, marker, status, tag.healthy, categorical.cov = NULL, 
CFN = 1, CFP = 1, control = control.gsym.point(), confidence.level = 0.95, 
trace = FALSE, seed = FALSE, value.seed = 3, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>methods</code></td>
<td>

<p>a character vector selecting the method(s) to be used for estimating the Generalized Symmetry point and its accuracy measures. The possible options are: "GPQ", "EL", "auto", c("GPQ","EL") or c("EL","GPQ").
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing all needed variables: the diagnostic marker, the true disease status and, when it is neccesary, the categorical covariate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker</code></td>
<td>

<p>a character string with the name of the diagnostic test variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>

<p>a character string with the name of the variable that distinguishes healthy from diseased individuals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag.healthy</code></td>
<td>

<p>the value codifying healthy individuals in the <code>status</code> variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical.cov</code></td>
<td>

<p>a character string with the name of the categorical covariate according to which the Generalized Symmetry point is to be calculated. The default is NULL (no categorical covariate is considered in the analysis).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CFN</code></td>
<td>

<p>a numerical value that specifies the cost of a false negative decision. The default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CFP</code></td>
<td>

<p>a numerical value that specifies the cost of a false positive decision. The default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>output of the <code>control.gsym.point</code> function that controls the whole calculation process of the Generalized Symmetry point.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence.level</code></td>
<td>

<p>a numerical value with the confidence level for the construction of the confidence intervals. The default value is 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>a logical value to show information on progress when it is TRUE. The default value is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>a logical value to choose if a seed is fixed for generating the trials in the computation of the confidence intervals in order to reproduce the same simulation process. The default value is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value.seed</code></td>
<td>

<p>the numerical value for the fixed seed when <code>seed</code> is TRUE. The default value is 3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>a  logical value that allows to show extra information on the normality assumption and the Shapiro-Wilk normality p-values. The default value is FALSE.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Symmetry point <code class="reqn">c_{S}</code> satisfies the equality <code class="reqn">p(c_{S}) = q(c_{S})</code>, where <code class="reqn">p</code> and <code class="reqn">q</code> denote, respectively, the specificity (or true negative fraction) and sensitivity (or true positive fraction). Geometrically, it is the point where the ROC curve and the line <code class="reqn">y = 1 - x</code> (the perpendicular to the positive diagonal line) intersect, and it can also be seen as the point that maximizes simultaneously both types of correct classifications (Riddle and Stratford, 1999; Gallop et al., 2003) corresponding, therefore, to the probability of correctly classifying any subject, whether it is healthy or diseased (Jiménez-Valverde et al., 2012; 2014).
</p>
<p>Taking into account the costs associated to the false positives and false negatives misclassifications, <code class="reqn">C_{FP}</code> and <code class="reqn">C_{FN}</code>, an extension of the Symmetry point called the Generalized Symmetry point, <code class="reqn">c_{GS}</code>, can be defined as follows (López-Ratón et al., 2015):
</p>
<p style="text-align: center;"><code class="reqn">\rho (1-p(c_{GS})) = 1-q(c_{GS})</code>
</p>

<p>where <code class="reqn">\rho = \frac{C_{FP}}{C_{FN}}</code> is the relative loss (cost) of a false positive classification as compared with a false negative classification.
Analogously to the Symmetry point, <code class="reqn">c_{GS}</code> is obtained graphically by the intersection point between the ROC curve and the line <code class="reqn">y = 1 - \rho x</code>.
</p>
<p>In this package, the two methods proposed in López-Ratón et al. (2016) for estimating the Generalized Symmetry point and its sensitivity and specificity indexes are available:
</p>
<p><code>"GPQ"</code>: Method based on the Generalized Pivotal Quantity (Weerahandi, 1993; 1995; Lai et al., 2012). It assumes that the diagnostic test on both groups or a monotone Box-Cox transformation is Normal distributed. So, the Generalized Symmetry point <code class="reqn">c_{GS}</code> can be estimated from the following equation:
</p>
<p style="text-align: center;"><code class="reqn">\Phi(a+b\Phi^{-1}(t)) = 1-\rho t  \Leftrightarrow  \Phi \left(\frac{\Phi^{-1}(1-\rho t)-a}{b}\right)-t=0</code>
</p>

<p>where <code class="reqn">a=\frac{\mu_1-\mu_0}{\sigma_1}</code>, <code class="reqn">b=\frac{\sigma_0}{\sigma_1}</code>, <code class="reqn">t=1-p(c_{GS})</code> and <code class="reqn">\Phi</code> denotes the standard Normal cumulative distribution function (cdf), with <code class="reqn">\mu_i</code> and <code class="reqn">\sigma_i</code>, i = 0,1, the mean and standard deviation of healthy (<code class="reqn">i</code>=0) and diseased (<code class="reqn">i</code>=1) populations, respectively.
To check the assumption of normality, the Shapiro-Wilk test is used with a significance level of 5%.
</p>
<p><code>"EL"</code>: Method based on the Empirical Likelihood (Thomas and Grunkemeier, 1975). It takes into account that <code class="reqn">c_{GS}</code> can be seen as two specific quantiles, the <code class="reqn">p(c_{GS})</code>-th quantile of the healthy population and the <code class="reqn">\rho (1-q(c_{GS}))</code>-th quantile of the diseased population. Following the same reasoning as in Molanes-López and Letón (2011), and considering that the value of <code class="reqn">p(c_{GS})</code> is known in advance and the Generalized Symmetry point defines an operating point on the ROC curve fulfilling <code class="reqn">1-x=p(c_{GS})</code>, the following adjusted empirical log-likelihood ratio function is derived to make inference on <code class="reqn">c_{GS}</code>:
</p>
<p style="text-align: center;"><code class="reqn">\ell(c)=2n_0\hat{F}_{0,g_{0}}(c)\log\!\left(\frac{\hat{F}_{0,g_{0}}(c)}{p(c)}\right) +2n_0(1-\hat{F}_{0,g_{0}}(c))\log\left(\frac{1-\hat{F}_{0,g_0}(c)}{1-p(c)}\right)</code>
</p>

<p style="text-align: center;"><code class="reqn">+2n_1\hat{F}_{1,g_{1}}(c)\log\left(\frac{\hat{F}_{1,g_{1}}(c)}{\rho(1-p(c))}\right)
+2n_1(1-\hat{F}_{1,g_{1}}(c))\log\left(\frac{1-\hat{F}_{1,g_{1}}(c)}{1-\rho (1-p(c))}\right)\!,
</code>
</p>

<p>where <code class="reqn">\hat{F}_{i,g_{i}}(y)=\frac{1}{n_i}\sum_{k_i=1}^{n_i}K\left(\frac{y-Y_{ik_i}}{g_{i}}\right)</code> are kernel-type estimates of the cdfs <code class="reqn">F_{i}</code>, of the two populations, <code class="reqn">i=0,1</code>, with <code class="reqn">K(y)=\int_{-\infty}^{y} K(z)\mathrm{d}z</code> a kernel function and <code class="reqn">g_i</code> the smoothing parameter, for <code class="reqn">i=0,1</code>.
</p>
<p><code>"auto"</code>: the program selects automatically the most appropriate method of the two available, based on the normality assumption. The GPQ is selected under the normality assumption and the EL otherwise.
</p>


<h3>Value</h3>

<p>Returns an object of class "gsym.point" with the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>methods</code></td>
<td>
<p>a character vector with the value of the <code>methods</code> argument used in the call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels.cat</code></td>
<td>
<p>a character vector indicating the levels of the categorical covariate if the <code>categorical.cov</code> argument in the <code>gsym.point</code> function is not NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data frame with the variables used in the call.</p>
</td>
</tr>
</table>
<p>For each of the methods used in the call, a list with the following components is obtained:  
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"optimal.result"</code></td>
<td>
<p>a list with the Generalized Symmetry point and its associated sensitivity and specificity accuracy measures with the corresponding confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"AUC"</code></td>
<td>
<p>the numerical value of the Area Under the ROC Curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"rho"</code></td>
<td>
<p>the numerical value of the cost ratio <code class="reqn">\rho = \frac{C_{FP}}{C_{FN}}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"pvalue.healthy"</code></td>
<td>
<p>the numerical value of the p-value obtained by the Shapiro-Wilk normality test for checking the normality assumption of the marker in the healthy population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"pvalue.diseased"</code></td>
<td>
<p>the numerical value of the p-value obtained by the Shapiro-Wilk normality test for checking the normality assumption of the marker in the diseased population.</p>
</td>
</tr>
</table>
<p>In addition, if the original data are not normally distributed the following components also appears:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"lambda"</code></td>
<td>
<p>the estimated numerical value of the power used in the Box-Cox transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"normality.transformed"</code></td>
<td>
<p>a character string indicating if the transformed marker values by the Box-Cox transformation are normally distributed ("yes") or not ("no").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"pvalue.healthy.transformed"</code></td>
<td>
<p>the numerical value of the p-value obtained by the Shapiro-Wilk normality test for checking the normality assumption of the Box-Cox transformed marker in the healthy population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"pvalue.diseased.transformed"</code></td>
<td>
<p>the numerical value of the p-value obtained by the Shapiro-Wilk normality test for checking the normality assumption of the Box-Cox transformed marker in the diseased population.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mónica López-Ratón, Carmen Cadarso-Suárez, Elisa M. Molanes-López and Emilio Letón
</p>


<h3>References</h3>

<p>Gallop, R.J., Crits-Christoph, P., Muenz, L.R. and Tu, X.M. (2003). Determination and interpretation of the optimal operating point for ROC curves derived through generalized linear models. <em>Understanding Statistics</em> <b>2</b>, 219-242.
</p>
<p>Jiménez-Valverde, A. (2012). Insights into the area under the receiver operating characteristic curve (AUC) as a discrimination measure in species distribution modelling. <em>Global Ecology and Biogeography</em>  <b>21</b>, 498-507.
</p>
<p>Jiménez-Valverde, A. (2014). Threshold-dependence as a desirable attribute for discrimination assessment: implications for the evaluation of species distribution models. <em>Biodiversity Conservation</em> <b>23</b>, 369-385 
</p>
<p>Lai, C.Y., Tian, L. and Schisterman, E.F. (2012). Exact confidence interval estimation for the Youden index and its corresponding optimal cut-point. <em>Comput. Stat. Data Anal.</em> <b>56</b>, 1103-1114.
</p>
<p>López-Ratón, M., Cadarso-Suárez, C., Molanes-López, E.M. and Letón, E. (2016). Confidence intervals for the Symmetry point: an optimal cutpoint in continuous diagnostic tests. <em>Pharmaceutical Statistics</em> <b>15(2)</b>, 178-192.
</p>
<p>López-Ratón, M., Molanes-López, E.M., Letón, E. and Cadarso-Suárez, C. (2017). GsymPoint: An R Package to Estimate the Generalized Symmetry Point, an Optimal Cut-off Point for Binary Classification in Continuous Diagnostic Tests. <em>The R Journal</em> <b>9(1)</b>, 262-283.
</p>
<p>Metz, C.E. (1978). Basic Principles of ROC Analysis. <em>Seminars in Nuclear Medicine</em> <b>8</b>, 183-298.
</p>
<p>Molanes-López, E.M. and Letón, E. (2011). Inference of the Youden index and associated threshold using empirical likelihood for quantiles. <em>Statistics in Medicine</em> <b>30</b>, 2467-2480.
</p>
<p>Molanes-López, E.M., Van Keilegom, I. and Veraverbeke, N. (2009). Empirical likelihood for non-smooth criterion functions. <em>Scandinavian Journal of Statistics</em> <b>36</b>, 413-432.
</p>
<p>Remaley, A.T., Sampson, M.L., DeLeo, J.M., Remaley, N.A., Farsi, B.D. and Zweig, M.H. (1999). Prevalence-value-accuracy plots: a new method for comparing diagnostic tests based on misclassification costs. <em>Clinical Chemistry</em> <b>45</b>, 934-941.
</p>
<p>Riddle, D.L. and Stratford, P.W. (1999). Interpreting validity indexes for diagnostic tests: An illustration using the Berg Balance Test. <em>Physical Therapy</em> <b>79</b>, 939-948.
</p>
<p>Rutter, C.M. and Miglioretti, D.L. (2003). Estimating the accuracy of psychological scales using longitudinal data. <em>Biostatistics</em> <b>4</b>, 97-107.
</p>
<p>Thomas, D.R. and Grunkemeier, G.L. (1975). Confidence interval estimation of survival probabilities for censored data. <em>Journal of the American Statistical Association</em> <b>70</b>, 865-871.
</p>
<p>Wand, M.P. and Jones, M.C. (1995). <em>Kernel smoothing</em>. Chapman and Hall, London.
</p>
<p>Weerahandi, S. (1993). Generalized confidence intervals. <em>Journal of the American Statistical Association</em> <b>88</b>, 899-905. 
</p>
<p>Weerahandi, S. (1995). <em>Exact statistical methods for data analysis</em>. Springer-Verlag, New York.
</p>
<p>Zhou, W. and Jing, B.Y. (2003). Adjusted empirical likelihood method for quantiles. <em>Annals of the Institute of Statistical Mathematics</em> <b>55</b>, 689-703.
</p>


<h3>See Also</h3>

<p><code>control.gsym.point</code>, <code>summary.gsym.point</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(GsymPoint)

data(melanoma)

###########################################################
# marker: X
# status: group
###########################################################

###########################################################
# Generalized Pivotal Quantity Method ("GPQ"): 
# Original data normally distributed
###########################################################

gsym.point.GPQ.melanoma&lt;-gsym.point(methods = "GPQ", data = melanoma,
marker = "X", status = "group", tag.healthy = 0, categorical.cov = NULL, 
CFN = 1, CFP = 1, control = control.gsym.point(),confidence.level = 0.95, 
trace = FALSE, seed = FALSE, value.seed = 3, verbose = FALSE)

summary(gsym.point.GPQ.melanoma)

plot(gsym.point.GPQ.melanoma)


data(prostate)

###########################################################
# marker: marker
# status: status
###########################################################

###########################################################
# Generalized Pivotal Quantity Method ("GPQ"): 
# Box-Cox transformed data normally distributed
###########################################################

gsym.point.GPQ.prostate &lt;- gsym.point (methods = "GPQ", data = prostate,
marker = "marker", status = "status", tag.healthy = 0, categorical.cov = NULL, 
CFN = 1, CFP = 1, control = control.gsym.point(), confidence.level = 0.95, 
trace = FALSE, seed = FALSE, value.seed = 3, verbose = FALSE)

summary(gsym.point.GPQ.prostate)

plot(gsym.point.GPQ.prostate)


data(elastase)

###########################################################
# marker: elas
# status: status
###########################################################

###########################################################
# Generalized Pivotal Quantity Method ("GPQ"):
# Original data not normally distributed 
# Box-Cox transformed data not normally distributed
###########################################################

gsym.point.GPQ.elastase &lt;- gsym.point(methods = "GPQ", data = elastase, 
marker = "elas", status = "status", tag.healthy = 0, categorical.cov = NULL, 
CFN = 1, CFP = 1, control = control.gsym.point(), confidence.level = 0.95, 
trace = FALSE, seed = FALSE, value.seed = 3, verbose = FALSE) 

summary(gsym.point.GPQ.elastase)

plot(gsym.point.GPQ.elastase)

</code></pre>


</div>