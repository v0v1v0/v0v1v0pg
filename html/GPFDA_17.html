<div class="container">

<table style="width: 100%;"><tr>
<td>gpfr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gaussian process functional regression (GPFR) model</h2>

<h3>Description</h3>

<p>Use functional regression (FR) model for the mean structure and Gaussian
Process (GP) for the covariance structure. <br><br> Let 'n' be the number of
time points 't' of functional objects and 'nrep' the number of independent
replications in the sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpfr(
  response,
  time = NULL,
  uReg = NULL,
  fxReg = NULL,
  fyList = NULL,
  uCoefList = NULL,
  fxList = NULL,
  concurrent = TRUE,
  fxCoefList = NULL,
  gpReg = NULL,
  hyper = NULL,
  NewHyper = NULL,
  Cov = "pow.ex",
  gamma = 2,
  nu = 1.5,
  useGradient = T,
  rel.tol = 1e-10,
  trace.iter = 5,
  fitting = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>Response data. It can be an 'fd' object or a matrix with
'nrep' rows and 'n' columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Input 't' of functional objects. It is a numeric vector of
length 'n'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uReg</code></td>
<td>
<p>Scalar covariates for the FR model. It should be a matrix with
'nrep' rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fxReg</code></td>
<td>
<p>Functional covariates for the FR model. It can be a matrix with
'nrep' rows  and 'n' columns, an 'fd' object, or a list of matrices or 'fd'
objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fyList</code></td>
<td>
<p>A list to control the smoothing of response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uCoefList</code></td>
<td>
<p>A list to control the smoothing of the regression
coefficient function of the scalar covariates in the FR model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fxList</code></td>
<td>
<p>A list to control the smoothing of functional covariates in the
FR model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concurrent</code></td>
<td>
<p>Logical. If TRUE (default), concurrent functional
regression will be carried out; otherwise, the full functional regression
will be carried out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fxCoefList</code></td>
<td>
<p>A list to control the smoothing of the regression
coefficient function of functional covariates in the functional concurrent
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpReg</code></td>
<td>
<p>Covariates in the GP model. It should be a matrix, a numeric vector, 
an 'fd' object, a list of matrices or a list of 'fd' objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>Vector of initial hyperparameters. Default to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NewHyper</code></td>
<td>
<p>Vector of names of new hyperparameters from the customized
kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cov</code></td>
<td>
<p>Covariance function(s) to use. Options are: 'linear', 'pow.ex',
'rat.qu', and 'matern'. Default to 'power.ex'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Power parameter used in powered exponential kernel function. It
must be 0&lt;gamma&lt;=2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Smoothness parameter of the Matern class. It must be a positive
value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useGradient</code></td>
<td>
<p>Logical. If TRUE, first derivatives will be used in the
optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol</code></td>
<td>
<p>Relative tolerance passed to nlminb(). Default to be 1e-10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.iter</code></td>
<td>
<p>Print the processing of iterations of optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitting</code></td>
<td>
<p>Logical. If TRUE, fitting is carried out. Default to FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fyList</code> is a list with the following items:
</p>
 <ul>
<li> <p><code>time</code>: a sequence of time points; default to be 100
points from 0 to 1. </p>
</li>
<li> <p><code>nbasis</code>: number of basis functions used in
smoothing, default to be less than or equal to 23. </p>
</li>
<li> <p><code>norder</code>:
order of the functional curves; default to be 6. </p>
</li>
<li> <p><code>bSpline</code>:
logical. If TRUE (default), B-splines basis is used; otherwise, Fourier
basis is used. </p>
</li>
<li> <p><code>Pen</code>: default to be c(0,0), meaning that the
penalty is only applied to the second order derivative of the curve, with
no penalty for the zero-th and first order derivatives of the curve. </p>
</li>
<li>
<p><code>lambda</code>: smoothing parameter for the penalty, default to be 1e-4. </p>
</li>
</ul>
<p><code>fxList</code> is similar to <code>fyList</code>. However, it is a list of lists
to allow for different specifications for each functional covariate if
there are multiple ones.
</p>
<p><code>uCoefList</code> and <code>fxCoefList</code> are similar to
each other. Each one is expected to be a list of lists. If a list of one 
element is provided, then the items of this element are applied to each of 
the functional coefficients of scalar covariates and of functional covariates,
respectively. 
</p>
 <ul>
<li> <p><code>rtime</code>: range of time, default to be c(0,1). </p>
</li>
<li>
<p><code>nbasis</code>: nnumber of basis functions used in smoothing, default to be
less than or equal to 19. </p>
</li>
<li>  <p><code>norder</code>: order of the functional
curves; default to be 6. </p>
</li>
<li> <p><code>bSpline</code>: logical. If TRUE (default),
B-splines basis is used; otherwise, Fourier basis is used. </p>
</li>
<li>
<p><code>Pen</code>: default to be c(0,0). </p>
</li>
<li> <p><code>lambda</code>: smoothing parameter
for the penalty, default to be 1e4. </p>
</li>
<li> <p><code>bivar</code>:logical. Used for
non-concurrent models; if TRUE, bivariate basis will be used; if FALSE
(default), normal basis will be used; see details in
<code>bifdPar</code>. </p>
</li>
<li> <p><code>lambdas</code>: smoothing parameter for
the penalty of the additional basis, default to be 1. </p>
</li>
</ul>
<p> Note that all items
have default settings.
</p>


<h3>Value</h3>

<p>A list containing: </p>
 <dl>
<dt>hyper</dt>
<dd>
<p>Estimated hyperparameters</p>
</dd>
<dt>I</dt>
<dd>
<p>A vector of estimated standard deviation of hyperparameters</p>
</dd>
<dt>modellist</dt>
<dd>
<p>List of FR models fitted before Gaussian process</p>
</dd>
<dt>CovFun</dt>
<dd>
<p>Covariance function used</p>
</dd> <dt>gamma</dt>
<dd>
<p>Parameter 'gamma' used
in Gaussian process with powered exponential kernel</p>
</dd> <dt>nu</dt>
<dd>
<p>Parameter
'nu' used in Gaussian process with Matern kernel</p>
</dd> <dt>init_resp</dt>
<dd>
<p>Raw
response data</p>
</dd> <dt>resid_resp</dt>
<dd>
<p>Residual after the fitted values from FR
models have been taken out</p>
</dd> <dt>fitted</dt>
<dd>
<p>Fitted values</p>
</dd>
<dt>fitted.sd</dt>
<dd>
<p>Standard deviation of the fitted values</p>
</dd>
<dt>ModelType</dt>
<dd>
<p>The type of the model applied in the function.</p>
</dd>
<dt>lTrain</dt>
<dd>
<p>Training scalar covariates for the FR model</p>
</dd>
<dt>fTrain</dt>
<dd>
<p>Training functional covariates for the FR model</p>
</dd>
<dt>mfTrainfd</dt>
<dd>
<p>List of 'fd' objects from training data for FR model with
functional covariates</p>
</dd> <dt>gpTrain</dt>
<dd>
<p>Training data for Gaussian Process</p>
</dd>
<dt>time</dt>
<dd>
<p>Input time 't'</p>
</dd> <dt>iuuL</dt>
<dd>
<p>Inverse of covariance matrix for
uReg</p>
</dd> <dt>iuuF</dt>
<dd>
<p>Inverse of covariance matrix for fxReg</p>
</dd>
<dt>fittedFM</dt>
<dd>
<p>Fitted values from the FR model</p>
</dd> <dt>fyList</dt>
<dd>
<p>fyList
object used</p>
</dd> </dl>
<h3>References</h3>

 <ul>
<li>
<p> Ramsay, J., and Silverman, B. W. (2006),
“Functional Data Analysis”, 2nd ed., Springer, New York. </p>
</li>
<li>
<p> Shi, J.
Q., and Choi, T. (2011), “Gaussian Process Regression Analysis for
Functional Data”, CRC Press. </p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## See examples in vignette:
# vignette("gpfr", package = "GPFDA")
</code></pre>


</div>