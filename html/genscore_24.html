<div class="container">

<table style="width: 100%;"><tr>
<td>get_elts_ab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The R implementation to get the elements necessary for calculations for general a and b.</h2>

<h3>Description</h3>

<p>The R implementation to get the elements necessary for calculations for general <code class="reqn">a</code> and <code class="reqn">b</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_elts_ab(
  hdx,
  hpdx,
  x,
  a,
  b,
  setting,
  centered = TRUE,
  profiled_if_noncenter = TRUE,
  scale = "",
  diagonal_multiplier = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hdx</code></td>
<td>
<p>A matrix, <code class="reqn">h(\mathbf{x})</code> applied to the distance of x from the boundary of the domain, should be of the same dimension as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpdx</code></td>
<td>
<p>A matrix, <code class="reqn">h'(\mathbf{x})</code> applied to the distance of x from the boundary of the domain, should be of the same dimension as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code>n</code> by <code>p</code> matrix, the data matrix, where <code>n</code> is the sample size and <code>p</code> the dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A number, must be strictly larger than <code class="reqn">b/2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A number, must be &gt;= 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setting</code></td>
<td>
<p>A string that indicates the distribution type. Returned without being checked or used in the function body.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered</code></td>
<td>
<p>A boolean, whether in the centered setting (assume <code class="reqn">\boldsymbol{\mu}=\boldsymbol{\eta}=0</code>) or not. Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profiled_if_noncenter</code></td>
<td>
<p>A boolean, whether in the profiled setting (<code class="reqn">\lambda_{\boldsymbol{\eta}}=0</code>) if non-centered. Parameter ignored if <code>centered=TRUE</code>. Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A string indicating the scaling method. Returned without being checked or used in the function body. Default to <code>"norm"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal_multiplier</code></td>
<td>
<p>A number &gt;= 1, the diagonal multiplier.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the <code class="reqn">\boldsymbol{\Gamma}</code> matrix and the <code class="reqn">\boldsymbol{g}</code> vector for generalized score matching.
</p>
<p>Here, <code class="reqn">\boldsymbol{\Gamma}</code> is block-diagonal, and in the non-profiled non-centered setting, the <code class="reqn">j</code>-th block is composed of <code class="reqn">\boldsymbol{\Gamma}_{\mathbf{KK},j}</code>, <code class="reqn">\boldsymbol{\Gamma}_{\mathbf{K}\boldsymbol{\eta},j}</code> and its transpose, and finally <code class="reqn">\boldsymbol{\Gamma}_{\boldsymbol{\eta\eta},j}</code>. In the centered case, only <code class="reqn">\boldsymbol{\Gamma}_{\mathbf{KK},j}</code> is computed. In the profiled non-centered case, </p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Gamma}_{j}\equiv\boldsymbol{\Gamma}_{\mathbf{KK},j}-\boldsymbol{\Gamma}_{\mathbf{K}\boldsymbol{\eta},j}\boldsymbol{\Gamma}_{\boldsymbol{\eta}\boldsymbol{\eta},j}^{-1}\boldsymbol{\Gamma}_{\mathbf{K}\boldsymbol{\eta}}^{\top}.</code>
</p>

<p>Similarly, in the non-profiled non-centered setting, <code class="reqn">\boldsymbol{g}</code> can be partitioned <code class="reqn">p</code> parts, each with a <code class="reqn">p</code>-vector <code class="reqn">\boldsymbol{g}_{\mathbf{K},j}</code> and a scalar <code class="reqn">g_{\boldsymbol{\eta},j}</code>. In the centered setting, only <code class="reqn">\boldsymbol{g}_{\mathbf{K},j}</code> is needed. In the profiled non-centered case, </p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{g}_j\equiv\boldsymbol{g}_{\mathbf{K},j}-\boldsymbol{\Gamma}_{\mathbf{K}\boldsymbol{\eta},j}\boldsymbol{\Gamma}_{\boldsymbol{\eta\eta},j}^{-1}g_{\boldsymbol{\eta},j}.</code>
</p>

<p>The formulae for the pieces above are
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Gamma}_{\mathbf{KK},j}\equiv\frac{1}{n}\sum_{i=1}^nh\left(X_j^{(i)}\right){X_j^{(i)}}^{2a-2}{\boldsymbol{X}^{(i)}}^a{{\boldsymbol{X}^{(i)}}^a}^{\top},</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{\Gamma}_{\mathbf{K}\boldsymbol{\eta},j}\equiv-\frac{1}{n}\sum_{i=1}^nh\left(X_j^{(i)}\right){X_j^{(i)}}^{a+b-2}{\boldsymbol{X}^{(i)}}^a,</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{\Gamma}_{\boldsymbol{\eta\eta},j}\equiv\frac{1}{n}\sum_{i=1}^nh\left(X_j^{(i)}\right){X_j^{(i)}}^{2b-2},</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{g}_{\mathbf{K},j}\equiv\frac{1}{n}\sum_{i=1}^n\left(h'\left(X_j^{(i)}\right){X_j^{(i)}}^{a-1}+(a-1)h\left(X_j^{(i)}\right){X_j^{(i)}}^{a-2}\right){\boldsymbol{X}^{(i)}}^a+ah\left(X_j^{(i)}\right){X_j^{(i)}}^{2a-2}\boldsymbol{e}_{j,p},</code>
</p>

<p style="text-align: center;"><code class="reqn">\boldsymbol{g}_{\boldsymbol{\eta},j}\equiv\frac{1}{n}\sum_{i=1}^n-h'\left(X_j^{(i)}\right){X_j^{(i)}}^{b-1}-(b-1)h\left(X_j^{(i)}\right){X_j^{(i)}}^{b-2},</code>
</p>

<p>where <code class="reqn">\boldsymbol{e}_{j,p}</code> is the <code class="reqn">p</code>-vector with 1 at the <code class="reqn">j</code>-th position and 0 elsewhere.
</p>
<p>In the profiled non-centered setting, the function also returns <code class="reqn">t_1</code> and <code class="reqn">t_2</code> defined as
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{t}_1\equiv\boldsymbol{\Gamma}_{\boldsymbol{\eta\eta}}^{-1}\boldsymbol{g}_{\boldsymbol{\eta}},\quad\boldsymbol{t}_2\equiv\boldsymbol{\Gamma}_{\boldsymbol{\eta\eta}}^{-1}\boldsymbol{\Gamma}_{\mathbf{K}\boldsymbol{\eta}}^{\top},</code>
</p>

<p>so that <code class="reqn">\hat{\boldsymbol{\eta}}=\boldsymbol{t}_1-\boldsymbol{t}_2\mathrm{vec}(\hat{\mathbf{K}}).</code>
</p>


<h3>Value</h3>

<p>A list that contains the elements necessary for estimation.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered</code></td>
<td>
<p>The centered setting or not. Same as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>The scaling method. Same as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal_multiplier</code></td>
<td>
<p>The diagonal multiplier. Same as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonals_with_multiplier</code></td>
<td>
<p>A vector that contains the diagonal entries of <code class="reqn">\boldsymbol{\Gamma}</code> after applying the multiplier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setting</code></td>
<td>
<p>The setting. Same as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_K</code></td>
<td>
<p>The <code class="reqn">\boldsymbol{g}</code> vector. In the non-profiled non-centered setting, this is the <code class="reqn">\boldsymbol{g}</code> sub-vector corresponding to <code class="reqn">\mathbf{K}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma_K</code></td>
<td>
<p>The <code class="reqn">\boldsymbol{\Gamma}</code> matrix with no diagonal multiplier. In the non-profiled non-centered setting, this is the <code class="reqn">\boldsymbol{\Gamma}</code> sub-matrix corresponding to <code class="reqn">\mathbf{K}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_eta</code></td>
<td>
<p>Returned in the non-profiled non-centered setting. The <code class="reqn">\boldsymbol{g}</code> sub-vector corresponding to <code class="reqn">\boldsymbol{\eta}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma_K_eta</code></td>
<td>
<p>Returned in the non-profiled non-centered setting. The <code class="reqn">\boldsymbol{\Gamma}</code> sub-matrix corresponding to interaction between <code class="reqn">\mathbf{K}</code> and <code class="reqn">\boldsymbol{\eta}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma_eta</code></td>
<td>
<p>Returned in the non-profiled non-centered setting. The <code class="reqn">\boldsymbol{\Gamma}</code> sub-matrix corresponding to <code class="reqn">\boldsymbol{\eta}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1,t2</code></td>
<td>
<p>Returned in the profiled non-centered setting, where the <code class="reqn">\boldsymbol{\eta}</code> estimate can be retrieved from <code class="reqn">\boldsymbol{t_1}-\boldsymbol{t_2}\hat{\mathbf{K}}</code> after appropriate resizing.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 50
p &lt;- 30
eta &lt;- rep(0, p)
K &lt;- diag(p)
domain &lt;- make_domain("R+", p=p)
x &lt;- gen(n, setting="ab_1/2_7/10", abs=FALSE, eta=eta, K=K, domain=domain, finite_infinity=100, 
       xinit=NULL, seed=2, burn_in=1000, thinning=100, verbose=FALSE)
h_hp &lt;- get_h_hp("min_pow", 1.5, 3)
h_hp_dx &lt;- h_of_dist(h_hp, x, domain) # h and h' applied to distance from x to boundary
elts &lt;- get_elts_ab(h_hp_dx$hdx, h_hp_dx$hpdx, x, a=0.5, b=0.7, setting="ab_1/2_7/10",
            centered=TRUE, scale="norm", diag=1.5)
elts &lt;- get_elts_ab(h_hp_dx$hdx, h_hp_dx$hpdx, x, a=0.5, b=0.7, setting="ab_1/2_7/10",
            centered=FALSE, profiled_if_noncenter=TRUE, scale="norm", diag=1.7)
elts &lt;- get_elts_ab(h_hp_dx$hdx, h_hp_dx$hpdx, x, a=0.5, b=0.7, setting="ab_1/2_7/10",
            centered=FALSE, profiled_if_noncenter=FALSE, scale="norm", diag=1.9)
</code></pre>


</div>