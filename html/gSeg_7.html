<div class="container">

<table style="width: 100%;"><tr>
<td>gseg1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graph-Based Change-Point Detection for Single Change-Point</h2>

<h3>Description</h3>

<p>This function finds a break point in the sequence where the underlying distribution changes. It provides four graph-based test statistics.</p>


<h3>Usage</h3>

<pre><code class="language-R">gseg1(n, E, statistics=c("all","o","w","g","m"), n0=0.05*n, n1=0.95*n, pval.appr=TRUE,
 skew.corr=TRUE, pval.perm=FALSE, B=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations in the sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>The edge matrix (a "number of edges" by 2 matrix) for the similarity graph.  Each row contains the node indices of an edge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics</code></td>
<td>
<p>The scan statistic to be computed. A character indicating the type of of scan statistic desired. The default is <code>"all"</code>.
</p>
<p><code>"all"</code>: specifies to compute <b>a</b>ll of the scan statistics: original, weighted, generalized, and max-type;
</p>
<p><code>"o", "ori"</code> or <code>"original"</code>: specifies the <b>o</b>riginal edge-count scan statistic;
</p>
<p><code>"w"</code> or <code>"weighted"</code>: specifies the <b>w</b>eighted edge-count scan statistic;
</p>
<p><code>"g"</code> or <code>"generalized"</code>: specifies the <b>g</b>eneralized edge-count scan statistic; and
</p>
<p><code>"m"</code> or <code>"max"</code>: specifies the <b>m</b>ax-type edge-count scan statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>The starting index to be considered as a candidate for the change-point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>The ending index to be considered as a candidate for the change-point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.appr</code></td>
<td>
<p>If it is TRUE, the function outputs p-value approximation based on asymptotic properties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew.corr</code></td>
<td>
<p>This argument is useful only when pval.appr=TRUE.  If skew.corr is TRUE, the p-value approximation would incorporate skewness correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.perm</code></td>
<td>
<p>If it is TRUE, the function outputs p-value from doing B permutations, where B is another argument that you can specify. Doing permutation could be time consuming, so use this argument with caution as it may take a long time to finish the permutation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>This argument is useful only when pval.perm=TRUE.  The default value for B is 100.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list <code>scanZ</code> with <code>tauhat</code>, <code>Zmax</code>, and a vector of the scan statistics for each type of scan statistic specified. See below for more details.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tauhat</code></td>
<td>
<p>An estimate of the location of the change-point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zmax</code></td>
<td>
<p>The test statistic (maximum of the scan statistics).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>A vector of the original scan statistics (standardized counts) if statistic specified is "all" or "o".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zw</code></td>
<td>
<p>A vector of the weighted scan statistics (standardized counts) if statistic specified is "all" or "w".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>A vector of the generalized scan statistics (standardized counts) if statistic specified is "all" or "g".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>A vector of the max-type scan statistics (standardized counts) if statistic specified is "all" or "m".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A vector of raw counts of the original scan statistic. This output only exists if the statistic specified is "all" or "o".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rw</code></td>
<td>
<p>A vector of raw counts of the weighted scan statistic. This output only exists if statistic specified is "all" or "w".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.appr</code></td>
<td>
<p>The approximated p-value based on asymptotic theory for each type of statistic specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.perm</code></td>
<td>
<p>This output exists only when the argument pval.perm is TRUE . It is the permutation p-value from B permutations and appears for each type of statistic specified (same for perm.curve, perm.maxZs, and perm.Z).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.curve</code></td>
<td>
<p>A B by 2 matrix with the first column being critical values corresponding to the p-values in the second column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.maxZs</code></td>
<td>
<p>A sorted vector recording the test statistics in the B permutaitons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.Z</code></td>
<td>
<p>A B by n matrix with each row being the scan statistics from each permutaiton run.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>gSeg</code>, <code>gseg2</code>, <code>gseg1_discrete</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Example)
# Five examples, each example is a n-length sequence.
# Ei (i=1,...,5): an edge matrix representing a similarity graph constructed on the
# observations in the ith sequence.  
# Check '?gSeg' to see how the Ei's were constructed.


## E1 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in mean 
# in the middle of the sequence (tau = 100).

r1 = gseg1(n,E1, statistics="all")  
# output results based on all four statistics
# the scan statistics can be found in r1$scanZ
r1_a = gseg1(n,E1, statistics="w")  
# output results based on the weighted edge-count statistic
r1_b = gseg1(n,E1, statistics=c("w","g"))  
# output results based on the weighted edge-count statistic 
# and generalized edge-count statistic


## E2 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in mean 
# away from the middle of the sequence (tau=45).
r2 = gseg1(n,E2,statistic="all")


## E3 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in both mean 
# and variance away from the middle of the sequence (tau = 145).
r3=gseg1(n,E3,statistic="all")


## E4 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in both mean 
# and variance away from the middle of the sequence (tau = 50).
r4=gseg1(n,E4,statistic="all")

</code></pre>


</div>