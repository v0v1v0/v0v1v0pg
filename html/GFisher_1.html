<div class="container">

<table style="width: 100%;"><tr>
<td>p.GFisher</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Survival function of the generalized Fisher's p-value combination statistic.</h2>

<h3>Description</h3>

<p>Survival function of the generalized Fisher's p-value combination statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.GFisher(q, df, w, M, p.type = "two", method = "HYB", nsim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>- observed GFisher statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>- vector of degrees of freedom for inverse chi-square transformation for each p-value. If all df's are equal, it can be defined by the constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>- vector of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>- correlation matrix of the input statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.type</code></td>
<td>
<p>- "two" = two-sided p-values, "one" = one-sided p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>- "MR" = simulation-assisted moment ratio matching, "HYB" = moment ratio matching by quadratic approximation, "GB" = Brown's method with calculated variance. See details in the reference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>- number of simulation used in the "MR" method, default = 5e4.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>p-value of the observed GFisher statistic.
</p>


<h3>References</h3>

<p>Hong Zhang and Zheyang Wu. "Accurate p-Value Calculation for Generalized Fisher's Combination Tests Under Dependence", &lt;arXiv:2003.01286&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
n = 10
M = matrix(0.3, n, n) + diag(0.7, n, n)
zscore = matrix(rnorm(n),nrow=1)%*%chol(M)
pval = 2*(1-pnorm(abs(zscore)))
gf1 = stat.GFisher(pval, df=2, w=1)
gf2 = stat.GFisher(pval, df=1:n, w=1:n)
p.GFisher(gf1, df=2, w=1, M=M, method="HYB")
p.GFisher(gf1, df=2, w=1, M=M, method="MR", nsim=5e4)
p.GFisher(gf2, df=1:n, w=1:n, M=M, method="HYB")
p.GFisher(gf2, df=1:n, w=1:n, M=M, method="MR", nsim=5e4)
</code></pre>


</div>