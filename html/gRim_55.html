<div class="container">

<table style="width: 100%;"><tr>
<td>fit_ggm_grips</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Gaussian graphical models</h2>

<h3>Description</h3>

<p>Fit Gaussian graphical models using various algorithms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_ggm_grips(
  S,
  formula = NULL,
  nobs,
  K = NULL,
  maxit = 10000L,
  eps = 0.01,
  convcrit = 1,
  aux = list(),
  method = "ncd",
  print = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Sample covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Generators of model; a list of integer vectors or a 2
x p matrix of integers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>Number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Initial value of concentration matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convcrit</code></td>
<td>
<p>Convergence criterions. See section <code>details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aux</code></td>
<td>
<p>A list of form name=value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either <code>"ncd"</code> (default), <code>"covips"</code> or <code>"conips"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>Should output from fitting be printed?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Convergence criterion:
</p>

<ul>
<li>
<p> 1: max absolute difference between S and Sigmahat on edges.
</p>
</li>
<li>
<p> 2: difference in log likelihood divided by number of parameters in the
model (number of edges + number of nodes) between successive
iterations.
</p>
</li>
<li>
<p> 3: computed duality gap may turn negative due to rounding error, so its absolute value is returned.
This still provides upper bound on error of likelihood function.
</p>
</li>
</ul>
<p>Methods:
</p>

<ul>
<li>
<p> "ncd": Neighbour coordinate descent.
</p>
</li>
<li>
<p> "covips": IPS based on working with the covariance matrix.
</p>
</li>
<li>
<p> "conips": IPS based on working with the concentration matrix.
</p>
</li>
</ul>
<p>ncd is very fast but may fail to converge in rare cases. Both
covips and conips are guaranteed to converge provided the maximum
likelihood estimate exists, and covips are considerably faster than
conips.
</p>


<h3>Author(s)</h3>

<p>Søren Højsgaard, <a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">options("digits"=3)
data(math, package="gRbase")

S &lt;- cov(math)
nobs &lt;- nrow(math)
gl &lt;- list(1:3, 3:5)
em &lt;- matrix(c(1,2, 2,3, 1,3, 3,4, 3,5, 4,5), nrow=2)

EPS = 1e-2

fit_cov = fit_ggm_grips(S, gl, nobs=nobs, eps=EPS, method="cov")
fit_con = fit_ggm_grips(S, gl, nobs=nobs, eps=EPS, method="con")
fit_ncd = fit_ggm_grips(S, gl, nobs=nobs, eps=EPS, method="ncd")

K &lt;- solve(S)
(fit_con$K - K)  |&gt; abs() |&gt; max()
(fit_cov$K - K)  |&gt; abs() |&gt; max()
(fit_ncd$K - K)  |&gt; abs() |&gt; max()

</code></pre>


</div>