<div class="container">

<table style="width: 100%;"><tr>
<td>plot.gbmt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphics for a group-based multivariate trajectory model</h2>

<h3>Description</h3>

<p>Visualization of estimated and predicted trajectories.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gbmt'
plot(x, group=NULL, unit=NULL, x.names=NULL, n.ahead=0, bands=TRUE, conf=0.95,
  observed=TRUE, equal.scale=FALSE, trim=0, ylim=NULL, xlab="", ylab="", titles=NULL,
  add.grid=TRUE, col=NULL, transparency=-1, add.legend=TRUE, pos.legend=c(0,0),
  cex.legend=0.6, mar=c(5.1,4.1,4.1,2.1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>gbmt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Numerical value indicating the group for which the estimated trajectories should be displayed. If <code>NULL</code> (the default), the estimated trajectories for each group will be overlapped. Ignored if <code>unit</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>Character indicating the name of the unit for which estimated trajectories should be displayed. If <code>NULL</code> (the default), estimated group trajectories are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.names</code></td>
<td>
<p>Character including the names of the indicators for which the estimated trajectory should be displayed. If <code>NULL</code> (the default), estimated trajectories of all indicators are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.ahead</code></td>
<td>
<p>Non-negative integer value indicating the number of steps ahead to perform prediction. Default is 0, meaning no prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bands</code></td>
<td>
<p>Logical value indicating whether the prediction bands for should be drawn. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>Numerical value indicating the confidence level for the prediction bands. Default is 0.05. Ignored if <code>bands</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>Logical indicating whether observed trajectories should be drawn. Default is <code>TRUE</code>. Ignored if both <code>group</code> and <code>unit</code> are <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equal.scale</code></td>
<td>
<p>Logical indicating whether indicators should have the same scale across all groups. Default is <code>FALSE</code>. Ignored if <code>ylim</code> is not <code>NULL</code> or if <code>unit</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Numerical value indicating the proportion of extreme values to trim when either <code>equal.scale</code> is <code>TRUE</code>. Ignored if <code>observed</code> is <code>FALSE</code> or both <code>group</code> and <code>unit</code> are <code>NULL</code>. Default is 0, meaning no trim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>vector of length 2 indicating the limits of the y-axis, which will be applied to all indicators. If <code>NULL</code> (the default), it will be determined independently for each indicator based on data, unless <code>equal.scale</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for the x-axis, which will be applied to all indicators. Default is empty string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for the y-axis, which will be applied to all indicators. Default is empty strings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titles</code></td>
<td>
<p>vector of titles for the indicators. If <code>NULL</code>, the name of the indicators is used as title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.grid</code></td>
<td>
<p>Logical value indicating whether the grid should be added. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Character or numerical vector indicating the color of group trajectories. If <code>group</code> is not <code>NULL</code>, only the first valid color is considered. If <code>group</code> is <code>NULL</code> and there are more than <code>ng</code> valid colors, only the first <code>ng</code> valid colors are considered, otherwise valid colors are recycled to achieve a total number equal to <code>ng</code>. If <code>NULL</code> (the default), colors of group trajectories will be determined automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transparency</code></td>
<td>
<p>Numerical value between 0 and 100 indicating the trasparency of prediction regions. Value 75 is suggested. If negative, only prediction bands are displayed. Default is -1. Ignored if <code>group</code> is not <code>NULL</code> or <code>bands</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.legend</code></td>
<td>
<p>Logical value indicating whether the legend for groups should be added. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos.legend</code></td>
<td>
<p>Numerical vector of length 2 indicating the horizontal-vertical shift of the legend for groups with respect to the position 'topleft'. Default is <code>c(0,0)</code>. Ignored if <code>group</code> is not <code>NULL</code> or <code>add.legend</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>Expansion factor relative to the legend for groups. Default is 0.6. Ignored if <code>group</code> is not <code>NULL</code> or <code>add.legend</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>Numerical vector of length 4 indicating the margin size in the order: bottom, left, top, right, which will be applied to all indicators. Default is <code>c(5.1,4.1,4.1,2.1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further graphical parameters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>No return value.</p>


<h3>Note</h3>

<p>If <code>unit</code> is not <code>NULL</code>, values are back transformed to the original scales of indicators.</p>


<h3>See Also</h3>

<p>gbmt.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(agrisus2)

# names of indicators (just a subset for illustration)
varNames &lt;- c("TFP_2005", "NetCapital_GVA",
  "Income_rur", "Unempl_rur", "GHG_UAA", "GNB_N_UAA")

# model with 2 polynomial degrees and 3 groups
m3_2 &lt;- gbmt(x.names=varNames, unit="Country", time="Year", d=2, ng=3, data=agrisus2, scaling=4)

# group trajectories including 3 steps ahead prediction
mar0 &lt;- c(3.1,2.55,3.1,1.2)
plot(m3_2, n.ahead=3, mar=mar0)  ## overlapped groups
plot(m3_2, group=1, n.ahead=3, mar=mar0)  ## group 1
plot(m3_2, group=2, n.ahead=3, mar=mar0)  ## group 2
plot(m3_2, group=3, n.ahead=3, mar=mar0)  ## group 3

# same scale to ease comparisons
plot(m3_2, n.ahead=3, mar=mar0, equal.scale=TRUE)
plot(m3_2, group=1, n.ahead=3, mar=mar0, equal.scale=TRUE, trim=0.05)
plot(m3_2, group=2, n.ahead=3, mar=mar0, equal.scale=TRUE, trim=0.05)
plot(m3_2, group=3, n.ahead=3, mar=mar0, equal.scale=TRUE, trim=0.05)

# overlapped groups with transparency
plot(m3_2, group=1, n.ahead=3, mar=mar0, equal.scale=TRUE, trim=0.05,
  transparency=80)

# trajectories including 3 steps ahead prediction for unit 'Italy'
plot(m3_2, unit="Italy", n.ahead=3, transparency=80)
</code></pre>


</div>