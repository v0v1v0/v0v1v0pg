<div class="container">

<table style="width: 100%;"><tr>
<td>fdr_envelope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The FDR envelope</h2>

<h3>Description</h3>

<p>Calculate the FDR envelope based on the ATSE or IATSE algorithm
of Mrkvička and Myllymäki (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fdr_envelope(
  curve_sets,
  alpha = 0.05,
  alternative = c("two.sided", "less", "greater"),
  algorithm = c("IATSE", "ATSE"),
  lower = NULL,
  upper = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>curve_sets</code></td>
<td>
<p>A <code>curve_set</code> object or a list of <code>curve_set</code>
objects containing a data function and simulated functions from which the envelope is
to be constructed.
Also <code>envelope</code> objects of <span class="pkg">spatstat</span> are accepted instead of curve_set objects.
If an envelope object is given, it must contain the summary
functions from simulated patterns which can be achieved by setting
<code>savefuns = TRUE</code> when calling the <code>envelope</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level. The 100(1-alpha)% global envelope will be calculated
under the 'fwer' or 'fdr' control.
If a vector of values is provided, the global envelopes are calculated for each value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis.
Must be one of the following: "two.sided" (default), "less" or "greater".
The last two options only available for types <code>'rank'</code>, <code>'erl'</code>,
<code>'cont'</code> and <code>'area'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>The algorithm for the computation of the FDR envelope.
Either "IATSE" or "ATSE" standing for the iteratively adaptive two-stage
envelope and the adaptive two-stage envelope, respectively, see Mrkvička and Myllymäki (2023).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A single number (or a vector of suitable length) giving a lower bound
for the functions. Used only for the extension of the FDR envelope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A single number (or a vector of suitable length) giving an upper bound
for the functions. Used only for the extension of the FDR envelope.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Typical use of this function is through other functions.
<code>fdr_envelope(cset)</code> is the same as <code>global_envelope_test(cset, typeone = "fdr")</code>.
Functions such as <code>graph.fanova</code>, <code>graph.flm</code>, <code>frank.flm</code>
allow to use the FDR control by specifying <code>typeone = "fdr"</code> appropriately
(passing this to <code>global_envelope_test</code>).
</p>


<h3>References</h3>

<p>Mrkvička and Myllymäki (2023). False discovery rate envelopes. Statistics and Computing 33, 109. https://doi.org/10.1007/s11222-023-10275-7
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A GLM example
data(rimov)
nsim &lt;- 1000 # Number of simulations

res &lt;- graph.flm(nsim=nsim,
                 formula.full = Y~Year,
                 formula.reduced = Y~1,
                 curve_sets = list(Y=rimov),
                 factors = data.frame(Year = 1979:2014),
                 GET.args = list(typeone = "fdr"))
plot(res)

</code></pre>


</div>