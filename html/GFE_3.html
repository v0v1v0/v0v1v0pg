<div class="container">

<table style="width: 100%;"><tr>
<td>reSamGF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gross flows variance estimation.</h2>

<h3>Description</h3>

<p>Gross flows variance estimation according to resampling method (Bootstrap or Jackknife).
</p>


<h3>Usage</h3>

<pre><code class="language-R">reSamGF(
  sampleBase = NULL,
  nRepBoot = 500,
  model = "I",
  niter = 100,
  type = "Bootstrap",
  colWeights = NULL,
  nonrft = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sampleBase</code></td>
<td>
<p>An object of class data.frame or data.table containing the sample selected to estimate the gross flows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nRepBoot</code></td>
<td>
<p>The number of replicates for the bootstrap method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A character indicating the model that will be used for estime the gross flows. The available models are: 'I','II','III','IV'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>The number of iterations for the <code class="reqn">\eta_{i}</code> and <code class="reqn">p_{ij}</code> model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character indicating the resampling method <em>("Bootstrap" or "Jackknife")</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colWeights</code></td>
<td>
<p>The data colum name containing the sampling weights to be used on the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonrft</code></td>
<td>
<p>a logical value indicating the non response for the first time.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The resampling methods for variance estimation are:
</p>

<dl>
<dt>Bootstrap:</dt>
<dd>
<p> This technique allows to estimate the sampling distribution of almost any statistic by using random sampling methods. Bootstrapping is the practice of estimating properties of an statistic (such as its variance) by measuring those properties from it's approximated sample.</p>
</dd>
<dt>Jackknife:</dt>
<dd>
<p> The jackknife estimate of a parameter is found by systematically leaving out each observation from a dataset and calculating the estimate and then finding the average of these calculations. Given a sample of size <em>n</em>, the jackknife estimate is found by aggregating the estimates of each <em>n-1</em>-sized sub-sample.</p>
</dd>
</dl>
<h3>Value</h3>

<p><code>reSamGF</code> returns a list that contains the variance of each parameter of the selected model.
</p>


<h3>References</h3>

<p>Efron, B. (1979), ‘Computers and the theory of statistics: Thinking the unthinkable’, <em>SIAM review</em> <b>21</b>(4), pp. 460-480. <br>
Quenouille, M. H. (1949), ‘Problems in plane sampling’, <em>The Annals of Mathematical Statistics</em> pp. 355-375. <br>
Tukey, J. W. (1958), ‘Bias and confidence in not-quite large samples’, <em>Annals of Mathematical Statistics</em> <b>29</b>, pp. 614.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(TeachingSampling)
library(data.table)
# Colombia's electoral candidates in 2014
candidates_t0 &lt;- c("Clara","Enrique","Santos","Martha","Zuluaga","Blanco", "NoVoto")
candidates_t1 &lt;- c("Santos","Zuluaga","Blanco", "NoVoto")

N 	   &lt;- 100000
nCanT0  &lt;- length(candidates_t0)
nCanT1  &lt;- length(candidates_t1)

# Initial probabilities 
eta &lt;- matrix(c(0.10, 0.10, 0.20, 0.17, 0.28, 0.1, 0.05),
			   byrow = TRUE, nrow = nCanT0)
# Transition probabilities
P &lt;- matrix(c(0.10, 0.60, 0.15, 0.15,
			  0.30, 0.10, 0.25,	0.35,
			  0.34, 0.25, 0.16, 0.25,
			  0.25,	0.05, 0.35,	0.35,
			  0.10, 0.25, 0.45,	0.20,
			  0.12, 0.36, 0.22, 0.30,
			  0.10,	0.15, 0.30,	0.45),
	 byrow = TRUE, nrow = nCanT0)

citaMod &lt;- matrix(, ncol = nCanT1, nrow = nCanT0)
row.names(citaMod) &lt;- candidates_t0
colnames(citaMod) &lt;- candidates_t1

for(ii in 1:nCanT0){ 
 citaMod[ii,] &lt;- c(rmultinom(1, size = N * eta[ii,], prob = P[ii,]))
}

# # Model I
psiI   &lt;- 0.9
rhoRRI &lt;- 0.9
rhoMMI &lt;- 0.5

citaModI &lt;- matrix(nrow = nCanT0 + 1, ncol = nCanT1 + 1)
rownames(citaModI) &lt;- c(candidates_t0, "Non_Resp")
colnames(citaModI) &lt;- c(candidates_t1, "Non_Resp")

citaModI[1:nCanT0, 1:nCanT1] 		 &lt;- P * c(eta) * rhoRRI * psiI  
citaModI[(nCanT0 + 1), (nCanT1 + 1)]  &lt;- rhoMMI * (1-psiI) 
citaModI[1:nCanT0, (nCanT1 + 1)]  	 &lt;-  (1-rhoRRI) * psiI * rowSums(P * c(eta))
citaModI[(nCanT0 + 1), 1:nCanT1 ] 	 &lt;-  (1-rhoMMI) * (1-psiI) * colSums(P * c(eta))
citaModI   &lt;- round_preserve_sum(citaModI * N)
DBcitaModI &lt;- createBase(citaModI)

# Creating auxiliary information
DBcitaModI[,AuxVar := rnorm(nrow(DBcitaModI), mean = 45, sd = 10)]
# Selects a sample with unequal probabilities
res &lt;- S.piPS(n = 1200, as.data.frame(DBcitaModI)[,"AuxVar"])
sam &lt;- res[,1]
pik &lt;- res[,2]
DBcitaModISam &lt;- copy(DBcitaModI[sam,])
DBcitaModISam[,Pik := pik]

# Gross flows estimation
estima &lt;- estGF(sampleBase = DBcitaModISam, niter = 500, model = "II", colWeights = "Pik")
# gross flows variance estimation
varEstima &lt;- reSamGF(sampleBase = DBcitaModISam, type = "Bootstrap", nRepBoot = 100,
						model = "II", niter = 101,  colWeights = "Pik")
varEstima
</code></pre>


</div>