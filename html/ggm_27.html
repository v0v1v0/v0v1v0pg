<div class="container">

<table style="width: 100%;"><tr>
<td>fitConGraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting a Gaussian concentration graph model</h2>

<h3>Description</h3>

<p>Fits a concentration graph (a covariance selection model).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitConGraph(amat, S, n, cli = NULL, alg = 3, pri = FALSE, tol = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amat</code></td>
<td>
<p>a square Boolean matrix representing
the adjacency matrix of an UG</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the sample covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>an integer denoting the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cli</code></td>
<td>
<p>a list containing the cliques of the graph. The components
of the list are character vectors containing the names of the nodes in the
cliques. The names must match the names of the vertices. The
knowledge of the cliques is not needed. If the cliques are not specified
the function uses the algorithm
by Hastie et al. (2009, p. 446).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>The algorithm used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pri</code></td>
<td>
<p>If TRUE is verbose</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a small positive number indicating the tolerance
used in convergence tests.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithms for fitting concentration graph
models by maximum likelihood are discussed in Speed and Kiiveri (1986).
If the cliques are known
the function uses the iterative proportional
fitting algorithm described  by Whittaker (1990, p. 184).
If the cliques are not specified
the function uses the algorithm
by Hastie et al. (2009, p. 631ff).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Shat</code></td>
<td>
<p>the fitted covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev</code></td>
<td>
<p>the ‘deviance’ of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p>the iterations.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Giovanni M. Marchetti</p>


<h3>References</h3>

<p>Cox, D. R. &amp; Wermuth, N. (1996). <em>Multivariate
dependencies</em>. London: Chapman &amp; Hall.
</p>
<p>Hastie, T.,  Tibshirani, R. and Friedman, J. (2009).
<em>The elements of statistical learning.</em>  Springer Verlag: New York.
</p>
<p>Speed, T.P. and Kiiveri, H (1986). Gaussian
Markov distributions over finite graphs. <em>Annals of
Statistics</em>, 14, 138–150.
</p>
<p>Whittaker, J. (1990). <em>Graphical models in applied
multivariate statistics</em>. Chichester: Wiley.
</p>


<h3>See Also</h3>

<p><code>UG</code>, <code>fitDag</code>,
<code>marks</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## A model for the mathematics marks (Whittaker, 1990)
data(marks)
## A butterfly concentration graph
G &lt;- UG(~ mechanics*vectors*algebra + algebra*analysis*statistics)
fitConGraph(G, cov(marks), nrow(marks))
## Using the cliques

cl = list(c("mechanics", "vectors",   "algebra"), c("algebra", "analysis" ,  "statistics"))
fitConGraph(G, S = cov(marks), n = nrow(marks), cli = cl)
</code></pre>


</div>