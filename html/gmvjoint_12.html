<div class="container">

<table style="width: 100%;"><tr>
<td>logLik.joint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log-likelihood for joint model.</h2>

<h3>Description</h3>

<p>Calculate joint log-likelihood, degrees of freedom, AIC and BIC of 
joint model fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'joint'
logLik(object, conditional = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a <code>joint</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conditional</code></td>
<td>
<p>Logical. Should the conditional or observed data log-likelihood
be returned? See <strong>details</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments (none used).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculate the log-likelihood of a joint model of survival and multivariate longitudinal
data (i.e. a <code>joint</code> object). The argument <code>conditional</code> manages whether
or not the log-likelihood <em>conditional</em> on the random effects, or simply
the observed data log-likelihood is returned (the default, <code>conditional = FALSE</code>). 
</p>
<p>If <code>conditional = TRUE</code>, then the log-likelihood conditional on the random 
effects is returned. That is
</p>
<p style="text-align: center;"><code class="reqn">\log f(T_i, \Delta_i, Y_i|b_i;\Omega) = 
      \log f(Y_i|b_i; \Omega) + \log f(T_i, \Delta_i|b_i; \Omega) + \log f(b_i|\Omega)</code>
</p>

<p>If <code>conditional = FALSE</code>, then the observed data log-likelihood is returned i.e.
</p>
<p style="text-align: center;"><code class="reqn">\log\int f(Y_i|b_i; \Omega)f(T_i, \Delta_i|b_i; \Omega)f(b_i|\Omega)db_i.</code>
</p>

<p>Additionally, the degrees of freedom, <code class="reqn">\nu</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\nu = \code{length(vech(D))} + \sum_{k=1}^K\{P_k + P_{\sigma_k}\} + P_s,</code>
</p>

<p>where <code class="reqn">P_k</code> denotes the number of coefficients estimated for the <code class="reqn">k</code>th response,
and <code class="reqn">P_{\sigma_k}</code> the number of dispersion parameters estimated. <code class="reqn">P_s</code> denotes
the number of survival coefficients, i.e. the length of <code>c(zeta, gamma)</code>. Finally,
all covariance parameters are captured in <code>length(vech(D))</code>. 
</p>
<p>With the degrees of freedom, we can additionally compute AIC and BIC, which are defined
in no special way; and are calculated using the observed data log-likelihood.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>logLik</code>, a number which is the log-likelihood
of the fitted model <code>object</code>. This has multiple attributes: <code>df</code> which is the 
degrees of freedom, <code>df.residual</code>; the number of residual degrees of freedom;
<code>AIC</code> and <code>BIC</code> which are the Akaike or Bayes information criterion evaluated at 
either the conditional or observed log-likelihood (as requested by argument 
<code>conditional</code>).
</p>


<h3>Author(s)</h3>

<p>James Murray (<a href="mailto:j.murray7@ncl.ac.uk">j.murray7@ncl.ac.uk</a>)
</p>


<h3>References</h3>

<p>Henderson R, Diggle P, Dobson A. Joint modelling of longitudinal measurements and event time
data. <em>Biostatistics</em> 2000; <strong>1(4)</strong>; 465-480.
</p>
<p>Wulfsohn MS, Tsiatis AA. A joint model for survival and longitudinal data measured with error.
<em>Biometrics</em> 1997; <strong>53(1)</strong>; 330-339.
</p>


<h3>See Also</h3>

<p><code>extractAIC.joint</code> and <code>anova.joint</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Bivariate simulated data (2x Gaussian)
data &lt;- simData(n = 100,
   D = diag(c(.25, .04, .2, .02)),
   gamma = c(0.4, -0.2), theta = c(-2, .2))$data
fit &lt;- joint(list(
    Y.1 ~ time + cont + bin + (1 + time|id),
    Y.2 ~ time + cont + bin + (1 + time|id)
  ), Surv(survtime, status) ~ cont + bin, 
  data = data, 
  family = list('gaussian', 'gaussian'))

logLik(fit)

</code></pre>


</div>