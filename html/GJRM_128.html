<div class="container">

<table style="width: 100%;"><tr>
<td>LM.bpm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lagrange Multiplier Test (Score Test)</h2>

<h3>Description</h3>

 
<p>Before fitting a bivariate probit model, <code>LM.bpm</code> can be used to test the hypothesis of absence of endogeneity, 
correlated model equations/errors 
or non-random sample selection.</p>


<h3>Usage</h3>

<pre><code class="language-R">
LM.bpm(formula, data = list(), weights = NULL, subset = NULL, model, 
       hess = TRUE)

</code></pre>


<h3>Arguments</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A list of two formulas, one for equation 1 and the other for equation 2. <code>s</code> terms are used to specify 
smooth smooth functions of predictors. Note that if <code>model = "BSS"</code> then the first formula MUST refer 
to the selection equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame, list or environment containing the variables in the model.  If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of prior weights to be used in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Optional vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>It indicates the type of model to be used in the analysis. Possible values are "B" (bivariate model) and 
"BSS" (bivariate model with sample selection). The two marginal equations have probit links.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>If <code>FALSE</code> then the expected (rather than observed) information matrix is employed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This Lagrange multiplier test (also known as score test) is used here for testing the null 
hypothesis that <code class="reqn">\theta</code> is equal to 0 (i.e. no endogeneity, non-random sample selection or 
correlated model equations/errors, depending 
on  the model being fitted). Its main advantage is that it does 
not require an estimate of the model parameter vector under the alternative hypothesis. Asymptotically, it takes a Chi-squared distribution 
with one degree of freedom. Full details can be found in Marra et al. (2014) and Marra et al. (2017).
</p>


<h3>Value</h3>

<p>It returns a numeric p-value corresponding to the null hypothesis that the correlation, <code class="reqn">\theta</code>, is equal to 0.
</p>


<h3>WARNINGS</h3>

<p>This test's implementation is ONLY valid for bivariate binary probit models with normal errors.
</p>


<h3>Author(s)</h3>

<p>Maintainer: Giampiero Marra <a href="mailto:giampiero.marra@ucl.ac.uk">giampiero.marra@ucl.ac.uk</a>
</p>


<h3>References</h3>

<p>Marra G., Radice R. and Filippou P. (2017), Regression Spline Bivariate Probit Models: A Practical Approach to Testing for Exogeneity. <em>Communications in Statistics - Simulation and Computation</em>, 46(3), 2283-2298.
</p>
<p>Marra G., Radice R. and Missiroli S. (2014), Testing the Hypothesis of Absence of Unobserved Confounding in Semiparametric Bivariate Probit Models. <em>Computational Statistics</em>, 29(3-4), 715-741.
</p>


<h3>See Also</h3>

<p><code>gjrm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## see examples for gjrm
</code></pre>


</div>