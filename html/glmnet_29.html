<div class="container">

<table style="width: 100%;"><tr>
<td>coxgrad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute gradient for Cox model</h2>

<h3>Description</h3>

<p>Compute the gradient of the log partial likelihood at a particular fit for Cox
model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxgrad(eta, y, w, std.weights = TRUE, diag.hessian = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>Fit vector (usually from glmnet at a particular lambda).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Survival response variable, must be a <code>Surv</code> or
<code>stratifySurv</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Observation weights (default is all equal to 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.weights</code></td>
<td>
<p>If TRUE (default), observation weights are standardized
to sum to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag.hessian</code></td>
<td>
<p>If <code>TRUE</code>, compute the diagonal of the Hessian
of the log partial likelihood as well. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute a gradient vector at the fitted vector for the log partial likelihood.
This is like a residual vector, and useful for manual screening of
predictors for <code>glmnet</code> in applications where <code>p</code> is very large
(as in GWAS). Uses the Breslow approach to ties.
</p>
<p>This function is essentially a wrapper: it checks whether the response
provided is right-censored or (start, stop] survival data, and calls the
appropriate internal routine.
</p>


<h3>Value</h3>

<p>A single gradient vector the same length as <code>eta</code>. If
<code>diag.hessian=TRUE</code>, the diagonal of the Hessian is
included as an attribute "diag_hessian".
</p>


<h3>See Also</h3>

<p><code>coxnet.deviance</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
eta &lt;- rnorm(10)
time &lt;- runif(10, min = 1, max = 10)
d &lt;- ifelse(rnorm(10) &gt; 0, 1, 0)
y &lt;- survival::Surv(time, d)
coxgrad(eta, y)

# return diagonal of Hessian as well
coxgrad(eta, y, diag.hessian = TRUE)

# example with (start, stop] data
y2 &lt;- survival::Surv(time, time + runif(10), d)
coxgrad(eta, y2)

# example with strata
y2 &lt;- stratifySurv(y, rep(1:2, length.out = 10))
coxgrad(eta, y2)

</code></pre>


</div>