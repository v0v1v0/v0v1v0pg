<div class="container">

<table style="width: 100%;"><tr>
<td>fitTail</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>For fitting truncated distribution to the tails of data 
</h2>

<h3>Description</h3>

<p>There are two functions here. The function <code>fitTail()</code> which fits a truncated distribution to certain percentage of the tail of a response variable and the function  <code>fitTailAll()</code> which does a sequence of truncated fits. Plotting  the results from those fits is analogous to the Hill plot, Hill (1975).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitTail(y, family = "WEI3", percentage = 10, howmany = NULL, 
      type = c("right", "left"), ...)
   
fitTailAll(y, family = "WEI3", percentage = 10, howmany = NULL, 
      type = c("right", "left"), plot = TRUE, 
      print = TRUE, save = FALSE, start = 5, trace = 0,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The variable of interest
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a <code>gamlsss.family</code> distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentage</code></td>
<td>
<p>what percentage of the tail need to be modelled, default is 10%</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>howmany</code></td>
<td>
<p>how many observations in the tail needed. This is an alternative to <code>percentage</code>. If it specified it take over from the <code>percentage</code> argument otherwise <code>percentage</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>which tall needs checking the right (default) of the left</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to plot with default equal <code>TRUE</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>whether to print the coefficients with default equal <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>
<p>whether to save the fitted linear model with default equal <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>where to start fitting from the tail of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>0: no output 1: minimal 2: print estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>for further argument to the fitting function
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The idea here is to fit a truncated distribution to the tail of the data.
Truncated log-normal and Weibull distributions could be appropriate distributions. More details can be found in Chapter 6 of  "The Distribution Toolbox of GAMLSS" book  which can be found in   <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>Value</h3>

<p>A fitted gamlss model
</p>


<h3>Author(s)</h3>

<p>Bob Rigby <a href="mailto:r.rigby@gre.ac.uk">r.rigby@gre.ac.uk</a>, Mikis Stasinopoulos <a href="mailto:d.stasinopoulos@gre.ac.uk">d.stasinopoulos@gre.ac.uk</a> and Vlassios Voudouris 
</p>


<h3>References</h3>

<p>Hill B. M. (1975) A Simple General Approach to Inference About the Tail of a Distribution
<em>Ann. Statist.</em> Volume <b>3</b>, Number 5, pp 1163-1174.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code>loglogSurv</code>, <code>logSurv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(film90)
F90 &lt;- exp(film90$lborev1)# original scale
# trucated plots
# 10%
w403&lt;- fitTail(F90, family=WEI3)
qqnorm(resid(w403))
abline(0,1, col="red")

## Not run: 
# hill -sequential plot 10
w1&lt;-fitTailAll(F90)
# plot sigma
plot(w1[,2])
#-----------------
#LOGNO
l403&lt;- fitTail(F90, family=LOGNO)
plot(l403)
qqnorm(resid(l403))
abline(0,1)
#  hill -sequential plot 10
l1&lt;-fitTailAll(F90, family=LOGNO)
plot(l1[,2])
#-------------------------

## End(Not run)
</code></pre>


</div>