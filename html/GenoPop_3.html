<div class="container">

<table style="width: 100%;"><tr>
<td>FixedSites</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>FixedSites</h2>

<h3>Description</h3>

<p>This function counts the number of sites fixed for the alternative allele ("1") in a VCF file.
It processes the file in two modes: the entire file at once or in specified windows across the genome.
For batch processing, it uses <code>process_vcf_in_batches</code>. For windowed analysis, it uses a similar
approach but tailored to process specific genomic windows (<code>process_vcf_in_windows</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">FixedSites(
  vcf_path,
  threads = 1,
  write_log = FALSE,
  logfile = "log.txt",
  batch_size = 10000,
  window_size = NULL,
  skip_size = NULL,
  exclude_ind = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vcf_path</code></td>
<td>
<p>Path to the VCF file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>Number of threads to use for parallel processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write_log</code></td>
<td>
<p>Logical, indicating whether to write progress logs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logfile</code></td>
<td>
<p>Path to the log file where progress will be logged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>The number of variants to be processed in each batch
(used in batch mode only, default of 10,000 should be suitable for most use cases).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_size</code></td>
<td>
<p>Size of the window for windowed analysis in base pairs (optional).
When specified, <code>skip_size</code> must also be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_size</code></td>
<td>
<p>Number of base pairs to skip between windows (optional).
Used in conjunction with <code>window_size</code> for windowed analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_ind</code></td>
<td>
<p>Optional vector of individual IDs to exclude from the analysis.
If provided, the function will remove these individuals from the genotype matrix
before applying the custom function. Default is NULL, meaning no individuals are excluded.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function has two modes of operation:
</p>

<ol>
<li>
<p> Batch Mode: Processes the entire VCF file in batches to count the total number of fixed sites for the alternative allele. Suitable for a general overview of the entire dataset.
</p>
</li>
<li>
<p> Window Mode: Processes the VCF file in windows of a specified size and skip distance. This mode is useful for identifying regions with high numbers of fixed sites, which could indicate selective sweeps or regions of low recombination.
</p>
</li>
</ol>
<h3>Value</h3>

<p>In batch mode (no window_size or skip_size provided): A single integer representing the total number of fixed sites for the alternative allele across the entire VCF file.
In window mode (window_size and skip_size provided): A data frame with columns 'Chromosome', 'Start', 'End', and 'FixedSites', representing the count of fixed sites within each window.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Batch mode example
vcf_file &lt;- system.file("tests/testthat/sim.vcf.gz", package = "GenoPop")
index_file &lt;- system.file("tests/testthat/sim.vcf.gz.tbi", package = "GenoPop")
num_fixed_sites &lt;- FixedSites(vcf_file)

# Window mode example
fixed_sites_df &lt;- FixedSites(vcf_file, window_size = 100000, skip_size = 50000)

</code></pre>


</div>