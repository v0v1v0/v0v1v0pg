<div class="container">

<table style="width: 100%;"><tr>
<td>groupbn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>groupbn

</h2>

<h3>Description</h3>

<p>creates groupbn object
(determines an initial clustering based on a hierarchy with target variable and 'separated' variables separated, learns a Bayesian network from grouped data and saves discretization and pca parameters)

</p>


<h3>Usage</h3>

<pre><code class="language-R">groupbn(hierarchy, k, target, separate=NULL, separate.as.roots=FALSE,
X.quanti=NULL, X.quali=NULL, struct.alg="hc", boot=TRUE,
discretize=TRUE, arc.thresh=NULL,
debug=FALSE, R=100, seed=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hierarchy</code></td>
<td>
<p>a cluster object from ClustOfVar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>a positive integer number, the number of initial clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>a string, the name of the target variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separate</code></td>
<td>
<p>a vector of strings, names of variables that should be separated from the groups, such as age, sex,...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separate.as.roots</code></td>
<td>
<p>a boolean; if TRUE separated variables are used as roots in the network. Can be ignored if separate is empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.quanti</code></td>
<td>
<p>a numeric matrix of data,
or an object that can be coerced to such a matrix
(such as a numeric vector or a data frame with all numeric columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.quali</code></td>
<td>
<p>a categorical matrix of data,
or an object that can be coerced to such a matrix
(such as a character vector, a factor or a data frame with all factor columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>struct.alg</code></td>
<td>
<p>structure learning algorithm according to bnlearn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arc.thresh</code></td>
<td>
<p>threshold for bootstrap arcs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discretize</code></td>
<td>
<p>a boolean, if a network variables should be discretized before network learning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>boolean, if TRUE, a bootstrap based network averaging approach is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>a boolean,
if TRUE, debugging messages are printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of bootstrap replicates for model averaging, default is 100</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a random seed number</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class groupbn
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bn</code></td>
<td>
<p>a Bayesian Network structure of bn class from bnlearn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a Bayesian Network with fitted parameters of bn.fit class from bnlearn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.quanti</code></td>
<td>
<p>a data.frame containing only the quantitative variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.quali</code></td>
<td>
<p>a data.frame containing only the qualitative variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>a vector of positive integers, giving the cluster assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.data</code></td>
<td>
<p>a data.frame containing the cluster representants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>a string, the name of the target variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>separate</code></td>
<td>
<p>a vector of strings, names of variables that should be separated from the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca.param</code></td>
<td>
<p>the PCAmix used to determine the cluster representants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disc.param</code></td>
<td>
<p>the cutpoints used to discretize the cluster representants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>Different prediction scores for the target variable using the fitted network.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ann-Kristin Becker
</p>


<h3>References</h3>

<p>Becker A-K, DÃ¶rr M, Felix SB, Frost F, Grabe HJ, Lerch MM, et al. (2021) From heterogeneous healthcare data to disease-specific biomarker networks: A hierarchical Bayesian network approach. PLoS Comput Biol 17(2): e1008735. https://doi.org/10.1371/journal.pcbi.1008735</p>


<h3>See Also</h3>

<p><code>groupbn_refinement</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">#load example data
data(wine)
wine.test&lt;-wine[wine$Soil%in%c("Reference", "Env1"),1:29]
wine.test$Soil&lt;-factor(wine.test$Soil)
levels(wine.test$Soil)&lt;-c("0", "1")

#cluster data
hierarchy&lt;-hclustvar(X.quanti=wine.test[,3:29], X.quali=wine.test[,1:2])

#Learn group network among 5 clusters with "Soil" as target variable
wine.groupbn&lt;-groupbn(hierarchy, k=5, target="Soil", separate=NULL,
X.quanti=wine.test[,3:29], X.quali=wine.test[,1:2], seed=321)

#Plot network
plot(wine.groupbn)
</code></pre>


</div>