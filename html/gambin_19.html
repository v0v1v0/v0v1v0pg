<div class="container">

<table style="width: 100%;"><tr>
<td>dgambin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The mixture gambin distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the mixture 
gambin distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgambin(x, alpha, maxoctave, w = 1, log = FALSE)

pgambin(q, alpha, maxoctave, w = 1, lower.tail = TRUE, log.p = FALSE)

rgambin(n, alpha, maxoctave, w = 1)

qgambin(p, alpha, maxoctave, w = 1, lower.tail = TRUE, log.p = FALSE)

gambin_exp(alpha, maxoctave, w = 1, total_species)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of (non-negative integer) quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The shape parameter of the GamBin distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxoctave</code></td>
<td>
<p>The scale parameter of the GamBin distribution - which octave is the highest in the empirical dataset?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A vector of weights. Default, a single weight. This vector must of the same length as alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; If <code>TRUE</code>, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are P[X &lt;= x], otherwise, P[X &gt; x].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random values to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_species</code></td>
<td>
<p>The total number of species in the empirical dataset</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>dgambin</code> gives the distribution function of a mixture gambin, so all octaves sum to 1.
<code>gambin_exp</code> multiplies this by the total number of species to give the expected GamBin distribution in units of species, 
for comparison with empirical data.
</p>


<h3>Value</h3>

<p>A vector with length MaxOctave + 1 of the expected number of species in each octave
</p>


<h3>References</h3>

<p>Matthews, T. J., Borregaard, M. K., Gillespie, C. S., Rigal,
F., Ugland, K. I., Kr√ºger, R. F., . . . Whittaker, R. J. (2019) Extension of
the gambin model to multimodal species abundance distributions. Methods
in Ecology and Evolution, doi:10.1111/2041-210X.13122
</p>
<p>Matthews, T.J., Borregaard, M.K., Ugland, K.I., Borges, P.A.V, Rigal,
F., Cardoso, P. and Whittaker, R.J. (2014) The gambin model provides a
superior fit to species abundance distributions with a single free
parameter: evidence, implementation and interpretation. Ecography 37:
1002-1011.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## maxoctave is 4. So zero for x = 5
dgambin(0:5, 1, 4)

## Equal weightings between components
dgambin(0:5, alpha = c(1,2), maxoctave = c(4, 4))

## Zero weight on the second component, i.e. a 1 component model
dgambin(0:5, alpha = c(1,2), maxoctave = c(4, 4), w = c(1, 0))
expected = gambin_exp(4, 13, total_species = 200)
plot(expected, type = "l")

##draw random values from a gambin distribution 
x = rgambin(1e6, alpha = 2, maxoctave = 7) 
x = table(x)
freq = as.vector(x)
values = as.numeric(as.character(names(x)))
abundances = data.frame(octave=values, species = freq)
fit_abundances(abundances, no_of_components = 1)


</code></pre>


</div>