<div class="container">

<table style="width: 100%;"><tr>
<td>psbar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add Bars to GMT Mercator Map</h2>

<h3>Description</h3>

<p>Call GMT to add bars to a map and save in postscript format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psbar(x, cmd="-J -R -W1p -G180 -O -K", file=getOption("gmt.file"),
      ref=0, digits=getOption("digits"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data frame, matrix, or filename containing the data to be
plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmd</code></td>
<td>
<p>string of arguments passed to GMT shell command
<code>psxy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>filename where the map is saved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>reference latitude where height 1 renders a bar 1 degree
high.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>precision used when rounding the geographic
coordinates.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data are arranged in four columns: Lon, Lat, Width, and Height, in
that order.
</p>
<p>If <code>x</code> is a filename, the data should be tabular with or without
a header, separated by commas or whitespace. The first line is
interpreted as header if the first non-whitespace character is not
minus, point, or number.
</p>
<p>This function provides an alternative to <code>psxy -Sb</code> and
<code>psxy -Sr</code> for drawing bars on a Mercator map. See the
GMT documentation for details on <code>psxy</code> and other GMT
commands.
</p>


<h3>Value</h3>

<p>Null, but the map is annotated and saved in postscript format.
</p>
<p>The temporary GMT input file ‘<span class="file">bar.gmt</span>’ is saved in directory
<code>dirname(tempdir())</code>, for the user to view or edit. It is later
removed by <code>psclose()</code>.
</p>


<h3>Note</h3>

<p>This function does the necessary calculations to draw bars in standard
height given a Mercator-projected map. It is not intended for other
projections.
</p>
<p>The derivative of the Mercator projection is used to standardize the
bar height:
</p>
<p style="text-align: center;"><code class="reqn">
    f'\!(\theta) \;=\; \frac{1}
    {2\tan\;\!\!\!\Big(\!\frac\pi4\!+\!\frac\theta2\!\Big)
      \cos^2\!\Big(\!\frac\pi4\!+\!\frac\theta2\!\Big)}
  </code>
</p>

<p>where <code class="reqn">\theta</code> is latitude in radians and <code class="reqn">f(\theta)</code>
is the y-axis coordinate. The bar height at a given latitude is
<code class="reqn">h\times f'(\theta_{\mathrm{ref}})/f'(\theta)</code>,
where <code class="reqn">h</code> is the height passed by the user and
<code class="reqn">\theta_{\mathrm{ref}}</code> is a reference latitude where
<code class="reqn">h\!=\!1</code> renders a bar 1 degree high.
</p>


<h3>See Also</h3>

<p>Similar to <code>barplot</code> and <code>postscript</code> in
native <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> graphics.
</p>
<p><code>gmt</code>, <code>pscoast</code>, <code>psxy</code>,
<code>pstext</code>, <code>psbar</code>, and <code>psclose</code> work
together to draw maps.
</p>
<p><code>gmt-package</code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Draw map and save as "map.ps" in R working directory
gmt(demo.par)
pscoast(demo.coast)
psxy(demo.xy)
pstext(demo.text, "-J -R -F+f+a+j -O -K")
psbar(demo.bar, ref=66)
psclose()
# See directory gmt/example for details

## End(Not run)
</code></pre>


</div>