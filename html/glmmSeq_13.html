<div class="container">

<table style="width: 100%;"><tr>
<td>modelPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixed model effects plot</h2>

<h3>Description</h3>

<p>Plot to show differences between groups over time using base graphics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">modelPlot(
  object,
  geneName = NULL,
  x1var = NULL,
  x2var = NULL,
  x2shift = NULL,
  xlab = NA,
  ylab = geneName,
  plab = NULL,
  title = geneName,
  logTransform = is(object, "GlmmSeq"),
  shapes = 21,
  colours = "grey60",
  lineColours = "grey60",
  markerSize = 0.5,
  fontSize = NULL,
  alpha = 0.7,
  addModel = TRUE,
  addPoints = TRUE,
  modelSize = 2,
  modelColours = "royalblue",
  modelLineSize = 1,
  modelLineColours = modelColours,
  errorBarLwd = 2.5,
  errorBarLength = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A glmmSeq/lmmSeq object created by
<code>glmmSeq::glmmSeq()</code> or
<code>glmmSeq::lmmSeq()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneName</code></td>
<td>
<p>The gene/row name to be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1var</code></td>
<td>
<p>The name of the first (inner) x parameter, typically 'time'.
This is anticipated to have different values when matched by ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2var</code></td>
<td>
<p>The name of an optional second (outer) x parameter, which should
be a factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2shift</code></td>
<td>
<p>Amount to shift along x axis for each level of <code>x2var</code>. By
default the function will arrange each level of <code>x2var</code> side by side. Lower
values of <code>x2shift</code> or <code>x2shift = 0</code> can be used to overlap plots similar
to 'dodge' or stagger them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Title for the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Title for the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plab</code></td>
<td>
<p>Optional character vector of labels for p-values. These must
align with column names in <code>object@stats$pvals</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Plot title. If NULL gene name is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logTransform</code></td>
<td>
<p>Whether to perform a log10 transform on the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapes</code></td>
<td>
<p>The marker shapes (default=19)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colours</code></td>
<td>
<p>The marker colours (default='red') as vector or named vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lineColours</code></td>
<td>
<p>The line colours (default='grey60') as vector or named
vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markerSize</code></td>
<td>
<p>Size of markers (default=2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontSize</code></td>
<td>
<p>Plot font size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Line and marker opacity (default=0.7)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addModel</code></td>
<td>
<p>Whether to add the fit model with markers (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addPoints</code></td>
<td>
<p>Whether to add underlying data points (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelSize</code></td>
<td>
<p>Size of model points (default=2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelColours</code></td>
<td>
<p>Colour of model fit markers (default="black") as vector
or named vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelLineSize</code></td>
<td>
<p>Size of model points (default=1) as vector or named
vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelLineColours</code></td>
<td>
<p>Colour of model fit lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorBarLwd</code></td>
<td>
<p>Line width of error bars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorBarLength</code></td>
<td>
<p>Head width of error bars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to pass to
<code>graphics::plot()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a paired plot for matched samples
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(PEAC_minimal_load)

disp &lt;- apply(tpm, 1, function(x){
  (var(x, na.rm=TRUE)-mean(x, na.rm=TRUE))/(mean(x, na.rm=TRUE)**2)
})

MS4A1glmm &lt;- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),
                     countdata = tpm[1:2, ],
                     metadata = metadata,
                     dispersion = disp)

modelPlot(object=MS4A1glmm,
          geneName = 'MS4A1',
          x1var = 'Timepoint',
          x2var='EULAR_6m')
</code></pre>


</div>