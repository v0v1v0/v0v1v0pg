<div class="container">

<table style="width: 100%;"><tr>
<td>GSA.func</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gene set analysis without permutations</h2>

<h3>Description</h3>

<p>Determines the significance of pre-defined sets of genes  with respect to 
an outcome
variable, such as a group indicator, quantitative variable or  survival time.
This is the basic function called by GSA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GSA.func(x,y, genesets, genenames,geneset.names=NULL,
 method=c("maxmean","mean","absmean"),
 resp.type=c("Quantitative","Two class unpaired","Survival","Multiclass",
             "Two class paired",  "tCorr", "taCorr" ),
censoring.status=NULL,
 first.time = TRUE, return.gene.ind = TRUE, 
ngenes = NULL, gs.mat =NULL, gs.ind = NULL,
 catalog = NULL, catalog.unique =NULL, 
s0 = NULL, s0.perc = NULL, minsize = 15, maxsize= 500, restand = TRUE,
restand.basis=c("catalog","data")) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Data x: p by n matrix of features,
one observation per column (missing values allowed)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of response values:  1,2 for two class
problem, or 1,2,3 ... for multiclass problem, or real numbers for quantitative
or survival problems</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genesets</code></td>
<td>
<p>Gene set collection (a list)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genenames</code></td>
<td>
<p>Vector of genenames in expression dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneset.names</code></td>
<td>
<p>Optional vector of gene set names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for summarizing a gene set: "maxmean" (default), "mean" or "absmean"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp.type</code></td>
<td>
<p>Problem type: "quantitative" for a continuous parameter;
"Two class unpaired" ; "Survival" for censored survival outcome; "Multiclass" :
more than 2 groups; "Two class paired" for paired outcomes, coded -1,1 (first pair), -2,2 (second pair), etc  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censoring.status</code></td>
<td>
<p>Vector of censoring status values for survival problems,
1 mean death or failure, 0 means censored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first.time</code></td>
<td>
<p>internal use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.gene.ind</code></td>
<td>
<p>internal use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngenes</code></td>
<td>
<p>internal use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gs.mat</code></td>
<td>
<p>internal use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gs.ind</code></td>
<td>
<p>internal use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catalog</code></td>
<td>
<p>internal use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catalog.unique</code></td>
<td>
<p>internal use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>
<p>Exchangeability factor  for denominator of test statistic; Default
is automatic choice</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0.perc</code></td>
<td>
<p>Percentile of standard  deviation values to use for s0; default is
automatic choice; -1 means s0=0 (different from s0.perc=0, meaning
s0=zeroeth percentile of  standard  deviation values= min of sd values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minsize</code></td>
<td>
<p>Minimum number of genes in  genesets to be  considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsize</code></td>
<td>
<p>Maximum number of genes in  genesets to be considered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restand</code></td>
<td>
<p>Should restandardization be done? Default TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restand.basis</code></td>
<td>
<p>What should be used to do the  restandardization?
The set of genes in the genesets ("catalog", the default) or the
genes in the data set ("data")</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Carries out a Gene set analysis, computing the gene set scores.
This function does not do any permutations for estimation of  false discovery rates.
GSA calls this function to estimate  FDRs.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table><tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Gene set scores  for each gene set</p>
</td>
</tr></table>
<p>,
</p>
<table><tr style="vertical-align: top;">
<td><code>norm.scores</code></td>
<td>
<p>Gene set scores  transformed by the inverse Gaussian cdf</p>
</td>
</tr></table>
<p>,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>Means of gene  expression values for each sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Standard deviation of gene  expression values for each sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.ind</code></td>
<td>
<p>List indicating whch genes in each positive  gene set
had positive individual scores, and similarly for negative gene sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geneset.names</code></td>
<td>
<p>Names of the gene sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperms</code></td>
<td>
<p>Number of permutations used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.scores</code></td>
<td>
<p>Individual gene scores (eg t-statistics for two class problem)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>
<p>Computed  exchangeability factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0.perc</code></td>
<td>
<p>Computed percentile of standard deviation values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand.info</code></td>
<td>
<p> Information computed  used in the restandardization process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used (from call to GSA.func)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call to GSA</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Robert Tibshirani</p>


<h3>References</h3>

<p>Efron, B. and   Tibshirani, R.  
On testing the significance of sets of genes. Stanford tech report rep 2006.
http://www-stat.stanford.edu/~tibs/ftp/GSA.pdf</p>


<h3>Examples</h3>

<pre><code class="language-R">
######### two class unpaired comparison
# y must take values 1,2

set.seed(100)
x&lt;-matrix(rnorm(1000*20),ncol=20)
dd&lt;-sample(1:1000,size=100)

u&lt;-matrix(2*rnorm(100),ncol=10,nrow=100)
x[dd,11:20]&lt;-x[dd,11:20]+u
y&lt;-c(rep(1,10),rep(2,10))


genenames=paste("g",1:1000,sep="")

#create some random gene sets
genesets=vector("list",50)
for(i in 1:50){
 genesets[[i]]=paste("g",sample(1:1000,size=30),sep="")
}
geneset.names=paste("set",as.character(1:50),sep="")

GSA.func.obj&lt;-GSA.func(x,y, genenames=genenames, genesets=genesets,  resp.type="Two class unpaired")




#to use  "real" gene set collection, we read it in from a gmt file:
# 
# geneset.obj&lt;- GSA.read.gmt("file.gmt")
# 
# where file.gmt is a gene set collection from GSEA collection or
#  or the website http://www-stat.stanford.edu/~tibs/GSA, or one
# that you have created yourself. Then

#   GSA.func.obj&lt;-GSA.func(x,y, genenames=genenames,
#                          genesets=geneset.obj$genesets,
#                          resp.type="Two class unpaired")
#
#



</code></pre>


</div>