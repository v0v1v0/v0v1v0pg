<div class="container">

<table style="width: 100%;"><tr>
<td>fdsa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finite difference stochastic approximation inference</h2>

<h3>Description</h3>

<p>Finite difference stochastic approximation (FDSA) inference for the g-and-k or g-and-h distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">fdsa(
  x,
  N,
  model = c("gk", "generalised_gh", "tukey_gh", "gh"),
  logB = FALSE,
  theta0,
  batch_size = 100,
  alpha = 1,
  gamma = 0.49,
  a0 = 1,
  c0 = NULL,
  A = 100,
  theta_min = c(-Inf, ifelse(logB, -Inf, 1e-05), -Inf, 1e-05),
  theta_max = c(Inf, Inf, Inf, Inf),
  silent = FALSE,
  plotEvery = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of iterations to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Which model to check: "gk", "generalised_gh" or "tukey_gh".
For backwards compatibility, "gh" acts the same as "generalised_gh".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logB</code></td>
<td>
<p>When true, the second parameter is log(B) rather than B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>Vector of initial value for 4 parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>Mini-batch size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Gain decay for step size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Gain decay for finite difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>Multiplicative step size tuning parameter (or vector of 4 values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c0</code></td>
<td>
<p>Multiplicative finite difference step tuning parameter (or vector of 4 values).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Additive step size tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_min</code></td>
<td>
<p>Vector of minimum values for each parameter.
Note: for <code>model=="tukey_gh"</code> it's usually advisable to rule out h=0 as this case sometimes causes optimisation problems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_max</code></td>
<td>
<p>Vector of maximum values for each parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>When <code>FALSE</code> (the default) a progress bar and intermediate results plots are shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotEvery</code></td>
<td>
<p>How often to plot the results if <code>silent==FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fdsa</code> performs maximum likelihood inference for iid data from a g-and-k or g-and-h distribution, using simulataneous perturbation stochastic approximation. This should be faster than directly maximising the likelihood.
</p>


<h3>Value</h3>

<p>Matrix whose rows are FDSA states: the initial state <code>theta0</code> and N subsequent states.
The final row is the MLE estimate.
</p>


<h3>References</h3>

<p>D. Prangle gk: An R package for the g-and-k and generalised g-and-h distributions, 2017.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
x = rgk(10, A=3, B=1, g=2, k=0.5) ##An unusually small dataset for fast execution of this example
out = fdsa(x, N=100, theta0=c(mean(x),sd(x),0,1E-5), theta_min=c(-5,1E-5,-5,1E-5),
    theta_max=c(5,5,5,5))
</code></pre>


</div>