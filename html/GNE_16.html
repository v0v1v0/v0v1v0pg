<div class="container">

<table style="width: 100%;"><tr>
<td>CER</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constrained Equation Reformulation</h2>

<h3>Description</h3>

<p>functions of the Constrained Equation Reformulation of the GNEP
</p>


<h3>Usage</h3>

<pre><code class="language-R">
funCER(z, dimx, dimlam, 
	grobj, arggrobj, 
	constr, argconstr,  
	grconstr, arggrconstr, 
	dimmu, joint, argjoint,
	grjoint, arggrjoint,
	echo=FALSE)

jacCER(z, dimx, dimlam,
	heobj, argheobj, 
	constr, argconstr,  
	grconstr, arggrconstr, 
	heconstr, argheconstr,
	dimmu, joint, argjoint,
	grjoint, arggrjoint,
	hejoint, arghejoint,
	echo=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a numeric vector z containing x then lambda values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimx</code></td>
<td>
<p>dimension of x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimlam</code></td>
<td>
<p>dimension of lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grobj</code></td>
<td>
<p>gradient of the objective function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arggrobj</code></td>
<td>
<p>a list of additional arguments of the objective gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constr</code></td>
<td>
<p>constraint function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argconstr</code></td>
<td>
<p>a list of additional arguments of the constraint function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grconstr</code></td>
<td>
<p>gradient of the constraint function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arggrconstr</code></td>
<td>
<p>a list of additional arguments of the constraint gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimmu</code></td>
<td>
<p>a vector of dimension for <code class="reqn">mu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint</code></td>
<td>
<p>joint function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argjoint</code></td>
<td>
<p>a list of additional arguments of the joint function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grjoint</code></td>
<td>
<p>gradient of the joint function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arggrjoint</code></td>
<td>
<p>a list of additional arguments of the joint gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heobj</code></td>
<td>
<p>Hessian of the objective function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argheobj</code></td>
<td>
<p>a list of additional arguments of the objective Hessian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heconstr</code></td>
<td>
<p>Hessian of the constraint function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argheconstr</code></td>
<td>
<p>a list of additional arguments of the constraint Hessian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hejoint</code></td>
<td>
<p>Hessian of the joint function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arghejoint</code></td>
<td>
<p>a list of additional arguments of the joint Hessian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>echo</code></td>
<td>
<p>a logical to show some traces.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute the H function or the Jacobian of the H function defined in Dreves et al.(2009).
</p>

<dl>
<dt><b>Arguments of the H function</b></dt>
<dd>	
<p>The arguments which are functions must respect the following features
</p>

<dl>
<dt><code>grobj</code></dt>
<dd>
<p>The gradient <code class="reqn">Grad Obj</code> of an objective function <code class="reqn">Obj</code> (to be minimized) must have 3 arguments for <code class="reqn">Grad Obj(z, playnum, ideriv)</code>: vector <code>z</code>, player number, derivative index
, and optionnally additional arguments in <code>arggrobj</code>.
</p>
</dd>
<dt><code>constr</code></dt>
<dd>
<p>The constraint function <code class="reqn">g</code> must have 2 arguments: vector <code>z</code>, player number,
such that <code class="reqn">g(z, playnum) &lt;= 0</code>. Optionnally, <code class="reqn">g</code> may have additional arguments in <code>argconstr</code>.
</p>
</dd>
<dt><code>grconstr</code></dt>
<dd>
<p>The gradient of the constraint function <code class="reqn">g</code>  must have 3 arguments: vector <code>z</code>, player number, derivative index,
and optionnally additional arguments in <code>arggrconstr</code>.
</p>
</dd>
</dl>
</dd>
<dt><b>Arguments of the Jacobian of H</b></dt>
<dd>	
<p>The arguments which are functions must respect the following features
</p>

<dl>
<dt><code>heobj</code></dt>
<dd>
<p>It must have 4 arguments: vector <code>z</code>, player number, two derivative indexes.</p>
</dd>
<dt><code>heconstr</code></dt>
<dd>
<p>It must have 4 arguments: vector <code>z</code>, player number, two derivative indexes.</p>
</dd>
</dl>
<p>Optionnally, <code>heobj</code> and <code>heconstr</code> can have additional arguments <code>argheobj</code> and <code>argheconstr</code>.
</p>
</dd>
</dl>
<p>See the example	below.
</p>


<h3>Value</h3>

<p>A vector for <code>funCER</code> or a matrix for <code>jacCER</code>.
</p>


<h3>Author(s)</h3>

<p>Christophe Dutang
</p>


<h3>References</h3>

<p>Dreves, A., Facchinei, F., Kanzow, C. and Sagratella, S. (2011), 
<em>On the solutions of the KKT conditions of generalized Nash equilibrium problems</em>,
SIAM Journal on Optimization.
</p>
<p>F. Facchinei, A. Fischer and V. Piccialli (2009), 
<em>Generalized Nash equilibrium problems and Newton methods</em>,
Math. Program.
</p>


<h3>See Also</h3>

<p>See also <code>GNE.ceq</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">


#-------------------------------------------------------------------------------
# (1) Example 5 of von Facchinei et al. (2007)
#-------------------------------------------------------------------------------

dimx &lt;- c(1, 1)
#Gr_x_j O_i(x)
grobj &lt;- function(x, i, j)
{
	if(i == 1)
		res &lt;- c(2*(x[1]-1), 0)
	if(i == 2)
		res &lt;- c(0, 2*(x[2]-1/2))
	res[j]	
}
#Gr_x_k Gr_x_j O_i(x)
heobj &lt;- function(x, i, j, k)
	2 * (i == j &amp;&amp; j == k)

dimlam &lt;- c(1, 1)
#constraint function g_i(x)
g &lt;- function(x, i)
	sum(x[1:2]) - 1
#Gr_x_j g_i(x)
grg &lt;- function(x, i, j)
	1
#Gr_x_k Gr_x_j g_i(x)
heg &lt;- function(x, i, j, k)
	0


x0 &lt;- rep(0, sum(dimx))
z0 &lt;- c(x0, 2, 2, max(10, 5-g(x0, 1) ), max(10, 5-g(x0, 2) ) )

#true value is (3/4, 1/4, 1/2, 1/2)
funCER(z0, dimx, dimlam, grobj=grobj, 
	constr=g, grconstr=grg)

jacCER(z0, dimx, dimlam, heobj=heobj, 
	constr=g, grconstr=grg, heconstr=heg)



#-------------------------------------------------------------------------------
# (2) Duopoly game of Krawczyk and Stanislav Uryasev (2000)
#-------------------------------------------------------------------------------


#constants
myarg &lt;- list(d= 20, lambda= 4, rho= 1)

dimx &lt;- c(1, 1)
#Gr_x_j O_i(x)
grobj &lt;- function(x, i, j, arg)
{
	res &lt;- -arg$rho * x[i]
	if(i == j)
	res &lt;- res + arg$d - arg$lambda - arg$rho*(x[1]+x[2])
	-res
}
#Gr_x_k Gr_x_j O_i(x)
heobj &lt;- function(x, i, j, k, arg)
	arg$rho * (i == j) + arg$rho * (j == k)	


dimlam &lt;- c(1, 1)
#constraint function g_i(x)
g &lt;- function(x, i)
	-x[i]
#Gr_x_j g_i(x)
grg &lt;- function(x, i, j)
	-1*(i == j)
#Gr_x_k Gr_x_j g_i(x)
heg &lt;- function(x, i, j, k)
	0

#true value is (16/3, 16/3, 0, 0) 

x0 &lt;- rep(0, sum(dimx))
z0 &lt;- c(x0, 2, 2, max(10, 5-g(x0, 1) ), max(10, 5-g(x0, 2) ) )


funCER(z0, dimx, dimlam, grobj=grobj, arggrobj=myarg, 
	constr=g, grconstr=grg)

jacCER(z0, dimx, dimlam, heobj=heobj, 
	argheobj=myarg, constr=g, grconstr=grg, heconstr=heg)





</code></pre>


</div>