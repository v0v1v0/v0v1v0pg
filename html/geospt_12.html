<div class="container">

<table style="width: 100%;"><tr>
<td>est.variograms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Variogram Estimator
</h2>

<h3>Description</h3>

<p>Calculate empirical <code>variogram</code> estimates. An object of class
variogram contains empirical variogram estimates which are generated
from a point object and a pair object. A variogram object is stored
as a data frame containing seven columns: <code>lags</code>, <code>bins</code>,
<code>classic</code>, <code>robust</code>,<code>med</code>, <code>trim</code> and
<code>n</code>. The length of each vector is equal to the number of lags
in the pair object used to create the variogram object, say l. The
<code>lags</code> vector contains the lag numbers for each lag, beginning
with one (1) and going to the number of lags (l). The <code>bins</code> vector
contains the spatial midpoint of each lag. The <code>classic</code>, <code>robust</code>,
<code>med</code> and <code>trimmed.mean</code> vectors contain: the classical,
robust, median, and trimmed mean, respectively, which are given, respectively,
by (see Cressie, 1993, p. 75)
</p>
<p>classical
</p>
<p style="text-align: center;"><code class="reqn">
\gamma_{c}(h)=\frac{1}{n}\sum_{(i,j)\in 
    N(h)}(z(x_{i})-z(x_{j}))^{2}
</code>
</p>

<p>robust,
</p>
<p style="text-align: center;"><code class="reqn">
\gamma_{m}(h)=\frac{(\frac{1}{n}\sum_{(i,j)\in N(h)}
    (\sqrt{|z(x_{i})-z(x_{j})|}))^{4}}{0.457+\frac{0.494}{n}}
</code>
</p>

<p>median
</p>
<p style="text-align: center;"><code class="reqn">
\gamma_{me}(h)=\frac{\mbox(median_{(i,j)\in N(h)}
     (\sqrt{|z(x_{i})-z(x_{j})|}))^{4}}{0.457+\frac{0.494}{|N(h)|}}
</code>
</p>

<p>and trimmed mean
</p>
<p style="text-align: center;"><code class="reqn">
\gamma_{tm}(h)=\frac{(trimmed.mean_{(i,j)\in N(h)}(\sqrt{|z(x_{i})-z(x_{j})|}))^{4}}{0.457+\frac{0.494}{|N(h)|}}
</code>
</p>

<p>The <code class="reqn">n</code> vector contains the number <code class="reqn">|N(h)|</code> of pairs of points
in each lag <code class="reqn">N(h)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">est.variograms(point.obj, pair.obj, a1, a2, trim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>point.obj</code></td>
<td>
<p>a point object generated by <code>point()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pair.obj</code></td>
<td>
<p>a pair object generated by <code>pair()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1</code></td>
<td>
<p>a variable to calculate semivariogram for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2</code></td>
<td>
<p>an optional variable name, if entered cross variograms will be created between <code>a1</code> and <code>a2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>percent of trimmed mean</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A variogram object: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>vector of lag identifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>vector of midpoints of each lag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classic</code></td>
<td>
<p>vector of classic variogram estimates for each lag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>vector of robust variogram estimates for each lag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>med</code></td>
<td>
<p>vector of median variogram estimates for each lag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trimmed.mean</code></td>
<td>
<p>vector of trimmed mean variogram estimates for each lag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>vector of the number of pairs in each lag</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Based on the <code>est.variogram</code> function of the <code>sgeostat</code> package
</p>


<h3>References</h3>

<p>Bardossy, A., 2001. <em>Introduction to Geostatistics</em>. University of Stuttgart.
</p>
<p>Cressie, N.A.C., 1993. <em>Statistics for Spatial Data</em>. Wiley.
</p>
<p>Majure, J., Gebhardt, A., 2009. sgeostat: An Object-oriented Framework for Geostatistical Modeling in S+. R package version 1.0-23.
</p>
<p>Roustant O., Dupuy, D., Helbert, C., 2007. <em>Robust Estimation of the Variogram in Computer Experiments</em>. Ecole des Mines, Departement 3MI, 158 Cours Fauriel, 42023 Saint-Etienne, France
</p>


<h3>See Also</h3>

<p><code>point</code>, <code>pair</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sgeostat, pos=which(search()=="package:gstat")+1)
data(maas)
maas.point &lt;- point(maas) 
maas.pair &lt;- pair(maas.point, num.lags=24, maxdist=2000) 
maas.v &lt;- est.variograms(maas.point,maas.pair,'zinc',trim=0.1) 
maas.v
</code></pre>


</div>