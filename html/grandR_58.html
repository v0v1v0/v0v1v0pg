<div class="container">

<table style="width: 100%;"><tr>
<td>EstimateRegulation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate regulation from snapshot experiments</h2>

<h3>Description</h3>

<p>Compute the posterior log2 fold change distributions of RNA synthesis and degradation
</p>


<h3>Usage</h3>

<pre><code class="language-R">EstimateRegulation(
  data,
  name.prefix = "Regulation",
  contrasts,
  reference.columns = NULL,
  slot = DefaultSlot(data),
  time.labeling = Design$dur.4sU,
  time.experiment = NULL,
  ROPE.max.log2FC = 0.25,
  sample.f0.in.ss = TRUE,
  N = 10000,
  N.max = N * 10,
  CI.size = 0.95,
  seed = 1337,
  dispersion = NULL,
  sample.level = 2,
  correct.labeling = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the grandR object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.prefix</code></td>
<td>
<p>the prefix for the new analysis name; a dot and the column names of the contrast matrix are appended; can be NULL (then only the contrast matrix names are used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>contrast matrix that defines all pairwise comparisons, generated using GetContrasts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference.columns</code></td>
<td>
<p>a reference matrix usually generated by FindReferences to define reference samples for each sample; can be NULL if all conditions are at steady state (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>the data slot to take f0 and totals from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.labeling</code></td>
<td>
<p>the column in the Coldata table denoting the labeling duration, or the numeric labeling duration itself</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.experiment</code></td>
<td>
<p>the column in the Coldata table denoting the experimental time point (can be NULL, see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ROPE.max.log2FC</code></td>
<td>
<p>the region of practical equivalence is [-ROPE.max.log2FC,ROPE.max.log2FC] in log2 fold change space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.f0.in.ss</code></td>
<td>
<p>whether or not to sample f0 under steady state conditions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.max</code></td>
<td>
<p>the maximal number of samples (necessary if old RNA &gt; f0); if more are necessary, a warning is generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.size</code></td>
<td>
<p>A number between 0 and 1 representing the size of the credible interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for the random number generator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>
<p>overdispersion parameter for each gene; if NULL this is estimated from data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.level</code></td>
<td>
<p>Define how the NTR is sampled from the hierarchical Bayesian model (must be 0,1, or 2; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct.labeling</code></td>
<td>
<p>Labeling times have to be unique; usually execution is aborted, if this is not the case; if this is set to true, the median labeling time is assumed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print status messages</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The kinetic parameters s and d are computed using TransformSnapshot. For that, the sample either must be in steady state
(this is the case if defined in the reference.columns matrix), or if the levels at an earlier time point are known from separate samples,
so called temporal reference samples. Thus, if s and d are estimated for a set of samples x_1,...,x_k (that must be from the same time point t),
we need to find (i) the corresponding temporal reference samples from time t0, and (ii) the time difference between t and t0.
</p>
<p>The temporal reference samples are identified by the reference.columns matrix. This is a square matrix of logicals, rows and columns correspond to all samples
and TRUE indicates that the row sample is a temporal reference of the columns sample. This time point is defined by <code>time.experiment</code>. If <code>time.experiment</code>
is NULL, then the labeling time of the A or B samples is used (e.g. useful if labeling was started concomitantly with the perturbation, and the steady state samples
are unperturbed samples).
</p>
<p>By default, the hierarchical Bayesian model is estimated. If sample.level = 0, the NTRs are sampled from a beta distribution
that approximates the mixture of betas from the replicate samples. If sample.level = 1, only the first level from the hierarchical model
is sampled (corresponding to the uncertainty of estimating the biological variability). If sample.level = 2, the first and second levels
are estimated (corresponding to the full hierarchical model).
</p>
<p>if N is set to 0, then no sampling from the posterior is performed, but the transformed MAP estimates are returned
</p>


<h3>Value</h3>

<p>a new grandR object including a new analysis table. The columns of the new analysis table are
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"s.A"</code></td>
<td>
<p>the posterior mean synthesis rate for sample A from the comparison</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"s.B"</code></td>
<td>
<p>the posterior mean synthesis rate for sample B from the comparison</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"HL.A"</code></td>
<td>
<p>the posterior mean RNA half-life for sample A from the comparison</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"HL.B"</code></td>
<td>
<p>the posterior mean RNA half-life for sample B from the comparison</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"s.log2FC"</code></td>
<td>
<p>the posterior mean synthesis rate log2 fold change</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"s.cred.lower"</code></td>
<td>
<p>the lower CI boundary of the synthesis rate log2 fold change</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"s.cred.upper"</code></td>
<td>
<p>the upper CI boundary of the synthesis rate log2 fold change</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"s.ROPE"</code></td>
<td>
<p>the signed ROPE probability (negative means downregulation) for the synthesis rate fold change</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"HL.log2FC"</code></td>
<td>
<p>the posterior mean half-life log2 fold change</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"HL.cred.lower"</code></td>
<td>
<p>the lower CI boundary of the half-life log2 fold change</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"HL.cred.upper"</code></td>
<td>
<p>the upper CI boundary of the half-life log2 fold change</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"HL.ROPE"</code></td>
<td>
<p>the signed ROPE probability (negative means downregulation) for the half-life fold change</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>FitKineticsGeneSnapshot,FitKineticsSnapshot
</p>


<h3>Examples</h3>

<pre><code class="language-R">banp &lt;- ReadGRAND(system.file("extdata", "BANP.tsv.gz", package = "grandR"),
          design=c("Cell","Experimental.time","Genotype",
                       Design$dur.4sU,Design$has.4sU,Design$Replicate))
contrasts &lt;- GetContrasts(banp,contrast=c("Experimental.time.original","0h"),name.format="$A")
reference.columns &lt;- FindReferences(banp,reference= Experimental.time==0)
banp &lt;- EstimateRegulation(banp,"Regulation",
                             contrasts=contrasts,
                             reference.columns=reference.columns,
                             verbose=TRUE,
                             time.experiment = "Experimental.time",
                             N=0,               # don't sample in the example
                             dispersion=0.1)    # don't estimate dispersion in the example
head(GetAnalysisTable(banp))

</code></pre>


</div>