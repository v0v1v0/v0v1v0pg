<div class="container">

<table style="width: 100%;"><tr>
<td>lipsitz.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lipsitz goodness of fit test for ordinal logistic models.</h2>

<h3>Description</h3>

<p>Performs the Lipsitz goodness of fit test for ordinal logistic regression models.</p>


<h3>Usage</h3>

<pre><code class="language-R">lipsitz.test(model, g = 10)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> an ordinal logistic regression model. Must be an object of class <code>polr</code> or <code>clm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p> number of quantiles of risk, defaults to 10.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Lipsitz test is a goodness of fit test for ordinal response logistic regression models. It involves binning the observed data into equally sized <code>g</code> groups based on an ordinal response score. This score is computed by summing the predicted probabilities of each subject for each outcome level multiplied by equally spaced integer weights. The user can specify the number of groups by assigning an integer value to <code>g</code>, which is 10 by default.
</p>
<p>Given this partitioning of the data, dummy variables, <code>I</code>, are derived such that, for each group, <code>I = 1</code> if the subject is in region <code>g</code> and <code>I = 0</code> if not. The model is then re-fit with these dummy variables. If the model has good fit, then the coefficients for all these dummy variables simultaneously = 0. Lipsitz et al (1996) suggest that likelihood ratio, Wald or score tests can be used; <code>lipsitz.test</code> just uses the likelihood ratio test with <code>g-1</code> degrees of freedom.
</p>
<p>Note that the outcome variable MUST be converted to a factor before running the model. Using <code>as.factor()</code> within the model function will cause an error because of the way in which <code>lipsitz.test</code> uses the <code>update()</code> function to re-fit the model.
</p>
<p>It is recommended (Fagerland and Hosmer, 2016) that the Lipsitz test be run alongside the ordinal Hosmer-Lemeshow test (<code>logitgof</code>) and the Pulkstenis-Robinson tests (<code>pulkrob.chisq</code> and <code>pulkrob.deviance</code>).
</p>


<h3>Value</h3>

<p>A list of class <code>htest</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p> the value of the likelihood ratio statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p> degrees of freedom used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p> the p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> a character string indicating the name of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p> a character string indicating the model formula used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newmoddata</code></td>
<td>
<p> a data frame containing the data used in fitting the updated model (the original data plus the dummy variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictedprobs</code></td>
<td>
<p> a data frame of predicted probabilities from the original model.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matthew Alexander Jay</p>


<h3>References</h3>


<ul>
<li>
<p> Fagerland MW, Hosmer DW. A goodness-of-fit test for the proportional odds regression model. Statistics in Medicine 2013;32:2235-2249.
</p>
</li>
<li>
<p> Fagerland MW, Hosmer DW. Tests for goodness of fit in ordinal logistic regression models. Journal of Statistical Computation and Simulation 2016. DOI: 10.1080/00949655.2016.1156682.
</p>
</li>
<li>
<p> Lipsitz SR, Fitzmaurice GM, Molenberghs G. Goodness-of-Fit Tests for Ordinal Response Regression Models. Journal of the Royal Statistical Society 1996;45(2):175-190.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>logitgof</code>, <code>pulkrob.chisq</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mtcars)
mtcars$gear &lt;- as.factor(mtcars$gear) # Outcome must be converted to factor 
                                      # before fitting model otherwise 
                                      # lipsitz.test() will fail.
mod1 &lt;- polr(gear ~ mpg + cyl, data = mtcars)
lipsitz.test(mod1)
  
library(ordinal)
mod2 &lt;- clm(gear ~ mpg, data = mtcars)
lipsitz.test(mod2)
</code></pre>


</div>