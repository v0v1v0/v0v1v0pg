<div class="container">

<table style="width: 100%;"><tr>
<td>varhat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotic variance (times <code>n</code>) of the estimator for <code>mu</code> or <code>sigmasq</code> for the univariate normal on a general domain assuming the other parameter is known.</h2>

<h3>Description</h3>

<p>Asymptotic variance (times <code>n</code>) of the estimator for <code>mu</code> or <code>sigmasq</code> for the univariate normal on a general domain assuming the other parameter is known.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varhat(mu, sigmasq, mode, param1, param2, est_mu, domain, tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A number, the true <code>mu</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmasq</code></td>
<td>
<p>A number, the true <code>sigmasq</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>A string, the class of the <code>h</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param1</code></td>
<td>
<p>A number, the first parameter to the <code>h</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param2</code></td>
<td>
<p>A number, the second parameter (may be optional depending on <code>mode</code>) to the <code>h</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_mu</code></td>
<td>
<p>A boolean. If <code>TRUE</code>, returns the asymptotic variance of muhat assuming sigmasq is known; if <code>FALSE</code>, returns the asymptotic variance of sigmasqhat assuming mu is known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p>A list returned from <code>make_domain()</code> that represents the domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A positive number, tolerance for numerical integration. Defaults to <code>1e-10</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The estimates may be off from the empirical variance, or may even be <code>Inf</code> or <code>NaN</code> if <code>"mode"</code> is one of <code>"cosh"</code>, <code>"exp"</code>, and <code>"sinh")</code> as the functions grow too fast.
If <code>est_mu == TRUE</code>, the function numerically calculates
</p>
<p style="text-align: center;"><code class="reqn">E\left[\sigma^2 h^2(X)+\sigma^4 {h'}^2(X)\right]/E^2[h(X)],</code>
</p>

<p>and if <code>est_mu == FALSE</code>, the function numerically calculates
</p>
<p style="text-align: center;"><code class="reqn">E\left[\left(2\sigma^6h^2(X)+\sigma^8{h'}^2(X)\right)(X-\mu)^2\right]/E^2\left[h(X)(X-\mu)^2\right],</code>
</p>

<p>where <code class="reqn">E</code> is the expectation over the true distribution <code class="reqn">TN(\mu,\sigma)</code> of <code class="reqn">X</code>.
</p>


<h3>Value</h3>

<p>A number, the asymptotic variance.
</p>


<h3>Examples</h3>

<pre><code class="language-R">varhat(0, 1, "min_log_pow", 1, 1, TRUE, make_domain("R+", 1))
varhat(0.5, 4, "min_pow", 1, 1, TRUE, make_domain("R+", 1))
</code></pre>


</div>