<div class="container">

<table style="width: 100%;"><tr>
<td>citest-array</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for conditional independence in a contingency table</h2>

<h3>Description</h3>

<p>Test for conditional independence in a contingency table
represented as an array.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ciTest_table(
  x,
  set = NULL,
  statistic = "dev",
  method = "chisq",
  adjust.df = TRUE,
  slice.info = TRUE,
  L = 20,
  B = 200,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An array of counts with named dimnames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set</code></td>
<td>
<p>A specification of the test to be made. The tests are of the form u
and v are independent condionally on S where u and v are variables and S
is a set of variables. See 'details' for details about specification of
<code>set</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Possible choices of the test statistic are <code>"dev"</code> for
deviance and <code>"X2"</code> for Pearsons X2 statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method of evaluating the test statistic. Possible choices are
<code>"chisq"</code>, <code>"mc"</code> (for Monte Carlo) and <code>"smc"</code> for
sequential Monte Carlo.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust.df</code></td>
<td>
<p>Logical. Should degrees of freedom be adjusted for
sparsity?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slice.info</code></td>
<td>
<p>Logical. Should slice info be stored in the
output?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Number of extreme cases as stop criterion if method is
<code>"smc"</code> (sequential Monte Carlo test); ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number (maximum) of simulations to make if method is
<code>"mc"</code> or <code>"smc"</code> (Monte Carlo test or sequential
Monte Carlo test); ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>set</code> can be 1) a vector or 2) a right-hand sided formula in
which variables are separated by '+'. In either case, it is tested if the
first two variables in the <code>set</code> are conditionally independent given
the remaining variables in <code>set</code>.  (Notice an abuse of the '+'
operator in the right-hand sided formula: The order of the variables does
matter.)
</p>
<p>If <code>set</code> is <code>NULL</code> then it is tested whether the first two
variables are conditionally independent given the remaining variables.
</p>


<h3>Value</h3>

<p>An object of class <code>citest</code> (which is a list).
</p>


<h3>Author(s)</h3>

<p>Søren Højsgaard, <a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a>
</p>


<h3>See Also</h3>

<p><code>ciTest</code>, <code>ciTest_df</code>,
<code>ciTest_mvn</code>, <code>chisq.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(lizard)

## lizard is has named dimnames
names( dimnames( lizard ))
## checked with
is.named.array( lizard )

## Testing for conditional independence:
# the following are all equivalent:
ciTest(lizard, set=~diam + height + species)
# ciTest(lizard, set=c("diam", "height", "species"))
# ciTest(lizard, set=1:3)
# ciTest(lizard)
# (The latter because the names in lizard are as given above.)

## Testing for marginal independence
ciTest(lizard, set=~diam + height)
ciTest(lizard, set=1:2)

## Getting slice information:
ciTest(lizard, set=c("diam", "height", "species"), slice.info=TRUE)$slice

## Do Monte Carlo test instead of usual likelihood ratio test. Different
# options:

# 1) Do B*10 simulations divided equally over each slice: 
ciTest(lizard, set=c("diam", "height", "species"), method="mc", B=400)
# 2) Do at most B*10 simulations divided equally over each slice, but stop
# when at most L extreme values are found
ciTest(lizard, set=c("diam", "height", "species"), method="smc", B=400)
</code></pre>


</div>