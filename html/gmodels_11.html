<div class="container">

<table style="width: 100%;"><tr>
<td>estimable</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contrasts and estimable linear functions of model coefficients</h2>

<h3>Description</h3>

<p>Compute and test contrasts and other estimable linear functions of model
coefficients for for lm, glm, lme, mer, and geese objects
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimable(obj, cm, beta0, conf.int = NULL, show.beta0, ...)

## Default S3 method:
estimable(obj, cm, beta0, conf.int = NULL, show.beta0, joint.test = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Regression (lm, glm, lme, mer, mlm) object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cm</code></td>
<td>
<p>Vector, List, or Matrix specifying estimable linear functions or
contrasts.  See below for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>Vector of null hypothesis values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>Confidence level.  If provided, confidence intervals will be
computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.beta0</code></td>
<td>
<p>Logical value. If TRUE a column for beta0 will be included
in the output table.  Defaults to TRUE when beta0 is specified, FALSE
otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint.test</code></td>
<td>
<p>Logical value. If TRUE a 'joint' Wald test for the
hypothesis <code class="reqn">L \beta=\beta_0</code> is performed.
Otherwise 'row-wise' tests are performed, i.e. <code class="reqn">(L \beta)[i]=\beta_0[i]</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>estimable</code> computes an estimate, test statitic, significance test, and
(optional) confidence interval for each linear functions of the model
coefficients specified by <code>cm</code>.
</p>
<p>The estimable function(s) may be specified via a vector, list, or matrix.
If <code>cm</code> is a vector, it should contained named elements each of which
gives the coefficient to be applied to the corresponding parameter. These
coefficients will be used to construct the contrast matrix, with unspecified
model parameters assigned zero coefficients. If <code>cm</code> is a list, it
should contain one or more coefficient vectors, which will be used to
construct rows of the contrast matrix.  If <code>cm</code> is a matrix, column
names must match (a subset of) the model parameters, and each row should
contain the corresponding coefficient to be applied.  Model parameters which
are not present in the set of column names of <code>cm</code> will be set to zero.
</p>
<p>The estimates and their variances are obtained by applying the contrast
matrix (generated from) <code>cm</code> to the model estimates variance-covariance
matrix.  Degrees of freedom are obtained from the appropriate model terms.
</p>
<p>The user is responsible for ensuring that the specified linear functions are
meaningful.
</p>
<p>For computing contrasts among levels of a single factor, <code>fit.contrast</code>
may be more convenient.  For computing contrasts between two specific
combinations of model parameters, the <code>contrast</code> function in Frank
Harrell's 'rms' library (formerly 'Design') may be more convenient.
</p>
<p>%The <code>.wald</code> function is called internally by <code>estimable</code> and %is
not intended for direct use.
</p>


<h3>Value</h3>

<p>Returns a matrix with one row per linear function.  Columns contain
the beta0 value (optional, see <code>show.beta0</code> above), estimated
coefficients, standard errors, t values, degrees of freedom, two-sided
p-values, and the lower and upper endpoints of the 1-alpha confidence
intervals.
</p>


<h3>Note</h3>

<p>The estimated fixed effect parameters of <code>lme</code> objects may have
different degrees of freedom.  If a specified contrast includes nonzero
coefficients for parameters with differing degrees of freedom, the smallest
number of degrees of freedom is used and a warning message is issued.
</p>


<h3>Author(s)</h3>

<p>BXC (Bendix Carstensen) <a href="mailto:b@bxc.dk">b@bxc.dk</a>, Gregory R. Warnes
<a href="mailto:greg@warnes.net">greg@warnes.net</a>, Soren Hojsgaard <a href="mailto:sorenh@agrsci.dk">sorenh@agrsci.dk</a>, and
Randall C Johnson <a href="mailto:rjohnson@ncifcrf.gov">rjohnson@ncifcrf.gov</a>
</p>


<h3>See Also</h3>

<p><code>fit.contrast()</code>, <code>stats::lm()</code>,
<code>nlme::lme()</code>, <code>stats::contrasts()</code>,
<code>rms::contrast()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# setup example data
y &lt;- rnorm(100)
x &lt;-  cut(rnorm(100, mean=y, sd=0.25),c(-4,-1.5,0,1.5,4))
levels(x) &lt;- c("A","B","C","D")
x2 &lt;- rnorm(100, mean=y, sd=0.5)

# simple contrast and confidence interval
reg &lt;- lm(y ~ x)
estimable(reg, c(    0,   1,    0,   -1) )  # full coefficient vector
estimable(reg, c("xB"=1,"xD"=-1) )          # just the nonzero terms


# Fit a spline with a single knot at 0.5 and plot the *pointwise*
# confidence intervals
library(gplots)
pm &lt;- pmax(x2-0.5, 0) # knot at 0.5
reg2 &lt;- lm(y ~ x + x2 + pm )

range &lt;- seq(-2, 2, , 50)
tmp &lt;- estimable(reg2,
                 cm=cbind(
                          '(Intercept)'=1,
                          'xC'=1,
                          'x2'=range,
                          'pm'=pmax(range-0.5, 0)
                           ),
                 conf.int=0.95)
plotCI(x=range, y=tmp[, 1], li=tmp[, 6], ui=tmp[, 7])

# Fit both linear and quasi-Poisson models to iris data, then compute
# joint confidence intervals on contrasts for the Species and
# Sepal.Width by Species interaction terms.
data(iris)
lm1  &lt;- lm (Sepal.Length ~ Sepal.Width + Species + Sepal.Width:Species, data=iris)
glm1 &lt;- glm(Sepal.Length ~ Sepal.Width + Species + Sepal.Width:Species, data=iris,
            family=quasipoisson("identity"))

cm &lt;- rbind(
            'Setosa vs. Versicolor'   = c(0, 0, 1, 0, 1, 0),
            'Setosa vs. Virginica'    = c(0, 0, 0, 1, 0, 1),
            'Versicolor vs. Virginica'= c(0, 0, 1,-1, 1,-1)
            )
estimable(lm1, cm)
estimable(glm1, cm)

</code></pre>


</div>