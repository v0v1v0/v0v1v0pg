<div class="container">

<table style="width: 100%;"><tr>
<td>hosmerlem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hosmer-Lemeshow Test for Categorical Response Models</h2>

<h3>Description</h3>

<p>This is a post estimation goodness-of-fit test for categorical
response models. It currently supports the binary, multinomial and ordinal
logistic regression models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hosmerlem(model, group = 10, tables = FALSE, customFreq = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a model object or data.frame of observed and estimated
values. The following class of objects can be directly passed to the function:
glm(), vglm(), serp(), polr(), clm(), and mlogit(). Other class of objects
require providing a data.frame of observed and predicted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Default to 10. The number of groups to be formed from the
original observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>
<p>Default to FALSE. When TRUE, both the observed and the
expected frequency tables are printed alongside test results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>customFreq</code></td>
<td>
<p>a vector of custom group frequencies to be used instead of
the default equal group frequencies. The vector should, however, sum up to
the total number of original observations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The implemented tests are discussed in Hosmer and Lemeshow (1980)
(for the binary case), Fagerland, Hosmer, and Bofin (2008);
Fagerland and Hosmer (2012) (for the multinomial case) and
Fagerland and Hosmer (2013, 2016, 2017) (for the ordinal case). In each
of the three settings, one makes a split of the original observations into k
groups (10 by default), after ranking the observations by ordinal
scores (OS). Ties are separated following an additional ranking based on the
observed values. A Pearson chi-squared statistic is thereafter obtained
from a (k X c) expected and observed frequency tables. The Hosmerlem()
function automatically dictates which of the three HL tests to run based on
the type of model supplied or by inspecting the class/level of response
category in the supplied data.frame of predicted and observed values.
</p>
<p>On the choice of k-groups, Fagerland and Hosmer (2013, 2016) recommend
using ten groups. It is believed that number of groups below six
adversely affects the heterogeneity within groups thereby resulting in a
test with low power. Also having too many groups could lead to a sparsely
populated contingency tables, affecting the distributional assumptions of
the test statistic. The test statistic follows the chi-squared distribution
with (k - 2)(r - 1) + (r - 2) degrees of freedom. Where k and r are
respectively the number of groups and response category. For chi-square
estimation to hold, it is recommended to have the percentage of estimated
frequencies greater than 80 percent of all estimated frequencies
(Fagerland and Hosmer, 2017).
</p>
<p>Finally, it is particularly recommended to compare the results of the
ordinal Hosmer-Lemeshow test with the lipsitz and the Pulkstenis-Robinson
tests (Fagerland and Hosmer, 2016; 2017).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chi.sq</code></td>
<td>
<p>realized value of the chi-square statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>table of observed frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>table of estimated frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>percentage of estimated frequencies greater than one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character vector indicating the type of HL-test conducted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tables</code></td>
<td>
<p>TRUE or FALSE logical vector.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Hosmer, D. W. and Lemeshow, S. (1980). Goodness of fit tests for the multiple
logistic regression model. <em>Communications in Statistics-Theory and
Methods</em>, 9, 1043-1069.
</p>
<p>Fagerland, M. W., Hosmer, D. W. and Bofin, A. M. (2008). Multinomial
goodness-of-fit tests for logistic regression models. <em>Statistics in
Medicine</em>, 27, 4238-4253.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2012). A generalized Hosmer-Lemeshow
goodness-of-fit test for multinomial logistic regression models.
<em>Stata Journal</em>, 12, 447-453.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2013). A goodness-of-fit test for the
proportional odds regression model. <em>Statistics in Medicine</em>,
32, 2235-2249.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2016). Tests for goodness of fit in
ordinal logistic regression models. <em>Journal of Statistical
Computation and Simulation</em>, 86, 3398-3418.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2017). How to test for goodness of fit
in ordinal logistic regression models. <em>Stata Journal</em>, 17, 668-686.
</p>


<h3>See Also</h3>

<p><code>lipsitz</code>, <code>pulkroben</code>, <code>brant.test</code>,
<code>LR.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
require(VGAM)

# Binary L-H test
set.seed(1)
gm &lt;- glm(rbinom(100,1,0.5) ~ rnorm(100), family=binomial)
hosmerlem(gm, group = 10, customFreq = NULL, tables = TRUE)

# multinomial L-H test
vg &lt;- vglm(RET ~ DIAB + GH + BP, model = TRUE,
           family = multinomial(parallel = TRUE), data = retinopathy)
hosmerlem(vg)

# ordinal L-H test
## proportional odds model
cu &lt;- update(vg, family = cumulative(link = 'logitlink', parallel = TRUE))
hosmerlem(cu, tables=TRUE)
hosmerlem(cu, group = 5, tables=TRUE, customFreq = c(rep(100,5), 113))

## adjacent category model
ac &lt;- update(vg, family = acat(parallel = TRUE))
hosmerlem(ac)

## continuation ratio model
cr &lt;- update(vg, family = cratio(parallel = TRUE))
hosmerlem(cr)

## using data.frame
y &lt;- ordered(retinopathy$RET)
df &lt;- data.frame(y, fitted.values(cr))
hosmerlem(df, tables = TRUE)

</code></pre>


</div>