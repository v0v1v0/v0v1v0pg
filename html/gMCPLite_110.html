<div class="container">

<table style="width: 100%;"><tr>
<td>weighted.test.functions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Test Functions for use with gMCP</h2>

<h3>Description</h3>

<p>The package gMCP provides the following weighted test functions:
</p>

<dl>
<dt>bonferroni.test</dt>
<dd>
<p>Bonferroni test - see <code>?bonferroni.test</code> for details.</p>
</dd>
<dt>parametric.test</dt>
<dd>
<p>Parametric test - see <code>?parametric.test</code> for details.</p>
</dd>
<dt>simes.test</dt>
<dd>
<p>Simes test - see <code>?simes.test</code> for details.</p>
</dd>
<dt>bonferroni.trimmed.simes.test</dt>
<dd>
<p>Trimmed Simes test for intersections of two hypotheses and otherwise Bonferroni - see <code>?bonferroni.trimmed.simes.test</code> for details.</p>
</dd>
<dt>simes.on.subsets.test</dt>
<dd>
<p>Simes test for intersections of hypotheses from certain sets and otherwise Bonferroni - see <code>?simes.on.subsets.test</code> for details.</p>
</dd>
</dl>
<h3>Details</h3>

<p>Depending on whether <code>adjPValues==TRUE</code> these test functions return different values:
</p>

<ul>
<li>
<p> If <code>adjPValues==TRUE</code> the minimal value for alpha is returned for which the null hypothesis can be rejected. If that's not possible (for example in case of the trimmed Simes test adjusted p-values can not be calculated), the test function may throw an error.
</p>
</li>
<li>
<p> If <code>adjPValues==FALSE</code> a logical value is returned whether the null hypothesis can be rejected.
</p>
</li>
</ul>
<p>To provide your own test function write a function that takes at least the following arguments:
</p>

<dl>
<dt>pvalues</dt>
<dd>
<p>A numeric vector specifying the p-values.</p>
</dd>
<dt>weights</dt>
<dd>
<p>A numeric vector of weights.</p>
</dd>
<dt>alpha</dt>
<dd>
<p>A numeric specifying the maximal allowed type one error rate. If <code>adjPValues==TRUE</code> (default) the parameter <code>alpha</code> should not be used.</p>
</dd>
<dt>adjPValues</dt>
<dd>
<p>Logical scalar. If <code>TRUE</code> an adjusted p-value for the weighted test is returned (if possible - if not the function should call <code>stop</code>).
Otherwise if <code>adjPValues==FALSE</code> a logical value is returned whether the null hypothesis can be rejected.</p>
</dd>
<dt>...</dt>
<dd>
<p> Further arguments possibly passed by <code>gMCP</code> which will be used by other test procedures but not this one.</p>
</dd>
</dl>
<p>Further the following parameters have a predefined meaning:
</p>

<dl>
<dt>verbose</dt>
<dd>
<p>Logical scalar. If <code>TRUE</code> verbose output should be generated and printed to the standard output</p>
</dd>
<dt>subset</dt>
<dd></dd>
<dt>correlation</dt>
<dd></dd>
</dl>
<h3>Author(s)</h3>

<p>Kornelius Rohmeyer <a href="mailto:rohmeyer@small-projects.de">rohmeyer@small-projects.de</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# The test function 'bonferroni.test' is used in by gMCP in the following call:
graph &lt;- BonferroniHolm(4)
pvalues &lt;- c(0.01, 0.05, 0.03, 0.02)
alpha &lt;- 0.05
r &lt;- gMCP.extended(graph=graph, pvalues=pvalues, test=bonferroni.test, verbose=TRUE)

# For the intersection of all four elementary hypotheses this results in a call
bonferroni.test(pvalues=pvalues, weights=getWeights(graph))
bonferroni.test(pvalues=pvalues, weights=getWeights(graph), adjPValues=FALSE)

# bonferroni.test function:
bonferroni.test &lt;- function(pvalues, weights, alpha=0.05, adjPValues=TRUE, verbose=FALSE, ...) {
  if (adjPValues) {
    return(min(pvalues/weights))
  } else {
    return(any(pvalues&lt;=alpha*weights))
  }
}

</code></pre>


</div>