<div class="container">

<table style="width: 100%;"><tr>
<td>filter_zi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter initial conditions</h2>

<h3>Description</h3>

<p>Construct initial conditions for a filter
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter_zi(filt, ...)

## Default S3 method:
filter_zi(filt, a, ...)

## S3 method for class 'Arma'
filter_zi(filt, ...)

## S3 method for class 'Ma'
filter_zi(filt, ...)

## S3 method for class 'Sos'
filter_zi(filt, ...)

## S3 method for class 'Zpg'
filter_zi(filt, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filt</code></td>
<td>
<p>For the default case, the moving-average coefficients of an ARMA
filter (normally called <code>b</code>), specified as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments (ignored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the autoregressive (recursive) coefficients of an ARMA filter,
specified as a vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes an initial state for the filter function that
corresponds to the steady state of the step response. In other words, it
finds the initial condition for which the response to an input of all ones is
a constant. Therefore, the results returned by this function can also be
obtained using the function <code>filtic</code> by setting <code>x</code> and
<code>y</code> to all 1s (see the examples).
</p>
<p>A typical use of this function is to set the initial state so that the output
of the filter starts at the same value as the first element of the signal to
be filtered.
</p>


<h3>Value</h3>

<p>The initial state for the filter, returned as a vector.
</p>


<h3>Author(s)</h3>

<p>Geert van Boxtel, <a href="mailto:G.J.M.vanBoxtel@gmail.com">G.J.M.vanBoxtel@gmail.com</a>,
converted to R from Python scipy.signal.lfilter_zi.
</p>


<h3>References</h3>

<p>Gustafsson, F. (1996). Determining the initial states in
forward-backward filtering. IEEE Transactions on Signal Processing, 44(4),
988 - 992.
</p>


<h3>See Also</h3>

<p><code>filtic</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## taken from Python scipy.signal.lfilter_zi documentation

h &lt;- butter(5, 0.25)
zi &lt;- filter_zi(h)
y &lt;- filter(h, rep(1, 10), zi)
## output is all 1, as expected.
y2 &lt;- filter(h, rep(1, 10))
## if the zi argument is not given, the output
## does not return the final conditions

x &lt;- c(0.5, 0.5, 0.5, 0.0, 0.0, 0.0, 0.0)
y &lt;- filter(h, x, zi = zi*x[1])
## Note that the zi argument to filter was computed using
## filter_zi and scaled by x[1]. Then the output y has no
## transient until the input drops from 0.5 to 0.0.

## obtain the same results with filtic
lab &lt;- max(length(h$b), length(h$a)) - 1
ic &lt;- filtic(h, rep(1, lab), rep(1, lab))
all.equal(zi, ic)

</code></pre>


</div>