<div class="container">

<table style="width: 100%;"><tr>
<td>max_FI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum Fisher information</h2>

<h3>Description</h3>

<p><code>max_FI</code> is used to estimate maximum Fisher information based on two power criteria. 
- The first criterion consider the maxmimum Fisher information such that there is a pre-defined power to declare efficacy in the entire population for a given vector of parameters representing treatment effetcs in each subgroup.
- The second criterion consider the maxmimum Fisher information such that there is a pre-defined power to declare efficacy in at least one subgroup for a given vector of parameters representing treatment effetcs in each subgroup.
</p>


<h3>Usage</h3>

<pre><code class="language-R">max_FI(K_stages, N_subsets, f, ratio_Delta_star_d1, l, u, type_outcome, param_theta, 
pow, ordering, increasing_theta=FALSE, seed=42, n_trials, rule, updateProgress=NULL)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>K_stages</code></td>
<td>
<p>Integer indicating the number of stages in the design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_subsets</code></td>
<td>
<p>Integer representing the number of possible subgroups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Vector containing the prevalence rates of each subgroup. Must be of length <code>N_subsets</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_Delta_star_d1</code></td>
<td>
<p>Vector containing the ratio between the (observed Fisher) information increments at each stage &gt;1 with the (observed Fisher) information at stage 1. Must be of length <code>K_stages</code>-1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>Vector containing the lower boundaries for stagewise decisions. Must be of length <code>K_stages</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Vector containing the upper boundaries for stagewise decisions. Must be of length <code>K_stages</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_outcome</code></td>
<td>
<p>A string containing the type of outcome, either "survival", "binary", or "continuous".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param_theta</code></td>
<td>
<p>Vector of parameters representing treatment effects in each subgroup. Must satisfy the properties detailed in Magnusson and Turnbull's article (reparametrization can be needed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>
<p>Value representing the desired power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordering</code></td>
<td>
<p>Boolean indicating if the subgroups (theta) are ordered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>increasing_theta</code></td>
<td>
<p>Boolean indicating if greater values of theta parameters represent better treatment effects. The default value is set at FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Interger representing the seed. The default value is set at 42.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_trials</code></td>
<td>
<p>Integer indicating the number of trials to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>Integer with value either 1 or 2 for power criteria detailed in description section (1 for entire population, 2 for at least one subgroup).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateProgress</code></td>
<td>
<p>(for Rshiny application)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A value representing the maximum Fisher information is returned.
</p>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Baldur P. Magnusson and Bruce W. Turnbull. Group sequential enrichment design incorporating subgroup selection. Statistics in Medicine, 2013. &lt;doi:10.1002/sim.5738&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">theta_assumption = list(matrix(c(0.4,0.6,0.4,0.6,0.4,0.6),nrow=2,ncol=3))

#For testing purpose only, larger number of simulations required (see in comments below)
max_FI(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), ratio_Delta_star_d1=c(1), l=c(0.7962, 2.5204), 
u=c(2.7625, 2.5204), type_outcome="binary", param_theta=theta_assumption, pow=0.9, 
ordering=FALSE, increasing_theta=FALSE, seed=140691, n_trials=3, rule=1)
       
#max_FI(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), ratio_Delta_star_d1=c(1), l=c(0.7962, 2.5204), 
#u=c(2.7625, 2.5204), type_outcome="binary", param_theta=theta_assumption, pow=0.9, 
#ordering=FALSE, increasing_theta=FALSE, seed=140691, n_trials=10000000, rule=1)

#max_FI(K_stages=2, N_subsets=3, f=c(0.6,0.2,0.2), ratio_Delta_star_d1=c(1), l=c(0.7962, 2.5204), 
#u=c(2.7625, 2.5204), type_outcome="binary", param_theta=theta_assumption, pow=0.9,
#ordering=FALSE, increasing_theta=FALSE, seed=140691, n_trials=10000000, rule=2)
</code></pre>


</div>