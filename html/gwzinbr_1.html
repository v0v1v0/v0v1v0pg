<div class="container">

<table style="width: 100%;"><tr>
<td>Golden</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Golden Section Search</h2>

<h3>Description</h3>

<p>Runs a Golden Section Search (GSS) algorithm for determining the optimum bandwidth for the geographically weighted zero inflated negative binomial regression and other spatial regression models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Golden(
  data,
  formula,
  xvarinf = NULL,
  weight = NULL,
  lat,
  long,
  globalmin = TRUE,
  method,
  model = "zinb",
  bandwidth = "cv",
  offset = NULL,
  force = FALSE,
  maxg = 100,
  distancekm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>name of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>regression model formula as in <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvarinf</code></td>
<td>
<p>name of the covariates for the zero inflated part of the model, default value is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>name of the variable containing the sample weights, default value is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>name of the variable containing the latitudes in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>name of the variable containing the longitudes in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>globalmin</code></td>
<td>
<p>logical value indicating whether to find a global minimum in the optimization process, default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>indicates the method to be used for the bandwidth calculation (<code>adaptive_bsq</code> or <code>fixed_g</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>indicates the model to be used for the regression (<code>zinb</code>, <code>zip</code>, <code>negbin</code>, <code>poisson</code>), default value is<code>"zinb"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>indicates the criterion to be used for the bandwidth calculation (<code>cv</code>, <code>aic</code>), default value is <code>"cv"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>name of the variable containing the offset values, if null then is set to a vector of zeros, default value is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>logical value indicating whether to force the indicated model even if it is not the best fit for the data, default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxg</code></td>
<td>
<p>integer indicating the maximum number of iterations for the zero inflated part of the model, default value is <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distancekm</code></td>
<td>
<p>logical value indicating whether to calculate the distances in km, default value is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list that contains:
</p>

<ul>
<li> <p><code>h_values</code> - Initial values tested for the bandwidth.
</p>
</li>
<li> <p><code>iterations</code> - All bandwidth values tested and respective cv/aic results for each Golden Section Search executed.
</p>
</li>
<li> <p><code>gss_results</code> - Optimum bandwidth found and respective cv/aic.
</p>
</li>
<li> <p><code>min_bandwidth</code> - Optimum bandwidth.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Data


data(southkorea_covid19)


## GSS algorithm

gss &lt;- Golden(data = southkorea_covid19[1:122, ],
formula = n_covid1~diff_sd,
xvarinf = NULL, weight = NULL, lat = "y", long = "x",
offset = NULL, model = "poisson", method = "fixed_g",
bandwidth = "cv", globalmin = FALSE, distancekm = FALSE,
force=FALSE)

## Bandwidth
gss$min_bandwidth

## Iterations
gss$iterations

</code></pre>


</div>