<div class="container">

<table style="width: 100%;"><tr>
<td>overglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</h2>

<h3>Description</h3>

<p>Allows to fit regression models based on the negative binomial, beta-binomial, and random-clumped binomial.
distributions, which are alternatives to the Poisson and binomial regression models under the presence of overdispersion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">overglm(
  formula,
  offset,
  family = "nb1(log)",
  weights,
  data,
  subset,
  na.action = na.omit(),
  reltol = 1e-13,
  start = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>formula</code> expression of the form <code>response ~ x1 + x2 + ...</code>, which is a symbolic description
of the linear predictor of the model to be fitted to the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known component to be included in the linear predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A character string that allows you to specify the
distribution describing the response variable. In addition,
it allows you to specify the link function to be used in the
model for <code class="reqn">\mu</code>. The following distributions are
supported: negative binomial I ("nb1"), negative binomial II
("nb2"), negative binomial ("nbf"), zero-truncated negative
binomial I ("ztnb1"), zero-truncated negative binomial II
("ztnb2"), zero-truncated negative binomial ("ztnbf"),
zero-truncated poisson ("ztpoi"), beta-binomial ("bb") and
random-clumped binomial ("rcb"). Link functions available for
these models are the same as those available for Poisson and
binomial models via glm. See family documentation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an (optional) vector of positive "prior weights" to be used in the fitting process. The length of
<code>weights</code> should be the same as the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression,
as well as for variables specified in the arguments <code>weights</code> and <code>subset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an (optional) vector specifying a subset of individuals to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. By default <code>na.action</code>
is set to <code>na.omit()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>an (optional) positive value which represents the <em>relative convergence tolerance</em> for the BFGS method in optim.
As default, <code>reltol</code> is set to 1e-13.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an (optional) vector of starting values for the parameters in the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The negative binomial distribution can be obtained as mixture of the Poisson and Gamma distributions. If
<code class="reqn">Y | \lambda</code> ~ Poisson<code class="reqn">(\lambda)</code>, where E<code class="reqn">(Y | \lambda)=</code> Var<code class="reqn">(Y | \lambda)=\lambda</code>, and
<code class="reqn">\lambda</code> ~ Gamma<code class="reqn">(\theta,\nu)</code>, in which E<code class="reqn">(\lambda)=\theta</code> and Var<code class="reqn">(\lambda)=\nu\theta^2</code>, then
<code class="reqn">Y</code> is distributed according to the negative binomial distribution. As follows, some special cases are described:
</p>
<p>(1) If <code class="reqn">\theta=\mu</code> and <code class="reqn">\nu=\phi</code> then <code class="reqn">Y</code> ~ Negative Binomial I,
E<code class="reqn">(Y)=\mu</code> and Var<code class="reqn">(Y)=\mu(1 + \phi\mu)</code>.
</p>
<p>(2) If <code class="reqn">\theta=\mu</code> and <code class="reqn">\nu=\phi/\mu</code> then <code class="reqn">Y</code> ~ Negative Binomial II,
E<code class="reqn">(Y)=\mu</code> and Var<code class="reqn">(Y)=\mu(1 +\phi)</code>.
</p>
<p>(3) If <code class="reqn">\theta=\mu</code> and <code class="reqn">\nu=\phi\mu^\tau</code> then <code class="reqn">Y</code> ~ Negative Binomial,
E<code class="reqn">(Y)=\mu</code> and Var<code class="reqn">(Y)=\mu(1 +\phi\mu^{\tau+1})</code>.
</p>
<p>Therefore, the regression models based on the negative binomial and
zero-truncated negative binomial distributions are alternatives,
under overdispersion, to those based on the Poisson and
zero-truncated Poisson distributions, respectively.
</p>
<p>The beta-binomial distribution can be obtained as a mixture of the binomial and beta distributions. If
<code class="reqn">mY | \pi</code> ~ Binomial<code class="reqn">(m,\pi)</code>, where E<code class="reqn">(Y | \pi)=\pi</code> and Var<code class="reqn">(Y | \pi)=m^{-1}\pi(1-\pi)</code>,
and <code class="reqn">\pi</code> ~ Beta<code class="reqn">(\mu,\phi)</code>, in which E<code class="reqn">(\pi)=\mu</code> and Var<code class="reqn">(\pi)=(\phi+1)^{-1}\mu(1-\mu)</code>,
with <code class="reqn">\phi&gt;0</code>, then <code class="reqn">mY</code> ~ Beta-Binomial<code class="reqn">(m,\mu,\phi)</code>, so that E<code class="reqn">(Y)=\mu</code> and
Var<code class="reqn">(Y)=m^{-1}\mu(1-\mu)[1 + (\phi+1)^{-1}(m-1)]</code>. Therefore, the regression model based on the
beta-binomial distribution is an alternative, under overdispersion, to the binomial regression model.
</p>
<p>The random-clumped binomial distribution can be obtained as a mixture of the binomial and Bernoulli distributions. If
<code class="reqn">mY | \pi</code> ~ Binomial<code class="reqn">(m,\pi)</code>, where E<code class="reqn">(Y | \pi)=\pi</code> and Var<code class="reqn">(Y | \pi)=m^{-1}\pi(1-\pi)</code>,
whereas <code class="reqn">\pi=(1-\phi)\mu + \phi</code> with probability <code class="reqn">\mu</code>, and <code class="reqn">\pi=(1-\phi)\mu</code> with probability <code class="reqn">1-\mu</code>,
in which E<code class="reqn">(\pi)=\mu</code> and Var<code class="reqn">(\pi)=\phi^{2}\mu(1-\mu)</code>, with <code class="reqn">\phi \in (0,1)</code>, then <code class="reqn">mY</code> ~ Random-clumped
Binomial<code class="reqn">(m,\mu,\phi)</code>, so that E<code class="reqn">(Y)=\mu</code> and Var<code class="reqn">(Y)=m^{-1}\mu(1-\mu)[1 + \phi^{2}(m-1)]</code>. Therefore,
the regression model based on the random-clumped binomial distribution is an alternative, under
overdispersion, to the binomial regression model.
</p>
<p>In all cases, even where the response variable is described by a
zero-truncated distribution, the fitted model describes the way in
which <code class="reqn">\mu</code> is dependent on some covariates. Parameter estimation
is performed using the maximum likelihood method. The model
parameters are estimated by maximizing the log-likelihood function
through the BFGS method available in the routine optim. The
accuracy and speed of the BFGS method are increased because the call
to the routine optim is performed using analytical instead
of the numerical  derivatives. The variance-covariance matrix
estimate is obtained as being minus the inverse of the (analytical)
hessian matrix evaluated at the parameter estimates and the observed
data.
</p>
<p>A set of standard extractor functions for fitted model objects is available for objects of class  <em>zeroinflation</em>,
including methods to the generic functions such as <code>print</code>, <code>summary</code>,	<code>model.matrix</code>, <code>estequa</code>,
<code>coef</code>, <code>vcov</code>, <code>logLik</code>, <code>fitted</code>, <code>confint</code>, <code>AIC</code>, <code>BIC</code> and <code>predict</code>.
In addition, the model fitted to the	data may be assessed using functions such as anova.overglm,
residuals.overglm, dfbeta.overglm, cooks.distance.overglm, localInfluence.overglm,
gvif.overglm and envelope.overglm. The variable selection may be accomplished using the routine
stepCriterion.overglm.
</p>


<h3>Value</h3>

<p>an object of class <em>overglm</em> in which the main results of the model fitted to the data are stored, i.e., a
list with components including
</p>

<table>
<tr>
<td style="text-align: left;">
<code>coefficients</code> </td>
<td style="text-align: left;"> a vector containing the parameter estimates,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>fitted.values</code>
</td>
<td style="text-align: left;"> a vector containing the estimates of <code class="reqn">\mu_1,\ldots,\mu_n</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>start</code>        </td>
<td style="text-align: left;"> a vector containing the starting values used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>prior.weights</code>
</td>
<td style="text-align: left;"> a vector containing the case weights used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>offset</code>       </td>
<td style="text-align: left;"> a vector containing the offset used, </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>terms</code>        </td>
<td style="text-align: left;"> an object containing the terms objects,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>loglik</code>       </td>
<td style="text-align: left;"> the value of the log-likelihood function avaliated at the parameter estimates,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>estfun</code>       </td>
<td style="text-align: left;"> a vector containing the estimating functions evaluated at the parameter estimates</td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> and the observed data,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>formula</code>      </td>
<td style="text-align: left;"> the formula,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>levels</code>       </td>
<td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>contrasts</code>    </td>
<td style="text-align: left;"> an object containing the contrasts corresponding to levels,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>converged</code>    </td>
<td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>model</code>        </td>
<td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>y</code>            </td>
<td style="text-align: left;"> the response count vector,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>family</code>       </td>
<td style="text-align: left;"> an object containing the family object used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>linear.predictors</code> </td>
<td style="text-align: left;"> a vector containing the estimates of <code class="reqn">g(\mu_1),\ldots,g(\mu_n)</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>R</code>            </td>
<td style="text-align: left;"> a matrix with the Cholesky decomposition of the inverse of the variance-covariance</td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> matrix of all parameters in the model,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>call</code>         </td>
<td style="text-align: left;"> the original function call.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Crowder M. (1978) Beta-binomial anova for proportions, <em>Journal of the Royal Statistical
Society Series C (Applied Statistics)</em> 27, 34-37.
</p>
<p>Lawless J.F. (1987) Negative binomial and mixed poisson regression, <em>The Canadian Journal
of Statistics</em> 15, 209-225.
</p>
<p>Morel J.G., Neerchal N.K. (1997) Clustered binary logistic regression in teratology data
using a finite mixture distribution, <em>Statistics in Medicine</em> 16, 2843-2853.
</p>
<p>Morel J.G., Nagaraj N.K. (2012) <em>Overdispersion Models in SAS</em>. SAS Institute Inc.,
Cary, North Carolina, USA.
</p>


<h3>See Also</h3>

<p>zeroalt, zeroinf
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example 1: Ability of retinyl acetate to prevent mammary cancer in rats
data(mammary)
fit1 &lt;- overglm(tumors ~ group, family="nb1(identity)", data=mammary)
summary(fit1)

### Example 2: Self diagnozed ear infections in swimmers
data(swimmers)
fit2 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)
summary(fit2)

### Example 3: Urinary tract infections in HIV-infected men
data(uti)
fit3 &lt;- overglm(episodes ~ cd4 + offset(log(time)), family="nb1(log)", data = uti)
summary(fit3)

### Example 4: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit4 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
summary(fit4)

### Example 5: Agents to stimulate cellular differentiation
data(cellular)
fit5 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)
summary(fit5)

### Example 6: Teratogenic effects of phenytoin and trichloropropene oxide
data(ossification)
model6 &lt;- cbind(fetuses,litter-fetuses) ~ pht + tcpo
fit6 &lt;- overglm(model6, family="rcb(cloglog)", data=ossification)
summary(fit6)

### Example 7: Germination of orobanche seeds
data(orobanche)
model7 &lt;- cbind(germinated,seeds-germinated) ~ specie + extract
fit7 &lt;- overglm(model7, family="rcb(cloglog)", data=orobanche)
summary(fit7)

</code></pre>


</div>