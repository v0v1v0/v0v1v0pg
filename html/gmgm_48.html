<div class="container">

<table style="width: 100%;"><tr>
<td>smem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select the number of mixture components and estimate the parameters of a
Gaussian mixture model</h2>

<h3>Description</h3>

<p>This function selects the number of mixture components and estimates the
parameters of a Gaussian mixture model using a split-and-merge EM (SMEM)
algorithm. At the first iteration, the classic EM algorithm is performed to
update the parameters of the initial model. Then each following iteration
consists in splitting a component into two or merging two components, before
re-estimating the parameters with the EM algorithm. The selected split or
merge operation is the one that maximizes a scoring function (after the
re-estimation process). To avoid testing all possible operations, the split
and merge candidates are initially ranked according to relevant criteria
(Zhang <em>et al.</em>, 2003). At first, the top-ranked split and top-ranked
merge operations are tested. If neither of them increases the score, the
second-ranked ones are considered, and so on. The SMEM algorithm stops if a
given maximum rank is reached without improving the score.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smem(
  gmm,
  data,
  y = NULL,
  score = "bic",
  split = TRUE,
  merge = TRUE,
  min_comp = 1,
  max_comp = Inf,
  space = 0.5,
  max_rank = 1,
  max_iter_smem = 10,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gmm</code></td>
<td>
<p>An initial object of class <code>gmm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or numeric matrix containing the data used in the
SMEM algorithm. Its columns must explicitly be named after the variables of
<code>gmm</code> and must not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A character vector containing the dependent variables if a
conditional model is estimated (which involves maximizing a conditional
score). If <code>NULL</code> (the default), the joint model is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>A character string (<code>"aic"</code>, <code>"bic"</code> or
<code>"loglik"</code>) corresponding to the scoring function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>A logical value indicating whether split operations are allowed
(if <code>FALSE</code>, no mixture component can be split).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>
<p>A logical value indicating whether merge operations are allowed
(if <code>FALSE</code>, no mixture component can be merged).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_comp</code></td>
<td>
<p>A positive integer corresponding to the minimum number of
mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_comp</code></td>
<td>
<p>A positive integer corresponding to the maximum number of
mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>space</code></td>
<td>
<p>A numeric value in [0, 1[ corresponding to the space between two
subcomponents resulting from a split.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_rank</code></td>
<td>
<p>A positive integer corresponding to the maximum rank for
testing the split and merge candidates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter_smem</code></td>
<td>
<p>A non-negative integer corresponding to the maximum
number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value indicating whether iterations in progress
are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to function <code>em</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>gmm</code></td>
<td>
<p>The final <code>gmm</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>A numeric matrix containing the posterior probabilities for
each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq_score</code></td>
<td>
<p>A numeric vector containing the sequence of scores measured
initially and after each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq_oper</code></td>
<td>
<p>A character vector containing the sequence of split and merge
operations performed at each iteration.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhang, Z., Chen, C., Sun, J. and Chan, K. L. (2003). EM algorithms for
Gaussian mixtures with split-and-merge operation. <em>Pattern Recognition</em>,
36(9):1973â€“1983.
</p>


<h3>See Also</h3>

<p><code>em</code>, <code>stepwise</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data_body)
gmm_1 &lt;- add_var(NULL, c("WAIST", "AGE", "FAT", "HEIGHT", "WEIGHT"))
res_smem &lt;- smem(gmm_1, data_body, max_comp = 3, verbose = TRUE)

</code></pre>


</div>