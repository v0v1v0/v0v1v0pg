<div class="container">

<table style="width: 100%;"><tr>
<td>gte</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Turnbull's Estimator</h2>

<h3>Description</h3>

<p>The <code>gte</code> function computes the generalized Turnbull's Estimator (GTE) proposed by Dehghan and Duchesne (2011).
It is a nonparametric estimator of a conditional survival function given a vector of continuous covariates 
that can handle interval-censored lifetimes.<br>
The <code>print</code> method for objects obtained from <code>gte</code> only prints the output value <code>surv.summary</code>.<br>
The <code>plot</code> method for objects obtained from <code>gte</code> plots the estimate of the conditional survival
function, by default overlaying curves if more than one estimate is present and shading the innermost interval,
in which the GTE is indeterminate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gte(formula, data, z, h = NULL, itermax = 1e+05, tole = 5e-04)

## S3 method for class 'gte'
print(x, ...)

## S3 method for class 'gte'
plot(
  x,
  overlay = TRUE,
  shade = TRUE,
  xlab = "time",
  ylab = "survival",
  xleg = "bottomleft",
  yleg = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object with the response on the left of a ~ operator, and the covariates on the right. 
The response must be a survival object as returned by the <code>Surv</code> function from the package 
<span class="pkg">survival</span> (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame, list or environment
containing the variables in the model formula. If not found in data, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which <code>gte</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A matrix: each row contains the values of a covariate vector at which an estimate of the 
conditional survival function is requested.
If there is only one covariate, it can be a vector (possibly of length 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>A vector: the values of the bandwidth parameter <code class="reqn">h</code> for each covariate
(default = equation 7 of Dehghan and Duchesne (2011)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itermax</code></td>
<td>
<p>maximal number of iterations for the algorithm (default=100000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tole</code></td>
<td>
<p>maximal distance between successive iterations tolerated
before declaring convergence (default=0.0005).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object, produced by the <code>gte</code> function, to print or to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>print.default</code> or <code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlay</code></td>
<td>
<p>A logical: Should the curves be overlayed when there is more than one estimate 
of the conditional survival function in the <code>gte</code> object <code>x</code>? (default=<code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>
<p>A logical: Should the rectangles of indeterminate NPMLE (innermost interval) 
be shaded? (default=<code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A label for the x-axis, by defaut <code>xlab = "time"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>A label for the y-axis, by defaut <code>ylab = "survival"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xleg</code></td>
<td>
<p>x location for legend, "bottomleft" by default (see <code>legend</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yleg</code></td>
<td>
<p>y location for legend, NULL by default (see <code>legend</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For interval-censored data, the <code>Surv</code> function should be called with the argument 
<code>type="interval"</code> or <code>type="interval2"</code>. If <code>type="interval"</code>, the <code>event</code> argument
is mandatory. Therefore, in addition to the left and right endpoints of the censoring interval (called, respectively,
<code>left</code> and right for illustrative purpose), one would need a third variable (<code>status</code>) taking the value 0 
for right censored data, 1 for an event at exact time, 2 for left censored data and 3 for interval censored data. 
The <code>Surv</code> function would be called as follows:<br><code>Surv(time=left, time2=right, event=status, type="interval")</code>.
</p>
<p>If <code>type="interval2"</code>, the <code>event</code> argument cannot be given. 
The value of <code>event</code> is derived from the <code>time</code> and <code>time2</code> argument as follows:<br> 
if <code>time</code> takes the value <code>NA</code>, <code>event=2</code> (left censored data);<br> 
if <code>time2</code> takes the value <code>NA</code>, <code>event=0</code> (right censored data);<br>
if <code>time=time2</code>, <code>event=1</code> (exact time);<br> 
otherwise, <code>event=3</code> (interval censored data).<br>
See the help page of the <code>Surv</code> function for more details.<br></p>
<p>In the <code>gte</code> function, the data must be given through the <code>Surv</code> function
but it is internally transformed in two vectors : <code>L</code> and <code>R</code> for the left and right endpoints of 
the censoring interval, respectively.<br>     
If <code>event=0</code> (right censored data), then <code>L=time</code> and <code>R=Inf</code>;<br>     
if <code>event=1</code> (exact time), then <code>L=time</code> and <code>R=time</code>;<br>     
if <code>event=2</code> (left censored data), then <code>L=0</code> and <code>R=time</code>;<br>     
and if <code>event=3</code> (interval censored data), then <code>L=time</code> and <code>R=time2</code>;<br>
If one has vectors <code>L</code> and <code>R</code> respecting this convention, they can be given directly to <code>gte</code>
by calling <code>Surv</code> as follows:<br><code>Surv(L, R, type="interval2")</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> A vector: the ordered distinct values of the left and right endpoints of the censoring 
interval (omitting the smallest value, but always including time 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv</code></td>
<td>
<p> A matrix: the estimates of the conditional survival function at time <code>time</code>. 
The <code class="reqn">i</code>th column refers to the <code class="reqn">i</code>th value of the covariate vector given 
in <code>z</code> (row <code class="reqn">i</code> of <code>z</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intmap</code></td>
<td>
<p>A matrix : The intervals of the potential steps in the conditional survival function,
called innermost interval, over which the GTE is indeterminate. The left endpoints of
the intervals are in the first row, and the rigth endpoints in the second. The object
attribute LRin denotes whether to include each of the endpoints or not. This matrix
is computed with an internal function derived from function <code>Aintmap</code> of the
<span class="pkg">interval</span> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv.summary</code></td>
<td>
<p>A summary of <code>surv</code>: the estimates of the conditional survival function 
only for the intervals of the potential steps in the function (innermost 
intervals). The row names describe the intervals, which are detailed in 
<code>intmap</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p> The function call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mohammad Hossein Dehghan, Thierry Duchesne and Sophie Baillargeon
</p>


<h3>References</h3>

<p>Dehghan, M. H. and Duchesne, T. (2011). A generalization of Turnbull's estimator for 
nonparametric estimation of the conditional survival function with interval-censored data.
<em>Lifetime Data Analysis</em>, <b>17</b>, 234-255.
</p>


<h3>See Also</h3>

<p><code>Surv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Calling Surv() with type="interval2"
Fit &lt;- gte(Surv(L, R, type="interval2") ~ Z, data=simul, z=c(10, 20))
Fit

## Calling Surv() with type="interval"
event &lt;- ifelse(is.na(simul$R), 0,
                ifelse(is.na(simul$L), 2,
                       ifelse(simul$R==simul$L, 1, 3)))
time &lt;- ifelse(event==2, simul$R, simul$L)
time2 &lt;- ifelse(event==3, simul$R, NA)
simul_event &lt;- cbind(simul, time, time2, event)

Fit_event &lt;- gte(Surv(time, time2, event, type="interval") ~ Z, data=simul_event, z=c(10, 20))
Fit_event

# The results are the same
all.equal(Fit_event$time, Fit$time)
all.equal(Fit_event$surv, Fit$surv)

## Plotting the results
plot(Fit, xleg="topright")

</code></pre>


</div>