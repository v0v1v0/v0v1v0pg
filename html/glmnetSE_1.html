<div class="container">

<table style="width: 100%;"><tr>
<td>glmnetSE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add Nonparametric Bootstrap SE to 'glmnet' for Selected Coefficients (No Shrinkage)</h2>

<h3>Description</h3>

<p>Builds a LASSO, Ridge, or Elastic Net model with <code>glmnet</code> or <code>cv.glmnet</code> with bootstrap inference statistics (SE, CI, and p-value) for selected coefficients with no shrinkage applied for them. Model performance can be evaluated on test data and an automated alpha selection is implemented for Elastic Net. Parallelized computation is used to speed up the process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glmnetSE(
  data,
  cf.no.shrnkg,
  alpha = 1,
  method = "10CVoneSE",
  test = "none",
  r = 250,
  nlambda = 100,
  seed = 0,
  family = "gaussian",
  type = "basic",
  conf = 0.95,
  perf.metric = "mse",
  ncore = "mx.core"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame, tibble, or matrix object with the outcome variable in the first column and the feature variables in the following columns. Note: all columns beside the first one are used as feature variables. Feature selection has to be done beforehand.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cf.no.shrnkg</code></td>
<td>
<p>A character string of the coefficients whose effect size will be interpreted, the inference statistic is of interest and therefore no shrinkage will be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Alpha value [0,1]. An alpha of 0 results in a ridge regression, a value of 1 in a LASSO, and a value between 0 and 1 in an Elastic Net. If a sequence of possible alphas is passed to the <code>alpha</code> argument the alpha of the best performing model (based on the selected <code>method</code> and <code>perf.metric</code>) is selected - default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string defining if 10-fold cross-validation is used or not. Possible methods are <code>none</code>: no cross-validation is applied and the coefficients for lambda = 0.1 are selected. <code>10CVoneSE </code>:  10-fold cross-validation is applied and the lambda of the least complex model with an MSE within one standard error of the smallest MSE is selected. <code>10CVmin</code>: 10-fold cross-validation is applied and the lambda at which the MSE is the smallest is selected - default is <code>10CVoneSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>A data frame, tibble, or matrix object with the same outcome and feature variables as supplied to <code>data</code> which includes test-observations not used for the training of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Number of nonparametric bootstrap repetitions - default is 250</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>Number of tested lambda values - default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed set for the cross-validation and bootstrap sampling - default 0 which means no seed set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A character string representing the used model family either <code>gaussian</code> or <code>binomial</code> - default is <code>gaussian</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string indicating the type of calculated bootstrap intervals. It can be <code>norm</code>, <code>basic</code>,  <code>perc</code>, or  <code>bca</code>. For more information check the <code>boot.ci</code> package - default is <code>basic</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>Indicates the confidence interval level - default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perf.metric</code></td>
<td>
<p>A character string indicating the used performance metric to evaluate the performance of different lambdas and the final model. Can be either <code>mse</code> (mean squared error), <code>mae</code> (mean absolute error), <code>class</code> (classification error), or <code>auc</code> (area under the curve). Is not applied when method <code>none</code> is used - default is <code>mse</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore</code></td>
<td>
<p>A numerical value indicates the number of build clusters and used cores in the computation. If not defined the maximum available number of cores of the OS -1 is used <code>mx.core</code>. It is not possible to use more than 32 cores, because efficiency decreases rapidly at this point see (Sloan et al. 2014) - default is <code>mx.core</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>glmnetSE </code> object which output can be displayed using <code>summary()</code> or <code>summary.glmnetSE()</code>. If family <code>binomial</code> and performance metric <code>auc</code> is used it is possible to plot the ROC curve with <code>plot()</code> or <code>plot.glmnetSE()</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastian Bahr, <a href="mailto:sebastian.bahr@unibe.ch">sebastian.bahr@unibe.ch</a>
</p>


<h3>References</h3>

<p>Friedman J., Hastie T. and Tibshirani R. (2010). Regularization Paths for Generalized Linear Models via Coordinate Descent. Journal of Statistical Software, 33(1), 1-22. <a href="https://www.jstatsoft.org/v33/i01/">https://www.jstatsoft.org/v33/i01/</a>.
</p>
<p>Simon N., Friedman J., Hastie T. and Tibshirani R. (2011). Regularization Paths for Cox's Proportional Hazards Model via Coordinate Descent. Journal of Statistical Software, 39(5), 1-13. <a href="https://www.jstatsoft.org/v39/i05/">https://www.jstatsoft.org/v39/i05/</a>.
</p>
<p>Efron, B. and Tibshirani, R. (1993) An Introduction to the Bootstrap. Chapman &amp; Hall. <a href="https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf">https://cds.cern.ch/record/526679/files/0412042312_TOC.pdf</a>
</p>
<p>Sloan T.M., Piotrowski M., Forster T. and Ghazal P. (2014) Parallel Optimization of Bootstrapping in R. <a href="https://arxiv.org/ftp/arxiv/papers/1401/1401.6389.pdf">https://arxiv.org/ftp/arxiv/papers/1401/1401.6389.pdf</a>
</p>


<h3>See Also</h3>

<p><code>summary.glmnetSE</code> and <code>plot.glmnetSE</code> methods.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# LASSO model with gaussian function, no cross validation, a seed of 123, and
# the coefficient of interest is Education. Two cores are used for the computation

glmnetSE(data=swiss, cf.no.shrnkg = c("Education"), alpha=1, method="none", seed = 123, ncore = 2)


# Ridge model with binomial function, 10-fold cross validation selecting the lambda
# at which the smallest MSE is achieved, 500 bootstrap repetitions, no seed, the
# misclassification error is used as performance metric, and the coefficient of
# interest are Education and Catholic. Two cores are used for the computation.

# Generate dichotom variable
swiss$Fertility &lt;- ifelse(swiss$Fertility &gt;= median(swiss$Fertility), 1, 0)

glmnetSE(data=swiss, cf.no.shrnkg = c("Education", "Catholic"), alpha=0, method="10CVmin", r=500,
         seed = 0, family="binomial", perf.metric = "class", ncore = 2)


# Elastic Net with gaussian function, automated alpha selection, selection the lambda
# within one standard deviation of the best model, test data to obtain the performance
# metric on it, a seed of 123, bias-corrected and accelerated confidence intervals, a
# level of 0.9, the performance metric MAE, and the coefficient of interest is Education.
# Two cores are used for the computation

# Generate a train and test set
set.seed(123)
train_sample &lt;- sample(nrow(swiss), 0.8*nrow(swiss))

swiss.train &lt;- swiss[train_sample, ]
swiss.test  &lt;- swiss[-train_sample, ]

glmnetSE(data=swiss.train, cf.no.shrnkg = c("Education"), alpha=seq(0.1,0.9,0.1),
method="10CVoneSE", test = swiss.test, seed = 123, family = "gaussian", type = "bca",
conf = 0.9, perf.metric = "mae", ncore = 2)

</code></pre>


</div>