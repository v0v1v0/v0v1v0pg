<div class="container">

<table style="width: 100%;"><tr>
<td>gen_net</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a Partial Correlation Matrix</h2>

<h3>Description</h3>

<p>Simulate a Partial Correlation Matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">gen_net(p = 20, edge_prob = 0.3, lb = 0.05, ub = 0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of variables (nodes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge_prob</code></td>
<td>
<p>connectivity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>lower bound for the partial correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>upper bound for the partial correlations</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following:
</p>

<ul>
<li>
<p><strong>pcor</strong>: Partial correlation matrix, encoding
the conditional (in)dependence structure.
</p>
</li>
<li>
<p><strong>cors</strong>: Correlation matrix.
</p>
</li>
<li>
<p><strong>adj</strong>: Adjacency matrix.
</p>
</li>
<li>
<p><strong>trys</strong>: Number of attempts to obtain a
positive definite matrix.
</p>
</li>
</ul>
<h3>Note</h3>

<p>The function checks for a valid matrix (positive definite),
but sometimes this will still fail. For example, for
larger <code>p</code>, to have large partial correlations this
requires a sparse GGM
(accomplished by setting <code>edge_prob</code>
to a small value).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
p &lt;- 20
n &lt;- 500

true_net &lt;- gen_net(p = p, edge_prob = 0.25)

y &lt;- MASS::mvrnorm(n = n,
                   mu = rep(0, p),
                   Sigma = true_net$cors)

# default
fit_atan &lt;- ggmncv(R = cor(y),
                   n = nrow(y),
                   penalty = "atan",
                   progress = FALSE)

# lasso
fit_l1 &lt;- ggmncv(R = cor(y),
                 n = nrow(y),
                 penalty = "lasso",
                 progress = FALSE)

# atan
score_binary(estimate = true_net$adj,
             true = fit_atan$adj,
             model_name = "atan")

# lasso
score_binary(estimate = fit_l1$adj,
             true = true_net$adj,
             model_name = "lasso")

</code></pre>


</div>