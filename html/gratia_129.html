<div class="container">

<table style="width: 100%;"><tr>
<td>fderiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>First derivatives of fitted GAM functions</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a>
</p>
<p>This function was deprecated because it was limited to first order forward
finite differences for derivatives only, but couldn't be improved to offer
the needed functionality without breaking backwards compatability with papers
and blog posts that already used <code>fderiv()</code>. A replacement, <code>derivatives()</code>,
is now available and recommended for new analyses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fderiv(model, ...)

## S3 method for class 'gam'
fderiv(
  model,
  newdata,
  term,
  n = 200,
  eps = 1e-07,
  unconditional = FALSE,
  offset = NULL,
  ...
)

## S3 method for class 'gamm'
fderiv(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A fitted GAM. Currently only models fitted by <code>mgcv::gam()</code> and
<code>mgcv::gamm()</code> are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments that are passed to other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a data frame containing the values of the model covariates at
which to evaluate the first derivatives of the smooths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term</code></td>
<td>
<p>character; vector of one or more terms for which derivatives are
required. If missing, derivatives for all smooth terms will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer; if <code>newdata</code> is missing the original data can be
reconstructed from <code>model</code> and then <code>n</code> controls the number of values over
the range of each covariate with which to populate <code>newdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>numeric; the value of the finite difference used to approximate
the first derivative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconditional</code></td>
<td>
<p>logical; if <code>TRUE</code>, the smoothing parameter uncertainty
corrected covariance matrix is used, <em>if available</em>, otherwise the
uncorrected Bayesian posterior covariance matrix is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>numeric; value of offset to use in generating predictions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>"fderiv"</code> is returned.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>Examples</h3>

<pre><code class="language-R">load_mgcv()

dat &lt;- data_sim("eg1", seed = 2)
mod &lt;- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = "REML")

## first derivatives of all smooths...
fd &lt;- fderiv(mod)
## now use --&gt;
fd &lt;- derivatives(mod)

## ...and a selected smooth
fd2 &lt;- fderiv(mod, term = "x1")
## now use --&gt;
fd2 &lt;- derivatives(mod, select = "s(x1)")

## Models with factors
dat &lt;- data_sim("eg4", n = 400, dist = "normal", scale = 2, seed = 2)
mod &lt;- gam(y ~ s(x0) + s(x1) + fac, data = dat, method = "REML")

## first derivatives of all smooths...
fd &lt;- fderiv(mod)
## now use --&gt;
fd &lt;- derivatives(mod)

## ...and a selected smooth
fd2 &lt;- fderiv(mod, term = "x1")
## now use --&gt;
fd2 &lt;- derivatives(mod, select = "s(x1)")
</code></pre>


</div>