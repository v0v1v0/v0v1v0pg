<div class="container">

<table style="width: 100%;"><tr>
<td>MLfullGB2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum Likelihood Estimation of the GB2 Based on the Full Log-likelihood
</h2>

<h3>Description</h3>

<p>Performs maximum pseudo-likelihood estimation through the general-purpose optimisation function <code>optim</code> from package <code>stats</code>. Two methods of optimization are considered: BFGS and L-BFGS-B 
(see <code>optim</code> documentation for more details). Initial values of the parameters to be optimized over (<code class="reqn">a</code>, <code class="reqn">b</code>, 
<code class="reqn">p</code> and <code class="reqn">q</code>) are given from the Fisk distribution and <code class="reqn">p=q=1</code>. The function to be maximized by <code>optim</code> is the negative of the full log-likelihood and the gradient is equal to the 
negative of the scores, respectively for the case of a sample of persons and a sample of households. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ml.gb2(z, w=rep(1, length(z)), method=1, hess=FALSE) 
mlh.gb2(z, w=rep(1, length(z)), hs=rep(1, length(z)), method=1, hess = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>numeric; vector of data values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>numeric; vector of weights. Must have the same length as <code>z</code>. By default <code>w</code> is a vector of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>
<p>numeric; vector of household sizes. Must have the same length as <code>z</code>. By default <code>hs</code> is a vector of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>numeric; the method to be used by <code>optim</code>. By default, codemethod = 1 and the used method is BFGS. If <code>method = </code>2, method L-BFGS-B is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>logical; By default, <code>hess = FALSE</code>, the hessian matrix is not calculated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>ml.gb2</code> performs maximum likelihood estimation through the general-purpose optimization function <code>optim</code> from package <code>stats</code>,
based on the full log-likelihood calculated in a sample of persons. Function <code>mlh.gb2</code> performs maximum likelihood estimation through the general-purpose optimization function <code>optim</code> 
from package <code>stats</code>, based on the full log-likelihood calculated in a sample of households.
</p>


<h3>Value</h3>

 
<p><code>ml.gb2</code> and <code>mlh.gb2</code> return a list with 1 argument: <code>opt1</code> for the output of the BFGS fit or <code>opt2</code> for the output of the L-BFGS fit. Further values are given by the values of <code>optim</code>.
</p>


<h3>Author(s)</h3>

<p>Monique Graf
</p>


<h3>References</h3>

<p>Graf, M., Nedyalkova, D., Muennich, R., Seger, J. and Zins, S. (2011)
AMELI Deliverable 2.1: Parametric Estimation of Income Distributions and
Indicators of Poverty and Social Exclusion.
<em>Technical report</em>, AMELI-Project.
</p>


<h3>See Also</h3>

<p><code>optim</code> for the general-purpose optimization and <code>fisk</code> for the Fisk distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(laeken)
data(eusilc)

# Income
inc &lt;- as.vector(eusilc$eqIncome)

# Weights
w &lt;- eusilc$rb050

# Data set
d &lt;- data.frame(inc, w)
d &lt;- d[!is.na(d$inc),]
   
# Truncate at 0
inc &lt;- d$inc[d$inc &gt; 0]
w   &lt;- d$w[d$inc &gt; 0]

# Fit using the full log-likelihood
fitf &lt;- ml.gb2(inc, w)

# Fitted GB2 parameters
af &lt;- fitf$par[1]
bf &lt;- fitf$par[2]
pf &lt;- fitf$par[3]
qf &lt;- fitf$par[4]

# Likelihood
flik &lt;- fitf$value

# If we want to compare the indicators

# GB2 indicators
indicf &lt;- round(main.gb2(0.6,af,bf,pf,qf), digits=3)
# Empirical indicators
indice &lt;- round(main.emp(inc,w), digits=3)

# Plots
plotsML.gb2(inc,af,bf,pf,qf,w)

## End(Not run)
</code></pre>


</div>