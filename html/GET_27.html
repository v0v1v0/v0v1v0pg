<div class="container">

<table style="width: 100%;"><tr>
<td>GET-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global Envelopes</h2>

<h3>Description</h3>

<p>The <span class="pkg">GET</span> package provides implementation of global envelopes
for a set of general d-dimensional vectors T in various applications.
A 100(1-alpha)
the probability that T falls outside this envelope in any of the d points is
equal to alpha. Global means that the probability is controlled simultaneously
for all the d elements of the vectors.
The global envelopes can be used for central regions of functional or
multivariate data (e.g. outlier detection, functional boxplot),
for graphical Monte Carlo and permutation tests where the test statistic
is a multivariate vector or function (e.g. goodness-of-fit testing for point
patterns and random sets, functional ANOVA, functional GLM, n-sample test of
correspondence of distribution functions), and for global confidence and
prediction bands (e.g. confidence band in polynomial regression,
Bayesian posterior prediction).
</p>


<h3>Details</h3>

<p>The <span class="pkg">GET</span> package provides central regions (i.e. global envelopes) and
global envelope tests with intrinsic graphical interpretation.
The central regions can be constructed from (functional) data.
The tests are Monte Carlo or permutation tests, which demand simulations
from the tested null model. The methods are applicable for any multivariate
vector data and functional data (after discretization).
</p>
<p>To get an overview of the package, start R and type <code>library("GET")</code> and <code>vignette("GET")</code>.
</p>
<p>To get examples of point pattern analysis, start R and type <code>library("GET")</code> and <code>vignette("pointpatterns")</code>.
</p>
<p>To get examples of Mrkvička and Myllymäki (2022), start R and type <code>library("GET")</code> and <code>vignette("FDRenvelopes")</code>.
</p>


<h3>Key functions in <span class="pkg">GET</span>
</h3>


<ul>
<li> <p><em>Central regions</em> or <em>global envelopes</em> or <em>confidence bands</em>:
<code>central_region</code>.
E.g. 50% central region of growth curves of girls <code>growth</code>.
</p>

<ul>
<li>
<p> First create a curve_set of the growth curves, e.g.
</p>
<p><code>
                   cset &lt;- curve_set(r = as.numeric(row.names(growth$hgtf)),
                                     obs = growth$hgtf)
                 </code>
</p>
</li>
<li>
<p> Then calculate 50% central region (see <code>central_region</code> for further arguments)
</p>
<p><code>
                   cr &lt;- central_region(cset, coverage = 0.5)
                 </code>
</p>
</li>
<li>
<p> Plot the result (see <code>plot.global_envelope</code> for plotting options)
</p>
<p><code>
                   plot(cr)
                 </code>
</p>
</li>
</ul>
<p>It is also possible to do combined central regions for several sets of curves provided in a list
for the function, see examples in <code>central_region</code>.
</p>
</li>
<li> <p><em>Global envelope tests</em>: <code>global_envelope_test</code> is the main function.
E.g. A test of complete spatial randomness (CSR) for a point pattern <code>X</code>:
</p>
<p><code>X &lt;- spruces # an example pattern from spatstat</code>
</p>

<ul>
<li>
<p> Use the function <code>envelope</code> of <span class="pkg">spatstat</span> to create nsim simulations
under CSR and to calculate the functions you want (below K-functions by Kest).
Important: use the option 'savefuns=TRUE' and
specify the number of simulations <code>nsim</code>.
</p>
<p><code>
                   env &lt;- envelope(X, nsim=999, savefuns = TRUE, fun = Kest, simulate = expression(runifpoint(ex = X)))
                 </code>
</p>
</li>
<li>
<p> Perform the test (see <code>global_envelope_test</code> for further arguments)
</p>
<p><code>
                   res &lt;- global_envelope_test(env)
                 </code>
</p>
</li>
<li>
<p> Plot the result (see <code>plot.global_envelope</code> for plotting options)
</p>
<p><code>
                   plot(res)
                 </code>
</p>
</li>
</ul>
<p>It is also possible to do combined global envelope tests for several sets of curves provided in a list
for the function, see examples in <code>global_envelope_test</code>.
To obtain false discovery rate envelopes of Mrkvička and Myllymäki (2023) use the argument <code>typeone = "fdr"</code>.
</p>
</li>
</ul>
<ul>
<li> <p><em>Functional ordering</em>: <code>central_region</code> and <code>global_envelope_test</code>
are based on different measures for ordering the functions (or vectors) from
the most extreme to the least extreme ones. The core functionality of calculating the measures
is in the function <code>forder</code>, which can be used to obtain different measures for sets of
curves. Usually there is no need to call <code>forder</code> directly.
</p>
</li>
<li> <p><em>Functional boxplots</em>: <code>fBoxplot</code>
</p>
</li>
<li> <p><em>Adjusted</em> global envelope tests for composite null hypotheses
</p>

<ul><li> <p><code>GET.composite</code>, see a detailed example in <code>saplings</code>
</p>
</li></ul>
</li>
<li> <p><em>One-way functional ANOVA</em>:
</p>

<ul>
<li> <p><em>Graphical</em> functional ANOVA tests: <code>graph.fanova</code>
</p>
</li>
<li>
<p> Global rank envelope based on F-values: <code>frank.fanova</code>
</p>
</li>
</ul>
</li>
<li> <p><em>Functional general linear model (GLM)</em>:
</p>

<ul>
<li> <p><em>Graphical</em> functional GLM: <code>graph.flm</code>
</p>
</li>
<li>
<p> Global rank envelope based on F-values: <code>frank.flm</code>
</p>
</li>
<li>
<p> For large data (not fitting comfortably in memory): <code>partial_forder</code>
</p>
</li>
</ul>
</li>
<li> <p><em>Functional clustering</em>: <code>fclustering</code>
</p>
</li>
<li> <p><em>Global quantile regression</em>: <code>global_rq</code>
</p>
</li>
<li>
<p> Functions for performing global envelopes for other specific purposes:
</p>

<ul>
<li>
<p> Graphical n sample test of correspondence of distribution functions: <code>GET.distrequal</code>
</p>
</li>
<li>
<p> Permutation-based tests of independence to samples from any bivariate distribution: <code>GET.distrindep</code>
</p>
</li>
<li>
<p> Testing global and local dependence of point patterns on covariates: <code>GET.spatialF</code>
</p>
</li>
<li>
<p> Testing local correlations: <code>GET.localcor</code>
</p>
</li>
<li>
<p> Variogram and residual variogram with global envelopes: <code>GET.variogram</code>
</p>
</li>
</ul>
</li>
<li>
<p> Deviation tests (for simple hypothesis): <code>deviation_test</code> (no graphical
interpretation)
</p>
</li>
<li>
<p> Most functions accept the curves provided in a <code>curve_set</code> object.
Use <code>curve_set</code> to create a <code>curve_set</code> object from the
functions. Other formats to provide the curves to the above functions are
also accepted, see the information on the help pages.
</p>
</li>
</ul>
<p>See the help files of the functions for examples.
</p>


<h3>Workflow for (single hypothesis) tests based on single functions</h3>

<p>To perform a test you always first need to obtain the test function <code class="reqn">T(r)</code>
for your data (<code class="reqn">T_1(r)</code>) and for each simulation
(<code class="reqn">T_2(r), \dots, T_{s+1}(r)</code>) in one way or another.
Given the set of the functions <code class="reqn">T_i(r), i=1, \dots, s+1</code>,
you can perform a test by <code>global_envelope_test</code>.
</p>
<p>1) The workflow when using your own programs for simulations:
</p>

<ul>
<li>
<p> (Fit the model and) Create <code class="reqn">s</code> simulations from the (fitted) null model.
</p>
</li>
<li>
<p> Calculate the functions <code class="reqn">T_1(r), T_2(r), \dots, T_{s+1}(r)</code>.
</p>
</li>
<li>
<p> Use <code>curve_set</code> to create a <code>curve_set</code> object
from the functions <code class="reqn">T_i(r), i=1, \dots, s+1</code>.
</p>
</li>
<li>
<p> Perform the test
</p>
<p><code>res &lt;- global_envelope_test(curve_set)</code>
</p>
<p>where <code>curve_set</code> is the 'curve_set'-object you created, and plot the result
</p>
<p><code>plot(res)</code>
</p>
</li>
</ul>
<p>2) The workflow utilizing <span class="pkg">spatstat</span>: start R, type <code>library("GET")</code> and <code>vignette("pointpatterns")</code>,
which explains the workflow and gives many examples of point pattern analysis
</p>


<h3>Functions for modifying sets of functions</h3>

<p>It is possible to modify the curve set <code class="reqn">T_1(r), T_2(r), \dots, T_{s+1}(r)</code> for the test.
</p>

<ul>
<li>
<p> You can choose the interval of distances <code class="reqn">[r_{\min}, r_{\max}]</code> by <code>crop_curves</code>.
</p>
</li>
<li>
<p> For better visualisation, you can take <code class="reqn">T(r)-T_0(r)</code> by <code>residual</code>.
Here <code class="reqn">T_0(r)</code> is the expectation of <code class="reqn">T(r)</code> under the null hypothesis.
</p>
</li>
</ul>
<h3>Example data (see references on the help pages of each data set)</h3>


<ul>
<li> <p><code>abide_9002_23</code>: see help page
</p>
</li>
<li> <p><code>adult_trees</code>: a point pattern of adult rees
</p>
</li>
<li> <p><code>cgec</code>: centred government expenditure centralization (GEC) ratios (see <code>graph.fanova</code>)
</p>
</li>
<li> <p><code>fallen_trees</code>: a point pattern of fallen trees
</p>
</li>
<li> <p><code>GDPtax</code>: GDP per capita with country groups and other covariates
</p>
</li>
<li> <p><code>imageset3</code>: a simulated set of images
</p>
</li>
<li> <p><code>rimov</code>: water temperature curves in 365 days of the 36 years
</p>
</li>
<li> <p><code>saplings</code>: a point pattern of saplings (see <code>GET.composite</code>)
</p>
</li>
</ul>
<p>The data sets are used to show examples of the functions of the library.
</p>


<h3>Number of functions</h3>

<p>If the number of functions is low, the choice of the measure (or type or depth) playes a role,
as explained in <code>vignette("GET")</code> (Section 2.4).
</p>
<p>Note that the recommended minimum number of simulations for the rank
envelope test (Myllymäki et al., 2017) based on a single function in spatial statistics is nsim=2499.
When the number of argument values is large, also larger number simulations is needed in order to
have a narrow p-interval.
The "erl", "cont", "area", "qdir" and "st" global envelope tests and deviation tests can be
used with a lower number of simulations, although the Monte Carlo error is obviously larger
with a lower number of simulations.
For increasing the number of simulations, all the global rank envelopes approach the same curves.
</p>
<p>Mrkvička et al. (2017) discussed the number of simulations for tests based on many functions.
</p>


<h3>Documentation</h3>

<p>Myllymäki and Mrkvička (2023) provides description of the package.
The material can also be found in the corresponding vignette, which is available by
starting R and typing <code>library("GET")</code> and <code>vignette("GET")</code>.
</p>
<p>In the special case of spatial processes (spatial point processes, random sets),
the functions are typically estimators of summary functions. The package supports
the use of the R package <span class="pkg">spatstat</span> for generating simulations and calculating
estimators of the chosen summary function, but alternatively these can be done by
any other way, thus allowing for any user-specified models/functions.
To see examples of global envelopes for analysing point pattern data,
start R, type <code>library("GET")</code> and <code>vignette("pointpatterns")</code>.
</p>
<p>Mrkvička and Myllymäki (2023) developed false discovery rate (FDR) envelopes.
Examples can be found by in associated vignette: start R, and type
<code>library("GET")</code> and <code>vignette("pointpatterns")</code>.
</p>
<p>Mrkvička et al. (2023a) proposed global quantile regression. An example of
global quantile regression is given in the vignette <code>vignette("QuantileRegression")</code>.
</p>
<p>The vignette <code>vignette("HotSpots")</code> illustrates the methodology proposed by
Mrkvička et al. (2023b) for detecting hotspots on a linear network.
</p>
<p>Type citation("GET") to get a full list of references.
</p>


<h3>Acknowledgements</h3>

<p>Mikko Kuronen has made substantial contributions of code.
Additional contributions and suggestions from Jiří Dvořák, Pavel Grabarnik,
Ute Hahn, Michael Rost and Henri Seijo.
</p>


<h3>Author(s)</h3>

<p>Mari Myllymäki (mari.myllymaki@luke.fi, mari.j.myllymaki@gmail.com) and
Tomáš Mrkvička (mrkvicka.toma@gmail.com)
</p>


<h3>References</h3>

<p>Dai, W., Athanasiadis, S., Mrkvička, T. (2021) A new functional clustering method with combined dissimilarity sources and graphical interpretation. Intech open, London, UK. DOI: 10.5772/intechopen.100124
</p>
<p>Dvořák, J. and Mrkvička, T. (2022). Graphical tests of independence for general distributions. Computational Statistics 37, 671–699.
</p>
<p>Mrkvička, T., Konstantinou, K., Kuronen, M. and Myllymäki, M. (2023a) Global quantile regression. arXiv:2309.04746 [stat.ME]. https://doi.org/10.48550/arXiv.2309.04746
</p>
<p>Mrkvička, T., Kraft, S., Blažek, V. and Myllymäki, M. (2023b) Hotspots detection on a linear network with presence of covariates: a case study on road crash data. Available at SSRN: http://dx.doi.org/10.2139/ssrn.4598454
</p>
<p>Mrkvička, T., Myllymäki, M. and Hahn, U. (2017) Multiple Monte Carlo testing, with applications in spatial point processes. Statistics &amp; Computing 27(5), 1239-1255. doi: 10.1007/s11222-016-9683-9
</p>
<p>Mrkvička, T., Myllymäki, M., Jilek, M. and Hahn, U. (2020) A one-way ANOVA test for functional data with graphical interpretation. Kybernetika 56(3), 432-458. doi: 10.14736/kyb-2020-3-0432
</p>
<p>Mrkvička, T., Myllymäki, M., Kuronen, M. and Narisetty, N. N. (2022) New methods for multiple testing in permutation inference for the general linear model. Statistics in Medicine 41(2), 276-297. doi: 10.1002/sim.9236
</p>
<p>Mrkvička, T., Myllymäki, M. (2023) False discovery rate envelopes. Statistics and Computing 33, 109. https://doi.org/10.1007/s11222-023-10275-7
</p>
<p>Mrkvička, T., Roskovec, T. and Rost, M. (2021) A nonparametric graphical tests of significance in functional GLM. Methodology and Computing in Applied Probability 23, 593-612. doi: 10.1007/s11009-019-09756-y
</p>
<p>Mrkvička, T., Soubeyrand, S., Myllymäki, M., Grabarnik, P., and Hahn, U. (2016) Monte Carlo testing in spatial statistics, with applications to spatial residuals. Spatial Statistics 18, Part A, 40-53. doi: http://dx.doi.org/10.1016/j.spasta.2016.04.005
</p>
<p>Myllymäki, M., Grabarnik, P., Seijo, H. and Stoyan. D. (2015) Deviation test construction and power comparison for marked spatial point patterns. Spatial Statistics 11, 19-34. doi: 10.1016/j.spasta.2014.11.004
</p>
<p>Myllymäki, M., Mrkvička, T., Grabarnik, P., Seijo, H. and Hahn, U. (2017) Global envelope tests for spatial point patterns. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 79, 381-404. doi: 10.1111/rssb.12172
</p>
<p>Myllymäki, M. and Mrkvička, T. (2023). GET: Global envelopes in R. arXiv:1911.06583 [stat.ME]. https://doi.org/10.48550/arXiv.1911.06583
</p>
<p>Myllymäki, M., Kuronen, M. and Mrkvička, T. (2020). Testing global and local dependence of point patterns on covariates in parametric models. Spatial Statistics 42, 100436. doi: 10.1016/j.spasta.2020.100436
</p>


</div>