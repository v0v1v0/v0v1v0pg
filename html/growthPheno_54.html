<div class="container">

<table style="width: 100%;"><tr>
<td>plotSmoothsMedianDevns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates and plots the medians of the deviations from the observed values for 
several sets of smoothed values  stored in a <code>data.frame</code> in long format.</h2>

<h3>Description</h3>

<p>Calculates and plots the medians of the deviations of the supplied smoothed values from the 
supplied observed values for traits and combinations of different smoothing parameters, 
possibly for subsets of non-smoothing-<code>factor</code> combinations. The observed and smoothed values are supplied in 
long format i.e. with the values for each set of smoothing parameters stacked one under the other 
in the supplied <code>data.frame</code>. Such data can be generated using <code>probeSmooths</code>;  
to prevent <code>probeSmooths</code> producing the plots, which it is does using 
<code>plotSmoothsComparison</code>, <code>plotDeviationsBoxes</code> and 
<code>plotSmoothsMedianDevns</code>, set <code>which.plots</code> to <code>none</code>. 
The smoothing parameters include <code>spline.types</code>, <code>df</code>, <code>lambdas</code> and 
<code>smoothing.methods</code> (see <code>probeSmooths</code>). 
</p>
<p>Multiple plots, possibly each having multiple facets, are produced using <code>ggplot2</code>. 
The layout of these plots is controlled via the smoothing-parameter <code>factor</code>s 
<code>Type</code>, <code>Tuning</code> (the combination of <code>TunePar</code> and <code>TuneVal</code>) and 
<code>Method</code> that can be supplied to the arguments <code>plots.by</code>, 
<code>plots.group</code>, <code>facet.x</code> and <code>facet.y</code>. These <code>plots</code> and 
<code>facet</code> arguments can also include <code>factor</code>s other than the 
smoothing-parameter <code>factor</code>s, that are also associated with the data. 
The basic principle is that the number of levels combinations of the smoothing-parameter 
<code>factor</code>s included in the <code>plots</code> and <code>facet</code> 
arguments must be the same as those covered by the combinations of the values supplied to 
<code>spline.types</code>, <code>df</code>, <code>lambdas</code> and <code>Method</code> and incorporated into the 
<code>smooths.frame</code> input to <code>plotSmoothsMedianDevns</code> via the <code>data</code> argument. 
This ensures that smooths from different parameter sets are not pooled in a single plot. 
Envelopes of the median value of a trait for each <code>factor</code> combination can be added.</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSmoothsMedianDevns(data, response, response.smoothed = NULL, 
                       individuals = "Snapshot.ID.Tag",  times = "DAP", 
                       trait.types = c("response", "AGR", "RGR"), 
                       x.title = NULL, y.titles = NULL, 
                       meddevn.plot.args = 
                         args4meddevn_plot(plots.by = NULL, plots.group = NULL,
                                           facet.x = ".", facet.y = ".", 
                                           propn.note = TRUE, 
                                           propn.types = c(0.1, 0.5, 0.75)), 
                       printPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>smooths.frame</code>, such as is produced by 
<code>probeSmooths</code> and that contains the data resulting from 
smoothing a response over time for a set of <code>individuals</code>, the data 
being arranged in long format both with respect to the 
times and the smoothing-parameter values used in the smoothing. That is, 
each response occupies a single column. The <code>smooths.frame</code> 
must include the columns <code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, 
<code>Tuning</code> and <code>Method</code>, and the columns nominated using the 
arguments <code>individuals</code>, <code>times</code>, <code>plots.by</code>, 
<code>facet.x</code>, <code>facet.y</code>, <code>plots.group</code>, <code>response</code>, 
<code>response.smoothed</code>, and, if requested, the AGR and the RGR of the 
<code>response</code> and <code>response.smoothed</code>. The names of the growth 
rates should be formed from <code>response</code> and <code>response.smoothed</code> 
by adding <code>.AGR</code> and <code>.RGR</code> to both of them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A <code>character</code> specifying the response variable for which the 
observed values are supplied. Depending on the setting of 
<code>trait.types</code>, the observed values of related <code>trait.types</code> 
may also need to be be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response.smoothed</code></td>
<td>
<p>A <code>character</code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code> and obtained for the combinations of 
<code>smoothing.methods</code> and <code>df</code>, usually using smoothing splines. 
If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>. 
Depending on the setting of <code>trait.types</code>, the smoothed 
values of related <code>trait.types</code> may also need to be be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individuals</code></td>
<td>
<p>A <code>character</code> giving the name of the 
<code>factor</code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>A <code>character</code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code>numeric</code>, <code>factor</code>, or 
<code>character</code>. It will be used to provide the values to be plotted 
on the x-axis. If a <code>factor</code> or <code>character</code>, 
the values should be numerics stored as characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.types</code></td>
<td>
<p>A <code>character</code> giving the traits types that are to be 
plotted. While <code>AGR</code> and <code>RGR</code> are commonly used, the names 
can be arbitrary, except that <code>response</code> is a special case that 
indicates that the original response is to be plotted. If <code>all</code>, 
each of <code>response</code>, <code>AGR</code> and <code>RGR</code> is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.title</code></td>
<td>
<p>Title for the x-axis. If <code>NULL</code> then set to <code>times</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.titles</code></td>
<td>
<p>A <code>character</code> giving the titles for the y-axis, 
one for each trait specified by <code>trait.types</code>. 
If <code>NULL</code>, then set to the traits derived for <code>response</code> 
from <code>trait.types</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meddevn.plot.args</code></td>
<td>
<p>A named <code>list</code> that is most easily 
generated using <code>args4meddevn_plot</code>, it documenting the 
options available for varying median deviations plots. <em>Note 
that if <code>args4meddevn_plot</code> is to be called to change 
from the default settings given in the default <code>plotSmoothsMedianDevns</code> 
call and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code>args4meddevn_plot</code>; be aware that if you call 
<code>args4meddevn_plot</code>, then the defaults for this call are 
those for <code>args4meddevn_plot</code>, <b>NOT</b> the call to 
<code>args4meddevn_plot</code> shown as the default for 
<code>plotSmoothsMedianDevns</code>.</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printPlot</code></td>
<td>
<p>A <code>logical</code> indicating whether or not to print the 
plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>allows passing of arguments to other functions; not used at present.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> that consists of two components:  (i) a componenent named  
<code>plots</code> that stores a two-level <code>list</code> of the median deviations 
plots; the first-level <code>list</code> has a component for each 
<code>trait.types</code> and each of these <code>list</code>(s) is a second-level 
<code>list</code> that contains the set of plots specified by <code>plots.by</code> 
(if <code>plots.by</code> is <code>NULL</code>, a single plot is stored); (ii) a component named 
<code>med.dev.dat</code> that stores the <code>data.frame</code> containing the 
median deviations that have been plotted.  Each plot in the <code>plots</code> 
<code>list</code> is in an object of class <code>ggplot</code>, which can be 
plotted using <code>print</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code>traitSmooth</code>, <code>probeSmooths</code>, <code>args4meddevn_plot</code>, <code>plotSmoothsComparison</code>, <code>plotDeviationsBoxes</code>, <code>ggplot</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(exampleData)
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", size=1))
traits &lt;- probeSmooths(data = longi.dat, 
                       response = "PSA", response.smoothed = "sPSA", 
                       times = "DAP", 
                       get.rates = FALSE, trait.types = "response", 
                       smoothing.args = 
                         args4smoothing(smoothing.methods = "direct", 
                                        spline.types = "NCSS", 
                                        df = c(4,7), lambdas = NULL), 
                       which.plots = "none")
med &lt;- plotSmoothsMedianDevns(data = traits, 
                              response = "PSA", response.smoothed = "sPSA", 
                              times = "DAP", trait.types = "response",  
                              meddevn.plot.args = 
                                args4meddevn_plot(plots.by = NULL, 
                                                  plots.group = "Tuning", 
                                                  facet.x = ".", facet.y = ".", 
                                                  propn.types = 0.02,
                                                  ggplotFuncs = vline))
</code></pre>


</div>