<div class="container">

<table style="width: 100%;"><tr>
<td>loglogSurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Survival function plots for checking the tail behaviour of the data
</h2>

<h3>Description</h3>

<p>The log-log Survival functions are design for checking the tails of a single response variable (no explanatory should be involved). There are three different function:
</p>
<p>a) the function <code>loglogSurv1()</code> which plot the right tails of the empirical log-log Survival function against <code>loglog(y)</code>, where y is the variable of interest. The coefficient of a linear fit to the plot can be used as an estimated for Type I tails  (see Chapter 17 in Rigby <em>et al.</em> (2019) for definition of the different types of tails.) 
</p>
<p>b)  the function <code>loglogSurv2()</code> which plot the  right tails of the empirical log-log Survival function against <code>log(y)</code>. The coefficient of a linear fit to the plot can be used as an  estimated for Type II tails. 
</p>
<p>c)  the function <code>loglogSurv3()</code> which plot the (left or right) tails of the empirical log-log Survival function against
<code>y</code>. The coefficient of a linear fit to the plot can be used as an estimated for Type III tails. 
</p>
<p>The function <code>loglogSurv()</code> combines all the above functions. 
</p>
<p>The function <code>logSurv()</code> is design for exploring the heavy tails of a single response variable. It plots the empirical log-survival function of the right tail of the distribution or the empirical log-cdf function  of the  left tail against <code>log(y)</code> for a specified probability of the tail. Then fits a linear, a quadratic and an exponential curve to the points of the plot. For distributions defined on the positive real line a good linear fit would indicate a Pareto type tail, a good quadratic fit a log-normal type tail and good exponential fit a Weibull type tail. Note that this function is only appropriate to investigate rather heavy tails and it is not very good to discriminate between different type of tails, as the <code>loglogSurv()</code>. The function <code>logSurv0()</code> plots but do not fit the curves.
</p>
<p>The function <code>loglogplot()</code> plot  the empirical log-survival function of all data against  <code>log(y)</code>. 
The function <code>ECDF()</code> calculates the empirical commutative distribution function. It is similar to <code>ecdf()</code> but divides by <code>n+1</code> rather <code>n</code>, the number of conservations.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">loglogSurv(y, prob = 0.9, print = TRUE, title = NULL, lcol = gray(0.1), 
           ltype = 1, plot = TRUE, ...)

loglogSurv1(y, prob = 0.9, print = TRUE, title = NULL, lcol = gray(0.1), 
           ltype = 1, ...)

loglogSurv2(y, prob = 0.9, print = TRUE, title = NULL, lcol = gray(0.1), 
           ltype = 1, ...)
           
loglogSurv3(y, prob = 0.9, print = TRUE, title = NULL, lcol = gray(0.1), 
           ltype = 1, ...)
          
logSurv(y, prob = 0.9, tail = c("right", "left"), plot = TRUE, 
       lines = TRUE, print = TRUE, title = NULL, lcol = c(gray(0.1), 
       gray(0.2), gray(0.3)), ltype = c(1, 2, 3), ...)  

logSurv0(y, prob = 0.9, tail = c("right", "left"), plot = TRUE, 
           title = NULL, ...)
           
         
ECDF(y, weights=NULL)

loglogplot(y, nplus1 = TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector, the variable of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>what probability. The defaul is  0.90 which means 10% for "right" tail 90% for "left" tail </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>which tall needs checking the right (default) of the left</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to plot with default equal <code>TRUE</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>whether to print the coefficients with default equal <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>if a different title rather the default is needed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p>The line colour in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>
<p>whether to plot the fitted lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltype</code></td>
<td>
<p>The line type in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nplus1</code></td>
<td>
<p>whether to divide by n+1 or n when calculating the ecdf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>prior weights for <code>ECDF()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra argument in the plot command</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions <code>loglogSurv1()</code>, <code>loglogSurv3()</code> and <code>loglogSurv3()</code> take the upper  part of an ordered variable, create its empirical survival function, and plot the log-log of this functions against <code>log(log(y))</code>, <code>log(y)</code> and <code>y</code>, respectively. Then they fit a line to the plot. The coefficients of the line can be interpreted as parameters determined the behaviour of the tail.
The function <code>loglogSurv()</code> fits all three models and displays  the best. 
</p>
<p>The function <code>logSurv()</code> takes the upper (or lower) part of an ordered variable  and plots the log empirical survival function against log(y). Also display three curves i) linear ii) quadratic and iii) exponential to determine what kind of tail relationship exist. Plotting the log  empirical survival function against log(y) often call in the literature the "log-log plot". 
</p>
<p>The function <code>loglogplot()</code> plots the whole log  empirical survival function against log(y) (not just the tail).  The function <code>ECDF()</code>  calculate the step function of the empirical cumulative distribution function.
</p>
<p>More details can be found in Chapter 17 of  "Rigby <em>et al.</em> (2019)  book  an old version on which can be found in   <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>)
</p>


<h3>Value</h3>

<p>The functions create plots. 
</p>


<h3>Author(s)</h3>

<p>Bob Rigby, Mikis Stasinopoulos and Vlassios Voudouris 
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby R.A., Stasinopoulos D. M., Heller G., and De Bastiani F., (2019) <em>Distributions for Modelling Location, Scale and Shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. (In press)
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(film90)
y &lt;- film90$lborev1
op&lt;-par(mfrow=c(3,1))
loglogSurv1(y)
loglogSurv2(y)
loglogSurv3(y)
par(op)
loglogSurv(y)

logSurv(y)

loglogplot(y)

plot(ECDF(y), main="ECDF")
</code></pre>


</div>