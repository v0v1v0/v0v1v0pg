<div class="container">

<table style="width: 100%;"><tr>
<td>predicted_samples</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw new response values from the conditional distribution of the response</h2>

<h3>Description</h3>

<p>Predicted values of the response (new response data) are drawn from the
fitted model, created via <code>simulate()</code> (e.g. <code>simulate.gam()</code>) and returned
in a tidy, long, format. These predicted values do not include the
uncertainty in the estimated model; they are simply draws from the
conditional distribution of the response.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predicted_samples(model, ...)

## S3 method for class 'gam'
predicted_samples(
  model,
  n = 1,
  data = newdata,
  seed = NULL,
  weights = NULL,
  ...,
  newdata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a fitted model of the supported types</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to other methods. For <code>fitted_samples()</code>, these
are passed on to <code>mgcv::predict.gam()</code>. For <code>posterior_samples()</code> these are
passed on to <code>fitted_samples()</code>. For <code>predicted_samples()</code> these are
passed on to the relevant <code>simulate()</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric; the number of posterior samples to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame; new observations at which the posterior draws
from the model should be evaluated. If not supplied, the data used to fit
the model will be used for <code>data</code>, if available in <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>numeric; a random seed for the simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>numeric; a vector of prior weights. If <code>data</code> is null
then defaults to <code>object[["prior.weights"]]</code>, otherwise a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Deprecated: use <code>data</code> instead.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tibble (data frame) with 3 columns containing the posterior
predicted values in long format. The columns are
</p>

<ul>
<li> <p><code>row</code> (integer) the row of <code>data</code> that each posterior draw relates to,
</p>
</li>
<li> <p><code>draw</code> (integer) an index, in range <code>1:n</code>, indicating which draw each row
relates to,
</p>
</li>
<li> <p><code>response</code> (numeric) the predicted response for the indicated row of
<code>data</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>Examples</h3>

<pre><code class="language-R">load_mgcv()

dat &lt;- data_sim("eg1", n = 1000, dist = "normal", scale = 2, seed = 2)
m &lt;- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = "REML")

predicted_samples(m, n = 5, seed = 42)

## Can pass arguments to predict.gam()

newd &lt;- data.frame(
  x0 = runif(10), x1 = runif(10), x2 = runif(10),
  x3 = runif(10)
)

## Exclude s(x2)
predicted_samples(m, n = 5, newd, exclude = "s(x2)", seed = 25)

## Exclude s(x1)
predicted_samples(m, n = 5, newd, exclude = "s(x1)", seed = 25)

## Select which terms --- result should be the same as previous
## but note that we have to include any parametric terms, including the
## constant term
predicted_samples(m,
  n = 5, newd, seed = 25,
  terms = c("Intercept", "s(x0)", "s(x2)", "s(x3)")
)

</code></pre>


</div>