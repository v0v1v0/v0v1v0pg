<div class="container">

<table style="width: 100%;"><tr>
<td>grcmle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Maximum likelihood estimation of Poisson or ZIP parameters at the aggregate level.
</h2>

<h3>Description</h3>

<p>This function infers Poisson or zero-inflated Poisson (ZIP) parameters from grouped and right-censored count data,
and conducts a chi-squared goodness-of-fit test.
A grouped and right-censored scheme may look like
</p>
<p><code>  0, 1, 2--4, 5--8, 9+.</code>
</p>
<p>For grouped and right-censored count data collected in a survey, such as frequency of alcohol drinking, number of births or occurrence of crimes,
the response category designed as the example above means never, once, 2 to 4 times, 5 to 8 times, 9 times and more.
The frequency distribution from a sample corresponding to the example above may look like
</p>
<p><code>  3, 15, 168, 155, 15</code>.

</p>


<h3>Usage</h3>

<pre><code class="language-R">grcmle(counts, scheme, method = c("Poisson", "ZIP"),
  do.plot = T, init.guess = NULL,
  optimizing.algorithm.index = 2, lambda.extend.ratio = 3,
  conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>

<p>specifies the frequency distribution of the grouped and right-censored count data. For the example above, one may input
</p>
<p><code>  counts = c(3, 15, 168, 155, 15)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scheme</code></td>
<td>

<p>specifies the grouping scheme. It should be a vector of integers containing the starting
point (or the lowest integer) of each group. For example, to input the scheme above
</p>
<p><code>  0, 1, 2--4, 5--8, 9+,</code>
</p>
<p>one may use
</p>
<p><code>  scheme = c(0, 1, 2, 5, 9)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a string parameter specifies which statistical model to use. Currently there are two options
<code>"Poisson"</code> and <code>"ZIP"</code>. The default value is <code>"Poisson"</code>.
It can be abbreviated.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.plot</code></td>
<td>

<p>a logical variable indicating whether or not to plot the log likelihood.
The default is <code>T</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.guess</code></td>
<td>

<p>the initial value used for the optimization procedure of the likelihood estimation. The default value
is <code>NULL</code>, which instructs the function <code>grcmle</code> to select the initial value automatically.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizing.algorithm.index</code></td>
<td>


<p>defines which optimization algorithm to use. Currently the possible values are <code>1,2,3,4,5,6,7</code> and <code>8</code>,
representing the following algorithms, respectively:
</p>
<p><code>  NLOPT_GN_DIRECT_L</code>
</p>
<p><code>  NLOPT_GN_DIRECT</code>
</p>
<p><code>  NLOPT_GN_DIRECT_L_RAND</code>
</p>
<p><code>  NLOPT_GN_DIRECT_NOSCAL</code>
</p>
<p><code>  NLOPT_GN_DIRECT_L_NOSCAL</code>
</p>
<p><code>  NLOPT_GN_DIRECT_L_RAND_NOSCAL</code>
</p>
<p><code>  NLOPT_GN_ORIG_DIRECT</code>
</p>
<p><code>  NLOPT_GN_ORIG_DIRECT_L</code>
</p>
<p>For details of these algorithms, please see the manual of the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package <code>"nloptr"</code>.
The default value is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.extend.ratio</code></td>
<td>

<p>specifies the searching interval of possible <code class="reqn">\lambda</code> as <code class="reqn">[0, nr]</code>, where <code class="reqn">n</code> is the left end (i.e., the lowest integer)
of the last right-censored group, and <code class="reqn">r</code> is <code>lambda.extend.ratio</code>. By default,
we set
</p>
<p><code>lambda.extend.ratio=3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>confidence level of the confidence interval(s) for the parameter(s) inferred
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Maximum likelihood estimation is used for the inference.

</p>


<h3>Value</h3>

<p>The returned value is a list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>the parameter(s) inferred. For Poisson model, it is the estimate of <code class="reqn">\lambda</code>.
For ZIP model, it shows a vector of length 2: the first element is the estimate of <code class="reqn">p</code> and
the second element is the estimate of <code class="reqn">\lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the chi-squared test of goodness-of-fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degree(s) of freedom of the chi-squared test of goodness-of-fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.lambda</code></td>
<td>
<p>the confidence interval of <code class="reqn">\lambda</code> obtained by normal approximation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.p</code></td>
<td>
<p>the confidence interval of <code class="reqn">p</code> obtained by normal approximation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>the confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>the standard error of <code class="reqn">\lambda</code>
or the standard errors of <code class="reqn">(p, \lambda)</code>, if a ZIP model is specified</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>


<p>Authors: Xin Guo &lt;x.guo@polyu.edu.hk&gt;, Qiang Fu &lt;qiang.fu@ubc.ca&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">grcmle(counts=c(6, 15, 168, 155, 15), scheme = c(0, 1, 2, 5, 9))

grcmle(counts=c(6, 15, 168, 155, 15), scheme = c(0, 1, 2, 5, 9), method = "ZIP")

</code></pre>


</div>