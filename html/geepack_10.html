<div class="container">

<table style="width: 100%;"><tr>
<td>geeglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Generalized Estimating Equations (GEE)</h2>

<h3>Description</h3>

<p>The geeglm function fits generalized estimating equations using
the 'geese.fit' function of the 'geepack' package for doing the actual
computations. geeglm has a syntax similar to glm and returns an object
similar to a glm object.  An important feature of geeglm, is that an
anova method exists for these models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">geeglm(
  formula,
  family = gaussian,
  data = parent.frame(),
  weights,
  subset,
  na.action,
  start = NULL,
  etastart,
  mustart,
  offset,
  control = geese.control(...),
  method = "glm.fit",
  contrasts = NULL,
  id,
  waves = NULL,
  zcor = NULL,
  corstr = "independence",
  scale.fix = FALSE,
  scale.value = 1,
  std.err = "san.se",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>No action is taken. Indeed geeglm only works on complete
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etastart</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mustart</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>See corresponding documentation to <code>glm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector which identifies the clusters.  The length of
‘id’ should be the same as the number of observations.  Data
are assumed to be sorted so that observations on each cluster
appear as contiguous rows in data. If data is not sorted this
way, the function will not identify the clusters correctly. If
data is not sorted this way, a warning will be issued. Please
consult the package vignette for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waves</code></td>
<td>
<p>Wariable specifying the ordering of repeated
mesurements on the same unit.  Also used in connection with
missing values. Please consult the package vignette for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zcor</code></td>
<td>
<p>Used for entering a user defined working correlation
structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>a character string specifying the correlation
structure. The following are permitted: '"independence"',
'"exchangeable"', '"ar1"', '"unstructured"' and '"userdefined"'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.fix</code></td>
<td>
<p>a logical variable; if true, the scale parameter
is fixed at the value of 'scale.value'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.value</code></td>
<td>
<p>numeric variable giving the value to which the
scale parameter should be fixed; used only if 'scale.fix =
TRUE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>Type of standard error to be calculated. Defualt
'san.se' is the usual robust estimate.  Other options are
'jack': if approximate jackknife variance estimate should be
computed.  'j1s': if 1-step jackknife variance estimate should
be computed.  'fij': logical indicating if fully iterated
jackknife variance estimate should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the case of corstr="fixed" one must provide the zcor vector if
the clusters have unequal sizes. Clusters with size one must not be
represented in zcor.
</p>


<h3>Value</h3>

<p>An object of type 'geeglm'
</p>


<h3>Warning </h3>

<p>Use "unstructured" correlation structure only with great
care. (It may cause R to crash).
</p>


<h3>Note</h3>

<p>See the documentation for the 'geese' function for additional
information. geeglm only works for complete data. Thus if there are NA's
in data you can specify data=na.omit(mydata).
</p>


<h3>Author(s)</h3>

<p>Søren Højsgaard, <a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a>
</p>


<h3>References</h3>

<p>Halekoh, U.; Højsgaard, S. and Yan, J (2006)
The R Package geepack for Generalized Estimating Equations.
Journal of Statistical Software, 15, 2, 1-11"
</p>
<p>Liang, K.Y. and Zeger, S.L. (1986) Longitudinal data analysis using
generalized linear models. Biometrika, <em>73</em> 13-22.
</p>
<p>Prentice, R.L. and Zhao, L.P. (1991). Estimating equations for
parameters in means and covariances of multivariate discrete and
continuous responses.  Biometrics, <em>47</em> 825-839.
</p>


<h3>See Also</h3>

<p><code>geese</code>, <code>glm</code>, <code>anova.geeglm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(dietox)
dietox$Cu     &lt;- as.factor(dietox$Cu)
mf &lt;- formula(Weight ~ Cu * (Time + I(Time^2) + I(Time^3)))
gee1 &lt;- geeglm(mf, data=dietox, id=Pig, family=poisson("identity"), corstr="ar1")
gee1
coef(gee1)
vcov(gee1)
summary(gee1)
coef(summary(gee1))

mf2 &lt;- formula(Weight ~ Cu * Time + I(Time^2) + I(Time^3))
gee2 &lt;- geeglm(mf2, data=dietox, id=Pig, family=poisson("identity"), corstr="ar1")
anova(gee2)

# Notice the difference here: Clusters of observations must
# appear as chunks in data. 

set.seed(1)
chick1 &lt;- ChickWeight
chick2 &lt;- chick1[sample(nrow(chick1)),]
chick3 &lt;- chick2[order(chick2$Chick),]

fit1 &lt;- geeglm(weight~Time, id=Chick, data=chick1)
fit2 &lt;- geeglm(weight~Time, id=Chick, data=chick2)
fit3 &lt;- geeglm(weight~Time, id=Chick, data=chick3)

vcov(fit1)
vcov(fit2)
vcov(fit3)



</code></pre>


</div>