<div class="container">

<table style="width: 100%;"><tr>
<td>RatQuad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rational Quadratic Kernel R6 class</h2>

<h3>Description</h3>

<p>Rational Quadratic Kernel R6 class
</p>
<p>Rational Quadratic Kernel R6 class
</p>


<h3>Usage</h3>

<pre><code class="language-R">k_RatQuad(
  beta,
  alpha = 1,
  s2 = 1,
  D,
  beta_lower = -8,
  beta_upper = 6,
  beta_est = TRUE,
  alpha_lower = 1e-08,
  alpha_upper = 100,
  alpha_est = TRUE,
  s2_lower = 1e-08,
  s2_upper = 1e+08,
  s2_est = TRUE,
  useC = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Initial beta value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Initial alpha value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>Initial variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Number of input dimensions of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_lower</code></td>
<td>
<p>Lower bound for beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_upper</code></td>
<td>
<p>Upper bound for beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_est</code></td>
<td>
<p>Should beta be estimated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_lower</code></td>
<td>
<p>Lower bound for alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_upper</code></td>
<td>
<p>Upper bound for alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_est</code></td>
<td>
<p>Should alpha be estimated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2_lower</code></td>
<td>
<p>Lower bound for s2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2_upper</code></td>
<td>
<p>Upper bound for s2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2_est</code></td>
<td>
<p>Should s2 be estimated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useC</code></td>
<td>
<p>Should C code used? Much faster if implemented.</p>
</td>
</tr>
</table>
<h3>Format</h3>

<p><code>R6Class</code> object.
</p>


<h3>Value</h3>

<p>Object of <code>R6Class</code> with methods for fitting GP model.
</p>


<h3>Super classes</h3>

<p><code>GauPro::GauPro_kernel</code> -&gt; <code>GauPro::GauPro_kernel_beta</code> -&gt; <code>GauPro_kernel_RatQuad</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>alpha</code></dt>
<dd>
<p>alpha value (the exponent). Between 0 and 2.</p>
</dd>
<dt><code>logalpha</code></dt>
<dd>
<p>Log of alpha</p>
</dd>
<dt><code>logalpha_lower</code></dt>
<dd>
<p>Lower bound for log of alpha</p>
</dd>
<dt><code>logalpha_upper</code></dt>
<dd>
<p>Upper bound for log of alpha</p>
</dd>
<dt><code>alpha_est</code></dt>
<dd>
<p>Should alpha be estimated?</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-GauPro_kernel_RatQuad-new"><code>RatQuad$new()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-k"><code>RatQuad$k()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-kone"><code>RatQuad$kone()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-dC_dparams"><code>RatQuad$dC_dparams()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-dC_dx"><code>RatQuad$dC_dx()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-param_optim_start"><code>RatQuad$param_optim_start()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-param_optim_start0"><code>RatQuad$param_optim_start0()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-param_optim_lower"><code>RatQuad$param_optim_lower()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-param_optim_upper"><code>RatQuad$param_optim_upper()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-set_params_from_optim"><code>RatQuad$set_params_from_optim()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-print"><code>RatQuad$print()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_RatQuad-clone"><code>RatQuad$clone()</code></a>
</p>
</li>
</ul>
<details open><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro_kernel" data-id="plot"><a href="../../GauPro/html/GauPro_kernel.html#method-GauPro_kernel-plot"><code>GauPro::GauPro_kernel$plot()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro_kernel_beta" data-id="C_dC_dparams"><a href="../../GauPro/html/GauPro_kernel_beta.html#method-GauPro_kernel_beta-C_dC_dparams"><code>GauPro::GauPro_kernel_beta$C_dC_dparams()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro_kernel_beta" data-id="s2_from_params"><a href="../../GauPro/html/GauPro_kernel_beta.html#method-GauPro_kernel_beta-s2_from_params"><code>GauPro::GauPro_kernel_beta$s2_from_params()</code></a></span></li>
</ul></details><hr>
<a id="method-GauPro_kernel_RatQuad-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Initialize kernel object
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$new(
  beta,
  alpha = 1,
  s2 = 1,
  D,
  beta_lower = -8,
  beta_upper = 6,
  beta_est = TRUE,
  alpha_lower = 1e-08,
  alpha_upper = 100,
  alpha_est = TRUE,
  s2_lower = 1e-08,
  s2_upper = 1e+08,
  s2_est = TRUE,
  useC = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>beta</code></dt>
<dd>
<p>Initial beta value</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>Initial alpha value</p>
</dd>
<dt><code>s2</code></dt>
<dd>
<p>Initial variance</p>
</dd>
<dt><code>D</code></dt>
<dd>
<p>Number of input dimensions of data</p>
</dd>
<dt><code>beta_lower</code></dt>
<dd>
<p>Lower bound for beta</p>
</dd>
<dt><code>beta_upper</code></dt>
<dd>
<p>Upper bound for beta</p>
</dd>
<dt><code>beta_est</code></dt>
<dd>
<p>Should beta be estimated?</p>
</dd>
<dt><code>alpha_lower</code></dt>
<dd>
<p>Lower bound for alpha</p>
</dd>
<dt><code>alpha_upper</code></dt>
<dd>
<p>Upper bound for alpha</p>
</dd>
<dt><code>alpha_est</code></dt>
<dd>
<p>Should alpha be estimated?</p>
</dd>
<dt><code>s2_lower</code></dt>
<dd>
<p>Lower bound for s2</p>
</dd>
<dt><code>s2_upper</code></dt>
<dd>
<p>Upper bound for s2</p>
</dd>
<dt><code>s2_est</code></dt>
<dd>
<p>Should s2 be estimated?</p>
</dd>
<dt><code>useC</code></dt>
<dd>
<p>Should C code used? Much faster if implemented.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-k"></a>



<h4>Method <code>k()</code>
</h4>

<p>Calculate covariance between two points
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$k(
  x,
  y = NULL,
  beta = self$beta,
  logalpha = self$logalpha,
  s2 = self$s2,
  params = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>vector.</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>vector, optional. If excluded, find correlation
of x with itself.</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>Correlation parameters.</p>
</dd>
<dt><code>logalpha</code></dt>
<dd>
<p>A correlation parameter</p>
</dd>
<dt><code>s2</code></dt>
<dd>
<p>Variance parameter.</p>
</dd>
<dt><code>params</code></dt>
<dd>
<p>parameters to use instead of beta and s2.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-kone"></a>



<h4>Method <code>kone()</code>
</h4>

<p>Find covariance of two points
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$kone(x, y, beta, theta, alpha, s2)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>vector</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>vector</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>correlation parameters on log scale</p>
</dd>
<dt><code>theta</code></dt>
<dd>
<p>correlation parameters on regular scale</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>A correlation parameter</p>
</dd>
<dt><code>s2</code></dt>
<dd>
<p>Variance parameter</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-dC_dparams"></a>



<h4>Method <code>dC_dparams()</code>
</h4>

<p>Derivative of covariance with respect to parameters
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$dC_dparams(params = NULL, X, C_nonug, C, nug)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>Kernel parameters</p>
</dd>
<dt><code>X</code></dt>
<dd>
<p>matrix of points in rows</p>
</dd>
<dt><code>C_nonug</code></dt>
<dd>
<p>Covariance without nugget added to diagonal</p>
</dd>
<dt><code>C</code></dt>
<dd>
<p>Covariance with nugget</p>
</dd>
<dt><code>nug</code></dt>
<dd>
<p>Value of nugget</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-dC_dx"></a>



<h4>Method <code>dC_dx()</code>
</h4>

<p>Derivative of covariance with respect to X
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$dC_dx(XX, X, theta, beta = self$beta, alpha = self$alpha, s2 = self$s2)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>XX</code></dt>
<dd>
<p>matrix of points</p>
</dd>
<dt><code>X</code></dt>
<dd>
<p>matrix of points to take derivative with respect to</p>
</dd>
<dt><code>theta</code></dt>
<dd>
<p>Correlation parameters</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>log of theta</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>parameter</p>
</dd>
<dt><code>s2</code></dt>
<dd>
<p>Variance parameter</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-param_optim_start"></a>



<h4>Method <code>param_optim_start()</code>
</h4>

<p>Starting point for parameters for optimization
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$param_optim_start(
  jitter = F,
  y,
  beta_est = self$beta_est,
  alpha_est = self$alpha_est,
  s2_est = self$s2_est
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>jitter</code></dt>
<dd>
<p>Should there be a jitter?</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>Output</p>
</dd>
<dt><code>beta_est</code></dt>
<dd>
<p>Is beta being estimated?</p>
</dd>
<dt><code>alpha_est</code></dt>
<dd>
<p>Is alpha being estimated?</p>
</dd>
<dt><code>s2_est</code></dt>
<dd>
<p>Is s2 being estimated?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-param_optim_start0"></a>



<h4>Method <code>param_optim_start0()</code>
</h4>

<p>Starting point for parameters for optimization
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$param_optim_start0(
  jitter = F,
  y,
  beta_est = self$beta_est,
  alpha_est = self$alpha_est,
  s2_est = self$s2_est
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>jitter</code></dt>
<dd>
<p>Should there be a jitter?</p>
</dd>
<dt><code>y</code></dt>
<dd>
<p>Output</p>
</dd>
<dt><code>beta_est</code></dt>
<dd>
<p>Is beta being estimated?</p>
</dd>
<dt><code>alpha_est</code></dt>
<dd>
<p>Is alpha being estimated?</p>
</dd>
<dt><code>s2_est</code></dt>
<dd>
<p>Is s2 being estimated?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-param_optim_lower"></a>



<h4>Method <code>param_optim_lower()</code>
</h4>

<p>Lower bounds of parameters for optimization
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$param_optim_lower(
  beta_est = self$beta_est,
  alpha_est = self$alpha_est,
  s2_est = self$s2_est
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>beta_est</code></dt>
<dd>
<p>Is beta being estimated?</p>
</dd>
<dt><code>alpha_est</code></dt>
<dd>
<p>Is alpha being estimated?</p>
</dd>
<dt><code>s2_est</code></dt>
<dd>
<p>Is s2 being estimated?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-param_optim_upper"></a>



<h4>Method <code>param_optim_upper()</code>
</h4>

<p>Upper bounds of parameters for optimization
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$param_optim_upper(
  beta_est = self$beta_est,
  alpha_est = self$alpha_est,
  s2_est = self$s2_est
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>beta_est</code></dt>
<dd>
<p>Is beta being estimated?</p>
</dd>
<dt><code>alpha_est</code></dt>
<dd>
<p>Is alpha being estimated?</p>
</dd>
<dt><code>s2_est</code></dt>
<dd>
<p>Is s2 being estimated?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-set_params_from_optim"></a>



<h4>Method <code>set_params_from_optim()</code>
</h4>

<p>Set parameters from optimization output
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$set_params_from_optim(
  optim_out,
  beta_est = self$beta_est,
  alpha_est = self$alpha_est,
  s2_est = self$s2_est
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>optim_out</code></dt>
<dd>
<p>Output from optimization</p>
</dd>
<dt><code>beta_est</code></dt>
<dd>
<p>Is beta being estimated?</p>
</dd>
<dt><code>alpha_est</code></dt>
<dd>
<p>Is alpha being estimated?</p>
</dd>
<dt><code>s2_est</code></dt>
<dd>
<p>Is s2 being estimated?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_RatQuad-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Print this object
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$print()</pre></div>


<hr>
<a id="method-GauPro_kernel_RatQuad-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>RatQuad$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">k1 &lt;- RatQuad$new(beta=0, alpha=0)
</code></pre>


</div>