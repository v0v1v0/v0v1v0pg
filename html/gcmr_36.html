<div class="container">

<table style="width: 100%;"><tr>
<td>residuals.gcmr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile Residuals for Gaussian Copula Marginal Regression</h2>

<h3>Description</h3>

<p>Computes various type of quantile residuals for validation of a fitted Gaussian copula marginal regression model, as described in Masarotto and Varin (2012; 2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gcmr'
residuals(object, type=c("conditional","marginal"),
          method=c("random","mid"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>gcmr</code>, typically the result of
a call to <code>gcmr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>the type of quantile residuals which should be returned.
The alternatives are: <code>"conditional"</code> (default) and <code>"marginal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>different methods available for quantile residuals in case of discrete responses:
<code>"random"</code> for randomized quantile residuals (default), and 
<code>"mid"</code> for mid interval quantile residuals as defined in Zucchini and MacDonald (2009).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Quantile residuals are defined in Dunn and Smyth (1996). Two different types are available:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>conditional</code> </td>
<td style="text-align: left;"> quantile residuals that account for the dependence. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>marginal</code> </td>
<td style="text-align: left;"> quantile residuals that do not account for the dependence.
</td>
</tr>
</table>
<p>Conditional quantile residuals are normal quantiles of Rosenblatt (1952) transformations and they are appropriate for validation of the marginal regression models discussed in Masarotto and Varin (2012; 2017). If the responses are discrete, then the conditional quantile residuals are not well defined. This difficulty is overcame by randomized quantile residuals available through option <code>method="random"</code>. Alternatively, Zucchini and MacDonald (2009) suggest the use of mid interval quantile residuals (<code>method="mid"</code>). 
</p>


<h3>Note</h3>

<p>Differently from randomized quantile residuals, mid quantile residuals are <b>not</b> realizations of incorrelated standard normal variables under model conditions.
</p>
<p>It is appropriate to inspect several sets of randomized quantile residuals before to take a decision about the model.
</p>
<p>See Masarotto and Varin (2012; 2017) for more details.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Dunn, P.K. and Smyth, G.K. (1996). Randomized quantile residuals. <em>Journal of Computational and Graphical Statistics</em> <b>5</b>, 236–244.
</p>
<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517–1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1–26. 
</p>
<p>Rosenblatt, M. (1952). Remarks on a multivariate transformation. <em>The Annals of Mathematical Statistics</em> <b>23</b>, 470–472.
</p>
<p>Zucchini, W. and MacDonald, I.L. (2009). <em>Hidden Markov Models for Time Series</em>. Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p><code>gcmr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## spatial binomial data
## Not run: 
data(malaria)
D &lt;- sp::spDists(cbind(malaria$x, malaria$y))/1000
m &lt;- gcmr(cbind(cases, size-cases) ~ netuse+I(green/100)+phc, data=malaria, 
marginal=binomial.marg, cormat=matern.cormat(D))
res &lt;- residuals(m)
## normal probability plot
qqnorm(res)
qqline(res)
## or better via plot.gcmr
plot(m, which = 3)

## End(Not run)
</code></pre>


</div>