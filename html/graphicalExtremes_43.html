<div class="container">

<table style="width: 100%;"><tr>
<td>fmpareto_HR_MLE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter fitting for multivariate Huesler-Reiss Pareto distribution</h2>

<h3>Description</h3>

<p>Fits the parameters of a multivariate Huesler-Reiss Pareto distribution
using (censored) maximum likelihood estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmpareto_HR_MLE(
  data,
  p = NULL,
  cens = FALSE,
  init = NULL,
  fixParams = integer(0),
  useTheta = TRUE,
  maxit = 100,
  graph = NULL,
  optMethod = "BFGS",
  nAttemptsFixInit = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Numeric <code class="reqn">n \times d</code> matrix, where <code>n</code> is the
number of observations and <code>d</code> is the number of dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Numeric scalar between 0 and 1 or <code>NULL</code>. If <code>NULL</code> (default),
it is assumed that the <code>data</code> is already on a multivariate Pareto scale. Else,
<code>p</code> is used as the probability in <code>data2mpareto()</code> to standardize the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>
<p>Logical scalar. If true, then censored likelihood contributions are used for
components below the threshold. This is computationally expensive and by default <code>cens = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Numeric vector or numeric matrix. Initial parameter values in the optimization.
If <code>NULL</code>, the empirical variogram is used instead. Otherwise should be a numeric
vector with one entry per edge in <code>graph</code>, or a complete variogram/precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixParams</code></td>
<td>
<p>Numeric or logical vector. Indices of the parameter vectors that are kept
fixed (identical to <code>init</code>) during the optimization. Default is <code>integer(0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useTheta</code></td>
<td>
<p>Logical. Whether to perform the MLE optimization in terms of Theta or Gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Positive integer. The maximum number of iterations in the optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>Graph object from <code>igraph</code> package or <code>NULL</code> (implying the complete graph).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optMethod</code></td>
<td>
<p>String. A valid optimization method used by the function
stats::optim. By default, <code>method = "BFGS"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nAttemptsFixInit</code></td>
<td>
<p>Numeric. If <code>useTheta=TRUE</code> and the initial parameter <code>init</code> is not valid,
attempt to fix it first by making sure all off-diagonal entries are negative and then adding some random noise
at most this many times.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Only the parameters corresponding to edges in <code>graph</code> are optimized, the remaining
entries are implied by the graphical structure. If <code>graph</code> is <code>NULL</code>, the complete graph is used.
The optimization is done either in terms of the variogram (Gamma) or precision matrix (Theta),
depending on the value of <code>useTheta</code>. If <code>graph</code> is non-decomposable,
<code>useTheta=TRUE</code> is significantly faster, otherwise they are similar in performance.
</p>


<h3>Value</h3>

<p>List consisting of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Logical. Indicates whether the optimization converged or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>Numeric <code style="white-space: pre;">⁠d x d⁠</code> matrix. Fitted variogram matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta</code></td>
<td>
<p>Numeric <code style="white-space: pre;">⁠d x d⁠</code> matrix. Fitted precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Numeric vector. Optimal parameters, including fixed parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par_opt</code></td>
<td>
<p>Numeric. Optimal parameters, excluding fixed parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nllik</code></td>
<td>
<p>Numeric. Optimal value of the negative log-likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>Numeric matrix. Estimated Hessian matrix of the estimated parameters.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>Other parameter estimation methods:
<code>data2mpareto()</code>,
<code>emp_chi_multdim()</code>,
<code>emp_chi()</code>,
<code>emp_vario()</code>,
<code>emtp2()</code>,
<code>fmpareto_graph_HR()</code>,
<code>loglik_HR()</code>
</p>


</div>