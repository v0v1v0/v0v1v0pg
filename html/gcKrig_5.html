<div class="container">

<table style="width: 100%;"><tr>
<td>corrTG</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Correlation in  Transformed Gaussian Random Fields</h2>

<h3>Description</h3>

<p>This function implements two general methods for computing the correlation function in
a transformed Gaussian random field.
</p>


<h3>Usage</h3>

<pre><code class="language-R">corrTG(marg1, marg2, corrGauss = 0.5, method = "integral", nrep = 1000,
       kmax = 10, earlystop = FALSE, epscut = 1e-3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>marg1</code></td>
<td>
<p>an object of class <code>marginal.gc</code> specifying the first marginal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marg2</code></td>
<td>
<p>an object of class <code>marginal.gc</code> specifying the second marginal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrGauss</code></td>
<td>
<p>the correlation in the Gaussian random field. Should be a scalar between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the computation method of calculating correlation in the transformed Gaussian random field.
Can be either "integral" or "mc".
If use "integral" then a series expansion based on the Hermite Polynomials will be used to approximate the
correlation, see De Oliveira (2013) or Han and De Oliveira (2016).
If use "mc" then the Monte Carlo method will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>the Monte Carlo size in computing the correlation. Only need to be specified if <code>method = "mc"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>
<p>the maximum number of terms used in the series summation (with Hermite polynomial expansion).
Only need to be specified if <code>method = "integral"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>earlystop</code></td>
<td>
<p>whether or not to allow the series summation to stop early.
If <code>earlystop = FALSE</code> then a total number of kmax terms will be kept.
If <code>earlystop = TRUE</code> then the series will be automatically truncated if the absolute values
of the three consecutive terms are smaller than <code>epscut</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epscut</code></td>
<td>
<p>a small positive value used to truncate the series.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>method = "mc"</code> the output is a scalar between 0 and 1, denoting the correlation of the transformed Gaussian random field. If <code>method = "integral"</code> the output is a scalar of the correlation in the transformed Gaussian random field, and a list of the values in the series expansion based on the integral with Hermite polynomials.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>De Oliveira, V. (2013) Hierarchical Poisson models for spatial count data.
<em>Journal of Multivariate Analysis,122:393-408</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2016) On the correlation structure of Gaussian
copula models for geostatistical count data.
<em>Australian and New Zealand Journal of Statistics, 58:47-69</em>.
</p>
<p>Han, Z. and De Oliveira, V. (2018) gcKrig: An R Package for the Analysis of Geostatistical Count Data Using Gaussian Copulas.
<em>Journal of Statistical Software</em>, <b>87</b>(13), 1â€“32. doi: <a href="https://doi.org/10.18637/jss.v087.i13">10.18637/jss.v087.i13</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
corrTG(marg1 = poisson.gc(lambda = 10), marg2 = binomial.gc(size = 1, prob = 0.1),
       corrGauss = 0.5, method = "integral", kmax = 10, earlystop = TRUE, epscut = 1e-5)
set.seed(12345)
corrTG(marg1 = poisson.gc(lambda = 10), marg2 = binomial.gc(size = 1, prob = 0.1),
       corrGauss = 0.5, nrep = 100000, method = "mc")

## End(Not run)
</code></pre>


</div>