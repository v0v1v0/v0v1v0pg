<div class="container">

<table style="width: 100%;"><tr>
<td>linear_transformation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Full Alignment of Peak Lists by linear retention time correction.</h2>

<h3>Description</h3>

<p>Shifts all peaks within samples to maximise the similarity to a reference sample. For optimal results, a sufficient number of shared peaks are required to find a optimal solution. A reference needs to be specified, for instance using <code>choose_optimal_reference</code>. Linear shifts are evaluated within a user-defined window in discrete steps. The highest similarity score defines the shift that will be applied. If more than a single shift step yields to the same similarity score, the smallest absolute value wins in order to avoid overcompensation. The functions is envoked internally by <code>align_chromatograms</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">linear_transformation(
  gc_peak_list,
  reference,
  max_linear_shift = 0.05,
  step_size = 0.01,
  rt_col_name,
  Logbook = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gc_peak_list</code></td>
<td>
<p>List of data.frames. Each data.frame contains GC-data
(e.g. retention time, peak area, peak height) of one sample. Variables are
stored in columns. Rows represent distinct peaks. Retention time is a
required variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>A character giving the name of a sample included in the dataset. All samples are aligned to the reference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_linear_shift</code></td>
<td>
<p>Numeric value giving the window size considered in the full alignment. Usually, the amplitude of linear drift is small in typical GC-FID datasets. Therefore, the default value of 0.05 minutes is adequate for most datasets. Increase this value if the drift amplitude is larger.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step_size</code></td>
<td>
<p>Integer giving the step size in which linear shifts are evaluated between <code>max_linear_shift</code> and <code>-max_linear_shift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rt_col_name</code></td>
<td>
<p>A character giving the name of the column containing the retention times. The decimal separator needs to be a point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Logbook</code></td>
<td>
<p>A list. If present, a summary of the applied linear shifts in full alignments of peak lists is appended to the list. If not specified, a list will be created automatically.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A similarity score is calculated as the sum of deviations in retention times between all reference peaks and the closest peak in the sample. The principle idea is that the appropriate linear transformation will reduce the deviation in retention time between homologous peaks, whereas all other peaks should deviate randomly. Among all considered shifts, the minimum deviation score is selected for subsequent full alignment by shifting all peaks of the sample by the same value.
</p>


<h3>Value</h3>

<p>A list containing two items.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>chroma_aligned</code></td>
<td>
<p>List containing the transformed data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Logbook</code></td>
<td>
<p>Logbook, record of the applied shifts</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Martin Stoffel (martin.adam.stoffel@gmail.com) &amp;
Meinolf Ottensmann (meinolf.ottensmann@web.de)
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat &lt;- peak_data[1:10]
dat &lt;- lapply(dat, function(x) x[1:50,])
x &lt;- linear_transformation(gc_peak_list = dat, reference = "C2", rt_col_name = "time")

</code></pre>


</div>