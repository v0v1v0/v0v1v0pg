<div class="container">

<table style="width: 100%;"><tr>
<td>georobObject</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitted georob Object</h2>

<h3>Description</h3>

<p>An object of class <code>georob</code> as returned by <code>georob</code> and
representing a (robustly) fitted spatial linear model.  Objects of this
class have methods for model building (see
<code>georobModelBuilding</code>) and cross-validation (see
<code>cv.georob</code>), for computing (robust) Kriging predictions (see
<code>predict.georob</code>), for plotting (see
<code>plot.georob</code>) and for common generic functions (see
<code>georobMethods</code>).  </p>


<h3>Value</h3>

<p>A <code>georob</code> object is a list with following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the maximized (restricted) Gaussian log-likelihood of a
non-robust (RE)ML fit or <code>NA</code> for a robust fit if
<code>tuning.psi</code> is less than <code>tuning.psi.nr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variogram.object</code></td>
<td>
<p>the estimated parameters of a possibly nested
variograms model.  This is a list that contains for each variogram model
structure the following components:
</p>

<ul>
<li>
<p><code>variogram.model</code>: the name of the fitted parametric variogram
model.
</p>
</li>
<li>
<p><code>param</code>: a named numeric vector with the (estimated) variogram
parameters.
</p>
</li>
<li>
<p><code>fit.param</code>: a named logical vector with the flags defining what
variogram parameters were estimated.
</p>
</li>
<li>
<p><code>isotropic</code>: logical indicating whether an isotropic
variogram was fitted.
</p>
</li>
<li>
<p><code>aniso</code>: a named numeric vector with the (estimated)
anisotropy parameters.
</p>
</li>
<li>
<p><code>fit.aniso</code>: a named logical vector with the flags defining what
anisotropy parameters were estimated.
</p>
</li>
<li>
<p><code>sincos</code>: a list with <code>sin</code> and <code>cos</code> of the
angles <code class="reqn">\omega</code>, <code class="reqn">\phi</code> and <code class="reqn">\zeta</code> that define the
orientation of the anisotropy ellipsoid (see <code>georobPackage</code>).
</p>
</li>
<li>
<p><code>rotmat</code>: the matrix
<code class="reqn">(\boldsymbol{C}_1,
      \boldsymbol{C}_2,
      \boldsymbol{C}_3)</code> (see
<code>georobPackage</code>).
</p>
</li>
<li>
<p><code>sclmat</code>: a vector with the elements 1, <code class="reqn">1/f_1</code>,
<code class="reqn">1/f_2</code> (see <code>georobPackage</code>). 
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>a named numeric vector with the estimating equations
(robust REML) or the gradient of the maximized (restricted) log-likelihood
(Gaussian (RE)ML) evaluated at the solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.psi</code></td>
<td>
<p>the value of the tuning constant <code class="reqn">c</code> of the
<code class="reqn">\psi_c</code>-function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector with the estimated regression coefficients
<code class="reqn">\widehat{\boldsymbol{\beta}}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>a named vector with the fitted values of the
external drift
<code class="reqn">\boldsymbol{X}\widehat{\boldsymbol{\beta}}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bhat</code></td>
<td>
<p>a named vector with the predicted spatial random effects
<code class="reqn">\widehat{\boldsymbol{B}}</code> at the data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a named vector with the residuals
<code class="reqn">\widehat{\boldsymbol{\varepsilon}}=\boldsymbol{Y} -
  \boldsymbol{X} \widehat{\boldsymbol{\beta}} -
  \widehat{\boldsymbol{B}}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rweights</code></td>
<td>
<p>a named numeric vector with the “robustness weights”
<code class="reqn">\psi_c(\widehat{\varepsilon}_i/\widehat{\tau}) /
    (\widehat{\varepsilon}_i/\widehat{\tau})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>a logical scalar indicating whether numerical maximization of
the (restricted)<br> log-likelihood by <code>nlminb</code> or <code>optim</code> or root
finding by <code>nleqslv</code> converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence.code</code></td>
<td>
<p>a diagnostic integer issued by
<code>nlminb</code>, <code>optim</code> (component
<code>convergence</code>) or <code>nleqslv</code> (component
<code>termcd</code>) about convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>a named integer vector of length two, indicating either
</p>

<ul>
<li>
<p> the number of function and gradient evaluations when maximizing
the (restricted) Gaussian log-likelihood by <code>nlminb</code>
or <code>optim</code>, or
</p>
</li>
<li>
<p> the number of function and Jacobian evaluations when solving
the robustified estimating equations by
<code>nleqslv</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmat</code></td>
<td>
<p>the compressed design matrix for replicated observations at
coincident locations (integer vector that contains for each observation
the row index of the respective unique location).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>a list with covariance matrices (or diagonal variance
vectors).  Covariance matrices are stored in <em>compressed form</em> (see
<code>compress</code>) and can be expanded to square matrices by
<code>expand</code>.  What <code>cov</code> actually contains depends on the
flags passed to <code>georob</code> for computing covariances (see
<code>control.georob</code>).  Possible components are:
</p>

<ul>
<li> <p><code>cov.bhat</code>: the covariances of
<code class="reqn">\widehat{\boldsymbol{B}}</code>.
</p>
</li>
<li> <p><code>cov.betahat</code>: the covariances of
<code class="reqn">\widehat{\boldsymbol{\beta}}</code>.
</p>
</li>
<li> <p><code>cov.delta.bhat</code>: the covariances of
<code class="reqn">\boldsymbol{B}- \widehat{\boldsymbol{B}}</code>.
</p>
</li>
<li> <p><code>cov.delta.bhat.betahat</code>: the covariances of
<code class="reqn">\boldsymbol{B}- \widehat{\boldsymbol{B}}</code>
and
<code class="reqn">\widehat{\boldsymbol{\beta}}</code>.
</p>
</li>
<li> <p><code>cov.ehat</code>: the covariances of
<code class="reqn">\widehat{\boldsymbol{\varepsilon}}=\boldsymbol{Y} -
      \boldsymbol{X} \widehat{\boldsymbol{\beta}} -
      \widehat{\boldsymbol{B}}</code>.
</p>
</li>
<li> <p><code>cov.ehat.p.bhat</code>: the covariances of
<code class="reqn">\widehat{\boldsymbol{\varepsilon}} +
      \widehat{\boldsymbol{B}}
      =\boldsymbol{Y} -
      \boldsymbol{X} \widehat{\boldsymbol{\beta}}</code>.
</p>
</li>
<li> <p><code>cov.pred.target</code>: a covariance term required for the
back-trans-<br> formation of Kriging predictions of log-transformed data.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectations</code></td>
<td>
<p>a named numeric vector with the expectations of
<code class="reqn">\partial \psi_c(x)/\partial x</code> and <code class="reqn">\psi_c^2(x)</code>
with respect to a standard normal distribution (<code>exp.gauss.dpsi</code>,
<code>var.gauss.psi</code>) and the expectations of
<code class="reqn">\varepsilon^2</code> and <code class="reqn">\psi_c^2(x)</code> with respect to the
long-tailed distribution of <code class="reqn">\varepsilon</code>
(<code>var.f0.eps</code>, <code>var.f0.psi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Valphaxi.objects</code></td>
<td>
<p>a list of matrices in <em>compressed form</em> with
(among others) the following components:
</p>

<ul>
<li> <p><code>Valpha</code>: a list with the (generalized) correlation
matrices (<code>Valpha</code>) of the nested variogram models structures
along with the constants (<code>gcr.constant</code>) added to the respective
semi-variance matrices.
</p>
</li>
<li> <p><code>Valphaxi</code>: the (generalized) correlation matrix
<code class="reqn">\boldsymbol{V}_{\alpha,\xi} =
      \boldsymbol{\Gamma}_{\alpha,\xi} /
      (\sigma_{\mathrm{n}}^2+\sigma^2 )</code> that includes the spatial nugget effect.
</p>
</li>
<li> <p><code>Valphaxi.inverse</code>: the inverse of
<code class="reqn">\boldsymbol{V}_{\alpha,\xi}</code>.
</p>
</li>
<li> <p><code>log.det.Valphaxi</code>:
<code class="reqn">\log(\det(\boldsymbol{V}_{\alpha,\xi}))</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zhat.objects</code></td>
<td>
<p>a list of matrices in (partly) <em>compressed form</em> with
the following components:
</p>

<ul>
<li> <p><code>Aalphaxi</code>: the matrix
<code class="reqn">(\boldsymbol{X}^T
      \boldsymbol{V}_{\alpha,\xi}^{-1}\boldsymbol{X})^{-1}
      \boldsymbol{X}^T\boldsymbol{V}_{\alpha,\xi}^{-1}
      </code>.
</p>
</li>
<li> <p><code>Palphaxi</code>: the matrix
<code class="reqn">\boldsymbol{I}-
      \boldsymbol{X} \boldsymbol{A}_{\alpha,\xi}
      </code>.
</p>
</li>
<li> <p><code>Valphaxi.inverse.Palphaxi</code>: the matrix
<code class="reqn">\boldsymbol{V}^{-1}_{\alpha,\xi}
      \boldsymbol{P}_{\alpha,\xi} </code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations.object</code></td>
<td>
<p>a list with 3 components:
</p>

<ul>
<li> <p><code>locations</code>: a formula indicating the coordinates of the
measurement locations.
</p>
</li>
<li> <p><code>coordinates</code>: a numeric matrix with the coordinates
of the measurement locations.
</p>
</li>
<li> <p><code>lag.vectors</code>: a numeric matrix with the lag vectors
between any distinct pairs of measurement locations.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.objects</code></td>
<td>
<p>a list with 3 components:
</p>

<ul>
<li> <p><code>coefficients</code>: initial estimates of
<code class="reqn">\boldsymbol{\beta}</code> computed either by
<code>lmrob</code> or <code>rq</code>.
</p>
</li>
<li> <p><code>bhat</code>: initial predictions of
<code class="reqn">\boldsymbol{B}</code>.
</p>
</li>
<li> <p><code>variogram.object</code>: the initial values of the parameters
of a possibly nested variograms model.  This is a list with the same
structure as described above for the component
<code>variogram.object</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian.tfpa</code></td>
<td>
<p>a symmetric matrix with the Hessian (observed
Fisher information) at the solution with respect to the transformed
variogram and anisotropy parameters if the model was fitted non-robustly
with the argument <code>hessian = TRUE</code> (see
<code>control.georob</code>).  Missing otherwise.  This Hessian is used
by <code>summary.georob</code> to compute confidence intervals for the
estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian.ntfpa</code></td>
<td>
<p>a symmetric matrix with the Hessian (observed
Fisher information) at the solution with respect to the non-transformed
variogram and anisotropy parameters if the model was fitted non-robustly
with the argument <code>hessian = TRUE</code> (see
<code>control.georob</code>).  Missing otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list with control parameters generated by
<code>control.georob</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MD</code></td>
<td>
<p>optionally a matrix of robust distances in the space spanned by
<code class="reqn">\boldsymbol{X}</code> (see argument <code>compute.rd</code>
of <code>lmrob.control</code> and
<code>control.georob</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model, x, y</code></td>
<td>
<p>if requested the model frame, the model matrix and the
response, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>na.action</code>, <code>offset</code>, <code>contrasts</code>, <code>xlevels</code>,
<code>rank</code>, <code>df.residual</code>, <code>call</code>, <code>terms</code>
</td>
<td>
<p>further
components of the fit as described for an object of class
<code>lm</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>See Also</h3>

<p><code>georobPackage</code> for a description of the model and a brief summary of the algorithms;
</p>
<p><code>georob</code> for (robust) fitting of spatial linear models;
</p>

<p><code>profilelogLik</code> for computing profiles of Gaussian likelihoods;
</p>
<p><code>plot.georob</code> for display of RE(ML) variogram estimates;
</p>
<p><code>control.georob</code> for controlling the behaviour of <code>georob</code>;
</p>
<p><code>georobModelBuilding</code> for stepwise building models of class <code>georob</code>;
</p>
<p><code>cv.georob</code> for assessing the goodness of a fit by <code>georob</code>;
</p>
<p><code>georobMethods</code> for further methods for the class <code>georob</code>;
</p>
<p><code>predict.georob</code> for computing robust Kriging predictions;

</p>
<p><code>lgnpp</code> for unbiased back-transformation of Kriging prediction
of log-transformed data;
</p>
<p><code>georobSimulation</code> for simulating realizations of a Gaussian process
from model fitted by <code>georob</code>; and finally
</p>
<p><code>sample.variogram</code> and <code>fit.variogram.model</code>
for robust estimation and modelling of sample variograms.
</p>


</div>