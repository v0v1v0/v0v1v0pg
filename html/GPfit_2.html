<div class="container">

<table style="width: 100%;"><tr>
<td>corr_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power Exponential or Matern Correlation Matrix</h2>

<h3>Description</h3>

<p>Computes the power exponential or Matern correlation matrix for a set of
<em>n</em> design points in <em>d</em>-dimensional input region and a vector of
<em>d</em> correlation hyper-parameters (beta).
</p>


<h3>Usage</h3>

<pre><code class="language-R">corr_matrix(X, beta, corr = list(type = "exponential", power = 1.95))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the (<code>n x d</code>) design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a (<code>d x 1</code>) vector of correlation hyper-parameters in
<code class="reqn">(-\infty, \infty)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>a list that specifies the <code>type</code> of correlation function
along with the smoothness parameter. The default corresponds to power
exponential correlation with smoothness parameter "<code>power=1.95</code>". One
can specify a different power (between 1.0 and 2.0) for the power
exponential, or use the Matern correlation function, specified as
<code>corr=list(type = "matern", nu=(2*k+1)/2)</code>, where <code class="reqn">k \in
\{0,1,2,...\}</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power exponential correlation function is given by
</p>
<p><code class="reqn">R_{ij} = \prod_{k=1}^{d} \exp({-10^{\beta_k}|x_{ik}-x_{jk}|^{power}})</code>. <br></p>
<p>The Matern correlation function given by Santner, Williams, and Notz (2003)
is
</p>
<p><code class="reqn">R_{ij} = \prod_{k=1}^{d}
\frac{1}{\Gamma(\nu)2^{\nu-1}}(2\sqrt{\nu}|x_{ik} - </code><code class="reqn">x_{jk}|10^{\beta_k})^\nu
\kappa_{\nu}(2\sqrt{\nu}|x_{ik} - </code><code class="reqn">x_{jk}|10^{\beta_k})</code>,
</p>
<p>where <code class="reqn">\kappa_{\nu}</code> is the modified Bessel function of
order <code class="reqn">\nu</code>.<br></p>


<h3>Value</h3>

<p>The (<code>n x n</code>) correlation matrix, R, for the design matrix
(<code>X</code>) and the hyper-parameters (<code>beta</code>).
</p>


<h3>Note</h3>

<p>Both Matern and power exponential correlation functions use the new
<code class="reqn">\beta</code> parametrization of hyper-parameters given by <code class="reqn">\theta_k =
10^{\beta_k}</code> for easier likelihood optimization.  That is, <code>beta</code> is a
log scale parameter (see MacDonald et al. (2015)).
</p>


<h3>Author(s)</h3>

<p>Blake MacDonald, Hugh Chipman, Pritam Ranjan
</p>


<h3>References</h3>

<p>MacDonald, K.B., Ranjan, P. and Chipman, H. (2015). 
GPfit: An R Package for Fitting a Gaussian Process Model to 
Deterministic Simulator Outputs.  
Journal of Statistical Software, 64(12), 1-23.
<a href="http://www.jstatsoft.org/v64/i12/">http://www.jstatsoft.org/v64/i12/</a> <br></p>
<p>Ranjan, P., Haynes, R., and Karsten, R. (2011). 
A Computationally Stable
Approach to Gaussian Process Interpolation of 
Deterministic Computer Simulation Data, 
Technometrics, 53(4), 366 - 378. <br></p>
<p>Santner, T.J., Williams, B., and Notz, W. (2003), 
The design and analysis of computer experiments, 
Springer Verlag, New York.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1D Example - 1
n = 5
d = 1
set.seed(3)
library(lhs)
x = maximinLHS(n,d)
beta =  rnorm(1)
corr_matrix(x,beta)

## 1D Example - 2
beta = rnorm(1)
corr_matrix(x,beta,corr = list(type = "matern"))

## 2D example - 1
n = 10
d = 2
set.seed(2)
library(lhs)
x = maximinLHS(n,d) 
beta = rnorm(2)
corr_matrix(x, beta,
    corr = list(type = "exponential", power = 2))

## 2D example - 2
beta = rnorm(2)
R = corr_matrix(x,beta,corr = list(type = "matern", nu = 5/2))
print(R)

</code></pre>


</div>