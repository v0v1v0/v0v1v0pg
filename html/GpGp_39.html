<div class="container">

<table style="width: 100%;"><tr>
<td>matern_spacetime_categorical_local</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Space-Time Matern covariance function with local random effects for categories</h2>

<h3>Description</h3>

<p>From a matrix of locations and covariance parameters of the form
(variance, spatial range, temporal range, smoothness, cat variance, cat spatial range, cat temporal range, cat smoothness, nugget),
return the square matrix of
all pairwise covariances.
This is the covariance for the following model for data from cateogory k
</p>
<p style="text-align: center;"><code class="reqn"> Y_k(x_i,t_i) = Z_0(x_i,t_i) + Z_k(x_i,t_i) + e_i </code>
</p>

<p>where Z_0 is Matern with parameters (variance,spatial range,temporal range,smoothness)
and Z_1,...,Z_K are independent Materns with parameters
(cat variance, cat spatial range, cat temporal range, cat smoothness),
and e_1, ..., e_n are independent normals with variance (variance * nugget)
</p>


<h3>Usage</h3>

<pre><code class="language-R">matern_spacetime_categorical_local(covparms, locs)

d_matern_spacetime_categorical_local(covparms, locs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>covparms</code></td>
<td>
<p>A vector with covariance parameters
in the form (variance, spatial range, temporal range, smoothness, category, nugget)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locs</code></td>
<td>
<p>A matrix with <code>n</code> rows and <code>d</code> columns.
Each row of locs gives a point in R^d.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix with <code>n</code> rows and <code>n</code> columns, with the i,j entry
containing the covariance between observations at <code>locs[i,]</code> and
<code>locs[j,]</code>.
</p>


<h3>Functions</h3>


<ul><li> <p><code>d_matern_spacetime_categorical_local()</code>: Derivatives of isotropic Matern covariance
</p>
</li></ul>
<h3>Parameterization</h3>

<p>The covariance parameter vector is (variance, range, smoothness, category, nugget)
= <code class="reqn">(\sigma^2,\alpha_1,\alpha_2,\nu,c^2,\tau^2)</code>, and the covariance function is parameterized
as
</p>
<p style="text-align: center;"><code class="reqn"> d = ( || x - y ||^2/\alpha_1 + |s-t|^2/\alpha_2^2 )^{1/2} </code>
</p>

<p style="text-align: center;"><code class="reqn"> M(x,y) = \sigma^2 2^{1-\nu}/\Gamma(\nu) (d)^\nu K_\nu(d) </code>
</p>

<p>(x,s) and (y,t) are the space-time locations of a pair of observations.
The nugget value <code class="reqn"> \sigma^2 \tau^2 </code> is added to the diagonal of the covariance matrix.
The category variance <code class="reqn">c^2</code> is added if two observation from same category
NOTE: the nugget is <code class="reqn"> \sigma^2 \tau^2 </code>, not <code class="reqn"> \tau^2 </code>.
</p>


</div>