<div class="container">

<table style="width: 100%;"><tr>
<td>fitted_devianceIncr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting the deviance increment of GAMLSS</h2>

<h3>Description</h3>

<p>There are two plotting function here:
</p>
<p>i) <code>fitted_devianceIncr()</code> plots the fitted model deviance components. This is  useful for identifying observations with unusual y-values (given the current fitted  distribution).  
</p>
<p>iii) <code>model_devianceIncr_diff</code> plots the difference of deviance  increments  from two fitted GAMLSS model. This function is useful if the GAIC and the residuals contradict each other. For example the GAIC is better for model 1 but the residuals look lot better for model 2. This can happens if the two distributions are better suited to fit different parts of the response distribution i.e. one model fits the center better but the other fits the tail better.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">
fitted_devianceIncr(obj, plot = TRUE, title, quan.val = 0.99,
         annotate = TRUE, line.col = "steelblue4", 
         point.col = "darkblue", annot.col = "white",
         newdata = NULL)
         

model_devianceIncr_diff(model1, model2, against = "index", 
         tol = 20, data, newdata)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a GAMLSS fitted object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to create just the plot or save also the values with high deviance increment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a tittle if needed it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quan.val</code></td>
<td>
<p>The quantile values of the deviance increment from which the obsrevrvarion should be identify</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotate</code></td>
<td>
<p>whether to plot the quantile values above in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>the colour of the line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.col</code></td>
<td>
<p>the colour of the points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annot.col</code></td>
<td>
<p>the colour of the annotation for the deviance increment plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model1</code></td>
<td>
<p>The first fitted GAMLSS model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model2</code></td>
<td>
<p>The second fitted GAMLSS model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>against</code></td>
<td>
<p>you can plot the deviance increment an index, the response or an x-variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>if the absolute value of deviance increment  exceeds the <code>tol</code> the number of the observation  is plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data if can not be found from <code>model1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>evaluates the function in new data</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions are diagnostic tools to check unusual observations in the response.
</p>


<h3>Value</h3>

<p>return a plot
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopulos, Rober Rigby and Fernanda de Bastiani 
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code>gamlss</code></p>


<h3>Examples</h3>

<pre><code class="language-R">m1 &lt;- gamlss(R~pb(Fl)+pb(A)+H+loc, data=rent, family=GA )
m2 &lt;- gamlss(R~pb(Fl)+pb(A)+H+loc, data=rent, family=NO )
fitted_devianceIncr(m1)
model_devianceIncr_diff(m1,m2, against="Fl")
</code></pre>


</div>