<div class="container">

<table style="width: 100%;"><tr>
<td>predict.gamlss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Predictor Values and Standard Errors For New Data In a GAMLSS Model </h2>

<h3>Description</h3>

<p><code>predict.gamlss</code> is the GAMLSS specific method which produce predictors for a new data set   
for a specified parameter from a GAMLSS objects.  
The <code>predict.gamlss</code> can be used to extract the linear predictors, fitted values and specific  terms in the model at new 
data values in the same way that the <code>predict.lm()</code> and <code>predict.glm()</code> functions can be used for 
<code>lm</code> or <code>glm</code> objects. Note that linear predictors, fitted values and specific terms in the model at the current  
data values can also be extracted using the function <code>lpred()</code> (which is called from predict if new data is NULL).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gamlss'
predict(object, what = c("mu", "sigma", "nu", "tau"), 
                parameter= NULL,
                newdata = NULL, type = c("link", "response", "terms"), 
                terms = NULL, se.fit = FALSE, data = NULL, ...)
predictAll(object, newdata = NULL, type = c("response", "link", "terms"), 
                terms = NULL, se.fit = FALSE, use.weights = FALSE, 
                data = NULL, y.value = "median", 
                set.to = .Machine$double.xmin,
                  output = c("list","data.frame", "matrix"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a GAMLSS fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p> which distribution parameter is required, default <code>what="mu"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>equivalent to <code>what</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a data frame containing new values for the explanatory variables used in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the default, gets the linear predictor for the specified distribution parameter. 
<code>type="response"</code> gets the fitted values for the parameter while <code>type="terms"</code> gets the fitted terms contribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>if <code>type="terms"</code>, which terms to be selected (default is all terms)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>if TRUE the approximate standard errors of the appropriate type are extracted if exist</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.weights</code></td>
<td>
<p>if <code>use.weights=TRUE</code> the old data and the <code>newdata</code> are merged and the model is refitted with weights equal to the prior weights for the old data  observational and   equal to a very small value (see option <code>set.to</code>) for the .<code>newdata</code> values. This trick allows to obtain standard errors for all parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> the data frame used in the original fit if is not defined in the call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.value</code></td>
<td>
<p>how to get  the response values for the <code>newdata</code> if they do not exist. The default is taking the median, <code>y.value="median"</code>. Other function like "max", "min" are allowed. Also numerical values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.to</code></td>
<td>
<p>what values the weights for the <code>newdata</code> should take</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>whether the output to be a ‘list’ (default) or a 'matrix'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> for extra arguments </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The predict function  assumes that the object given in <code>newdata</code> is a data frame containing the right x-variables
used in the model. This could possible cause problems if transformed variables are used in the fitting of the original model.
For example, let us assume that a transformation of age is needed in the model i.e. <code>nage&lt;-age^.5</code>. This could be fitted as 
<code>mod&lt;-gamlss(y~cs(age^.5),data=mydata)</code> or as  <code>nage&lt;-age^.5;  mod&lt;-gamlss(y~cs(nage), data=mydata)</code>.
The later could more efficient if the data are in thousands rather in hundreds. In the first case,   
the code <code>predict(mod,newdata=data.frame(age=c(34,56)))</code> would produce the right results.  
In the second case a new data frame has to be created containing the old data plus any new transform data. This data frame has to 
be declared in the <code>data</code> option. The option <code>newdata</code> should 
contain a data.frame with the new names and the transformed values in which prediction is required, (see the last example). </p>


<h3>Value</h3>

<p>A vector or a matrix  depending on the options. 
</p>


<h3>Note</h3>

<p> This function is under development</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos </p>


<h3>References</h3>

<p> Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

  <p><code>lp</code>,  <code>lpred</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">data(aids)
a&lt;-gamlss(y~poly(x,3)+qrt, family=PO, data=aids) # 
newaids&lt;-data.frame(x=c(45,46,47), qrt=c(2,3,4))
ap &lt;- predict(a, newdata=newaids, type = "response")
ap
# now getting all the parameters
predictAll(a, newdata=newaids)
rm(a, ap)
data(abdom)
# transform x 
aa&lt;-gamlss(y~cs(x^.5),data=abdom)
# predict at old values
predict(aa)[610]
# predict at new values 
predict(aa,newdata=data.frame(x=42.43))
# now transform x first 
nx&lt;-abdom$x^.5
aaa&lt;-gamlss(y~cs(nx),data=abdom)
# create a new data frame 
newd&lt;-data.frame( abdom, nx=abdom$x^0.5)
# predict at old values
predict(aaa)[610]
# predict at new values 
predict(aaa,newdata=data.frame(nx=42.43^.5), data=newd)
</code></pre>


</div>