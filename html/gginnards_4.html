<div class="container">

<table style="width: 100%;"><tr>
<td>drop_vars</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Explore and manipulate the embedded data.</h2>

<h3>Description</h3>

<p>Automatically remove unused variables from the "default" data object embedded
in a <code>gg</code> or <code>ggplot</code> object with <code>drop_vars()</code>. Explore data
variables and their use with <code>mapped_vars()</code>, <code>data_vars()</code> and
<code>data_attributes()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">drop_vars(p, keep.vars = character(), guess.vars = TRUE)

mapped_vars(p, invert = FALSE)

data_vars(p)

data_attributes(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>ggplot Plot object with embedded data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.vars</code></td>
<td>
<p>character Names of unused variables to be kept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guess.vars</code></td>
<td>
<p>logical Flag indicating whether to find used variables
automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invert</code></td>
<td>
<p>logical If TRUE return indices for elements of <code>data</code> that
are not mapped to any aesthetic or facet.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>"ggplot"</code> object that is a copy of <code>p</code> but containing
only a subset of the variables in its default <code>data</code>.
</p>
<p>character vector with names of mapped variables in the default
data object.
</p>
<p>character vector with names of all variables in the default
data object.
</p>
<p>list containing all attributes of the default data object.
</p>


<h3>Warning!</h3>

<p>The current implementation drops variables only from the
default data object. Data objects within layers are not modified.
</p>


<h3>Note</h3>

<p>These functions are under development and not yet thoroughly tested!
They are a demonstration of how one can manipulate the internals of
<code>ggplot</code> objects creayed with 'ggplot2' versions 3.1.0 and later.
These functions may stop working after some future update to the 'ggplot2'
package. Although I will maintain this package for use in some of my other
packages, there is no guarantee that I will be able to achieve this
transparently.
</p>
<p>Obviously, rather than using function <code>drop_vars()</code> after creating the
<code>ggplot</code> object it is usually more efficient to select the variables
of interest and pass a data frame containing only these to the
<code>ggplot()</code> constructor.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggplot2)

p &lt;- ggplot(mpg, aes(factor(year), (cty + hwy) / 2)) +
  geom_boxplot() +
  facet_grid(. ~ class)

mapped_vars(p) # those in use
mapped_vars(p, invert = TRUE) # those not used

p.dp &lt;- drop_vars(p) # we drop unused vars

# number of columns in the data member
ncol(p$data)
ncol(p.dp$data)

# which vars are in the data member
data_vars(p)
data_vars(p.dp)

# which variables in data are used in the plot
mapped_vars(p)
mapped_vars(p.dp)

# the plots identical
p
p.dp

# structure and size of p
str(p, max.level = 0)
str(p.dp, max.level = 0) # smaller in size

# structure and size of p["data"]
str(p, components = "data")
str(p.dp, components = "data") # smaller in size

# shape data
if (requireNamespace("sf", quietly = TRUE)) {
  nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)

  p.sf &lt;- ggplot(data = nc) +
          geom_sf()
  p.sf
  mapped_vars(p.sf)
  drop_vars(p.sf)
}

</code></pre>


</div>