<div class="container">

<table style="width: 100%;"><tr>
<td>ggseqrfplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Relative Frequency Sequence Plot</h2>

<h3>Description</h3>

<p>Function for rendering sequence index plots with <code>ggplot2</code>
instead of base R's <code>plot</code> function that is used by
<code>TraMineR::seqrfplot</code>. Note that <code>ggseqrfplot</code>
uses <code>patchwork</code> to combine the different components of
the plot. The function and the documentation draw heavily from
<code>TraMineR::seqrf</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ggseqrfplot(
  seqdata = NULL,
  diss = NULL,
  k = NULL,
  sortv = "mds",
  weighted = TRUE,
  grp.meth = "prop",
  squared = FALSE,
  pow = NULL,
  seqrfobject = NULL,
  border = FALSE,
  ylab = NULL,
  yaxis = TRUE,
  which.plot = "both",
  quality = TRUE,
  box.color = NULL,
  box.fill = NULL,
  box.alpha = NULL,
  outlier.jitter.height = 0,
  outlier.color = NULL,
  outlier.fill = NULL,
  outlier.shape = 19,
  outlier.size = 1.5,
  outlier.stroke = 0.5,
  outlier.alpha = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seqdata</code></td>
<td>
<p>State sequence object (class <code>stslist</code>) created with the
<code>TraMineR::seqdef</code> function. <code>seqdata</code> is
ignored if <code>seqrfobject</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>
<p>pairwise dissimilarities between sequences in <code>seqdata</code>
(see <code>TraMineR::seqdist</code>). <code>diss</code> is
ignored if <code>seqrfobject</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer specifying the number of frequency groups. When <code>NULL</code>,
<code>k</code> is set as the minimum between 100 and the sum of weights over 10.
<code>k</code> is ignored if <code>seqrfobject</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortv</code></td>
<td>
<p>optional sorting vector of length <code>nrow(diss)</code> that may be
used to compute the frequency groups. If <code>NULL</code>, the original data order
is used. If <code>mds</code> (default), the first MDS factor of <code>diss</code>
(<code>diss^2</code> when <code>squared=TRUE</code>) is used. Ties are randomly ordered.
Also allows for the usage of the string inputs:
<code>"from.start"</code> or <code>"from.end"</code> (see <code>ggseqiplot</code>).
<code>sortv</code> is ignored if <code>seqrfobject</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Controls if weights (specified in
<code>TraMineR::seqdef</code>) should be used. Default is
<code>TRUE</code>, i.e. if available weights are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp.meth</code></td>
<td>
<p>Character string. One of <code>"prop"</code>, <code>"first"</code>,
and <code>"random"</code>. Grouping method. See details. <code>grp.meth</code> is ignored
if <code>seqrfobject</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>Logical. Should medoids (and computation of <code>sortv</code> when
applicable) be based on squared dissimilarities? (default is <code>FALSE</code>).
<code>squared</code> is ignored if <code>seqrfobject</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>
<p>Dissimilarity power exponent (typically 1 or 2) for computation of
pseudo R2 and F. When <code>NULL</code>, pow is set as 1 when <code>squared = FALSE</code>,
and as 2 otherwise. <code>pow</code> is ignored if <code>seqrfobject</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqrfobject</code></td>
<td>
<p>object of class <code>seqrf</code> generated with
<code>TraMineR::seqrf</code>. Default is <code>NULL</code>;
either <code>seqrfobject</code> or <code>seqdata</code> and <code>diss</code> have to specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>if <code>TRUE</code> bars of index plot are plotted with black outline;
default is <code>FALSE</code> (also accepts <code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>character string specifying title of y-axis. If <code>NULL</code> axis
title is "Frequency group"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis</code></td>
<td>
<p>Controls if a y-axis is plotted. When set as <code>TRUE</code>, index
of frequency groups is displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.plot</code></td>
<td>
<p>character string specifying which components of relative
frequency sequence plot should be displayed. Default is <code>"both"</code>. If set
to <code>"medoids"</code> only the index plot of medoids is shown.
If <code>"diss.to.med"</code> only the box plots of the group-specific distances to
the medoids are shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quality</code></td>
<td>
<p>specifies if representation quality is shown as figure caption;
default is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.color</code></td>
<td>
<p>specifies color of boxplot borders; default is "black</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.fill</code></td>
<td>
<p>specifies fill color of boxplots; default is "white"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box.alpha</code></td>
<td>
<p>specifies alpha value of boxplot fill color; default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.jitter.height</code></td>
<td>
<p>if greater than 0 outliers are jittered vertically.
If greater than .375 height is automatically adjusted to be aligned with the box width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.color, outlier.fill, outlier.shape, outlier.size, outlier.stroke, outlier.alpha</code></td>
<td>
<p>parameters to change the appearance of the outliers. Uses defaults of
<code>ggplot2::geom_boxplot</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function renders relative frequency sequence plots using either an internal
call of <code>TraMineR::seqrf</code> or by using an object of
class <code>"seqrf"</code> generated with <code>TraMineR::seqrf</code>.
</p>
<p>For further details on the technicalities we refer to the excellent documentation
of <code>TraMineR::seqrf</code>. A detailed account of
relative frequency index plot can be found in the original contribution by
Fasang and Liao (2014).
</p>
<p><code>ggseqrfplot</code> renders the medoid sequences extracted by
<code>TraMineR::seqrf</code> with an internal call of
<code>ggseqiplot</code>. For the box plot depicting the distances to the medoids
<code>ggseqrfplot</code> uses <code>geom_boxplot</code> and
<code>geom_jitter</code>. The latter is used for plotting the outliers.
</p>
<p>Note that <code>ggseqrfplot</code> renders in the box plots analogous to the those
produced by <code>TraMineR::seqrfplot</code>. Actually,
the box plots produced with <code>TraMineR::seqrfplot</code>
and  <code>ggplot2::geom_boxplot</code>
might slightly differ due to differences in the underlying computations of
<code>grDevices::boxplot.stats</code> and
<code>ggplot2::stat_boxplot</code>.
</p>
<p>Note that <code>ggseqrfplot</code> uses <code>patchwork</code> to combine
the different components of the plot. If you want to adjust the appearance of
the composed plot, for instance by changing the plot theme, you should consult
the documentation material of <code>patchwork</code>.
</p>
<p>At this point <code>ggseqrfplot</code> does not support a grouping option. For
plotting multiple groups, I recommend to produce group specific seqrfobjects or
plots and to arrange them in a common plot using <code>patchwork</code>.
See Example 6 in the vignette for further details:
<code>vignette("ggseqplot", package = "ggseqplot")</code>
</p>


<h3>Value</h3>

<p>A relative frequency sequence plot using <code>ggplot</code>.
</p>


<h3>Author(s)</h3>

<p>Marcel Raab
</p>


<h3>References</h3>

<p>Fasang AE, Liao TF (2014).
“Visualizing Sequences in the Social Sciences: Relative Frequency Sequence Plots.”
<em>Sociological Methods &amp; Research</em>, <b>43</b>(4), 643–676.
<a href="https://doi.org/10.1177/0049124113506563">doi:10.1177/0049124113506563</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load additional library for fine-tuning the plots
library(patchwork)

# From TraMineR::seqprf
# Defining a sequence object with the data in columns 10 to 25
# (family status from age 15 to 30) in the biofam data set
data(biofam)
biofam.lab &lt;- c("Parent", "Left", "Married", "Left+Marr",
  "Child", "Left+Child", "Left+Marr+Child", "Divorced")

# Here, we use only 100 cases selected such that all elements
# of the alphabet be present.
# (More cases and a larger k would be necessary to get a meaningful example.)
biofam.seq &lt;- seqdef(biofam[501:600, 10:25], labels=biofam.lab,
                     weights=biofam[501:600,"wp00tbgs"])
diss &lt;- seqdist(biofam.seq, method = "LCS")


# Using 12 groups and default MDS sorting
# and original method by Fasang and Liao (2014)

# ... with TraMineR::seqrfplot (weights have to be turned off)
seqrfplot(biofam.seq, weighted = FALSE, diss = diss, k = 12,
          grp.meth="first", which.plot = "both")

# ... with ggseqrfplot
ggseqrfplot(biofam.seq, weighted = FALSE, diss = diss, k = 12, grp.meth="first")

# Arrange sequences by a user specified sorting variable:
# time spent in parental home; has ties
parentTime &lt;- seqistatd(biofam.seq)[, 1]
b.srf &lt;- seqrf(biofam.seq, diss=diss, k=12, sortv=parentTime)
# ... with ggseqrfplot (and some extra annotation using patchwork)
ggseqrfplot(seqrfobject = b.srf) +
  plot_annotation(title = "Sorted by time spent in parental home",
                  theme = theme(plot.title = element_text(hjust = 0.5, size = 18)))
</code></pre>


</div>