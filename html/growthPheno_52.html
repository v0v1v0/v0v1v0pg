<div class="container">

<table style="width: 100%;"><tr>
<td>plotSmoothsComparison</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots  several sets of smoothed values for a response, possibly along with growth rates and optionally including the unsmoothed values, as well as deviations boxplots.</h2>

<h3>Description</h3>

<p>Plots the smoothed values for an observed <code>response</code> and, optionally, the unsmoothed 
observed <code>response</code> using <code>plotProfiles</code>. Depending on the setting of 
<code>trait.types</code> (<code>response</code>, <code>AGR</code> or <code>RGR</code>), the computed traits of the 
Absolute Growth Rates (AGR) and/or the Relative Growth Rates (RGR) are plotted.  This 
function will also calculate and produce, using <code>plotDeviationsBoxes</code>, boxplots 
of the deviations of the supplied smoothed values from the observed response values for the 
traits and for combinations of the different smoothing parameters and for subsets of 
non-smoothing-<code>factor</code> combinations. The observed and smoothed values are 
supplied in long format i.e. with the values for each set of smoothing parameters stacked 
one under the other in the supplied <code>smooths.frame</code>. Such data can be generated 
using <code>probeSmooths</code>;  to prevent <code>probeSmooths</code> producing the 
plots, which it is does using <code>plotSmoothsComparison</code>, <code>plotDeviationsBoxes</code> 
and <code>plotSmoothsMedianDevns</code>, set <code>which.plots</code> to <code>none</code>. 
The smoothing parameters include <code>spline.types</code>, <code>df</code>, <code>lambdas</code> and 
<code>smoothing.methods</code> (see <code>probeSmooths</code>). 
</p>
<p>Multiple plots, possibly each having multiple facets, are produced using <code>ggplot2</code>. 
The layout of these plots is controlled via the arguments <code>plots.by</code>, 
<code>facet.x</code> and <code>facet.y</code>. The basic principle is that the number of levels 
combinations of the smoothing-parameter <code>factor</code>s <code>Type</code>, <code>TunePar</code>, 
<code>TuneVal</code>, <code>Tuning</code> (the combination of (<code>TunePar</code> and <code>TuneVal</code>), and 
<code>Method</code> that are included  in <code>plots.by</code>, <code>facet.x</code> and 
<code>facet.y</code> must be the same as those covered by the combinations of the values 
supplied to <code>spline.types</code>, <code>df</code>, <code>lambdas</code> and <code>Method</code> and incorporated 
into the <code>smooths.frame</code> input to <code>plotSmoothsComparison</code> via the 
<code>data</code> argument. This ensures that smooths from different parameter sets are not 
pooled into the same plot. The <code>factor</code>s other than the smoothing-parameter 
<code>factor</code>s can be supplied to the <code>plots.by</code> and <code>facet</code> arguments.
</p>
<p>The following profiles plots can be produced: (i) separate plots of the 
smoothed traits for each combination of the smoothing parameters 
(include <code>Type</code>, <code>Tuning</code> and <code>Method</code> in <code>plots.by</code>); 
(ii) as for (i), with the corresponding plot for the unsmoothed trait 
preceeding the plots for the smoothed trait (also set <code>include.raw</code> to 
<code>alone</code>); (iii) profiles plots that compare a smoothed trait for all 
combinations of the values of the smoothing parameters, arranging the plots 
side-by-side or one above the other (include <code>Type</code>, <code>Tuning</code> and 
<code>Method</code> in <code>facet.x</code> and/or <code>facet.y</code> - to include the 
unsmoothed trait set <code>include.raw</code> to one of <code>facet.x</code> or 
<code>facet.y</code>; (iv) as for (iii), except that separate plots are 
produced for each combination of the levels of the <code>factor</code>s 
in <code>plot.by</code> and each plot compares the smoothed traits for the 
smoothing-parameter <code>factor</code>s included in <code>facet.x</code> 
and/or <code>facet.y</code> (set both <code>plots.by</code> and one or more of 
<code>facet.x</code> and <code>facet.y</code>). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSmoothsComparison(data, response, response.smoothed = NULL, 
                      individuals = "Snapshot.ID.Tag", times = "DAP", 
                      trait.types = c("response", "AGR", "RGR"), 
                      x.title = NULL, y.titles = NULL, 
                      profile.plot.args = 
                        args4profile_plot(plots.by = NULL, 
                                          facet.x = ".", facet.y = ".", 
                                          include.raw = "no"),
                      printPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>smooths.frame</code>, such as is produced by 
<code>probeSmooths</code> and that contains the data resulting from 
smoothing a response over time for a set of <code>individuals</code>, the data 
being arranged in long format both with respect to the 
times and the smoothing-parameter values used in the smoothing. That is, 
each response occupies a single column. The unsmoothed <code>response</code> and 
the <code>response.smoothed</code> are to be plotted for different sets of values 
for the smoothing parameters. The <code>smooths.frame</code> must include 
the columns <code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code> and 
<code>Method</code>, and the columns nominated using the arguments 
<code>individuals</code>, <code>times</code>, <code>plots.by</code>, <code>facet.x</code>, <code>facet.y</code>, 
<code>response</code>, <code>response.smoothed</code>, and, if requested, 
the AGR and the RGR of the <code>response</code> and <code>response.smoothed</code>. 
The names of the growth rates should be formed from <code>response</code> and 
<code>response.smoothed</code> by adding <code>.AGR</code> and <code>.RGR</code> to both of them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A <code>character</code> specifying the response variable for which the 
observed values are supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response.smoothed</code></td>
<td>
<p>A <code>character</code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code> and obtained for the combinations of 
<code>smoothing.methods</code> and <code>df</code>, usually using smoothing splines. 
If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>A <code>character</code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code>numeric</code>, <code>factor</code>, or 
<code>character</code>. It will be used to provide the values to be plotted 
on the x-axis. If a <code>factor</code> or <code>character</code>, 
the values should be numerics stored as characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individuals</code></td>
<td>
<p>A <code>character</code> giving the name of the 
<code>factor</code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.types</code></td>
<td>
<p>A <code>character</code> giving the <code>trait.types</code> that 
are to be plotted when <code>which.plots</code> is <code>profiles</code>. 
Irrespective of the setting of <code>get.rates</code>, the nominated traits 
are plotted. If <code>all</code>, each of <code>response</code>, <code>AGR</code> and 
<code>RGR</code> is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.title</code></td>
<td>
<p>Title for the x-axis, used for all plots. If <code>NULL</code> then set to 
<code>times</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.titles</code></td>
<td>
<p>A <code>character</code> giving the titles for the y-axis, 
one for each trait specified by <code>trait.types</code> and used for all plots. 
If <code>NULL</code>, then set to the traits derived for <code>response</code> 
from <code>trait.types</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profile.plot.args</code></td>
<td>
<p>A named <code>list</code> that is most easily 
generated using <code>args4profile_plot</code>, it documenting the 
options available for varying profile plots and boxplots. <em>Note 
that if <code>args4profile_plot</code> is to be called to change 
from the default settings given in the default 
<code>plotSmoothsComparison</code> call 
and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code>args4profile_plot</code>; be aware that if you call 
<code>args4profile_plot</code>, then the defaults for this call are 
those for <code>args4profile_plot</code>, <b>NOT</b> the call to 
<code>args4profile_plot</code> shown as the default for 
<code>plotSmoothsComparison</code>.</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printPlot</code></td>
<td>
<p>A <code>logical</code> indicating whether or not to print any 
plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>allows passing of arguments to <code>plotProfiles</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A multilevel <code>list</code> that contains the <code>ggplot</code> 
objects for the plots produced. The first-level <code>list</code> 
has a component for each <code>trait.types</code> and each of these is a 
second-level <code>list</code> that contains the trait 
profile plots and for a <code>trait</code>. It may contain components labelled 
<code>Unsmoothed</code>, <code>all</code> or for one of the levels of the 
<code>factor</code>s in <code>plots.by</code>; each of these third-level 
<code>ist</code>s contains a <code>ggplot</code> object that can 
be plotted using <code>print</code>. 
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code>traitSmooth</code>, <code>probeSmooths</code>, <code>args4profile_plot</code>, <code>plotDeviationsBoxes</code>, <code>plotSmoothsMedianDevns</code>, <code>ggplot2</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(exampleData)
vline &lt;- list(ggplot2::geom_vline(xintercept=29, linetype="longdash", size=1))
traits &lt;- probeSmooths(data = longi.dat, 
                       response = "PSA", response.smoothed = "sPSA", 
                       times = "DAP", 
                       #only df is changed from the probeSmooth default
                       smoothing.args = 
                         args4smoothing(smoothing.methods = "direct", 
                                        spline.types = "NCSS", 
                                        df = c(4,7), lambdas = NULL), 
                       which.plots = "none")
plotSmoothsComparison(data = traits, 
                      response = "PSA", response.smoothed = "sPSA", 
                      times = "DAP", x.title = "DAP",
                      #only facet.x is changed from the probeSmooth default
                      profile.plot.args = 
                        args4profile_plot(plots.by = NULL, 
                                          facet.x = "Tuning", facet.y = ".", 
                                          include.raw = "no", 
                                          ggplotFuncs = vline))
</code></pre>


</div>