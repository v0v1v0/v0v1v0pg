<div class="container">

<table style="width: 100%;"><tr>
<td>gamBiCopSelect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Selection and Maximum penalized likelihood estimation of a Generalized
Additive model (gam) for the copula parameter or Kendall's tau.</h2>

<h3>Description</h3>

<p>This function selects an appropriate bivariate copula family for given
bivariate copula data using one of a range of methods. The corresponding
parameter estimates are obtained by maximum penalized  likelihood estimation,
where each Newton-Raphson iteration is reformulated as a generalized ridge
regression solved using the <code>mgcv</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gamBiCopSelect(
  udata,
  lin.covs = NULL,
  smooth.covs = NULL,
  familyset = NA,
  rotations = TRUE,
  familycrit = "AIC",
  level = 0.05,
  edf = 1.5,
  tau = TRUE,
  method = "FS",
  tol.rel = 0.001,
  n.iters = 10,
  parallel = FALSE,
  verbose = FALSE,
  select.once = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>udata</code></td>
<td>
<p>A matrix or data frame containing the model responses, (u1,u2) in
[0,1]x[0,1]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lin.covs</code></td>
<td>
<p>A matrix or data frame containing the parametric (i.e.,
linear) covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.covs</code></td>
<td>
<p>A matrix or data frame containing the non-parametric
(i.e., smooth) covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>familyset</code></td>
<td>
<p>(Similar to <code>BiCopSelect</code> from the
<code>VineCopula</code> package)
Vector of bivariate copula families to select from.
If <code>familyset = NA</code> (default), selection
among all possible families is performed.   Coding of bivariate copula
families:
<code>1</code> Gaussian,
<code>2</code> Student t,
<code>5</code> Frank,
<code>301</code> Double Clayton type I (standard and rotated 90 degrees),
<code>302</code> Double Clayton type II (standard and rotated 270 degrees),
<code>303</code> Double Clayton type III (survival and rotated 90 degrees),
<code>304</code> Double Clayton type IV (survival and rotated 270 degrees),
<code>401</code> Double Gumbel type I (standard and rotated 90 degrees),
<code>402</code> Double Gumbel type II (standard and rotated 270 degrees),
<code>403</code> Double Gumbel type III (survival and rotated 90 degrees),
<code>404</code> Double Gumbel type IV (survival and rotated 270 degrees).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotations</code></td>
<td>
<p>If <code>TRUE</code>, all rotations of the families in familyset
are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>familycrit</code></td>
<td>
<p>Character indicating the criterion for bivariate copula
selection. Possible choices: <code>familycrit = 'AIC'</code> (default) or
<code>'BIC'</code>, as in <code>BiCopSelect</code> from the
<code>VineCopula</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Numerical; significance level of the test for removing individual
predictors (default: <code>level = 0.05</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edf</code></td>
<td>
<p>Numerical; if the estimated EDF for individual predictors is
smaller than <code>edf</code> but the predictor is still significant, then
it is set as linear (default: <code>edf = 1.5</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p><code>FALSE</code> for a calibration function specified for
the Copula parameter or <code>TRUE</code> (default) for a calibration function
specified for Kendall's tau.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>'FS'</code> for Fisher-scoring (default) and
<code>'NR'</code> for Newton-Raphson.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.rel</code></td>
<td>
<p>Relative tolerance for <code>'FS'</code>/<code>'NR'</code> algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iters</code></td>
<td>
<p>Maximal number of iterations for
<code>'FS'</code>/<code>'NR'</code> algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p><code>TRUE</code> for a parallel estimation across copula families.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>TRUE</code> prints informations during the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select.once</code></td>
<td>
<p>if <code>TRUE</code> the GAM structure is only selected once,
for the family that appears first in <code>familyset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>gam</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>gamBiCopFit</code> returns a list consisting of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>S4 <code>gamBiCop-class</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>'FS'</code> for Fisher-scoring and
<code>'NR'</code> for Newton-Raphson.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.rel</code></td>
<td>
<p>relative tolerance for <code>'FS'</code>/<code>'NR'</code> algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iters</code></td>
<td>
<p>maximal number of iterations for
<code>'FS'</code>/<code>'NR'</code> algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>the estimation procedure's trace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p><code>0</code> if the algorithm converged and <code>1</code> otherwise.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>gamBiCop</code> and <code>gamBiCopFit</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(copula)
set.seed(0)

## Simulation parameters (sample size, correlation between covariates,
## Student copula with 4 degrees of freedom)
n &lt;- 5e2
rho &lt;- 0.9
fam &lt;- 2
par2 &lt;- 4

## A calibration surface depending on four variables
eta0 &lt;- 1
calib.surf &lt;- list(
  calib.lin &lt;- function(t, Ti = 0, Tf = 1, b = 2) {
    return(-2 + 4 * t)
  },
  calib.quad &lt;- function(t, Ti = 0, Tf = 1, b = 8) {
    Tm &lt;- (Tf - Ti) / 2
    a &lt;- -(b / 3) * (Tf^2 - 3 * Tf * Tm + 3 * Tm^2)
    return(a + b * (t - Tm)^2)
  },
  calib.sin &lt;- function(t, Ti = 0, Tf = 1, b = 1, f = 1) {
    a &lt;- b * (1 - 2 * Tf * pi / (f * Tf * pi +
      cos(2 * f * pi * (Tf - Ti))
      - cos(2 * f * pi * Ti)))
    return((a + b) / 2 + (b - a) * sin(2 * f * pi * (t - Ti)) / 2)
  },
  calib.exp &lt;- function(t, Ti = 0, Tf = 1, b = 2, s = Tf / 8) {
    Tm &lt;- (Tf - Ti) / 2
    a &lt;- (b * s * sqrt(2 * pi) / Tf) * (pnorm(0, Tm, s) - pnorm(Tf, Tm, s))
    return(a + b * exp(-(t - Tm)^2 / (2 * s^2)))
  }
)

## 6-dimensional matrix X of covariates
covariates.distr &lt;- mvdc(normalCopula(rho, dim = 6),
  c("unif"), list(list(min = 0, max = 1)),
  marginsIdentical = TRUE
)
X &lt;- rMvdc(n, covariates.distr)
colnames(X) &lt;- paste("x", 1:6, sep = "")

## U in [0,1]x[0,1] depending on the four first columns of X
U &lt;- condBiCopSim(fam, function(x1, x2, x3, x4) {
  eta0 + sum(mapply(function(f, x)
    f(x), calib.surf, c(x1, x2, x3, x4)))
}, X[, 1:4], par2 = 4, return.par = TRUE)
## Not run: 
## Selection using AIC (about 30sec on single core)
## Use parallel = TRUE to speed-up....
system.time(best &lt;- gamBiCopSelect(U$data, smooth.covs = X))
print(best$res)
EDF(best$res) ## The first function is linear
## Plot only the smooth component
par(mfrow = c(2, 2))
plot(best$res)

## End(Not run)
</code></pre>


</div>