<div class="container">

<table style="width: 100%;"><tr>
<td>igini</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gini index, variances and confidence intervals in infinite populations</h2>

<h3>Description</h3>

<p>Estimation of the Gini index and computation of variances and confidence interval for infinite populations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">igini(
  y,
  bias.correction = TRUE,
  interval = NULL,
  B = 1000L,
  alpha = 0.05,
  cum.sums = NULL,
  na.rm = TRUE,
  precisionEL = 1e-04,
  maxiterEL = 100L,
  large.sample = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector with the non-negative real numbers to be used for estimating the Gini index. This argument can be missing if argument <code>cum.sums</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias.correction</code></td>
<td>
<p>A 'TRUE/FALSE' logical value indicating whether the bias correction should be applied to the estimation of the Gini index. The default value is <code>bias.correction = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>A character string specifying the type of variance estimation and confidence interval to be used, or <code>NULL</code> (the default value) to omit the computation of both variance and confidence interval. Possible values are <code>"zjackknife"</code>, <code>"tjackknife"</code>, <code>"zalinearization"</code>, <code>"zblinearization"</code>, <code>"talinearization"</code>, <code>"tblinearization"</code>, <code>"pbootstrap"</code>, <code>"BCa"</code>, <code>"ELchisq"</code> and <code>"ELboot"</code>. The default value is <code>interval = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A single integer specifying the number of bootstrap replicates. The default value is <code>B = 1000L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A single numeric value between 0 and 1. If <code>interval</code> is not <code>NULL</code>, the confidence level to be used for computing  the confidence interval for the Gini is <code>1-alpha</code>. Some authors call <code>alpha</code> the significance level. The default value is <code>alpha = 0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum.sums</code></td>
<td>
<p>A vector with the non-negative real numbers specifying the cumulative sums of the variable used to estimate the Gini index. This argument can be <code>NULL</code> if argument <code>y</code> is provided. The default value is <code>cum.sums = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A 'TRUE/FALSE' logical value indicating whether <code>NA</code>'s should be removed before the computation proceeds. The default value is <code>na.rm = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precisionEL</code></td>
<td>
<p>A single numeric value specifying the precision for the confidence interval based on the empirical likelihood method. The default value is <code>precisionEL = 1e-4</code>, i.e., limits of the confidence interval have a total of 4 decimal places.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiterEL</code></td>
<td>
<p>A single integer specifying the maximal number of iterations allowed for the convergene of the empirical likelihood method. The default value is <code>maxiterEL = 100L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>large.sample</code></td>
<td>
<p>A 'TRUE/FALSE' logical value indicating whether the sample is large to apply a faster algorithm to sort the sample values. The default value is <code>large.sample = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a sample <code class="reqn">S</code>, with size <code class="reqn">n</code>, derived from an infinite population, the Gini index is estimated by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{G}      = \displaystyle \frac{2}{\overline{y}n^{2}}\sum_{i \in S}iy_{(i)} - \frac{n+1}{n} </code>
</p>

<p>when <code>bias.correction = FALSE</code>, and by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{G}^{bc} = \displaystyle \frac{2}{\overline{y}n(n-1)}\sum_{i \in S}iy_{(i)} - \frac{n+1}{n-1} </code>
</p>

<p>when <code>bias.correction = TRUE</code>. For more details, see Muñoz et al. (2023). The table below sumarises the various types of variances and confidence intervals that computes this function.
Methods based on the jackknife technique use the fast algorithm suggested by Ogwang (2000). The linearization technique for variance estimation (Deville, 1999) has been applied to the following estimators of the Gini index (Berger, 2008; Langel and Tille, 2013):
</p>
<p style="text-align: center;"><code class="reqn">\widehat{G}^{a} = \displaystyle \frac{1}{2\overline{y}n^{2}}\sum_{i \in S}\sum_{j\in S} |y_i-y_j|</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\widehat{G}^{b}      = \displaystyle \frac{2}{\overline{y}n}\sum_{i \in S}y_{i}\widehat{F}_{n}(y_{i}) - 1,</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\widehat{F}_{n}(y_i)=\frac{1}{n}\sum_{j \in S}\delta(y_j \leq y_i).</code>
</p>

<p><code>zalinearization</code> and <code>zblinearization</code> linearizate, respectively, the estimators <code class="reqn">\widehat{G}^{a}</code> and <code class="reqn">\widehat{G}^{b}</code>. The percentile bootstrap (see Qin et al., 2010) is computed using <code>pbootstrap</code>. <code>Bca</code> is the bias corrected bootstrap confidence interval (Efron and Tibshirani, 1993). <code>ELchisq</code> and <code>ELboot</code> are the confidence intervals based on the empirical likelihood method.
The <b>vignette</b> <code>vignette("GiniVarInterval")</code> contains a detailed description of the various methods for variance estimation and confidence intervals for the Gini index.
</p>

<table>
<tr>
<td style="text-align: left;">
<b>Interval</b>          </td>
<td style="text-align: left;"> <b>Variance</b> </td>
<td style="text-align: left;"> <b>Critical values</b>  </td>
<td style="text-align: left;"> <b>References</b>
</td>
</tr>
<tr>
<td style="text-align: left;">
_______________     </td>
<td style="text-align: left;"> ____________  </td>
<td style="text-align: left;"> __________________ </td>
<td style="text-align: left;"> __________________________</td>
</tr>
<tr>
<td style="text-align: left;">
<code>zjackknife</code>        </td>
<td style="text-align: left;"> Jackknife     </td>
<td style="text-align: left;"> Normal                </td>
<td style="text-align: left;"> Berger (2008)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>tjackknife</code>        </td>
<td style="text-align: left;"> Jackknife     </td>
<td style="text-align: left;"> Studentized bootstrap </td>
<td style="text-align: left;"> Biewen (2002); Berger (2008)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>zalinearization</code>    </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Normal                </td>
<td style="text-align: left;"> Langel and Tille (2013)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>zblinearization</code>    </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Normal                </td>
<td style="text-align: left;"> Berger (2008)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>talinearization</code>    </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Studentized bootstrap </td>
<td style="text-align: left;"> Langel and Tille (2013)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>tblinearization</code>    </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Studentized bootstrap </td>
<td style="text-align: left;"> Biewen (2002); Berger (2008)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>pBootstrap</code>        </td>
<td style="text-align: left;"> Bootstrap     </td>
<td style="text-align: left;"> Percentile bootstrap  </td>
<td style="text-align: left;"> Qin et al. (2010)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>BCa</code>               </td>
<td style="text-align: left;"> Bootstrap  </td>
<td style="text-align: left;"> BCa bootstrap           </td>
<td style="text-align: left;"> Davison and Hinkley (1997)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>ELchisq</code>           </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Chi-Squared           </td>
<td style="text-align: left;"> Qin et al. (2010)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>ELboot</code>            </td>
<td style="text-align: left;"> Bootstrap     </td>
<td style="text-align: left;"> Percentile bootstrap  </td>
<td style="text-align: left;"> Qin et al. (2010)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>When <code>interval = NULL</code>, a single numeric value between 0 and 1, containing the estimation of the Gini index based on the vector <code>y</code> or the vector <code>cum.sums</code>.
When <code>interval</code> is not <code>NULL</code>, a list of 3 components: a single numeric value with the estimation of the Gini index; a single numeric value with the variance estimation of the Gini index; and a numeric matrix with 1 row and 2 columns containing the lower and upper limits of the confidence intervals for the Gini index.
</p>


<h3>Author(s)</h3>

<p>Juan F Munoz <a href="mailto:jfmunoz@ugr.es">jfmunoz@ugr.es</a>
</p>
<p>Jose M Pavia <a href="mailto:pavia@uv.es">pavia@uv.es</a>
</p>
<p>Encarnacion Alvarez <a href="mailto:encarniav@ugr.es">encarniav@ugr.es</a>
</p>


<h3>References</h3>

<p>Berger, Y. G. (2008). A note on the asymptotic equivalence of jackknife and linearization variance estimation for the Gini Coefficient. Journal of Official Statistics, 24(4), 541-555.
</p>
<p>Biewen, M. (2002). Bootstrap inference for inequality, mobility and poverty measurement. Journal of Econometrics, 108(2), 317-342.
</p>
<p>Davison, A. C., and Hinkley, D. V. (1997). Bootstrap Methods and Their Application (Cambridge Series in Statistical and Probabilistic Mathematics, No 1)–Cambridge University Press.
</p>
<p>Deville, J.C. (1999). Variance Estimation for Complex Statistics and Estimators: Linearization and Residual Techniques. Survey Methodology, 25, 193–203.
</p>
<p>Efron, B. and Tibshirani, R. (1993). An Introduction to the Bootstrap. Chapman and Hall, New York, London.
</p>
<p>Langel, M., and Tille, Y. (2013). Variance estimation of the Gini index: revisiting a result several times published. Journal of the Royal Statistical Society: Series A (Statistics in Society), 176(2), 521-540.
</p>
<p>Muñoz, J. F., Moya-Fernández, P. J., and Álvarez-Verdejo, E. (2023). Exploring and Correcting the Bias in the Estimation of the Gini Measure of Inequality. Sociological Methods &amp; Research. https://doi.org/10.1177/00491241231176847
</p>
<p>Ogwang, T. (2000). A convenient method of computing the Gini index and its standard error. Oxford Bulletin of Economics and Statistics, 62(1), 123-123.
</p>
<p>Qin, Y., Rao, J. N. K., and Wu, C. (2010). Empirical likelihood confidence intervals for the Gini measure of income inequality. Economic Modelling, 27(6), 1429-1435.
</p>


<h3>See Also</h3>

<p><code>icompareCI</code>, <code>iginindex</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sample, with size 50, from a Lognormal distribution. The true Gini index is 0.5.
set.seed(123)
y &lt;- gsample(n = 50, gini = 0.5, distribution = "lognormal")

# Bias corrected estimation of the Gini index.
igini(y)

# Estimation of the Gini index and confidence interval based on jackknife and studentized bootstrap.
igini(y, interval = "tjackknife")


</code></pre>


</div>