<div class="container">

<table style="width: 100%;"><tr>
<td>gwr.mixed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixed GWR</h2>

<h3>Description</h3>

<p>This function implements mixed (semiparametric) GWR
</p>


<h3>Usage</h3>

<pre><code class="language-R">gwr.mixed(formula, data, regression.points, fixed.vars,
                     intercept.fixed=FALSE, bw, diagnostic=T, kernel="bisquare", 
                     adaptive=FALSE, p=2, theta=0, longlat=F,dMat, dMat.rp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Regression model formula of a formula object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a Spatial*DataFrame, i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame as defined in package <span class="pkg">sp</span>, or a sf object defined in package <span class="pkg">sf</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regression.points</code></td>
<td>
<p>a Spatial*DataFrame object, i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame as defined in package <span class="pkg">sp</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.vars</code></td>
<td>
<p>independent variables that appeared in the formula that are to be treated as global</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept.fixed</code></td>
<td>
<p>logical, if TRUE the intercept will be treated as global</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>bandwidth used in the weighting function, possibly calculated by bw.gwr;fixed (distance) or adaptive bandwidth(number of nearest neighbours)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostic</code></td>
<td>
<p>logical, if TRUE the diagnostics will be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>function chosen as follows:
</p>
<p>gaussian: wgt = exp(-.5*(vdist/bw)^2);
</p>
<p>exponential: wgt = exp(-vdist/bw);
</p>
<p>bisquare: wgt = (1-(vdist/bw)^2)^2 if vdist &lt; bw, wgt=0 otherwise;
</p>
<p>tricube: wgt = (1-(vdist/bw)^3)^3 if vdist &lt; bw, wgt=0 otherwise; 
</p>
<p>boxcar: wgt=1 if dist &lt; bw, wgt=0 otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive</code></td>
<td>
<p>if TRUE calculate an adaptive kernel where the bandwidth (bw) corresponds to the number of nearest neighbours (i.e. adaptive distance); default is FALSE, where a fixed kernel is found (bandwidth is a fixed distance)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the power of the Minkowski distance, default is 2, i.e. the Euclidean distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>an angle in radians to rotate the coordinate system, default is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>if TRUE, great circle distances will be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dMat</code></td>
<td>
<p>a pre-specified distance matrix, it can be calculated by the function <code>gw.dist</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dMat.rp</code></td>
<td>
<p>a distance matrix when an individual set of regression points are adopted</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of class “mgwr”:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>GW.arguments</code></td>
<td>
<p>a list class object including the model fitting parameters for generating the report file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AICc value from this calibration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.used</code></td>
<td>
<p> effective degree of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rss</code></td>
<td>
<p>residual sum of squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SDF</code></td>
<td>
<p>a SpatialPointsDataFrame (may be gridded), or 
SpatialPolygonsDataFrame object (see package “sp”), or sf object  (see package “sf”) 
integrated with coefficient estimates in its "data" slot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timings</code></td>
<td>
<p>starting and ending time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>this.call</code></td>
<td>
<p>the function call used.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>For an alternative formulation of mixed GWR, please refer to GWR 4, which provides useful tools for automatic bandwidth selection.
This windows-based software also implements generalised mixed GWR.
</p>
<p>The mixed GWR in the latest release of GWmodel (2.0-0) has been revised by Dr. Fiona H Evans from Centre for Digital Agriculture, Murdoch and Curtin Universities in terms of its computational efficiency.
</p>


<h3>Author(s)</h3>

<p>Binbin Lu <a href="mailto:binbinlu@whu.edu.cn">binbinlu@whu.edu.cn</a></p>


<h3>References</h3>

<p>Fotheringham S, Brunsdon, C, and Charlton, M (2002),
Geographically Weighted Regression: The Analysis of Spatially Varying Relationships, Chichester: Wiley.
</p>
<p>Brunsdon C, Fotheringham AS, Charlton ME (1999) Some notes on parametric signficance 
tests for geographically weighted regression. Journal of Regional Science 39(3):497-524
</p>
<p>Mei L-M, He S-Y, Fang K-T (2004) A note on the mixed geographically weighted regression 
model. Journal of regional science 44(1):143-157
</p>
<p>Mei L-M, Wang N, Zhang W-X (2006) Testing the importance of the explanatory variables 
in a mixed geographically weighted regression model. Environment and Planning A 38:587-598
</p>
<p>Nakaya T, Fotheringham AS, Brunsdon C, Charlton M (2005) Geographically Weighted Poisson Regression for Disease Association Mapping,
Statistics in Medicine 24: 2695-2717
</p>
<p>Nakaya T et al. (2011) GWR4.0, <a href="http://gwr.nuim.ie/">http://gwr.nuim.ie/</a>.
</p>


</div>