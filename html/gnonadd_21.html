<div class="container">

<table style="width: 100%;"><tr>
<td>train_and_impute_PRS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Trains and imputes a poligenic risk score (PRS)</h2>

<h3>Description</h3>

<p>This function trains a poligenic risk score model on a dataset, and then imputes the risk score into another dataset
</p>


<h3>Usage</h3>

<pre><code class="language-R">train_and_impute_PRS(
  qt_training,
  g_training,
  g_impute,
  dominance_effects = rep(FALSE, ncol(g_training)),
  interaction_effects = matrix(0, nrow = 0, ncol = 0)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>qt_training</code></td>
<td>
<p>A numeric vector. Represents the qt values of the data we train the model on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_training</code></td>
<td>
<p>A matrix, where each colomn represents a variant and each line represents a subject in the training data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_impute</code></td>
<td>
<p>A matrix, where each column represents a variant and each line represents a subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dominance_effects</code></td>
<td>
<p>A Boolian vector, each term determines whether a dominance term for the corresponding variant is used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction_effects</code></td>
<td>
<p>An integer matrix with two columns. Each line represents a pair of interacting variants that should be included in the model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following objects
* PRS_imputed, the imputed PRS values
* PRS_training, the PRS values for the training data
* Residuals_training, the residuals from the model in the training data
</p>


<h3>Examples</h3>

<pre><code class="language-R">g_train_vec &lt;- matrix(0, nrow = 100000, ncol = 5)
freqs &lt;- runif(ncol(g_train_vec), min = 0, max = 1)
for(i in 1:ncol(g_train_vec)){
 g_train_vec[,i] &lt;- rbinom(100000, 2, freqs[i])
}
g_impute_vec &lt;- matrix(0, nrow = 50000, ncol = 5)
for(i in 1:ncol(g_impute_vec)){
 g_impute_vec[,i] &lt;- rbinom(50000, 2, freqs[i])
}
dom_vec &lt;- c(TRUE, FALSE, FALSE, TRUE, FALSE)

int_vec &lt;- matrix(c(1, 2, 4, 5), nrow = 2 , ncol = 2)

qt_vec &lt;- rnorm(100000) + 0.2 * g_train_vec[, 1] + 0.3 * g_train_vec[, 1] * g_train_vec[, 4]

res &lt;- train_and_impute_PRS(qt_vec, g_train_vec, g_impute_vec,
       dominance_effects = dom_vec, interaction_effects = int_vec)
</code></pre>


</div>