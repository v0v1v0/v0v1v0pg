<div class="container">

<table style="width: 100%;"><tr>
<td>derivatives</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derivatives of estimated smooths via finite differences</h2>

<h3>Description</h3>

<p>Derivatives of estimated smooths via finite differences
</p>


<h3>Usage</h3>

<pre><code class="language-R">derivatives(object, ...)

## Default S3 method:
derivatives(object, ...)

## S3 method for class 'gamm'
derivatives(object, ...)

## S3 method for class 'gam'
derivatives(
  object,
  select = NULL,
  term = deprecated(),
  data = newdata,
  order = 1L,
  type = c("forward", "backward", "central"),
  n = 100,
  eps = 1e-07,
  interval = c("confidence", "simultaneous"),
  n_sim = 10000,
  level = 0.95,
  unconditional = FALSE,
  frequentist = FALSE,
  offset = NULL,
  ncores = 1,
  partial_match = FALSE,
  ...,
  newdata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an R object to compute derivatives for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>character; select which smooth's posterior to draw from.
The default (<code>NULL</code>) means the posteriors of all smooths in <code>model</code>
wil be sampled from. If supplied, a character vector of requested terms.
Can be a partial match to a smooth term; see argument <code>partial_match</code>
below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Use <code>select</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the values of the model covariates
at which to evaluate the first derivatives of the smooths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>numeric; the order of derivative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character; the type of finite difference used. One of
<code>"forward"</code>, <code>"backward"</code>, or <code>"central"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric; the number of points to evaluate the derivative at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>numeric; the finite difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>character; the type of interval to compute. One of
<code>"confidence"</code> for point-wise intervals, or <code>"simultaneous"</code> for
simultaneous intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sim</code></td>
<td>
<p>integer; the number of simulations used in computing the
simultaneous intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>numeric; <code style="white-space: pre;">⁠0 &lt; level &lt; 1⁠</code>; the confidence level of the
point-wise or simultaneous interval. The default is <code>0.95</code> for a 95%
interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconditional</code></td>
<td>
<p>logical; use smoothness selection-corrected Bayesian
covariance matrix?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequentist</code></td>
<td>
<p>logical; use the frequentist covariance matrix?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>numeric; a value to use for any offset term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>number of cores for generating random variables from a
multivariate normal distribution. Passed to <code>mvnfast::rmvn()</code>.
Parallelization will take place only if OpenMP is supported (but appears
to work on Windows with current <code>R</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial_match</code></td>
<td>
<p>logical; should smooths be selected by partial matches
with <code>term</code>? If <code>TRUE</code>, <code>term</code> can only be a single string to match
against.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Deprecated: use <code>data</code> instead.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tibble, currently with the following variables:
</p>

<ul>
<li> <p><code>smooth</code>: the smooth each row refers to,
</p>
</li>
<li> <p><code>var</code>: the name of the variable involved in the smooth,
</p>
</li>
<li> <p><code>data</code>: values of <code>var</code> at which the derivative was evaluated,
</p>
</li>
<li> <p><code>derivative</code>: the estimated derivative,
</p>
</li>
<li> <p><code>se</code>: the standard error of the estimated derivative,
</p>
</li>
<li> <p><code>crit</code>: the critical value such that <code>derivative</code> ± <code>(crit * se)</code> gives
the upper and lower bounds of the requested confidence or simultaneous
interval (given <code>level</code>),
</p>
</li>
<li> <p><code>lower</code>: the lower bound of the confidence or simultaneous interval,
</p>
</li>
<li> <p><code>upper</code>: the upper bound of the confidence or simultaneous interval.
</p>
</li>
</ul>
<h3>Note</h3>

<p><code>derivatives()</code> will ignore any random effect smooths it encounters in
<code>object</code>.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>Examples</h3>

<pre><code class="language-R">
load_mgcv()

dat &lt;- data_sim("eg1", n = 400, dist = "normal", scale = 2, seed = 42)
mod &lt;- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = "REML")

## first derivatives of all smooths using central finite differences
derivatives(mod, type = "central")

## derivatives for a selected smooth
derivatives(mod, type = "central", select = "s(x1)")
## or via a partial match
derivatives(mod, type = "central", select = "x1", partial_match = TRUE)

</code></pre>


</div>