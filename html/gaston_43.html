<div class="container">

<table style="width: 100%;"><tr>
<td>LD.clump</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> LD clumping </h2>

<h3>Description</h3>

<p> Construct group of SNPs in LD with 'top associated SNPs' </p>


<h3>Usage</h3>

<pre><code class="language-R">LD.clump(x, p, r2.threshold, p.threshold, max.dist = 500e3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> A <code>bed.matrix</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> A vector of p-values, or a data frame including p-values, such as sent back by <code>association.test</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2.threshold</code></td>
<td>
<p> The maximum LD (measured by <code class="reqn">r^2</code>) between SNPs in a group </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.threshold</code></td>
<td>
<p> The threshold used to define associated SNPs </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist</code></td>
<td>
<p> The maximum distance for which the LD is computed </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The p-values provided through argument <code>p</code> are assumed to correspond to the result of an association test with the SNPs of <code>x</code>.
</p>
<p>The aim of the function is to construct cluster of SNPs in strong LD with associated SNPs.
The algorithm first seeks the SNP with the lowest p-value (below <code>p.threshold</code>) ; this SNP will be the 'index' of a cluster. 
The corresponding cluster is constructed by aggregating SNPs that are in LD (above <code>r2.threshold</code>) with the index. The cluster's name 
is the position of the index SNP.
The processus is repeated on the SNPs which are not yet attributed to a cluster, until there is no associated SNP 
(ie SNP with a p-value below <code>threshold</code>) left.
The remaining SNPs are attributed to cluster 0. 
</p>
<p>The LD is computed only for SNP pairs for which distance is inferior to <code>max.dist</code>, expressed in number of bases: above this 
distance it is assumed to be null.
</p>


<h3>Value</h3>

<p>If <code>p</code> was a data frame, then the function returns the same data frame with to extra columns, <code>cluster</code> and <code>is.index</code>.
If <code>p</code> was a vector of p-values, it returns a data frame with columns <code>chr</code>, <code>id</code>, <code>pos</code>, <code>p</code>, <code>cluster</code> 
and <code>is.index</code>.
</p>


<h3>See Also</h3>

 <p><code>LD</code>, <code>LD.thin</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Construct a bed matrix
x &lt;- as.bed.matrix(TTN.gen, TTN.fam, TTN.bim)
standardize(x) &lt;- "p"
     
# simulate quantitative phenotype with effect of SNPs #108 and #631
beta &lt;- numeric(ncol(x))
beta[c(108,631)] &lt;- 0.5
set.seed(1)
y &lt;- x %*% beta + rnorm(nrow(x))
     
# association test with linear model 
test &lt;- association.test(x, y, method="lm", response = "quanti")

# LD clumping
test &lt;- LD.clump(x, test, r2.threshold = 0.25, p.threshold = 1e-8)

# use as.factor for a quick-and-dirty cluster colouring on the manhattan plot 
manhattan(test, col = as.factor(test$cluster), pch = 20)
</code></pre>


</div>