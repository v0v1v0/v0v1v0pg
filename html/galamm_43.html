<div class="container">

<table style="width: 100%;"><tr>
<td>t2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set up smooth term with factor loading</h2>

<h3>Description</h3>

<p>This is a very thin wrapper around <code>mgcv::t2</code>. It enables
the specification of loading variables for smooth terms. The last letter
"l", which stands for "loading", has been added to avoid namespace
conflicts with <code>mgcv</code> and <code>gamm4</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">t2l(..., factor = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed on to <code>mgcv::t2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor</code></td>
<td>
<p>Optional character of length one specifying the loading
variable. Case sensitive.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The documentation of the function <code>mgcv::t2</code> should be consulted
for details on how to properly set up smooth terms. In particular, note
that these terms distinguish between ordered and unordered factor terms
in the <code>by</code> variable, which can be provided in <code>...</code> and is
forwarded to <code>mgcv::t2</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>xx.smooth.spec</code>, where <code>xx</code> is a basis
identifying code given by the <code>bs</code> argument of <code>t2</code>. It differs
from the smooth returned by <code>mgcv::s</code> in that it has an additional
attribute named <code>"factor"</code> which specifies any factor loading which
this smooth term should be multiplied with in order to produce the observed
outcome.
</p>


<h3>References</h3>

<p>Wood SN (2003).
“Thin Plate Regression Splines.”
<em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <b>65</b>(1), 95–114.
ISSN 1369-7412.
</p>
<p>Wood SN (2017).
<em>Generalized Additive Models: An Introduction with R</em>, 2 edition.
Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p>Other modeling functions: 
<code>galamm()</code>,
<code>s()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Linear mixed model with factor structures
dat &lt;- subset(cognition, domain == 1 &amp; timepoint == 1)
loading_matrix &lt;- matrix(c(1, NA, NA), ncol = 1)

# Model with four cubic regression splines as basis functions
mod &lt;- galamm(
  formula = y ~ 0 + item + t2l(x, k = 4, factor = "loading"),
  data = dat,
  load.var = "item",
  lambda = loading_matrix,
  factor = "loading"
)

# Model with four thin-plate regression splines as basis functions
mod &lt;- galamm(
  formula = y ~ 0 + item +
    t2l(x, bs = "tp", k = 4, factor = "loading"),
  data = dat,
  load.var = "item",
  lambda = loading_matrix,
  factor = "loading"
)

</code></pre>


</div>