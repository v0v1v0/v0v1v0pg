<div class="container">

<table style="width: 100%;"><tr>
<td>sim.bdtree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>birth-death tree simulator</h2>

<h3>Description</h3>

<p>simulating phylogenetic trees under a uniform birth-death process
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.bdtree(b=1, d=0, stop=c("taxa", "time"), n=100, t=4, seed=0, extinct=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>per-lineage birth (speciation) rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>per-lineage death (extinction) rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop</code></td>
<td>
<p>stopping criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>maximum number of taxa in simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>maximum time steps of simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random number seed (default is to seed based on the clock)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extinct</code></td>
<td>
<p> whether to return trees where all lineages have gone extinct (see <b>Details</b>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Starting from a root node - i.e., two living lineages - this function simulates the growth of a
phylogenetic tree under a uniform, time-homogeneous birth-death process.  This means that every
lineage has a constant probability of speciating, and a constant probability of going extinct, per
unit time.  If birth is greater than death, then the number of lineages is expected to grow exponentially.
If <code>extinct=FALSE</code>, the function will build trees until one is simulated with at least one surviving lineage. 
</p>


<h3>Value</h3>

<p>A phylogenetic tree in 'phylo' format is returned.  If death rate is non-zero, then the returned tree will likely 
include some extinct lineages (terminating before the present day).  See <code>drop.extinct</code> for 
a function to remove these lineages.
</p>


<h3>Note</h3>

 
<p>One note of caution: it is easy to set parameter values that result in tremendously <em>huge</em> trees.  If the
function seems to hang up, this could be the problem.
</p>
<p>Other tree simulators are available from the packages <span class="pkg">ape</span> (<code>rbdtree</code>), <span class="pkg">TreeSim</span> (<code>sim.bd.taxa</code>, <code>sim.bd.age</code>, and <code>sim.bd.taxa.age</code>), and <span class="pkg">phytools</span> (<code>pbtree</code>).
</p>


<h3>Author(s)</h3>

<p> LJ Harmon and J Weir</p>


<h3>See Also</h3>

<p><code>sim.bd</code> for non-phylogenetic simulations; <code>drop.extinct</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Pure-birth tree
p1 &lt;- sim.bdtree(b=0.1, d=0, stop="time", t=20)
plot(p1)

# Birth-death tree with extinct taxa
# The extinct flag prevents trees with no survivors

p2 &lt;- sim.bdtree(b=0.2, d=0.05, stop="time", t=20, extinct=FALSE)
plot(p2)

# Previous tree with extinct taxa removed
p3 &lt;- drop.extinct(p2)

</code></pre>


</div>