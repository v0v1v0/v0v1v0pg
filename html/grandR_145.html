<div class="container">

<table style="width: 100%;"><tr>
<td>PlotScatter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make a scatter plot</h2>

<h3>Description</h3>

<p>Convenience method to compare two variables (slot data or analyses results).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotScatter(
  data,
  x = NULL,
  y = NULL,
  analysis = NULL,
  xcol = NULL,
  ycol = NULL,
  xlab = NULL,
  ylab = NULL,
  log = FALSE,
  log.x = log,
  log.y = log,
  axis = TRUE,
  axis.x = axis,
  axis.y = axis,
  remove.outlier = 1.5,
  show.outlier = TRUE,
  lim = NULL,
  xlim = lim,
  ylim = lim,
  size = 0.3,
  cross = NULL,
  diag = NULL,
  filter = NULL,
  genes = NULL,
  highlight = NULL,
  label = NULL,
  label.repel = 1,
  facet = NULL,
  color = NULL,
  colorpalette = NULL,
  color.label = NULL,
  density.margin = "n",
  density.n = 100,
  rasterize = NULL,
  correlation = NULL,
  correlation.x = -Inf,
  correlation.y = Inf,
  correlation.hjust = 0.5,
  correlation.vjust = 0.5,
  layers.below = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the grandR object (can also be a plain data frame)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an expression to compute the x value or a character corresponding to a sample (or cell) name or a fully qualified analysis result name (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an expression to compute the y value or a character corresponding to a sample (or cell) name or a fully qualified analysis result name (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analysis</code></td>
<td>
<p>the name of an analysis table (can be NULL; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcol</code></td>
<td>
<p>a character corresponding to a sample (or cell) name or a fully qualified analysis result name (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ycol</code></td>
<td>
<p>a character corresponding to a sample (or cell) name or a fully qualified analysis result name (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>the label for x (can be NULL, then the x parameter is used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>the label for y (can be NULL, then the y parameter is used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>if TRUE, use log scales for x and y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.x</code></td>
<td>
<p>if TRUE, use log scale for the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.y</code></td>
<td>
<p>if TRUE, use log scale for the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis</code></td>
<td>
<p>if FALSE, don't show x and y axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.x</code></td>
<td>
<p>if FALSE, don't show the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.y</code></td>
<td>
<p>if FALSE, don't show the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.outlier</code></td>
<td>
<p>configure how outliers are selected (is the coef parameter to boxplot.stats); can be FALSE, in which case no points are considered outliers (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.outlier</code></td>
<td>
<p>if TRUE, show outlier as gray points at the border of the plotting plane</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>
<p>define the both x and y axis limits (vector of length 2 defining the lower and upper bound, respectively)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>define the x axis limits (vector of length 2 defining the lower and upper bound, respectively)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>define the y axis limits (vector of length 2 defining the lower and upper bound, respectively)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>the point size to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cross</code></td>
<td>
<p>add horizontal and vertical lines through the origin?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>if TRUE, add main diagonal; if numeric vector, add these diagonals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>restrict to these rows; is evaluated for the data frame, and should result in a logical vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genes</code></td>
<td>
<p>restrict to these genes; can be either numeric indices, gene names, gene symbols or a logical vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight</code></td>
<td>
<p>highlight these genes; can be either numeric indices, gene names, gene symbols or a logical vector (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>label these genes; can be either numeric indices, gene names, gene symbols or a logical vector (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.repel</code></td>
<td>
<p>force to repel labels from points and each other (increase if labels overlap)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet</code></td>
<td>
<p>an expression (evaluated in the same environment as x and y); for each unique value a panel (facet) is created; can be NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>either NULL (use point density colors), or a name of the GeneInfo table (use scale_color_xxx to define colors), or a color for all points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorpalette</code></td>
<td>
<p>either NULL (use default colors), or a palette name from color brewer or viridis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.label</code></td>
<td>
<p>the label for the color legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.margin</code></td>
<td>
<p>for density colors, one of 'n','x' or 'y'; should the density be computed along both axes ('n'), or along 'x' or 'y' axis only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.n</code></td>
<td>
<p>how many bins to use for density calculation (see kde2d)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rasterize</code></td>
<td>
<p>use ggrastr to rasterize points? (can be NULL, see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>a function to format correlation statistics to be annotated (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation.x</code></td>
<td>
<p>x coordinate to put the correlation annotation in the plot (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation.y</code></td>
<td>
<p>y coordinate to put the correlation annotation in the plot (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation.hjust</code></td>
<td>
<p>x adjustment to put the correlation annotation in the plot (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation.vjust</code></td>
<td>
<p>y adjustment to put the correlation annotation in the plot (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layers.below</code></td>
<td>
<p>list of ggplot geoms to add before adding the layer containing the points</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Both the x and y parameter are either expressions or names. Names are either sample (or cell, in case of single cell experiments) names or
fully qualified analysis results (analysis name followed by a dot and the analysis result table column). If the analysis parameter is given, the analysis
name must be omitted from x and y. These names can be used within expressions using non-standard evaluation.
Defining by names only works with character literals like "kinetics.Synthesis", but if you give an expression (e.g. a variable name that contains a character),
the situation is more complicated, since PlotScatter will try to evaluate this for defining the values, not the name of the column. If the expression evaluates
into a single character string that is equal to a name (see above!), PlotScatter knows what to do. For more complicated situations that cannot be resolved by this,
you can use the xcol and ycol parameters instead of the x and y parameters!
</p>
<p>By default the limits of x and y axis are chosen after removing outliers (using the same algorithm used for boxplot). Thus, larger numbers filter
less stringently. remove.outlier can also be set to FALSE (no outlier filtering). If xlim or ylim are set, this overrides outlier filtering. Points outside of the limits
(i.e. outliers or points outside of xlim or ylim) are set to infinity (such that they are shown at the border of the plot in gray)
</p>
<p>By default, all genes are shown. This can be restricted using the <code>genes</code> parameter (see ToIndex). It is also possible to highlight a subset of the genes
using <code>highlight</code>. This parameter either describes a subset of the genes (either numeric indices, gene names, gene symbols or a logical vector), in which case these genes
are plotted in red and with larger points size, or it can be a list of such vectors. The names of this list must be valid colors. Genes can also be labeled (make sure that this
is really only a small subset of the genes).
</p>
<p>When rendering to vector based devices (such as svg or pds), a genome-wide scatterplot often is painfully big (and rendering therefore slow). The <code>rasterize</code>
parameter can be used to automatically rasterize the points only (via the ggrastr package). If this parameter is NULL, ggrastr is used if more than 1000 points are plotted!
</p>
<p>Often scatter plots show that x and y coordinates are correlated. Correlations can be annotated using the FormatCorrelation function. Most often you will use
<code>PlotScatter(data,x,y,correlation=FormatCorrelation())</code>. To use a different correlation measure, other formats for correlation coefficient and P values or omit one of these
statistics, parametrize <code>FormatCorrelation</code>. Use correlation.x and correlation.y to place the annotation in the plot, and correlation.hjust/correlation.vjust to align the
annotation at the given x,y coordinates. Infinite values for correlation.x/correlation.y will put the annotation at the border of the plot.
</p>


<h3>Value</h3>

<p>a ggplot object with the data frame used as the df attribute
</p>


</div>