<div class="container">

<table style="width: 100%;"><tr>
<td>find_peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find local maxima or global maximum (peaks)</h2>

<h3>Description</h3>

<p>This method finds peaks (local maxima) in a vector, using a user selectable
span and size threshold relative to the tallest peak (global maximum).
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_peaks(x, ignore_threshold = 0, span = 3, strict = FALSE, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_threshold</code></td>
<td>
<p>numeric value between 0.0 and 1.0 indicating the size
threshold below which peaks will be ignored, or a negative value &gt;= -1,
to ignore peaks above a threshold. These values are relative to the range
of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element. The default value is 3, meaning that a peak is bigger than both of
its neighbors. <code>span = NULL</code> extends the span to the whole length of
<code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strict</code></td>
<td>
<p>logical flag: if TRUE, an element must be strictly greater than
all other values in its window to be considered a peak. Default: TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code> values should be stripped
before searching for peaks.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a wrapper built onto function
<code>peaks</code> from <span class="pkg">splus2R</span> and handles non-finite
(including NA) values differently than <code>peaks</code>, instead of giving an
error when <code>na.rm = FALSE</code> and <code>x</code> contains <code>NA</code> values,
<code>NA</code> values are replaced with the smallest finite value in <code>x</code>.
<code>span = NULL</code> is treated as a special case and returns <code>max(x)</code>.
</p>


<h3>Value</h3>

<p>A vector of logical values. Values that are TRUE correspond to local
peaks in vector <code>x</code> and can be used to extract the rows corresponding
to peaks from a data frame.
</p>


<h3>Note</h3>

<p>The default for parameter <code>strict</code> is <code>FALSE</code> in functions
<code>peaks()</code> and <code>find_peaks()</code>, as in <code>stat_peaks()</code> and in
<code>stat_valleys()</code>, while the default in <code>peaks</code>
is <code>strict = TRUE</code>.
</p>


<h3>See Also</h3>

<p><code>peaks</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># lynx is a time.series object
lynx_num.df &lt;-
  try_tibble(lynx,
             col.names = c("year", "lynx"),
             as.numeric = TRUE) # years -&gt; as numeric

which(find_peaks(lynx_num.df$lynx, span = 31))
lynx_num.df[find_peaks(lynx_num.df$lynx, span = 15), ]
lynx_num.df[find_peaks(lynx_num.df$lynx, span = NULL), ]
lynx_num.df[find_peaks(lynx_num.df$lynx,
                       span = 31,
                       ignore_threshold = 0.75), ]

lynx_datetime.df &lt;-
   try_tibble(lynx,
              col.names = c("year", "lynx")) # years -&gt; POSIXct

which(find_peaks(lynx_datetime.df$lynx, span = 31))
lynx_datetime.df[find_peaks(lynx_datetime.df$lynx, span = 31), ]
lynx_datetime.df[find_peaks(lynx_datetime.df$lynx,
                            span = 31,
                            ignore_threshold = 0.75), ]

</code></pre>


</div>