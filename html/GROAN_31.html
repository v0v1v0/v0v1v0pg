<div class="container">

<table style="width: 100%;"><tr>
<td>phenoRegressor.RFR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random Forest Regression using package randomForest</h2>

<h3>Description</h3>

<p>This is a wrapper around randomForest and related functions.
As such, this function will not work if randomForest package is not installed.
There is no distinction between regular covariates (genotypes) and extra
covariates (fixed effects) in random forest. If extra covariates are passed, they are
put together with genotypes, side by side. Same thing happens with covariances matrix. This
can bring to the scientifically questionable but technically correct situation of regressing
on a big matrix made of SNP genotypes, covariances and other covariates, all collated side by side.
The function makes no distinction, and it's up to the user understand what is correct in each
specific experiment.<br><br><strong>WARNING</strong>: this function can be *very* slow, especially when called on thousands of SNPs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phenoRegressor.RFR(
  phenotypes,
  genotypes,
  covariances,
  extraCovariates,
  ntree = ceiling(length(phenotypes)/5),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phenotypes</code></td>
<td>
<p>phenotypes, a numeric array (n x 1), missing values are predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>SNP genotypes, one row per phenotype (n), one column per marker (m), values in 0/1/2 for
diploids or 0/1/2/...ploidy for polyploids. Can be NULL if <code>covariances</code> is present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariances</code></td>
<td>
<p>square matrix (n x n) of covariances. Can be NULL if <code>genotypes</code> is present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraCovariates</code></td>
<td>
<p>extra covariates set, one row per phenotype (n), one column per covariate (w).
If NULL no extra covariates are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntree</code></td>
<td>
<p>number of trees to grow, defaults to a fifth of the number of samples (rounded
up). As per <code>randomForest</code> documentation, it should not be set to too
small a number, to ensure that every input row gets predicted at least a few times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any extra parameter is passed to <code>randomForest::randomForest()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the following fields:
</p>

<ul>
<li> <p><code>predictions</code> : an array of (k) predicted phenotypes
</p>
</li>
<li> <p><code>hyperparams</code> : named vector with the following keys: ntree (number of grown trees)
and mtry (number of variables randomly sampled as candidates at each split)
</p>
</li>
<li> <p><code>extradata</code>   : the object returned by <code>randomForest::randomForest()</code>, containing the
full trained forest and the used parameters
</p>
</li>
</ul>
<h3>See Also</h3>

<p>randomForest
</p>
<p>Other phenoRegressors: 
<code>phenoRegressor.BGLR()</code>,
<code>phenoRegressor.SVR()</code>,
<code>phenoRegressor.dummy()</code>,
<code>phenoRegressor.rrBLUP()</code>,
<code>phenoregressor.BGLR.multikinships()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#using the GROAN.KI dataset, we regress on the dataset and predict the first ten phenotypes
phenos = GROAN.KI$yield
phenos[1:10]  = NA

#calling the regressor with random forest
results = phenoRegressor.RFR(
  phenotypes = phenos,
  genotypes = GROAN.KI$SNPs,
  covariances = NULL,
  extraCovariates = NULL,
  ntree = 20,
  mtry = 200 #randomForest-specific parameters
)

#examining the predictions
plot(GROAN.KI$yield, results$predictions,
     main = 'Train set (black) and test set (red) regressions',
     xlab = 'Original phenotypes', ylab = 'Predicted phenotypes')
points(GROAN.KI$yield[1:10], results$predictions[1:10], pch=16, col='red')

#printing correlations
test.set.correlation  = cor(GROAN.KI$yield[1:10], results$predictions[1:10])
train.set.correlation = cor(GROAN.KI$yield[-(1:10)], results$predictions[-(1:10)])
writeLines(paste(
  'test-set correlation :', test.set.correlation,
  '\ntrain-set correlation:', train.set.correlation
))

## End(Not run)
</code></pre>


</div>