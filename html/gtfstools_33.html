<div class="container">

<table style="width: 100%;"><tr>
<td>get_trip_geometry</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get trip geometry</h2>

<h3>Description</h3>

<p>Returns the geometry of each specified <code>trip_id</code>, based either on the
<code>shapes</code> or the <code>stop_times</code> file (or both).
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_trip_geometry(
  gtfs,
  trip_id = NULL,
  file = NULL,
  crs = 4326,
  sort_sequence = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gtfs</code></td>
<td>
<p>A GTFS object, as created by <code>read_gtfs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trip_id</code></td>
<td>
<p>A character vector including the <code>trip_id</code>s to have their
geometries generated. If <code>NULL</code> (the default), the function generates
geometries for every <code>trip_id</code> in the GTFS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>A character vector specifying the file from which geometries
should be generated (either one of or both <code>shapes</code> and <code>stop_times</code>). If
<code>NULL</code> (the default), the function attemps to generate the geometries from
both files, but only raises an error if none of the files exist.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>The CRS of the resulting object, either as an EPSG code or as an
<code>crs</code> object. Defaults to 4326 (WGS 84).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort_sequence</code></td>
<td>
<p>A logical specifying whether to sort shapes and
timetables by <code>shape_pt_sequence</code> and <code>stop_sequence</code>, respectively.
Defaults to <code>FALSE</code>, otherwise spec-compliant feeds, in which
shape/timetables points are already ordered by
<code>shape_pt_sequence</code>/<code>stop_sequence</code>, would be penalized through longer
processing times. Geometries generated from unordered sequences do not
correctly depict the trip trajectories.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code style="white-space: pre;">⁠LINESTRING sf⁠</code>.
</p>


<h3>Details</h3>

<p>The geometry generation works differently for the two files. In the case of
<code>shapes</code>, the shape as described in the text file is converted to an <code>sf</code>
object. For <code>stop_times</code> the geometry is the result of linking subsequent
stops along a straight line (stops' coordinates are retrieved from the
<code>stops</code> file). Thus, the resolution of the geometry when generated with
<code>shapes</code> tends to be much higher than when created with <code>stop_times</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data_path &lt;- system.file("extdata/spo_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

trip_geometry &lt;- get_trip_geometry(gtfs)
head(trip_geometry)

# the above is identical to
trip_geometry &lt;- get_trip_geometry(gtfs, file = c("shapes", "stop_times"))
head(trip_geometry)

trip_ids &lt;- c("CPTM L07-0", "2002-10-0")
trip_geometry &lt;- get_trip_geometry(gtfs, trip_id = trip_ids)
trip_geometry
plot(trip_geometry["origin_file"])

</code></pre>


</div>