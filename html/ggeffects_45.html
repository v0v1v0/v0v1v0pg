<div class="container">

<table style="width: 100%;"><tr>
<td>residualize_over_grid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute partial residuals from a data grid</h2>

<h3>Description</h3>

<p>This function computes partial residuals based on a data grid,
where the data grid is usually a data frame from all combinations of factor
variables or certain values of numeric vectors. This data grid is usually used
as <code>newdata</code> argument in <code>predict()</code>, and can be created with
<code>new_data()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">residualize_over_grid(grid, model, ...)

## S3 method for class 'data.frame'
residualize_over_grid(grid, model, predictor_name, ...)

## S3 method for class 'ggeffects'
residualize_over_grid(grid, model, protect_names = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>A data frame representing the data grid, or an object of class
<code>ggeffects</code>, as returned by <code>predict_response()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model for which to compute partial residuals. The data grid
<code>grid</code> should match to predictors in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictor_name</code></td>
<td>
<p>The name of the focal predictor, for which partial residuals
are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protect_names</code></td>
<td>
<p>Logical, if <code>TRUE</code>, preserves column names from the
<code>ggeffects</code> objects that is used as <code>grid</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with residuals for the focal predictor.
</p>


<h3>Partial Residuals</h3>

<p>For <strong>generalized linear models</strong> (glms), residualized scores are
computed as <code>inv.link(link(Y) + r)</code> where <code>Y</code> are the predicted
values on the response scale, and <code>r</code> are the <em>working</em> residuals.
<br><br>
For (generalized) linear <strong>mixed models</strong>, the random effect are also
partialled out.
</p>


<h3>References</h3>

<p>Fox J, Weisberg S. Visualizing Fit and Lack of Fit in Complex Regression
Models with Predictor Effect Plots and Partial Residuals. Journal of Statistical
Software 2018;87.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ggeffects)
set.seed(1234)
x &lt;- rnorm(200)
z &lt;- rnorm(200)
# quadratic relationship
y &lt;- 2 * x + x^2 + 4 * z + rnorm(200)

d &lt;- data.frame(x, y, z)
model &lt;- lm(y ~ x + z, data = d)

pr &lt;- predict_response(model, c("x [all]", "z"))
head(residualize_over_grid(pr, model))
</code></pre>


</div>