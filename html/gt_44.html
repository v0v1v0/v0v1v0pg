<div class="container">

<table style="width: 100%;"><tr>
<td>cols_units</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Define units for one or more columns</h2>

<h3>Description</h3>

<p>Column labels can sometimes contain measurement units, and these might range
from easy to define and typeset (e.g., <code>"m/s"</code>) to very difficult. Such
difficulty can arise from the need to include subscripts or superscripts,
non-ASCII symbols, etc. The <code>cols_units()</code> function tries to make this task
easier by letting you apply text pertaining to units to various columns. This
takes advantage of <strong>gt</strong>'s specialized units notation (e.g.,
<code>"J Hz^-1 mol^-1"</code> can be used to generate units for the
<em>molar Planck constant</em>). The notation here provides several conveniences for
defining units, letting you produce the correct formatting no matter what the
table output format might be (i.e., HTML, LaTeX, RTF, etc.). Details
pertaining to the units notation can be found in the section entitled
<em>How to use <strong>gt</strong>'s units notation</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cols_units(.data, ..., .list = list2(...), .units_pattern = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p><em>The gt table data object</em>
</p>
<p><code style="white-space: pre;">⁠obj:&lt;gt_tbl&gt;⁠</code> // <strong>required</strong>
</p>
<p>This is the <strong>gt</strong> table object that is commonly created through use of the
<code>gt()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><em>Column units definitions</em>
</p>
<p><code style="white-space: pre;">⁠&lt;multiple expressions&gt;⁠</code> // <strong>required</strong> (or, use <code>.list</code>)
</p>
<p>Expressions for the assignment of column units for the table columns in
<code>.data</code>. Two-sided formulas (e.g., <code style="white-space: pre;">⁠&lt;LHS&gt; ~ &lt;RHS&gt;⁠</code>) can be used, where the
left-hand side corresponds to selections of columns and the right-hand side
evaluates to single-length values for the units to apply. Column names
should be enclosed in <code>c()</code>. Select helpers like <code>starts_with()</code>,
<code>ends_with()</code>, <code>contains()</code>, <code>matches()</code>, and <code>everything()</code> can be used in
the LHS. Named arguments are also valid as input for simple mappings of
column name to the <strong>gt</strong> units syntax; they should be of the form
<code style="white-space: pre;">⁠&lt;column name&gt; = &lt;units text&gt;⁠</code>. Subsequent expressions that operate on the
columns assigned previously will result in overwriting column units
defintion values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.list</code></td>
<td>
<p><em>Alternative to <code>...</code></em>
</p>
<p><code style="white-space: pre;">⁠&lt;list of multiple expressions&gt;⁠</code> // <strong>required</strong> (or, use <code>...</code>)
</p>
<p>Allows for the use of a list as an input alternative to <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.units_pattern</code></td>
<td>
<p><em>Pattern to combine column labels and units</em>
</p>
<p><code style="white-space: pre;">⁠scalar&lt;character&gt;⁠</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>An optional pattern to be used for combining column labels with the defined
units. The default pattern is <code>"{1}, {2}"</code>, where <code>"{1}"</code> refers to the
column label text and <code>"{2}"</code> is the text related to the associated units.
This default can be modified through the <code>column_labels.units_pattern</code>
option found in <code>tab_options()</code>. Setting a value here will provide an
override to the <code>column_labels.units_pattern</code> default (only for the
resolved columns in the invocation of <code>cols_units()</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gt_tbl</code>.
</p>


<h3>How to use <strong>gt</strong>'s units notation</h3>

<p>The units notation involves a shorthand of writing units that feels familiar
and is fine-tuned for the task at hand. Each unit is treated as a separate
entity (parentheses and other symbols included) and the addition of subscript
text and exponents is flexible and relatively easy to formulate. This is all
best shown with examples:
</p>

<ul>
<li> <p><code>"m/s"</code> and <code>"m / s"</code> both render as <code>"m/s"</code>
</p>
</li>
<li> <p><code>"m s^-1"</code> will appear with the <code>"-1"</code> exponent intact
</p>
</li>
<li> <p><code>"m /s"</code> gives the same result, as <code>"/&lt;unit&gt;"</code> is equivalent to
<code>"&lt;unit&gt;^-1"</code>
</p>
</li>
<li> <p><code>"E_h"</code> will render an <code>"E"</code> with the <code>"h"</code> subscript
</p>
</li>
<li> <p><code>"t_i^2.5"</code> provides a <code>t</code> with an <code>"i"</code> subscript and a <code>"2.5"</code> exponent
</p>
</li>
<li> <p><code>"m[_0^2]"</code> will use overstriking to set both scripts vertically
</p>
</li>
<li> <p><code>"g/L %C6H12O6%"</code> uses a chemical formula (enclosed in a pair of <code>"%"</code>
characters) as a unit partial, and the formula will render correctly with
subscripted numbers
</p>
</li>
<li>
<p> Common units that are difficult to write using ASCII text may be implicitly
converted to the correct characters (e.g., the <code>"u"</code> in <code>"ug"</code>, <code>"um"</code>,
<code>"uL"</code>, and <code>"umol"</code> will be converted to the Greek <em>mu</em> symbol; <code>"degC"</code>
and <code>"degF"</code> will render a degree sign before the temperature unit)
</p>
</li>
<li>
<p> We can transform shorthand symbol/unit names enclosed in <code>":"</code> (e.g.,
<code>":angstrom:"</code>, <code>":ohm:"</code>, etc.) into proper symbols
</p>
</li>
<li>
<p> Greek letters can added by enclosing the letter name in <code>":"</code>; you can
use lowercase letters (e.g., <code>":beta:"</code>, <code>":sigma:"</code>, etc.) and uppercase
letters too (e.g., <code>":Alpha:"</code>, <code>":Zeta:"</code>, etc.)
</p>
</li>
<li>
<p> The components of a unit (unit name, subscript, and exponent) can be
fully or partially italicized/emboldened by surrounding text with <code>"*"</code> or
<code>"**"</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<p>Let's analyze some <code>pizzaplace</code> data with <strong>dplyr</strong> and then make a <strong>gt</strong>
table. Here we are separately defining new column labels with <code>cols_label()</code>
and then defining the units (to combine to those labels) through
<code>cols_units()</code>. The default pattern for combination is <code>"{1}, {2}"</code> which
is acceptable here.
</p>
<div class="sourceCode r"><pre>pizzaplace |&gt;
  dplyr::mutate(month = lubridate::month(date, label = TRUE, abbr = TRUE)) |&gt;
  dplyr::group_by(month) |&gt;
  dplyr::summarize(
    n_sold = dplyr::n(),
    rev = sum(price)
  ) |&gt;
  dplyr::mutate(chg = (rev - dplyr::lag(rev)) / dplyr::lag(rev)) |&gt;
  dplyr::mutate(month = as.character(month)) |&gt;
  gt(rowname_col = "month") |&gt;
  fmt_integer(columns = n_sold) |&gt;
  fmt_currency(columns = rev, use_subunits = FALSE) |&gt;
  fmt_percent(columns = chg) |&gt;
  sub_missing() |&gt;
  cols_label(
    n_sold = "Number of Pizzas Sold",
    rev = "Revenue Generated",
    chg = "Monthly Changes in Revenue"
  ) |&gt;
  cols_units(
    n_sold = "units month^-1",
    rev = "USD month^-1",
    chg = "% change *m*/*m*"
  ) |&gt;
  cols_width(
    stub() ~ px(40),
    everything() ~ px(200)
  )
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_cols_units_1.png" alt="This image of a table was generated from the first code example in the `cols_units()` help file." style="width:100%;"><p>The <code>sza</code> dataset has a wealth of information and here we'll generate
a smaller table that contains the average solar zenith angles at noon for
different months and at different northern latitudes. The column labels are
numbers representing the latitudes and it's convenient to apply units
of 'degrees north' to each of them with <code>cols_units()</code>. The extra thing we
wanted to do here was to ensure that the units are placed directly after
the column labels, and we do that with <code>.units_pattern = "{1}{2}"</code>. This
append the units (<code>"{2}"</code>) right to the column label (<code>"{1}"</code>).
</p>
<div class="sourceCode r"><pre>sza |&gt;
  dplyr::filter(tst == "1200") |&gt;
  dplyr::select(-tst) |&gt;
  dplyr::arrange(desc(latitude)) |&gt;
  tidyr::pivot_wider(
    names_from = latitude,
    values_from = sza
  ) |&gt;
  gt(rowname_col = "month") |&gt;
  cols_units(
    everything() ~ ":degree:N",
    .units_pattern = "{1}{2}"
  ) |&gt;
  tab_spanner(
    label = "Solar Zenith Angle",
    columns = everything()
  ) |&gt;
  text_transform(
    fn = toupper,
    locations = cells_stub()
  ) |&gt;
  tab_style(
    style = cell_text(align = "right"),
    locations = cells_stub()
  )
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_cols_units_2.png" alt="This image of a table was generated from the second code example in the `cols_units()` help file." style="width:100%;"><p>Taking a portion of the <code>towny</code> dataset, let's use spanners to describe
what's in the columns and use only measurement units for the column labels.
The columns labels that have to do with population and density information
will be replaced with units defined in <code>cols_units()</code>. We'll use a
<code>.units_pattern</code> value of <code>"{2}"</code>, which means that only the units will
be present (the <code>"{1}"</code>, representing the column label text, is omitted).
Spanners added through several invocations of <code>tab_spanner()</code> will declare
what the last four columns contain.
</p>
<div class="sourceCode r"><pre>towny |&gt;
  dplyr::select(
    name, land_area_km2,
    ends_with("2016"), ends_with("2021")
  ) |&gt;
  dplyr::slice_max(population_2021, n = 10) |&gt;
  gt(rowname_col = "name") |&gt;
  tab_stubhead(label = "City") |&gt;
  fmt_integer() |&gt;
  cols_label(
    land_area_km2 ~ "Area, {{km^2}}",
    starts_with("population") ~ "",
    starts_with("density") ~ ""
  ) |&gt;
  cols_units(
    starts_with("population") ~ "*ppl*",
    starts_with("density") ~ "*ppl* km^-2",
    .units_pattern = "{2}"
  ) |&gt;
  tab_spanner(
    label = "Population",
    columns = starts_with("population"),
    gather = FALSE
  ) |&gt;
  tab_spanner(
    label = "Density",
    columns = starts_with("density"),
    gather = FALSE
  ) |&gt;
  tab_spanner(
    label = "2016",
    columns = ends_with("2016"),
    gather = FALSE
  ) |&gt;
  tab_spanner(
    label = "2021",
    columns = ends_with("2021"),
    gather = FALSE
  ) |&gt;
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_column_labels(
      c(starts_with("population"), starts_with("density"))
    )
  ) |&gt;
  cols_width(everything() ~ px(120)) |&gt;
  opt_horizontal_padding(scale = 3)
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_cols_units_3.png" alt="This image of a table was generated from the third code example in the `cols_units()` help file." style="width:100%;"><h3>Function ID</h3>

<p>5-6
</p>


<h3>Function Introduced</h3>

<p><code>v0.10.0</code> (October 7, 2023)
</p>


<h3>See Also</h3>

<p>Other column modification functions: 
<code>cols_add()</code>,
<code>cols_align()</code>,
<code>cols_align_decimal()</code>,
<code>cols_hide()</code>,
<code>cols_label()</code>,
<code>cols_label_with()</code>,
<code>cols_merge()</code>,
<code>cols_merge_n_pct()</code>,
<code>cols_merge_range()</code>,
<code>cols_merge_uncert()</code>,
<code>cols_move()</code>,
<code>cols_move_to_end()</code>,
<code>cols_move_to_start()</code>,
<code>cols_nanoplot()</code>,
<code>cols_unhide()</code>,
<code>cols_width()</code>
</p>


</div>