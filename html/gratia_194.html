<div class="container">

<table style="width: 100%;"><tr>
<td>lp_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return the linear prediction matrix of a fitted GAM</h2>

<h3>Description</h3>

<p><code>lp_matrix()</code> is a wrapper to <code>predict(..., type = "lpmatrix")</code> for returning
the linear predictor matrix for the model training data (when <code>data = NULL</code>),
or user-specified data values supplied via <code>data</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lp_matrix(model, ...)

## S3 method for class 'gam'
lp_matrix(model, data = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to other methods and <code>predict</code> methods including
<code>mgcv::predict.gam()</code> and <code>mgcv::predict.bam()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame of values at which to return the linear prediction
matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The linear prediction matrix <code class="reqn">\mathbf{X}_p</code> is a matrix that maps values
of parameters <code class="reqn">\hat{\mathbf{\beta}}_p</code> to values on the linear
predictor of the model <code class="reqn">\hat{\eta}_p = \mathbf{X}_p
\hat{\mathbf{\beta}}_p</code>. <code class="reqn">\mathbf{X}_p</code> is the model matrix where spline
covariates have been replaced by the values of the basis functions evaluated
at the respective covariates. Parametric covariates are also included.
</p>


<h3>Value</h3>

<p>The linear prediction matrix is returned as a matrix. The object
returned is of class <code>"lp_matrix"</code>, which inherits from classes <code>"matrix"</code>
and <code>"array"</code>. The special class allows the printing of the matrix to be
controlled, which we do by printing the matrix as a tibble.
</p>


<h3>Examples</h3>

<pre><code class="language-R">load_mgcv()

df &lt;- data_sim("eg1", seed = 1)
m &lt;- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = df)

# linear prediction matrix for observed data
xp &lt;- lp_matrix(m)
## IGNORE_RDIFF_BEGIN
xp
## IGNORE_RDIFF_END

# the object `xp` *is* a matrix
class(xp)
# but we print like a tibble to avoid spamming the R console

# linear predictor matrix for new data set
ds &lt;- data_slice(m, x2 = evenly(x2))
xp &lt;- lp_matrix(m, data = ds)
## IGNORE_RDIFF_BEGIN
xp
## IGNORE_RDIFF_END

</code></pre>


</div>