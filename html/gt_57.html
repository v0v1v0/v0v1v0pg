<div class="container">

<table style="width: 100%;"><tr>
<td>extract_body</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract the table body from a <strong>gt</strong> object</h2>

<h3>Description</h3>

<p>We can extract the body of a <strong>gt</strong> table, even at various stages of its
rendering, from a <code>gt_tbl</code> object using <code>extract_body()</code>. By default, the
data frame returned will have gone through all of the build stages but we
can intercept the table body after a certain build stage. Here are the eight
different build stages and some notes about each:
</p>

<ol>
<li> <p><code>"init"</code>: the body table is initialized here, entirely with <code>NA</code> values.
It's important to note that all columns of the are of the <code>character</code> type in
this first stage. And all columns remain in the same order as the input data
table.
</p>
</li>
<li> <p><code>"fmt_applied"</code>: Any cell values that have had formatting applied to them
are migrated to the body table. All other cells remain as <code>NA</code> values.
Depending on the <code>output</code> type, the formatting may also be different.
</p>
</li>
<li> <p><code>"sub_applied"</code>: Any cell values that have had substitution functions
applied to them (whether or not they were previously formatted) are migrated
to the body table or modified in place (if formatted). All cells that had
neither been formatted nor undergone substitution remain as <code>NA</code> values.
</p>
</li>
<li> <p><code>"unfmt_included"</code>: All cells that either didn't have any formatting or
any substitution operations applied are migrated to the body table. <code>NA</code>
values now become the string <code>"NA"</code>, so, there aren't any true missing values
in this body table.
</p>
</li>
<li> <p><code>"cols_merged"</code>: The result of column-merging operations (through
<code>cols_merge()</code> and related functions) is materialized here. Columns that were
asked to be hidden will be present here (i.e., hiding columns doesn't remove
them from the body table).
</p>
</li>
<li> <p><code>"body_reassembled"</code>: Though columns do not move positions rows can move
to different positions, and this is usually due to migration to different row
groups. At this stage, rows will be in the finalized order that is seen in
the associated display table.
</p>
</li>
<li> <p><code>"text_transformed"</code>: Various <code style="white-space: pre;">⁠text_*()⁠</code> functions in <strong>gt</strong> can operate
on body cells (now fully formatted at this stage) and return transformed
character values. After this stage, the effects of those functions are
apparent.
</p>
</li>
<li> <p><code>"footnotes_attached"</code>: Footnote marks are attached to body cell values
(either on the left or right of the content). This stage performs said
attachment.
</p>
</li>
</ol>
<h3>Usage</h3>

<pre><code class="language-R">extract_body(
  data,
  build_stage = NULL,
  incl_hidden_cols = FALSE,
  incl_stub_cols = TRUE,
  ...,
  output = c("html", "latex", "rtf", "word", "grid")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><em>The gt table data object</em>
</p>
<p><code style="white-space: pre;">⁠obj:&lt;gt_tbl&gt;⁠</code> // <strong>required</strong>
</p>
<p>This is the <strong>gt</strong> table object that is commonly created through use of the
<code>gt()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>build_stage</code></td>
<td>
<p><em>The build stage of the formatted R data frame</em>
</p>
<p><code style="white-space: pre;">⁠scalar&lt;character&gt;⁠</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>When a <strong>gt</strong> undergoes rendering, the body of the table proceeds through
several build stages. Providing a single stage name will yield a data frame
that has been extracted after completed that stage. Here are the build
stages in order: (1) <code>"init"</code>, (2) <code>"fmt_applied"</code>, (3) <code>"sub_applied"</code>,
(4) <code>"unfmt_included"</code>, (5) <code>"cols_merged"</code>, (6) <code>"body_reassembled"</code>, (7)
<code>"text_transformed"</code>, and (8) <code>"footnotes_attached"</code>. If not supplying a
value for <code>build_stage</code> then the entire build for the table body (i.e., up
to and including the <code>"footnotes_attached"</code> stage) will be performed before
returning the data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incl_hidden_cols</code></td>
<td>
<p><em>Should hidden columns be included?</em>
</p>
<p><code style="white-space: pre;">⁠scalar&lt;logical&gt;⁠</code> // <em>default:</em> <code>FALSE</code>
</p>
<p>Certain columns may be hidden from final display via <code>cols_hide()</code>. By
default, those columns won't be part of the extracted data frame. However,
we can choose to include them by using <code>incl_hidden_cols = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incl_stub_cols</code></td>
<td>
<p><em>Should stub columns be included?</em>
</p>
<p><code style="white-space: pre;">⁠scalar&lt;logical&gt;⁠</code> // <em>default:</em> <code>TRUE</code>
</p>
<p>Any stub columns in the <strong>gt</strong> object (which may consist of a grouping
column and a column for row labels) are included in the extracted data for
clarity but clearly marked with the names <code>"::group_id::"</code> and
<code>"::rowname::"</code>. We can exclude them by setting <code>incl_stub_cols = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>These dots are for future extensions and must be empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p><em>Output format</em>
</p>
<p><code style="white-space: pre;">⁠singl-kw:[html|latex|rtf|word]⁠</code> // <em>default:</em> <code>"html"</code>
</p>
<p>The output format of the resulting data frame. This can either be
<code>"html"</code> (the default), <code>"latex"</code>, <code>"rtf"</code>, or <code>"word"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame or tibble object containing the table body.
</p>


<h3>Examples</h3>

<p>Use a modified version of <code>sp500</code> the dataset to create a <strong>gt</strong> table with
row groups and row labels. Formatting will be applied to the date- and
currency-based columns.
</p>
<div class="sourceCode r"><pre>gt_tbl &lt;-
  sp500 |&gt;
  dplyr::filter(date &gt;= "2015-01-05" &amp; date &lt;= "2015-01-16") |&gt;
  dplyr::arrange(date) |&gt;
  dplyr::mutate(week = paste0("W", strftime(date, format = "%V"))) |&gt;
  dplyr::select(-adj_close, -volume) |&gt;
  gt(
    rowname_col = "date",
    groupname_col = "week"
  ) |&gt;
  fmt_date(columns = date, date_style = "day_month_year") |&gt;
  fmt_currency(columns = c(open, high, low, close)) |&gt;
  cols_hide(columns = c(high, low))

</pre></div>
<div class="sourceCode r"><pre>gt_tbl
</pre></div>

<img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_extract_body_1.png" alt="This image of a table was generated from the first code example in the `extract_body()` help file." style="width:100%;"><p>Using <code>extract_body()</code> on the <strong>gt</strong> object (<code>gt_tbl</code>) will provide us with
a tibble that contains the fully built data cells for the <code>output</code> context
(in this case, <code>"html"</code>).
</p>
<div class="sourceCode r"><pre>extract_body(gt_tbl)
#&gt; # A tibble: 10 x 4
#&gt;    `::group_id::` `::rowname::`   open      close    
#&gt;    &lt;chr&gt;          &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;    
#&gt;  1 W02            5 January 2015  $2,054.44 $2,020.58
#&gt;  2 W02            6 January 2015  $2,022.15 $2,002.61
#&gt;  3 W02            7 January 2015  $2,005.55 $2,025.90
#&gt;  4 W02            8 January 2015  $2,030.61 $2,062.14
#&gt;  5 W02            9 January 2015  $2,063.45 $2,044.81
#&gt;  6 W03            12 January 2015 $2,046.13 $2,028.26
#&gt;  7 W03            13 January 2015 $2,031.58 $2,023.03
#&gt;  8 W03            14 January 2015 $2,018.40 $2,011.27
#&gt;  9 W03            15 January 2015 $2,013.75 $1,992.67
#&gt; 10 W03            16 January 2015 $1,992.25 $2,019.42
</pre></div>
<p>To provide us with a better frame of reference, the grouping and row label
values are provided as the first columns in the returned output. We could
suppress those in the output by setting <code>incl_stub_cols = FALSE</code>.
</p>
<div class="sourceCode r"><pre>extract_body(gt_tbl, incl_stub_cols = FALSE)
#&gt; # A tibble: 10 x 2
#&gt;    open      close    
#&gt;    &lt;chr&gt;     &lt;chr&gt;    
#&gt;  1 $2,054.44 $2,020.58
#&gt;  2 $2,022.15 $2,002.61
#&gt;  3 $2,005.55 $2,025.90
#&gt;  4 $2,030.61 $2,062.14
#&gt;  5 $2,063.45 $2,044.81
#&gt;  6 $2,046.13 $2,028.26
#&gt;  7 $2,031.58 $2,023.03
#&gt;  8 $2,018.40 $2,011.27
#&gt;  9 $2,013.75 $1,992.67
#&gt; 10 $1,992.25 $2,019.42
</pre></div>
<p>The <code>high</code> and <code>low</code> columns were hidden via <code>cols_hide()</code> and so they
won't be shown in the returned data unless we use <code>incl_hidden_cols = TRUE</code>.
</p>
<div class="sourceCode r"><pre>extract_body(
  gt_tbl,
  incl_stub_cols = FALSE,
  incl_hidden_cols = TRUE
)
#&gt; # A tibble: 10 x 4
#&gt;    open      high      low       close    
#&gt;    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    
#&gt;  1 $2,054.44 $2,054.44 $2,017.34 $2,020.58
#&gt;  2 $2,022.15 $2,030.25 $1,992.44 $2,002.61
#&gt;  3 $2,005.55 $2,029.61 $2,005.55 $2,025.90
#&gt;  4 $2,030.61 $2,064.08 $2,030.61 $2,062.14
#&gt;  5 $2,063.45 $2,064.43 $2,038.33 $2,044.81
#&gt;  6 $2,046.13 $2,049.30 $2,022.58 $2,028.26
#&gt;  7 $2,031.58 $2,056.93 $2,008.25 $2,023.03
#&gt;  8 $2,018.40 $2,018.40 $1,988.44 $2,011.27
#&gt;  9 $2,013.75 $2,021.35 $1,991.47 $1,992.67
#&gt; 10 $1,992.25 $2,020.46 $1,988.12 $2,019.42
</pre></div>


<h3>Function ID</h3>

<p>13-7
</p>


<h3>Function Introduced</h3>

<p><code>v0.10.0</code> (October 7, 2023)
</p>


<h3>See Also</h3>

<p>Other table export functions: 
<code>as_gtable()</code>,
<code>as_latex()</code>,
<code>as_raw_html()</code>,
<code>as_rtf()</code>,
<code>as_word()</code>,
<code>extract_cells()</code>,
<code>extract_summary()</code>,
<code>gtsave()</code>
</p>


</div>