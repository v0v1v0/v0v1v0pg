<div class="container">

<table style="width: 100%;"><tr>
<td>fitted_terms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting fitted additive terms</h2>

<h3>Description</h3>

<p>The function <code>fitted_terms()</code> is doing what the function <code>term.plot()</code> is doing for GAMLSS models but it uses <code>ggplot2</code> package. 
The function <code>pe_terms()</code> is synonymous to  <code>fitted_terms()</code> in the package <span class="pkg">gamlss</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitted_terms(object, 
          what = c("mu", "sigma", "nu", "tau"), 
          parameter = NULL, data = NULL, terms = NULL,
          envir = environment(formula(object)), 
          partial = FALSE, rug = FALSE, rug.sides = "b", 
          rug.col = "gray",  alpha = 0.2, 
          ylim = c("common", "free"), xlabs = NULL, 
          ylabs = NULL, main = NULL, term.col = "darkred", 
          resid.col = "lightblue", resid.alpha = 0.8, 
          resid.size = 1, nrow = NULL, ncol = NULL, 
          plots.per.page = 9, one.by.one = FALSE, 
          surface.gam = FALSE, polys = NULL, 
          polys.scheme = "topo", col.ribbon = "darksalmon",
          col.shaded = "gray", ...)

pe_terms(object, 
          what = c("mu", "sigma", "nu", "tau"), 
          parameter = NULL, data = NULL, terms = NULL,
          envir = environment(formula(object)), 
          partial = FALSE, rug = FALSE, rug.sides = "b", 
          rug.col = "gray",  alpha = 0.2, 
          ylim = c("common", "free"), xlabs = NULL, 
          ylabs = NULL, main = NULL, term.col = "darkred", 
          resid.col = "lightblue", resid.alpha = 0.8, 
          resid.size = 1, nrow = NULL, ncol = NULL, 
          plots.per.page = 9, one.by.one = FALSE, 
          surface.gam = FALSE, polys = NULL, 
          polys.scheme = "topo", col.ribbon = "darksalmon",
          col.shaded = "gray", ...)          
          
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a gamlss fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>which distribution parameters, i.e. "mu"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>which distribution parameters (equivalent to <code>what</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame in which variables in <code>object</code> can be found</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>which terms to plot (default NULL means all terms); a vector passed to lpred(..., type = "terms", terms =*)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>environment in which variables in <code>object</code> can be found</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>logical; should partial residuals be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>add rug plots to the axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug.sides</code></td>
<td>
<p>which side the rug "b"=bottom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug.col</code></td>
<td>
<p>the colour for the rug</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the alpha for the shade</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>there are two options here a) "common" and b) "free". The "common"" option plots all figures with the same ylim range and therefore allows the viewer to check the relative contribution of each terms compate to the rest. In the ‘free’ option the limits are computed for each plot seperatly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabs</code></td>
<td>
<p>the x label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabs</code></td>
<td>
<p>the y label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title NOT WORKING</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>term.col</code></td>
<td>
<p>the colour of the line for term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.col</code></td>
<td>
<p>the colour of the partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.alpha</code></td>
<td>
<p>The alpha for the partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.size</code></td>
<td>
<p>the size of the partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>
<p>the number or rows in a mupliple plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>the number of rows in a mupliple plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots.per.page</code></td>
<td>
<p>the number of plots per page in multiple plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one.by.one</code></td>
<td>
<p>whether to plot the terms one by one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surface.gam</code></td>
<td>
<p>whether to use surface plot if a ga() term is fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polys</code></td>
<td>
<p>for GRMF models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polys.scheme</code></td>
<td>
<p>The polygone information file for MRF models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ribbon</code></td>
<td>
<p>he colour of the ribbon</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.shaded</code></td>
<td>
<p>he colour of the shaded area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra argument</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A multiple plot</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code>term.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(aids)
a &lt;- gamlss(y ~ pb(x) + qrt, data = aids, family = NBI)
fitted_terms(a, pages = 1)
</code></pre>


</div>