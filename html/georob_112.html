<div class="container">

<table style="width: 100%;"><tr>
<td>sample.variogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing (Robust) Sample Variograms of Spatial Data</h2>

<h3>Description</h3>

<p>The function <code>sample.variogram</code> computes the
sample (empirical) variogram of a spatial variable by the method-of-moment
and three robust estimators.  Both omnidirectional and direction-dependent
variograms can be computed, the latter for observation locations in a
three-dimensional domain.  There are <code>summary</code> and <code>plot</code>
methods for summarizing and displaying sample variograms.</p>


<h3>Usage</h3>

<pre><code class="language-R">
sample.variogram(object, ...)

## Default S3 method:
sample.variogram(object, locations, lag.dist.def,
    xy.angle.def = c(0, 180), xz.angle.def = c(0, 180), max.lag = Inf,
    estimator = c("qn", "mad", "matheron", "ch"), mean.angle = TRUE, ...)

## S3 method for class 'formula'
sample.variogram(object, data, subset, na.action,
    locations, lag.dist.def, xy.angle.def = c(0, 180),
    xz.angle.def = c(0, 180), max.lag = Inf,
    estimator = c("qn", "mad", "matheron", "ch"), mean.angle = TRUE, ...)

## S3 method for class 'georob'
sample.variogram(object, lag.dist.def,
    xy.angle.def = c(0, 180), xz.angle.def = c(0, 180), max.lag = Inf,
    estimator = c("qn", "mad", "matheron", "ch"), mean.angle = TRUE, ...)

## S3 method for class 'sample.variogram'
summary(object, ...)

## S3 method for class 'sample.variogram'
plot(x, type = "p", add = FALSE,
    xlim = c(0, max(x[["lag.dist"]])),
    ylim = c(0, 1.1 * max(x[["gamma"]])), col, pch, lty, cex = 0.8,
    xlab = "lag distance", ylab = "semivariance",
    annotate.npairs = FALSE, npairs.pos = 3, npairs.cex = 0.7,
    legend = nlevels(x[["xy.angle"]]) &gt; 1 || nlevels(x[["xz.angle"]]) &gt; 1,
    legend.pos = "topleft", ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a numeric vector with the values of the response for which
the sample variogram should be computed
(<code>sample.variogram.default</code>), a formula, specifying in its left part
the response variable (right part of formula is ignored,
<code>sample.variogram.formula</code>), an object of class <code>georob</code><br>
(<code>sample.variogram.georob</code>) or an object of class<br><code>sample.variogram</code> (<code>summary.sample.variogram</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>
<p>a numeric matrix with the coordinates of the locations
where the response was observed (<code>sample.variogram.default</code>) or a
one-sided formula specifying the coordinates
(<code>sample.variogram.formula</code>).  The matrix may have an arbitrary
number of columns for an omnidirectional variogram, but at most 3 columns
if a directional variogram is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or another
object coercible by<br><code>as.data.frame</code> to a data frame)
containing the response variable and the coordinates where the data
was recorded.  If not found in <code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>sample.variogram</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for estimating the variogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the
data contain <code>NA</code>s.  The default is set by the <code>na.action</code>
argument of <code>options</code>, and is <code>na.fail</code> if that is
unset.  The “factory-fresh” default is <code>na.omit</code>.
Another possible value is <code>NULL</code>, no action.  Value
<code>na.exclude</code> can be useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.dist.def</code></td>
<td>
<p>a numeric scalar defining a constant bin
width for grouping the lag distances or a numeric vector with the bounds
of a set of contiguous bins (upper bounds of bins except for the first
element of <code>lag.dist.def</code> which is the lower bound of the first
bin). This argument is mandatory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy.angle.def</code></td>
<td>
<p>an numeric vector defining angular classes
in the horizontal plane for computing directional variograms.
<code>xy.angle.def</code> must contain an ascending sequence of azimuth angles
in degrees from north (positive clockwise to south), see <em>Details</em>.
Omnidirectional variograms are computed with the default
<code>c(0,180)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xz.angle.def</code></td>
<td>
<p>an numeric vector defining angular classes
in the <code class="reqn">x</code>-<code class="reqn">z</code>-plane for computing directional variograms.
<code>xz.angle.def</code> must contain an ascending sequence of angles in
degrees from zenith (positive clockwise to nadir), see
<em>Details</em>.  Omnidirectional variograms are computed with the default
<code>c(0,180)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.lag</code></td>
<td>
<p>a positive numeric defining the largest lag distance for
which semi variances should be computed (default no restriction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>a character keyword defining the estimator for computing
the sample variogram.  Possible values are:
</p>

<ul>
<li> <p><code>"qn"</code>: Genton's robust
<code>Qn</code>-estimator (default, <cite>Genton, 1998</cite>),
</p>
</li>
<li> <p><code>"mad"</code>: Dowd's robust MAD-estimator (<cite>Dowd, 1984</cite>),
</p>
</li>
<li> <p><code>"matheron"</code>: non-robust method-of-moments estimator,
</p>
</li>
<li> <p><code>"ch"</code>: robust Cressie-Hawkins estimator (<cite>Cressie and
Hawkins, 1980</cite>).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.angle</code></td>
<td>
<p>a logical scalar controlling whether the mean lag vector (per
combination of lag distance and angular class) is computed from the mean
angles of all the lag vectors falling into a given class (<code>TRUE</code>,
default) or from the mid-angles of the respective angular classes
(<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>sample.variogram</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type, xlim, ylim, xlab, ylab</code></td>
<td>
<p>see respective arguments of
<code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>a logical scalar controlling whether a new plot should be
generated (<code>FALSE</code>, default) or whether the information should be
added to the current plot (<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector with the colours of plotting symbols for distinguishing semi variances
for angular classes in the <code class="reqn">x</code>-<code class="reqn">y</code>-plane.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>a vector with the types of plotting symbols for distinguishing
semi variances for angular classes in the <code class="reqn">x</code>-<code class="reqn">z</code>-plane.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>the line type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>a numeric with the character expansion factor for plotting
symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotate.npairs</code></td>
<td>
<p>a logical scalar controlling whether the plotting symbols
should be annotated by the number of data pairs per lag class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npairs.pos</code></td>
<td>
<p>an integer defining the position where text annotation
about number of pairs should be plotted, see
<code>text</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npairs.cex</code></td>
<td>
<p>a numeric defining the character expansion for text
annotation about number of pairs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>a logical scalar controlling whether a
<code>legend</code> should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pos</code></td>
<td>
<p>a character keyword defining where to place the
legend, see <code>legend</code> for possible values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to
<code>plot.formula</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The angular classes in the <code class="reqn">x</code>-<code class="reqn">y</code>- and <code class="reqn">x</code>-<code class="reqn">z</code>-plane are
defined by vectors of ascending angles on the half circle.  The <code class="reqn">i</code>th
angular class is defined by the vector elements, say <var>l</var> and <var>u</var>,
with indices <code class="reqn">i</code> and <code class="reqn">i+1</code>.  A lag vector belongs to the
<code class="reqn">i</code>th angular class if its azimuth (or angle from zenith), say
<code class="reqn">\varphi</code>, satisfies <code class="reqn"> l &lt; \varphi \leq u</code>.
If the first and the last element of <code>xy.angle.def</code> or
<code>xz.angle.def</code> are equal to <code>0</code> and <code>180</code> degrees,
respectively, then the first and the last angular class are
“joined”, i.e., if there are <code class="reqn">K</code> angles, there will be only
<code class="reqn">K-2</code> angular classes and the first class is defined by the interval
( <var>xy.angle.def</var>[<var>K</var>-1]-180, <var>xy.angle.def</var>[2] ] and the last
class by ( <var>xy.angle.def</var>[<var>K</var>-2], <var>xy.angle.def</var>[<var>K</var>-1]].
</p>


<h3>Value</h3>

<p>All methods of the generic function <code>sample.variogram</code>
return an object of class  <code>sample.variogram</code>, which
is a data frame with the following components:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>lag.dist</code> </td>
<td style="text-align: left;"> the mean lag distance of the lag class, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>xy.angle</code> </td>
<td style="text-align: left;"> the angular class in the <code class="reqn">x</code>-<code class="reqn">y</code>-plane, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>xz.angle</code> </td>
<td style="text-align: left;"> the angular class in the <code class="reqn">x</code>-<code class="reqn">z</code>-plane, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>gamma</code> </td>
<td style="text-align: left;"> the estimated semi-variance of the lag class, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>npairs</code> </td>
<td style="text-align: left;"> the number of data pairs in the lag class, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>lag.x</code> </td>
<td style="text-align: left;"> the <code class="reqn">x</code>-component of the mean lag vector of the lag class, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>lag.x</code> </td>
<td style="text-align: left;"> the <code class="reqn">y</code>-component of the mean lag vector of the lag class, </td>
</tr>
<tr>
<td style="text-align: left;">
    <code>lag.z</code> </td>
<td style="text-align: left;"> the <code class="reqn">z</code>-component of the mean lag vector of the lag class.</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>The method <code>summary.sample.variogram</code> returns an object of class
<code>summary.sample.variogram</code> which is list with the components
<code>log.dist</code>, <code>npairs</code>, <code>xy.angle</code> and <code>xz.angle</code>, see
description for object of class <code>sample.variogram</code> above.  There is a
<code>print</code> method for objects of class <code>summary.sample.variogram</code>
which invisibly returns the object unchanged.
</p>
<p>The method <code>plot.sample.variogram</code> is called for its side effects and
invisibly returns the object <code>sample.variogram</code> unchanged.
</p>


<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>References</h3>

<p>Cressie, N. and Hawkins, D. M. (1980) Robust Estimation of the Variogram:
I. <em>Mathematical Geology</em>, <b>12</b>, 115–125,
<a href="https://doi.org/10.1007/BF01035243">doi:10.1007/BF01035243</a>.
</p>
<p>Dowd, P. A. (1984) The variogram and Kriging: Robust and resistant
estimators.  In <em>Geostatistics for Natural Resources
Characterization</em>, Verly, G., David, M., Journel, A. and Marechal, A.
(Eds.)  Dordrecht: D. Reidel Publishing Company, Part I, 1, 91–106,
<a href="https://doi.org/10.1007/978-94-009-3699-7">doi:10.1007/978-94-009-3699-7</a>.
</p>
<p>Genton, M. (1998) Highly Robust Variogram Estimation.  <em>Mathematical
Geology</em>, <b>30</b>, 213–220, <a href="https://doi.org/10.1023/A%3A1021728614555">doi:10.1023/A:1021728614555</a>.
</p>


<h3>See Also</h3>

<p><code>georobPackage</code> for a description of the model and a brief summary of the algorithms;
</p>
<p><code>georob</code> for (robust) fitting of spatial linear models;
</p>
<p><code>georobObject</code> for a description of the class <code>georob</code>;
</p>
<p><code>profilelogLik</code> for computing profiles of Gaussian likelihoods;
</p>
<p><code>plot.georob</code> for display of RE(ML) variogram estimates;
</p>
<p><code>control.georob</code> for controlling the behaviour of <code>georob</code>;
</p>
<p><code>georobModelBuilding</code> for stepwise building models of class <code>georob</code>;
</p>
<p><code>cv.georob</code> for assessing the goodness of a fit by <code>georob</code>;
</p>
<p><code>georobMethods</code> for further methods for the class <code>georob</code>;
</p>
<p><code>predict.georob</code> for computing robust Kriging predictions;
</p>

<p><code>lgnpp</code> for unbiased back-transformation of Kriging prediction
of log-transformed data;
</p>
<p><code>georobSimulation</code> for simulating realizations of a Gaussian process
from model fitted by <code>georob</code>.
</p>





<h3>Examples</h3>

<pre><code class="language-R">data(wolfcamp)

## omnidirectional sample variogram
r.sv.iso &lt;- sample.variogram(pressure~1, data = wolfcamp,
    locations = ~x + y, lag.dist.def = seq(0, 200, by = 15))

plot(r.sv.iso, type = "l")

## direction-dependent sample variogram
r.sv.aniso &lt;- sample.variogram(pressure~1, data = wolfcamp,
    locations = ~x + y, lag.dist.def = seq(0, 200, by = 15),
    xy.angle.def = c(0., 22.5, 67.5, 112.5, 157.5, 180.))
plot(r.sv.aniso, type = "l", add = TRUE, col = 2:5)
</code></pre>


</div>