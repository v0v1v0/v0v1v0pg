<div class="container">

<table style="width: 100%;"><tr>
<td>gwqs.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Grouped WQS Regression</h2>

<h3>Description</h3>

<p>This function fits a grouped weighted quantile sum (GWQS) regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gwqs.fit(
  y,
  y.train = NULL,
  x,
  x.train = NULL,
  z = NULL,
  z.train = NULL,
  x.s,
  B = 100,
  n.quantiles = 4,
  pars = NULL,
  func,
  ineqLB = NULL,
  ineqUB = NULL,
  tol = 1e-06,
  delta = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector containing outcomes for validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.train</code></td>
<td>
<p>A vector containing outcomes for training. If left as NULL the validation data will be used for training as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of component data for validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.train</code></td>
<td>
<p>A matrix of component data for training. If left as NULL the validation data will be used for training as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector or matrix of covariates for validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.train</code></td>
<td>
<p>A vector or matrix of covariates for training. If left as NULL the validation data will be used for training as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.s</code></td>
<td>
<p>A vector of the number of components in each index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of bootstrap samples, must be 1 or more.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.quantiles</code></td>
<td>
<p>The number of quantiles to apply to data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>A vector of initial values, listed in order: beta naught intercept and group index beta coefficients, individual chemical weight coefficients, and covariate coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>The objective function to be used (must match outcome data type); currently only fun args "continuous" or "binary" are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ineqLB</code></td>
<td>
<p>Vector of lower bounds for betas and weights, set to -2 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ineqUB</code></td>
<td>
<p>Vector of upper bounds for betas and weights, set to 2 be default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance level for bootstrap convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Step size for bootstrap procedure.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of 3 containing the GWQS estimate based on calculated weights, the GWQS model fit to validation data, and weight estimates
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("WQSdata")
group_list &lt;- list(c("X1", "X2", "X3"), c("X4", "X7"), c("X5", "X6", "X9", "X8"))
x.s &lt;- make.x.s(WQSdata, 3, group_list)
X &lt;- make.X(WQSdata, 3, group_list)
Y &lt;- WQSdata$y
results &lt;- gwqs.fit(y = Y, x = X, x.s = x.s, B=1, func = "continuous")

</code></pre>


</div>