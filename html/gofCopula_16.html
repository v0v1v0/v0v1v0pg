<div class="container">

<table style="width: 100%;"><tr>
<td>gofKendallKS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>gof test (Kolmogorov-Smirnov) based on Kendall's process</h2>

<h3>Description</h3>

<p><code>gofKendallKS</code> tests a given dataset for a copula based on
Kendall's process with the Kolmogorov-Smirnov test statistic. The margins
can be estimated by a bunch of distributions and the time which is necessary
for the estimation can be given. The possible copulae are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>. See for
reference Genest et al. (2009). The parameter estimation is performed with
pseudo maximum likelihood method. In case the estimation fails, inversion of
Kendall's tau is used. The approximate p-values are computed with a
parametric bootstrap, which computation can be accelerated by enabling
in-build parallel computation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofKendallKS(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "huslerReiss", "tawn", "tev", "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are "ex" for exchangeable and "un" for unstructured, see package
<code>copula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With the pseudo observations <code class="reqn">U_{ij}</code> for <code class="reqn">i = 1, \dots,n</code>, <code class="reqn">j = 1, \dots,d</code> and <code class="reqn">\mathbf{u} \in
[0,1]^d</code> is the empirical copula given by <code class="reqn">C_n(\mathbf{u})
= \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(U_{i1} \leq u_1, \dots, U_{id} \leq
u_d).</code> Let the
rescaled pseudo observations be <code class="reqn">V_1 = C_n(U_1), \dots, V_n =
C_n(U_n)</code> and the distribution
function of <code class="reqn">V</code> shall be <code class="reqn">K</code>. The estimated version is given by
</p>
<p style="text-align: center;"><code class="reqn">K_n(v) = \frac{1}{n} \sum_{i=1}^n \mathbf{I}(V_i \leq v)</code>
</p>
<p> with <code class="reqn">v \in [0,1]^d.</code>
The testable <code class="reqn">H_0^{'}</code> hypothesis is then </p>
<p style="text-align: center;"><code class="reqn">K \in
\mathcal{K}_0 = \{K_{\theta} : \theta \in \Theta \}</code>
</p>
<p> with <code class="reqn">\Theta</code> being an open subset of
<code class="reqn">R^p</code> for an integer <code class="reqn">p \geq 1</code>, see Genest et al.
(2009). The resulting Kolmogorov-Smirnof test statistic is then given by
</p>
<p style="text-align: center;"><code class="reqn">T = \sqrt{n} \sup_{v \in [0,1]} |K_n(v) - K_{\theta_n}| .</code>
</p>

<p>Because <code class="reqn">H_0^{'}</code> consists of more distributions than the
<code class="reqn">H_0</code> is the test not necessarily consistent.
</p>
<p>The approximate p-value is computed by the formula
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br><br> Christian
Genest, Jean-Francois Quessy, Bruno Remillard (2006). Goodness-of-fit
Procedures for Copula Models Based on the Probability Integral
Transformation. <em>Scandinavian Journal of Statistics, Volume 33, Issue
2, 2006, Pages 337-366</em>.
doi: <a href="https://doi.org/10.1111/j.1467-9469.2006.00470.x">10.1111/j.1467-9469.2006.00470.x</a><br><br> Ulf
Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler
(2015). VineCopula: Statistical Inference of Vine Copulas. <em>R package
version 1.4.</em>. <a href="https://cran.r-project.org/package=VineCopula">https://cran.r-project.org/package=VineCopula</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(IndexReturns2D)

gofKendallKS("normal", IndexReturns2D, M = 10)

</code></pre>


</div>