<div class="container">

<table style="width: 100%;"><tr>
<td>RobSBoosting</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust semiparametric gene-environment interaction analysis using sparse boosting</h2>

<h3>Description</h3>

<p>Robust semiparametric gene-environment interaction analysis using sparse boosting. Here a
semiparametric model is assumed to accommodate nonlinear effects, where we model continuous
environmental (E) factors in a nonlinear way, and discrete E factors and all genetic (G)
factors in a linear way. For estimating the nonlinear functions, the B spline expansion is
adopted. The Huber loss function and Qn estimator are adopted to accommodate long-tailed
distribution/data contamination. For model estimation and selection of relevant variables, we
adopt an effective sparse boosting approach, where the strong hierarchy is respected.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RobSBoosting(
  G,
  E,
  Y,
  loop_time,
  num.knots = NULL,
  Boundary.knots = NULL,
  degree = 1,
  v = 0.1,
  family = c("continuous", "survival"),
  knots = NULL,
  E_type
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Input matrix of <code>p</code> genetic measurements consisting of <code>n</code> rows. Each row
is an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Input matrix of <code>q</code> environmental risk factors, each row is an observation
vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response variable. A quantitative vector for <code>family="continuous"</code>. For
<code>family="survival"</code>, <code>Y</code> should be a two-column matrix with the first column being
the log(survival time) and the second column being the censoring indicator. The indicator is a
binary variable, with "1" indicating dead, and "0" indicating right censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loop_time</code></td>
<td>
<p>Number of iterations of the sparse boosting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.knots</code></td>
<td>
<p>Numbers of knots for the B spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boundary.knots</code></td>
<td>
<p>The boundary of knots for the B spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>Degree for the B spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>The step size used in the sparse boosting process. Default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Response type of <code>Y</code> (see above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>List of knots for the B spline basis. Default is NULL and knots can be generated
with the given <code>num.knots</code>, <code>degree</code> and <code>Boundary.knots</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E_type</code></td>
<td>
<p>A vector indicating the type of each E factor, with "ED" representing discrete E factor, and "EC" representing continuous E factor.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with S3 class <code>"RobSBoosting"</code> is returned, which is a list with the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call that produced this object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_t</code></td>
<td>
<p>The stopping iteration time of the sparse boosting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline_result</code></td>
<td>
<p>A list of length <code>max_t</code> that includes the estimation results of
each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>A vector of length max_t that includes Bayesian Information Criterion based on the
Huber's prediction error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>A vector of length max_t that includes the index of selected variable in each
iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>The iteration time with the smallest BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable_pair</code></td>
<td>
<p>A matrix with two columns that include the set of variables that can
potentially enter the regression model at the stopping iteration time. Here, the first and
second columns correspond to the indexes of E factors and G factors. For example, (1, 0)
represents that this variable is the first E factor, and (1,2) represents that the variable is
the interaction between the first E factor and second G factor. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_type</code></td>
<td>
<p>A vector whose length is the number of rows of <code>variable_pair</code>, with each
element representing the variable type of the corresponding row of <code>variable_pair</code>. Here,
"EC" stands for continuous E effect, "ED" for discrete E effect, and "G"  for G effect, "EC-G"
for the interaction between "EC" and "G", "ED-G" for the interaction between "ED" and "G".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The same as input <code>family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>Degree for the B spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>The step size used in the sparse boosting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NorM</code></td>
<td>
<p>The values of B spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation_results</code></td>
<td>
<p>A list of estimation results for each variable. Here, the first
<code>q</code> elemnets are for the E effects, the (<code>q+1</code>) element
is for the first G effect and the (<code>q+2</code>) to (<code>2q+1</code>) elements are for the interactions
corresponding to the first G factor, and so on.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Mengyun Wu and Shuangge Ma.
<em>Robust semiparametric gene-environment interaction analysis using sparse boosting.
Statistics in Medicine, 38(23):4625-4641, 2019.</em>
</p>


<h3>See Also</h3>

<p><code>bs</code> method for B spline expansion, <code>coef</code>, <code>predict</code>, and <code>plot</code> methods, and <code>Miss.boosting</code>
method.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Rob_data)
G=Rob_data[,1:20];E=Rob_data[,21:24]
Y=Rob_data[,25];Y_s=Rob_data[,26:27]
knots = list();Boundary.knots = matrix(0, 24, 2)
for(i in 1:4) {
  knots[[i]] = c(0, 1)
  Boundary.knots[i, ] = c(0, 1)
  }

#continuous
fit1= RobSBoosting(G,E,Y,loop_time = 80,num.knots = 2,Boundary.knots=Boundary.knots,
degree = 2,family = "continuous",knots = knots,E_type=c("EC","EC","ED","ED"))
coef1 = coef(fit1)
predict1=predict(fit1,newE=E[1:2,],newG=G[1:2,])
plot(fit1)


#survival
fit2= RobSBoosting(G,E,Y_s,loop_time = 200, num.knots = 2, Boundary.knots=Boundary.knots,
family = "survival", knots = knots,E_type=c("EC","EC","ED","ED"))
coef2 = coef(fit2)
predict2=predict(fit2,newE=E[1:2,],newG=G[1:2,])
plot(fit2)

</code></pre>


</div>