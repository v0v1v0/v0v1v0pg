<div class="container">

<table style="width: 100%;"><tr>
<td>pwlrmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compositional maps, pairwise logratios
Matrix of maps showing different combinations of components of a composition, in pairwise logratios</h2>

<h3>Description</h3>

<p>Compositional maps, pairwise logratios
Matrix of maps showing different combinations of components of a composition, in pairwise logratios
</p>


<h3>Usage</h3>

<pre><code class="language-R">pwlrmap(
  loc,
  comp,
  colscale = rev(rainbow(10, start = 0, end = 4/6)),
  cexrange = c(0.1, 2),
  scale = rank,
  commonscale = FALSE,
  foregroundcolor = "black",
  closeplot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>matrix or data.frame of coordinates of the sample locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>composition observed at every location, can be a matrix, a data.frame or
of one of the classes <code>compositions::acomp</code> or <code>compositions::aplus</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colscale</code></td>
<td>
<p>set of colors to be used as colorscale (defauls to 10 colors between blue and red)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexrange</code></td>
<td>
<p>symbol size min and max values (default to 0.1 to 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>function scaling the set of z-values of each map, defaults to <code>rank</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>commonscale</code></td>
<td>
<p>logical, should all plots share a common z-scale? defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foregroundcolor</code></td>
<td>
<p>color to be used for the border of the symbol</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>closeplot</code></td>
<td>
<p>logical, should the plot be left open (FALSE) for further changes, or be frozen (TRUE)?
defaults to TRUE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function is primarily called for producing a matrix of (D,D) plots of the D-part
compositional samples, where at each plot we represent a map whose symbols are colored and
sized according to a z-scale controlled by a different logratio. For each plot, this is the
logratio of the row variable by the column variable. However, in case that <code>closeplot=FALSE</code>,
this function returns
invisibly the graphical parameters that were active prior to calling this function. This allows
the user to add further stuff to the plots (mostly, using <code>par(mfg=c(i,j))</code> to plot on the
diagram (i,j)), or manually freeze the plot (by wrapping the call to <code>pwlrmap</code> on a call to
<code>par</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Windarling")
coords = as.matrix(Windarling[,c("Easting","Northing")])
compo = Windarling[,c("Fe","Al2O3","SiO2", "Mn", "P")]
compo$Rest = 100-rowSums(compo)
compo = compositions::acomp(compo) 
# in quantiles (default, ranking controls color and size)
pwlrmap(coords, compo) 

# in logratios (I=identity)
pwlrmap(coords, compo, scale=I)
# in ratios (i.e., apply exp)
pwlrmap(coords, compo, scale=exp)  
# use only color, no change in symbol size
pwlrmap(coords, compo, cexrange=c(1,1)) 
# change all
pwlrmap(coords, compo, commonscale=TRUE, cexrange=c(1.2,1.2), 
                    colscale=rev(rainbow(40, start=0, end=4/6))) 

</code></pre>


</div>