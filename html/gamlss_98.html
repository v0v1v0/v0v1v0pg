<div class="container">

<table style="width: 100%;"><tr>
<td>lo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Specify a loess fit in a GAMLSS formula</h2>

<h3>Description</h3>

<p>Allows the user to specify a <code>loess</code> fit within a GAMLSS model. This function is similar to the <code>lo</code> function in the <code>gam</code> implementation of package <code>gam</code> see Chambers and Hastie (1991).
</p>
<p>The function <code>vis.lo()</code> allows plotting the results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lo(formula, control = lo.control(...), ...)
lo.control(span = 0.75, enp.target = NULL, 
          degree = 2, parametric = FALSE, drop.square = FALSE, 
          normalize = TRUE, family = c("gaussian", "symmetric"), 
          method = c("loess", "model.frame"), 
          surface = c("interpolate", "direct"), 
          statistics = c("approximate", "exact", "none"), 
          trace.hat = c("exact", "approximate"), 
          cell = 0.2, iterations = 4,iterTrace = FALSE, ...)
vis.lo(obj, se=-1, rug = FALSE, partial.resid = FALSE, 
          col.term = "darkred",  col.shaded = "gray", 
          col.res = "lightblue", col.rug = "gray", lwd.term = 1.5, 
          cex.res = 1, pch.res = par("pch"), 
          type = c("persp", "contour"), col.surface = "gray", 
          nlevels = 30, n.grid = 30, image = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula specifying the explanatory variables </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a control to be passed to the <code>loess</code> function </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>the number of observations in a neighbourhood. This is the smoothing parameter for a loess fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enp.target</code></td>
<td>
<p>an alternative way to specify span, as the approximate equivalent number degrees of freedom to be used. See also the help file of the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function <code>loess</code>. For consistency with the older version of <code>lo</code> the effective degrees of freedom <code>df</code> can be also specified instead of span, e.g. <code>df=5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of local polynomial; can be 1 or 2. See also the help file of <code>loess</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parametric</code></td>
<td>
<p>should any terms be fitted globally rather than locally? See the help file of <code>loess</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.square</code></td>
<td>
<p>for fits with more than one predictor and degree=2, should the quadratic term be dropped for particular predictors?. See also help file of <code>loess</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>should the predictors be normalized to a common scale if there is more than one? See the help file of <code>loess</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>if <code>"gaussian"</code> fitting is by least-squares, and if "symmetric" a re-descending M estimator is used with Tukey's biweight function. See the help file of <code>loess</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>fit the model or just extract the model frame. See the help file of <code>loess</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surface</code></td>
<td>
<p>should the fitted surface be computed exactly or via interpolation from a kd tree? See also
the help file of <code>loess.control</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics</code></td>
<td>
<p>should the statistics be computed exactly or approximately? See the help file of <code>loess.control</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.hat</code></td>
<td>
<p>should the trace of the smoother matrix be computed exactly or approximately? See the help file of <code>loess.control</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell</code></td>
<td>
<p>if interpolation is used this controls the accuracy of the approximation via the maximum number of points in a cell in the kd tree. See the help file of <code>loess.control</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the number of iterations used in robust fitting. See the help file of <code>loess.control</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterTrace</code></td>
<td>
<p>logical (or integer) determining if tracing information during the robust iterations (iterations&gt;= 2) is produced. See the help file of <code>loess.control</code></p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>an <code>lowss</code> object fitted within gamlss</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>if <code>se&gt;0</code> then standard errors surfaces are drawn in the 3-dimensional plot. Set <code>se</code> at the required level i.e <code>se=1.96</code> will be an approximated 95% CI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>whether to plot a rug in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.resid</code></td>
<td>
<p>whether to plot the partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.term</code></td>
<td>
<p>the colour of the line of fitted term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.res</code></td>
<td>
<p> the shading of standard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.shaded</code></td>
<td>
<p>the shading of standard error intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.res</code></td>
<td>
<p>the colour of partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.rug</code></td>
<td>
<p>the colour of the rug</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.term</code></td>
<td>
<p>the width of the line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.res</code></td>
<td>
<p>The character for the partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of the plot if the x's are two dimensional</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.surface</code></td>
<td>
<p>the colour of the fitted surface</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>the number of levels used in <code>cotour()</code> plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.grid</code></td>
<td>
<p>The number of points to evaluate the surface</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>image</code></td>
<td>
<p>whether to use <code>image()</code> or just <code>contour</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that <code>lo</code> itself does no smoothing; it simply sets things up for the function <code>gamlss.lo()</code> which is used by the backfitting function  <code>gamlss.add()</code>.
</p>


<h3>Value</h3>

<p>a <code>loess</code> object is returned.  
</p>


<h3>Warning </h3>

<p>In this version the first argument is a formula NOT a list as in the previous one</p>


<h3>Note</h3>

<p>Note that <code>lo</code> itself does no smoothing; it simply sets things up for <code>gamlss.lo()</code> to do the backfitting.</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby, (The original <code>lo()</code> function was based on the Trevor Hastie's S-plus <code>lo()</code> function. See also the documentation of the <code>loess</code> function for the authorship of the function.</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1991). <em>Statistical Models in S</em>, Chapman and Hall, London. 
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code>cs</code>, <code>random</code>,  </p>


<h3>Examples</h3>

<pre><code class="language-R"># fitting a loess curve with span=0.4 plus the a quarterly  effect 
aids1&lt;-gamlss(y~lo(~x,span=0.4)+qrt,data=aids,family=PO) # 
term.plot(aids1, page=1)
## Not run: 
r1 &lt;- gamlss(R~lo(~Fl)+lo(~A), data=rent, family=GA)
 term.plot(r1, pages=1)
 vis.lo(getSmo(r1, which=1), partial=T)
r2 &lt;- gamlss(R~lo(~Fl+A), data=rent, family=GA)
 term.plot(r2, pages=1)
 vis.lo(getSmo(r2, which=1))
 vis.lo(getSmo(r2, which=1), se=1.97)
 vis.lo(getSmo(r2, which=1), partial.res=T)

## End(Not run)
</code></pre>


</div>