<div class="container">

<table style="width: 100%;"><tr>
<td>stepCriterion.glm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable Selection in Generalized Linear Models</h2>

<h3>Description</h3>

<p>Performs variable selection in generalized linear models using hybrid versions of forward stepwise and backward stepwise.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'glm'
stepCriterion(
  model,
  criterion = c("adjr2", "bic", "aic", "p-value", "qicu"),
  test = c("wald", "lr", "score", "gradient"),
  direction = c("forward", "backward"),
  levels = c(0.05, 0.05),
  trace = TRUE,
  scope,
  force.in,
  force.out,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of the class <em>glm</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>an (optional) character string indicating the criterion which should be used to compare the candidate models. The available options are: AIC ("aic"), BIC ("bic"), adjusted deviance-based R-squared ("adjr2"), and <em>p</em>-value of the <code>test</code> test ("p-value"). As default, <code>criterion</code> is set to "adjr2".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>an (optional) character string indicating the statistical test which should be used to compare nested models. The available options are: Wald ("wald"), Rao's score ("score"), likelihood-ratio ("lr") and gradient ("gradient") tests. As default, <code>test</code> is set to "wald".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>an (optional) character string indicating the type of procedure which should be used. The available options are: hybrid backward stepwise ("backward") and hybrid forward stepwise ("forward"). As default, <code>direction</code> is set to "forward".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>an (optional) two-dimensional vector of values in the interval <code class="reqn">(0,1)</code> indicating the levels at which the variables should in and out from the model. This is only appropiate if <code>criterion</code>="p-value". As default, <code>levels</code> is set to <code>c(0.05,0.05)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>an (optional) logical switch indicating if should the stepwise reports be printed. As default, <code>trace</code> is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope</code></td>
<td>
<p>an (optional) list, containing components <code>lower</code> and <code>upper</code>, both formula-type objects, indicating the range of models which should be examined in the stepwise search. As default, <code>lower</code> is a model with no predictors and <code>upper</code> is the linear predictor of the model in <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.in</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in all models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.out</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in no models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. For example, <code>k</code>, that is, the magnitude of the penalty in the AIC/QICu, which by default is set to 2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The "hybrid forward stepwise" algorithm starts with the simplest model (which may
be chosen at the argument <code>scope</code>, and As default, is a model whose parameters in the
linear predictor, except the intercept, if any, are set to 0), and then the candidate
models are built by hierarchically including effects in the linear predictor, whose
"relevance" and/or "importance" in the model fit is assessed by comparing nested models
(that is, by comparing the models with and without the added effect) using a criterion
previously specified. If an effect is added to the equation, this strategy may also remove
any effect which, according to the previously specified criterion, no longer provides
improvement in the model fit. That process continues until no more effects are included
or excluded. The "hybrid backward stepwise" algorithm works similarly.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
<td style="text-align: left;">
<code>initial</code> </td>
<td style="text-align: left;">  a character string indicating the linear predictor of the "initial model",</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>direction</code> </td>
<td style="text-align: left;">  a character string indicating the type of procedure which was used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>criterion</code> </td>
<td style="text-align: left;"> a character string indicating the criterion used to compare the candidate models,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>final</code> </td>
<td style="text-align: left;"> a character string indicating the linear predictor of the "final model",</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>final.fit</code> </td>
<td style="text-align: left;"> an object of class <code>glm</code> with the results of the fit to the data of the "final model",</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>James G., Witten D., Hastie T., Tibshirani R. (2013, page 210) An Introduction to Statistical Learning with Applications in R, Springer, New York.
</p>


<h3>See Also</h3>

<p>bestSubset, stepCriterion.lm, stepCriterion.overglm, stepCriterion.glmgee
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example 1: Fuel consumption of automobiles
Auto &lt;- ISLR::Auto
Auto2 &lt;- within(Auto, origin &lt;- factor(origin))
mod &lt;- mpg ~ cylinders + displacement + acceleration + origin + horsepower*weight
fit1 &lt;- glm(mod, family=inverse.gaussian("log"), data=Auto2)
stepCriterion(fit1, direction="forward", criterion="p-value", test="lr")
stepCriterion(fit1, direction="backward", criterion="bic", force.in=~cylinders)

###### Example 2: Patients with burn injuries
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
upper &lt;- ~ age + gender + race + tbsa + inh_inj + flame + age*inh_inj + tbsa*inh_inj
fit2 &lt;- glm(death ~ age + gender + race + tbsa + inh_inj, family=binomial("logit"), data=burn1000)
stepCriterion(fit2, direction="backward", criterion="bic", scope=list(upper=upper),force.in=~tbsa)
stepCriterion(fit2, direction="forward", criterion="p-value", test="score")

###### Example 3: Skin cancer in women
data(skincancer)
upper &lt;- cases ~ city + age + city*age
fit3 &lt;- glm(upper, family=poisson("log"), offset=log(population), data=skincancer)
stepCriterion(fit3, direction="backward", criterion="aic", scope=list(lower=~ 1,upper=upper))
stepCriterion(fit3, direction="forward", criterion="p-value", test="lr")
</code></pre>


</div>