<div class="container">

<table style="width: 100%;"><tr>
<td>genZcor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>genZcor</h2>

<h3>Description</h3>

<p>constructs the design matrix for the correlation structures: independence,
echangeable, ar1 and unstructured The user will need this function only as a
basis to construct a user defined correlation structure: use genZcor to get
the design matrix Z for the unstructured correlation and define the specific
correlation structure by linear combinations of the columns of Z.
</p>


<h3>Usage</h3>

<pre><code class="language-R">genZcor(clusz, waves, corstrv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clusz</code></td>
<td>
<p>integer vector giving the number of observations in
each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waves</code></td>
<td>
<p>integer vector, obervations in the same cluster with
values of wave i and j have the correlation
<code class="reqn">latex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstrv</code></td>
<td>
<p>correlation structures:
1=independence, 2=exchangeable, 3=ar1, 4=unstructured.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The design matrix for the correlation structure.
</p>


<h3>Author(s)</h3>

<p>Jun Yan <a href="mailto:jyan.stat@gmail.com">jyan.stat@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>fixed2Zcor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# example to construct a Toeplitz correlation structure
#    sigma_ij=sigma_|i-j|

# data set with 5 clusters and maximally 4 observations (visits) per cluster
gendat &lt;- function() {
       id &lt;- gl(5, 4, 20)
       visit &lt;- rep(1:4, 5)
       y &lt;- rnorm(id)
       dat &lt;- data.frame(y, id, visit)[c(-2,-9),]
}

set.seed(88)
dat &lt;- gendat()

# generating the design matrix for the unstructured correlation
zcor &lt;- genZcor(clusz = table(dat$id), waves = dat$visit, corstrv=4)

# defining the Toeplitz structure 
zcor.toep     &lt;- matrix(NA, nrow(zcor), 3)
zcor.toep[,1] &lt;- apply(zcor[,c(1, 4, 6)], 1, sum)
zcor.toep[,2] &lt;- apply(zcor[,c(2, 5)], 1, sum)
zcor.toep[,3] &lt;- zcor[,3]

zfit1 &lt;- geese(y ~ 1,id = id, data = dat,
                   corstr = "userdefined", zcor = zcor.toep)


zfit2 &lt;- geeglm(y ~ 1,id = id, data = dat,
                   corstr = "userdefined", zcor = zcor.toep)

</code></pre>


</div>