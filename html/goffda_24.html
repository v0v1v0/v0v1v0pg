<div class="container">

<table style="width: 100%;"><tr>
<td>ontario</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ontario temperature and electricity consumption during 2010–2014</h2>

<h3>Description</h3>

<p>Real dataset employed Benatia et al. (2017). Contains the
hourly electricity consumption and air temperature curves in the province
of Ontario (Canada). It features a set of daily curves during the summer
months of 2010–2014.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ontario
</code></pre>


<h3>Format</h3>

<p>A list with the following entries:
</p>

<dl>
<dt>temp</dt>
<dd>
<p>an <code>fdata</code> with 368 smoothed
daily temperature (in Celsius degrees) curves of the Ontario province,
discretized on 73 equispaced grid points on <code class="reqn">[-24, 48]</code>
(see examples).</p>
</dd>
<dt>elec</dt>
<dd>
<p>an <code>fdata</code> with the daily
electricity consumption (in gigawatts) curves of the Ontario province.
Discretized on 25 equispaced grid points on <code class="reqn">[0, 24]</code>.</p>
</dd>
<dt>df</dt>
<dd>
<p>a dataframe with time metadata for each curve:
</p>

<ul>
<li>
<p><code>date</code>: the date of the observation, a <code>POSIXct</code>
object.
</p>
</li>
<li>
<p><code>weekday</code>: the weekday of the observation.
</p>
</li>
</ul>
</dd>
</dl>
<h3>Details</h3>

<p>The summer months correspond to June 1st to September 15th. Weekend days and
holidays are disregarded.
</p>
<p>The smoothed temperature curves are constructed by a weighted average of
the temperatures of 41 Ontarian cities that is afterwards smoothed with
a local polynomial regression. The curves correspond to a 3-days window
of the temperature (see examples). The temperature is standardized such
that its original minimum, 6 ºC, is subtracted.
</p>
<p>The electricity consumption curves are discretized on the interval
<code class="reqn">[0, 24]</code>. That means that the last observation of the
<code class="reqn">i</code>-th curve is the same as the first observation of the
<code class="reqn">(i + 1)</code>-th curve <em>if</em> the curves correspond to consecutive days.
</p>
<p>See more details about the construction of the dataset in Benatia et al.
(2017).
</p>


<h3>Author(s)</h3>

<p>Data gathered and processed by David Benatia, Marine Carrasco, and
Jean-Pierre Florens. Javier Álvarez-Liébana and Eduardo García-Portugués
imported the dataset and added temporal metadata.
</p>


<h3>Source</h3>

<p>The dataset comes from the companion data to Benatia et al. (2017), which
was retrieved from the <a href="https://www.davidbenatia.com/publication/">
first author's website</a>. The source of the electricity consumption data is
the <a href="https://www.ieso.ca/">System operator's website</a>. The source
of the preprocessed temperature values is the
<a href="https://climat.meteo.gc.ca/">Environment Canada's website</a>.
</p>


<h3>References</h3>

<p>Benatia, D., Carrasco, M. and Florens, J. P. (2017) Functional linear
regression with functional response. <em>Journal of Econometrics</em>,
201(2):269–291. <a href="https://doi.org/10.1016/j.jeconom.2017.08.008">doi:10.1016/j.jeconom.2017.08.008</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Show data

# Load data
data("ontario")

# Plot
old_par &lt;- par(mfrow = c(1, 2))
plot(ontario$temp)
plot(ontario$elec)
par(old_par)

# Observe the 3-day windows for each observation
plot(ontario$temp$argvals, ontario$temp$data[2, ], type = "o",
     xlim = c(-48, 72), ylim = c(7, 13), xlab = "Hours",
     ylab = "Electricity consumption", pch = 16)
points(ontario$temp$argvals - 24, ontario$temp$data[1, ], col = 3, pch = 2)
points(ontario$temp$argvals + 24, ontario$temp$data[3, ], col = 2, cex = 1.5)
abline(v = 24 * -2:3, lty = 2)
legend("top", legend = c("Curve 1", "Curve 2", "Curve 3"), col = c(3, 1, 2),
       pt.cex = c(1, 1, 1.5), pch = c(2, 16, 1))

# If the days are not consecutive, then the electricity consumptions at the
# end of one day and the beginning of the next do not match
head(abs(ontario$elec$data[-368, 25] - ontario$elec$data[-1, 1]))
head(diff(ontario$df$date))

## Test the linear model with functional response and predictor

(comp_flmfr &lt;- flm_test(X = ontario$temp, Y = ontario$elec,
                        est_method = "fpcr_l1s"))
(simp_flmfr &lt;- flm_test(X = ontario$temp, Y = ontario$elec,
                        beta0 = 0, est_method = "fpcr_l1s"))

# Visualize estimation
filled.contour(x = ontario$temp$argvals, y = ontario$elec$argvals,
               z = comp_flmfr$fit_flm$Beta_hat,
               color.palette = viridisLite::viridis, nlevels = 20)

</code></pre>


</div>