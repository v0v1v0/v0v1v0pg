<div class="container">

<table style="width: 100%;"><tr>
<td>baseline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Baseline Estimation and Removal</h2>

<h3>Description</h3>

<p>Baseline Estimation and Removal
</p>


<h3>Usage</h3>

<pre><code class="language-R">signal_baseline(object, ...)

signal_correct(object, ...)

baseline_snip(object, ...)

baseline_rubberband(object, ...)

baseline_linear(object, ...)

## S4 method for signature 'GammaSpectrum'
signal_baseline(object, method = c("SNIP", "rubberband", "linear"), ...)

## S4 method for signature 'GammaSpectra'
signal_baseline(object, method = c("SNIP", "rubberband", "linear"), ...)

## S4 method for signature 'GammaSpectrum'
signal_correct(object, method = c("SNIP", "rubberband", "linear"), ...)

## S4 method for signature 'GammaSpectra'
signal_correct(object, method = c("SNIP", "rubberband", "linear"), ...)

## S4 method for signature 'GammaSpectrum'
baseline_linear(object, from = NULL, to = NULL)

## S4 method for signature 'GammaSpectra'
baseline_linear(object, from = NULL, to = NULL)

## S4 method for signature 'GammaSpectrum'
baseline_rubberband(object, noise = 0, spline = TRUE, ...)

## S4 method for signature 'GammaSpectra'
baseline_rubberband(object, noise = 0, spline = TRUE, ...)

## S4 method for signature 'GammaSpectrum'
baseline_snip(object, LLS = FALSE, decreasing = FALSE, n = 100, ...)

## S4 method for signature 'GammaSpectra'
baseline_snip(object, LLS = FALSE, decreasing = FALSE, n = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A GammaSpectrum or GammaSpectra
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra parameters to be passed to further methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A <code>character</code> string specifying the method to be used for
baseline estimation (see details). Any unambiguous substring can be given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>An <code>integer</code> giving the first channel to be used for linear
interpolation. If <code>NULL</code> (the default), channel <code class="reqn">1</code> is used.
Only used if <code>method</code> is "<code>linear</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>An <code>integer</code> giving the last channel to be used for linear
interpolation. If <code>NULL</code> (the default), channel <code class="reqn">max</code> is used.
Only used if <code>method</code> is "<code>linear</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>A length-one <code>numeric</code> vector giving the noise level.
Only used if <code>method</code> is "<code>rubberband</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline</code></td>
<td>
<p>A <code>logical</code> scalar: should spline interpolation through the
support points be used instead of linear interpolation?
Only used if <code>method</code> is "<code>rubberband</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LLS</code></td>
<td>
<p>A <code>logical</code> scalar: should the LLS operator be applied on <code>x</code>
before employing SNIP algorithm? Only used if <code>method</code> is "<code>SNIP</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p>A <code>logical</code> scalar: should a decreasing clipping window
be used? Only used if <code>method</code> is "<code>SNIP</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An <code>integer</code> value giving the number of iterations.
Only used if <code>method</code> is "<code>SNIP</code>".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following methods are available for baseline estimation:
</p>

<dl>
<dt><code>SNIP</code></dt>
<dd>
<p>Sensitive Nonlinear Iterative Peak clipping algorithm.</p>
</dd>
<dt><code>rubberband</code></dt>
<dd>
<p>A convex envelope of the spectrum is determined and the
baseline is estimated as the part of the convex envelope lying below the
spectrum. Note that the rubber band does not enter the concave regions
(if any) of the spectrum.</p>
</dd>
<dt><code>linear</code></dt>
<dd>
<p>Linear baseline estimation.</p>
</dd>
</dl>
<h3>Value</h3>


<ul>
<li> <p><code style="white-space: pre;">⁠baseline_*()⁠</code> returns a BaseLine object.
</p>
</li>
<li> <p><code>signal_correct()</code> returns a corrected GammaSpectrum or
GammaSpectra object (same as <code>object</code>).
</p>
</li>
</ul>
<h3>Note</h3>

<p><code>baseline_rubberband()</code> is slightly modified from C. Beleites'
<code>hyperSpec::spc.rubberband()</code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Liland, K. H. (2015). 4S Peak Filling - baseline estimation by iterative
mean suppression. <em>MethodsX</em>, 2, 135-140. <a href="https://doi.org/10.1016/j.mex.2015.02.009">doi:10.1016/j.mex.2015.02.009</a>.
</p>
<p>Morháč, M., Kliman, J., Matoušek, V., Veselský, M. &amp; Turzo, I. (1997).
Background elimination methods for multidimensional gamma-ray spectra.
<em>Nuclear Instruments and Methods in Physics Research Section A:
Accelerators, Spectrometers, Detectors and Associated Equipment</em>, 401(1),
p. 113-132. <a href="https://doi.org/10.1016/S0168-9002%2897%2901023-1">doi:10.1016/S0168-9002(97)01023-1</a>
</p>
<p>Morháč, M. &amp; Matoušek, V. (2008). Peak Clipping Algorithms for Background
Estimation in Spectroscopic Data. <em>Applied Spectroscopy</em>, 62(1), p. 91-106.
<a href="https://doi.org/10.1366/000370208783412762">doi:10.1366/000370208783412762</a>
</p>
<p>Ryan, C. G., Clayton, E., Griffin, W. L., Sie, S. H. &amp; Cousens, D. R.
(1988). SNIP, a statistics-sensitive background treatment for the
quantitative analysis of PIXE spectra in geoscience applications.
<em>Nuclear Instruments and Methods in Physics Research Section B:
Beam Interactions with Materials and Atoms</em>, 34(3), p. 396-402.
<a href="https://doi.org/10.1016/0168-583X%2888%2990063-8">doi:10.1016/0168-583X(88)90063-8</a>
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code>peaks_find()</code>,
<code>peaks_search()</code>,
<code>signal_integrate()</code>,
<code>signal_slice()</code>,
<code>signal_split()</code>,
<code>signal_stabilize()</code>,
<code>smooth()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Import a CNF file
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(spc_file)

## Remove the first 35 channels
spc &lt;- signal_slice(spc, -c(1:35))

## Linear baseline
bsl_linear &lt;- baseline_linear(spc, from = 250, to = 750)
plot(spc, bsl_linear)

## SNIP baseline
bsl_snip &lt;- baseline_snip(spc, LLS = FALSE, decreasing = FALSE, n = 100)
plot(spc, bsl_snip)

## Rubberband baseline
bsl_rubber &lt;- baseline_rubberband(spc)
plot(spc, bsl_rubber)

## Remove baseline
spc_clean1 &lt;- signal_correct(spc)
spc_clean2 &lt;- spc - bsl_snip
all(spc_clean1 == spc_clean2)

plot(spc_clean1)
</code></pre>


</div>