<div class="container">

<table style="width: 100%;"><tr>
<td>logLik.gips</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract the Log-Likelihood for <code>gips</code> class</h2>

<h3>Description</h3>

<p>Calculates Log-Likelihood of the sample based on the <code>gips</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gips'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>gips</code>. Usually, a result of a <code>find_MAP()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments will be ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This will always be the biggest for <code>perm = "()"</code> (provided that <code>p &lt;= n</code>).
</p>
<p>If the found permutation still requires more parameters than <code>n</code>,
the likelihood does not exist; thus the function returns <code>NULL</code>.
</p>
<p>If the <code>projected_cov</code> (output of <code>project_matrix()</code>)
is close to singular, the <code>NA</code> is returned.
</p>


<h3>Value</h3>

<p>Log-Likelihood of the sample.
</p>
<p>When the multivariate normal model does not exist
(<code>number_of_observations &lt; n0</code>), it returns <code>NULL</code>.
When the multivariate normal model cannot be reasonably approximated
(output of <code>project_matrix()</code> is singular), it returns <code>-Inf</code>.
</p>
<p>In both failure situations, it shows a warning.
More information can be found in the <strong>Existence of likelihood</strong> section below.
</p>


<h3>Existence of likelihood</h3>

<p>We only consider the non-degenerate multivariate normal model.
In the <code>gips</code> context, such a model exists only when
the number of observations is bigger or equal to <code>n0</code>. To get <code>n0</code>
for the <code>gips</code> object <code>g</code>, call <code>summary(g)$n0</code>.
</p>
<p>For more information, refer to <strong><code class="reqn">C_\sigma</code> and <code>n0</code></strong> section in
<code>vignette("Theory", package = "gips")</code> or its
<a href="https://przechoj.github.io/gips/articles/Theory.html">pkgdown page</a>.
</p>


<h3>Calculation details</h3>

<p>For more details and used formulas, see
the <strong>Information Criterion - AIC and BIC</strong> section in
<code>vignette("Theory", package = "gips")</code> or its
<a href="https://przechoj.github.io/gips/articles/Theory.html">pkgdown page</a>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>logLik()</code> - Generic function this <code>logLik.gips()</code> extends.
</p>
</li>
<li> <p><code>find_MAP()</code> - Usually, the <code>logLik.gips()</code>
is called on the output of <code>find_MAP()</code>.
</p>
</li>
<li> <p><code>AIC.gips()</code>, <code>BIC.gips()</code> - Often, one is more
interested in an Information Criterion AIC or BIC.
</p>
</li>
<li> <p><code>summary.gips()</code> - One can get <code>n0</code> by calling <code>summary(g)$n0</code>.
To see why one may be interested in <code>n0</code>,
see the <strong>Existence of likelihood</strong> section above.
</p>
</li>
<li> <p><code>project_matrix()</code> - Project the known matrix
onto the found permutations space.
It is mentioned in the <strong>Calculation details</strong> section above.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">S &lt;- matrix(c(
  5.15, 2.05, 3.60, 1.99,
  2.05, 5.09, 2.03, 3.57,
  3.60, 2.03, 5.21, 1.97,
  1.99, 3.57, 1.97, 5.13
), nrow = 4)
g &lt;- gips(S, 5)
logLik(g) # -32.67048
# For perm = "()", which is default, there is p + choose(p, 2) degrees of freedom

g_map &lt;- find_MAP(g, optimizer = "brute_force")
logLik(g_map) # -32.6722 # this will always be smaller than `logLik(gips(S, n, perm = ""))`

g_n_too_small &lt;- gips(S, 4)
logLik(g_n_too_small) # NULL # the likelihood does not exists
</code></pre>


</div>