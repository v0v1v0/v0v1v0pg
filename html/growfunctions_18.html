<div class="container">

<table style="width: 100%;"><tr>
<td>informative_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot credible intervals for parameters to compare ignoring with weighting an informative sample</h2>

<h3>Description</h3>

<p>Uses as input the output object from the gpdpgrow() and gmrfdpgrow() functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">informative_plot(
  objects = NULL,
  objects_labels = c("ignore", "weight"),
  map = NULL,
  units_name = NULL,
  model = "gp",
  true_star = NULL,
  map_true = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>objects</code></td>
<td>
<p>A list of objects, either all outputs from gpdpgrow(), or all from gmrfdpgrow().
<code>objects</code> includes a model estimated under ignoring the informativeness of the 
sampling design and another that employs weighting to account for the informativeness.
An additional object may be added to represent a separate "iid" (or non-informative)
sample from the same population, which will typically be available if the dataset
was generated as synthetic data using function, "gen_informative_sample()".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objects_labels</code></td>
<td>
<p>A character vector of length equal to <code>objects</code> that provides
labels for each entry in <code>objects</code>.  Allowed entries in <code>objects_labels</code> 
are <code>c("ignore","weight","iid")</code>, where "ignore" denotes a model that ignores
the informativeness, while "weight" denotes a model that employs sampling weights and
"iid" denotes a model run on a non-informative, iid sample from the same population.
Defaults to <code>objects_labels = c("ignore","weight")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>A list matrices, where each entry is produced 
from <code>cluster_plot(object)$map</code>. It is comprised of
unit labels and cluster assignments for each object in <code>objects</code>.
The length of <code>map</code> must be equal to the length of <code>objects</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units_name</code></td>
<td>
<p>The label in each "map" matrix for the observation units. Will be the same as the
<code>units_name</code> entry for the previously run, <code>cluster_plot()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A scalar character input indicating the estimation model for <em>all</em> of the entries
in <code>objects</code>. Allowable values for <code>model</code> are c("gp","gmrf"). Defaults to
<code>model = "gp"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_star</code></td>
<td>
<p>An optional, <em>P x M</em>  matrix, of true parameter location values, where
<code>P</code> denotes the number of parameters per cluster and <code>M</code> denotes the number of
clusters.  For example, in <code>model = "gp"</code> with a single, rational quadratic covariance,
<code>P = 3</code> and if there are 3 clusters, then <code>M = 3</code>.  For a <code>model = "gmrf"</code>,
with a single covariance, <code>P = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map_true</code></td>
<td>
<p>An optional <code>data.frame</code> object with <code>n</code> rows, the size of the
informative sample used for <code>c("ignore","weight")</code> objects that maps the
<code>units_name</code> to a true cluster.  <code>map_true</code> must have 2 columns (and the
rest are ignored), one must be named the same value as input for <code>units_name</code>.
The second column must be named, <code>cluster</code>.  If the true values derive
from running <code>gen_informative_sample()</code> as the source of the true values,
one may just input the <code>map_obs</code> <code>data.frame</code> that is listed in the object
returned by <code>gen_informative_sample()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list object containing the plot of estimated functions, faceted by cluster,
and the associated <code>data.frame</code> object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.compare</code></td>
<td>
<p>A <code>ggplot2</code> plot object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat.compare</code></td>
<td>
<p>A <code>data.frame</code> object used to generate <code>p.compare</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Terrance Savitsky <a href="mailto:tds151@gmail.com">tds151@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>gpdpgrow</code>, <code>gmrfdpgrow</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(growfunctions)
## use gen_informative_sample() to generate an 
## N X T population drawn from a dependent GP
## By default, 3 clusters are used to generate 
## the population.
## A single stage stratified random sample of size n 
## is drawn from the population using I = 4 strata. 
## The resulting sample is informative in that the 
## distribution for this sample is
## different from the population from which 
## it was drawn because the strata inclusion
## probabilities are proportional to a feature 
## of the response, y (in the case, the variance.
## The stratified random sample over-samples 
## large variance strata).
## (The user may also select a 2-stage 
## sample with the first stage
## sampling "blocks" of the population and 
## the second stage sampling strata within blocks). 
dat_sim        &lt;- gen_informative_sample(N= 10000, 
                                n = 500, T = 5,
                                noise_to_signal = 0.1)

y_obs                       &lt;- dat_sim$y_obs
T                           &lt;- ncol(y_obs)

an informative sampling design that inputs inclusion
probabilities, ipr
res_gp_w            &lt;- gpdpgrow(y = y_obs, 
                               ipr = dat_sim$map_obs$incl_prob, 
                               n.iter = 5, n.burn = 2,  
                               n.thin = 1, n.tune = 0)
and fit vs. data for experimental units
fit_plots_w         &lt;- cluster_plot( object = res_gp_w,  
                           units_name = "establishment", 
                           units_label = dat_sim$map_obs$establishment, 
                           single_unit = FALSE, credible = TRUE )

## estimate parameters ignoring sampling design
res_gp_i            &lt;- gpdpgrow(y = y_obs, 
                               n.iter = 5, n.burn = 2, 
                               n.thin = 1, n.tune = 0)
## plots of estimated functions, faceted by cluster and fit vs. 
## data for experimental units
fit_plots_i         &lt;- cluster_plot( object = res_gp_i,  
                                    units_name = "establishment", 
                                    units_label = dat_sim$map_obs$establishment, 
                                    single_unit = FALSE, credible = TRUE )

## We also draw an iid (non-informative, exchangeable) 
## sample from the same population to 
## compare estimation results to our weighted 
## (w) and unweighted/ignoring (i) models

## estimate parameters under an iid sampling design
res_gp_iid          &lt;- gpdpgrow(y = dat_sim$y_iid, 
                               n.iter = 5, n.burn = 2,   
                               n.thin = 1, n.tune = 0)
## plots of estimated functions, faceted by cluster and 
## fit vs. data for experimental units
fit_plots_iid       &lt;- cluster_plot( object = res_gp_iid,  
                           units_name = "establishment", 
                           units_label = dat_sim$map_iid$establishment, 
                           single_unit = FALSE, credible = TRUE )

## compare estimations of covariance parameter credible 
## intervals when ignoring informativeness vs.
## weighting to account for informativeness
objects                  &lt;- map &lt;- vector("list",3)
objects[[1]]             &lt;- res_gp_i
objects[[2]]             &lt;- res_gp_iid
objects[[3]]             &lt;- res_gp_w
map[[1]]                 &lt;- fit_plots_i$map
map[[2]]                 &lt;- fit_plots_iid$map
map[[3]]                 &lt;- fit_plots_w$map
objects_labels           &lt;- c("ignore","iid","weight")

parms_plots_compare      &lt;- informative_plot( objects = objects, 
                                objects_labels = objects_labels,
                                map = map, units_name = "establishment", 
                                model = "gp",
                                true_star = dat_sim$theta_star, 
                                map_true = dat_sim$map_obs)


## End(Not run)
</code></pre>


</div>