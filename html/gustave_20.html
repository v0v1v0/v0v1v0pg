<div class="container">

<table style="width: 100%;"><tr>
<td>varSYG</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sen-Yates-Grundy variance estimator</h2>

<h3>Description</h3>

<p><code>varSYG</code> computes the Sen-Yates-Grundy 
variance estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varSYG(y = NULL, pikl, precalc = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A (sparse) numerical matrix of the variable(s) whose variance of their total
is to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pikl</code></td>
<td>
<p>A numerical matrix of second-order inclusion probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precalc</code></td>
<td>
<p>A list of pre-calculated results (analogous to the one used by 
<code>varDT</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>varSYG</code> aims at being an efficient implementation of the 
Sen-Yates-Grundy variance estimator for sampling designs with fixed sample 
size. It should be especially useful when several variance estimations are
to be conducted, as it relies on (sparse) matrix linear algebra.
</p>
<p>Moreover, in order to be consistent with <code>varDT</code>, <code>varSYG</code>
has a <code>precalc</code> argument allowing for the re-use of intermediary
results calculated once and for all in a pre-calculation step (see 
<code>varDT</code> for details).
</p>


<h3>Value</h3>

 <ul>
<li>
<p> if <code>y</code> is not <code>NULL</code> (calculation step) : a
numerical vector of size the number of columns of y. </p>
</li>
<li>
<p> if <code>y</code> is
<code>NULL</code> (pre-calculation step) : a list containing pre-calculated data 
(analogous to the one used by <code>varDT</code>).</p>
</li>
</ul>
<h3>Difference with <code>varHT</code> from package <code>sampling</code>
</h3>

<p><code>varSYG</code> differs from <code>sampling::varHT</code> in several ways: 
</p>
 <ul>
<li>
<p> The formula implemented in <code>varSYG</code> is solely
the Sen-Yates-Grundy estimator, which is the one calculated 
by <code>varHT</code> when method = 2.
</p>
</li>
<li> <p><code>varSYG</code> introduces several optimizations: </p>
 <ul>
<li>
<p>matrixwise operations allow to estimate variance on several interest
variables at once </p>
</li>
<li>
<p> Matrix::TsparseMatrix capability yields significant 
performance gains.</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>

<p>Martin Chevalier
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sampling)
set.seed(1)

# Simple random sampling case
N &lt;- 1000
n &lt;- 100
y &lt;- rnorm(N)[as.logical(srswor(n, N))]
pikl &lt;- matrix(rep((n*(n-1))/(N*(N-1)), n*n), nrow = n)
diag(pikl) &lt;- rep(n/N, n)
varSYG(y, pikl)
sampling::varHT(y = y, pikl = pikl, method = 2)
</code></pre>


</div>