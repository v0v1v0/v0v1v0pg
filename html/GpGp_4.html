<div class="container">

<table style="width: 100%;"><tr>
<td>cond_sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional Simulation using Vecchia's approximation</h2>

<h3>Description</h3>

<p>With the prediction locations ordered after the observation locations,
an approximation for the inverse Cholesky of the covariance matrix
is computed, and standard formulas are applied to obtain
a conditional simulation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cond_sim(
  fit = NULL,
  locs_pred,
  X_pred,
  y_obs = fit$y,
  locs_obs = fit$locs,
  X_obs = fit$X,
  beta = fit$betahat,
  covparms = fit$covparms,
  covfun_name = fit$covfun_name,
  m = 60,
  reorder = TRUE,
  st_scale = NULL,
  nsims = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>GpGp_fit object, the result of <code>fit_model</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locs_pred</code></td>
<td>
<p>prediction locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_pred</code></td>
<td>
<p>Design matrix for predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_obs</code></td>
<td>
<p>Observations associated with locs_obs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locs_obs</code></td>
<td>
<p>observation locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_obs</code></td>
<td>
<p>Design matrix for observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Linear mean parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covparms</code></td>
<td>
<p>Covariance parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covfun_name</code></td>
<td>
<p>Name of covariance function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of nearest neighbors to use. Larger <code>m</code> gives
better approximations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder</code></td>
<td>
<p>TRUE/FALSE for whether reordering should be done. This should
generally be kept at TRUE, unless testing out the effect of
reordering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st_scale</code></td>
<td>
<p>amount by which to scale the spatial and temporal
dimensions for the purpose of selecting neighbors. We recommend setting
this manually when using a spatial-temporal covariance function. When 
<code>lonlat = TRUE</code>, spatial scale is in radians (earth radius = 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>
<p>Number of conditional simulations to return.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We can specify either a GpGp_fit object (the result of 
<code>fit_model</code>), OR manually enter the covariance function and
parameters, the observations, observation locations, and design matrix. We 
must specify the prediction locations and the prediction design matrix.
</p>


</div>