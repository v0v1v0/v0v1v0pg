<div class="container">

<table style="width: 100%;"><tr>
<td>reshape.GRM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Reshape a Genetic Relationship Matrix</h2>

<h3>Description</h3>

<p>Reshapes a GRM into a data frame listing relationship of (possibly all) pairs of individuals.
Options are provided to specify ranges of relationship values to include or exclude. This
is useful in the Quality Control process.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> reshape.GRM(K, include = c(-Inf, +Inf), exclude) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p> A symmetric matrix (such as produced by <code>GRM</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p> Range of values to include (default is to include all values) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p> Range of values to exclude (default it to exclude nothing) </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The relationship between individuals <code class="reqn">i</code> and <code class="reqn">j</code> is the coefficient <code class="reqn">k_{ij}</code>
in the matrix <code class="reqn">K</code>. The functions lists all pair <code class="reqn">i, j</code> with <code class="reqn">i &lt; j</code> and <code class="reqn">k_{ij}</code>
in the range defined by <code>include</code> and outside the range defined by <code>exclude</code>. 
</p>


<h3>Value</h3>

<p>A data frame with three columns named <code>i</code>, <code>j</code>, <code>k</code>.
</p>


<h3>Author(s)</h3>

<p> Herv√© Perdry and Claire Dandine-Roulland </p>


<h3>See Also</h3>

 <p><code>GRM</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># load chr2 data set (~10k SNPs in low LD)
x &lt;- read.bed.matrix( system.file("extdata", "chr2.bed", package="gaston") )

# Compute Genetic Relationship Matrix
K &lt;- GRM(x)

# List all pairs if individuals with a relationship above 0.07
pairs &lt;- reshape.GRM(K, exclude = c(-Inf, 0.07))

# Exclude first individual from each such pair
x1 &lt;- x[ -pairs$i, ]
</code></pre>


</div>