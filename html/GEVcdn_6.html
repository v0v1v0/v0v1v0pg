<div class="container">

<table style="width: 100%;"><tr>
<td>gevcdn.bootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bootstrapped confidence intervals for GEV CDN parameters and quantiles
</h2>

<h3>Description</h3>

<p>Used to assist in the calculation of bootstrapped confidence intervals for
GEV location, scale, and shape parameters, as well as for specified quantiles.
Residual and parametric bootstrap estimates are supported.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gevcdn.bootstrap(n.bootstrap, x, y, iter.max = 1000, n.hidden = 2,
                 Th = gevcdn.logistic, fixed = NULL,
                 init.range = c(-0.25, 0.25),
                 scale.min = .Machine$double.eps,
                 beta.p = 3.3, beta.q = 2, sd.norm = Inf,
                 n.trials = 5, method = c("BFGS", "Nelder-Mead"),
                 boot.method = c("residual", "parametric"),
                 init.from.prev = TRUE, max.fails = 100,
                 probs = c(0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 0.9,
                 0.95, 0.99), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n.bootstrap</code></td>
<td>

<p>number of bootstrap trials used to calculate confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>covariate matrix with number of rows equal to the number of samples and number of columns equal to the number of variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>column matrix of target values with number of rows equal to the number of samples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>

<p>maximum number of iterations of optimization algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.hidden</code></td>
<td>

<p>number of hidden nodes in each GEV CDN ensemble member.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Th</code></td>
<td>

<p>hidden layer transfer function; defaults to <code>gevcdn.logistic</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>

<p>vector indicating GEV parameters to be held constant; elements chosen from <code>c("location", "scale", "shape")</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.range</code></td>
<td>

<p>range for random weights on [<code>min(init.range)</code>, <code>max(init.range)</code>]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.min</code></td>
<td>

<p>minimum allowable value for the GEV scale parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.p</code></td>
<td>

<p><code>shape1</code> parameter for shifted beta distribution prior for GEV shape parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.q</code></td>
<td>

<p><code>shape2</code> parameter for shifted beta distribution prior for GEV shape parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.norm</code></td>
<td>

<p><code>sd</code> parameter for normal distribution prior for the magnitude of input-hidden layer weights; equivalent to weight penalty regularization.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trials</code></td>
<td>

<p>number of repeated trials used to avoid shallow local minima during optimization
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>optimization method for <code>optim</code> function; must be chosen from <code>c("BFGS", "Nelder-Mead")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.method</code></td>
<td>

<p>bootstrap method; must be chosen from <code>c("residual", "parametric")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.from.prev</code></td>
<td>

<p>logical value indicating whether or not optimization runs should be initialized from the final weights of the previous run.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.fails</code></td>
<td>

<p>maximum number of repeated exceptions allowed during optimization
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>vector of cumulative probabilities for which quantile confidence intervals are desired.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments passed to the <code>control</code> list of <code>optim</code> function
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note: the <code>boot</code> package provides a more
comprehensive suit of methods for estimating bootstrap-based confidence
intervals.
</p>


<h3>Value</h3>

<p>a list consisting of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>weights.bootstrap</code></td>
<td>
<p>a list of length <code>n.bootstrap</code> consisting of weights following the format returned by <code>gevcdn.fit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms.bootstrap</code></td>
<td>
<p>a list of length <code>n.bootstrap</code> consisting of GEV parameters following the format returned by <code>gevcdn.evaluate</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location.bootstrap</code></td>
<td>
<p>a matrix of GEV location parameters with number of rows equal to that of <code>x</code> and number of columns equal to <code>n.bootstrap</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.bootstrap</code></td>
<td>
<p>a matrix of GEV scale parameters with number of rows equal to that of <code>x</code> and number of columns equal to <code>n.bootstrap</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape.bootstrap</code></td>
<td>
<p>a matrix of GEV shape parameters with number of rows equal to that of <code>x</code> and number of columns equal to <code>n.bootstrap</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles.bootstrap</code></td>
<td>
<p>a list of length <code>n.bootstrap</code> with each consisting of a matrix with number of rows equal to that of <code>x</code> and columns corresponding to <code>probs</code></p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cannon, A.J., 2010. A flexible nonlinear modelling framework for
nonstationary generalized extreme value analysis in hydroclimatology.
Hydrological Processes, 24: 673-685. DOI: 10.1002/hyp.7506
</p>


<h3>See Also</h3>

<p><code>gevcdn.cost</code>, <code>gevcdn.evaluate</code>,
<code>gevcdn.fit</code>, <code>gevcdn.bag</code>,
<code>dgev</code>, <code>optim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate synthetic data

x &lt;- as.matrix(seq(0.1, 1, length = 50))

loc &lt;- x^2
scl &lt;- x/2
shp &lt;- seq(-0.1, 0.3, length = length(x))

set.seed(100)
y &lt;- as.matrix(rgev(length(x), location = loc, scale = scl,
               shape = shp))

## Not run: 
## Fit 30 bootstrapped models

CI &lt;- gevcdn.bootstrap(n.bootstrap = 30, x = x, y = y,
                       iter.max = 100, n.hidden = 2,
                       Th = gevcdn.logistic, n.trials = 1,
                       boot.method = "residual",
                       probs = c(0.1, 0.5, 0.9))

## Plot data and percentile confidence intervals for GEV parameters

par(mfrow = c(2, 2))
matplot(x, y, type = "b", pch = 19, col = "red", xlab = "x",
        ylab = "y", main = "gevcdn.bootstrap")
matplot(x, cbind(loc, t(apply(CI$location.bootstrap, 1, quantile,
        p = c(0.025, 0.975)))), type = c("l", "b", "b"), pch = 20,
        lwd = 3, col = c("black", rep("green", 2)), xlab = "x",
        ylab = "location", main = "location CI")
matplot(x, cbind(scl, t(apply(CI$scale.bootstrap, 1, quantile,
        p = c(0.025, 0.975)))), type = c("l", "b", "b"), pch = 20,
        lwd = 3, col = c("black", rep("orange", 2)), xlab = "x",
        ylab = "scale", main = "scale CI")
matplot(x, cbind(shp, t(apply(CI$shape.bootstrap, 1, quantile,
        p = c(0.025, 0.975)))), type = c("l", "b", "b"), pch = 20,
        lwd = 3, col = c("black", rep("brown", 2)), xlab = "x",
        ylab = "shape", main = "shape CI")

## End(Not run)
</code></pre>


</div>