<div class="container">

<table style="width: 100%;"><tr>
<td>propagation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Propagate particles forward in time</h2>

<h3>Description</h3>

<p>This function propagates particles forward in time. Assuming that the
particles have been propagated to a given time slice <code class="reqn">t</code>, the aim is to
propagate them to a later time slice <code class="reqn">t + k</code> according to the Gaussian
mixture graphical model and to the evidence collected over time. At first, a
renewal step is performed if the effective sample size (ESS) is below a given
threshold (Doucet and Johansen, 2009). This step consists in randomly
selecting new particles among the old ones proportionately to their current
weights. Upon receiving the data (the evidence) of <code class="reqn">t + 1</code>, each particle
is used to generate samples for the unknown values. Its weight is then
updated to the likelihood for the observed values. The higher this
likelihood, the more likely the particle is selected at the next renewal step
for propagation to <code class="reqn">t + 2</code>, and so on (Koller and Friedman, 2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">propagation(
  part,
  gmgm,
  evid = NULL,
  col_seq = NULL,
  col_weight = "weight",
  n_times = 1,
  min_ess = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>A data frame containing the particles propagated to time slice
<code class="reqn">t</code>, as obtained from function <code>particles</code> or
<code>propagation</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmgm</code></td>
<td>
<p>An object of class <code>gmbn</code> or <code>gmdbn</code>. For a
<code>gmdbn</code> object, the <code>gmbn</code> elements used for propagation are
selected according to the temporal depth of the particles, assuming that the
particles contain all the samples since the first time slice (this depth is
thus considered as the current time slice).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evid</code></td>
<td>
<p>A data frame containing the evidence of time slices
<code class="reqn">t + 1, \dots , t + k</code>. Its columns must explicitly be named after nodes
of <code>gmgm</code> and can contain missing values (columns with no value can be
removed). If <code>NULL</code> (the default), no evidence is taken into account.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_seq</code></td>
<td>
<p>A character vector containing the column names of <code>part</code>
and <code>evid</code> that describe the observation sequence. If <code>NULL</code> (the
default), all the particles and observations belong to a single sequence. In
<code>evid</code>, the observations of a same sequence must be ordered such that
the <code class="reqn">k</code>th one is related to time slice <code class="reqn">t + k</code> (note that the
sequences can have different lengths).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_weight</code></td>
<td>
<p>A character string corresponding to the column name of
<code>part</code> that describes the particle weight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_times</code></td>
<td>
<p>A non-negative integer corresponding to the number of time
slices <code class="reqn">k</code> over which the particles are propagated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_ess</code></td>
<td>
<p>A numeric value in [0, 1] corresponding to the minimum ESS
(expressed as a proportion of the number of particles) under which the
renewal step is performed. If <code>1</code> (the default), this step is performed
at each time slice.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame (tibble) containing the particles supplemented with the
samples of time slices <code class="reqn">t + 1, \dots , t + k</code>.
</p>


<h3>References</h3>

<p>Doucet, A. and Johansen, A. M. (2009). A Tutorial on Particle Filtering and
Smoothing: Fifteen years later. <em>Handbook of nonlinear filtering</em>,
12:656â€“704.
</p>
<p>Koller, D. and Friedman, N. (2009). <em>Probabilistic Graphical Models:
Principles and Techniques</em>. The MIT Press.
</p>


<h3>See Also</h3>

<p><code>aggregation</code>, <code>particles</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)
set.seed(0)
data(gmdbn_air, data_air)
evid &lt;- data_air %&gt;%
  group_by(DATE) %&gt;%
  slice(1:3) %&gt;%
  ungroup()
evid$NO2[sample.int(150, 30)] &lt;- NA
evid$O3[sample.int(150, 30)] &lt;- NA
evid$TEMP[sample.int(150, 30)] &lt;- NA
evid$WIND[sample.int(150, 30)] &lt;- NA
part &lt;- particles(data.frame(DATE = unique(evid$DATE))) %&gt;%
  propagation(gmdbn_air, evid, col_seq = "DATE", n_times = 3)

</code></pre>


</div>