<div class="container">

<table style="width: 100%;"><tr>
<td>gp.model.adequacy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model assessment based on Deviance information criterion (DIC), logarithmic pointwise predictive density (lppd), and
logarithmic joint predictive density (ljpd).</h2>

<h3>Description</h3>

<p>This function computes effective number of parameters (pD), deviance information criterion (DIC), logarithmic pointwise predictive density (lppd), and
logarithmic joint predictive density (ljpd). For detailed introduction of these 
metrics, see Chapter 7 of Gelman et al. (2013).
</p>
<p>The deviance function for a model with a vector of parameters 
<code class="reqn">\boldsymbol \theta</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">
 D(\boldsymbol \theta) = -2\log p(\mathbf{y} \mid \boldsymbol \theta),
</code>
</p>
 
<p>where <code class="reqn">\mathbf{y}:=(y(\mathbf{x}_1), \ldots, y(\mathbf{x}_n))^\top</code> is a vector of <code class="reqn">n</code> observations.
</p>

<ul>
<li>
<p>The effective number of parameters (see p.172 of Gelman et al. 2013) is defined as
</p>
<p style="text-align: center;"><code class="reqn">
 pD = E_{\boldsymbol \theta| \mathbf{y}}[D(\boldsymbol \theta)] - D(\hat{ \boldsymbol \theta }),
 </code>
</p>

<p>where <code class="reqn">\hat{\boldsymbol \theta} = E_{\boldsymbol \theta | \mathbf{y}}[\boldsymbol \theta]. </code>
The interpretation is that the effective number of parameters is the “expected" 
deviance minus the “fitted" deviance. Higher <code class="reqn">pD</code> implies more over-fitting with estimate  <code class="reqn">\hat{\boldsymbol \theta}</code>.

</p>
</li>
<li>
<p>The Deviance information criteria (DIC) (see pp. 172-173 of Gelman et al. 2013) is 
</p>
<p style="text-align: center;"><code class="reqn">DIC = E_{\boldsymbol \theta | \mathbf{y}}[D(\boldsymbol \theta)] + pD.
</code>
</p>

<p>DIC approximates Akaike information criterion (AIC) and is more appropriate for hierarchical models than AIC and BIC.

</p>
</li>
<li>
<p>The log predictive density (<strong>lpd</strong>) is defined as 
</p>
<p style="text-align: center;"><code class="reqn"> p(y(\mathbf{x}_0) \mid \mathbf{y}) = \int p(y(\mathbf{x}_0) \mid 
\boldsymbol \theta, \mathbf{y}) p(\boldsymbol \theta \mid \mathbf{y}) 
d \boldsymbol \theta,
</code>
</p>

<p>where <code class="reqn">\mathbf{y}:=(y(\mathbf{x}_1), \ldots, y(\mathbf{x}_n))^\top</code> is a vector of <code class="reqn">n</code> observations.
<code class="reqn">\boldsymbol \theta</code> contains correlation
parameters and nugget parameter. This predictive density should be understood as an update of the likelihood since data is treated as prior information now.
With a set of prediction locations <code class="reqn">\mathcal{X}:=\{x_0^i: i=1, \ldots, m\}</code>. 
The log pointwise predictive density (<strong>lppd</strong>) is defined as
</p>
<p style="text-align: center;"><code class="reqn">lppd = \sum_{i=1}^m \log p(y(\mathbf{x}_0^i) 
\mid \mathbf{y}).</code>
</p>
 
<p>The log joint predictive density (<strong>ljpd</strong>) is defined as 
</p>
<p style="text-align: center;"><code class="reqn">ljpd = \log p(y(\mathcal{X})). </code>
</p>

<p>The <code>lppd</code> is connected to cross-validation, while the <code>ljpd</code> measures joint uncertainty across prediction locations.

</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">gp.model.adequacy(
  obj,
  testing.input,
  testing.output,
  pointwise = TRUE,
  joint = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a <code>gp</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testing.input</code></td>
<td>
<p>a matrix of testing inputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testing.output</code></td>
<td>
<p>a vector of testing outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointwise</code></td>
<td>
<p>a logical value with default value <code>TRUE</code>. If it is
<code>TRUE</code>, <strong>lppd</strong> is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint</code></td>
<td>
<p>a logical value with default value <code>TRUE</code>. If it is
<code>TRUE</code>, <strong>ljpd</strong> is calculated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing <strong>pD</strong>, <strong>DIC</strong>, <strong>lppd</strong>, <strong>ljpd</strong>.
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>References</h3>


<ul><li>
<p>Gelman, Andrew, John B. Carlin, Hal S. Stern, David B. Dunson, 
Aki Vehtari, and Donald B. Rubin (2013). 
Bayesian Data Analysis, Third Edition. CRC Press.
</p>
</li></ul>
<h3>See Also</h3>

<p>GPBayes-package, <code>GaSP</code>, <code>gp</code>,
</p>


</div>