<div class="container">

<table style="width: 100%;"><tr>
<td>geno_to_char</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a genotype matrix from numeric to character codes</h2>

<h3>Description</h3>

<p>Given the genotype matrix <code>X</code> and <code>bim</code> table (as they are parsed by <code>read_plink()</code>, this outputs a matrix of the same dimensions as <code>X</code> but with the numeric codes (all values in 0, 1, 2) translated to human-readable character codes (such as 'A/A', 'A/G', 'G/G', depending on which are the two alleles at the locus as given in the <code>bim</code> table, see return value).
</p>


<h3>Usage</h3>

<pre><code class="language-R">geno_to_char(X, bim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The genotype matrix.
It must have values only in 0, 1, 2, and <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bim</code></td>
<td>
<p>The variant table.
It is required to have the same number of rows as <code>X</code>, and to have at least two named columns <code>alt</code> and <code>ref</code> (alleles 1 and 2 in a plink BIM table).
These alleles can be arbitrary strings (i.e. not just SNPs but also indels, any single or multicharacter code, or even blank strings) except the forward slash character ("/") is not allowed anywhere in these strings (function stops if a slash is present), since in the output it is the delimiter string.
<code>ref</code> and <code>alt</code> alleles must be different at each locus.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The genotype matrix reencoded as strings.
At one locus, if the two alleles (alt and ref) are 'A' and 'B', then the genotypes in the input are encoded as characters as: 0 -&gt; 'A/A', 1 -&gt; 'B/A', and 2 -&gt; 'B/B'.
Thus, the numeric encoding counts the reference allele dosage.
<code>NA</code> values in input <code>X</code> remain <code>NA</code> in the output.
If the input genotype matrix had row and column names, these are inherited by the output matrix.
</p>


<h3>See Also</h3>

<p><code>read_plink()</code>,
<code>read_bed()</code>,
<code>read_bim()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># a numeric/dosage genotype matrix with two loci (rows)
# and three individuals (columns)
X &lt;- rbind( 0:2, c(0, NA, 2) )
# corresponding variant table (minimal case with just two required columns)
library(tibble)
bim &lt;- tibble( alt = c('C', 'GT'), ref = c('A', 'G') )

# genotype matrix translated as characters
X_char &lt;- geno_to_char( X, bim )
X_char

</code></pre>


</div>