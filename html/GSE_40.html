<div class="container">

<table style="width: 100%;"><tr>
<td>GSE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Generalized S-Estimator in the presence of missing data</h2>

<h3>Description</h3>

<p>Computes the Generalized S-Estimate (GSE) – a robust estimate of location and scatter 
for data with contamination and missingness. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">GSE(x, tol=1e-4, maxiter=150, method=c("bisquare","rocke"), 
    init=c("emve","qc","huber","imputed","emve_c"), mu0, S0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame. May contain missing values, but cannot contain columns with completely missing entries. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for the convergence criterion. Default is 1e-4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations for the GSE algorithm. Default is 150.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>which loss function to use: 'bisquare', 'rocke'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>type of initial estimator. Currently this can either be "emve" (EMVE with uniform sampling, see Danilov et al., 2012),
"qc" (QC, see Danilov et al., 2012), "huber" (Huber Pairwise, see Danilov et al., 2012), 
"imputed" (Imputed S-estimator, see the rejoinder in Agostinelli et al., 2015), or
"emve_c" (EMVE_C with cluster sampling, see Leung and Zamar, 2016).
Default is "emve". If <code>mu0</code> and <code>S0</code> are provided, this argument is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>optional vector of initial location estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>optional matrix of initial scatter estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments for computing the initial estimates (see <code>emve</code>, <code>HuberPairwise</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes GSE (Danilov et al., 2012) and GRE (Leung and Zamar, 2016). The estimator requires a robust positive definite 
initial estimator. This initial estimator is required to “re-scale" the partial square mahalanobis distance for 
the different missing pattern, in which a single scale parameter is not enough. This function currently allows two 
main initial estimators: EMVE (the default; see <code>emve</code> and Huberized Pairwise 
(see <code>HuberPairwise</code>). GSE using Huberized Pairwise with sign psi function is referred to as QGSE in Danilov et al. (2012). 
Numerical results have shown that GSE with EMVE as 
initial has better performance (in both efficiency and robustness), but computing time can be longer. 
</p>


<h3>Value</h3>

<p>An S4 object of class <code>GSE-class</code> which is a subclass of the virtual class <code>CovRobMissSc-class</code>. The
output S4 object contains the following slots:
</p>

<table>
<tr>
<td style="text-align: left;">
        <code>mu</code> </td>
<td style="text-align: left;"> Estimated location. Can be accessed via <code>getLocation</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>S</code> </td>
<td style="text-align: left;"> Estimated scatter matrix. Can be accessed via <code>getScatter</code>. </td>
</tr>
<tr>
<td style="text-align: left;"> 
        <code>sc</code> </td>
<td style="text-align: left;"> Generalized S-scale (GS-scale). Can be accessed via <code>getScale</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>pmd</code> </td>
<td style="text-align: left;"> Squared partial Mahalanobis distances. Can be accessed via <code>getDist</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>pmd.adj</code> </td>
<td style="text-align: left;"> Adjusted squared partial Mahalanobis distances. Can be accessed via <code>getDistAdj</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>pu</code> </td>
<td style="text-align: left;"> Dimension of the observed entries for each case. Can be accessed via <code>getDim</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>mu0</code> </td>
<td style="text-align: left;"> Estimated initial location.</td>
</tr>
<tr>
<td style="text-align: left;">
        <code>S0</code> </td>
<td style="text-align: left;"> Estimated initial scatter matrix. </td>
</tr>
<tr>
<td style="text-align: left;"> 
        <code>ximp</code> </td>
<td style="text-align: left;"> Input data matrix with missing values imputed using best linear predictor. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>weights</code> </td>
<td style="text-align: left;"> Weights used in the estimation of the location. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>weightsp</code> </td>
<td style="text-align: left;"> First derivative of the weights used in the estimation of the location. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>iter</code> </td>
<td style="text-align: left;"> Number of iterations till convergence. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>eps</code> </td>
<td style="text-align: left;"> relative change of the GS-scale at convergence. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>call</code> </td>
<td style="text-align: left;"> Object of class <code>"language"</code>. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>x</code> </td>
<td style="text-align: left;"> Input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>p</code> </td>
<td style="text-align: left;"> Column dimension of input data matrix. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>estimator</code>
</td>
<td style="text-align: left;"> Character string of the name of the estimator used. Not meant to be accessed. </td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Ruben H. Zamar, Mike Danilov, Victor J. Yohai</p>


<h3>References</h3>

<p>Agostinelli, C., Leung, A. , Yohai, V.J., and Zamar, R.H. (2015) Robust estimation of multivariate location and scatter in the presence of cellwise and casewise contamination. <em>TEST</em>.
</p>
<p>Danilov, M., Yohai, V.J., Zamar, R.H. (2012). Robust Esimation of Multivariate
Location and Scatter in the Presence of Missing Data. <em>Journal of the American Statistical Association</em>
<b>107</b>, 1178–1186.
</p>
<p>Leung, A. and Zamar, R.H. (2016). Multivariate Location and Scatter Matrix Estimation Under Cellwise and Casewise Contamination.
Submitted.    
</p>


<h3>See Also</h3>

<p><code>emve</code>, <code>HuberPairwise</code>, <code>GSE-class</code>, <code>generate.casecontam</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(12)

## generate 10-dimensional data with 10% casewise contamination
n &lt;- 100
p &lt;- 10
A &lt;- matrix(0.9, p, p)
diag(A) &lt;- 1
x &lt;- generate.casecontam(n, p, cond=100, contam.size=10, contam.prop=0.1, A=A)$x

## introduce 5% missingness
pmiss &lt;- 0.05
nmiss &lt;- matrix(rbinom(n*p,1,pmiss), n,p)
x[ which( nmiss == 1 ) ] &lt;- NA

## Using EMVE as initial
res.emve &lt;- GSE(x)
slrt( getScatter(res.emve), A) ## LRT distances to the true covariance

## Using QC as initial
res.qc &lt;- GSE(x, init="qc")
slrt( getScatter(res.qc), A) ## in general performs worse than if EMVE used as initials

</code></pre>


</div>