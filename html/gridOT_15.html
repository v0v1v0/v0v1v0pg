<div class="container">

<table style="width: 100%;"><tr>
<td>transport_cost.numeric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimal Transport Cost</h2>

<h3>Description</h3>

<p>Calculate the optimal transport cost.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'numeric'
transport_cost(x, y, wx, wy, p = 1, sorted = FALSE, threshold = 1e-15, ...)

transport_cost(x, ...)

## S3 method for class 'otgridtransport'
transport_cost(x, threshold = 1e-15, ...)

## S3 method for class 'otgrid'
transport_cost(x, ...)

## S3 method for class 'data.frame'
transport_cost(x, costm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of points; a data frame with columns <code>from</code>, <code>to</code> and <code>mass</code> specifying the optimal transport plan;
an object of class <code>"otgridtransport"</code> or <code>"otgrid"</code>, in the latter case <code>...</code> must be
the arguments of <code>pivot_measure</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>second vector of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wx</code></td>
<td>
<p>weight vector of the first vector of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wy</code></td>
<td>
<p>weight vector of the second vector of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the power <code class="reqn">\geq 1</code> of the cost function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorted</code></td>
<td>
<p>logical value indicating whether or not <code>a</code> and <code>b</code> are sorted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>small value that indicates when a value is considered to be zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments (for <code>pivot_measure</code> if <code>x</code> is an object of class <code>"otgrid"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costm</code></td>
<td>
<p>cost matrix of the transport</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In case of two-dimensional grids, the pivot measure is used to calculate the optimal transport cost.
</p>
<p>For one-dimensional optimal transport, the cost function is given by <code class="reqn">c(x, y) = | x - y |^p</code>. In this case, the north-west-corner
algorithm is used.
</p>


<h3>Value</h3>

<p>the optimal transport cost or, in case of two-dimensional case, an object of class <code>"otgridtransport"</code> with element <code>cost</code> that contains it.
</p>


<h3>See Also</h3>

<p>pivot measure <code>pivot_measure</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## one-dimensional example
set.seed(1)
a &lt;- 1:5
wa &lt;- rep(1/5, 5)
b &lt;- 1:6
wb &lt;- runif(6)
wb &lt;- wb / sum(wb)
transport_cost(a, b, wa, wb, p = 1)

## two-dimensional example
x &lt;- otgrid(cbind(0:1, 1:0))
y &lt;- otgrid(cbind(1:0, 0:1))

# first calculate pivot manually
pm &lt;- pivot_measure(x, y)
pm &lt;- transport_cost(pm)
print(pm$cost)

# or just
pm2 &lt;- transport_cost(x, y)
print(pm2$cost)

# or from transport plan and cost matrix
costm &lt;- transport_costmat(pm)
tp &lt;- transport_df(pm)
print(transport_cost(tp$df, costm))
</code></pre>


</div>