<div class="container">

<table style="width: 100%;"><tr>
<td>ssllrm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Smoothing Spline Log-Linear Regression Models</h2>

<h3>Description</h3>

<p>Fit smoothing spline log-linear regression models.  The symbolic
model specification via <code>formula</code> follows the same rules as in
<code>lm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssllrm(formula, response, type=NULL, data=list(), weights, subset,
       na.action=na.omit, alpha=1, id.basis=NULL, nbasis=NULL,
       seed=NULL, random=NULL, prec=1e-7, maxiter=30, skip.iter=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Symbolic description of the model to be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>Formula listing response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>List specifying the type of spline for each variable.
See <code>mkterm</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional data frame containing the variables in the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of weights to be used in the
fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Function which indicates what should happen when
the data contain NAs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Parameter modifying GCV or Mallows' CL; larger absolute
values yield smoother fits; negative value invokes a stable and
more accurate GCV/CL evaluation algorithm but may take two to
five times as long.  Ignored when <code>method="m"</code> are
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.basis</code></td>
<td>
<p>Index designating selected "knots".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>Number of "knots" to be selected.  Ignored when
<code>id.basis</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed to be used for the random generation of "knots".
Ignored when <code>id.basis</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>Input for parametric random effects in nonparametric
mixed-effect models.  See <code>mkran</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>Precision requirement for internal iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for
internal iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip.iter</code></td>
<td>
<p>Flag indicating whether to use initial values of
theta and skip theta iteration.  See <code>ssanova</code> for
notes on skipping theta iteration.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model is specified via <code>formula</code> and <code>response</code>, where
<code>response</code> lists the response variables.  For example,
<code>ssllrm(~y1*y2*x,~y1+y2)</code> prescribe a model of the form
</p>
<p style="text-align: center;"><code class="reqn">
      log f(y1,y2|x) = g_{1}(y1) + g_{2}(y2) + g_{12}(y1,y2)
              + g_{x1}(x,y1) + g_{x2}(x,y2) + g_{x12}(x,y1,y2) + C(x)
    </code>
</p>

<p>with the terms denoted by <code>"y1"</code>, <code>"y2"</code>, <code>"y1:y2"</code>,
<code>"y1:x"</code>, <code>"y2:x"</code>, and <code>"y1:y2:x"</code>; the term(s) not
involving response(s) are removed and the constant <code>C(x)</code> is
determined by the fact that a conditional density integrates (adds)
to one on the <code>y</code> axis.
</p>
<p>The model terms are sums of unpenalized and penalized
terms. Attached to every penalized term there is a smoothing
parameter, and the model complexity is largely determined by the
number of smoothing parameters.
</p>
<p>A subset of the observations are selected as "knots."  Unless
specified via <code>id.basis</code> or <code>nbasis</code>, the number of
"knots" <code class="reqn">q</code> is determined by <code class="reqn">max(30,10n^{2/9})</code>, which is
appropriate for the default cubic splines for numerical vectors.
</p>


<h3>Value</h3>

<p><code>ssllrm</code> returns a list object of class <code>"ssllrm"</code>.
</p>
<p>The method <code>predict.ssllrm</code> can be used to evaluate
<code>f(y|x)</code> at arbitrary x, or contrasts of <code>log{f(y|x)}</code>
such as the odds ratio along with standard errors.  The method
<code>project.ssllrm</code> can be used to calculate the
Kullback-Leibler projection for model selection.
</p>


<h3>Note</h3>

<p>The responses, or y-variables, must be factors, and there must be at
least one numerical x's.  For <code>response</code>, there is no difference
between <code>~y1+y2</code> and <code>~y1*y2</code>.
</p>
<p>The results may vary from run to run. For consistency, specify
<code>id.basis</code> or set <code>seed</code>.
</p>


<h3>References</h3>

<p>Gu, C. and Ma, P. (2011), Nonparametric regression with
cross-classified responses.  <em>The Canadian Journal of
Statistics</em>, <b>39</b>, 591â€“609.
</p>
<p>Gu, C. (2014), Smoothing Spline ANOVA Models: R Package gss.
<em>Journal of Statistical Software</em>, 58(5), 1-25. URL
http://www.jstatsoft.org/v58/i05/.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate data
test &lt;- function(x)
        {.3*(1e6*(x^11*(1-x)^6)+1e4*(x^3*(1-x)^10))-2}
x &lt;- (0:100)/100
p &lt;- 1-1/(1+exp(test(x)))
y &lt;- rbinom(x,3,p)
y1 &lt;- as.ordered(y)
y2 &lt;- as.factor(rbinom(x,1,p))
## Fit model
fit &lt;- ssllrm(~y1*y2*x,~y1+y2)

## Evaluate f(y|x)
est &lt;- predict(fit,data.frame(x=x),
               data.frame(y1=as.factor(0:3),y2=as.factor(rep(0,4))))
## f(y|x) at all y values (fit$qd.pt)
est &lt;- predict(fit,data.frame(x=x))

## Evaluate contrast of log f(y|x)
est &lt;- predict(fit,data.frame(x=x),odds=c(-1,.5,.5,0),
               data.frame(y1=as.factor(0:3),y2=as.factor(rep(0,4))),se=TRUE)
## Odds ratio log{f(0,0|x)/f(3,0|x)}
est &lt;- predict(fit,data.frame(x=x),odds=c(1,-1),
               data.frame(y1=as.factor(c(0,3)),y2=as.factor(c(0,1))),se=TRUE)

## KL projection
kl &lt;- project(fit,include=c("y2:x","y1:y2","y1:x","y2:x"))

## Clean up
## Not run: rm(test,x,p,y,y1,y2,fit,est,kl)
dev.off()
## End(Not run)
</code></pre>


</div>