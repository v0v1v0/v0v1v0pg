<div class="container">

<table style="width: 100%;"><tr>
<td>GIRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate generalized impulse response function for
structural (and reduced form) GMVAR, StMVAR, and G-StMVAR models.</h2>

<h3>Description</h3>

<p><code>GIRF</code> estimates generalized impulse response function for
structural (and reduced form) GMVAR, StMVAR, and G-StMVAR models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GIRF(
  gsmvar,
  which_shocks,
  shock_size = 1,
  N = 30,
  R1 = 250,
  R2 = 250,
  init_regimes = 1:sum(gsmvar$model$M),
  init_values = NULL,
  which_cumulative = numeric(0),
  scale = NULL,
  scale_type = c("instant", "peak"),
  scale_horizon = N,
  ci = c(0.95, 0.8),
  include_mixweights = TRUE,
  ncores = 2,
  plot_res = TRUE,
  seeds = NULL,
  ...
)

## S3 method for class 'girf'
plot(x, add_grid = FALSE, margs, ...)

## S3 method for class 'girf'
print(x, ..., digits = 2, N_to_print)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gsmvar</code></td>
<td>
<p>an object of class <code>'gsmvar'</code>, typically created with <code>fitGSMVAR</code> or <code>GSMVAR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_shocks</code></td>
<td>
<p>a numeric vector of length at most <code class="reqn">d</code>
(<code>=ncol(data)</code>) and elements in <code class="reqn">1,...,d</code> specifying the
structural shocks for which the GIRF should be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shock_size</code></td>
<td>
<p>a non-zero scalar value specifying the common size for all scalar
components of the structural shock. Note that the conditional covariance
matrix of the structural shock is an identity matrix and that the
(generalized) impulse responses may not be symmetric to the sign and size
of the shock.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>a positive integer specifying the horizon how far ahead should the
generalized impulse responses be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R1</code></td>
<td>
<p>the number of repetitions used to estimate GIRF for each initial
value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>the number of initial values to be drawn from a stationary
distribution of the process or of a specific regime? The confidence bounds
will be sample quantiles of the GIRFs based on different initial values.
Ignored if the argument <code>init_value</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_regimes</code></td>
<td>
<p>a numeric vector of length at most <code class="reqn">M</code> and elements
in <code class="reqn">1,...,M</code> specifying the regimes from which the initial values
should be generated from. The initial values will be generated from a
mixture distribution with the mixture components being the stationary
distributions of the specific regimes and the (proportional) mixing weights
given by the mixing weight parameters of those regimes. Note that if
<code>init_regimes=1:M</code>, the initial values are generated from the
stationary distribution of the process and if <code>init_regimes=m</code>, the
initial value are generated from the stationary distribution of the
<code class="reqn">m</code>th regime. Ignored if the argument <code>init_values</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_values</code></td>
<td>
<p>a size <code class="reqn">(pxd)</code> matrix specifying the initial values, where d is the number
of time series in the system. The <strong>last</strong> row will be used as initial values for the first lag,
the second last row for second lag etc. If not specified, initial values will be drawn according to
mixture distribution specifed by the argument <code>init_regimes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_cumulative</code></td>
<td>
<p>a numeric vector with values in <code class="reqn">1,...,d</code>
(<code>d=ncol(data)</code>) specifying which the variables for which the impulse
responses should be cumulative. Default is none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>should the GIRFs to some of the shocks be scaled so that they
correspond to a specific magnitude of instantaneous or peak response
of some specific variable (see the argument <code>scale_type</code>)?
Provide a length three vector where the shock of interest
is given in the first element (an integer in <code class="reqn">1,...,d</code>), the variable of
interest is given in the second element (an integer in <code class="reqn">1,...,d</code>), and
the magnitude of its instantaneous or peak response in the third element
(a non-zero real number). If the GIRFs of multiple shocks should be scaled, provide
a matrix which has one column for each of the shocks with the columns being
the length three vectors described above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_type</code></td>
<td>
<p>If argument <code>scale</code> is specified, should the GIRFs be
scaled to match an instantaneous response (<code>"instant"</code>) or peak response
(<code>"peak"</code>). If <code>"peak"</code>, the scale is based on the largest magnitude
of peak response in absolute value. Ignored if <code>scale</code> is not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_horizon</code></td>
<td>
<p>If <code>scale_type == "peak"</code> what the maximum horizon up
to which peak response is expected? Scaling won't based on values after this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>a numeric vector with elements in <code class="reqn">(0, 1)</code> specifying the
confidence levels of the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_mixweights</code></td>
<td>
<p>should the generalized impulse response be
calculated for the mixing weights as well? <code>TRUE</code> or <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>the number CPU cores to be used in parallel computing. Only
single core computing is supported if an initial value is specified (and
the GIRF won't thus be estimated multiple times).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_res</code></td>
<td>
<p><code>TRUE</code> if the results should be plotted, <code>FALSE</code> if
not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seeds</code></td>
<td>
<p>a length <code>R2</code> vector containing the random number generator
seed for estimation of each GIRF. A single number of an initial value is
specified. or <code>NULL</code> for not initializing the seed. Exists for
creating reproducible results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>grid</code> which plots grid to the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>'girf'</code> generated by the function <code>GIRF</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_grid</code></td>
<td>
<p>should grid be added to the plots?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margs</code></td>
<td>
<p>numeric vector of length four that adjusts the
<code>[bottom_marginal, left_marginal, top_marginal, right_marginal]</code>
as the relative sizes of the marginals to the figures of the responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of decimals to print</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_to_print</code></td>
<td>
<p>an integer specifying the horizon how far to print the estimates and
confidence intervals. The default is that all the values are printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model DOES NOT need to be structural in order for this function to be
applicable. When an identified structural GMVAR, StMVAR, or G-StMVAR model is
provided in the argument <code>gsmvar</code>, the identification imposed by the model
is used. When a reduced form model is provided in the argument <code>gsmvar</code>,
lower triangular Cholesky identification is used to identify the shocks.
</p>
<p>The confidence bounds reflect uncertainty about the initial state (but
currently not about the parameter estimates) if initial values are not
specified. If initial values are specified, there won't currently be
confidence intervals. See the cited paper by Virolainen (2022) for details
about the algorithm.
</p>
<p>Note that if the argument <code>scale</code> is used, the scaled responses of
the mixing weights might be more than one in absolute value.
</p>


<h3>Value</h3>

<p>Returns a class <code>'girf'</code> list with the GIRFs in the first
element (<code>$girf_res</code>) and the used arguments the rest. The first
element containing the GIRFs is a list with the <code class="reqn">m</code>th element
containing the point estimates for the GIRF in <code>$point_est</code> (the first
element) and confidence intervals in <code>$conf_ints</code> (the second
element). The first row is for the GIRF at impact <code class="reqn">(n=0)</code>, the second
for <code class="reqn">n=1</code>, the third for <code class="reqn">n=2</code>, and so on.
</p>
<p>The element <code>$all_girfs</code> is a list containing results from all the individual GIRFs
obtained from the MC repetitions. Each element is for one shock and results are in
array of the form <code>[horizon, variables, MC-repetitions]</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>plot(girf)</code>: plot method
</p>
</li>
<li> <p><code>print(girf)</code>: print method
</p>
</li>
</ul>
<h3>References</h3>


<ul>
<li>
<p> Kalliovirta L., Meitz M. and Saikkonen P. 2016. Gaussian mixture vector autoregression.
<em>Journal of Econometrics</em>, <strong>192</strong>, 485-498.
</p>
</li>
<li>
<p> Virolainen S. (forthcoming). A statistically identified structural vector autoregression with endogenously
switching volatility regime. <em>Journal of Business &amp; Economic Statistics</em>.
</p>
</li>
<li>
<p> Virolainen S. 2022. Gaussian and Student's t mixture vector autoregressive model with application to the
asymmetric effects of monetary policy shocks in the Euro area. Unpublished working
paper, available as arXiv:2109.13648.
</p>
</li>
</ul>
<p>@keywords internal
</p>


<h3>See Also</h3>

<p><code>GFEVD</code>, <code>linear_IRF</code>, <code>fitGSMVAR</code>, <code>GSMVAR</code>,
<code>gsmvar_to_sgsmvar</code>, <code>reorder_W_columns</code>,
<code>swap_W_signs</code>, <code>simulate.gsmvar</code>,
<code>predict.gsmvar</code>, <code>profile_logliks</code>,
<code>quantile_residual_tests</code>, <code>LR_test</code>,
<code>Wald_test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
 # These are long-running examples that use parallel computing.
 # It takes approximately 30 seconds to run all the below examples.

 ## StMVAR(1, 2), d=2 model identified recursively by lower-triangular
 ## Cholesky decomposition (i.e., reduced form model is specified):
 params12t &lt;- c(0.55, 0.11, 0.34, 0.05, -0.01, 0.72, 0.58, 0.01, 0.06, 0.17,
   0.25, 0.34, 0.05, -0.01, 0.72, 0.50, -0.01, 0.20, 0.60, 3.00, 12.00)
 mod12t &lt;- GSMVAR(gdpdef, p=1, M=2, params=params12t, model="StMVAR")

 # Estimating the GIRFs of both structural shocks with initial values
 # drawn from the stationary distribution of the process,
 # 12 periods ahead, confidence levels 0.95 and 0.8:
 girf0 &lt;- GIRF(mod12t, N=12, R1=100, R2=100)
 girf0
 plot(girf0)
 ## NOTE: Small R1 and R2 is used here to shorten the estimation time.
 ## Larger R1 and R2 should be considered in empirical applications!

 ## Structural GMVAR(2, 2), d=2 model identified with sign-constraints:
 params22s &lt;- c(0.36, 0.121, 0.484, 0.072, 0.223, 0.059, -0.151, 0.395,
  0.406, -0.005, 0.083, 0.299, 0.218, 0.02, -0.119, 0.722, 0.093, 0.032,
   0.044, 0.191, 0.057, 0.172, -0.46, 0.016, 3.518, 5.154, 0.58)
 W_22 &lt;- matrix(c(1, 1, -1, 1), nrow=2, byrow=FALSE)
 mod22s &lt;- GSMVAR(gdpdef, p=2, M=2, params=params22s,
  structural_pars=list(W=W_22))
 mod22s
 # Alternatively, use:
 #fit22s &lt;- fitGSMVAR(gdpdef, p=2, M=2, structural_pars=list(W=W_22),
 #                   ncalls=20, seeds=1:20)
 # To obtain an estimated version of the same model.

 # Estimating the GIRFs of both structural shocks with initial values
 # drawn from the stationary distribution of the process,
 # 12 periods ahead, confidence levels 0.95 and 0.8:
 girf1 &lt;- GIRF(mod22s, N=12, R1=100, R2=100)
 girf1
 plot(girf1)

 # Estimating the GIRF of the second shock only, 12 periods ahead
 # and shock size 1, initial values drawn from the stationary distribution
 # of the first regime, confidence level 0.9:
 girf2 &lt;- GIRF(mod22s, which_shocks=2, shock_size=1, N=12, init_regimes=1,
               ci=0.9, R1=100, R2=100)

 # Estimating the GIRFs of both structural shocks, negative one standard
 # error shock, N=20 periods ahead, estimation based on 200 Monte Carlo
 # simulations, and fixed initial values given by the last p observations
 # of the data:
 girf3 &lt;- GIRF(mod22s, shock_size=-1, N=20, R1=200,
               init_values=mod22s$data)
 
</code></pre>


</div>