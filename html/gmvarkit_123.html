<div class="container">

<table style="width: 100%;"><tr>
<td>simulate.gsmvar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate method for class 'gsmvar' objects</h2>

<h3>Description</h3>

<p><code>simulate.gsmvar</code> is a simulate method for class 'gsmvar' objects.
It allows to simulate observations from a GMVAR, StMVAR, or G-StMVAR process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gsmvar'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  ...,
  init_values = NULL,
  init_regimes = 1:sum(gsmvar$model$M),
  ntimes = 1,
  drop = TRUE,
  girf_pars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>'gsmvar'</code>, typically created with <code>fitGSMVAR</code> or <code>GSMVAR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of observations to be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>set seed for the random number generator?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently not in use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_values</code></td>
<td>
<p>a size <code class="reqn">(pxd)</code> matrix specifying the initial values, where d is the number
of time series in the system. The <strong>last</strong> row will be used as initial values for the first lag,
the second last row for second lag etc. If not specified, initial values will be drawn according to
mixture distribution specifed by the argument <code>init_regimes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_regimes</code></td>
<td>
<p>a numeric vector of length at most <code class="reqn">M</code> and elements
in <code class="reqn">1,...,M</code> specifying the regimes from which the initial values
should be generated from. The initial values will be generated from a
mixture distribution with the mixture components being the stationary
distributions of the specific regimes and the (proportional) mixing weights
given by the mixing weight parameters of those regimes. Note that if
<code>init_regimes=1:M</code>, the initial values are generated from the
stationary distribution of the process and if <code>init_regimes=m</code>, the
initial value are generated from the stationary distribution of the
<code class="reqn">m</code>th regime. Ignored if the argument <code>init_values</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntimes</code></td>
<td>
<p>how many sets of simulations should be performed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>if <code>TRUE</code> (default) then the components of the returned list are coerced to lower dimension if <code>ntimes==1</code>, i.e.,
<code>$sample</code> and <code>$mixing_weights</code> will be matrices, and <code>$component</code> will be vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>girf_pars</code></td>
<td>
<p>This argument is used internally in the estimation of generalized impulse response functions (see <code>?GIRF</code>).
You should ignore it (specifying something else than null to it will change how the function behaves).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>ntimes</code> is intended for forecasting: a GMVAR, StMVAR, or G-StMVAR process can be forecasted by simulating
its possible future values. One can easily perform a large number simulations and calculate the sample quantiles from the simulated
values to obtain prediction intervals (see the forecasting example).
</p>


<h3>Value</h3>

<p>If <code>drop==TRUE</code> and <code>ntimes==1</code> (default): <code>$sample</code>, <code>$component</code>, and <code>$mixing_weights</code> are matrices.
Otherwise, returns a list with...
</p>

<dl>
<dt><code>$sample</code></dt>
<dd>
<p>a size (<code>nsim</code><code class="reqn"> x d x </code><code>ntimes</code>) array containing the samples: the dimension <code>[t, , ]</code> is
the time index, the dimension <code>[, d, ]</code> indicates the marginal time series, and the dimension <code>[, , i]</code> indicates
the i:th set of simulations.</p>
</dd>
<dt><code>$component</code></dt>
<dd>
<p>a size (<code>nsim</code><code class="reqn"> x </code><code>ntimes</code>) matrix containing the information from which mixture component
each value was generated from.</p>
</dd>
<dt><code>$mixing_weights</code></dt>
<dd>
<p>a size (<code>nsim</code><code class="reqn"> x M x </code><code>ntimes</code>) array containing the mixing weights corresponding to
the sample: the dimension <code>[t, , ]</code> is the time index, the dimension <code>[, m, ]</code> indicates the regime, and the dimension
<code>[, , i]</code> indicates the i:th set of simulations.</p>
</dd>
</dl>
<h3>References</h3>


<ul>
<li>
<p> Kalliovirta L., Meitz M. and Saikkonen P. 2016. Gaussian mixture vector autoregression.
<em>Journal of Econometrics</em>, <strong>192</strong>, 485-498.
</p>
</li>
<li>
<p> LÃ¼tkepohl H. 2005. New Introduction to Multiple Time Series Analysis,
<em>Springer</em>.
</p>
</li>
<li>
<p> McElroy T. 2017. Computation of vector ARMA autocovariances.
<em>Statistics and Probability Letters</em>, <strong>124</strong>, 92-96.
</p>
</li>
<li>
<p> Virolainen S. (forthcoming). A statistically identified structural vector autoregression with endogenously
switching volatility regime. <em>Journal of Business &amp; Economic Statistics</em>.
</p>
</li>
<li>
<p> Virolainen S. 2022. Gaussian and Student's t mixture vector autoregressive model with application to the
asymmetric effects of monetary policy shocks in the Euro area. Unpublished working
paper, available as arXiv:2109.13648.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>fitGSMVAR</code>, <code>GSMVAR</code>, <code>diagnostic_plot</code>, <code>predict.gsmvar</code>,
<code>profile_logliks</code>, <code>quantile_residual_tests</code>, <code>GIRF</code>, <code>GFEVD</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # GMVAR(1,2), d=2 process, initial values from the stationary
 # distribution
 params12 &lt;- c(0.55, 0.112, 0.344, 0.055, -0.009, 0.718, 0.319, 0.005,
  0.03, 0.619, 0.173, 0.255, 0.017, -0.136, 0.858, 1.185, -0.012, 0.136,
  0.674)
 mod12 &lt;- GSMVAR(p=1, M=2, d=2, params=params12)
 set.seed(1)
 sim12 &lt;- simulate(mod12, nsim=500)
 plot.ts(sim12$sample)
 ts.plot(sim12$mixing_weights, col=c("blue", "red"), lty=2)
 plot(sim12$component, type="l")

 # StMVAR(2, 2), d=2 model
 params22t &lt;- c(0.554, 0.033, 0.184, 0.005, -0.186, 0.683, 0.256, 0.031,
  0.026, 0.204, 0.583, -0.002, 0.048, 0.697, 0.154, 0.049, 0.374, 0.476,
   0.318, -0.645, -0.302, -0.222, 0.193, 0.042, -0.013, 0.048, 0.818,
    4.334, 20)
 mod22t &lt;- GSMVAR(gdpdef, p=2, M=2, params=params22t, model="StMVAR")
 sim22t &lt;- simulate(mod22t, nsim=100)
 plot.ts(sim22t$mixing_weights)

 ## FORECASTING EXAMPLE ##
 # Forecast 5-steps-ahead, 500 sets of simulations with initial
 # values from the data:
 # GMVAR(2,2), d=2 model
 params22 &lt;- c(0.36, 0.121, 0.223, 0.059, -0.151, 0.395, 0.406, -0.005,
  0.083, 0.299, 0.215, 0.002, 0.03, 0.484, 0.072, 0.218, 0.02, -0.119,
   0.722, 0.093, 0.032, 0.044, 0.191, 1.101, -0.004, 0.105, 0.58)
 mod22 &lt;- GSMVAR(gdpdef, p=2, M=2, params=params22)
 sim22 &lt;- simulate(mod22, nsim=5, ntimes=500)

 # Point forecast + 95% prediction intervals:
 apply(sim22$sample, MARGIN=1:2, FUN=quantile, probs=c(0.025, 0.5, 0.972))

 # Similar forecast for the mixing weights:
 apply(sim22$mixing_weights, MARGIN=1:2, FUN=quantile,
       probs=c(0.025, 0.5, 0.972))
</code></pre>


</div>