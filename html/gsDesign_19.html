<div class="container">

<table style="width: 100%;"><tr>
<td>gsBound</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Boundary derivation - low level</h2>

<h3>Description</h3>

<p><code>gsBound()</code> and <code>gsBound1()</code> are lower-level functions used to
find boundaries for a group sequential design. They are not recommended
(especially <code>gsBound1()</code>) for casual users. These functions do not
adjust sample size as <code>gsDesign()</code> does to ensure appropriate power for
a design.
</p>
<p><code>gsBound()</code> computes upper and lower bounds given boundary crossing
probabilities assuming a mean of 0, the usual null hypothesis.
<code>gsBound1()</code> computes the upper bound given a lower boundary, upper
boundary crossing probabilities and an arbitrary mean (<code>theta</code>).
</p>
<p>The function <code>gsBound1()</code> requires special attention to detail and
knowledge of behavior when a design corresponding to the input parameters
does not exist.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsBound(I, trueneg, falsepos, tol = 1e-06, r = 18, printerr = 0)

gsBound1(theta, I, a, probhi, tol = 1e-06, r = 18, printerr = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>Vector containing statistical information planned at each analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trueneg</code></td>
<td>
<p>Vector of desired probabilities for crossing upper bound
assuming mean of 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>falsepos</code></td>
<td>
<p>Vector of desired probabilities for crossing lower bound
assuming mean of 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance for error (scalar; default is 0.000001). Normally this
will not be changed by the user.  This does not translate directly to number
of digits of accuracy, so use extra decimal places.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Single integer value controlling grid for numerical integration as
in Jennison and Turnbull (2000); default is 18, range is 1 to 80.  Larger
values provide larger number of grid points and greater accuracy.  Normally
<code>r</code> will not be changed by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printerr</code></td>
<td>
<p>If this scalar argument set to 1, this will print messages
from underlying C program.  Mainly intended to notify user when an output
solution does not match input specifications.  This is not intended to stop
execution as this often occurs when deriving a design in <code>gsDesign</code>
that uses beta-spending.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Scalar containing mean (drift) per unit of statistical
information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Vector containing lower bound that is fixed for use in
<code>gsBound1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probhi</code></td>
<td>
<p>Vector of desired probabilities for crossing upper bound
assuming mean of theta.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Both routines return a list. Common items returned by the two
routines are: </p>
<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The length of vectors input; a scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>As input in <code>gsBound1()</code>; 0 for <code>gsBound()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>As input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>For <code>gsbound1</code>, this is as input. For
<code>gsbound</code> this is the derived lower boundary required to yield the
input boundary crossing probabilities under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>The derived upper boundary required to yield the input boundary
crossing probabilities under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>As input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>As input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>Error code. 0 if no error; greater than 0
otherwise.</p>
</td>
</tr>
</table>
<p><code>gsBound()</code> also returns the following items: </p>
<table>
<tr style="vertical-align: top;">
<td><code>rates</code></td>
<td>
<p>a list
containing two items:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>falsepos</code></td>
<td>
<p>vector of upper boundary crossing
probabilities as input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trueneg</code></td>
<td>
<p>vector of lower boundary crossing
probabilities as input.</p>
</td>
</tr>
</table>
<p><code>gsBound1()</code> also returns the following items: </p>
<table>
<tr style="vertical-align: top;">
<td><code>problo</code></td>
<td>
<p>vector of
lower boundary crossing probabilities; computed using input lower bound and
derived upper bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probhi</code></td>
<td>
<p>vector of upper boundary crossing
probabilities as input.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The gsDesign technical manual is available at
<a href="https://keaven.github.io/gsd-tech-manual/">https://keaven.github.io/gsd-tech-manual/</a>.
</p>


<h3>Author(s)</h3>

<p>Keaven Anderson <a href="mailto:keaven_anderson@merck.com">keaven_anderson@merck.com</a>
</p>


<h3>References</h3>

<p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>vignette("gsDesignPackageOverview")</code>, <code>gsDesign</code>,
<code>gsProbability</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# set boundaries so that probability is .01 of first crossing
# each upper boundary and .02 of crossing each lower boundary
# under the null hypothesis
x &lt;- gsBound(
  I = c(1, 2, 3) / 3, trueneg = rep(.02, 3),
  falsepos = rep(.01, 3)
)
x

#  use gsBound1 to set up boundary for a 1-sided test
x &lt;- gsBound1(
  theta = 0, I = c(1, 2, 3) / 3, a = rep(-20, 3),
  probhi = c(.001, .009, .015)
)
x$b

# check boundary crossing probabilities with gsProbability
y &lt;- gsProbability(k = 3, theta = 0, n.I = x$I, a = x$a, b = x$b)$upper$prob

#  Note that gsBound1 only computes upper bound
#  To get a lower bound under a parameter value theta:
#      use minus the upper bound as a lower bound
#      replace theta with -theta
#      set probhi as desired lower boundary crossing probabilities
#  Here we let set lower boundary crossing at 0.05 at each analysis
#  assuming theta=2.2
y &lt;- gsBound1(
  theta = -2.2, I = c(1, 2, 3) / 3, a = -x$b,
  probhi = rep(.05, 3)
)
y$b

#  Now use gsProbability to look at design
#  Note that lower boundary crossing probabilities are as
#  specified for theta=2.2, but for theta=0 the upper boundary
#  crossing probabilities are smaller than originally specified
#  above after first interim analysis
gsProbability(k = length(x$b), theta = c(0, 2.2), n.I = x$I, b = x$b, a = -y$b)
</code></pre>


</div>