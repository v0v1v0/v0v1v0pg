<div class="container">

<table style="width: 100%;"><tr>
<td>glm.fit2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generalized Linear Models Fitting Method
</h2>

<h3>Description</h3>

<p><code>glm.fit2</code> is identical to <code>glm.fit</code> in the <b>stats</b> package, except for a modification to the computational method that provides improved convergence properties. It is the default fitting method for <code>glm2</code> and can also be used as an alternative fitting method for <code>glm</code>, instead of the default method <code>glm.fit</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm.fit2(x, y, weights = rep(1, nobs), start = NULL, 
    etastart = NULL, mustart = NULL, offset = rep(0, nobs), 
    family = gaussian(), control = list(), intercept = TRUE,
    singular.ok = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etastart</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mustart</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>

<p>as for <code>glm.fit</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>glm.fit2</code> is a modified version of <code>glm.fit</code> in the <b>stats</b> package. The computational method in <code>glm.fit2</code> uses a stricter form of step-halving to deal with numerical instability in the iteratively reweighted least squares algorithm. Whereas <code>glm.fit</code> uses step-halving to correct divergence and parameter space violations, <code>glm.fit2</code> additionally uses step-halving to force the model deviance to decrease at each iteration, which improves the convergence properties. Like <code>glm.fit</code>, <code>glm.fit2</code> usually would not be called directly. Instead, it is called by <code>glm2</code> as the default fitting method. Like <code>glm.fit</code>, it is possible to call <code>glm.fit2</code> directly if the response vector and design matrix have already been calculated, in which case it may be more efficient than calling <code>glm2</code>. It can also be passed to <code>glm</code> in the <b>stats</b> package, using the <code>method</code> argument, providing an alternative to the default fitting method <code>glm.fit</code>. See Marschner (2011) for a discussion of the need for a modified fitting method.
</p>


<h3>Value</h3>

<p>The value returned by <code>glm.fit2</code> has exactly the same documentation as the value returned by <code>glm.fit</code>.
</p>


<h3>Author(s)</h3>

<p><code>glm.fit2</code> uses the code from <code>glm.fit</code>, whose authors are listed in the help documentation for the <b>stats</b> package. Modifications to this code were made by Ian Marschner.
</p>


<h3>References</h3>

<p>Marschner, I.C. (2011) glm2: Fitting generalized linear models with convergence problems. The R Journal, Vol. 3/2, pp.12-15.
</p>


<h3>See Also</h3>

<p><code>glm.fit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(glm2)

#--- logistic regression null model ---------------#
# (intercept estimate = log(0.75/0.25) = 1.098612)

y &lt;- c(1,1,1,0)
x &lt;- rep(1,4)

#--- divergence of glm.fit to infinite estimate ---#
fit1 &lt;- glm.fit(x,y, family=binomial(link="logit"),start=-1.81)
fit2 &lt;- glm.fit2(x,y, family=binomial(link="logit"),start=-1.81)
print.noquote(c(fit1$coef,fit2$coef))

</code></pre>


</div>