<div class="container">

<table style="width: 100%;"><tr>
<td>graphGOspecies</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Undirected network representation  for the results of functional
enrichment analysis for one species</h2>

<h3>Description</h3>

<p>graphGOspecies is a function to create undirected graphs using two options:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
<p>Categories option:
</p>
<p>The nodes \((V)\) represent groups of gene lists (categories), and the edges \((E)\) represent GO terms co-occurring between pairs of categories. More specifically,
Two categories: \(u,v \epsilon V \) are connected by an edge \(e=(u,v)\).the edge weights \(w(e)\) are defined as the ratio of the number of GO terms co-occurring
between two categories. Edge weights w(e) are defined as the ratio of the number of GO terms (e.g. biological processes) co-occurring between two categories
\(BP_{u} \ n  BP_{v}\) compared to the total number of GO terms available.
A node weight \(K_{w}(u)\) is defined as the sum of the edge weights where the node u is a participant. Thus, the node weight represents how frequently
GO terms are reported and expressed in a biological phenomenon.
</p>
\[w(e) = \frac{\mid BP_{u} n {BP_{v}}\mid}{\mid BP\mid}\]<p> (1)
</p>
\[K_{w} = \sum_{{v} \epsilon {V}}{w(u,v)}\]<p> (2)
</p>
<p>GO option:
</p>
<p>The nodes \({V}\) represent GO terms and the edges \({E}'\) represent categories where a pair of GO terms co-occur. More specifically,
two GO terms are connected by an edge \({e}'=({u},{v}')\). the edge weight \({w}'({e}')\) corresponds to the number of categories co-occurring
the GO terms \({u}\) and \({v}'\),compared with the total number of GO terms (Equation 3). A node weight \({K}'_w({u}')\) is defined,in this case the weight
represents the importance of a GO term (more frequent co-occurring).(Please be patient, it requires a long time to finish).
</p>
\[{w}'({e}')=\frac{\mid{Cu}'\cap  {Cv}'\mid}{\mid BP \mid}\]<p> (3)
</p>
\[{K}'_w({u}')=\sum_{{v}'\epsilon {V}'}{{w}'({u}',{v}')}\]<p> (4)
</p>


<h3>Usage</h3>

<pre><code class="language-R">graphGOspecies(
  df,
  GOterm_field,
  option = "Categories",
  numCores = 2,
  saveGraph = FALSE,
  outdir = NULL,
  filename = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>A data frame with the results of a functional enrichment analysis for
a species with an extra column "feature" with the features to be compared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GOterm_field</code></td>
<td>
<p>This is a string with the column name of the GO terms (e.g: "Functional.Category")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>
<p>(values: "GO" or "Categories"). This option allows create either a graph where nodes are GO terms and edges are features or alternatively
a graph where nodes are features and edges are GO terms (default value="Categories")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numCores</code></td>
<td>
<p>numeric, Number of cores to use for the process (default value numCores=2). For the example below, only one core will be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveGraph</code></td>
<td>
<p>logical, if <code>TRUE</code> the function will allow save the graph in graphml format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outdir</code></td>
<td>
<p>This parameter will allow save the graph file in a folder described here (e.g: "D:").This parameter only
works when saveGraph=TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>The name of the graph filename to be saved in the outdir detailed by the user.This parameter only
works when saveGraph=TRUE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function will return a list with two slots: edges and nodes.
</p>
<p>(Categories):
Edges list columns:
</p>

<table>
<tr>
<td style="text-align: right;">
  Column </td>
<td style="text-align: right;"> Description </td>
</tr>
<tr>
<td style="text-align: right;">
  SOURCE and TARGET </td>
<td style="text-align: right;"> The source and target categories (Nodes in the edge) </td>
</tr>
<tr>
<td style="text-align: right;">
  FEATURES_N </td>
<td style="text-align: right;"> The number of GO terms between the categories </td>
</tr>
<tr>
<td style="text-align: right;">
  WEIGHT </td>
<td style="text-align: right;"> Edge weight </td>
</tr>
<tr>
<td style="text-align: right;">
  FEATURES </td>
<td style="text-align: right;"> GO terms available for both nodes </td>
</tr>
<tr>
<td style="text-align: right;">
  </td>
</tr>
</table>
<p>Node list columns:
</p>

<table>
<tr>
<td style="text-align: right;">
  Column </td>
<td style="text-align: right;"> Description </td>
</tr>
<tr>
<td style="text-align: right;">
  feature</td>
<td style="text-align: right;"> Category name </td>
</tr>
<tr>
<td style="text-align: right;">
  GO_count  </td>
<td style="text-align: right;"> GO terms counts for the node </td>
</tr>
<tr>
<td style="text-align: right;">
  WEIGHT  </td>
<td style="text-align: right;"> Node weight </td>
</tr>
<tr>
<td style="text-align: right;">
  </td>
</tr>
</table>
<p>(GO):
</p>
<p>Edges list columns:
</p>

<table>
<tr>
<td style="text-align: right;">
  Column </td>
<td style="text-align: right;"> Description </td>
</tr>
<tr>
<td style="text-align: right;">
  SOURCE and TARGET </td>
<td style="text-align: right;"> The source and target GO terms (Nodes in the edge) </td>
</tr>
<tr>
<td style="text-align: right;">
  FEATURE </td>
<td style="text-align: right;"> The number of Categories where both GO Terms were found </td>
</tr>
<tr>
<td style="text-align: right;">
  WEIGHT </td>
<td style="text-align: right;"> Edge weight </td>
</tr>
<tr>
<td style="text-align: right;">
  </td>
</tr>
</table>
<p>Node list columns:
</p>

<table>
<tr>
<td style="text-align: right;">
  Column </td>
<td style="text-align: right;"> Description </td>
</tr>
<tr>
<td style="text-align: right;">
  GO </td>
<td style="text-align: right;"> GO term node name </td>
</tr>
<tr>
<td style="text-align: right;">
  GO_WEIGHT </td>
<td style="text-align: right;"> Node weight </td>
</tr>
<tr>
<td style="text-align: right;">
  </td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
#Loading example datasets
data(H_sapiens_compress)

GOterm_field &lt;- "Functional_Category"

#Running function
x &lt;- graphGOspecies(df=H_sapiens_compress,
                     GOterm_field=GOterm_field,
                     option = "Categories",
                     numCores=1,
                     saveGraph=FALSE,
                     outdir = NULL,
                     filename=NULL)

</code></pre>


</div>