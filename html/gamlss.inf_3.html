<div class="container">

<table style="width: 100%;"><tr>
<td>centiles.Inf0to1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting centile curves for a <code>gamlssInf0to1</code> and  <code>gamlssZadj</code> object </h2>

<h3>Description</h3>

<p>Function <code>centiles.Inf0to1()</code> plots centile curves for distributions belonging to the GAMLSS family of distributions defined in the intervals (0,1],[0,1) and [0,1].  
The function also tabulates the sample percentages below each centile curve (for comparison with the model percentages given by the argument <code>cent</code>).
A restriction of the function is that it applies to models with one explanatory variable only.    
</p>


<h3>Usage</h3>

<pre><code class="language-R">centiles.Inf0to1(obj, xvar = NULL, cent = c(0.4, 2, 10, 25, 50, 75, 
    90, 98, 99.6), legend = TRUE, ylab = "y", xlab = "x", main = NULL, 
    main.gsub = "@", xleg = min(xvar), yleg = max(obj$y), xlim = range(xvar), 
    ylim = range(obj$y), save = FALSE, plot = TRUE, points = TRUE, 
    pch = 15, cex = 0.5, col = gray(0.7), col.centiles = 1:length(cent) + 
        2, lty.centiles = 1, lwd.centiles = 1, ...)
centiles.Zadj(obj, xvar = NULL, cent = c(0.4, 2, 10, 25, 50, 75, 
   90, 98, 99.6), legend = TRUE, ylab = "y", xlab = "x", main = NULL, 
   main.gsub = "@", xleg = min(xvar), yleg = max(obj$y), xlim = range(xvar), 
   ylim = range(obj$y), save = FALSE, plot = TRUE, points = TRUE, 
   pch = 15, cex = 0.5, col = gray(0.7), col.centiles = 1:length(cent) + 
   2, lty.centiles = 1, lwd.centiles = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a fitted gamlss object from fitting a gamlss distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>the unique explanatory variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cent</code></td>
<td>
<p>a vector with elements the % centile values for which the centile curves have to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>whether a legend is required in the plot or not, the default is <code>legent=TRUE</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>the y-variable label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>the x-variable label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>the main title here as character. 
If NULL the default title "centile curves using  NO" (or the relevant distributions name) is shown</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.gsub</code></td>
<td>
<p>if the <code>main.gsub</code> (with default "@") appears in the <code>main</code> 
title then it is substituted with the default title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xleg</code></td>
<td>
<p>position of the legend in the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yleg</code></td>
<td>
<p>position of the legend in the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>the limits of the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the limits of the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>
<p>whether to save the sample percentages or not with default equal to <code>FALSE</code>. 
In this case the sample percentages are printed but are not saved </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to plot the centiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>whether the data points should be plotted, default is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>the character to be used as the default in plotting points see <code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>size of  character see <code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>plotting colour see <code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.centiles</code></td>
<td>
<p>Plotting colours  for the centile curves</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.centiles</code></td>
<td>
<p>line type for the centile curves</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.centiles</code></td>
<td>
<p>The line width for the centile curves</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Centiles are calculated using the fitted values in <code>obj</code> and <code>xvar</code> must
correspond exactly to the predictor in <code>obj</code> to plot correctly.
</p>
<p><code>col.centiles</code>, <code>lty.centiles</code> and <code>lwd.centiles</code> may be vector arguments
and are recycled to the length <code>cent</code> if necessary.
</p>


<h3>Value</h3>

<p>A centile plot is produced and the sample centiles below each centile curve are printed (or saved)
</p>


<h3>Warning </h3>

<p>This function is appropriate only when one continuous explanatory variable is fitted in the model</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:mikis.stasinopoulos@gamlss.org">mikis.stasinopoulos@gamlss.org</a>, Bob Rigby <a href="mailto:r.rigby@londonmet.ac.uk">r.rigby@londonmet.ac.uk</a> with contribution from Steve Ellison</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2006) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>). 
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>
<p>Houssain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. Accepted for publication on <em>Statistics in Medicine</em>.  <br></p>


<h3>See Also</h3>

  <p><code>gamlssInf0to1</code>, <code>gamlss</code>, <code>centiles.split</code> , <code>centiles.com</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
gen.Family("SST", "logit")
gen.Inf0to1("logitSST","One") 
set.seed(30)
x &lt;- seq(0,1,l=2000)
dat &lt;- data.frame(x)
dat$Y &lt;- rlogitSSTInf1(2000,mu=-3+10*x-0.7*x^2,sigma=0.9,nu=0.5,
                       tau=5,xi1=plogis(-0.5*ifelse(x&gt;0.7,-1,13)),log=FALSE)

m1 &lt;- gamlssInf0to1(y=Y,mu.formula=~pb(x), sigma.formula=~pb(x),
                    nu.formula=~pb(x), tau.formula=~pb(x),
                    xi1.formula=~pb(x),
                    data=dat, family=logitSST)

centiles.Inf0to1(m1,xvar= dat$x, cent=c(2,10,25,50,75,90,98),
col.centiles=c(1,7:2),
ylab="proportion", xlab="x",legend=FALSE,main="(c) Inf. logitSST")

## End(Not run)
</code></pre>


</div>