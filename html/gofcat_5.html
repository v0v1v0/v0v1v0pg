<div class="container">

<table style="width: 100%;"><tr>
<td>lipsitz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lipsitz Test for Categorical Response Models</h2>

<h3>Description</h3>

<p>This provides a post estimation goodness-of-fit test for
the ordinal response models. Supported models include the proportional odds,
adjacent-category, and constrained continuation-ratio models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lipsitz(model, group = 10, customFreq = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a model object or data.frame of observed and estimated
values. The following class of objects can be directly passed to the
<code>lipsitz</code> function: vglm(), serp(), polr(), and clm(). Other class of
objects require providing a data.frame of observed and predicted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Default to 10. The number of groups to be formed from the
original observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>customFreq</code></td>
<td>
<p>a vector of custom group frequencies to be used instead of
the default equal group frequencies. The vector should, however, sum up to
the total number of original observations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Similar to the ordinal Hosmer-Lemeshow test (<code>hosmerlem</code>),
the Lipsitz test also group the observations into k separate groups using
the ordinal scores of the estimated values. According to Lipsitz, Fitzmaurice,
and Molenberghs (1996), the number of groups should be such that 6 &lt;= k &lt; n/5r,
with r the number of response category. An indicator variable is used to
denote the observations belonging to each group, producing additional pseudo
variables with which the original model is updated. Supposing the original
model fits correctly, then the coefficients of the pseudo variables all equal
zero. The likelihood ratio statistic calculated from the log likelihoods of
the original and the refitted models is subsequently compared with the
chi-squared distribution with k - 1 degrees of freedom.
</p>
<p>The Lipsitz test compliments the ordinal Hosmer-Lemeshow and the
Pulkstenis-Robinson tests. Fagerland and Hosmer (2013, 2016, 2017)
recommend comparing the three test.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>LR</code></td>
<td>
<p>the realized value of the likelihood ratio statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newVar</code></td>
<td>
<p>a numeric vector of the newly generated variable.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fagerland, M. W. and Hosmer, D. W. (2013). A goodness-of-fit test for the
proportional odds regression model. <em>Statistics in Medicine</em>,
32, 2235-2249.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2016). Tests for goodness of fit in
ordinal logistic regression models. <em>Journal of Statistical
Computation and Simulation</em>, 86, 3398-3418.
</p>
<p>Fagerland, M. W. and Hosmer, D. W. (2017). How to test for goodness of fit
in ordinal logistic regression models. <em>Stata Journal</em>, 17, 668-686.
</p>


<h3>See Also</h3>

<p><code>hosmerlem</code>, <code>pulkroben</code>, <code>brant.test</code>,
<code>LR.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
require(VGAM)

set.seed(1)
n &lt;- 200
y &lt;- ordered(rbinom(n, 2, 0.5))
x1 &lt;- factor(rbinom(n, 1, 0.7))
x2 &lt;- runif(n)

## proportional odds model
vg &lt;- vglm(y ~ x1 + x2, model = TRUE,
           family = cumulative(link = "logitlink", parallel = TRUE))
lipsitz(vg, group=6)

## adjacent category model
ac &lt;- update(vg, family = acat(parallel = TRUE))
lipsitz(ac)

## continuation ratio model
cr &lt;- update(vg, family = cratio(parallel = TRUE))
lipsitz(cr)

</code></pre>


</div>