<div class="container">

<table style="width: 100%;"><tr>
<td>stepCriterion.glmgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable selection in Generalized Estimating Equations</h2>

<h3>Description</h3>

<p>Performs variable selection in generalized estimating equations using hybrid versions of forward stepwise
and backward stepwise.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'glmgee'
stepCriterion(
  model,
  criterion = c("p-value", "qic", "qicu", "agpc", "sgpc"),
  test = c("wald", "score"),
  direction = c("forward", "backward"),
  levels = c(0.05, 0.05),
  trace = TRUE,
  scope,
  digits = max(3, getOption("digits") - 2),
  varest = c("robust", "df-adjusted", "model", "bias-corrected"),
  force.in,
  force.out,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of the class <code>glmgee</code> which is obtained from the fit of a generalized estimating equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>an (optional) character string indicating the criterion which should be used to compare the candidate
models. The available options are: QIC ("qic"), QICu ("qicu"), Akaike-type penalized gaussian pseudo-likelihood criterion ("agpc"),
Schwarz-type penalized gaussian pseudo-likelihood criterion ("sgpc") and <em>p</em>-value of the <code>test</code> test ("p-value"). By
default, <code>criterion</code> is set to "p-value".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>an (optional) character string indicating the statistical test which should be used to compare nested
models. The available options are: Wald ("wald") and generalized score ("score") tests. As default, <code>test</code> is
set to "wald".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>an (optional) character string indicating the type of procedure which should be used. The available
options are: hybrid backward stepwise ("backward") and hybrid forward stepwise ("forward"). As default, <code>direction</code>
is set to "forward".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>an (optional) two-dimensional vector of values in the interval <code class="reqn">(0,1)</code> indicating the levels at which
the variables should in and out from the model. This is only appropiate if <code>criterion</code>="p-value". By default,
<code>levels</code> is set to <code>c(0.05,0.05)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>an (optional) logical switch indicating if should the stepwise reports be printed. By default,
<code>trace</code> is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope</code></td>
<td>
<p>an (optional) list, containing components <code>lower</code> and <code>upper</code>, both formula-type objects,
indicating the range of models which should be examined in the stepwise search. As default, <code>lower</code> is a model
with no predictors and <code>upper</code> is the linear predictor of the model in <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits which should be used to print the most of the
criteria to compare the candidate models. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest</code></td>
<td>
<p>an (optional) character string indicating the type of estimator which should be used to the variance-covariance matrix of the interest parameters in the Wald-type test. The available options are: robust sandwich-type estimator ("robust"), degrees-of-freedom-adjusted estimator ("df-adjusted"), bias-corrected estimator ("bias-corrected"), and the model-based or naive estimator ("model"). As default, <code>varest</code> is set to "robust".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.in</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in all models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.out</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in no models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. For example, <code>k</code>, that is, the magnitude of the
penalty in the AGPC, which by default is set to 2.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list which contains the following objects:
</p>

<dl>
<dt><code>initial</code></dt>
<dd>
<p> a character string indicating the linear predictor of the "initial model".</p>
</dd>
<dt><code>direction</code></dt>
<dd>
<p> a character string indicating the type of procedure which was used.</p>
</dd>
<dt><code>criterion</code></dt>
<dd>
<p> a character string indicating the criterion used to compare the candidate models.</p>
</dd>
<dt><code>final</code></dt>
<dd>
<p> a character string indicating the linear predictor of the "final model".</p>
</dd>
<dt><code>final.fit</code></dt>
<dd>
<p> an object of class <code>glmgee</code> with the results of the fit to the data of the "final model".</p>
</dd>
</dl>
<p>'

</p>


<h3>References</h3>

<p>James G., Witten D., Hastie T., Tibshirani R. (2013, page 210) <em>An Introduction to Statistical Learning
with Applications in R</em>. Springer, New York.
</p>
<p>Jianwen X., Jiamao Z., Liya F. (2019) Variable selection in generalized estimating equations via empirical
likelihood and Gaussian pseudo-likelihood. <em>Communications in Statistics - Simulation and Computation</em> 48:1239-1250.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p>stepCriterion.lm, stepCriterion.glm, stepCriterion.overglm
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod &lt;- size ~ poly(days,4)*treat
fit1 &lt;- glmgee(mod, id=tree, family=Gamma(log), data=spruces, corstr="AR-M-dependent")
stepCriterion(fit1, criterion="p-value", direction="forward", scope=list(upper=mod),force.in=~treat)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod &lt;- depressd ~ visit*group
fit2 &lt;- glmgee(mod, id=subj, family=binomial(probit), corstr="AR-M-dependent", data=depression)
stepCriterion(fit2, criterion="agpc", direction="forward", scope=list(upper=mod),force.in=~group)

###### Example 3: Treatment for severe postnatal depression (2)
mod &lt;- dep ~ visit*group
fit2 &lt;- glmgee(mod, id=subj, family=gaussian(identity), corstr="AR-M-dependent", data=depression)
stepCriterion(fit2, criterion="sgpc", direction="forward", scope=list(upper=mod),force.in=~group)

</code></pre>


</div>