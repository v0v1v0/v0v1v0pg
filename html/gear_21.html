<div class="container">

<table style="width: 100%;"><tr>
<td>geolm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear model for geostatistical data.</h2>

<h3>Description</h3>

<p><code>geolm</code> creates a geostatistical linear model object
of the appropriate class based on the arguments,
especially the <code>cmod</code> arguments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">geolm(
  formula,
  data,
  coordnames,
  mod,
  weights = NULL,
  mu = NULL,
  longlat = NULL,
  cmod = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class
<code>formula</code> providing a symbolic
description of the model to be fitted.  See Details of
this function and <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the response,
covariates, and location coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordnames</code></td>
<td>
<p>The columns of <code>data</code> containing
the spatial coordinates, provided as a formula (e.g.,
<code>~ x + y</code>), column numbers (e.g., <code>c(1, 2)</code>),
or column names (e.g., <code>c("x", "y")</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>A model object produced by one
of the <code>cmod_*</code> functions, e.g.,
<code>cmod_std</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional vector of weights for the
errors to be used in the fitting process.  A vector
that is proportional to the reciprocal variances of the
errors, i.e., errors are assumed to be uncorrelated
with variances <code>evar/weights</code>.  Default is
<code>NULL</code>, meaning that the weights are uniformly 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A single numeric value indicating the consant
mean of the spatial process if simple kriging is
desired.  Default is <code>NULL</code>, meaning that ordinary
or universal kriging should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>A logical indicating whether Euclidean
(<code>FALSE</code>) or Great Circle distance (WGS84
ellipsoid) (<code>longlat = TRUE</code>) should be used.
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmod</code></td>
<td>
<p>Retained for backwards compatibility. A model object produced by one
of the <code>cmod_*</code> functions, e.g.,
<code>cmod_std</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note: for the multiresolution Gaussian process model, if
<code>cmod$est == "f"</code> (i.e., if the nugget is finescale
instead of measurement error), then the <code>weights</code>
argument is internally set to <code>rep(1, n)</code>, where
<code>n</code> is the number of observations.
</p>
<p><code>formula</code> should be specified after the form <code>y
~ x1 + x2</code>, where <code>y</code> is the response variable and
<code>x1</code> and <code>x2</code> are the covariates of interest.
If <code>mu</code> is provided, the variables to the right of
<code>~</code> are ignored.
</p>


<h3>Value</h3>

<p>Returns a <code>geolm_*</code> object, where <code>*</code>
depends on <code>mod</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class="language-R">data = data.frame(y = rnorm(10), x1 = runif(10),
                 x2 = runif(10))
d = geodist(data[,c("x1", "x2")])
mod = cmod_man(v = exp(-d), evar = 1)
gearmod = geolm(y ~ x1, data = data,
                coordnames = ~ x1 + x2, mod = mod)
</code></pre>


</div>