<div class="container">

<table style="width: 100%;"><tr>
<td>gitlab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Request GitLab API</h2>

<h3>Description</h3>

<p>This is 'gitlabr' core function to talk to GitLab's
server API via HTTP(S). Usually you will not
use this function directly too often, but either use 'gitlabr'
convenience wrappers or write your
own. See the 'gitlabr' vignette for more information on this.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gitlab(
  req,
  api_root,
  verb = httr::GET,
  auto_format = TRUE,
  debug = FALSE,
  gitlab_con = "default",
  page = "all",
  max_page = 10,
  enforce_api_root = TRUE,
  argname_verb = if (identical(verb, httr::GET) || identical(verb, httr::DELETE)) {
    
    "query"
 } else {
     "body"
 },
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>req</code></td>
<td>
<p>vector of characters that represents the call
(e.g. <code>c("projects", project_id, "events")</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>api_root</code></td>
<td>
<p>URL where the GitLab API to request resides
(e.g. <code style="white-space: pre;">⁠https://gitlab.myserver.com/api/v3/⁠</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>http verb to use for request in form of one of the
<code>httr</code> functions
<code>httr::GET()</code>, <code>httr::PUT()</code>, <code>httr::POST()</code>, <code>httr::DELETE()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto_format</code></td>
<td>
<p>whether to format the returned object automatically
to a flat data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>if TRUE API URL and query will be printed, defaults to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gitlab_con</code></td>
<td>
<p>function to use for issuing API requests
(e.g. as returned by <code>get_gitlab_connection()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>page</code></td>
<td>
<p>number of page of API response to get; if "all" (default),
all pages (up to max_page parameter!) are queried successively and combined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_page</code></td>
<td>
<p>maximum number of pages to retrieve.
Defaults to 10. This is an upper limit
to prevent 'gitlabr' getting stuck in retrieving
an unexpectedly high number of entries (e.g. of a
project list). It can be set to NA/Inf to retrieve
all available pages without limit, but this
is recommended only under controlled circumstances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enforce_api_root</code></td>
<td>
<p>if multiple pages are requested,
the API root URL is ensured
to be the same as in the original call for all calls
using the "next page" URL returned
by GitLab This makes sense for security and in cases
where GitLab is behind a reverse proxy
and ignorant about its URL from external.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argname_verb</code></td>
<td>
<p>name of the argument of the verb
that fields and information are passed on to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>named parameters to pass on to GitLab API
(technically: modifies query parameters of request URL),
may include private_token and all other parameters
as documented for the GitLab API</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>gitlab()</code> function allows to use any request
of the GitLab API <a href="https://docs.gitlab.com/ce/api/">https://docs.gitlab.com/ce/api/</a>.
</p>
<p>For instance, the API documentation shows how to create a new project in
<a href="https://docs.gitlab.com/ce/api/projects.html#create-project">https://docs.gitlab.com/ce/api/projects.html#create-project</a>:
</p>

<ul>
<li>
<p> The verb is <code>POST</code>
</p>
</li>
<li>
<p> The request is <code>projects</code>
</p>
</li>
<li>
<p> Required attributes are <code>name</code> or <code>path</code> (if <code>name</code> not set)
</p>
</li>
<li> <p><code>default_branch</code> is an attribute that can be set if wanted
</p>
</li>
</ul>
<p>The corresponding use of <code>gitlab()</code> is:
</p>
<div class="sourceCode"><pre>gitlab(
  req = "projects",
  verb = httr::POST,
  name = "toto",
  default_branch = "main"
)
</pre></div>
<p>Note: currently GitLab API v4 is supported.
GitLab API v3 is no longer supported, but
you can give it a try.
</p>


<h3>Value</h3>

<p>the response from the GitLab API,
usually as a <code>tibble</code> and including all pages
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Connect as a fixed user to a GitLab instance
set_gitlab_connection(
  gitlab_url = "https://gitlab.com",
  private_token = Sys.getenv("GITLAB_COM_TOKEN")
)

# Use a simple request
gitlab(req = "projects")
# Use a combined request with extra parameters
gitlab(
  req = c("projects", 1234, "issues"),
  state = "closed"
)

## End(Not run)
</code></pre>


</div>