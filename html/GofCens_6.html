<div class="container">

<table style="width: 100%;"><tr>
<td>chisqcens</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>General chi-squared statistics for right-censored data.</h2>

<h3>Description</h3>

<p>Function <code>chisqcens</code> computes the general chi-squared test statistic for 
right-censored data introduced by Kim (1993) and the respective p-value 
using bootstrapping.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
chisqcens(times, cens = rep(1, length(times)), M,
          distr = c("exponential", "gumbel", "weibull", "normal",
                    "lognormal", "logistic", "loglogistic", "beta"),
          betaLimits=c(0, 1), igumb = c(10, 10), degs = 3, BS = 999,
          params0 = list(shape = NULL, shape2 = NULL,
                         location = NULL, scale = NULL), tol = 1e-04, ...)
## S3 method for class 'formula'
chisqcens(formula, data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number indicating the number of cells that will be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BS</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params0</code></td>
<td>
<p>List specifying the parameters of the theoretical distribution. 
By default, parameters are set to <code>NULL</code> and estimated with 
the maximum likelihood method. This argument is only considered, 
if all parameters of the studied distribution are specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Precision of survival times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula with a numeric vector as response (which assumes no censoring) or <code>Surv</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame for variables in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function implements the test introduced by Kim (1993) and returns 
the value of the test statistic. 
</p>
<p>The cell boundaries of the test are obtained via the quantiles, which 
are based on the Kaplan-Meier estimate of the distribution function. 
In the presence of right-censored data, it is possible that not all 
quantiles are estimated, and in this case, the value of <code>M</code> 
provided by the user is reduced. 
</p>
<p>The parameter estimation is acomplished with the <code>fitdistcens</code> 
function of the <span class="pkg">fitdistrplus</span> package.
</p>
<p>The precision of the survival times is important mainly in 
the data generation step of the bootstrap samples.
</p>


<h3>Value</h3>

<p><code>chisqcens</code> returns an object of class <code>"chisqcens"</code>.
</p>
<p>An object of class <code>"chisqcens"</code> is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Distribution</code></td>
<td>
<p>Null distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Null hypothesis</code></td>
<td>
<p>Parameters under the null hypothesis (if <code>params0</code> is provided).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Statistic</code></td>
<td>
<p>Value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p-value</code></td>
<td>
<p>Estimated p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Parameters </code></td>
<td>
<p>The values of the parameters of the null distribution. 
If the user has set the parameters manually, these will 
be the returned parameters, otherwise the maximum 
likelihood estimates are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CellNumber</code></td>
<td>
<p>Vector with two values: the original cell number 
introduced by the user and the final cell number used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>J. H. Kim. <em>Chi-Square Goodness-of-Fit Tests for Randomly Censored Data.</em> 
In: The Annals of Statistics, 21 (3) (1993), 1621-1639.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Complete data
set.seed(123)
chisqcens(times = rgumbel(100, 12, scale = 4), M = 8, distr = "gumbel",
          BS = 99)

## Not run: 
# Censored data
data(colon)
set.seed(123)
colonsamp &lt;- colon[sample(nrow(colon), 300), ]
chisqcens(Surv(time, status) ~ 1, colonsamp, M = 6, distr = "normal")

## End(Not run)
</code></pre>


</div>