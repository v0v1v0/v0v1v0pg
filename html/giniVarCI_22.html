<div class="container">

<table style="width: 100%;"><tr>
<td>icompareCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Comparisons of variance estimators and confidence intervals for the Gini index in infinite populations</h2>

<h3>Description</h3>

<p>Compares variance estimates and confidence intervals for the Gini index in infinite populations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">icompareCI(
 y,
 B = 1000L,
 alpha = 0.05,
 plotCI = TRUE,
 digitsgini = 2L,
 digitsvar = 4L,
 cum.sums = NULL,
 na.rm = TRUE,
 precisionEL = 1e-4,
 maxiterEL = 100L,
 line.types = c(1L, 2L),
 colors = c("red", "green"),
 save.plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector with the non-negative real numbers to be used for estimating the Gini index. This argument can be missing if argument <code>cum.sums</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A single integer specifying the number of bootstrap replicates. The default value is <code>B = 1000L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A single numeric value between 0 and 1 specifying the confidence level 1-<code>alpha</code> to be used for computing the confidence interval for the Gini. Some authors call <code>alpha</code> the significance level. The default value is <code>alpha = 0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotCI</code></td>
<td>
<p>A 'TRUE/FALSE' logical value indicating whether confidence intervals are compared using a plot. The default value is <code>plotCI = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digitsgini</code></td>
<td>
<p>A single integer specifying the number of decimals used in the estimation of the Gini index and confidence intervals. The default value is <code>digitsgini = 2L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digitsvar</code></td>
<td>
<p>A single integer specifying the number of decimals used in the variance estimation of the Gini index. The default value is <code>digitsvar = 4L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum.sums</code></td>
<td>
<p>A numeric vector of non-negative real numbers specifying the cumulative sums of the variable used to estimate the Gini index. This argument can be <code>NULL</code> if argument <code>y</code> is provided. The default value is <code>cum.sums = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A 'TRUE/FALSE' logical value indicating whether the <code>NA</code> should be removed before the computation proceeds. The default value is <code>na.rm = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precisionEL</code></td>
<td>
<p>A single numeric value specifying the precision for the confidence interval based on the empirical likelihood method. The default value is <code>precisionEL = 1e-4</code>, i.e., limits of the confidence interval have a total of 4 decimal places.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiterEL</code></td>
<td>
<p>A single integer specifying the maximum number of iterations allowed for the convergence in the empirical likelihood method. The default value is <code>maxiterEL = 100L</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.types</code></td>
<td>
<p>A numeric vector with length equal 2 specifying the line types. See the function <code>plot</code> for the different line types. The default value is <code>lty = c(1L,2L)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>A numeric vector with length equal 2 specifying the colors for lines of the plot. The default value is <code>colors = c("red", "green")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.plot</code></td>
<td>
<p>A 'TRUE/FALSE' logical value indicating whether the ggplot object of the  plot comparing the confidence intervals should be saved in the output. The default value is <code>save.plot = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a sample <code class="reqn">S</code>, with size <code class="reqn">n</code>, derived from an infinite population, the Gini index is estimated by two different versions (see Muñoz et al., 2023 for more details):
</p>
<p style="text-align: center;"><code class="reqn">\widehat{G}      = \displaystyle \frac{2}{\overline{y}n^{2}}\sum_{i \in S}iy_{(i)} - \frac{n+1}{n}; </code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{G}^{bc} = \displaystyle \frac{2}{\overline{y}n(n-1)}\sum_{i \in S}iy_{(i)} - \frac{n+1}{n-1}, </code>
</p>

<p>where the label <code class="reqn">bc</code> indicates that the bias correction is applied. The table below sumarises the various types of variances and confidence intervals that computes this function.
Methods based on the jackknife technique use the fast algorithm suggested by Ogwang (2000). The linearization technique for variance estimation (Deville, 1999) has been applied to the following estimators of the Gini index (Berger, 2008; Langel and Tille, 2013):
</p>
<p style="text-align: center;"><code class="reqn">\widehat{G}^{a} = \displaystyle \frac{1}{2\overline{y}n^{2}}\sum_{i \in S}\sum_{j\in S} |y_i-y_j|</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\widehat{G}^{b}      = \displaystyle \frac{2}{\overline{y}n}\sum_{i \in S}y_{i}\widehat{F}_{n}(y_{i}) - 1,</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\widehat{F}_{n}(y_i)=\frac{1}{n}\sum_{j \in S}\delta(y_j \leq y_i).</code>
</p>

<p><code>zalinearization</code> and <code>zblinearization</code> linearizate, respectively, the estimators <code class="reqn">\widehat{G}^{a}</code> and <code class="reqn">\widehat{G}^{b}</code>. The percentile bootstrap (see Qin et al., 2010) is computed using <code>pbootstrap</code>. <code>Bca</code> is the bias corrected bootstrap confidence interval (Efron and Tibshirani, 1993). <code>ELchisq</code> and <code>ELboot</code> are the confidence intervals based on the empirical likelihood method.
The <b>vignette</b> <code>vignette("GiniVarInterval")</code> contains a detailed description of the various methods for variance estimation and confidence intervals for the Gini index.
</p>

<table>
<tr>
<td style="text-align: left;">
<b>Interval</b>          </td>
<td style="text-align: left;"> <b>Variance</b> </td>
<td style="text-align: left;"> <b>Critical values</b>  </td>
<td style="text-align: left;"> <b>References</b>
</td>
</tr>
<tr>
<td style="text-align: left;">
_______________     </td>
<td style="text-align: left;"> ____________  </td>
<td style="text-align: left;"> __________________ </td>
<td style="text-align: left;"> __________________________</td>
</tr>
<tr>
<td style="text-align: left;">
<code>zjackknife</code>        </td>
<td style="text-align: left;"> Jackknife     </td>
<td style="text-align: left;"> Normal                </td>
<td style="text-align: left;"> Berger (2008)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>tjackknife</code>        </td>
<td style="text-align: left;"> Jackknife     </td>
<td style="text-align: left;"> Studentized bootstrap </td>
<td style="text-align: left;"> Biewen (2002); Berger (2008)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>zalinearization</code>    </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Normal                </td>
<td style="text-align: left;"> Langel and Tille (2013)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>zblinearization</code>    </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Normal                </td>
<td style="text-align: left;"> Berger (2008)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>talinearization</code>    </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Studentized bootstrap </td>
<td style="text-align: left;"> Langel and Tille (2013)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>tblinearization</code>    </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Studentized bootstrap </td>
<td style="text-align: left;"> Biewen (2002); Berger (2008)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>pBootstrap</code>        </td>
<td style="text-align: left;"> Bootstrap     </td>
<td style="text-align: left;"> Percentile bootstrap  </td>
<td style="text-align: left;"> Qin et al. (2010)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>BCa</code>               </td>
<td style="text-align: left;"> Bootstrap  </td>
<td style="text-align: left;"> BCa bootstrap           </td>
<td style="text-align: left;"> Davison and Hinkley (1997)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>ELchisq</code>           </td>
<td style="text-align: left;"> Linearization </td>
<td style="text-align: left;"> Chi-Squared           </td>
<td style="text-align: left;"> Qin et al. (2010)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>ELboot</code>            </td>
<td style="text-align: left;"> Bootstrap     </td>
<td style="text-align: left;"> Percentile bootstrap  </td>
<td style="text-align: left;"> Qin et al. (2010)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>save.plot = FALSE</code>, a data frame with columns:
</p>

<ol>
<li> <p><code>interval</code>. The method used to construct the confidence interval.
</p>
</li>
<li> <p><code>bc</code>. A 'TRUE/FALSE' logical value indicating whether the  bias correction is applied.
</p>
</li>
<li> <p><code>gini</code>. The estimation of the Gini index.
</p>
</li>
<li> <p><code>lowerlimit</code>. The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upperlimit</code>. The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>var.gini</code>. The variance estimation for the estimator of the Gini index.
</p>
</li>
</ol>
<p>If <code>save.plot = TRUE</code>, a list with two components: (i) 'base.CI' a data frame of six columns as just described and (ii) 'plot' a (ggplot) description of the plot, which is a list with components that contain the plot itself, the data, information about the scales, panels, etc. As a side-effect, a plot that compares the various methods for constructing confidence intervals for the Gini index is displayed. **ggplot2** is needed to be installed for this option to work.
</p>
<p>If <code>plotCI = TRUE</code>, as a side-effect, a plot that compares the various methods for constructing confidence intervals for the Gini index is displayed. **ggplot2** is needed to be installed for this option to work.
</p>


<h3>Author(s)</h3>

<p>Juan F Munoz <a href="mailto:jfmunoz@ugr.es">jfmunoz@ugr.es</a>
</p>
<p>Jose M Pavia <a href="mailto:pavia@uv.es">pavia@uv.es</a>
</p>
<p>Encarnacion Alvarez <a href="mailto:encarniav@ugr.es">encarniav@ugr.es</a>
</p>


<h3>References</h3>

<p>Berger, Y. G. (2008). A note on the asymptotic equivalence of jackknife and linearization variance estimation for the Gini Coefficient. Journal of Official Statistics, 24(4), 541-555.
</p>
<p>Biewen, M. (2002). Bootstrap inference for inequality, mobility and poverty measurement. Journal of Econometrics, 108(2), 317-342.
</p>
<p>Davison, A. C., and Hinkley, D. V. (1997). Bootstrap Methods and Their Application (Cambridge Series in Statistical and Probabilistic Mathematics, No 1)–Cambridge University Press.
</p>
<p>Deville, J.C. (1999). Variance Estimation for Complex Statistics and Estimators: Linearization and Residual Techniques. Survey Methodology, 25, 193–203.
</p>
<p>Efron, B. and Tibshirani, R. (1993). An Introduction to the Bootstrap. Chapman and Hall, New York, London.
</p>
<p>Langel, M., and Tille, Y. (2013). Variance estimation of the Gini index: revisiting a result several times published. Journal of the Royal Statistical Society: Series A (Statistics in Society), 176(2), 521-540.
</p>
<p>Muñoz, J. F., Moya-Fernández, P. J., and Álvarez-Verdejo, E. (2023). Exploring and Correcting the Bias in the Estimation of the Gini Measure of Inequality. Sociological Methods &amp; Research. https://doi.org/10.1177/00491241231176847
</p>
<p>Ogwang, T. (2000). A convenient method of computing the Gini index and its standard error. Oxford Bulletin of Economics and Statistics, 62(1), 123-123.
</p>
<p>Qin, Y., Rao, J. N. K., and Wu, C. (2010). Empirical likelihood confidence intervals for the Gini measure of income inequality. Economic Modelling, 27(6), 1429-1435.
</p>


<h3>See Also</h3>

<p><code>igini</code>, <code>iginindex</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sample, with size 50, from a Lognormal distribution. The true Gini index is 0.5.
set.seed(123)
y &lt;- gsample(n = 50, gini = 0.5, distribution = "lognormal")

# Estimation of the Gini index and confidence intervals using different methods.
icompareCI(y)
</code></pre>


</div>