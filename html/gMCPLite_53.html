<div class="container">

<table style="width: 100%;"><tr>
<td>gMCP.extended</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graph based Multiple Comparison Procedures</h2>

<h3>Description</h3>

<p>Performs a graph based multiple test procedure for a given graph and unadjusted p-values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gMCP.extended(
  graph,
  pvalues,
  test,
  alpha = 0.05,
  eps = 10^(-3),
  upscale = FALSE,
  verbose = FALSE,
  adjPValues = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>A graph of class <code>graphMCP</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>A numeric vector specifying the p-values for the graph based
MCP. Note the assumptions in the description of the selected test (if there are any -
for example <code>test=bonferroni.test</code> has no further assumptions, but
<code>test=parametric.test</code> assumes p-values from a multivariate normal distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>A weighted test function.
</p>
<p>The package gMCP provides the following weighted test functions:
</p>

<dl>
<dt>bonferroni.test</dt>
<dd>
<p>Bonferroni test - see <code>?bonferroni.test</code> for details.</p>
</dd>
<dt>parametric.test</dt>
<dd>
<p>Parametric test - see <code>?parametric.test</code> for details.</p>
</dd>
<dt>simes.test</dt>
<dd>
<p>Simes test - see <code>?simes.test</code> for details.</p>
</dd>
<dt>bonferroni.trimmed.simes.test</dt>
<dd>
<p>Trimmed Simes test for intersections of two hypotheses and otherwise Bonferroni - see <code>?bonferroni.trimmed.simes.test</code> for details.</p>
</dd>
<dt>simes.on.subsets.test</dt>
<dd>
<p>Simes test for intersections of hypotheses from certain sets and otherwise Bonferroni - see <code>?simes.on.subsets.test</code> for details.</p>
</dd>
</dl>
<p>To provide your own test function see <code>?weighted.test.function</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric specifying the maximal allowed type one error rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>A numeric scalar specifying a value for epsilon edges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upscale</code></td>
<td>
<p>Logical. If <code>upscale=FALSE</code> then for each intersection
of hypotheses (i.e. each subgraph) a weighted test is performed at the
possibly reduced level alpha of sum(w)*alpha,
where sum(w) is the sum of all node weights in this subset.
If <code>upscale=TRUE</code> all weights are upscaled, so that sum(w)=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical scalar. If <code>TRUE</code> verbose output is generated
during sequentially rejection steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjPValues</code></td>
<td>
<p>Logical scalar. If <code>FALSE</code> no adjusted p-values will
be calculated. Especially for the weighted Simes test this will result in
significantly less calculations in most cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Test specific arguments can be given here.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>gMCPResult</code>, more specifically a list with
elements
</p>

<dl>
<dt><code>graphs</code></dt>
<dd>
<p>list of graphs</p>
</dd>
<dt><code>pvalues</code></dt>
<dd>
<p>p-values</p>
</dd>
<dt><code>rejected</code></dt>
<dd>
<p>logical whether hypotheses could be rejected</p>
</dd>
<dt><code>adjPValues</code></dt>
<dd>
<p>adjusted p-values</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Kornelius Rohmeyer <a href="mailto:rohmeyer@small-projects.de">rohmeyer@small-projects.de</a>
</p>


<h3>References</h3>

<p>Frank Bretz, Willi Maurer, Werner Brannath, Martin Posch: A
graphical approach to sequentially rejective multiple test procedures.
Statistics in Medicine 2009 vol. 28 issue 4 page 586-604.
<a href="https://www.meduniwien.ac.at/fwf_adaptive/papers/bretz_2009_22.pdf">https://www.meduniwien.ac.at/fwf_adaptive/papers/bretz_2009_22.pdf</a>
</p>
<p>Bretz F., Posch M., Glimm E., Klinglmueller F., Maurer W., Rohmeyer K.
(2011): Graphical approaches for multiple endpoint problems using weighted
Bonferroni, Simes or parametric tests. Biometrical Journal 53 (6),
pages 894-913, Wiley.
<a href="https://doi.org/10.1002/bimj.201000239">doi:10.1002/bimj.201000239</a>
</p>
<p>Strassburger K., Bretz F.: Compatible simultaneous lower confidence bounds
for the Holm procedure and other Bonferroni based closed tests. Statistics
in Medicine 2008; 27:4914-4927.
</p>
<p>Hommel G., Bretz F., Maurer W.: Powerful short-cuts for multiple testing
procedures with special reference to gatekeeping strategies. Statistics in
Medicine 2007; 26:4063-4073.
</p>
<p>Guilbaud O.: Simultaneous confidence regions corresponding to Holm's
stepdown procedure and other closed-testing procedures. Biometrical Journal
2008; 50:678-692.
</p>


<h3>See Also</h3>

<p><code>graphMCP</code> <code>multcomp::contrMat()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">g &lt;- BonferroniHolm(5)
gMCP(g, pvalues=c(0.01, 0.02, 0.04, 0.04, 0.7))
# Simple Bonferroni with empty graph:
g2 &lt;- matrix2graph(matrix(0, nrow=5, ncol=5))
gMCP(g2, pvalues=c(0.01, 0.02, 0.04, 0.04, 0.7))
# With 'upscale=TRUE' equal to BonferroniHolm:
gMCP(g2, pvalues=c(0.01, 0.02, 0.04, 0.04, 0.7), upscale=TRUE)

# Entangled graphs:
g3 &lt;- Entangled2Maurer2012()
gMCP(g3, pvalues=c(0.01, 0.02, 0.04, 0.04, 0.7), correlation=diag(5))

</code></pre>


</div>