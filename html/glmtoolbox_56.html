<div class="container">

<table style="width: 100%;"><tr>
<td>gnmgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Nonlinear Generalized Estimating Equations</h2>

<h3>Description</h3>

<p>Produces an object of the class <code>glmgee</code> in which the main results of a Nonlinear Generalized Estimating Equation (GEE) fitted to the data are stored.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gnmgee(
  formula,
  family = gaussian(),
  offset = NULL,
  weights = NULL,
  id,
  waves,
  data,
  subset = NULL,
  corstr,
  corr,
  start = NULL,
  scale.fix = FALSE,
  scale.value = 1,
  toler = 1e-05,
  maxit = 50,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a nonlinear model <code>formula</code> including variables and parameters, which is a symbolic description of the nonlinear predictor of the model to be fitted to the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>an (optional) <code>family</code> object, that is, a list of functions and expressions for defining link and variance functions. Families (and links) supported are the same supported by glm using its family argument, that is,
<code>gaussian</code>, <code>binomial</code>, <code>poisson</code>, <code>Gamma</code>, <code>inverse.gaussian</code>, and <code>quasi</code>. The family <code>negative.binomial</code> in the library <span class="pkg">MASS</span> are also available. As default, the argument <code>family</code> is set to <code>gaussian(identity)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>an (optional) numeric vector of length equal to the number of cases, which can be used to specify an a priori known component to be included in the linear predictor during fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an (optional) vector of positive "prior weights" to be used in the fitting process. The length of <code>weights</code> should be the same as the total number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector which identifies the subjects or clusters. The length of <code>id</code> should be the same as the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waves</code></td>
<td>
<p>an (optional) positive integer-valued variable that is used to identify the order and spacing of observations within clusters. This argument is crucial when there are missing values and gaps in the data. As default, <code>waves</code> is equal to the integers from 1 to the size of each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression, as well as for variables specified in the arguments <code>id</code> and <code>weights</code>. The data are assumed to be sorted by <code>id</code> and time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>an (optional) character string which allows to specify the working-correlation structure. The available options are: "Independence", "Unstructured", "Stationary-M-dependent(<em>m</em>)", "Non-Stationary-M-dependent(<em>m</em>)", "AR-M-dependent(<em>m</em>)", "Exchangeable" and "User-defined", where <em>m</em> represents the lag of the dependence. As default, <code>corstr</code> is set to "Independence".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>an (optional) square matrix of the same dimension of the maximum cluster size containing the user specified correlation. This is only appropriate if <code>corstr</code> is specified to be "User-defined".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an (optional) vector of starting values for the parameters in the nonlinear predictor. When <code>start</code> is
missing (and <code>formula</code> is not a self-starting model, see nls and selfStart), a very cheap guess for <code>start</code> is tried.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.fix</code></td>
<td>
<p>an (optional) logical variable. If TRUE, the scale parameter is fixed at the value of <code>scale.value</code>. As default, <code>scale.fix</code> is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.value</code></td>
<td>
<p>an (optional) numeric value at which the scale parameter should be fixed. This is only appropriate if <code>scale.fix=TRUE</code>. As default, <code>scale.value</code> is set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toler</code></td>
<td>
<p>an (optional) positive value which represents the <em>convergence tolerance</em>. The convergence is reached when the maximum of the absolute relative differences between the values of the parameters in the nonlinear predictor in consecutive iterations of the fitting algorithm is lower than <code>toler</code>. As default, <code>toler</code> is set to 0.00001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an (optional) integer value which represents the maximum number of iterations allowed for the fitting algorithm. As default, <code>maxit</code> is set to 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>an (optional) logical variable. If TRUE, output is produced for each iteration of the estimating algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The values of the multivariate response variable measured on <code class="reqn">n</code> subjects or clusters,
denoted by <code class="reqn">y_{i}=(y_{i1},\ldots,y_{in_i})^{\top}</code> for <code class="reqn">i=1,\ldots,n</code>, are assumed to be
realizations of independent random vectors denoted by <code class="reqn">Y_{i}=(Y_{i1},\ldots,Y_{in_i})^{\top}</code>
for <code class="reqn">i=1,\ldots,n</code>. The random variables associated to the <code class="reqn">i</code>-th subject or
cluster, <code class="reqn">Y_{ij}</code> for <code class="reqn">j=1,\ldots,n_i</code>, are assumed to satisfy
<code class="reqn">\mu_{ij}=</code> E<code class="reqn">(Y_{ij})</code>,Var<code class="reqn">(Y_{ij})=\frac{\phi}{\omega_{ij}}</code>V<code class="reqn">(\mu_{ij})</code>
and Corr<code class="reqn">(Y_{ij},Y_{ik})=r_{jk}(\rho)</code>,
where <code class="reqn">\phi&gt;0</code> is the dispersion parameter,
V<code class="reqn">(\mu_{ij})</code> is the variance function, <code class="reqn">\omega_{ij}&gt;0</code> is a known weight, and
<code class="reqn">\rho=(\rho_1,\ldots,\rho_q)^{\top}</code> is a parameter vector.
In addition, <code class="reqn">\mu_{ij}</code> is assumed to be dependent on the regressors vector <code class="reqn">x_{ij}</code>
by <code class="reqn">g(\mu_{ij})=z_{ij} + m(x_{ij},\beta)</code>, where <code class="reqn">g(\cdot)</code> is the link function,
<code class="reqn">z_{ij}</code> is a known <em>offset</em>, <code class="reqn">\beta=(\beta_1,\ldots,\beta_p)^{\top}</code> is
a vector of regression parameters and <code class="reqn">m(x_{ij},\beta)</code> is a known nonlinear function of <code class="reqn">\beta</code>.
The parameter estimates are obtained by iteratively
solving the estimating equations described by Liang and Zeger (1986).
</p>
<p>If the maximum cluster size is 6 and for a cluster of size 4 the value
of <code>waves</code> is set to 2, 4, 5, 6, then it means that the data at
times 1 and 3 are missing, which should be taken into account by
<code>gnmgee</code> when the structure of the correlation matrix is assumed
to be "Unstructured", "Stationary-M-dependent", "Non-Stationary-M-dependent"
or "AR-M-dependent". If in this scenario <code>waves</code> is not specified
then <code>gnmgee</code> assumes that the available data for this cluster
were taken at times 1, 2, 3 and 4.
</p>
<p>A set of standard extractor functions for fitted model objects is
available for objects of class <em>glmgee</em>, including methods to generic functions such as   <code>print</code>, <code>summary</code>,	<code>model.matrix</code>, <code>estequa</code>,
<code>coef</code>, <code>vcov</code>, <code>logLik</code>, <code>fitted</code>, <code>confint</code> and <code>predict</code>.
In addition, the model may be assessed using functions such as anova.glmgee,
residuals.glmgee, dfbeta.glmgee, cooks.distance.glmgee, tidy.glmgee and glance.glmgee.
</p>


<h3>Value</h3>

<p>an object of class <em>glmgee</em> in which the main results of the GEE model fitted to the data are stored, i.e., a
list with components including
</p>

<table>
<tr>
<td style="text-align: left;">
<code>coefficients</code> </td>
<td style="text-align: left;"> a vector with the estimates of <code class="reqn">\beta_1,\ldots,\beta_p</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>fitted.values</code>
</td>
<td style="text-align: left;"> a vector with the estimates of <code class="reqn">\mu_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>start</code>        </td>
<td style="text-align: left;"> a vector with the starting values used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>iter</code>         </td>
<td style="text-align: left;"> a numeric constant with the number of iterations,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>prior.weights</code>
</td>
<td style="text-align: left;"> a vector with the values of <code class="reqn">\omega_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>offset</code>       </td>
<td style="text-align: left;"> a vector with the values of <code class="reqn">z_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>terms</code>        </td>
<td style="text-align: left;"> an object containing the terms objects,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>loglik</code>       </td>
<td style="text-align: left;"> the value of the quasi-log-likelihood function evaluated at the parameter</td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> estimates and the observed data,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>estfun</code>       </td>
<td style="text-align: left;"> a vector with the estimating equations evaluated at the parameter</td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> estimates and the observed data,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>formula</code>      </td>
<td style="text-align: left;"> the formula,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>levels</code>       </td>
<td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>contrasts</code>    </td>
<td style="text-align: left;"> an object containing the contrasts corresponding to levels,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>converged</code>    </td>
<td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>model</code>        </td>
<td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>y</code>            </td>
<td style="text-align: left;"> a vector with the values of <code class="reqn">y_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>family</code>       </td>
<td style="text-align: left;"> an object containing the family object used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>linear.predictors</code> </td>
<td style="text-align: left;"> a vector with the estimates of <code class="reqn">g(\mu_{ij})</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>R</code>            </td>
<td style="text-align: left;"> a matrix with the (robust) estimate of the variance-covariance,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>corr</code>         </td>
<td style="text-align: left;"> a matrix with the estimate of the working-correlation,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>corstr</code>       </td>
<td style="text-align: left;"> a character string specifying the working-correlation structure,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>id</code>           </td>
<td style="text-align: left;"> a vector which identifies the subjects or clusters,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>sizes</code>        </td>
<td style="text-align: left;"> a vector with the values of <code class="reqn">n_i</code> for <code class="reqn">i=1,\ldots,n</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>call</code>         </td>
<td style="text-align: left;"> the original function call,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Liang K.Y., Zeger S.L. (1986) Longitudinal data analysis using generalized linear models.
<em>Biometrika</em> 73:13-22.
</p>
<p>Zeger S.L., Liang K.Y. (1986) Longitudinal data analysis for discrete and continuous outcomes.
<em>Biometrics</em> 42:121-130.
</p>
<p>Hardin J.W., Hilbe J.M. (2013) <em>Generalized Estimating Equations</em>. Chapman &amp; Hall, London.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p>glmgee, wglmgee
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example 1: Orange trees grown at Riverside, California
data(Oranges)
mod &lt;- Trunk ~ b1/(1 + exp((b2-Days)/b3))
start &lt;- c(b1=200,b2=760,b3=375)
fit1 &lt;- gnmgee(mod, start=start, id=Tree, family=Gamma(identity), corstr="Exchangeable",
               data=Oranges)
summary(fit1, corr.digits=2)

mod &lt;- Trunk ~ SSlogis(Days,b1,b2,b3)
fit2 &lt;- gnmgee(mod, id=Tree, family=Gamma(identity), corstr="Exchangeable", data=Oranges)
summary(fit2, corr.digits=2)

###### Example 2: Growth of Paramecium aurelium
data(paramecium)
fit2 &lt;- gnmgee(Number ~ exp(alpha - exp(beta - gamma*Days)), id=Colony, family=poisson(log),
         start=c(alpha=1.85,beta=0.7,gamma=0.35), corstr="AR-M-dependent(1)", data=paramecium)
summary(fit2, corr.digits=2)

</code></pre>


</div>