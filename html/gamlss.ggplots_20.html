<div class="container">

<table style="width: 100%;"><tr>
<td>family_pdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting Probabilities Density Functions (pdf's) for GAMLSS
</h2>

<h3>Description</h3>

<p>The function <code>family_pdf()</code> takes a GAMLSS family distribution and plots different pdf's according to the specified parameters.
</p>
<p>The function <code>fitted_pdf()</code> takes a gamlss fitted object and plots the fitted distributions for specified observations.
</p>
<p>The function <code>fitted_pdf_data()</code> it does the same as <code>fitted_pdf()</code>  but it adds  also the observation values  as grey vertical lines.
</p>
<p>The function <code>predict_pdf()</code> takes a fitted object and test  data and plots the predictive pdf's.
</p>


<h3>Usage</h3>

<pre><code class="language-R">family_pdf(family = NO(), mu = NULL, sigma = NULL, nu = NULL, tau = NULL, 
         title, from = 0, to = 10, no.points = 201,
         alpha = 0.4, col.fill = hcl.colors(lobs, palette = "viridis"), 
         size.seqment = 1.5, plot.point = TRUE, size.point = 1, 
         plot.line = TRUE, size.line = 0.2, ...)
         
fitted_pdf(model, obs, title, from = 0, to = 10, no.points = 201, alpha = 0.4, 
         col.fill = hcl.colors(lobs, palette = "viridis"), 
         size.seqment = 1.5, plot.point = TRUE, size.point = 1, plot.line = TRUE,
         size.line = 0.2, ...)
         
fitted_pdf_data(model, obs, from, to, ...)         
         
predict_pdf(model, newdata, title, from = 0, to = 10, no.points = 201, 
         alpha = 0.4, col.fill = hcl.colors(lobs, palette = "viridis"), 
         size.seqment = 1.5, plot.point = TRUE, size.point = 1, 
         plot.line = TRUE, size.line = 0.2, ...)
         
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A GAMLSS family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A GAMLSS fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>observations to plot fitted distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>for test data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>the <code>mu</code> parameter value(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the <code>sigma</code> parameter value(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>the <code>nu</code> parameter value(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the <code>tau</code> parameter value(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a diferent title for the default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>minimum value for the response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>maximum value for the response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.points</code></td>
<td>
<p>number of points (relevant for continuous responses)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>trasparency factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.fill</code></td>
<td>
<p>the colour pallet default is <code>hcl.colors(lobs, palette="viridis")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.seqment</code></td>
<td>
<p>for discrete responses the size of the bars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.point</code></td>
<td>
<p>for discrete responses whether to put poits on the top of the bars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.point</code></td>
<td>
<p>for discrete responses </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.line</code></td>
<td>
<p>for discrete responses whether to joint the bars with lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.line</code></td>
<td>
<p>for discrete responses the size of the joining lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra argumnets</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The  functions <code>family_pdf()</code> and <code>fitted_pdf()</code> are ggplot version of the   function <code>pdf.plot()</code>  used to plot fitted distributions of  GAMLSS family at specified observation values. Note that the range of the response  has to be specified using the argument <code>from</code> <code>to</code>. 
</p>
<p>For discrete fitted distributions maybe increase the value of <code>alpha</code> for clearer  plot.
</p>
<p>For binomial type of data (discrete response with upper limit) the function <code>family_pdf()</code> takes the argument <code>to</code> as the binomial denominator,
For fitted model with  binomial type responses the function <code>fitted_pdf()</code>  takes the binomial denominator form the fitted model and set the argument <code>to</code> to the maximum of those binomial denominators.
</p>


<h3>Value</h3>

<p>Creates a plot
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

  <p><code>gamlss</code>, <code>resid_density </code></p>


<h3>Examples</h3>

<pre><code class="language-R">###################################
# function fitted_pdf
# continuous variabe
a1 &lt;- gamlss(y~pb(x),sigma.fo=~pb(x), data=abdom, family=LO)
fitted_pdf(a1, obs=c(10,15,20), from=30, to=100)
# count data
p1 &lt;- gamlss(y~pb(x)+qrt, data=aids, family=NBI)
fitted_pdf(p1, obs=c(10:15), from=25, to=130, alpha=.9)
# binomial type
h&lt;-gamlss(y~ward+loglos+year, sigma.formula=~year+ward, family=BB, data=aep) 
fitted_pdf(h, obs=c(10:15),  alpha=.9)
###################################
# function predict_pdf
predict_pdf(a1, newdata=abdom[10:20, ], from=30, to=100)
# count data
predict_pdf(p1, newdata=aids[10:15, ], from=30, to=150)
# binomial
predict_pdf(h, newdata=aep[10:15, ], from=0, to=20)
###################################
# function family_pdf
# continuous
family_pdf(from=-5,to=5, mu=0, sigma=c(.5,1,2))
# count data 
family_pdf(NBI, to=15, mu=1, sigma=c(.5,1,2), alpha=.9, size.seqment = 3)
# binomial type
family_pdf(BB, to=15, mu=.5, sigma=c(.5,1,2),  alpha=.9, , size.seqment = 3)
</code></pre>


</div>