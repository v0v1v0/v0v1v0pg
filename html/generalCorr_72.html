<div class="container">

<table style="width: 100%;"><tr>
<td>kern_ctrl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kernel regression with control variables and optional residuals and gradients.</h2>

<h3>Description</h3>

<p>Allowing matrix input of control variables, this function runs kernel regression 
with options for residuals and gradients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kern_ctrl(
  dep.y,
  reg.x,
  ctrl,
  tol = 0.1,
  ftol = 0.1,
  gradients = FALSE,
  residuals = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dep.y</code></td>
<td>
<p>Data on the dependent (response) variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg.x</code></td>
<td>
<p>Data on the regressor (stimulus) variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrl</code></td>
<td>
<p>Data matrix on the control variable(s) kept outside the 
causal paths.
A constant vector is not allowed as a control variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance on the position of located minima of the cross-validation 
function (default=0.1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftol</code></td>
<td>
<p>Fractional tolerance on the value of cross validation function
evaluated at local minima  (default=0.1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradients</code></td>
<td>
<p>Set to TRUE if gradients computations are desired</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Set to TRUE if residuals are desired</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Creates a model object ‘mod’ containing the entire kernel regression output.
If this function is called as <code>mod=kern_ctrl(x,y,ctrl=z)</code>, the researcher can
simply type <code>names(mod)</code> to reveal the large variety of outputs produced by ‘npreg’ 
of the ‘np’ package.
The user can access all of them at will using the dollar notation of R.
</p>


<h3>Note</h3>

<p>This is a work horse for causal identification.
</p>


<h3>Author(s)</h3>

<p>Prof. H. D. Vinod, Economics Dept., Fordham University, NY
</p>


<h3>References</h3>

<p>Vinod, H. D. 'Generalized Correlation and Kernel Causality with 
Applications in Development Economics' in Communications in 
Statistics -Simulation and Computation, 2015, 
<a href="https://doi.org/10.1080/03610918.2015.1122048">doi:10.1080/03610918.2015.1122048</a>
</p>


<h3>See Also</h3>

<p>See <code>kern</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
set.seed(34);x=matrix(sample(1:600)[1:50],ncol=5)
require(np)
k1=kern_ctrl(x[,1],x[,2],ctrl=x[,4:5])
print(k1$R2) #prints the R square of the kernel regression

## End(Not run)

</code></pre>


</div>