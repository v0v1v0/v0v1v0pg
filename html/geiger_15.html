<div class="container">

<table style="width: 100%;"><tr>
<td>bd.ms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> estimate net diversification rate </h2>

<h3>Description</h3>

<p>estimating net diversification rate with confidence limits and testing diversities
</p>


<h3>Usage</h3>

<pre><code class="language-R">bd.ms(phy=NULL, time, n, missing = 0, crown=TRUE, epsilon = 0)
bd.km(phy=NULL, time, n, missing = 0, crown=TRUE)
crown.p(phy=NULL, time, n, r, epsilon)
stem.p(phy=NULL, time, n, r, epsilon)
crown.limits(time, r, epsilon, CI=0.95)
stem.limits(time, r, epsilon, CI=0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of class 'phylo' (see <b>Details</b>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> time interval (can be a vector) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of extant species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>net diversification rate, birth - death </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p> extinction rate as a fraction of speciation rate </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p> number of taxa missing from tree </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crown</code></td>
<td>
<p>whether time is treated as crown age (or otherwise as stem age)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>confidence level for estimated parameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

	
<p><code>bd.ms</code> uses the Magallon and Sanderson (2000) method to calculate net diversification rate for a clade given extant diversity and age. <code>bd.km</code> 
computes the Kendall-Moran estimate of speciation rate, which assumes a complete phylogenetic tree.
</p>
<p>Associated functions <code>crown.p</code> and <code>stem.p</code> also calculate the probability of obtaining a clade with at least <code>n</code> species given 
a net diversification rate (<code>r</code>), extinction fraction (<code>epsilon</code>), and <code>time</code> interval. Associated functions <code>stem.limits</code> and 
<code>crown.limits</code> generate confidence limits on extant diversity given a net diversification rate (<code>r</code>), extinction fraction (<code>epsilon</code>), 
and <code>time</code> interval.
</p>
<p>Where a function calls for a <code>time</code> and an <code>n</code> element, a tree may be given instead (as argument <code>phy</code>). The argument <code>n</code> is taken from the number of tips in the tree. The method 
will attempt to discern whether the model should be fitted assuming <code>crown</code> or <code>stem</code>.  If the tree has a non-NULL <code>phy$root.edge</code> element, the length will be assumed for the stem and <code>crown</code> is assumed to be <code>FALSE</code> (see also <code>read.tree</code>). 
</p>


<h3>Value</h3>


<ul>
<li>
<p><b>bd.ms</b> returns net diversification rate (<code>r</code> = <code>lambda</code> - <code>mu</code>)
</p>
</li>
<li>
<p><b>bd.km</b> returns speciation rate assuming a completely sampled tree
</p>
</li>
<li>
<p><b>crown.p</b> and <b>stem.p</b> return the probability of obtaining a clade as big as (or bigger than) size <code>n</code>, given 
<code>time</code>, <code>r</code>, and <code>epsilon</code>
</p>
</li>
<li>
<p><b>crown.limits</b> and <b>stem.limits</b> return lower (<code>lb</code>) and upper (<code>ub</code>) confidence intervals for clade size given <code>time</code>, 
<code>r</code>, and <code>epsilon</code>	
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p> LJ Harmon and C Brock </p>


<h3>References</h3>

 
<p>Magallon S and MJ Sanderson. 2000. Absolute diversification rates in angiosperm clades. <em>Evolution</em> 55:1762-1780.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

geo=get(data(geospiza))

# Assuming no extinction
bd.ms(phy=geo$phy, missing=1, epsilon=0)

# Assuming high extinction
bd.ms(phy=geo$phy, missing=1, epsilon=0.9)


</code></pre>


</div>