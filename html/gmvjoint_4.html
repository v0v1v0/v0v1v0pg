<div class="container">

<table style="width: 100%;"><tr>
<td>cond.ranefs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain conditional distribution of the random effects</h2>

<h3>Description</h3>

<p>Obtain the conditional distribution of the random effects of a <code>joint</code> model
fit. This is achieved by a Metropolis scheme. Approximate normality across random effects is
expected, and could be useful in diagnosing potential issues surrounding model fits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cond.ranefs(fit, burnin = 500L, N = 3500L, tune = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a joint model fit by the <code>joint</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Number of burn-in iterations to discard, defaults to 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of MC iterations to carry out <em>post</em> burn-in, defaults to 3500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune</code></td>
<td>
<p>Tuning parameter, problem-specific, defaults to 2.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of class <code>cond.b.joint</code> containing: </p>

<dl>
<dt>walks</dt>
<dd>
<p>A list of length <code>n</code> containing the history of <code class="reqn">b_i</code> post burn-in.</p>
</dd>
<dt>acceptance</dt>
<dd>
<p>A numeric vector containing the acceptance rate for each sampled subject.</p>
</dd>
<dt>M</dt>
<dd>
<p>The ModelInfo list from <code>joint</code>. Used by S3 methods for class 
<code>cond.b.joint</code>.</p>
</dd>
<dt>bhats</dt>
<dd>
<p>Posterior estimates at MLEs for the random effects. Same as <code>ranef(joint)</code>.</p>
</dd>
<dt>Sigmahats</dt>
<dd>
<p>The covariances of <code>bhats</code>.</p>
</dd>
<dt>D</dt>
<dd>
<p>The MLE estimate for the variance-covariance matrix of random effects from 
<code>fit</code>.</p>
</dd>
<dt>q</dt>
<dd>
<p>Dimension of random effects.</p>
</dd>
<dt>K</dt>
<dd>
<p>Number of responses.</p>
</dd> 
<dt>qnames</dt>
<dd>
<p>The names of the random effects as determined by call to <code>joint</code>.</p>
</dd>
<dt>burnin</dt>
<dd>
<p>The amount of burn-in used.</p>
</dd>
<dt>N</dt>
<dd>
<p>Number of MC iterations.</p>
</dd>
<dt>tune</dt>
<dd>
<p>tuning parameter used</p>
</dd>
<dt>nobs</dt>
<dd>
<p>The number of observations for each subject for each response.</p>
</dd>
<dt>elapsed.time</dt>
<dd>
<p>Time taken for <code>cond.ranefs</code> to complete.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>ranef.joint</code> <code>plot.cond.b.joint</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
dat &lt;- simData()$data
long.formulas &lt;- list(Y.1 ~ time + cont + bin + (1 + time|id), 
                      Y.2 ~ time + cont + bin + (1 + time|id))
surv.formula &lt;- Surv(survtime, status) ~ bin
fit &lt;- joint(long.formulas, surv.formula, dat, list("gaussian","gaussian"))
cond.b &lt;- cond.ranefs(fit, burnin = 50L, N = 1000, tune = 2)
cond.b
plot(cond.b) # Overall 
plot(cond.b, id = 1) # Plot the first subject (see plot.cond.b.joint).

</code></pre>


</div>