<div class="container">

<table style="width: 100%;"><tr>
<td>lehmer_mean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lehmer mean</h2>

<h3>Description</h3>

<p>Calculate a weighted Lehmer mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lehmer_mean(r)

contraharmonic_mean(x, w = NULL, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A finite number giving the order of the Lehmer mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A strictly positive numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A strictly positive numeric vector of weights, the same length as
<code>x</code>. The default is to equally weight each element of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Should missing values in <code>x</code> and <code>w</code> be removed? By
default missing values in <code>x</code> or <code>w</code> return a missing value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>lehmer_mean()</code> returns a function to compute the Lehmer
mean of order <code>r</code> of <code>x</code> with weights <code>w</code>, which is
calculated as the arithmetic mean of <code>x</code> with weights <code class="reqn">wx^{r-1}</code>.
This is also called the counter-harmonic mean or generalized anti-harmonic
mean. See Bullen (2003, p. 245) for a definition, or
<a href="https://en.wikipedia.org/wiki/Lehmer_mean">https://en.wikipedia.org/wiki/Lehmer_mean</a>.
</p>
<p>The Lehmer mean of order 2 is sometimes called the contraharmonic (or
anti-harmonic) mean. The function <code>contraharmonic_mean()</code> simply calls
<code>lehmer_mean(2)()</code>. Like the generalized mean, the contraharmonic mean
is the solution to an optimal prediction problem: choose <code class="reqn">m</code> to minimize
<code class="reqn">\sum_{i = 1}^{n} w_{i} \left(\frac{x_{i}}{m} - 1 \right)^2</code>. The Lehmer mean of order -1 has a similar interpretation,
replacing <code class="reqn">\frac{x_{i}}{m}</code> with <code class="reqn">\frac{m}{x_{i}}</code>,
and together these bound the harmonic and arithmetic means.
</p>
<p>The Lehmer mean is an alternative to the generalized mean that generalizes
the Pythagorean means. The function <code>lehmer_mean(1)()</code> is identical to
<code>arithmetic_mean()</code>, <code>lehmer_mean(0)()</code> is identical to
<code>harmonic_mean()</code>, and <code>lehmer_mean(0.5)()</code> is identical to
<code>geometric_mean()</code> with two values and no weights. See von der Lippe
(2015) for more details on the use of these means for making price indexes.
</p>


<h3>Value</h3>

<p><code>lehmer_mean()</code> returns a function:
</p>
<pre>function(x, w = NULL, na.rm = FALSE){...}</pre>
<p>This computes the Lehmer mean of order <code>r</code> of <code>x</code> with weights
<code>w</code>.
</p>
<p><code>contraharmonic_mean()</code> returns a numeric value for the Lehmer mean of
order 2.
</p>


<h3>Note</h3>

<p><code>lehmer_mean()</code> can be defined on the extended real line, so that
<code>r = -Inf / Inf</code> returns <code>min()</code>/<code>max()</code>, to agree with the
definition in, e.g., Bullen (2003). This is not implemented, and <code>r</code>
must be finite.
</p>


<h3>References</h3>

<p>Bullen, P. S. (2003). <em>Handbook of Means and Their Inequalities</em>.
Springer Science+Business Media.
</p>
<p>Lehmer, D. H. (1971). On the Compounding of Certain Means.
<em>Journal of Mathematical Analysis and Applications</em>, 36(1): 183-200.
</p>
<p>von der Lippe, P. (2015). Generalized Statistical Means and New Price Index
Formulas, Notes on some unexplored index formulas, their interpretations and
generalizations. Munich Personal RePEc Archive paper no. 64952.
</p>


<h3>See Also</h3>

<p>Other means: 
<code>extended_mean()</code>,
<code>generalized_mean()</code>,
<code>nested_mean()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- 2:3
w &lt;- c(0.25, 0.75)

#---- The Pythagorean means are special cases of the Lehmer mean ----

all.equal(lehmer_mean(1)(x, w), arithmetic_mean(x, w))
all.equal(lehmer_mean(0)(x, w), harmonic_mean(x, w))
all.equal(lehmer_mean(0.5)(x), geometric_mean(x))

#---- Comparing Lehmer means and generalized means ----

# When r &lt; 1, the generalized mean is larger than the corresponding
# Lehmer mean

lehmer_mean(-1)(x, w) &lt; generalized_mean(-1)(x, w)

# The reverse is true when r &gt; 1

lehmer_mean(3)(x, w) &gt; generalized_mean(3)(x, w)

# This implies the contraharmonic mean is larger than the quadratic
# mean, and therefore the Pythagorean means

contraharmonic_mean(x, w) &gt; arithmetic_mean(x, w)
contraharmonic_mean(x, w) &gt; geometric_mean(x, w)
contraharmonic_mean(x, w) &gt; harmonic_mean(x, w)

# ... and the logarithmic mean

contraharmonic_mean(2:3) &gt; logmean(2, 3)

# The difference between the arithmetic mean and contraharmonic mean
# is proportional to the variance of x

weighted_var &lt;- function(x, w) {
  arithmetic_mean((x - arithmetic_mean(x, w))^2, w)
}

arithmetic_mean(x, w) + weighted_var(x, w) / arithmetic_mean(x, w)
contraharmonic_mean(x, w)

#---- Changing the order of the mean ----

# It is easy to modify the weights to turn a Lehmer mean of order r
# into a Lehmer mean of order s because the Lehmer mean can be
# expressed as an arithmetic mean

r &lt;- 2
s &lt;- -3
lehmer_mean(r)(x, w)
lehmer_mean(s)(x, w * x^(r - 1) / x^(s - 1))

# The weights can also be modified to turn a Lehmer mean of order r
# into a generalized mean of order s

lehmer_mean(r)(x, w)
generalized_mean(s)(x, transmute_weights(1, s)(x, w * x^(r - 1)))

# ... and vice versa

lehmer_mean(r)(x, transmute_weights(s, 1)(x, w) / x^(r - 1))
generalized_mean(s)(x, w)

#---- Percent-change contributions ----

# Percent-change contributions for a price index based on the Lehmer
# mean are easy to calculate

scale_weights(w * x^(r - 1)) * (x - 1)

</code></pre>


</div>