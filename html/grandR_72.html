<div class="container">

<table style="width: 100%;"><tr>
<td>FitKineticsGeneSnapshot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the posterior distributions of RNA synthesis and degradation for a particular gene</h2>

<h3>Description</h3>

<p>Compute the posterior distributions of RNA synthesis and degradation for a particular gene
</p>


<h3>Usage</h3>

<pre><code class="language-R">FitKineticsGeneSnapshot(
  data,
  gene,
  columns = NULL,
  reference.columns = NULL,
  dispersion = NULL,
  slot = DefaultSlot(data),
  time.labeling = Design$dur.4sU,
  time.experiment = NULL,
  sample.f0.in.ss = TRUE,
  sample.level = 2,
  beta.prior = NULL,
  return.samples = FALSE,
  return.points = FALSE,
  N = 10000,
  N.max = N * 10,
  CI.size = 0.95,
  correct.labeling = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the grandR object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene</code></td>
<td>
<p>a gene name or symbol or index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>samples or cell representing the same experimental condition (must refer to a unique labeling duration)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference.columns</code></td>
<td>
<p>a reference matrix usually generated by FindReferences to define reference samples for each sample (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>
<p>dispersion parameter for the given columns (if NULL, this is estimated from the data, takes a lot of time!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>the data slot to take f0 and totals from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.labeling</code></td>
<td>
<p>the column in the column annotation table denoting the labeling duration or the labeling duration itself</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.experiment</code></td>
<td>
<p>the column in the column annotation table denoting the experimental time point (can be NULL, see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.f0.in.ss</code></td>
<td>
<p>whether or not to sample f0 under steady state conditions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.level</code></td>
<td>
<p>Define how the NTR is sampled from the hierarchical Bayesian model (must be 0,1, or 2; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.prior</code></td>
<td>
<p>The beta prior for the negative binomial used to sample counts, if NULL, a beta distribution is fit to all expression values and given dispersions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.samples</code></td>
<td>
<p>return the posterior samples of the parameters?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.points</code></td>
<td>
<p>return the point estimates per replicate as well?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the posterior sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.max</code></td>
<td>
<p>the maximal number of posterior samples (necessary if old RNA &gt; f0); if more are necessary, a warning is generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.size</code></td>
<td>
<p>A number between 0 and 1 representing the size of the credible interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct.labeling</code></td>
<td>
<p>whether to correct labeling times</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The kinetic parameters s and d are computed using TransformSnapshot. For that, the sample either must be in steady state
(this is the case if defined in the reference.columns matrix), or if the levels of reference samples from a specific prior time point are known. This time point is
defined by <code>time.experiment</code> (i.e. the difference between the reference samples and samples themselves). If
<code>time.experiment</code> is NULL, then the labeling time of the samples is used (e.g. useful if labeling was started concomitantly with
the perturbation, and the reference samples are unperturbed samples).
</p>
<p>By default, the hierarchical Bayesian model is estimated. If sample.level = 0, the NTRs are sampled from a beta distribution
that approximates the mixture of betas from the replicate samples. If sample.level = 1, only the first level from the hierarchical model
is sampled (corresponding to the uncertainty of estimating the biological variability). If sample.level = 2, the first and second levels
are estimated (corresponding to the full hierarchical model).
</p>
<p>Columns can be given as a logical, integer or character vector representing a selection of the columns (samples or cells).
The expression is evaluated in an environment having the <code>Coldata</code>, i.e. you can use names of <code>Coldata</code> as variables to
conveniently build a logical vector (e.g., columns=Condition=="x").
</p>


<h3>Value</h3>

<p>a list containing the posterior mean of s and s, its credible intervals and,
if return.samples=TRUE a data frame containing all posterior samples
</p>


</div>