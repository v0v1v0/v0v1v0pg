<div class="container">

<table style="width: 100%;"><tr>
<td>forder</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional ordering</h2>

<h3>Description</h3>

<p>Calculates different measures for ordering the functions (or vectors)
from the most extreme to least extreme one
</p>


<h3>Usage</h3>

<pre><code class="language-R">forder(
  curve_sets,
  measure = "erl",
  scaling = "qdir",
  alternative = c("two.sided", "less", "greater"),
  use_theo = TRUE,
  probs = c(0.025, 0.975),
  quantile.type = 7
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>curve_sets</code></td>
<td>
<p>A <code>curve_set</code> object or a list of <code>curve_set</code> objects.
Also <code>envelope</code> objects of <span class="pkg">spatstat</span> and <code>fdata</code> of <span class="pkg">fda.usc</span>
are accepted instead of curve_set objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure</code></td>
<td>
<p>The measure to use to order the functions from the most extreme to the least extreme
one. Must be one of the following: 'rank', 'erl', 'cont', 'area', 'max', 'int', 'int2'. Default is 'erl'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>The name of the scaling to use if measure is 'max', 'int' or 'int2'.
Options include 'none', 'q', 'qdir' and 'st', where 'qdir' is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis.
Must be one of the following: "two.sided" (default), "less" or "greater".
The last two options only available for types <code>'rank'</code>, <code>'erl'</code>,
<code>'cont'</code> and <code>'area'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_theo</code></td>
<td>
<p>Logical. When calculating the measures 'max', 'int', 'int2',
should the theoretical function from <code>curve_set</code> be used (if 'theo' provided),
see <code>deviation_test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A two-element vector containing the lower and upper
quantiles for the measure 'q' or 'qdir', in that order and on the interval [0, 1].
The default values are 0.025 and 0.975, suggested by Myllymäki et al. (2015, 2017).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile.type</code></td>
<td>
<p>As type argument of <code>quantile</code>, how to
calculate quantiles for 'q' or 'qdir'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a <code>curve_set</code> object or an <code>envelope</code> object of <span class="pkg">spatstat</span>,
which contains curves <code class="reqn">T_1(r),\dots,T_s(r)</code>,
the functions are ordered from the most extreme one to the least extreme one
by one of the following measures (specified by the argument <code>measure</code>).
Note that <code>'erl'</code>, <code>'cont'</code> and <code>'area'</code> were proposed as a refinement to
the extreme ranks <code>'rank'</code>, because the extreme ranks can contain many ties.
All of these completely non-parametric measures are smallest for the most extreme functions
and largest for the least extreme ones,
whereas the deviation measures (<code>'max'</code>, <code>'int'</code> and <code>'int2'</code>) obtain largest values
for the most extreme functions.
</p>

<ul>
<li> <p><code>'rank'</code>: extreme rank (Myllymäki et al., 2017).
The extreme rank <code class="reqn">R_i</code> is defined as the minimum of pointwise ranks of the curve
<code class="reqn">T_i(r)</code>, where the pointwise rank is the rank of the value of the curve for a
specific r-value among the corresponding values of the s other curves such that the lowest
ranks correspond to the most extreme values of the curves. How the pointwise ranks are determined
exactly depends on the whether a one-sided (<code>alternative</code> is "less" or "greater") or the
two-sided test (<code>alternative="two.sided"</code>) is chosen.
</p>
</li>
<li> <p><code>'erl'</code>: extreme rank length (Myllymäki et al., 2017).
Considering the vector of pointwise ordered ranks <code class="reqn">\mathbf{R}_i</code> of the ith curve,
the extreme rank length measure <code class="reqn">R_i^{erl}</code> is equal to
</p>
<p style="text-align: center;"><code class="reqn">R_i^{erl} = \frac{1}{s}\sum_{j=1}^{s} \mathbf{1}(\mathbf{R}_j "&lt;" \mathbf{R}_i)</code>
</p>

<p>where <code class="reqn">\mathbf{R}_j "&lt;" \mathbf{R}_i</code> if and only if
there exists <code class="reqn">n\leq d</code> such that for the first k, <code class="reqn">k&lt;n</code>, pointwise ordered
ranks of <code class="reqn">\mathbf{R}_j</code> and <code class="reqn">\mathbf{R}_i</code> are equal and the n'th rank of
<code class="reqn">\mathbf{R}_j</code> is smaller than that of <code class="reqn">\mathbf{R}_i</code>.
The scaling by </p>
<p style="text-align: center;"><code class="reqn">s</code>
</p>
<p> is applied to normalize the ranks following Mrkvička et al. (2019)
and Narisetty and Nair (2016).
</p>
</li>
<li> <p><code>'cont'</code>: continuous rank (Hahn, 2015; Mrkvička et al., 2019)
based on minimum of continuous pointwise ranks
</p>
</li>
<li> <p><code>'area'</code>: area rank (Mrkvička et al., 2019) based on area between continuous
pointwise ranks and minimum pointwise ranks for those argument (r) values for which pointwise
ranks achieve the minimum (it is a combination of erl and cont)
</p>
</li>
<li> <p><code>'max'</code> and <code>'int'</code> and <code>'int2'</code>:
Further options for the <code>measure</code> argument that can be used together with <code>scaling</code>.
See the help in <code>deviation_test</code> for these options of <code>measure</code> and <code>scaling</code>.
These measures are largest for the most extreme functions and smallest for the least extreme ones.
The arguments <code>use_theo</code> and <code>probs</code> are relevant for these measures only (otherwise ignored).
</p>
</li>
</ul>
<p>For details see Myllymäki and Mrkvička et al. (2020, Section 2)
</p>


<h3>Value</h3>

<p>A vector containing one of the above mentioned measures k for each of the functions
in the curve set. If the component <code>obs</code> in the curve set is a vector, then its measure
will be the first component (named 'obs') in the returned vector.
</p>


<h3>References</h3>

<p>Hahn U (2015). “A note on simultaneous Monte Carlo tests.” Technical report, Centre for Stochastic Geometry and advanced Bioimaging, Aarhus University.
</p>
<p>Mrkvička, T., Myllymäki, M., Jilek, M. and Hahn, U. (2020) A one-way ANOVA test for functional data with graphical interpretation. Kybernetika 56(3), 432-458. doi: 10.14736/kyb-2020-3-0432
</p>
<p>Mrkvička, T., Myllymäki, M., Kuronen, M. and Narisetty, N. N. (2022) New methods for multiple testing in permutation inference for the general linear model. Statistics in Medicine 41(2), 276-297. doi: 10.1002/sim.9236
</p>
<p>Myllymäki, M., Grabarnik, P., Seijo, H. and Stoyan. D. (2015). Deviation test construction and power comparison for marked spatial point patterns. Spatial Statistics 11, 19-34. doi: 10.1016/j.spasta.2014.11.004
</p>
<p>Myllymäki, M., Mrkvička, T., Grabarnik, P., Seijo, H. and Hahn, U. (2017). Global envelope tests for spatial point patterns. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 79, 381-404. doi: 10.1111/rssb.12172
</p>
<p>Narisetty, N. N. and Nair, V. J. (2016) Extremal depth for functional data and applications. Journal of the American Statistical Association 111, 1705-1714.
</p>


<h3>See Also</h3>

<p><code>partial_forder</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(requireNamespace("fda", quietly = TRUE)) {
  # Consider ordering of the girls in the Berkeley Growth Study data
  # available from the R package fda, see ?growth, according to their
  # annual heights or/and changes within years.
  # First create sets of curves (vectors), for raw heights and
  # for the differences within the years
  years &lt;- paste(1:18)
  curves &lt;- fda::growth[['hgtf']][years,]
  cset1 &lt;- curve_set(r = as.numeric(years),
                     obs = curves)
  cset2 &lt;- curve_set(r = as.numeric(years[-1]),
                     obs = curves[-1,] - curves[-nrow(curves),])

  # Order the girls from most extreme one to the least extreme one, below using the 'area' measure
  # a) according to their heights
  forder(cset1, measure = 'area')
  # Print the 10 most extreme girl indices
  order(forder(cset1, measure = 'area'))[1:10]
  # b) according to the changes (print indices)
  order(forder(cset2, measure = 'area'))[1:10]
  # c) simultaneously with respect to heights and changes (print indices)
  csets &lt;- list(Height = cset1, Change = cset2)
  order(forder(csets, measure = 'area'))[1:10]
}
</code></pre>


</div>