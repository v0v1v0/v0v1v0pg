<div class="container">

<table style="width: 100%;"><tr>
<td>self-adjoin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjoin a dataset to itself</h2>

<h3>Description</h3>

<p>This function binds a dataset to itself along adjacent pairs of a <code>key</code>
variable. It is invoked by <code>geom_flow()</code> to convert data in lodes
form to something similar to alluvia form.
</p>


<h3>Usage</h3>

<pre><code class="language-R">self_adjoin(
  data,
  key,
  by = NULL,
  link = NULL,
  keep.x = NULL,
  keep.y = NULL,
  suffix = c(".x", ".y")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame in lodes form (repeated measures data; see
<code>alluvial-data</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>Column of <code>data</code> indicating sequential collection; handled as in
<code>tidyr::spread()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>Character vector of variables to self-adjoin by; passed to
<code>dplyr::mutate-joins</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>Character vector of variables to adjoin. Will be replaced by
pairs of variables suffixed by <code>suffix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.x, keep.y</code></td>
<td>
<p>Character vector of variables to associate with the
first (respectively, second) copy of <code>data</code> after adjoining. These
variables can overlap with each other but cannot overlap with <code>by</code> or
<code>link</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>Suffixes to add to the adjoined <code>link</code> variables; passed to
<code>dplyr::mutate-joins</code> functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>self_adjoin</code> invokes <code>dplyr::mutate-joins</code> functions in order to convert
a dataset with measures along a discrete <code>key</code> variable into a dataset
consisting of column bindings of these measures (by any <code>by</code> variables) along
adjacent values of <code>key</code>.
</p>


<h3>See Also</h3>

<p>Other alluvial data manipulation: 
<code>alluvial-data</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># self-adjoin `majors` data
data(majors)
major_changes &lt;- self_adjoin(majors, key = semester,
                             by = "student", link = c("semester", "curriculum"))
major_changes$change &lt;- major_changes$curriculum.x == major_changes$curriculum.y
head(major_changes)

# self-adjoin `vaccinations` data
data(vaccinations)
vaccination_steps &lt;- self_adjoin(vaccinations, key = survey, by = "subject",
                                 link = c("survey", "response"),
                                 keep.x = c("freq"))
head(vaccination_steps)
vaccination_steps &lt;- self_adjoin(vaccinations, key = survey, by = "subject",
                                 link = c("survey", "response"),
                                 keep.x = c("freq"),
                                 keep.y = c("start_date", "end_date"))
head(vaccination_steps)
</code></pre>


</div>