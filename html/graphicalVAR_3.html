<div class="container">

<table style="width: 100%;"><tr>
<td>mlGraphicalVAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Pooled and individual graphical VAR estimation
</h2>

<h3>Description</h3>

<p>This function fits fixed effect temporal and contemporaneous networks over multiple subjects and runs separate graphical VAR models per subject. The algorithm does: (1) pool all data, within-subject center variables and run <code>graphicalVAR</code> to obtain fixed effects, (2) run <code>EBICglasso</code> on subject means to obtain a between-subjects network, (3) run <code>graphicalVAR</code> on data of every subject to obtain individual networks.  See arxiv.org/abs/1609.04156 for more details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mlGraphicalVAR(data, vars, beepvar, dayvar, idvar, scale = TRUE,
              centerWithin = TRUE, gamma = 0.5, verbose = TRUE,
              subjectNetworks = TRUE, lambda_min_kappa_fixed = 0.001,
              lambda_min_beta_fixed = 0.001, lambda_min_kappa = 0.05,
              lambda_min_beta = lambda_min_kappa, lambda_min_glasso = 0.01,
              ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data frame
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>

<p>Vectors of variables to include in the analysis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beepvar</code></td>
<td>

<p>String indicating assessment beep per day (if missing, is added). Adding this argument will cause non-consecutive beeps to be treated as missing!
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dayvar</code></td>
<td>

<p>String indicating assessment day. Adding this argument makes sure that the first measurement of a day is not regressed on the last measurement of the previous day. IMPORTANT: only add this if the data has multiple observations per day.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idvar</code></td>
<td>

<p>String indicating the subject ID
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical, should variables be standardized before estimation?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerWithin</code></td>
<td>

<p>Logical, should subject data be within-person centered before estimating fixed effects?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>EBIC tuning parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical indicating if console messages and the progress bar should be shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subjectNetworks</code></td>
<td>

<p><code>TRUE</code> to estimate all subject numbers, or a vector with IDs of which subject numbers should be estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_min_kappa_fixed</code></td>
<td>

<p>Multiplier of maximal tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_min_beta_fixed</code></td>
<td>

<p>Multiplier of maximal tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_min_kappa</code></td>
<td>

<p>Multiplier of maximal tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_min_beta</code></td>
<td>

<p>Multiplier of maximal tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_min_glasso</code></td>
<td>

<p>Multiplier of maximal tuning parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments sent to <code>graphicalVAR</code>
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>"mlGraphicalVAR"</code> object with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fixedPCC </code></td>
<td>
<p>Estimated fixed effects (partial contemporaneous correlations) of contemporaneous effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedPDC </code></td>
<td>
<p>Estimated fixed effects (partial directed correlations) of temporal effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedResults </code></td>
<td>
<p>Full object of pooled data estimation (fixed effects)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betweenNet </code></td>
<td>
<p>Estimated between-subjects network (partial correlations)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids </code></td>
<td>
<p>Vector of subject IDs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subjectPCC </code></td>
<td>
<p>List of estimated individual contemporaneous networks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subjectPDC </code></td>
<td>
<p>List of estimated individual directed networks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subjecResults </code></td>
<td>
<p>List of full results of individual estimations</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sacha Epskamp &lt;mail@sachaepskamp.com&gt;
</p>


<h3>References</h3>

<p>Epskamp, S., Waldorp, L. J., Mottus, R., &amp; Borsboom, D. Discovering Psychological Dynamics: The Gaussian Graphical Model in Cross-sectional and Time-series Data.
</p>


<h3>See Also</h3>

<p><code>graphicalVAR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Simulate data:
Sim &lt;- simMLgvar(nTime = 50, nPerson = 20, nVar = 3)

# Estimate model:
Res &lt;- mlGraphicalVAR(Sim$data, vars = Sim$vars, idvar = Sim$idvar)

layout(t(1:2))
library("qgraph")

# Temporal fixed effects
qgraph(Res$fixedPDC, title = "Estimated fixed PDC", layout = "circle")
qgraph(Sim$fixedPDC, title = "Simulated fixed PDC", layout = "circle")

# Contemporaneous fixed effects
qgraph(Res$fixedPCC, title = "Estimated fixed PCC", layout = "circle")
qgraph(Sim$fixedPCC, title = "Simulated fixed PCC", layout = "circle")

## End(Not run)
</code></pre>


</div>