<div class="container">

<table style="width: 100%;"><tr>
<td>fir2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Frequency sampling-based FIR filter design</h2>

<h3>Description</h3>

<p>Produce a FIR filter with arbitrary frequency response over frequency bands.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fir2(n, f, m, grid_n = 512, ramp_n = NULL, window = hamming(n + 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>filter order (1 less than the length of the filter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>vector of frequency points in the range from 0 to 1, where 1
corresponds to the Nyquist frequency. The first point of <code>f</code> must be 0
and the last point must be 1. <code>f</code> must be sorted in increasing order.
Duplicate frequency points are allowed and are treated as steps in the
frequency response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>vector of the same length as <code>f</code> containing the desired
magnitude response at each of the points specified in <code>f</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_n</code></td>
<td>
<p>length of ideal frequency response function. <code>grid_n</code>
defaults to 512, and should be a power of 2 bigger than <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ramp_n</code></td>
<td>
<p>transition width for jumps in filter response (defaults to
<code>grid_n / 20</code>). A wider ramp gives wider transitions but has better
stopband characteristics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p>smoothing window. The returned filter is the same shape as the
smoothing window. Default: <code>hamming(n + 1)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function linearly interpolates the desired frequency response onto a
dense grid and then uses the inverse Fourier transform and a Hamming window
to obtain the filter coefficients.
</p>


<h3>Value</h3>

<p>The FIR filter coefficients, a vector of length <code>n + 1</code>, of
class <code>Ma</code>.
</p>


<h3>Author(s)</h3>

<p>Paul Kienzle, <a href="mailto:pkienzle@users.sf.net">pkienzle@users.sf.net</a>.<br>
Conversion to R Tom Short,<br>
adapted by Geert van Boxtel, <a href="mailto:G.J.M.vanBoxtel@gmail.com">G.J.M.vanBoxtel@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code>Ma</code>, <code>filter</code>, <code>fftfilt</code>,
<code>fir1</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">f &lt;- c(0, 0.3, 0.3, 0.6, 0.6, 1)
m &lt;- c(0, 0, 1, 1/2, 0, 0)
fh &lt;- freqz(fir2(100, f, m))
op &lt;- par(mfrow = c(1, 2))
plot(f, m, type = "b", ylab = "magnitude", xlab = "Frequency")
lines(fh$w / pi, abs(fh$h), col = "blue")
# plot in dB:
plot(f, 20*log10(m+1e-5), type = "b", ylab = "dB", xlab = "Frequency")
lines(fh$w / pi, 20*log10(abs(fh$h)), col = "blue")
par(op)

</code></pre>


</div>