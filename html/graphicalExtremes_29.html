<div class="container">

<table style="width: 100%;"><tr>
<td>emst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting extremal minimum spanning tree</h2>

<h3>Description</h3>

<p>Fits an extremal minimum spanning tree, where the edge weights are:
</p>

<ul>
<li>
<p> negative maximized log-likelihoods of the bivariate Huesler-Reiss distributions,
if <code>method = "ML"</code>. See Engelke and Hitz (2020) for details.
</p>
</li>
<li>
<p> empirical extremal variogram, if <code>method = "vario"</code>. See Engelke and Volgushev (2022) for details.
</p>
</li>
<li>
<p> empirical extremal correlation, if <code>method = "chi"</code>. See Engelke and Volgushev (2022) for details.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">emst(data, p = NULL, method = c("vario", "ML", "chi"), cens = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Numeric <code class="reqn">n \times d</code> matrix, where <code>n</code> is the
number of observations and <code>d</code> is the dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Numeric between 0 and 1 or <code>NULL</code>. If <code>NULL</code> (default),
it is assumed that the <code>data</code> are already on multivariate Pareto scale. Else,
<code>p</code> is used as the probability in the function <code>data2mpareto()</code>
to standardize the <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of <code style="white-space: pre;">⁠"vario", "ML", "chi"⁠</code>.
Default is <code>method = "vario"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>
<p>Logical. This argument is considered only if <code>method = "ML"</code>.
If <code>TRUE</code>, then censored likelihood contributions are used for
components below the threshold. By default, <code>cens = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List consisting of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>An <code>igraph::graph</code> object. The fitted minimum spanning tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>

<p>Numeric <code class="reqn">d \times d</code> estimated variogram matrix <code class="reqn">\Gamma</code>
corresponding to the fitted minimum spanning tree.
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Engelke S, Hitz AS (2020).
“Graphical models for extremes (with discussion).”
<em>J. R. Stat. Soc. Ser. B Stat. Methodol.</em>, <b>82</b>, 871–932.<br><br> Engelke S, Volgushev S (2022).
“Structure learning for extremal tree models.”
<em>J. R. Stat. Soc. Ser. B Stat. Methodol.</em>.
<a href="https://doi.org/10.1111/rssb.12556">doi:10.1111/rssb.12556</a>, Forthcoming, https://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/rssb.12556.
</p>


<h3>See Also</h3>

<p>Other structure estimation methods:
<code>data2mpareto()</code>,
<code>eglatent()</code>,
<code>eglearn()</code>,
<code>fit_graph_to_Theta()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fitting a 4-dimensional HR minimum spanning tree
my_graph &lt;- igraph::graph_from_adjacency_matrix(
  rbind(
    c(0, 1, 0, 0),
    c(1, 0, 1, 1),
    c(0, 1, 0, 0),
    c(0, 1, 0, 0)
  ),
  mode = "undirected"
)
n &lt;- 100
Gamma_vec &lt;- c(.5, 1.4, .8)
complete_Gamma(Gamma = Gamma_vec, graph = my_graph) ## full Gamma matrix

set.seed(123)
my_data &lt;- rmpareto_tree(n, "HR", tree = my_graph, par = Gamma_vec)
my_fit &lt;- emst(my_data, p = NULL, method = "ML", cens = FALSE)
</code></pre>


</div>