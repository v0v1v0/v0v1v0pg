<div class="container">

<table style="width: 100%;"><tr>
<td>coefFrame</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return model parameters in a data frame</h2>

<h3>Description</h3>

<p>Fits a model to each subgroup defined by <code>by</code>, then returns a data
frame with one row for each fit and one column for each parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coefFrame(
  mod,
  data,
  by = NULL,
  fit.on = TRUE,
  fitfun,
  keep.unused.levels = TRUE,
  byvar.sep = "\001",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>a model formula, to be passed to by <code>fitfun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame, row subsets of which will be used as the
<code>data</code> argument to <code>fitfun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>names of columns in <code>x</code> that will be used to define the
subgroups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.on</code></td>
<td>
<p>a logical vector indicating which rows of <code>x</code> are to be
used to fit the model (like the <code>subset</code> argument in a lot of other
functions). Can be given in terms of variables in <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitfun</code></td>
<td>
<p>a model fitting function (e.g. lm, nls). More specifically, a
function that expects at least a formula object (as the first argument) and
a data.frame object (passed as an argument named <code>data</code>) and returns a
model object for which a <code>coef</code> method has been defined (e.g. coef.lm,
coef.nls) to extract fit values of model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.unused.levels</code></td>
<td>
<p>Include rows in output for all unique values of
<code>by</code>, even those which were excluded by <code>fit.on</code>. The default
value <code>TRUE</code> should be left alone if you are going to go on to pass the
result to <code>backFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byvar.sep</code></td>
<td>
<p>passed to frameApply, used to form the subsets of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to pass to <code>fitfun</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data frame with a row for each unique row of <code>x[by]</code>, and
column for each model paramter, as well as columns specified in <code>by</code>.
</p>


<h3>Author(s)</h3>

<p>Jim Rogers <a href="mailto:james.a.rogers@pfizer.com">james.a.rogers@pfizer.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# load example data
library(gtools)
data(ELISA)

# Coefficients for four parameter logistic fits:
coefFrame(log(Signal) ~ SSfpl(log(Concentration), A, B, xmid, scal),
           data = ELISA, fitfun = nls,
           by = c("PlateDay", "Read"),
           fit.on = Description == "Standard" &amp; Concentration != 0)

# Coefficients for linear fits:
coefFrame(log(Signal) ~ log(Concentration), 
           data = ELISA, fitfun = lm, 
           by = c("PlateDay", "Read"),
           fit.on = Description == "Standard" &amp; Concentration != 0 )

# Example passing arguments to fitfun, and example of
# error handling during model fitting:
ELISA$Signal[1] &lt;- NA
coefFrame(log(Signal) ~ log(Concentration), 
           data = ELISA, fitfun = lm, na.action = na.fail,
           by = c("PlateDay", "Read"),
           fit.on = Description == "Standard" &amp; Concentration != 0 )




</code></pre>


</div>