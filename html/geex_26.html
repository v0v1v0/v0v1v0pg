<div class="container">

<table style="width: 100%;"><tr>
<td>fay_df_correction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correct sandwich variance inference by Fay's degrees of freedom correction</h2>

<h3>Description</h3>

<p>Computes the degrees of freedom correction described in Fay and
Graubard (2001). See <code>vignette("05_finite_sample_corrections", package = "geex")</code>
for further information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fay_df_correction(components, b = 0.75, L, version)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>components</code></td>
<td>
<p>an object of class <code>sandwich_components</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a numeric value &lt; 1. Defaults to 0.75 as in Fay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>a k x p matrix where p is the dimension of theta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>either 1 or 2, corresponding to hat(d) or tilde(d), respectively</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a scalar corresponding to the estimated degrees of freedom
</p>


<h3>References</h3>

<p>Fay, M. P., &amp; Graubard, B. I. (2001). Small-Sample adjustments for
Wald-type tests using sandwich estimators. Biometrics, 57(4), 1198-1206
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# This example demonstrates usage of the corrections, not a meaningful application
myee &lt;- function(data){
 function(theta){
   c(data$Y1 - theta[1],
   (data$Y1 - theta[1])^2 - theta[2])
  }
}

results &lt;- m_estimate(
   estFUN = myee,
   data = geexex,
   root_control = setup_root_control(start = c(1,1)),
   corrections  = list(
     df_correction1 = correction(fay_df_correction,
                        b = .75, L = c(0, 1), version = 1 ),
     df_correction2 = correction(fay_df_correction,
                        b = .75, L = c(0, 1), version = 2 ))
   )

get_corrections(results)
</code></pre>


</div>