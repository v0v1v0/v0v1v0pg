<div class="container">

<table style="width: 100%;"><tr>
<td>MRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Markov Random Fields Fitting Functions
</h2>

<h3>Description</h3>

<p>The functions <code>MRF()</code> and  <code>MRFA()</code> fit a Gaussian Markov Random Fields (MRF) model. They are used by the functions <code>mrf()</code> and  <code>mrfa()</code> respectively to fit a MRF additive term within GAMLSS 
</p>


<h3>Usage</h3>

<pre><code class="language-R">MRF(y, x, precision = NULL, neighbour = NULL, polys = NULL, 
            area = NULL, weights = rep(1, length(y)), sig2e = 1, 
            sig2b =             1, sig2e.fix = FALSE, 
            sig2b.fix = FALSE, penalty = FALSE, 
            delta = c(0.01, 0.01), shift = c(0, 0))

MRFA(y, x, precision = NULL, neighbour = NULL, polys = NULL, 
           area = NULL, weights = rep(1, length(y)), 
           lambda = NULL, df = NULL, start = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>response variable
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a factor containing the areas
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>the precision matrix if set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighbour</code></td>
<td>
<p>an object containing the neighbour information for the area if set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polys</code></td>
<td>
<p>the polygon information if set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>this argument is here to allow more areas than the levels of the factor <code>x</code>, see example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>prior weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2e</code></td>
<td>
<p>starting values for the error variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2b</code></td>
<td>
<p>starting values for the random field variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2e.fix</code></td>
<td>
<p>whether sig2e is fixed in the fitting, default equals FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2b.fix</code></td>
<td>
<p>whether sig2B is fixed in the fitting, default equals FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>whether quadratic penalty is required to help convergence in for flat likelihoods, this is equivalent of putting a normal prior distribution for the log-sigmas e.g. <code>logsig2e-N(shift, 1/delta)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the precision of the prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>the mean of the prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>smoothing parameter for <code>MRFA</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting value for the smoothing parameter <code>lambda</code> for <code>MRFA</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>for fixing the degrees of freedom (only in <code>MRFA()</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are two functions for fitting Markov random fields: i) <code>MRF())</code>  which uses the Q-function (marginal likelihood) for estimating the <code>sig2e</code> and <code>sig2b</code> parameters and ii) <code>MRFA()</code> which estimates the smoothing parameter <code>lambda=sig2e/sig2b</code> using the "alternating" method.
</p>


<h3>Value</h3>

<p>a fitted MRF object
</p>


<h3>Author(s)</h3>

<p>Fernanda De Bastiani, Mikis Stasinopoulos, Robert Rigby and Vlasios Voudouris.
</p>
<p>Maintainer: Fernanda &lt;fernandadebastiani@gmail.com&gt;
</p>


<h3>References</h3>

<p>De Bastiani, F. Rigby, R. A., Stasinopoulos, D. M.,  Cysneiros, A. H. M. A. and Uribe-Opazo, M. A. (2016) Gaussian Markov random spatial models in GAMLSS. <em>Journal of Applied Statistics</em>, pp 1-19.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Rue and Held (2005) <em>Gaussian markov random fields: theory and applications</em>, Chapman  &amp; Hall, USA. 
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code>mrf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mgcv)
data(columb)
data(columb.polys)
vizinhos=polys2nb(columb.polys)
precisionC &lt;- nb2prec(vizinhos,x=columb$district)
# MRFA
 m1&lt;-MRFA(columb$crime, columb$district, polys=columb.polys)
m11&lt;-MRFA(columb$crime, columb$district, precision=precisionC)
m12&lt;-MRFA(columb$crime, columb$district,  neighbour=vizinhos)
draw.polys(columb.polys, m12, scheme="heat",swapcolors=TRUE)
## Not run: 
# MRF 
  m2&lt;-MRF(columb$crime, columb$district, polys=columb.polys)
 m21&lt;-MRF(columb$crime, columb$district, precision=precisionC)
 m22&lt;-MRF(columb$crime, columb$district, neighbour=vizinhos)
AIC(m1, m11,m12,m2, m21, m22, k=0)
draw.polys(columb.polys, m12, scheme="heat",swapcolors=TRUE)
# removing one area
columb2 &lt;- columb[-5,]
# creating new precision matrix
precisionC2 &lt;- nb2prec(vizinhos,x=columb$district,area=columb$district)
# MRFA 
# new data but declaring  area
m11&lt;-MRFA(columb2$crime, columb2$district, polys=columb.polys, area=columb$district)
# new data old polys
m112&lt;-MRFA(columb2$crime, columb2$district, polys=columb.polys)
# new data old precision old area
m111&lt;-MRFA(columb2$crime, columb2$district, precision=precisionC,area=columb$district)
# new data old neighbour old area
m121&lt;-MRFA(columb2$crime, columb2$district,  neighbour=vizinhos,area=columb$district)
# new data new precision old area
m113&lt;-MRFA(columb2$crime, columb2$district, precision=precisionC2,area=columb$district)
AIC(m11,m112,m111,m121,m113, k=0)
m11&lt;-MRFA(columb2$crime, columb2$district, polys=columb.polys, area=columb$district)
# new data old polys
m112&lt;-MRFA(columb2$crime, columb2$district, polys=columb.polys)
# new data old precision old area
m111&lt;-MRFA(columb2$crime, columb2$district, precision=precisionC,area=columb$district)
# new data old neighbour old area
m121&lt;-MRFA(columb2$crime, columb2$district,  neighbour=vizinhos,area=columb$district)
# new data new precision old area
m113&lt;-MRFA(columb2$crime, columb2$district, precision=precisionC2,area=columb$district)
AIC(m11,m112,m111,m121,m113, k=0)
draw.polys(columb.polys, fitted(m11))

## End(Not run)
</code></pre>


</div>