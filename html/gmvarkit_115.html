<div class="container">

<table style="width: 100%;"><tr>
<td>redecompose_Omegas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>In the decomposition of the covariance matrices (Muirhead, 1982, Theorem A9.9), change
the order of the covariance matrices.</h2>

<h3>Description</h3>

<p><code>redecompose_Omegas</code> exchanges the order of the covariance matrices in
the decomposition of Muirhead (1982, Theorem A9.9) and returns the new decomposition.
</p>


<h3>Usage</h3>

<pre><code class="language-R">redecompose_Omegas(M, d, W, lambdas, perm = 1:sum(M))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<dl>
<dt>For <strong>GMVAR</strong> and <strong>StMVAR</strong> models:</dt>
<dd>
<p>a positive integer specifying the number of mixture components.</p>
</dd>
<dt>For <strong>G-StMVAR</strong> models:</dt>
<dd>
<p>a size (2x1) integer vector specifying the number of <em>GMVAR type</em> components <code>M1</code>
in the first element and <em>StMVAR type</em> components <code>M2</code> in the second element. The total number of mixture components
is <code>M=M1+M2</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the number of time series in the system.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>a length <code>d^2</code> vector containing the vectorized W matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdas</code></td>
<td>
<p>a length <code>d*(M-1)</code> vector of the form <strong><code class="reqn">\lambda_{2}</code></strong><code class="reqn">,...,</code><strong><code class="reqn">\lambda_{M}</code></strong>
where <strong><code class="reqn">\lambda_{m}</code></strong><code class="reqn">=(\lambda_{m1},...,\lambda_{md})</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm</code></td>
<td>
<p>a vector of length <code>M</code> giving the new order of the covarince matrices
(relative to the current order)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We consider the following decomposition of positive definite covariannce matrices:
<code class="reqn">\Omega_1 = WW'</code>, <code class="reqn">\Omega_m = W\Lambda_{m}W'</code>, <code class="reqn">m=2,..,M</code> where <code class="reqn">\Lambda_{m} = diag(\lambda_{m1},...,\lambda_{md})</code>
contains the strictly postive eigenvalues of <code class="reqn">\Omega_m\Omega_1^{-1}</code> and the column of the invertible <code class="reqn">W</code> are the
corresponding eigenvectors. Note that this decomposition does not necessarily exists for <code class="reqn">M &gt; 2</code>.
</p>
<p>See Muirhead (1982), Theorem A9.9 for more details on the decomposition and the source code for more details on the reparametrization.
</p>


<h3>Value</h3>

<p>Returns a <code class="reqn">d^2 + (M - 1)*d x 1</code> vector of the form <code>c(vec(new_W), new_lambdas)</code>
where the lambdas parameters are in the regimewise order (first regime 2, then 3, etc) and the
"new W" and "new lambdas" are constitute the new decomposition with the order of the covariance
matrices given by the argument <code>perm</code>. Notice that if the first element of <code>perm</code>
is one, the W matrix will be the same and the lambdas are just re-ordered.
</p>
<p><strong>Note that unparametrized zero elements ARE present in the returned W!</strong>
</p>


<h3>Warning</h3>

<p>No argument checks! Does not work with dimension <code class="reqn">d=1</code> or with only
one mixture component <code class="reqn">M=1</code>.
</p>


<h3>References</h3>


<ul><li>
<p> Muirhead R.J. 1982. Aspects of Multivariate Statistical Theory, <em>Wiley</em>.
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R"> d &lt;- 2
 M &lt;- 2
 Omega1 &lt;- matrix(c(2, 0.5, 0.5, 2), nrow=d)
 Omega2 &lt;- matrix(c(1, -0.2, -0.2, 1), nrow=d)

 # Decomposition with Omega1 as the first covariance matrix:
 decomp1 &lt;- diag_Omegas(Omega1, Omega2)
 W &lt;- matrix(decomp1[1:d^2], nrow=d, ncol=d)
 lambdas &lt;- decomp1[(d^2 + 1):length(decomp1)]
 tcrossprod(W) # = Omega1
 W%*%tcrossprod(diag(lambdas), W) # = Omega2

 # Reorder the covariance matrices in the decomposition so that now
 # the first covariance matrix is Omega2:
 decomp2 &lt;- redecompose_Omegas(M=M, d=d, W=as.vector(W), lambdas=lambdas,
                               perm=2:1)
 new_W &lt;- matrix(decomp2[1:d^2], nrow=d, ncol=d)
 new_lambdas &lt;- decomp2[(d^2 + 1):length(decomp2)]
 tcrossprod(new_W) # = Omega2
 new_W%*%tcrossprod(diag(new_lambdas), new_W) # = Omega1
</code></pre>


</div>