<div class="container">

<table style="width: 100%;"><tr>
<td>qdir_envelope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global scaled maximum absolute difference (MAD) envelope tests</h2>

<h3>Description</h3>

<p>Performs the global scaled MAD envelope tests, either directional quantile or studentised,
or the unscaled MAD envelope test. These tests correspond to calling the
function <code>global_envelope_test</code> with <code>type="qdir"</code>, <code>type = "st"</code> and
<code>type="unscaled"</code>, respectively. The functions <code>qdir_envelope</code>, <code>st_envelope</code> and
<code>unscaled_envelope</code> have been kept for historical reasons;
preferably use <code>global_envelope_test</code> with the suitable <code>type</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qdir_envelope(curve_set, ...)

st_envelope(curve_set, ...)

unscaled_envelope(curve_set, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>curve_set</code></td>
<td>
<p>A <code>curve_set</code> object, or an <code>envelope</code> object of
<span class="pkg">spatstat</span>. If an envelope object is given, it must contain the summary
functions from the simulated patterns which can be achieved by setting
savefuns = TRUE when calling the function of <span class="pkg">spatstat</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>global_envelope_test</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The directional quantile envelope test (Myllymäki et al., 2015, 2017)
takes into account the unequal variances of the test function T(r)
for different distances r and is also protected against asymmetry of T(r).
</p>
<p>The studentised envelope test (Myllymäki et al., 2015, 2017)
takes into account the unequal variances of the test function T(r)
for different distances r.
</p>
<p>The unscaled envelope test (Ripley, 1981) corresponds to the classical maximum
deviation test without scaling, and leads to envelopes with constant width over the distances r.
Thus, it suffers from unequal variance of T(r) over the distances r and from the asymmetry of
distribution of T(r). We recommend to use the other global envelope tests available,
see <code>global_envelope_test</code> for full list of alternatives.
</p>


<h3>Value</h3>

<p>An object of class <code>global_envelope</code> of <code>combined_global_envelope</code>
which can be printed and plotted directly. See <code>global_envelope_test</code> for more details.
</p>


<h3>References</h3>

<p>Myllymäki, M., Grabarnik, P., Seijo, H. and Stoyan. D. (2015). Deviation test construction and power comparison for marked spatial point patterns. Spatial Statistics 11: 19-34. doi: 10.1016/j.spasta.2014.11.004
</p>
<p>Myllymäki, M., Mrkvička, T., Grabarnik, P., Seijo, H. and Hahn, U. (2017). Global envelope tests for spatial point patterns. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 79: 381–404. doi: 10.1111/rssb.12172
</p>
<p>Ripley, B.D. (1981). Spatial statistics. Wiley, New Jersey.
</p>


<h3>See Also</h3>

<p><code>global_envelope_test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See more examples in ?global_envelope_test
## Testing complete spatial randomness (CSR)
#-------------------------------------------
if(require("spatstat.explore", quietly=TRUE)) {
  X &lt;- spruces
  nsim &lt;- 999 # Number of simulations
  
  ## Test for complete spatial randomness (CSR)
  # Generate nsim simulations under CSR, calculate centred L-function for the data and simulations
  env &lt;- envelope(X, fun="Lest", nsim=nsim, savefuns=TRUE,
                  correction="translate", transform=expression(.-r),
                  simulate=expression(runifpoint(ex=X)))
  res_qdir &lt;- qdir_envelope(env) # The directional quantile envelope test
  plot(res_qdir)

  ## Advanced use:
  # Create a curve set, choosing the interval of distances [r_min, r_max]
  curve_set &lt;- crop_curves(env, r_min=1, r_max=8)
  # The directional quantile envelope test
  res_qdir &lt;- qdir_envelope(curve_set); plot(res_qdir)
  # The studentised envelope test
  res_st &lt;- st_envelope(curve_set); plot(res_st)
  # The unscaled envelope test
  res_unscaled &lt;- unscaled_envelope(curve_set); plot(res_unscaled)
}
</code></pre>


</div>