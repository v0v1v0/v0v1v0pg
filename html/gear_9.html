<div class="container">

<table style="width: 100%;"><tr>
<td>decomp_cov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Decompose covariance matrix</h2>

<h3>Description</h3>

<p><code>decomp_cov</code> decomposes a covariance matrix
<code>v</code>.  If <code>A = decomp_cov(v)</code>, then
<code>tcrossprod(A, A) == v</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">decomp_cov(v, method = "eigen")

decomp.cov(v, method = "eigen")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>An <code class="reqn">N \times N</code> covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used to decompose <code>v</code>.
Valid options are <code>"chol"</code>, <code>"eigen"</code>, or
<code>"svd"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>"chol"</code> method is the fastest but least
stable method.  The <code>"eigen"</code> method is slower, but more
stable.  The <code>"svd"</code> method is the slowest method,
but should be the most stable.
</p>


<h3>Value</h3>

<p>Returns an <code class="reqn">N \times N</code> matrix.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate data
n = 100
coords = matrix(runif(n*2), nrow = n, ncol = 2)
d = as.matrix(dist(coords))
# create covariance matrix
v = 3 * exp(-d/2) + 0.1 * diag(n)

# decompose v using the three methods
d1 = decomp_cov(v, "chol")
d2 = decomp_cov(v, "eigen")
d3 = decomp_cov(v, "svd")

# verify accuracy of decompositions
all.equal(v, tcrossprod(d1))
all.equal(v, tcrossprod(d2), check.attributes = FALSE)
all.equal(v, tcrossprod(d3), check.attributes = FALSE)
</code></pre>


</div>