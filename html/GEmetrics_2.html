<div class="container">

<table style="width: 100%;"><tr>
<td>EnvBV_blup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the best linear unbiased prediction and the conditional variance
matrix of environment-specific breeding values</h2>

<h3>Description</h3>

<p>This function calculates the best linear unbiased prediction
and the conditional variance matrix of environment-specific breeding values
</p>


<h3>Usage</h3>

<pre><code class="language-R">EnvBV_blup(Pheno, K, Omega_G, Omega_E)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pheno</code></td>
<td>
<p>a data frame with three columns: "Y" for phenotypic values,
"Genotype" for genotype names and "Environment" for environment names.
All genotypes names must be included in the set or row and column names of
the "K" matrix. The number of environments must be at least two</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a square kinship or genomic relationship matrix for N genotypes
whose row and column names include those of the "Genotype" column of
the "Pheno" matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega_G</code></td>
<td>
<p>a square matrix with genetic covariances between J environments
whose row and column names correspond to those of the "Environment" column of
the "Pheno" matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega_E</code></td>
<td>
<p>a square matrix with error covariances between J environments
whose row and column names correspond to those of the "Environment" column of
the "Pheno" matrix</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of two elements: a "G_hat" matrix of best linear unbiased prediction
of environment-specific breeding values for the N genotypes (as rows) in J
environments (as columns), and a square conditional variance matrix "P"
of environment-specific breeding values of dimension NJxNJ where each row
block of size N correspond to an environment and the rows of each block
correspond to genotypes
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Set seed for reproductibility
set.seed(123)

## Load "wheat" dataset from BGLR
data("wheat",package = "BGLR")

## Generate a design data frame for all genotypes in 5 environments
Design &lt;- expand.grid(Genotype=rownames(wheat.A),Environment=paste0("Env",1:5))

## Set sparseness by discarding 80% of the combinations
Design &lt;- Design[-sample(nrow(Design),round(nrow(Design)*4/5)),]

## Simulate phenotypic data with default parameter values
DataSim &lt;- Simulate_MET_data(Design=Design,K=wheat.A)


## Calculate the blup and the conditional variance matrix using simulated variance components
## this step can take several seconds
## note that variance can also be estimated (e.g. using BGLR)
BlupEnvBV &lt;- EnvBV_blup(Pheno=DataSim$Pheno,K=wheat.A,Omega_G=DataSim$Omega_G,
                        Omega_E=DataSim$Omega_E)

## Display results
head(BlupEnvBV$G_hat)
BlupEnvBV$P[1:5,1:5]

</code></pre>


</div>