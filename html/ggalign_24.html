<div class="container">

<table style="width: 100%;"><tr>
<td>align_dendro</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reorder or Group layout based on hierarchical clustering</h2>

<h3>Description</h3>

<p>Reorder or Group layout based on hierarchical clustering
</p>


<h3>Usage</h3>

<pre><code class="language-R">align_dendro(
  mapping = aes(),
  ...,
  distance = "euclidean",
  method = "complete",
  use_missing = "pairwise.complete.obs",
  reorder_dendrogram = FALSE,
  merge_dendrogram = FALSE,
  reorder_group = FALSE,
  k = NULL,
  h = NULL,
  plot_dendrogram = TRUE,
  plot_cut_height = NULL,
  root = NULL,
  center = FALSE,
  type = "rectangle",
  size = NULL,
  free_guides = waiver(),
  free_spaces = waiver(),
  plot_data = waiver(),
  theme = waiver(),
  free_labs = waiver(),
  data = NULL,
  set_context = NULL,
  order = NULL,
  name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Additional default list of aesthetic mappings to use for plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>&lt;dyn-dots&gt; Additional arguments passed to
geom_segment().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>A string of distance measure to be used. This must be one of
<code>"euclidean"</code>, <code>"maximum"</code>, <code>"manhattan"</code>, <code>"canberra"</code>, <code>"binary"</code> or
<code>"minkowski"</code>.  Correlation coefficient can be also used, including
<code>"pearson"</code>, <code>"spearman"</code> or <code>"kendall"</code>. In this way, <code>1 - cor</code> will be used
as the distance. In addition, you can also provide a dist
object directly or a function return a dist object. Use
<code>NULL</code>, if you don't want to calculate the distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string of the agglomeration method to be used. This should be
(an unambiguous abbreviation of) one of <code>"ward.D"</code>, <code>"ward.D2"</code>, <code>"single"</code>,
<code>"complete"</code>, <code>"average"</code> (= UPGMA), <code>"mcquitty"</code> (= WPGMA), <code>"median"</code> (=
WPGMC) or <code>"centroid"</code> (= UPGMC). You can also provide a function which
accepts the distance and returns a hclust object.
Alternative, you can supply an object which can be coerced to
hclust.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_missing</code></td>
<td>
<p>An optional character string giving a method for computing
covariances in the presence of missing values. This must be (an abbreviation
of) one of the strings <code>"everything"</code>, <code>"all.obs"</code>, <code>"complete.obs"</code>,
<code>"na.or.complete"</code>, or <code>"pairwise.complete.obs"</code>. Only used when <code>distance</code>
is a correlation coefficient string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder_dendrogram</code></td>
<td>
<p>A single boolean value, indicates whether we should
reorder the dendrogram based on the means. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge_dendrogram</code></td>
<td>
<p>A single boolean value, indicates whether we should
merge multiple dendrograms, only used when previous groups have been
established. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder_group</code></td>
<td>
<p>A single boolean value, indicates whether we should do
Hierarchical Clustering between groups, only used when previous groups have
been established. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer scalar indicates the desired number of groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>A numeric scalar indicates heights where the tree should be cut.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_dendrogram</code></td>
<td>
<p>A boolean value indicates whether plot the dendrogram
tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_cut_height</code></td>
<td>
<p>A boolean value indicates whether plot the cut height.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>A length one string or numeric indicates the root branch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>A boolean value. if <code>TRUE</code>, nodes are plotted centered with
respect to the leaves in the branch. Otherwise (default), plot them in the
middle of all direct child nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string indicates the plot type, <code>"rectangle"</code> or <code>"triangle"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Plot size, can be an unit object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>free_guides</code></td>
<td>
<p>Override the <code>guides</code> argument specified in the layout for
a plot. Options include:
</p>

<ul>
<li> <p><code>waiver()</code>: inherits behavior from the layout.
</p>
</li>
<li> <p><code>NULL</code>: no guide legends will be collected for the plot.
</p>
</li>
<li>
<p> A string containing one or more of <code>"t"</code>, <code>"l"</code>, <code>"b"</code>, and <code>"r"</code> indicates which side of guide legends should be collected for the plot..
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>free_spaces</code></td>
<td>
<p>A string with one or more of <code>"t"</code>, <code>"l"</code>, <code>"b"</code>, and <code>"r"</code>
indicating which border spaces should be removed. Defaults to
<code>waiver()</code>, which inherits from the parent layout. If no
parent, the default is <code>NULL</code>, meaning no spaces are removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_data</code></td>
<td>
<p>A function to transform plot data before rendering. Defaults
to <code>waiver()</code>, which inherits from the parent layout. If
no parent layout, the default is <code>NULL</code>, meaning the data won't be modified.
</p>
<p>Used to modify the data after layout has been created, which should be a data
frame, but before the data is handled of to the ggplot2 for rendering. Use
this hook if the you needs change the default data for all <code>geoms</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme</code></td>
<td>
<p>Default plot theme: One of:
</p>

<ul>
<li> <p><code>waiver()</code>: will inherit from the parent layout.
</p>
</li>
<li> <p><code>NULL</code>: Use the default theme.
</p>
</li>
<li> <p><code>theme()</code>: will be added with the parent layout theme.
</p>
</li>
</ul>
<p><code style="white-space: pre;">⁠Note:⁠</code> The axis title and labels parallel to the layout axis will always be
removed by default. For vertical stack layouts, this refers to the <code>x-axis</code>,
and for horizontal stack layouts, this refers to the <code>y-axis</code>. If you want to
display the axis title or labels, you should manually add
theme() elements for the parallel axis title or labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>free_labs</code></td>
<td>
<p>A string with one or more of <code>"t"</code>, <code>"l"</code>, <code>"b"</code>, and <code>"r"</code> indicating
which axis titles should be free from alignment. Defaults to
<code>waiver()</code>, which inherits from the parent layout. If no
parent layout, no axis titles will be aligned. If <code>NULL</code>, all axis titles
will be aligned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix, data frame, or a simple vector. If an atomic vector is
provided, it will be converted into a one-column matrix. When <code>data = NULL</code>,
the internal <code>layout</code> data will be used by default. Additionally, <code>data</code> can
be a function (including purrr-like lambdas), which will be applied to the
<code>layout</code> data.
</p>
<p>It is important to note that we consider the <code>rows</code> as the observations. It
means the <code>NROW(data)</code> must return the same number with the specific <code>layout</code>
axis (meaning the x-axis for vertical stack layout, or y-axis for horizontal
stack layout).
</p>

<ul>
<li> <p><code>heatmap_layout()</code>: for column annotation, the <code>layout</code> data will be
transposed before using (If data is a <code>function</code>, it will be applied with
the transposed matrix). This is necessary because column annotation uses
heatmap columns as observations, but we need rows.
</p>
</li>
<li> <p><code>stack_layout()</code>: the <code>layout</code> data will be used as it is since we place
all plots along a single axis.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set_context</code></td>
<td>
<p>A single boolean value indicates whether to set the active
context to current plot. If <code>TRUE</code>, all subsequent ggplot elements will be
added into this plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>An single integer for the plot area order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>A string of the plot name. Used to switch the active context in
<code>hmanno()</code> or <code>stack_active()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A new <code>Align</code> object.
</p>


<h3>ggplot2 specification</h3>

<p><code>align_dendro</code> initializes a ggplot <code>data</code> and <code>mapping</code>.
</p>
<p>The internal will always use a default mapping of <code>aes(x = .data$x, y = .data$y)</code>.
</p>
<p>The default ggplot data is the <code>node</code> coordinates, in addition, a
geom_segment layer with a data of the tree segments
<code>edge</code> coordinates will be added.
</p>
<p><code>node</code> and tree segments <code>edge</code> coordinates contains following columns:
</p>

<ul>
<li> <p><code>index</code>: the original index in the tree for the current node
</p>
</li>
<li> <p><code>label</code>: node label text
</p>
</li>
<li> <p><code>x</code> and <code>y</code>: x-axis and y-axis coordinates for current node or the start
node of the current edge.
</p>
</li>
<li> <p><code>xend</code> and <code>yend</code>: the x-axis and y-axis coordinates of the terminal node
for current edge.
</p>
</li>
<li> <p><code>branch</code>: which branch current node or edge is. You can use this column
to color different groups.
</p>
</li>
<li> <p><code>panel</code>: which panel current node is, if we split the plot into panel
using facet_grid, this column will show
which panel current node or edge is from. Note: some nodes may
fall outside panel (between two panel), so there are possible
<code>NA</code> values in this column.
</p>
</li>
<li> <p><code>.panel</code>: Similar with <code>panel</code> column, but always give the correct branch
for usage of the ggplot facet.
</p>
</li>
<li> <p><code>panel1</code> and <code>panel2</code>: The panel1 and panel2 variables have the same
functionality as <code>panel</code>, but they are specifically for the <code>edge</code> data
and correspond to both nodes of each edge.
</p>
</li>
<li> <p><code>leaf</code>: A logical value indicates whether current node is a leaf.
</p>
</li>
</ul>
<h3>See Also</h3>


<ul>
<li> <p><code>dendrogram_data()</code>
</p>
</li>
<li> <p><code>hclust2()</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">ggheatmap(matrix(rnorm(81), nrow = 9)) +
    hmanno("top") +
    align_dendro()
ggheatmap(matrix(rnorm(81), nrow = 9)) +
    hmanno("top") +
    align_dendro(k = 3L)
</code></pre>


</div>