<div class="container">

<table style="width: 100%;"><tr>
<td>ch6</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Code for Chapter 6: GAM Theory</h2>

<h3>Description</h3>

<p>R code from Chapter 6 of the second edition of ‘Generalized Additive Models: An Introduction with R’ is in the examples section below.
</p>


<h3>Author(s)</h3>

<p>Simon Wood &lt;simon@r-project.org&gt;
</p>
<p>Maintainer: Simon Wood &lt;simon@r-project.org&gt;
</p>


<h3>References</h3>

<p>Wood, S.N. (2017) <em>Generalized Additive Models: An Introduction with R</em>, CRC
</p>


<h3>See Also</h3>

<p><code>mgcv</code>, <code>ch6.solutions</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(gamair); library(mgcv)

## 6.13.2 backfitting

set.seed(2) ## simulate some data... 
dat &lt;- gamSim(1,n=400,dist="normal",scale=2)
edf &lt;- c(3,3,8,3)
y &lt;- dat$y
x &lt;- cbind(dat$x0,dat$x1,dat$x2,dat$x3)
f &lt;- x*0; alpha &lt;- mean(y); ok &lt;- TRUE; rss0 &lt;- 0
while (ok) { # backfitting loop
  for (i in 1:ncol(x)) { # loop through the smooth terms
    ep &lt;- y - rowSums(f[,-i]) - alpha
    b &lt;- smooth.spline(x[,i],ep,df=edf[i])
    f[,i] &lt;- predict(b,x[,i])$y
  }
  rss &lt;- sum((y-rowSums(f))^2)
  if (abs(rss-rss0)&lt;1e-6*rss) ok &lt;- FALSE
  rss0 &lt;- rss
}
par(mfrow=c(2,2))
for (i in 1:ncol(x)) {
  plot(x[,i],y-mean(y),col="grey",pch=19,cex=.3)
  ii &lt;- order(x[,i])
  lines(x[ii,i],f[ii,i],col=2,lwd=2)
}

</code></pre>


</div>