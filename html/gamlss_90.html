<div class="container">

<table style="width: 100%;"><tr>
<td>histDist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This function plots the histogram and a fitted (GAMLSS family) distribution to a variable</h2>

<h3>Description</h3>

<p>This function fits constants to the parameters of a GAMLSS family distribution and them plot the histogram and 
the fitted distribution. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">histDist(y, family = NO, freq = NULL, density = FALSE, 
        nbins = 10, xlim = NULL, ylim = NULL, main = NULL, 
        xlab = NULL, ylab = NULL, data = NULL, 
        col.hist = "gray", border.hist = "blue", 
        fg.hist = rainbow(12)[9], line.wd = 2, 
        line.ty = c(1, 2), line.col = c(2, 3), 
        col.main = "blue4", col.lab = "blue4", 
        col.axis = "blue", ...)
        </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector for the response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a <code>gamlss.family</code> distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>the frequencies of the data in <code>y</code> if exist. <code>freq</code> is used as <code>weights</code> in the <code>gamlss</code> fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>default value is FALSE. Change to TRUE if you would like a non-parametric density plot together with the parametric 
fitted distribution plot (for continuous variable only)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>The suggested number of bins (argument passed to <code>truehist()</code> of package MASS).  Either a positive integer, or a character string naming a rule: "Scott" or "Freedman-Diaconis" or "FD". (Case is ignored.) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>the minimum and the maximum x-axis value (if the default values are out of range)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the minimum and the maximum y-axis value (if the default values are out of range)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>the main title for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>the label in the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>the label in the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.hist</code></td>
<td>
<p>the colour of the histogram or barplot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border.hist</code></td>
<td>
<p>the colour of the border of the histogram or barplot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fg.hist</code></td>
<td>
<p>the colour of  axis in the histogram or barplot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.wd</code></td>
<td>
<p>the line width of the fitted distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.ty</code></td>
<td>
<p>the line type of the fitted distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>the line color of the fitted distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.main</code></td>
<td>
<p>the colour for the main title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.lab</code></td>
<td>
<p>the colour of the labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.axis</code></td>
<td>
<p>the color of the axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra arguments to be passed to the <code>gamlss</code> function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function first fits constants for each parameters of a GAMLSS distribution family using the <code>gamlss</code> function  
and them plots the fitted distribution together with the appropriate plot according to whether 
the <code>y</code> variable is of a continuous or discrete type. Histogram is plotted for continuous and barplot for discrete variables. 
The function <code>truehist()</code> of 
Venables and Ripley's MASS package is used for the histogram plotting.  
</p>


<h3>Value</h3>

<p>returns a plot
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code>gamlss</code>, <code>gamlss.family</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(abdom)
histDist(y,family="NO", data=abdom)
# use the ylim 
histDist(y,family="NO", ylim=c(0,0.005), data=abdom)
# bad fit use PE
histDist(y,family="PE",ymax=0.005, data=abdom, line.col="blue")
# discere data counts 
#  Hand at al. p150  Leptinotarsa decemlineata
y &lt;- c(0,1,2,3,4,6,7,8,10,11)
freq &lt;- c(33,12,5,6,5,2,2,2,1,2) 
histDist(y, "NBI", freq=freq)
# the same as 
histDist(rep(y,freq), "NBI")
</code></pre>


</div>