<div class="container">

<table style="width: 100%;"><tr>
<td>hyperbHessian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Two-Sided Hessian for the Hyperbolic Distribution
</h2>

<h3>Description</h3>

<p>Calculates the Hessian of a function, either exactly or approximately. Used to
obtain the information matrix for maximum likelihood estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hyperbHessian(x, param, hessianMethod = "exact",
              whichParam = 1:5)
sumX(x, mu, delta, r, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Data vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>The maximum likelihood estimates parameter vector of the
hyperbolic distribution. There are five different sets of
parameterazations can be used in this function, the first four sets
are listed in <code>hyperbChangePars</code> and the last set is the log
scale of the first set of the parameterization, i.e.,
<code>mu,log(delta),Pi,log(zeta)</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessianMethod</code></td>
<td>
<p>Two methods are available to calculate the
Hessian exactly ( <code>"exact"</code>) or approximately
(<code>"tsHessian")</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichParam</code></td>
<td>
<p>Numeric. A number between 1 to 5 indicating which
set of the parameterization is the specified value in argument
<code>param</code> belong to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Value of the parameter <code class="reqn">\mu</code> of the
hyperbolic distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Value of the parameter <code class="reqn">\delta</code> of the
hyperbolic distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Parameter used in calculating a cumulative sum of the data
vector x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Parameter used in calculating a cumulative sum of the data
vector x.</p>
</td>
</tr>
</table>
<h3>Details</h3>

  
<p>The formulae for the exact Hessian are derived by <code>Maple</code>
software with some simplifications. For now, the exact Hessian can
only be obtained based on the first, second or the last
parameterization sets.  The approximate Hessian is obtained via a
call to <code>tsHessian</code> from the package <code>DistributionUtils</code>.
<code>summary.hyperbFit</code> calls the function <code>hyperbHessian</code> to
calculate the Hessian matrix when the argument <code>hessian =
    TRUE</code>.   
</p>


<h3>Value</h3>

<p><code>hyperbHessian</code> gives the approximate or exact Hessian matrix for
the data vector <code>x</code> and the estimated parameter vector
<code>param</code>.  <code>sumX</code> is a sum term used in calculating the exact
Hessian. It is called by <code>hyperbHessian</code> when the argument
<code>hessianMethod = "exact"</code>.  It is not expected to be called
directly by users.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Christine Yang Dong <a href="mailto:c.dong@auckland.ac.nz">c.dong@auckland.ac.nz</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Calculate the exact Hessian using hyperbHessian:
param &lt;- c(2, 2, 2, 1)
dataVector &lt;- rhyperb(500, param = param)
fit &lt;- hyperbFit(dataVector, method = "BFGS")
coef &lt;- coef(fit)
hyperbHessian(x = dataVector, param = coef, hessianMethod = "exact",
              whichParam = 2)
              
### Or calculate the exact Hessian using summary.hyperbFit method:
summary(fit, hessian = TRUE)


## Calculate the approximate Hessian:
summary(fit, hessian = TRUE, hessianMethod = "tsHessian")
</code></pre>


</div>