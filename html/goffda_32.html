<div class="container">

<table style="width: 100%;"><tr>
<td>quadrature</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quadrature rules for the <span class="pkg">goffda</span> package</h2>

<h3>Description</h3>

<p>Quadrature rules for unidimensional and bidimensional
functions, as enhancements of <code>int.simpson</code> from the
<code>fda.usc-package</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">integral1D(fx, t, int_rule = "trapezoid", equispaced = FALSE,
  verbose = FALSE)

integral2D(fxy, s, t, int_rule = "trapezoid", equispaced_x = FALSE,
  equispaced_y = FALSE, verbose = FALSE)

w_integral1D(t, int_rule = "trapezoid", equispaced = FALSE,
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>a vector of length <code>length(t)</code> with the evaluation of
a univariate function at <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_rule</code></td>
<td>
<p>quadrature rule for approximating the definite
unidimensional integral: trapezoidal rule (<code>int_rule = "trapezoid"</code>)
and extended Simpson rule (<code>int_rule = "Simpson"</code>) are available.
Defaults to <code>"trapezoid"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equispaced</code></td>
<td>
<p>flag to indicate if <code>X_fdata$data</code> is valued in
an equispaced grid or not. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>flag to show information about the procedures. Defaults
to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fxy</code></td>
<td>
<p>a matrix of size <code>c(length(s), length(t))</code> with the
evaluation of a bivariate function at the bivariate grid formed by
<code>s</code> and <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s, t</code></td>
<td>
<p>vectors with grid points where functions are valued.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equispaced_x, equispaced_y</code></td>
<td>
<p>flags to indicate if <code>fxy</code> is valued
in equispaced grids or not, at each one of dimensions. Both default to
<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li>
<p><code>w_integral1D</code>: a vector of length <code>t</code> with the weights
required for the quadrature rule <code>int_rule</code>.
</p>
</li>
<li>
<p><code>integral1D</code>: a scalar with the approximation of the univariate
integral.
</p>
</li>
<li>
<p><code>integral2D</code>: a scalar with the approximation of the bivariate
integral.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Code iterated by Javier Álvarez-Liébana and Eduardo García-Portugués
from the <code>fda.usc-package</code> originals.
</p>


<h3>References</h3>

<p>Press, W. H., Teukolsky, S. A., Vetterling, W. T. and Flannery B. P. (1997).
Numerical Recipes in Fortran 77: the art of scientific computing (2nd ed).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Numerical integral of 1-D functions

# Equispaced grid points
t1 &lt;- seq(0, 1, l = 201)
t2 &lt;- seq(pi / 4, 3 * pi / 2, l = 201)
fx1 &lt;- 2 * (t1^3) - t1^2 + 5 * t1 - 2 # True integral is equal to 2/3
fx2 &lt;- sin(sqrt(t2)) # True integral is equal to 3.673555
int_fx1_trap &lt;- integral1D(fx = fx1, t = t1, int_rule = "trapezoid",
                           equispaced = TRUE)
int_fx1_Simp &lt;- integral1D(fx = fx1, t = t1, int_rule = "Simpson",
                           equispaced = TRUE)

int_fx2_trap &lt;- integral1D(fx = fx2, t = t2, int_rule = "trapezoid",
                           equispaced = TRUE)
int_fx2_Simp &lt;- integral1D(fx = fx2, t = t2, int_rule = "Simpson",
                           equispaced = TRUE)

# Check if the true integrals is approximated properly
abs(int_fx1_trap - 2/3) / (2/3)
abs(int_fx1_Simp - 2/3) / (2/3)
abs(int_fx2_trap - 3.673555) / 3.673555
abs(int_fx2_Simp - 3.673555) / 3.673555

# Non equispaced grid points
t &lt;- c(seq(0, 0.3, l = 50), seq(0.31, 0.6, l = 150),
       seq(0.61, 1, l = 100))
fx &lt;- 2 * (t^3) - t^2 + 5 * t - 2
int_fx_trap &lt;- integral1D(fx = fx, t = t, int_rule = "trapezoid",
                          equispaced = FALSE)
int_fx_Simp &lt;- integral1D(fx = fx, t = t, int_rule = "Simpson",
                          equispaced = FALSE)

# Check if the true integral is approximated properly
abs(int_fx_trap - 2/3) / (2/3)
abs(int_fx_Simp - 2/3) / (2/3)

## Numerical integral of 2-dimensional functions

# Equispaced grid points
s &lt;- seq(0, 2, l = 101)
t &lt;- seq(1, 5, l = 151)
fxy &lt;- outer(s^2, t^3) # True integral is equal to 416
int_fxy_trap &lt;- integral2D(fxy = fxy, s = s, t = t, int_rule = "trapezoid",
                           equispaced_x = TRUE, equispaced_y = TRUE)
int_fxy_Simp &lt;- integral2D(fxy = fxy, s = s, t = t, int_rule = "Simpson",
                           equispaced_x = TRUE, equispaced_y = TRUE)

# Check if the true integral is approximated properly
abs(int_fxy_trap - 416) / 416
abs(int_fxy_Simp - 416) / 416

# Non equispaced grid points
s &lt;- c(seq(0, 0.3, l = 150), seq(0.31, 1.6, l = 100),
       seq(1.61, 2, l = 250))
t &lt;- c(seq(1, 2.6, l = 170), seq(2.61, 4, l = 100),
       seq(4.01, 5, l = 140))
fxy &lt;- outer(s^2, t^3)

int_fxy_trap &lt;- integral2D(fxy = fxy, s = s, t = t, int_rule = "trapezoid",
                           equispaced_x = FALSE, equispaced_y = FALSE)

# Check if the true integral is approximated properly
abs(int_fxy_trap - 416) / 416
</code></pre>


</div>