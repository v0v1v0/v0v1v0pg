<div class="container">

<table style="width: 100%;"><tr>
<td>cr_buildstep_pkgdown</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create buildsteps for deploying an R pkgdown website to GitHub</h2>

<h3>Description</h3>

<p>Create buildsteps for deploying an R pkgdown website to GitHub
</p>


<h3>Usage</h3>

<pre><code class="language-R">cr_buildstep_pkgdown(
  github_repo,
  git_email,
  secret,
  env = NULL,
  build_image = "gcr.io/gcer-public/packagetools:latest",
  post_setup = NULL,
  post_clone = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>github_repo</code></td>
<td>
<p>The GitHub repo to deploy pkgdown website from and to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>git_email</code></td>
<td>
<p>The email the git commands will be identifying as</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>secret</code></td>
<td>
<p>The name of the secret on Google Secret Manager for the git ssh private key</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>A character vector of env arguments to set for all steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>build_image</code></td>
<td>
<p>A docker image with <code>pkgdown</code> installed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_setup</code></td>
<td>
<p>Steps that occur after git setup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_clone</code></td>
<td>
<p>A cr_buildstep that occurs after the repo is cloned</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Its convenient to set some of the above via Build macros, such as <code>github_repo=$_GITHUB_REPO</code> and <code>git_email=$_BUILD_EMAIL</code> in the Build Trigger web UI
</p>
<p>To commit the website to git, cr_buildstep_gitsetup is used for which
you will need to add your git ssh private key to Google Secret Manager
</p>
<p>The R package is installed via install before
running build_site
</p>


<h3>See Also</h3>

<p>Other Cloud Buildsteps: 
<code>cr_buildstep_bash()</code>,
<code>cr_buildstep_decrypt()</code>,
<code>cr_buildstep_df()</code>,
<code>cr_buildstep_docker()</code>,
<code>cr_buildstep_edit()</code>,
<code>cr_buildstep_extract()</code>,
<code>cr_buildstep_gcloud()</code>,
<code>cr_buildstep_gitsetup()</code>,
<code>cr_buildstep_mailgun()</code>,
<code>cr_buildstep_nginx_setup()</code>,
<code>cr_buildstep_packagetests()</code>,
<code>cr_buildstep_run()</code>,
<code>cr_buildstep_r()</code>,
<code>cr_buildstep_secret()</code>,
<code>cr_buildstep_slack()</code>,
<code>cr_buildstep_targets()</code>,
<code>cr_buildstep()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">cr_project_set("my-project")
cr_bucket_set("my-bucket")

# set github repo directly to write it out via cr_build_write()
cr_buildstep_pkgdown("MarkEdmondson1234/googleCloudRunner",
  git_email = "cloudbuild@google.com",
  secret = "github-ssh"
)

# github repo set via build trigger macro _GITHUB_REPO
cr_buildstep_pkgdown("$_GITHUB_REPO",
  git_email = "cloudbuild@google.com",
  secret = "github-ssh"
)

# example including environment arguments for pkgdown build step
cr_buildstep_pkgdown("$_GITHUB_REPO",
  git_email = "cloudbuild@google.com",
  secret = "github-ssh",
  env = c("MYVAR=$_MY_VAR", "PROJECT=$PROJECT_ID")
)
</code></pre>


</div>