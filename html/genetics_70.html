<div class="container">

<table style="width: 100%;"><tr>
<td>LD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pairwise linkage disequilibrium between genetic markers.</h2>

<h3>Description</h3>

<p>Compute pairwise linkage disequilibrium between genetic markers
</p>


<h3>Usage</h3>

<pre><code class="language-R">LD(g1, ...)
## S3 method for class 'genotype'
LD(g1,g2,...)
## S3 method for class 'data.frame'
LD(g1,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g1</code></td>
<td>
<p> genotype object or dataframe containing genotype objects </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g2</code></td>
<td>
<p> genotype object (ignored if g1 is a dataframe) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> optional arguments (ignored) </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Linkage disequilibrium (LD) is the non-random association of
marker alleles and can arise from marker proximity or from selection
bias.
</p>
<p><code>LD.genotype</code> estimates the extent of LD for a single pair of
genotypes.  <code>LD.data.frame</code> computes LD for all pairs of
genotypes contained in a data frame.  Before starting,
<code>LD.data.frame</code> checks the class and number of alleles of each
variable in the dataframe.  If the data frame contains non-genotype
objects or genotypes with more or less than 2 alleles, these will be
omitted from the computation and a warning will be generated.
</p>
<p>Three estimators of LD are computed:
</p>

<ul>
<li>
<p>D raw difference in frequency between the
observed number of AB pairs and the expected number:
</p>
<p style="text-align: center;"><code class="reqn">%
 	D = p_{AB} - p_A p_B %
      </code>
</p>


</li>
<li>
<p>D' scaled D spanning the range [-1,1] 
</p>
<p style="text-align: center;"><code class="reqn">D' = \frac{D}{D_{max} } </code>
</p>

<p>where, if D &gt; 0:
</p>
<p style="text-align: center;"><code class="reqn">%
  	D_{max} = \min( p_A p_b, p_a p_B )  %
      </code>
</p>
 
<p>or if D &lt; 0:
</p>
<p style="text-align: center;"><code class="reqn">%
  	D_{max} = \max{ -p_A p_B, -p_a p_b }  %
      </code>
</p>


</li>
<li>
<p>r correlation coefficient between the markers
</p>
<p style="text-align: center;"><code class="reqn">%
 	r = \frac{-D}{\sqrt( p_A * p_a * p_B * p_b  )} %
      </code>
</p>


</li>
</ul>
<p>where
</p>

<ul>
<li>
<p>- <code class="reqn">p_A</code> is defined as the observed probability of
allele 'A' for marker 1, 
</p>
</li>
<li>
<p>- <code class="reqn">p_a=1-p_A</code> is defined as the observed probability of
allele 'a' for marker 1, 
</p>
</li>
<li>
<p>-<code class="reqn">p_B</code> is defined as the observed probability of
allele 'B' for marker 2, and 
</p>
</li>
<li>
<p>-<code class="reqn">p_b=1-p_B</code> is defined as the observed probability of
allele 'b' for marker 2, and 
</p>
</li>
<li>
<p>-<code class="reqn">p_{AB}</code> is defined as the probability of
the marker allele pair 'AB'. 
</p>
</li>
</ul>
<p>For genotype data, AB/ab cannot be distinguished from
aB/Ab. Consequently, we estimate <code class="reqn">p_{AB}</code> using maximum
likelihood and use this value in the computations.
</p>


<h3>Value</h3>

<p><code>LD.genotype</code> returns a 5 element list:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Linkage disequilibrium estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dprime </code></td>
<td>
<p>Scaled linkage disequilibrium estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>Correlation coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>Number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq</code></td>
<td>
<p>Chi-square statistic for linkage
equilibrium (i.e., D=D'=corr=0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>Chi-square p-value for marker independence</p>
</td>
</tr>
</table>
<p><code>LD.data.frame</code> returns a list with the same elements, but each
element is a matrix where the upper off-diagonal elements contain the
estimate for the corresponding pair of markers.  The other matrix
elements are <code>NA</code>.
</p>


<h3>Author(s)</h3>

<p> Gregory R. Warnes <a href="mailto:greg@warnes.net">greg@warnes.net</a> </p>


<h3>See Also</h3>

 <p><code>genotype</code>, <code>HWE.test</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">
g1 &lt;- genotype( c('T/A',    NA, 'T/T',    NA, 'T/A',    NA, 'T/T', 'T/A',
                  'T/T', 'T/T', 'T/A', 'A/A', 'T/T', 'T/A', 'T/A', 'T/T',
                     NA, 'T/A', 'T/A',   NA) )

g2 &lt;- genotype( c('C/A', 'C/A', 'C/C', 'C/A', 'C/C', 'C/A', 'C/A', 'C/A',
                  'C/A', 'C/C', 'C/A', 'A/A', 'C/A', 'A/A', 'C/A', 'C/C',
                  'C/A', 'C/A', 'C/A', 'A/A') )


g3 &lt;- genotype( c('T/A', 'T/A', 'T/T', 'T/A', 'T/T', 'T/A', 'T/A', 'T/A',
                  'T/A', 'T/T', 'T/A', 'T/T', 'T/A', 'T/A', 'T/A', 'T/T',
                  'T/A', 'T/A', 'T/A', 'T/T') )

# Compute LD on a single pair

LD(g1,g2)

# Compute LD table for all 3 genotypes

data &lt;- makeGenotypes(data.frame(g1,g2,g3))
LD(data)
</code></pre>


</div>