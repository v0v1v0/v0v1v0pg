<div class="container">

<table style="width: 100%;"><tr>
<td>expectedPairs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Expected pairs in an inhomogeneous poisson process
</h2>

<h3>Description</h3>

<p>Compute the expected number of pairs at a given displacement h in a poisson
process with a given intensity function. This corresponds to the integrals
<code class="reqn">\gamma</code> of Shaw et al. 2020. The various functions correspond
to the univariate and bivariate versions of the anisotropic or isotropic
versions of <code class="reqn">\gamma</code>. The final two options (<code>expectedPairs_kernloo</code>
and <code>expectedPairs_iso_kernloo</code>), provide implementations of the leave-out
kernel estimates of <code class="reqn">\gamma</code>: <code class="reqn">\bar \gamma(h)</code> and
<code class="reqn">\bar \gamma ^\mathrm{iso}(r)</code>. In those cases, the point pattern
<code>X</code> itself is passed to the routine, rather than the (true or estimated) intensities
<code>rho</code> etc. The estimators for <code class="reqn">\bar \gamma(h)</code> are only applicable
to univariate processes. See Shaw et al, 2020 for details.</p>


<h3>Usage</h3>

<pre><code class="language-R">expectedPairs(rho, hx, hy=NULL, method=c("mc", "lattice"),
                tol=.005, dx=diff(as.owin(rho)$xrange)/200, maxeval=1e6,
                maxsamp=5e3)

expectedCrossPairs(rho1, rho2=NULL, hx, hy=NULL, method=c("mc", "lattice"),
                tol=.005, dx=diff(as.owin(rho1)$xrange)/200, maxeval=1e6,
                maxsamp=5e3)

expectedPairs_iso(rho, r, tol=.001, maxeval=1e6, maxsamp=5e3)

expectedCrossPairs_iso(rho1, rho2=NULL, r, tol=.001, maxeval=1e6, maxsamp=5e3)

expectedPairs_kernloo(X, hx,hy, sigma=bw.CvL, tol=.005, maxeval=1e6,
                            maxsamp=5e3, leaveoneout=TRUE)

expectedPairs_iso_kernloo(X, r, sigma=bw.CvL, tol=.001, maxeval=1e6,
                                    maxsamp=5e3, leaveoneout=TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho1, rho2, rho</code></td>
<td>

<p>Intensity functions, either of class <code>im</code> or <code>funxy</code>.  This may
be produced by <code>density.ppp</code> or
<code>densityfun.ppp</code>, or provided by a fitted
intensity model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Point pattern of class <code>ppp</code> with the points of
the pattern for which <code class="reqn">\bar \gamma</code> is to be estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hx, hy</code></td>
<td>

<p>For expectedPairs and expectedCrossPairs (i.e. <code class="reqn">\gamma(h)</code>),
the displacements <code class="reqn">h \in \textrm{R}^2</code> to evaluate <code class="reqn">\gamma</code>
at. These can be in any format supported by xy.coords.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>For the isotropic versions <code class="reqn">\gamma^\mathrm{iso}(r)</code>, the
separations <code class="reqn">r</code> at which <code class="reqn">\gamma^\mathrm{iso}</code> is to be
evaluated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Either mc (the default) or lattice. Compute integral using monte-carlo or
on a lattice.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>A tolerance for how precise the integral should be. This is compared to a
standard error for the mc estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Smoothing bandwidth for direct kernel-based estimators <code class="reqn">\bar \gamma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leaveoneout</code></td>
<td>

<p>Use leave-out estimators. This should generally be true except for the purpose of
evaluating the bias of the standard estimators. See Shaw et al 2020 for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxeval</code></td>
<td>

<p>Maximum number of evaluations of rho per iteration. Prevents memory-related
crashes that can occur.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsamp</code></td>
<td>

<p>Maximum number of monte carlo samples per iteration. If this is too large,
you may do more work than required to achieve tol.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx</code></td>
<td>

<p>if method=="lattice", a lattice spacing for the computation. defaults to .01.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The return value is a numeric vector with length equal to the number of
displacements h passed 
</p>


<h3>Author(s)</h3>

<p>Thomas Shaw &lt;shawtr@umich.edu&gt;
</p>


<h3>References</h3>

<p>T Shaw, J Møller, R Waagepetersen. 2020. “Globally Intensity-Reweighted Estimators for
<code class="reqn">K</code>- and pair correlation functions”. arXiv:2004.00527 [stat.ME].
</p>


<h3>See Also</h3>

<p><code>pcfglobal</code>, <code>Kglobal</code>, which use these functions to compute
the normalization functions <code class="reqn">\gamma</code>.
</p>


</div>