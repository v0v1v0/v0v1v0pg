<div class="container">

<table style="width: 100%;"><tr>
<td>GmedianCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GmedianCov</h2>

<h3>Description</h3>

<p>Computes recursively the Geometric median and the (geometric) median covariation matrix  with fast averaged stochastic gradient algorithms. The estimation of the Geometric median is performed first and then the median covariation matrix is estimated, as well as its leading eigenvectors. The original recursive estimator of the median covariation matrix may not be a non negative matrix. A fast projected estimator onto the convex closed cone of the non negative matrices allows to get a non negative solution.</p>


<h3>Usage</h3>

<pre><code class="language-R">GmedianCov(X, init=NULL, nn=TRUE, scores=2, gamma=2, gc=2, alpha=0.75, nstart=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data matrix, with n observations (rows) in dimension d (columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>When <code>NULL</code> the starting point of the algorithm estimating the median is the first observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn</code></td>
<td>
<p>When <code>TRUE</code> the algorithm provides a non negative estimates of the median covariation matrix. When <code>nn=FALSE</code>, the original algorithm is performed, with no guaranty that all the eigenvalues of the estimates are non negative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>An integer <code>q</code>, by default <code>q=2</code>. The function computes the eigenvectors of the median covariation matrix associated to the <code>q</code> largest eigenvalues and the corresponding principal component scores. No output if <code>scores=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Value (positive) of the constant controling the descent steps (see details) for the algorithm computing median.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gc</code></td>
<td>
<p>Value (positive) of the constant controling the descent steps (see details) for algorithm computing the median covariation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Rate of decrease of the descent steps, <code class="reqn"> 1/2 &lt; alpha &lt;=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>Number of time the algorithms are ran.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The (fast) computation of the eigenvectors is performed by  <code>eigs_sym</code> of package <code>RSpectra</code>.
See Cardot, H. and Godichon-Baggioni (2017) for more details on the recursive algorithm. See also <code>Gmedian</code>.
When <code>nn=TRUE</code>, the descent step is bounded above so that the solution remains non negative at each iteration.
The principal components standard deviation is estimed robustly thanks to function <code>scaleTau2</code> from package <code>robustbase</code>.

</p>


<h3>Value</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p>Vector of the geometric median</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmedian</code></td>
<td>
<p>Median covariation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vectors</code></td>
<td>
<p>The <code>scores=q</code> eigenvectors of the median covariation matrix associated to the <code>q</code> largest eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Principal component scores corresponding to the <code>scores=q</code> eigenvectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdev</code></td>
<td>
<p>The <code>scores=q</code> estimates of the standard deviation of the <code>scores=q</code> principal components.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cardot, H., Cenac, P. and Zitt, P-A. (2013). Efficient and fast estimation of the geometric median in Hilbert spaces with an averaged stochastic gradient algorithm. <em>Bernoulli</em>, 19, 18-43.
</p>
<p>Cardot, H. and Godichon-Baggioni, A. (2017). Fast Estimation of the Median Covariation Matrix with Application to Online Robust Principal Components Analysis. TEST, 26, 461-480.

</p>


<h3>See Also</h3>

<p>See also  <code>Gmedian</code> and <code>WeiszfeldCov</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulated data - Brownian paths
n &lt;- 1e3
d &lt;- 20
x &lt;- matrix(rnorm(n*d,sd=1/sqrt(d)), n, d)
x &lt;- t(apply(x,1,cumsum))

## Estimation
median.est &lt;- GmedianCov(x)

par(mfrow=c(1,2))
image(median.est$covmedian) ## median covariation function
plot(c(1:d)/d,median.est$vectors[,1]*sqrt(d),type="l",xlab="Time",
ylab="Eigenvectors",ylim=c(-1.4,1.4))
lines(c(1:d)/d,median.est$vectors[,2]*sqrt(d),lty=2)
</code></pre>


</div>