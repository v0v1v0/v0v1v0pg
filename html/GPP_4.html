<div class="container">

<table style="width: 100%;"><tr>
<td>GPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates a counterfactual with uncertainty using Gaussian process projection</h2>

<h3>Description</h3>

<p>Returns a list of a plot object (after making the plot) of estimated counterfactual values after checking for model convergence and adjusting the noise level, and returns the fitted model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GPP(
  df,
  controlVars,
  nUntreated,
  obvColName,
  obvName,
  outcomeName,
  starttime,
  timeColName,
  ncores = NULL,
  epsilon = 0.02,
  noise = 0.1,
  printMod = FALSE,
  shift = 0.05,
  iter = 25000,
  filepath = NULL,
  legendLoc = "topleft",
  xlabel = NULL,
  ylabel = NULL,
  actualdatacol = "black",
  preddatacol = "red",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The dataframe used for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controlVars</code></td>
<td>
<p>String of column names for control variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nUntreated</code></td>
<td>
<p>The number of untreated units in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obvColName</code></td>
<td>
<p>The column name that includes the observation subject to the counterfactual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obvName</code></td>
<td>
<p>The name of the observation subject to the counterfactual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcomeName</code></td>
<td>
<p>The outcome variable of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starttime</code></td>
<td>
<p>The start year of the counterfactual estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeColName</code></td>
<td>
<p>The name of the column that includes the time variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>The number of cores to be used to run the model. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>The desired level of convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>The baseline level of noise to be added to the model to prevent overfit. Updates as the model runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printMod</code></td>
<td>
<p>Boolean. Defaults FALSE. If TRUE, prints each model block to the console. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>The magnitude of adjustment for the noise level per iteration. Defaults to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of iterations you would like to run. Defaults to 25,000. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filepath</code></td>
<td>
<p>Your preferred place to save the fit data. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendLoc</code></td>
<td>
<p>The preferred location of the legend in the final graph. Defaults to "topleft".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>The label of the x-axis in the final graph. Defaults to input for 'timeColName'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabel</code></td>
<td>
<p>The preferred label of the y-axis in the final graph. Defaults to input for 'outcomeName'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>actualdatacol</code></td>
<td>
<p>The preferred color for plotted line for actual data. Defaults to black.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preddatacol</code></td>
<td>
<p>The preferred color for plotted line for predicted counterfactual data. Defaults to red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters passed to the plot function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We recommend using all cores on your machine to speed up model run time. If you are unsure about the number of cores in your machine, see <code>parallel::detectCores()</code>.
</p>
<p>We recommend keeping printMod as FALSE, otherwise, the function will write the model to the console for every model run on the convergence.
</p>
<p>For iterations, check that your model converged (we recommend all r-hats close to 1 and examining traceplots).
</p>
<p>We recommend creating a new folder for the file path since the Stan fit creates a large number of files at runtime.
</p>


<h3>Value</h3>

<p>A plot of the actual values and the estimated counterfactual values of the model, and the final model fit.
</p>


<h3>Author(s)</h3>

<p>Devin P. Brown <a href="mailto:devinpbrown96@gmail.com">devinpbrown96@gmail.com</a> and David Carlson <a href="mailto:carlson.david@wustl.edu">carlson.david@wustl.edu</a>
</p>


<h3>See Also</h3>

<p><code>plotGPPfit</code> <code>writeMod</code> <code>runMod</code> <code>autoConverge</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(GDPdata)
out = GPP(df = GDPdata, 
    controlVars = c('invest', 'school', 'ind'),
    nUntreated = length(unique(GDPdata$country))-1, 
    obvColName = 'country', obvName = 'West Germany', 
    outcomeName = 'gdp', starttime = 1989, 
    timeColName = 'year',
    ncores = 2)


</code></pre>


</div>