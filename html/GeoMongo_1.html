<div class="container">

<table style="width: 100%;"><tr>
<td>geomongo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>mongodb geospatial methods ( using PyMongo in R )</h2>

<h3>Description</h3>

<p>mongodb geospatial methods ( using PyMongo in R )
</p>
<p>mongodb geospatial methods ( using PyMongo in R )
</p>


<h3>Usage</h3>

<pre><code class="language-R"># init &lt;- geomongo$new(host = 'localhost', port = 27017,

       #                      tz_aware = FALSE, connect = TRUE, ...)
</code></pre>


<h3>Details</h3>

<p>See the reference link for more details on the <em>ellipsis</em> (...) concerning the additional parameters of the MongoClient()
</p>
<p>the <em>geomongo$new</em> method initializes the MongoClient
</p>
<p>the <em>getClient</em> method returns a <em>"pymongo.mongo_client.MongoClient"</em> object
</p>
<p>the <em>read_mongo_bson</em> method allows the user to read a file/string using the <em>bson.json_util</em> module, which loads MongoDB Extended JSON data ( SEE <em>https://stackoverflow.com/questions/42089045/bson-errors-invaliddocument-key-oid-must-not-start-with-trying-to-insert</em> )
</p>
<p>the <em>geoInsert</em> method allows the user to import data to a mongo-db from a <em>folder</em>, <em>file</em> or <em>list</em>
</p>
<p>the <em>geoQuery</em> method allows the user to perform geospatial queries using one of the <em>find</em>, <em>aggregate</em> or <em>command</em> methods
</p>
<p>For spherical query operators to function properly, you must convert distances to radians, and convert from radians to the distances units used by your application.
</p>
<p>To convert distance to radians: divide the distance by the radius of the sphere (e.g. the Earth) in the same units as the distance measurement.
To convert radians to distance: multiply the radian measure by the radius of the sphere (e.g. the Earth) in the units system that you want to convert the distance to.
</p>
<p>The equatorial radius of the Earth is approximately 3,963.2 miles or 6,378.1 kilometers.
</p>
<p>If specifying latitude and longitude coordinates, list the longitude first and then latitude:
</p>
<p>Valid longitude values are between -180 and 180, both inclusive.
Valid latitude values are between -90 and 90 (both inclusive).
</p>


<h3>Methods</h3>


<dl>
<dt><code>geomongo$new(host = 'localhost', port = 27017, tz_aware = FALSE, connect = TRUE, ...)</code></dt>
<dd></dd>
<dt><code>--------------</code></dt>
<dd></dd>
<dt><code>getClient()</code></dt>
<dd></dd>
<dt><code>--------------</code></dt>
<dd></dd>
<dt><code>read_mongo_bson(FILE = NULL, STR = NULL)</code></dt>
<dd></dd>
<dt><code>--------------</code></dt>
<dd></dd>
<dt><code>geoInsert(DATA = NULL, TYPE_DATA = NULL, COLLECTION = NULL, GEOMETRY_NAME = NULL, read_method = "geojsonR")</code></dt>
<dd></dd>
<dt><code>--------------</code></dt>
<dd></dd>
<dt><code>geoQuery(QUERY = NULL, METHOD = NULL, COLLECTION = NULL, DATABASE = NULL, GEOMETRY_NAME = NULL, TO_LIST = FALSE)</code></dt>
<dd></dd>
</dl>
<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-new"><code>geomongo$new()</code></a>
</p>
</li>
<li> <p><a href="#method-getClient"><code>geomongo$getClient()</code></a>
</p>
</li>
<li> <p><a href="#method-read_mongo_bson"><code>geomongo$read_mongo_bson()</code></a>
</p>
</li>
<li> <p><a href="#method-geoInsert"><code>geomongo$geoInsert()</code></a>
</p>
</li>
<li> <p><a href="#method-geoQuery"><code>geomongo$geoQuery()</code></a>
</p>
</li>
<li> <p><a href="#method-clone"><code>geomongo$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-new"></a>



<h4>Method <code>new()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>geomongo$new(
  host = "localhost",
  port = 27017,
  tz_aware = FALSE,
  connect = TRUE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>host</code></dt>
<dd>
<p>(optional) hostname or IP address or Unix domain socket path of a single mongod or mongos instance to connect to, or a mongodb URI, or a list of hostnames / mongodb URIs. See the reference link for more information.</p>
</dd>
<dt><code>port</code></dt>
<dd>
<p>(optional) port number on which to connect</p>
</dd>
<dt><code>tz_aware</code></dt>
<dd>
<p>(optional) if TRUE, datetime instances returned as values in a document by this MongoClient will be timezone aware (otherwise they will be naive)</p>
</dd>
<dt><code>connect</code></dt>
<dd>
<p>(optional) if TRUE (the default), immediately begin connecting to MongoDB in the background. Otherwise connect on the first operation</p>
</dd>
</dl>
</div>


<hr>
<a id="method-getClient"></a>



<h4>Method <code>getClient()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>geomongo$getClient()</pre></div>


<hr>
<a id="method-read_mongo_bson"></a>



<h4>Method <code>read_mongo_bson()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>geomongo$read_mongo_bson(FILE = NULL, STR = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>FILE</code></dt>
<dd>
<p>a character string specifying a valid path to a file ( applies to <em>read_mongo_bson</em> method )</p>
</dd>
<dt><code>STR</code></dt>
<dd>
<p>a character string ( applies to <em>read_mongo_bson</em> method )</p>
</dd>
</dl>
</div>


<hr>
<a id="method-geoInsert"></a>



<h4>Method <code>geoInsert()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>geomongo$geoInsert(
  DATA = NULL,
  TYPE_DATA = NULL,
  COLLECTION = NULL,
  GEOMETRY_NAME = NULL,
  read_method = "geojsonR"
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>DATA</code></dt>
<dd>
<p>a valid path to a file/folder or a list ( applies to <em>geoInsert</em> method )</p>
</dd>
<dt><code>TYPE_DATA</code></dt>
<dd>
<p>a character string. One of 'folder', 'file', 'dict_one' (takes as input a <em>list</em> or a <em>character string</em>) or 'dict_many' (takes as input a <em>list</em> or a <em>character string vector</em>) ( applies to <em>geoInsert</em> method )</p>
</dd>
<dt><code>COLLECTION</code></dt>
<dd>
<p>a <em>pymongo.collection.Collection</em> object ( applies to <em>geoInsert</em> and <em>geoQuery</em> methods )</p>
</dd>
<dt><code>GEOMETRY_NAME</code></dt>
<dd>
<p>a character string specifying the name of the geometry object, as it appears in the file/string ( applies to <em>geoInsert</em> and <em>geoQuery</em> methods )</p>
</dd>
<dt><code>read_method</code></dt>
<dd>
<p>a character string specifying the method to use to read the data. Either using the <em>"geojsonR"</em> (package) or the <em>"mongo_bson"</em> utility function ( applies to <em>geoInsert</em> method )</p>
</dd>
</dl>
</div>


<hr>
<a id="method-geoQuery"></a>



<h4>Method <code>geoQuery()</code>
</h4>



<h5>Usage</h5>

<div class="r"><pre>geomongo$geoQuery(
  QUERY = NULL,
  METHOD = NULL,
  COLLECTION = NULL,
  DATABASE = NULL,
  GEOMETRY_NAME = NULL,
  TO_LIST = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>QUERY</code></dt>
<dd>
<p>a named list specifying the query to use in mongodb ( applies to <em>geoQuery</em> method )</p>
</dd>
<dt><code>METHOD</code></dt>
<dd>
<p>a character string specifying the method to use to perform geospatial queries in mongodb. One of "find", "aggregate" OR "command" ( applies to <em>geoQuery</em> method )</p>
</dd>
<dt><code>COLLECTION</code></dt>
<dd>
<p>a <em>pymongo.collection.Collection</em> object ( applies to <em>geoInsert</em> and <em>geoQuery</em> methods )</p>
</dd>
<dt><code>DATABASE</code></dt>
<dd>
<p>a <em>"pymongo.database.Database"</em> object ( applies to <em>geoQuery</em> method )</p>
</dd>
<dt><code>GEOMETRY_NAME</code></dt>
<dd>
<p>a character string specifying the name of the geometry object, as it appears in the file/string ( applies to <em>geoInsert</em> and <em>geoQuery</em> methods )</p>
</dd>
<dt><code>TO_LIST</code></dt>
<dd>
<p>either TRUE or FALSE. If TRUE then the output of the <em>geoQuery</em> method will be a list, otherwise a data.table (matrix) object ( applies to <em>geoQuery</em> method )</p>
</dd>
</dl>
</div>


<hr>
<a id="method-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>geomongo$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>References</h3>

<p>https://github.com/mongodb/mongo-python-driver, https://docs.mongodb.com/manual/tutorial/calculate-distances-using-spherical-geometry-with-2d-geospatial-indexes/
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

library(GeoMongo)

init = geomongo$new()

getter_client = init$getClient()

init_db = getter_client$get_database("example_db")

init_col = init_db$get_collection("example_collection")

#--------------------------
# geonear using 'aggregate'
#--------------------------

query_geonear = list('$geoNear' = list(near = list(type = "Point", coordinates = c(-122.5, 37.1)),

                     distanceField = "distance", maxDistance = 900 * 1609.34,

                     distanceMultiplier = 1 / 1609.34, spherical = TRUE))


init$geoQuery(QUERY = query_geonear, METHOD = "aggregate", COLLECTION = init_col,

              DATABASE = init_db, GEOMETRY_NAME = "location", TO_LIST = FALSE)

## End(Not run)
</code></pre>


</div>