<div class="container">

<table style="width: 100%;"><tr>
<td>Qresiduals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical normality testing for quantile residuals</h2>

<h3>Description</h3>

<p>Derives quantile residuals of the input model and creates two plots: the first compares density of a standard normal distribution to the residuals' empirical density while the other one is a <em>QQplot</em>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">Qresiduals(model, plot.it = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a model supported by <code>glmxdiag</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>logical, whether to plot the results or not.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Quantile residuals are defined on a continuous cumulative distribution function; for binomial, beta-binomial, poisson and negative binomial regression models the <em>Randomized quantile residuals</em> are used.
</p>
<p>Residuals have an important role inside the global diagnostic of a regression model. Any departure from the standard normal distribution can be considered as a warning that one or more aspects of the model are misspecified. Quantile residuals are particullary useful with models that do not have a continuous response variable, such as a binomial or poisson models; see examples.
</p>


<h3>Value</h3>

<p>Called for side effects but invisibly returns the calculated quantile residuals.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>References</h3>

<p>Peter K. Dunn and Gordon K. Smyth (1996). Randomized Quantile Residuals. Journal of Computational and Graphical Statistics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulate the data

set.seed(10)
n &lt;- 100
x1 &lt;- rt(n, df = 4)
x2 &lt;- rnorm(n, sd = 2)
b &lt;- c(1, .5, .5)
eta &lt;- b[1] + b[2] * x1 + b[3] * x2
prob &lt;- exp(eta)/(1 + exp(eta))
y &lt;- rbinom(n, size = 1, prob = prob)

# The model is correctly specified
mod &lt;- glm(y ~ x1 + x2, family = binomial)

res.p &lt;- residuals(mod, type = 'pearson')
res.d &lt;- residuals(mod, type = 'deviance')
qres &lt;- Qresiduals(mod, plot.it = FALSE)

shapiro.test(res.p) # not normal
shapiro.test(res.d) # not normal
shapiro.test(qres) # normal

y.hat &lt;- fitted(mod)

plot(y.hat, res.p) # uninformative 
plot(y.hat, res.d) # uninformative 
plot(y.hat, qres)

Qresiduals(mod)

</code></pre>


</div>