<div class="container">

<table style="width: 100%;"><tr>
<td>ReadCounts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read a count table</h2>

<h3>Description</h3>

<p>grandR can also be used to analyze standard RNA-seq data, and this function is here to read such data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ReadCounts(
  file,
  design = c(Design$Condition, Design$Replicate),
  classify.genes = ClassifyGenes(),
  rename.sample = NULL,
  filter.table = NULL,
  num.samples = NULL,
  verbose = FALSE,
  sep = "\t"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>a file containing a count matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>Either a design vector (see details), or a data.frame providing metadata for all columns (samples/cells),
or a function that is called with the condition name vector and is supposed to return this data.frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classify.genes</code></td>
<td>
<p>A function that is used to add the <em>type</em> column to the gene annotation table, always a call to ClassifyGenes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rename.sample</code></td>
<td>
<p>function that is applied to each sample name before parsing (or NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.table</code></td>
<td>
<p>function that is applied to the table directly after read it (or NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.samples</code></td>
<td>
<p>number of sample columns containing read counts (can be NULL, see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print status updates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>The column separator used in the file</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The table is assumed to have read counts in the last n columns, which must be named according to sample names.
If num.samples is NULL this n is automatically recognized as the number of numeric columns (so make sure to either
specify num.samples, or that the column immediately prior to the first sample column is *not* numeric).
</p>
<p>If these columns are named systematically in a particular way, the design vector provides
a powerful and easy way to create the column annotations.
</p>
<p>The column names have to contain dots (.) to separate the fields for the column annotation table.
E.g. the name <em>Mock.4h.A</em> will be split into the fields <em>Mock</em>, <em>4h</em> and  <em>A</em>.
For such names, a design vector of length 3 has to be given, that describes the meaning of each field.
A reasonable design vector for the example would be <code>c("Treatment","Time","Replicate")</code>.
Some names are predefined in the list Design.
</p>
<p>The names given in the design vector might even have additional semantics:
E.g. for the name <em>duration.4sU</em> the values are interpreted (e.g. 4h is converted into the number 4,
or 30min into 0.5, or no4sU into 0). Semantics can be user-defined by calling <code>MakeColdata</code>
and using the return value as the design parameter, or a function that calls MakeColdata.
In most cases it is easier to manipulate the <code>Coldata</code> table after loading data instead of using this mechanism;
the build-in semantics simply provide a convenient way to reduce this kind of manipulation in most cases.
</p>
<p>Sometimes you might have forgotten to name all samples consistently (or you simply messed something up).
In this case, the rename.sample parameter can be handy (e.g. to rename a particular misnamed sample).
</p>
<p>Sometimes the table contains more than you want to read. In this case, use the filter.table parameter to preprocess it.
This should be a function that receives a data.frame, and returns a data.frame.
</p>
<p>If there are no columns named "Gene" or "Symbol", the first column is used!
</p>


<h3>Value</h3>

<p>a grandR object
</p>


</div>