<div class="container">

<table style="width: 100%;"><tr>
<td>nbinom2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Family functions for glmmTMB</h2>

<h3>Description</h3>

<p>Family functions for glmmTMB
</p>


<h3>Usage</h3>

<pre><code class="language-R">nbinom2(link = "log")

nbinom1(link = "log")

compois(link = "log")

truncated_compois(link = "log")

genpois(link = "log")

truncated_genpois(link = "log")

truncated_poisson(link = "log")

truncated_nbinom2(link = "log")

truncated_nbinom1(link = "log")

beta_family(link = "logit")

betabinomial(link = "logit")

tweedie(link = "log")

skewnormal(link = "identity")

lognormal(link = "log")

ziGamma(link = "inverse")

t_family(link = "identity")

ordbeta(link = "logit")

nbinom12(link = "log")

bell(link = "log")
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>(character) link function for the conditional mean ("log", "logit", "probit", "inverse", "cloglog", "identity", or "sqrt")</p>
</td>
</tr></table>
<h3>Details</h3>

<p>If specified, the dispersion model uses a log link. Denoting the variance as <code class="reqn">V</code>, the dispersion parameter
as <code class="reqn">\phi=\exp(\eta)</code> (where <code class="reqn">\eta</code> is the linear predictor from the dispersion model),
and the predicted mean as <code class="reqn">\mu</code>:
</p>

<dl>
<dt>gaussian</dt>
<dd>
<p>(from base R): constant <code class="reqn">V=\phi^2</code></p>
</dd>
<dt>Gamma</dt>
<dd>
<p>(from base R) phi is the shape parameter. <code class="reqn">V=\mu\phi</code></p>
</dd>
<dt>ziGamma</dt>
<dd>
<p>a modified version of <code>Gamma</code> that skips checks for zero values, allowing it to be used to fit hurdle-Gamma models</p>
</dd>
<dt>nbinom2</dt>
<dd>
<p>Negative binomial distribution: quadratic parameterization (Hardin &amp; Hilbe 2007). <code class="reqn">V=\mu(1+\mu/\phi) = \mu+\mu^2/\phi</code>.</p>
</dd>
<dt>nbinom1</dt>
<dd>
<p>Negative binomial distribution: linear parameterization (Hardin &amp; Hilbe 2007). <code class="reqn">V=\mu(1+\phi)</code>. <em>Note</em> that the <code class="reqn">phi</code> parameter has opposite meanings in the <code>nbinom1</code> and <code>nbinom2</code> families. In <code>nbinom1</code> overdispersion increases with increasing <code>phi</code> (the Poisson limit is <code>phi=0</code>); in <code>nbinom2</code> overdispersion decreases with increasing <code>phi</code> (the Poisson limit is reached as <code>phi</code> goes to infinity).</p>
</dd>
<dt>nbinom12</dt>
<dd>
<p>Negative binomial distribution: mixed linear/quadratic, as in the <code>DESeq2</code> package or as described by Lindén and Mäntyniemi (2011). <code class="reqn">V=\mu(1+\phi+\mu/psi)</code>. (In Lindén and Mäntyniemi's parameterization, <code class="reqn">\omega = \phi</code> and <code class="reqn">\theta=1/\psi</code>.) If a dispersion model is specified, it applies only to the linear (<code>phi</code>) term.</p>
</dd>
<dt>truncated_nbinom2</dt>
<dd>
<p>Zero-truncated version of nbinom2: variance expression from Shonkwiler 2016. Simulation code (for this and the other truncated count distributions) is taken from C. Geyer's functions in the <code>aster</code> package; the algorithms are described in <a href="https://cran.r-project.org/package=aster/vignettes/trunc.pdf">this vignette</a>.</p>
</dd>
<dt>compois</dt>
<dd>
<p>Conway-Maxwell Poisson distribution: parameterized with the exact mean (Huang 2017), which differs from the parameterization used in the <span class="pkg">COMPoissonReg</span> package (Sellers &amp; Shmueli 2010, Sellers &amp; Lotze 2015). <code class="reqn">V=\mu\phi</code>.</p>
</dd>
<dt>genpois</dt>
<dd>
<p>Generalized Poisson distribution (Consul &amp; Famoye 1992). <code class="reqn">V=\mu\exp(\eta)</code>. (Note that Consul &amp; Famoye (1992) define <code class="reqn">\phi</code> differently.) Our implementation is taken from the <code>HMMpa</code> package, based on Joe and Zhu (2005) and implemented by Vitali Witowski.</p>
</dd>
<dt>beta</dt>
<dd>
<p>Beta distribution: parameterization of Ferrari and Cribari-Neto (2004)
and the <span class="pkg">betareg</span> package (Cribari-Neto and Zeileis 2010); <code class="reqn">V=\mu(1-\mu)/(\phi+1)</code></p>
</dd>
<dt>betabinomial</dt>
<dd>
<p>Beta-binomial distribution: parameterized according to Morris (1997). <code class="reqn">V=\mu(1-\mu)(n(\phi+n)/(\phi+1))</code></p>
</dd>
<dt>tweedie</dt>
<dd>
<p>Tweedie distribution: <code class="reqn">V=\phi\mu^power</code>. The power parameter is restricted to the interval <code class="reqn">1&lt;power&lt;2</code>, i.e. the compound Poisson-gamma distribution. Code taken from the <code>tweedie</code> package, written by Peter Dunn. The power parameter (designated <code>psi</code> in the list of parameters) uses the link function <code>qlogis(psi-1.0)</code>; thus one can fix the power parameter to a specified value using <code>start = list(psi = qlogis(fixed_power-1.0)), map = list(psi = factor(NA))</code>.</p>
</dd>
<dt>t_family</dt>
<dd>
<p>Student-t distribution with adjustable scale and location parameters (also called a <a href="https://en.wikipedia.org/wiki/Pearson_distribution#The_Pearson_type_VII_distribution">Pearson type VII distribution</a>). The shape (degrees of freedom parameter) is fitted with a log link; it may be often be useful to fix the shape parameter using <code>start = list(psi = log(fixed_df)), map = list(psi = factor(NA))</code>.</p>
</dd>
<dt>ordbeta</dt>
<dd>
<p>Ordered beta regression from Kubinec (2022); fits continuous (e.g. proportion) data in the <em>closed</em> interval [0,1]. Unlike the implementation in the <code>ordbeta</code> package, this family will not automatically scale the data. If your response variable is defined on the closed interval [a,b], transform it to [0,1] via <code>y_scaled &lt;- (y-a)/(b-a)</code>.</p>
</dd>
<dt>lognormal</dt>
<dd>
<p>Log-normal, parameterized by the mean and standard deviation <em>on the data scale</em></p>
</dd>
<dt>skewnormal</dt>
<dd>
<p>Skew-normal, parameterized by the mean, standard deviation, and shape (Azzalini &amp; Capitanio, 2014); constant <code class="reqn">V=\phi^2</code></p>
</dd>
<dt>bell</dt>
<dd>
<p>Bell distribution (see Castellares et al 2018).
</p>
</dd> 
</dl>
<h3>Value</h3>

<p>returns a list with (at least) components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>length-1 character vector giving the family name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>length-1 character vector specifying the link function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>a function of either 1 (mean) or 2 (mean and dispersion
parameter) arguments giving a value proportional to the
predicted variance (scaled by <code>sigma(.)</code>)
</p>
</td>
</tr>
</table>
<h3>References</h3>


<ul>
<li>
<p> Azzalini A &amp; Capitanio A (2014). "The skew-normal and related families." Cambridge: Cambridge University Press.
</p>
</li>
<li>
<p> Castellares F, Ferrari SLP, &amp; Lemonte AJ (2018) "On the Bell Distribution and Its Associated Regression Model for Count Data" Applied Mathematical Modelling 56: 172–85. <a href="https://doi.org/10.1016/j.apm.2017.12.014">doi:10.1016/j.apm.2017.12.014</a>
</p>
</li>
<li>
<p> Consul PC &amp; Famoye F (1992). "Generalized Poisson regression model." Communications in Statistics: Theory and Methods 21:89–109.
</p>
</li>
<li>
<p> Ferrari SLP, Cribari-Neto F (2004). "Beta Regression for Modelling Rates and Proportions." <em>J. Appl. Stat.</em>  31(7), 799-815.
</p>
</li>
<li>
<p> Hardin JW &amp; Hilbe JM (2007). "Generalized linear models and extensions." Stata Press.
</p>
</li>
<li>
<p> Huang A (2017). "Mean-parametrized Conway–Maxwell–Poisson regression models for dispersed counts." <em>Statistical Modelling</em> 17(6), 1-22.
</p>
</li>
<li>
<p> Joe H &amp; Zhu R (2005). "Generalized Poisson Distribution: The Property of Mixture of Poisson and Comparison with Negative Binomial Distribution." <em>Biometrical Journal</em> 47(2): 219–29. <a href="https://doi.org/10.1002/bimj.200410102">doi:10.1002/bimj.200410102</a>.
</p>
</li>
<li>
<p> Lindén, A &amp; Mäntyniemi S. (2011). "Using the Negative Binomial Distribution to Model Overdispersion in Ecological Count Data." <em>Ecology</em> 92 (7): 1414–21. <a href="https://doi.org/10.1890/10-1831.1">doi:10.1890/10-1831.1</a>.
</p>
</li>
<li>
<p> Morris  W (1997). "Disentangling Effects of Induced Plant Defenses and Food Quantity on Herbivores by Fitting Nonlinear Models." <em>American Naturalist</em> 150:299-327.
</p>
</li>
<li>
<p> Kubinec R (2022). "Ordered Beta Regression: A Parsimonious, Well-Fitting Model for Continuous Data with Lower and Upper Bounds." <em>Political Analysis</em>. doi:10.1017/pan.2022.20.
</p>
</li>
<li>
<p> Sellers K &amp; Lotze T (2015). "COMPoissonReg: Conway-Maxwell Poisson (COM-Poisson) Regression". R package version 0.3.5. https://CRAN.R-project.org/package=COMPoissonReg
</p>
</li>
<li>
<p> Sellers K &amp; Shmueli G (2010) "A Flexible Regression Model for Count Data." <em>Annals of Applied Statistics</em> 4(2), 943–61. <a href="https://doi.org/10.1214/09-AOAS306">doi:10.1214/09-AOAS306</a>.
</p>
</li>
<li>
<p> Shonkwiler, J. S. (2016). "Variance of the truncated negative binomial distribution." <em>Journal of Econometrics</em> 195(2), 209–210. <a href="https://doi.org/10.1016/j.jeconom.2016.09.002">doi:10.1016/j.jeconom.2016.09.002</a>.
</p>
</li>
</ul>
</div>