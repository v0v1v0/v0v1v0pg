<div class="container">

<table style="width: 100%;"><tr>
<td>vdtest.gnm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for Varying Dispersion Parameter in Generalized Nonlinear Models</h2>

<h3>Description</h3>

<p>Performs Rao's score test for varying dispersion parameter in
weighted and unweighted generalized nonlinear models in which the response
distribution is assumed to be Gaussian, Gamma, or inverse Gaussian.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gnm'
vdtest(model, varformula, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of the class <em>gnm</em> where the distribution of the response
variable is assumed to be <code>gaussian</code>, <code>Gamma</code> or <code>inverse.gaussian</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varformula</code></td>
<td>
<p>an (optional) <code>formula</code> expression of the form <code>~ z1 + z2 + ... + zq</code> describing only the potential explanatory variables for the dispersion. As default, the same explanatory variables are taken as in the model for the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>From the generalized nonlinear model with varying dispersion in which
<code class="reqn">\log(\phi)=\gamma_0 + \gamma_1z_1 + \gamma_2z_2 + ... + \gamma_qz_q</code>, where
<code class="reqn">\phi</code> is the dispersion parameter of the distribution used to describe the
response variable, the Rao's score test (denoted here as <code class="reqn">S</code>) to assess the
hypothesis <code class="reqn">H_0: \gamma=0</code> versus <code class="reqn">H_1: \gamma\neq 0</code> is computed,
where <code class="reqn">\gamma=(\gamma_1,\ldots,\gamma_q)</code>.  The corresponding <em>p</em>-value is
computed from the chi-squared distribution with <code class="reqn">q</code> degrees of freedom,
that is, <em>p</em>-value = Prob<code class="reqn">[\chi^2_{q} &gt; S]</code>. If the object <code>model</code>
corresponds to an unweighted generalized linear model, this test assesses assumptions
of constant variance and constant coefficient of variation on models in which the
response distribution is assumed to be Gaussian and Gamma, respectively.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
<td style="text-align: left;">
<code>statistic</code> </td>
<td style="text-align: left;"> value of the Rao's score test (<code class="reqn">S</code>),</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>df</code>        </td>
<td style="text-align: left;"> number of degrees of freedom (<code class="reqn">q</code>),</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>p.value</code>   </td>
<td style="text-align: left;"> <em>p</em>-value of the test,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>vars</code>   </td>
<td style="text-align: left;"> names of explanatory variables for the dispersion parameter,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Wei B.-C., Shi, J.-Q., Fung W.-K., Hu Y.-Q. (1998) Testing for Varying Dispersion in Exponential Family Nonlinear Models. <em>Annals of the Institute of Statistical Mathematics</em> 50, 277â€“294.
</p>


<h3>See Also</h3>

<p>vdtest.lm, vdtest.glm
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)
vdtest(fit1)
vdtest(fit1,varformula = ~ Nitrogen + Phosphorus + Potassium)

###### Example 2: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit2 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)
vdtest(fit2)
vdtest(fit2,varformula = ~ Temp)
vdtest(fit2,varformula = ~ log(Temp))

###### Example 3: Radioimmunological Assay of Cortisol
data(Cortisol)
fit3 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)
vdtest(fit3)
vdtest(fit3,varformula = ~ lDose)
vdtest(fit3,varformula = ~ exp(lDose))

###### Example 4: Age and Eye Lens Weight of Rabbits in Australia
data(rabbits)
fit4 &lt;- gnm(wlens ~ b1 - b2/(age + b3), family=Gamma(log),
            start=c(b1=5.5,b2=130,b3=35), data=rabbits)
vdtest(fit4)
vdtest(fit4,varformula = ~ age)
vdtest(fit4,varformula = ~ log(age))
</code></pre>


</div>