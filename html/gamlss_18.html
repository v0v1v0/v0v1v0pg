<div class="container">

<table style="width: 100%;"><tr>
<td>bp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bucket plot</h2>

<h3>Description</h3>

<p>A bucket plot is a graphical way to check the skewness and kurtosis of a continuous variable or the residuals of a fitted GAMLSS model. It plots the transformed moment skewness and  transformed moment kurtosis of the variable (or residuals) together with a cloud of points obtained using a non-parametric bootstrap from the original variable (or residuals). It also provides a graphical way of performing the  Jarque-Bera test (JarqueandBera,1980). 
</p>
<p>There are two different bucket plots specified by the <code>type</code> argument:
</p>
<p>i) the <code>moment</code> bucket   and 
ii) the <code>centile</code> bucket which itself can be  <code>central</code> or <code>tail</code> one.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bp(obj = NULL, weights = NULL, 
      type = c("moment", "centile.central", "centile.tail"), 
      xvar = NULL, bootstrap = TRUE, no.bootstrap = 99, 
      col.bootstrap = c("lightblue", "pink", "khaki", 
      "thistle", "tan", "sienna1","steelblue", "coral", "gold", 
      "cyan"), 
      pch.bootstrap = rep(21, 10), asCharacter = TRUE, 
      col.point = rep("black", 10), pch.point = 1:10, 
      lwd.point = 2, text.to.show = NULL, cex.text = 1.5, 
      col.text = "black", show.legend = FALSE, n.inter = 4, 
      xcut.points = NULL, overlap = 0, show.given = TRUE, 
      cex = 1, pch = 21, data = NULL, 
      bar.bg = c(num = "lightblue", fac = "pink"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A <code>gamlss</code> fitted object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>prior weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of bucket plot whether "moment", "centile.central", or "centile.tail".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>the x-variable if need to split the bucket plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>whether to bootstrap the skewness and kurtosis points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.bootstrap</code></td>
<td>
<p>the number of the  bootstrap samples in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.bootstrap</code></td>
<td>
<p>the colour of the  bootstrap samples in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.bootstrap</code></td>
<td>
<p>the character plotting symbol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asCharacter</code></td>
<td>
<p>whether to plot the skewness and kurtosis as character or just  points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.point</code></td>
<td>
<p>the colout of the point is plotted as point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.point</code></td>
<td>
<p>the character symbol for the point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.point</code></td>
<td>
<p>the width of the symbol</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.to.show</code></td>
<td>
<p>whether to show character for the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.text</code></td>
<td>
<p>the <code>cex</code> of the text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.text</code></td>
<td>
<p>the <code>colour</code> of the text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.legend</code></td>
<td>
<p>whether to show the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.inter</code></td>
<td>
<p>number of intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcut.points</code></td>
<td>
<p>cut points for the <code>xvar</code> if need</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>whether the interval id <code>xvar</code> is set should overlap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.given</code></td>
<td>
<p>showing the top part of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>the <code>cex</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>the point character <code>pch</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>if data has to be set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.bg</code></td>
<td>
<p>the backgroud color of the bars in the top of the figure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot displaying the transformed moment skewness and  transformed moment kurtosis of the sample or residual of a model.
</p>


<h3>Note</h3>

<p>The  bucket plot provides an additional residual diagnostic tool that can be used for fitted model checking, alongside other diagnostic tools, for example   worm plots, and Q (and Z) statistics.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>De Bastiani, F.,   Stasinopoulos, D. M., Rigby, R. A., Heller, G. Z., and Lucas A. (2022) Bucket Plot: A Visual Tool for Skewness and Kurtosis Comparisons. send for publication.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>
An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://doi.org/10.18637/jss.v023.i07">doi:10.18637/jss.v023.i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>Stasinopoulos, M. D., Rigby, R. A., and De Bastiani F., (2018) GAMLSS: a distributional regression approach, <em>Statistical Modelling</em>, Vol. <b>18</b>, 
pp, 248-273, SAGE Publications Sage India: New Delhi, India. <a href="https://doi.org/10.1177/1471082X18759144">doi:10.1177/1471082X18759144</a>
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code>wp, Q.stats</code></p>


<h3>Examples</h3>

<pre><code class="language-R">m1 &lt;- gamlss(R~pb(Fl)+pb(A), data=rent, family=GA)
bp(m1)
</code></pre>


</div>