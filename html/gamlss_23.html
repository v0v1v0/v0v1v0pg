<div class="container">

<table style="width: 100%;"><tr>
<td>centiles.pred</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creating  predictive centiles values</h2>

<h3>Description</h3>

<p>This function creates predictive centiles curves for new x-values given a GAMLSS fitted model.
The function has three options: i) for given new x-values and given percentage centiles calculates a matrix containing 
the centiles values for y,
ii) for given new x-values and standard normalized centile values calculates a matrix containing the centiles values for y,
iii) for given new x-values and new y-values calculates the z-scores.  
A restriction of the function is that it applies to models with only one explanatory variable. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">centiles.pred(obj, type = c("centiles", "z-scores", "standard-centiles"), 
             xname = NULL, xvalues = NULL, power = NULL, yval = NULL, 
             cent = c(0.4, 2, 10, 25, 50, 75, 90, 98, 99.6), 
             dev = c(-4, -3, -2, -1, 0, 1, 2, 3, 4), calibration = FALSE,
             plot = FALSE, legend = TRUE,  ylim = NULL,xlim = NULL,
             ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a fitted gamlss object from fitting a gamlss continuous distribution </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the default, "centiles", gets the centiles values given in the option <code>cent</code>. 
<code>type="standard-centiles"</code> gets the standard centiles  given in the <code>dev</code>. 
<code>type="z-scores"</code> gets the z-scores for given y and x new values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xname</code></td>
<td>
<p> the name of the unique explanatory variable (it has to be the same as in the original fitted model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvalues</code></td>
<td>
<p>the new values for the explanatory variable where the prediction will take place</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>if power transformation is needed (but read the note below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yval</code></td>
<td>
<p>the response values for a given x required for the calculation of "z-scores"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cent</code></td>
<td>
<p>a vector with elements the % centile values for which the centile curves have to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev</code></td>
<td>
<p> a vector with elements the standard normalized values for which the centile curves have to be evaluated in the option <code>type="standard-centiles"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibration</code></td>
<td>
<p>whether to calibrate the "centiles", the default is <code>calibrate=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to plot the "centiles" or the "standard-centiles", the default is <code>plot=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>whether a legend is required in the plot or not, the default is <code>legent=TRUE</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>If different <code>ylim</code> is required from the default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>If different <code>xlim</code> is required from the default </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> for extra arguments </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a vector (for option <code>type="z-scores"</code>) or a  matrix for options
<code>type="centiles"</code> or <code>type="standard-centiles"</code>
containing the appropriate values
</p>


<h3>Warning </h3>

<p>See example below of how to use the function when power transformation is used for the x-variables</p>


<h3>Note</h3>

<p>The power option should be only used if the model  </p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, based on ideas of Elaine Borghie 
from the World Health Organization</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code>gamlss</code>, <code>centiles</code>, <code>centiles.split</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## bring the data and fit the model
data(abdom)
a&lt;-gamlss(y~pb(x),sigma.fo=~pb(x), data=abdom, family=BCT)
## plot the centiles
centiles(a,xvar=abdom$x)
##-----------------------------------------------------------------------------
## the first use of the function centiles.pred()
## to calculate the centiles at new x values
##-----------------------------------------------------------------------------
newx&lt;-seq(12,40,2)
mat &lt;- centiles.pred(a, xname="x", xvalues=newx )
mat
## now plot the centile curves  
 mat &lt;- centiles.pred(a, xname="x",xvalues=newx, plot=TRUE )
##-----------------------------------------------------------------------------
## the second use of the function centiles.pred()
## to calculate (nornalised) standard-centiles for new x
## values using the fitted model
##-----------------------------------------------------------------------------
newx &lt;- seq(12,40,2)
mat &lt;- centiles.pred(a, xname="x",xvalues=newx, type="standard-centiles" )
mat
## now plot the standard centiles  
mat &lt;- centiles.pred(a, xname="x",xvalues=newx, type="standard-centiles",
       plot = TRUE )
##-----------------------------------------------------------------------------
## the third use of the function centiles.pred()
##  if we have new x and y values what are their z-scores?
##-----------------------------------------------------------------------------
# create new y and x values and plot them in the previous plot
newx &lt;- c(20,21.2,23,20.9,24.2,24.1,25)
newy &lt;- c(130,121,123,125,140,145,150)
for(i in 1:7) points(newx[i],newy[i],col="blue")
## now calculate their z-scores
znewx &lt;- centiles.pred(a, xname="x",xvalues=newx,yval=newy, type="z-scores" )
znewx
## Not run: 
##-----------------------------------------------------------------------------
## What we do if the x variables is transformed?
##----------------------------------------------------------------------------
##  case 1 : transformed x-variable within the formula
##----------------------------------------------------------------------------
## fit model
aa &lt;- gamlss(y~pb(x^0.5),sigma.fo=~pb(x^0.5), data=abdom, family=BCT)
## centiles is working in this case
centiles(aa, xvar=abdom$x, legend = FALSE)
## get predict for values of x at 12, 14, ..., 40
mat &lt;- centiles.pred(aa, xname="x", xvalues=seq(12,40,2), plot=TRUE )
mat
# plot all prediction points
xx &lt;- rep(mat[,1],9)
yy &lt;- unlist(mat[,2:10])
points(xx,yy,col="red")
##----------------------------------------------------------------------------
##  case 2 : the x-variable is previously transformed 
##----------------------------------------------------------------------------
nx &lt;- abdom$x^0.5
aa &lt;- gamlss(y~pb(nx),sigma.fo=~pb(nx), data=abdom, family=BCT)
centiles(aa, xvar=abdom$x)
# equivalent to fitting
newd&lt;-data.frame( abdom, nx=abdom$x^0.5)
aa1 &lt;- gamlss(y~pb(nx),sigma.fo=~pb(nx), family=BCT, data=newd)
centiles(aa1, xvar=abdom$x)
# getting the centiles at x equal to 12, 14, ...40
mat &lt;-  centiles.pred(aa, xname="nx", xvalues=seq(12,40,2), power=0.5, 
         data=newd, plot=TRUE)
# plot all prediction points         
xxx &lt;- rep(mat[,1],9)
yyy &lt;- unlist(mat[,2:10])
points(xxx,yyy,col="red")
# the idea is that if the transformed x-variable is used in the fit
# the power argument has to used in centiles.pred()

## End(Not run)
</code></pre>


</div>