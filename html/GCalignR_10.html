<div class="container">

<table style="width: 100%;"><tr>
<td>draw_chromatogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualise peak lists as a pseudo-chromatogram</h2>

<h3>Description</h3>

<p>Creates a graphical representation of one or multiple peak lists in the form of a pseudo- chromatogram. Peaks are represented by Gaussian distributions centred at the peak retention time. The peak height is arbitrary and does not reflect any measured peak intensity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw_chromatogram(
  data = NULL,
  rt_col_name = NULL,
  conc_col_name = NULL,
  width = 0.1,
  step = NULL,
  sep = "\t",
  breaks = NULL,
  rt_limits = NULL,
  samples = NULL,
  show_num = FALSE,
  show_rt = FALSE,
  plot = TRUE,
  shape = c("gaussian", "stick"),
  legend.position = "bottom"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The input data can be either a GCalignR input file or an GCalign object. See <code>align_chromatograms</code> for details on both.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rt_col_name</code></td>
<td>
<p>A character giving the name of the column containing the retention times. The decimal separator needs to be a point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc_col_name</code></td>
<td>
<p>Character, denoting a variable used to scale the peak height (e.g., peak area or peak height.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Numeric value giving the standard deviation of Gaussian peaks. Decrease this value to separate overlapping peaks within samples. Default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>character allowing to visualise different steps of the alignment when a GCalign object is used. By default the aligned data is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>The field separator character. The default is tab separated (<code>sep = '\t'</code>).
See the "sep" argument in <code>read.table</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>A numeric vector giving the breakpoints between ticks on the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rt_limits</code></td>
<td>
<p>A numeric vector of length two giving min and max values or retention times to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>A character vector of sample names to draw chromatograms of a subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_num</code></td>
<td>
<p>Boolean indicating whether sample numbers are drawn on top of each peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_rt</code></td>
<td>
<p>Boolean indicating whether peak retention times are drawn on top of each peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Boolean indicating if the plot is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>A character determining the shape of peaks. Peaks are approximated as "gaussian" by default. Alternatively, peaks can be visualised as "sticks".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>
<p>See <code>theme</code> for options of legend positions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Peaks from the are depicted as Gaussian distributions. If the data is an "GCalign" object that was processed with <code>align_chromatograms</code>, chromatograms can be drawn for the dataset prior to alignment (<strong>"input"</strong>), after correcting linear drift (<strong>"shifted"</strong>) or after the complete alignment was conducted (<strong>"aligned"</strong>). In the latter case, retention times refer to the mean retention time of a homologous peaks scored among samples and do not reflect any between-sample variation anymore. Depending on the range of retention times and the distance among substances the peak width can be adjusted to enable a better visual separation of peaks by changing the value of parameter <code>width</code>. Note, homologous peaks (= exactly matching retention time) will overlap completely and only the last sample plotted will be visible. Hence, the number of samples can be printed on top of each peak. The function returns a list containing the ggplot object along with the internally used data frame to allow for maximum control in adapting the plot (see examples section in this document).
</p>


<h3>Value</h3>

<p>A list containing the data frame created for plotting and the ggplot object. See <code>ggplot</code>.
</p>


<h3>Author(s)</h3>

<p>Meinolf Ottensmann (meinolf.ottensmann@web.de) &amp; Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data
path &lt;- (system.file("extdata", "simulated_peak_data.txt", package = "GCalignR"))
## run with defaults
x &lt;- draw_chromatogram(data = path, rt_col_name = "rt")
## Customise and split samples in panels
x &lt;- draw_chromatogram(data = path, rt_col_name = "rt", samples = c("A2","A4"),
 plot = FALSE, show_num = FALSE)
x[["ggplot"]] + ggplot2::facet_wrap(~ sample, nrow = 2)
## plot without numbers
x &lt;- draw_chromatogram(data = path, show_num = FALSE, rt_col_name = "rt")
</code></pre>


</div>