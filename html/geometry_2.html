<div class="container">

<table style="width: 100%;"><tr>
<td>cart2bary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conversion of Cartesian to Barycentric coordinates.</h2>

<h3>Description</h3>

<p>Given the Cartesian coordinates of one or more points, compute
the barycentric coordinates of these points with respect to a
simplex.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cart2bary(X, P)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Reference simplex in <code class="reqn">N</code> dimensions represented by a
<code class="reqn">N+1</code>-by-<code class="reqn">N</code> matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p><code class="reqn">M</code>-by-<code class="reqn">N</code> matrix in which each row is the Cartesian
coordinates of a point.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a reference simplex in <code class="reqn">N</code> dimensions represented by a
<code class="reqn">N+1</code>-by-<code class="reqn">N</code> matrix an arbitrary point <code class="reqn">P</code> in
Cartesian coordinates, represented by a 1-by-<code class="reqn">N</code> row vector, can be
written as
</p>
<p style="text-align: center;"><code class="reqn">P = \beta X</code>
</p>

<p>where <code class="reqn">\beta</code> is an <code class="reqn">N+1</code> vector of the barycentric coordinates.
A criterion on <code class="reqn">\beta</code> is that
</p>
<p style="text-align: center;"><code class="reqn">\sum_i\beta_i = 1</code>
</p>

<p>Now partition the simplex into its first <code class="reqn">N</code> rows <code class="reqn">X_N</code> and
its <code class="reqn">N+1</code>th row <code class="reqn">X_{N+1}</code>. Partition the barycentric
coordinates into the first <code class="reqn">N</code> columns <code class="reqn">\beta_N</code> and the
<code class="reqn">N+1</code>th column <code class="reqn">\beta_{N+1}</code>. This allows us to write
</p>
<p style="text-align: center;"><code class="reqn">P_{N+1} - X_{N+1} = \beta_N X_N + \beta_{N+1} X_{N+1} - X_{N+1}</code>
</p>

<p>which can be written
</p>
<p style="text-align: center;"><code class="reqn">P_{N+1} - X_{N+1} = \beta_N(X_N - 1_N X_{N+1})</code>
</p>

<p>where <code class="reqn">1_N</code> is an <code class="reqn">N</code>-by-1 matrix of ones.  We can then solve
for <code class="reqn">\beta_N</code>:
</p>
<p style="text-align: center;"><code class="reqn">\beta_N = (P_{N+1} - X_{N+1})(X_N - 1_N X_{N+1})^{-1}</code>
</p>

<p>and compute
</p>
<p style="text-align: center;"><code class="reqn">\beta_{N+1} = 1 - \sum_{i=1}^N\beta_i</code>
</p>

<p>This can be generalised for multiple values of
<code class="reqn">P</code>, one per row.
</p>


<h3>Value</h3>

<p><code class="reqn">M</code>-by-<code class="reqn">N+1</code> matrix in which each row is the
barycentric coordinates of corresponding row of <code>P</code>. If the
simplex is degenerate a warning is issued and the function returns
<code>NULL</code>.
</p>


<h3>Note</h3>

<p>Based on the Octave function by David Bateman.
</p>


<h3>Author(s)</h3>

<p>David Sterratt
</p>


<h3>See Also</h3>

<p><code>bary2cart</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Define simplex in 2D (i.e. a triangle)
X &lt;- rbind(c(0, 0),
           c(0, 1),
           c(1, 0))
## Cartesian coordinates of points
P &lt;- rbind(c(0.5, 0.5),
           c(0.1, 0.8))
## Plot triangle and points
trimesh(rbind(1:3), X)
text(X[,1], X[,2], 1:3) # Label vertices
points(P)
cart2bary(X, P)
</code></pre>


</div>