<div class="container">

<table style="width: 100%;"><tr>
<td>choleskyFactory</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function Factory for Generating chol Function with unified arguments</h2>

<h3>Description</h3>

<p>A function factory which returns a function of the form <code>function(Sigma)</code> which performs a cholesky decomposition using an approach tailored to the type of input Sigma. Currently works for vectors, matrices, spam objects, and dgCMatrix objects from the <span class="pkg">Matrix</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">choleskyFactory(chol.args = list(), Rstruct = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chol.args</code></td>
<td>
<p>A list of optional settings for a cholesky function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rstruct</code></td>
<td>
<p>A <code>spam.chol.NgPeyton</code> object which represents the sparsity structure of covariance matrix Sigma.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The output of <code>choleskyFactory</code> is intended to replace calls to <code>chol.default</code> or <code>chol.spam</code>. The object type is determined during runtime, after which the appropriate function is called to obtain the cholesky decomposition. For spam objects, the function attempts to use <code>update.spam.chol.NgPeyton</code> if <code>Rstruct</code> is specified, and upon failure defaults to <code>chol.spam</code>. The result is then assigned in the execution environment of <code>choleskyFactory</code>, so that <code>Rstruct</code> will be defined in the next call.
</p>


<h3>Value</h3>

<p>A function of the form <code>function(Sigma)</code>.
</p>


<h3>Author(s)</h3>

<p>Thomas Caspar Fischer</p>


<h3>References</h3>

<p>Hadley Wickham (2015) <em>Advanced R</em>, CRC Press.
Reinhard Furrer and Roman Flury and Florian Gerber (2022) spam: SPArse Matrix, R package version 2.8-0.
</p>


<h3>See Also</h3>

<p><code>chol</code>,
<code>chol.spam</code>,
<code>update.spam.chol.NgPeyton</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
locations &lt;- data.frame(x = runif(10), y = runif(10))
theta &lt;- c(0.5,1,1,0,0)
dmat &lt;- as.matrix(dist(locations))
Sigma &lt;- cov.wendland(dmat, theta)

cholFun &lt;- choleskyFactory(chol.args = list())
cholD &lt;- cholFun(Sigma)

cholFun &lt;- choleskyFactory(chol.args = list(pivot = TRUE))
cholD_pivot &lt;- cholFun(Sigma)

cholFun &lt;- choleskyFactory(chol.args = list(pivot = "RCM"))
cholS_RCM &lt;- cholFun(spam::as.spam(Sigma))
</code></pre>


</div>