<div class="container">

<table style="width: 100%;"><tr>
<td>autoConverge</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Checks Stan model for convergence, then runs model on actual data.</h2>

<h3>Description</h3>

<p>Return a converged Stan model fit and the recommended noise level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">autoConverge(
  df,
  controlVars,
  nUntreated,
  obvColName,
  obvName,
  outcomeName,
  starttime,
  timeColName,
  filepath = NULL,
  ncores = NULL,
  iter = 25000,
  epsilon = 0.02,
  noise = 0.1,
  printMod = FALSE,
  shift = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The dataframe used for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controlVars</code></td>
<td>
<p>String of column names for control variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nUntreated</code></td>
<td>
<p>The number of untreated units in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obvColName</code></td>
<td>
<p>The column name that includes the observation subject to the counterfactual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obvName</code></td>
<td>
<p>The name of the observation subject to the counterfactual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcomeName</code></td>
<td>
<p>The outcome variable of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starttime</code></td>
<td>
<p>The start time of the counterfactual estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeColName</code></td>
<td>
<p>The name of the column that includes the time variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filepath</code></td>
<td>
<p>Your preferred place to save the fit data. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>The number of cores to be used to run the model. Default of NULL will utilize all cores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Preferred number of iterations. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>The desired level of convergence, i.e. how close to the 0.95 coverage is acceptable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>The baseline level of noise to be added to the model to prevent overfit. Updates as the model runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printMod</code></td>
<td>
<p>Boolean. Defaults FALSE. If TRUE, prints the model block for the run to the console. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>The magnitude of adjustment for the noise level per iteration. Defaults to 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We recommend creating a new folder for the file path since the Stan fit creates a large number of files at runtime.
</p>
<p>For iterations, check that your model converged (we recommend all r-hats close to 1 and examining traceplots).
</p>
<p>We recommend keeping printMod as FALSE, otherwise, the function will write the model to the console for every model run on the convergence.
</p>
<p>We also recommend using all cores on your machine to speed up model run time. If you are unsure about the number of cores in your machine, see doParallel::detectCores().
</p>


<h3>Value</h3>

<p>The recommended noise level after convergence.
</p>


<h3>Author(s)</h3>

<p>Devin P. Brown <a href="mailto:devinpbrown96@gmail.com">devinpbrown96@gmail.com</a> and David Carlson <a href="mailto:carlson.david@wustl.edu">carlson.david@wustl.edu</a>
</p>


<h3>See Also</h3>

<p><code>plotGPPfit</code> <code>runMod</code> <code>GPP</code> <code>writeMod</code>
</p>


</div>