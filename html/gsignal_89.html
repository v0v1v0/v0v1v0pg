<div class="container">

<table style="width: 100%;"><tr>
<td>fftshift</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Zero-frequency shift</h2>

<h3>Description</h3>

<p>Perform a shift in order to move the frequency 0 to the center of the input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fftshift(x, MARGIN = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input data, specified as a vector or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MARGIN</code></td>
<td>
<p>dimension to operate along, 1 = row, 2 = columns (default).
Specifying <code>MARGIN = c(1, 2)</code> centers along both rows and columns.
Ignored when <code>x</code> is a vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code> is a vector of <code>N</code> elements corresponding to <code>N</code> time
samples spaced by <code>dt</code>, then <code>fftshift(x)</code> corresponds to
frequencies <code>f = c(-seq(ceiling((N-1)/2), 1, -1), 0, (1:floor((N-1)/2)))
* df</code>, where <code>df = 1 / (N * dt)</code>. In other words, the left and right
halves of <code>x</code> are swapped.
</p>
<p>If <code>x</code> is a matrix, then <code>fftshift</code> operates on the rows or columns
of <code>x</code>, according to the <code>MARGIN</code> argument, i.e. it swaps the the
upper and lower halves of the matrix <code>(MARGIN = 1)</code>, or the left and
right halves of the matrix <code>(MARGIN = 2)</code>. Specifying <code>MARGIN =
c(1, 2)</code> swaps along both dimensions, i.e., swaps the first quadrant with the
fourth, and the second with the third.
</p>


<h3>Value</h3>

<p>vector or matrix with centered frequency.
</p>


<h3>Author(s)</h3>

<p>Vincent Cautaerts, <a href="mailto:vincent@comf5.comm.eng.osaka-u.ac.jp">vincent@comf5.comm.eng.osaka-u.ac.jp</a>,<br>
adapted by John W. Eaton.<br>
Conversion to R by Geert van Boxtel, <a href="mailto:G.J.M.vanBoxtel@gmail.com">G.J.M.vanBoxtel@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code>ifftshift</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">Xeven &lt;- 1:6
ev &lt;- fftshift(Xeven)   # returns 4 5 6 1 2 3

Xodd &lt;- 1:7
odd &lt;- fftshift(Xodd)   # returns 5 6 7 1 2 3 4

fs &lt;- 100                      # sampling frequency
t &lt;- seq(0, 10 - 1/fs, 1/fs)   # time vector
S &lt;- cos(2 * pi * 15 * t)
n &lt;- length(S)
X &lt;- fft(S)
f &lt;- (0:(n - 1)) * (fs / n);   # frequency range
power &lt;- abs(X)^2 / n          # power
plot(f, power, type="l")
Y &lt;- fftshift(X)
fsh &lt;- ((-n/2):(n/2-1)) * (fs / n)  # zero-centered frequency range
powersh &lt;- abs(Y)^2 / n             # zero-centered power
plot(fsh, powersh, type = "l")

</code></pre>


</div>