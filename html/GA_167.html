<div class="container">

<table style="width: 100%;"><tr>
<td>persp3D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perspective plot with colour levels</h2>

<h3>Description</h3>

<p>This function draws a perspective plot of a surface with different levels in different colours.</p>


<h3>Usage</h3>

<pre><code class="language-R">persp3D(x, y, z, theta = 30, phi = 20, d = 5, expand = 2/3,
        xlim = range(x, finite = TRUE), ylim = range(y, finite = TRUE), 
        zlim = range(z, finite = TRUE), levels = pretty(zlim, nlevels),
        nlevels = 20, col.palette = jet.colors, border = NA, 
        ticktype = "detailed", xlab = NULL, ylab = NULL, zlab = NULL, 
        ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are measured. These must be in ascending order. By default, equally spaced values from 0 to 1 are used. If <code>x</code> is a list, its components <code>x$x</code> and <code>x$y</code> are used for <code>x</code> and <code>y</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a matrix containing the values to be plotted (NAs are allowed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta, phi</code></td>
<td>
<p>angles defining the viewing direction. <code>theta</code> gives the azimuthal direction and <code>phi</code> the colatitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a value which can be used to vary the strength of the perspective transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expand</code></td>
<td>
<p>a expansion factor applied to the <code>z</code> coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim, zlim</code></td>
<td>
<p>x-, y- and z-limits for the axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a vector of values specifying the levels to be used for plotting the surface with different colours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>a value specifying the number of levels to be used for plotting. This value is used if <code>levels</code> argument is not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.palette</code></td>
<td>
<p>the colour palette used for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>the colour of the line drawn around the surface facets. By default is set to <code>NA</code> so no borders are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticktype</code></td>
<td>
<p>a character specifying the type of axes tickmarks. By default <code>"detailed"</code> ticks are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab, zlab</code></td>
<td>
<p>character strings specifying the titles for the axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the function <code>persp</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function enhances the default perspective plot for drawing 3-dimensional surfaces.</p>


<h3>Value</h3>

<p>Return a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>persp</code></td>
<td>
<p>the viewing transformation matrix (see <code>persp</code>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>a vector of values giving the levels used for plotting the surface;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>a vector of strings giving the colour used for plotting the surface.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>See Also</h3>

<p><code>persp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- x &lt;- seq(-10, 10, length=60)
f &lt;- function(x,y) { r &lt;- sqrt(x^2+y^2); 10 * sin(r)/r }
z &lt;- outer(x, y, f)
persp3D(x, y, z, theta = 30, phi = 30, expand = 0.5)
persp3D(x, y, z, col.palette = heat.colors, phi = 30, theta = 225, 
        box = TRUE, border = NA, shade = .4)
x1 &lt;- seq(-3,3,length=50)
x2 &lt;- seq(-3,3,length=50)
y &lt;- function(x1, x2) sin(x1)+cos(x2)
persp3D(x1, x2, outer(x1,x2,y), zlab="y", theta = 150, phi = 20, expand = 0.6)
</code></pre>


</div>