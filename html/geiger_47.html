<div class="container">

<table style="width: 100%;"><tr>
<td>dtt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>disparity-through-time</h2>

<h3>Description</h3>

<p>calculating and plotting disparity-through-time for a phylogenetic tree and 
phenotypic data
</p>


<h3>Usage</h3>

<pre><code class="language-R">disparity(phy=NULL, data, index = c("avg.sq", "avg.manhattan", "num.states"))
dtt(phy, data, index=c("avg.sq", "avg.manhattan", "num.states"),
    mdi.range=c(0,1), nsim=0, CI=0.95, plot=TRUE, calculateMDIp=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of class 'phylo'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a named vector or matrix of continuous trait values, associated with species in <code>phy</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>disparity index to use (see <b>Details</b>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mdi.range</code></td>
<td>
<p>time range over which to calculate MDI statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulations used to calculate null disparity-through-time plot (see <b>Details</b>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>confidence level from which to plot simulated disparities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether to plot disparities through time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calculateMDIp</code></td>
<td>
<p>calculate p-value for MDI compared to null; only valid if nsim is not zero</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The most complete implementation of <code>dtt</code> (where <code>nsim</code> is greater than 0) carries out the entire disparity-through-time (DTT) procedure described in Harmon et al. 2003, where simulated data are used to construct a null DTT distribution. The function <code>disparity</code> simply computes the morphological disparity for a set of species. Note that for <code>mdi.range</code>, time is relative to a total tree length of 1. The default <code>mdi.range</code> is the entire temporal span of the tree, from 0 (root) to 1 (tips). 
</p>
<p>For either function, the disparity index can be one of the following:
</p>

<ul>
<li>
<p><b>avg.sq </b>is average squared Euclidean distance among all pairs of points; this is the most common distance metric for disparity in macroevolution
</p>
</li>
<li>
<p><b>avg.manhattan </b>is average Manhattan distance among all pairs of points
</p>
</li>
<li>
<p><b>num.states </b>is number of unique character states; this is currently the only option for discrete 
character data
</p>
</li>
</ul>
<h3>Value</h3>

<p>The function <code>disparity</code> returns the disparity of the supplied <code>data</code>. If given a tree, <code>disparity</code> will return 
disparities computed for each subtree.  The vector of disparities is indexed based on the numeric node-identifier of the subtending subtree (e.g., the 
root is indexed by N+1, where N is the number of species in the tree; see <code>read.tree</code>). 
</p>
<p>The function <code>dtt</code> returns elements from the list below:
</p>

<ul>
<li>
<p><b>dtt </b>is average disparity for clades whose stem crosses each time interval in the tree
</p>
</li>
<li>
<p><b>times </b>are times for each value in disparity-through-time calculation; these are just the branching times of the phylogeny
</p>
</li>
<li>
<p><b>sim </b>are disparities at time intervals for each simulated dataset
</p>
</li>
<li>
<p><b>MDI </b>is the value of the MDI statistic, which is the area between the DTT for the data and the median of the simulations
</p>
</li>
</ul>
<p>If results are plotted, the mean DTT from the simulated datasets appears in dashed line and the empirical DTT in solid line.  
</p>


<h3>Author(s)</h3>

<p> LJ Harmon and GJ Slater</p>


<h3>References</h3>

<p>Foote M. 1997. The evolution of morphological diversity. <em>ARES</em> 28:129-152.
</p>
<p>Harmon LJ, JA Schulte, JB Losos, and A Larson. 2003. Tempo and mode of evolutionary radiation in iguanian lizards. <em>Science</em> 301:961-964.
</p>
<p>Slater GJ, SA Price, F Santini, and MA Alfaro. 2010. Diversity vs disparity and the evolution of modern cetaceans. <em>PRSB</em> 277:3097 -3104.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
geo=get(data(geospiza))

## disparity -- not tree-based
disparity(data=geo$dat) # not tree-based

## cladewise disparities
disparity(phy=geo$phy, data=geo$dat)

## disparity through time of culmen length
dttcul&lt;-dtt(phy=geo$phy, data=geo$dat[,"culmenL"], nsim=100, plot=TRUE)

## disparity through time of entire dataset -- without simulated data
dttgeo&lt;-dtt(phy=geo$phy, data=geo$dat, nsim=0, plot=TRUE)

## End(Not run)
</code></pre>


</div>