<div class="container">

<table style="width: 100%;"><tr>
<td>perform_grid_search</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform Grid Search or Random Search for Hyperparameter Tuning</h2>

<h3>Description</h3>

<p>Perform Grid Search or Random Search for Hyperparameter Tuning
</p>


<h3>Usage</h3>

<pre><code class="language-R">perform_grid_search(
  X_train,
  y_train,
  pipeline,
  scoring,
  params,
  search_type,
  n_iter,
  njobs,
  modules,
  random_state
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X_train</code></td>
<td>
<p>Training data for predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_train</code></td>
<td>
<p>Training data for outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pipeline</code></td>
<td>
<p>A pipeline specifying the steps for feature selection and model training.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoring</code></td>
<td>
<p>A string representing what scoring metric to use for hyperparameter adjustment. Default value is 'accuracy'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>A list of parameters or parameter distributions to search over.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search_type</code></td>
<td>
<p>A character string specifying the type of search ('grid' or 'random').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_iter</code></td>
<td>
<p>The number of parameter settings that are sampled in a random search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>njobs</code></td>
<td>
<p>The number of CPU cores to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modules</code></td>
<td>
<p>A list containing the definitions for the Python modules and submodules.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_state</code></td>
<td>
<p>An integer value setting the random seed for feature selection algorithms and randomized search CV procedure. By default set to NULL to use different random seed every time an algorithm is used. For reproducibility could be fixed, otherwise for an unbiased estimation should be left as NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a scikit-learn GridSearchCV, RandomizedSearchCV, or BayesSearchCV object, depending on the <code>search_type</code> specified.
This object includes several attributes useful for analyzing the hyperparameter tuning process:
- @field best_estimator_: The best estimator chosen by the search.
- @field best_score_: The score of the best_estimator on the left-out data.
- @field best_params_: The parameter setting that gave the best results on the hold-out data.
- @field cv_results_: A dict with keys as column headers and values as columns, that can be imported into a pandas DataFrame.
- @field scorer_: Scoring method used on the held-out data.
- @field n_splits_: The number of cross-validation splits (folds/iterations).
These attributes provide insights into the model's performance and the effectiveness of the selected hyperparameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
required_modules &lt;- c("sklearn", "boruta")
modules_available &lt;- sapply(required_modules, reticulate::py_module_available)

if (all(modules_available)) {
# Assuming X_train, y_train, pipeline, and params are predefined
# Define sklearn modules (assuming 'define_sklearn_modules' is defined)
sklearn_modules &lt;- define_sklearn_modules()

# Perform a grid search
optimal_model &lt;- perform_grid_search(X_train, y_train, pipeline, "accuracy",
                                    params, "grid", NULL, 1, sklearn_modules, NULL)


# Perform a random search
optimal_model_random &lt;- perform_grid_search(X_train, y_train, pipeline, "accuracy",
                                            params, "random", 10, 1, sklearn_modules, 42)

} else {
unavailable_modules &lt;- names(modules_available[!modules_available])
message(paste("Required Python modules not available:",
  paste(unavailable_modules, collapse=', '), ". Skipping example."))
}

</code></pre>


</div>