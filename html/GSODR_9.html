<div class="container">

<table style="width: 100%;"><tr>
<td>reformat_GSOD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tidy and Return a data.table Object of GSOD Data From Local Storage</h2>

<h3>Description</h3>

<p>This function automates cleaning and reformatting of <abbr><span class="acronym">GSOD</span></abbr> station
files in<br> “YEAR.tar.gz”, provided that they have been untarred or
“STATION.csv” format that have been downloaded from the United States
National Center for Environmental Information's (<abbr><span class="acronym">NCEI</span></abbr>)
download page.  Three additional useful elements: saturation vapour pressure
(es), actual vapour pressure (ea) and relative humidity (RH) are calculated
and returned in the final data frame using the improved August-Roche-Magnus
approximation (Alduchov and Eskridge 1996).  All units are converted to
International System of Units (SI), <em>e.g.</em>, Fahrenheit to Celsius and
inches to millimetres.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reformat_GSOD(dsn = NULL, file_list = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dsn</code></td>
<td>
<p>User supplied full file path to location of data files on local
disk for tidying.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file_list</code></td>
<td>
<p>User supplied list of file paths to individual files of data
on local disk for tidying.  Ignored if <code>dsn</code> is set.  Use if there are other
files in the <code>dsn</code> that you do not wish to reformat.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If multiple stations are given, data are summarised for each year by station,
which include vapour pressure and relative humidity elements calculated from
existing data in <abbr><span class="acronym">GSOD</span></abbr>.  Else, a single station is tidied and a data
frame is returned.
</p>
<p>All missing values in resulting files are represented as <code>NA</code> regardless
of which field they occur in.
</p>
<p>Only station files in the original “csv” file format are supported by
this function.  If you have downloaded the full annual (“YYYY.tar.gz”)
file you will need to extract the individual station files from the tar file
first to use this function.
</p>
<p>Note that <code>reformat_GSOD()</code> will attempt to reformat any “.csv”
files found in the <code>dsn</code> that you provide.  If there are non-<abbr><span class="acronym">GSOD</span></abbr>
files present this will lead to errors.
</p>
<p>For a complete list of the fields and description of the contents and units,
please refer to Appendix 1 in the <a href="https://CRAN.R-project.org/package=GSODR"><span class="pkg">GSODR</span></a> vignette,
<code>vignette("GSODR", package = "GSODR")</code>.
</p>


<h3>Value</h3>

<p>A data frame as a data.table::data.table object of
<abbr><span class="acronym">GSOD</span></abbr> data.
</p>


<h3>References</h3>

<p>Alduchov, O.A. and Eskridge, R.E., 1996. Improved Magnus form approximation
of saturation vapor pressure. Journal of Applied Meteorology and Climatology,
35(4), pp.601-609. DOI:
&lt;10.1175%2F1520-0450%281996%29035%3C0601%3AIMFAOS%3E2.0.CO%3B2&gt;.
</p>


<h3>Note</h3>

<p>While <a href="https://CRAN.R-project.org/package=GSODR"><span class="pkg">GSODR</span></a> does not distribute <abbr><span class="acronym">GSOD</span></abbr> weather data,
users of the data should note the conditions that the U.S. <abbr><span class="acronym">NCEI</span></abbr>
places upon the <abbr><span class="acronym">GSOD</span></abbr> data.
“The following data and products may have conditions placed on their
international commercial use.  They can be used within the U.S. or for non-
commercial international activities without restriction.  The non-U.S. data
cannot be redistributed for commercial purposes. Re-distribution of these
data by others must provide this same notification. A log of IP addresses
accessing these data and products will be maintained and may be made
available to data providers.”
</p>


<h3>Author(s)</h3>

<p>Adam H. Sparks, <a href="mailto:adamhsparks@gmail.com">adamhsparks@gmail.com</a>
</p>


<h3>See Also</h3>

<p>For automated downloading and tidying see the <code>get_GSOD()</code> function, which
provides expanded functionality for automatically downloading and expanding
annual <abbr><span class="acronym">GSOD</span></abbr> files and cleaning station files.
</p>
<p><code>get_GSOD()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Download data to 'tempdir()'
download.file(
  url =
    "https://www.ncei.noaa.gov/data/global-summary-of-the-day/access/2010/95551099999.csv",
  destfile = file.path(tempdir(), "95551099999.csv"),
  mode = "wb"
)

# Reformat station data files in R's tempdir() directory
tbar &lt;- reformat_GSOD(dsn = tempdir())

tbar


</code></pre>


</div>