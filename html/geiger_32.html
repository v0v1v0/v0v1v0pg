<div class="container">

<table style="width: 100%;"><tr>
<td>congruify.phylo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
ultrametricization of trees from a supplied timetree</h2>

<h3>Description</h3>

<p>automagically generating secondary calibrations</p>


<h3>Usage</h3>

<pre><code class="language-R">congruify.phylo(reference, target, taxonomy = NULL, tol = 0,
  scale=c(NA, "PATHd8", "treePL"), ncores=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>an ultrametric tree used to time-scale the <code>target</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>a phylogram that is sought to be ultrametricized based on the <code>reference</code> phylogeny</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxonomy</code></td>
<td>
<p>a linkage table between tips of the phylogeny and clades represented in the tree; rownames of 'taxonomy' should be tips found in the phylogeny</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>branching time in <code>reference</code> above which secondary constraints will be applied to <code>target</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p><code>NA</code>, <code>"PATHd8"</code> or <code>"treePL"</code> (if <code>PATHd8</code> or <code>"treePL"</code> are available in the R <code>PATH</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>number of cores to be used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses the <code>reference</code> to inform secondary calibrations in the <code>target</code>. The primary output is a table of 'congruent' nodes between the <code>reference</code>
and <code>target</code> with associated dates extracted from corresponding nodes in the <code>reference</code>.
</p>
<p>If multiple trees are supplied as the <code>reference</code>, a 'congruification' table is generated for each.
</p>
<p>If <code>scale="PATHd8"</code>, the <code>target</code> will be smoothed by <code>PATHd8</code> using the "d8 calculation" (see <a href="http://www2.math.su.se/PATHd8/PATHd8manual.pdf">http://www2.math.su.se/PATHd8/PATHd8manual.pdf</a>).
This scaling method requires that <code>PATHd8</code> is available on the user's <code>PATH</code> variable that can be accessed by <code>Sys.getenv("PATH")</code>.
</p>
<p>If <code>scale="treePL"</code>, the <code>target</code> will be smoothed by <code>treePL</code>.
This scaling method requires that <code>treePL</code> is available on the user's <code>PATH</code> variable that can be accessed by <code>Sys.getenv("PATH")</code>.
</p>


<h3>Author(s)</h3>

<p>JM Eastman</p>


<h3>References</h3>

<p>Eastman JM, LJ Harmon, and DC Tank. 2013. Congruification: support for time scaling large phylogenetic trees. <em>Methods in Ecology and Evolution</em>, in press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
sal=get(data(caudata))
res=congruify.phylo(sal$fam, sal$phy, sal$tax, tol=0, scale=NA, ncores=2)
print(res$calibrations)
plot(ladderize(sal$phy,right=FALSE), cex=0.35, type="fan", label.offset=2.5)
plot(ladderize(sal$fam,right=FALSE), cex=0.5, type="fan", label.offset=2.5, no.margin=FALSE)

# if you have PATHd8 installed you can also run
# res=congruify.phylo(sal$fam, sal$phy, sal$tax, tol=0, scale=\"PATHd8\")
# print(res)

## End(Not run)
</code></pre>


</div>