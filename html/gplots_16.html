<div class="container">

<table style="width: 100%;"><tr>
<td>bubbleplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bubble Plot</h2>

<h3>Description</h3>

<p>Draw a bubble plot, a scatterplot with varying symbol sizes and
colors, or add points to existing plots. A variety of input formats
are supported, including vectors, matrices, data frames, formulas,
etc.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bubbleplot(x, ...)

## Default S3 method:
bubbleplot(x, y, z, std=TRUE, pow=0.5, add=FALSE,
           rev=FALSE, type="p", ylim=NULL, xlab=NULL, ylab=NULL,
           pch=c(16,1), cex.points=1, col="black", bg=par("bg"), ...)

## S3 method for class 'formula'
bubbleplot(formula, data, subset, na.action=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of values for the horizontal axis. Can also be a
2-dimensional matrix or table (x values in column names and y values
in row names), or a data frame containing <code>x</code>, <code>y</code>, and
<code>z</code> in that order. If the data frame contains column names
<code>x</code>, <code>y</code>, and <code>z</code> then they will be used for
plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to <code>plot</code> and <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of values for the vertical axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a vector of values determining the bubble sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std</code></td>
<td>
<p>whether to standardize the <code>z</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>
<p>a power coefficient for the bubble sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>whether to add bubbles to an existing plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rev</code></td>
<td>
<p>whether to reverse the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>passed to <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>passed to <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>passed to <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>passed to <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.points</code></td>
<td>
<p>scales all bubble sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, bg</code></td>
<td>
<p>passed to <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>has the form <code>z ~ x + y</code>, where <code>z</code>
determines the bubble sizes and <code>x</code> and <code>y</code> determine
bubble locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>where formula terms are stored, e.g. data frame or list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>a logical vector specifying which data to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>how <code>NA</code> values are handled.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>std</code> standardization sets <code>z = abs(z) / mean(abs(z))</code>.
</p>
<p>The <code>pow = 0.5</code> (square root) is a good default, where a <code>z</code>
value of 2 has twice the area of 1. See example #2 below for an
exception, where the <code>z</code> value is tree circumference and
therefore proportional to the tree diameter.
</p>
<p>The <code>pch</code>, <code>col</code>, and <code>bg</code> arguments can be be vectors
of length 2, where positive <code>z</code> values are drawn with
<code>pch[1]</code>, <code>col[1]</code>, <code>bg[1]</code> and negative <code>z</code>
values are drawn with <code>pch[2]</code>, <code>col[2]</code>, and <code>bg[2]</code>.
</p>


<h3>Author(s)</h3>

<p>Arni Magnusson.</p>


<h3>See Also</h3>

<p><code>points</code> is the underlying function used to draw the
bubbles.
</p>
<p><code>symbols</code> can also draw bubbles, but does not handle
negative <code>z</code> values or have convenience features such as
<code>pow</code> and <code>rev</code>.
</p>
<p><code>balloonplot</code> provides an alternative interface and visual
style based on tables instead of scatterplots.
</p>


<h3>Examples</h3>

<pre><code class="language-R">catch.t &lt;- xtabs(Catch~Year+Age, catch.d)              # example table
catch.m &lt;- as.matrix(as.data.frame(unclass(catch.t)))  # example matrix

# 1  Formula
bubbleplot(Catch~Age+Year, data=catch.d)
# Use rev=TRUE to get same layout as crosstab matrix:
print(catch.m)
bubbleplot(Catch~Age+Year, data=catch.d, rev=TRUE, las=1)

# 2  Data frame
bubbleplot(catch.d)
bubbleplot(Orange)
# Visualize tree transverse section at breast height
bubbleplot(Orange, pow=1, cex=2, pch=21,
           col="darkred", bg="peru", lwd=1.5)

# 3  Matrix or table
bubbleplot(catch.m)
bubbleplot(catch.t)

# 4  Positive and negative values
bubbleplot(catch.r)
bubbleplot(Resid~Age+Year, catch.r, subset=Age %in% 4:9,
           rev=TRUE, xlim=c(3.5,9.5), cex=1.3)
# Residuals from orange tree model
library(nlme)
fm &lt;- nlme(circumference~phi1/(1+exp(-(age-phi2)/phi3)),
           fixed=phi1+phi2+phi3~1, random=phi1~1|Tree,
           data=Orange, start=c(phi1=200,phi2=800,phi3=400))
bubbleplot(residuals(fm)~Tree+age, Orange)
bubbleplot(residuals(fm)~Tree+age, Orange, cex=2.5, pch=16,
           col=c("dodgerblue","orange"))

# 5  Richter magnitude, amplitude, and energy release
bubbleplot(mag~long+lat, quakes, pch=1)
bubbleplot(10^mag~long+lat, quakes, cex=1.2, col=gray(0, 0.3))
bubbleplot(sqrt(1000)^mag~long+lat, quakes, cex=1.2, col=gray(0, 0.3))
bubbleplot(sqrt(1000)^mag~long+lat, quakes, cex=1.2, col="#FF00004D")
</code></pre>


</div>