<div class="container">

<table style="width: 100%;"><tr>
<td>GeoTests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistical Hypothesis Tests for Nested Models</h2>

<h3>Description</h3>

<p>The function performs statistical hypothesis tests for nested models
based on composite or standard likelihood versions of Wald-type and
Wilks-type (likelihood ratio) statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GeoTests(object1, object2, ..., statistic)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object1</code></td>
<td>
<p>An object of class <code>GeoFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object2</code></td>
<td>
<p>An object of class <code>GeoFit</code> that is a nested
model within <code>object1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further successively nested objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>String; the name of the statistic used within the
hypothesis test (see <b>Details</b>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The implemented hypothesis tests for nested models are based on the
following statistics:
</p>

<ol>
<li>
<p> Wald-type (<code>Wald</code>);
</p>
</li>
<li>
<p> Likelihood ratio or Wilks-type (<code>Wilks</code> under standard likelihood); 
For composite likelihood available variants of the basic version are:
</p>

<ul>
<li>
<p> Rotnitzky and Jewell adjustment (<code>WilksRJ</code>);
</p>
</li>
<li>
<p> Satterhwaite adjustment (<code>WilksS</code>);
</p>
</li>
<li>
<p> Chandler and Bate adjustment (<code>WilksCB</code>);
</p>
</li>
<li>
<p> Pace, Salvan and Sartori adjustment (<code>WilksPSS</code>);
</p>
</li>
</ul>
</li>
</ol>
<p>More specifically,
consider an <code class="reqn">p</code>-dimensional random vector <code class="reqn">\mathbf{Y}</code> with
probability density function <code class="reqn">f(\mathbf{y};\mathbf{\theta})</code>,
where <code class="reqn">\mathbf{\theta} \in \Theta</code> is a
<code class="reqn">q</code>-dimensional vector of parameters. Suppose that
<code class="reqn">\mathbf{\theta}=(\mathbf{\psi},\mathbf{\tau})</code>
can be partitioned in a <code class="reqn">q'</code>-dimensional subvector <code class="reqn">\psi</code>
and <code class="reqn">q''</code>-dimensional subvector <code class="reqn">\tau</code>. Assume also to be
interested in testing the specific values of the vector
<code class="reqn">\psi</code>. Then, one can use some statistical
hypothesis tests for testing the null hypothesis <code class="reqn">H_0:
 \psi=\psi_0</code> against the alternative <code class="reqn">H_1:
 \psi \neq \psi_0</code>. Composite likelihood versions
of 'Wald'  statistis have the usual asymptotic
chi-square distribution with <code class="reqn">q'</code> degree of freedom. The Wald-type statistic is
</p>
<p style="text-align: center;"><code class="reqn">W=(\hat{\psi}-\psi_0)^T (G^{\psi \psi})^{-1}(\hat{\theta})(\hat{\psi}-\psi_0),</code>
</p>

<p>where <code class="reqn">G_{\psi \psi}</code> is the <code class="reqn">q' \times q'</code>
submatrix of the Godambe or Fisher information pertaining to <code class="reqn">\psi</code> and
<code class="reqn">\hat{\theta}</code> is the maximum likelihood estimator from
the full model. 
This statistic can be called from the
routine <code>GeoTests</code> assigning at the argument <code>statistic</code>
the value: <code>Wald</code>.
</p>
<p>Alternatively to the Wald-type  statistic one can use the
composite version of the Wilks-type or likelihood ratio statistic, given by
</p>
<p style="text-align: center;"><code class="reqn">W=2[C \ell(\hat{\mathbf{\theta}};\mathbf{y}) - C \ell\{\mathbf{\psi}_0,
   \hat{\mathbf{\tau}}(\mathbf{\psi}_0);\mathbf{y}\}].</code>
</p>

<p>In the composite likelihood case, the asymptotic distribution of the composite 
likelihood ratio statistic is given by
</p>
<p style="text-align: center;"><code class="reqn">W \dot{\sim} \sum_{i} \lambda_i \chi^2,</code>
</p>

<p>for <code class="reqn">i=1,\ldots,q'</code>, where <code class="reqn">\chi^2_i</code> are
<code class="reqn">q'</code> iid copies of a chi-square one random variable and
<code class="reqn">\lambda_1,\ldots,\lambda_{q'}</code>
are the eigenvalues of the matrix <code class="reqn">(H^{\psi \psi})^{-1} G^{\psi
 \psi}</code>. There exist several adjustments
to the composite likelihood ratio statistic in order to get an
approximated <code class="reqn">\chi^2_{q'}</code>. For example, Rotnitzky and Jewell
(1990) proposed the adjustment <code class="reqn">W'= W / \bar{\lambda}</code> where <code class="reqn">\bar{\lambda}</code> is the average
of the eigenvalues <code class="reqn">\lambda_i</code>. This statistic can be
called within the routine by the value: <code>WilksRJ</code>. A better
solution is proposed by Satterhwaite (1946) defining <code class="reqn">W''=\nu W /
 (q' \bar{\lambda})</code>, where <code class="reqn">\nu=(\sum_i
 \lambda)^2 / \sum_i \lambda^2_i</code> for
<code class="reqn">i=1\ldots,q'</code>, is the effective number of the degree of
freedom. Note that in this case the distribution of the likelihood ratio
statistic is a chi-square random variable with <code class="reqn">\nu</code> degree of
freedom. This statistic can be called from the routine assigning the
value: <code>WilksS</code>. For the adjustments suggested by Chandler and
Bate (2007)  we refere to the article (see
<b>References</b>). This versions can be called from the routine assigning
respectively the values: <code>WilksCB</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>c("data.frame")</code>. The object contain a table
with the results of the tested models. The rows represent the
responses for each model and the columns the following results:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Num.Par</code></td>
<td>
<p>The number of the model's parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Diff.Par</code></td>
<td>
<p>The difference between the number of parameters of the model in the previous row
and those in the actual row.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Df</code></td>
<td>
<p>The effective number of degree of freedom of the chi-square distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Chisq</code></td>
<td>
<p>The observed value of the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pr(&gt;chisq)</code></td>
<td>
<p>The p-value of the quantile
<code>Chisq</code> computed using a chi-squared distribution with <code>Df</code> degrees
of freedom.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Moreno Bevilacqua, <a href="mailto:moreno.bevilacqua89@gmail.com">moreno.bevilacqua89@gmail.com</a>,<a href="https://sites.google.com/view/moreno-bevilacqua/home">https://sites.google.com/view/moreno-bevilacqua/home</a>,
Víctor Morales Oñate, <a href="mailto:victor.morales@uv.cl">victor.morales@uv.cl</a>, <a href="https://sites.google.com/site/moralesonatevictor/">https://sites.google.com/site/moralesonatevictor/</a>,
Christian", Caamaño-Carrillo, <a href="mailto:chcaaman@ubiobio.cl">chcaaman@ubiobio.cl</a>,<a href="https://www.researchgate.net/profile/Christian-Caamano">https://www.researchgate.net/profile/Christian-Caamano</a>
</p>


<h3>References</h3>

<p>Chandler, R. E., and Bate, S. (2007). Inference for Clustered Data Using the
Independence log-likelihood. <em>Biometrika</em>, <b>94</b>, 167–183.
</p>
<p>Rotnitzky, A. and Jewell, N. P. (1990). Hypothesis Testing of Regression
Parameters in Semiparametric Generalized Linear Models for Cluster
Correlated Data. <em>Biometrika</em>, <b>77</b>, 485–497.
</p>
<p>Satterthwaite, F. E. (1946). An Approximate Distribution of Estimates of
Variance Components. <em>Biometrics Bulletin</em>, <b>2</b>, 110–114.
</p>
<p>Varin, C., Reid, N. and Firth, D. (2011). An Overview of Composite
Likelihood Methods. <em>Statistica Sinica</em>, <b>21</b>, 5–42.
</p>


<h3>See Also</h3>

<p><code>GeoFit</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library(GeoModels)

################################################################
###
### Example 1. Test on the parameter
### of a regression model using conditional composite likelihood
###
###############################################################
set.seed(342)
model="Gaussian" 
# Define the spatial-coordinates of the points:
NN=1500
x = runif(NN, 0, 1)
y = runif(NN, 0, 1)
coords = cbind(x,y)
# Parameters
mean=1; mean1=-1.25;  # regression parameters
nugget=0; sill=1

# matrix covariates
X=cbind(rep(1,nrow(coords)),runif(nrow(coords)))

# model correlation 
corrmodel="Wend0"
power2=4;c_supp=0.15

# simulation
param=list(power2=power2,mean=mean,mean1=mean1,
              sill=sill,scale=c_supp,nugget=nugget)
data = GeoSim(coordx=coords, corrmodel=corrmodel,model=model, param=param,X=X)$data

I=Inf
##### H1: (regressian mean)
fixed=list(nugget=nugget,power2=power2)
start=list(mean=mean,mean1=mean1,scale=c_supp,sill=sill)

lower=list(mean=-I,mean1=-I,scale=0,sill=0)
upper=list(mean=I,mean1=I,scale=I,sill=I)
# Maximum pairwise composite-likelihood fitting of the RF:
fitH1 = GeoFit(data=data,coordx=coords,corrmodel=corrmodel, model=model,
              likelihood="Conditional",type="Pairwise",sensitivity=TRUE,
                   lower=lower,upper=upper,neighb=3,
                   optimizer="nlminb",X=X,
                    start=start,fixed=fixed)

unlist(fitH1$param)

##### H0: (constant mean i.e beta1=0)
fixed=list(power2=power2,nugget=nugget,mean1=0)
start=list(mean=mean,scale=c_supp,sill=sill)
lower0=list(mean=-I,scale=0,sill=0)
upper0=list(mean=I,scale=I,sill=I)
# Maximum pairwise composite-likelihood fitting of the RF:
fitH0 = GeoFit(data=data,coordx=coords,corrmodel=corrmodel, model=model,
            likelihood="Conditional",type="Pairwise",sensitivity=TRUE,
                      lower=lower0,upper=upper0,neighb=3,
                   optimizer="nlminb",X=X,
                    start=start,fixed=fixed)
unlist(fitH0$param)

# not run
##fitH1=GeoVarestbootstrap(fitH1,K=100,optimizer="nlminb",
##                     lower=lower, upper=upper)
##fitH0=GeoVarestbootstrap(fitH0,K=100,optimizer="nlminb",
##                     lower=lower0, upper=upper0)

#  Composite likelihood Wald and ratio statistic statistic tests
#  rejecting null  hypothesis beta1=0
##GeoTests(fitH1, fitH0 ,statistic='Wald')
##GeoTests(fitH1, fitH0 , statistic='WilksS')
##GeoTests(fitH1, fitH0 , statistic='WilksCB')




################################################################
###
### Example 2. Parametric test of Gaussianity
### using SinhAsinh random fields using standard likelihood
###
###############################################################
set.seed(99)
model="SinhAsinh" 
# Define the spatial-coordinates of the points:
NN=200
x = runif(NN, 0, 1)
y = runif(NN, 0, 1)
coords = cbind(x,y)
# Parameters
mean=0; nugget=0; sill=1
### skew and tail parameters
skew=0;tail=1   ## H0 is Gaussianity
# underlying model correlation 
corrmodel="Wend0"
power2=4;c_supp=0.2

# simulation from Gaussian  model (H0)
param=list(power2=power2,skew=skew,tail=tail,
             mean=mean,sill=sill,scale=c_supp,nugget=nugget)
data = GeoSim(coordx=coords, corrmodel=corrmodel,model=model, param=param)$data


##### H1: SinhAsinh model
fixed=list(power2=power2,nugget=nugget,mean=mean)
start=list(scale=c_supp,skew=skew,tail=tail,sill=sill)

lower=list(scale=0,skew=-I, tail=0,sill=0)
upper=list(scale=I,skew= I,tail=I,sill=I)
# Maximum pairwise composite-likelihood fitting of the RF:
fitH1 = GeoFit2(data=data,coordx=coords,corrmodel=corrmodel, model=model,
                   likelihood="Full",type="Standard",varest=TRUE,
                   lower=lower,upper=upper,
                   optimizer="nlminb",
                    start=start,fixed=fixed)

unlist(fitH1$param)

##### H0: Gaussianity (i.e tail1=1, skew=0 fixed)
fixed=list(power2=power2,nugget=nugget,mean=mean,tail=1,skew=0)
start=list(scale=c_supp,sill=sill)
lower=list(scale=0,sill=0)
upper=list(scale=2,sill=5)
# Maximum pairwise composite-likelihood fitting of the RF:
fitH0 = GeoFit(data=data,coordx=coords,corrmodel=corrmodel, model=model,
                    likelihood="Full",type="Standard",varest=TRUE,
                      lower=lower,upper=upper,
                   optimizer="nlminb",
                    start=start,fixed=fixed)

unlist(fitH0$param)

#  Standard likelihood Wald and ratio statistic statistic tests
#  not rejecting null  hypothesis tail=1,skew=0 (Gaussianity)
GeoTests(fitH1, fitH0,statistic='Wald')
GeoTests(fitH1, fitH0,statistic='Wilks')

</code></pre>


</div>