<div class="container">

<table style="width: 100%;"><tr>
<td>growth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>recovery of growth velocities 
</h2>

<h3>Description</h3>

<p>Computes the mean function and covariance kernel (over a fine grid of equispaced time points) of the posterior growth velocity  for each subject, based on growth data (e.g., heights) at fixed observation times.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	growth(data, tobs, sigma, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Input matrix of size N (subjects) times n (observation times). Each column  contains the heights (of all subjects) at a given observation time, each row contains the heights (at the observation times) for a given subject.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tobs</code></td>
<td>

<p>Row vector of n observation times (in increasing order, same for each subject).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>A positive scalar representing the infinitessimal standard deviation of the tied-down Brownian motion in the prior. Can be selected by cross-validation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>Number of time points on the fine grid.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Bayesian reconstruction implemented here uses a prior growth velocity model that is specified by a general multivariate normal distribution at the n fixed observation times, and a tied-down Brownian motion (having  infinitessimal standard deviation specified by <code>sigma</code>) between the observation times.
</p>
<p>The prior mean and prior precision matrix at the observation times are estimated using the data on N subjects. Clime (constrained L1 minimization) provides the estimate of the prior precision matrix, with the clime constraint parameter lambda selected by 5-fold cross validation using the likelihood loss function.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>muhatcurve</code></td>
<td>

<p>Posterior means of the growth velocities (for each subject) on the fine grid <code>tgrid</code>.  An N (subjects) times <code>d</code> matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Khat</code></td>
<td>

<p>Posterior covariance kernel of the growth velocities on the fine grid <code>tgrid</code>. A <code>d</code> times <code>d</code> matrix (the same for every subject).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tgrid</code></td>
<td>

<p>The fine grid of <code>d</code> equispaced-time points (between the first and last observation times in <code>tobs</code>) at which the posterior means and covariances are computed.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sara Lopez-Pintado and Ian W. McKeague
</p>
<p>Maintainer:  Ian W. McKeague &lt;im2131@columbia.edu&gt;
</p>


<h3>References</h3>

<p>Lopez-Pintado, S. and McKeague, I. W. (2013).
<em>Recovering gradients from sparsely observed functional
data.</em> Biometrics 69, 396-404 (2013).
http://www.columbia.edu/~im2131/ps/growthrate-package-reference.pdf
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## example using the height data provided in the package
## there are 7 observation times (age in years):
	data(height_data);
	tobs=c(0,1/3,2/3,1,3,4,7);
	d=200;
	sigma=1;
	g=growth(height_data,tobs,sigma,d);

## Plot of the posterior mean and credible interval for a specific individual
	indiv=1;
## posterior standard deviation (same for all subjects):
	postsd=sqrt(diag(g$Khat));
	plot(g$tgrid,g$muhatcurve[indiv,],type='l',
			xlab="Age (years)",ylab="Growth velocity (cms/year)");
	lines(g$tgrid,g$muhatcurve[indiv,]);
	lines(g$tgrid,g$muhatcurve[indiv,]+2*postsd,lty=2);
	lines(g$tgrid,g$muhatcurve[indiv,]-2*postsd,lty=2);

## Plot of a draw from the posterior growth velocity for a specific individual:
	draw=rmvnorm(n=1, mean=g$muhatcurve[indiv,], sigma=g$Khat, method="chol");
	plot(g$tgrid,draw,type='l',xlab="Age (years)",ylab="Growth
	velocity (cms/year)");

## End(Not run)
</code></pre>


</div>