<div class="container">

<table style="width: 100%;"><tr>
<td>ipf.gamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Iterative Proportional Fitting in Relational Models, with a Given Adjustment Factor
</h2>

<h3>Description</h3>

<p>For a given model matrix and a given vector of observed cell frequencies, 
<code>ipf.gamma</code> computes the vector of frequencies whose subset sums are equal 
to the observed subset sums times the adjustment factor and whose  
relative frequencies satisfy the multiplicative structure prescribed by 
the model. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ipf.gamma(ModelMatrix, ObsTable, gamma, tol, estimand)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ModelMatrix </code></td>
<td>
<p>an <code>I</code> by <code>J</code> model matrix of a relational model.
<code>I</code> is the number of observations;  <code>J</code> is the number of generating subsets.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ObsTable </code></td>
<td>
<p>a vector of observed cell frequencies.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma </code></td>
<td>
<p>an adjustment factor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol </code></td>
<td>
<p>tolerance used in stopping criteria.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimand </code></td>
<td>
<p>set to <code>"probabilities"</code> in the case of multinomial 
sampling; set to <code>"intensities"</code> in the case of Poisson sampling.
</p>
</td>
</tr>
</table>
<h3>Value</h3>



<table>
<tr style="vertical-align: top;">
<td><code>model.matrix </code></td>
<td>
<p>the model matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed.data </code></td>
<td>
<p>the vector of observed cell frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values </code></td>
<td>
<p>the estimated cell frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.parameters </code></td>
<td>
<p>the estimated model parameters on the multiplicative scale.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anna Klimova, Tamas Rudas 
</p>


<h3>References</h3>

<p> A.Klimova, T.Rudas, A.Dobra,
Relational models for contingency tables. 
J. Multivariate Anal., 2012, 104, 159–173.
</p>
<p>A.Klimova, T.Rudas, 
Iterative proportional scaling for curved exponential families. 
Scand. J. Statist., 2015, 42, 832–847. 
</p>
<p>A. Klimova, Coordinate-Free Exponential Families on Contingency Tables. PhD thesis. Advisers: Tamas Rudas and Thomas Richardson.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## The model of independence for a 2 by 2 contingency table

A = matrix(c( 1,1,0,0,
              0,0,1,1,
              1,0,1,0,
              0,1,0,1), byrow=TRUE, nrow=4) ## the model matrix

y = c(1,2,3,4)  ## the observed data

ipf.gamma(A, y, 1, 1e-6, "intensities")   ## Adjustment factor is set to 1 

ipf.gamma(A, y, 0.5, 1e-6, "intensities")   ## Adjustment factor is set to 0.5 


</code></pre>


</div>