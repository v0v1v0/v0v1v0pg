<div class="container">

<table style="width: 100%;"><tr>
<td>bwWilhelm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wilhelm (2015) bandwidth selection</h2>

<h3>Description</h3>

<p>It computes the optimal bandwidth for the HAC estimation of the
covariance matrix of the moment conditions. The bandwidth was shown by
Wilhelm (2005) to be the one that minimizes the MSE of the GMM estimator. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">bwWilhelm(x, order.by = NULL, kernel = c("Quadratic Spectral",
  "Bartlett", "Parzen", "Tukey-Hanning"), approx = c("AR(1)", "ARMA(1,1)"),
  weights = NULL, prewhite = 1, ar.method = "ols", data = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>gmm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.by</code></td>
<td>
<p>Either a vector 'z' or a formula with a single
explanatory variable like '~ z'. The observations in the model are ordered by the size of 'z'. If set to 'NULL' (the default)
the observations are assumed to be ordered (e.g., a time
series).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>type of kernel used to compute the covariance matrix of the vector of sample moment conditions (see <code>kernHAC</code> for more details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>A character specifying the approximation method if the bandwidth has to be chosen by <code>bwAndrews</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>numeric. A vector of weights used for weighting the
estimated coefficients of the approximation model (as specified by 'approx'). By default all weights are 1 except that for the
intercept term (if there is more than one variable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prewhite</code></td>
<td>
<p>logical or integer. Should the estimating functions be prewhitened? If <code>TRUE</code> or greater than 0 a VAR model of order <code>as.integer(prewhite)</code> is fitted via <code>ar</code> with method <code>"ols"</code> and <code>demean = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.method</code></td>
<td>
<p>character. The <code>method</code> argument passed to <code>ar</code> for prewhitening.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the 'order.by' model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function 'bwWilhelm'  returns the optimal bandwidth.
</p>


<h3>Note</h3>

<p>The function was written by Daniel Wilhelm and is based on bwAndrews.
</p>


<h3>References</h3>

<p>Wilhelm, D. (2015), Optimal Bandwidth Selection for Robust Generalized
Method of Moments Estimation.
<em>Econometric Theory</em>, <b>31</b>, 1054–1077
</p>
<p>Zeileis A (2006), Object-oriented Computation of Sandwich Estimators.
<em>Journal of Statistical Software</em>, <b>16</b>(9), 1–16.
URL <a href="https://doi.org/10.18637/jss.v016.i09">doi:10.18637/jss.v016.i09</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Finance)
f1 &lt;- Finance[1:300, "rm"] 
f2 &lt;- Finance[1:300, "hml"] 
f3 &lt;- Finance[1:300, "smb"] 
y &lt;- Finance[1:300,"WMK"]

## Silly example just to make it over-identified
###############################################
res &lt;- gmm(y ~ f1, ~ f1 + f2 + f3)
summary(res)


## Set the bandwidth using the second step estimate
################################################
bw &lt;- bwWilhelm(res)
res2 &lt;- update(res, bw=bw)
summary(res2)

## Set the bandwidth using the first-step estimate as for bwAndrews
###################################################################
res3 &lt;- gmm(y ~ f1, ~ f1 + f2 + f3, bw=bwWilhelm)
summary(res3)




</code></pre>


</div>