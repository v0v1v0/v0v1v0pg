<div class="container">

<table style="width: 100%;"><tr>
<td>gene_types</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Gene types
</h2>

<h3>Description</h3>

<p>Returns a vector containing the available gene types. In addition to
these gene types, the user can provide graphical functions that return
a list or a single <code>grob</code> object. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">gene_types(auto = TRUE)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>auto</code></td>
<td>

<p>Logical. Should type "auto" be added?
</p>
</td>
</tr></table>
<h3>Details</h3>

<p><code>dna_seg</code>s may contain one character column
<code>gene_type</code>. Elements in this column should either be one of the
predefined gene types, or refer to a graphical function that has
exactly the same name and that returns a <code>grob</code> or a <code>gList</code>
object.
</p>
<p>A gene object (i.e. a single row of a <code>dna_seg</code>) is passed to the
graphical function, as well as the contents of the .... The start
and line width of an element can thus be accessed via
<code>gene$start</code> and <code>gene$lwd</code>. Extra columns that would be
added in the <code>dna_seg</code> can be used similarly. Extra arguments can
also be globally passed via ... when calling <code>plot_gene_map</code>.
</p>


<h3>Value</h3>

<p>A character vector.
</p>


<h3>Author(s)</h3>

<p>Lionel Guy
</p>


<h3>See Also</h3>

<p><code>plot_gene_map</code>, <code>dna_seg</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## To view pre-coded gene types:
gene_types()

## Load data
data(barto)
n &lt;- length(gene_types(auto=FALSE))

## Get a small subset from the barto dataset
dna_seg &lt;- barto$dna_segs[[3]][1:n,]
plot_gene_map(list(dna_seg))

## Change gene_types and plot again
dna_seg$gene_type &lt;- gene_types(auto=FALSE)
dna_seg$fill &lt;- rainbow(n)
dna_seg_r &lt;- dna_seg
dna_seg_r$strand &lt;- -dna_seg$strand

## Add an annotation
annot &lt;- annotation(middle(dna_seg), text=dna_seg$gene_type, rot=45,
                    col=dna_seg$col)

## Plot
plot_gene_map(list(dna_seg, dna_seg_r), annotations=list(annot, annot),
              annotation_height=5, dna_seg_line=grey(0.7))


## Using home-made graphical functions
## Data
data(three_genes)

## Functions returning grobs.
## Creates a triangle
triangleGrob &lt;- function(gene, ...) {
  x &lt;- c(gene$start, (gene$start+gene$end)/2, gene$end)
  y1 &lt;- 0.5 + 0.4*gene$strand
  y &lt;- c(y1, 0.5, y1)
  polygonGrob(x, y, gp=gpar(fill=gene$fill, col=gene$col, lty=gene$lty,
                      lwd=gene$lwd), default.units="native")
}

## Draws a star. Note that the limits of the dna_seg region are
## voluntarily not respected
starGrob &lt;- function(gene, ...){
  ## Coordinates for the star
  x &lt;- sin(((0:5)/2.5)*pi)*(gene$end-gene$start)/2 + (gene$end+gene$start)/2
  y &lt;- cos(((0:5)/2.5)*pi)*gene$strand*2 + 0.5
  idx &lt;- c(1, 3, 5, 2, 4, 1)
  ## Attribute line_col only if present in the gene
  line_col &lt;- if (!is.null(gene$line_col)) gene$line_col else gene$col
  ## Having a conditional transparency, depending on a length cut-off
  ## passed via dots
  length_cutoff &lt;- list(...)$length_cutoff
  if (!is.null(length_cutoff)){
    alpha &lt;- if ((gene$end-gene$start) &lt; length_cutoff)  0.3 else  0.8
  } else alpha &lt;- 1
  
  ## Grobs
  g &lt;- polygonGrob(x[idx], y[idx], gp=gpar(fill=gene$col, col=line_col,
                                     lty=gene$lty, lwd=gene$lwd, alpha=alpha),
                   default.units="native")
  t &lt;- textGrob(label="***", x=(gene$end+gene$start)/2, y=0.5,
                default.units="native")
  gList(g, t)
}

## Replacing the standard types
dna_segs[[1]]$gene_type &lt;- "triangleGrob"
dna_segs[[2]]$gene_type &lt;- "starGrob"
## Adding more variables
dna_segs[[2]]$line_col &lt;- c("black", grey(0.3), "blue")
## Mix of several types on the same line
dna_segs[[3]]$gene_type &lt;- c("starGrob", "triangleGrob", "arrows")

## Plot
plot_gene_map(dna_segs, comparisons, length_cutoff=600)


</code></pre>


</div>