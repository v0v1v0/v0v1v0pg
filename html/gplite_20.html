<div class="container">

<table style="width: 100%;"><tr>
<td>gp_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a GP model</h2>

<h3>Description</h3>

<p>Function <code>gp_fit</code> fits a GP model with the current hyperparameters.
Notice that this function does not optimize the hyperparameters in any way,
but only finds the analytical posterior approximation (depending on chosen
<code>approx</code>) for the latent values with the current hyperparameters.
For optimizing the hyperparameter
values, see <code>gp_optim</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gp_fit(gp, x, y, trials = NULL, offset = NULL, jitter = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gp</code></td>
<td>
<p>The gp model object to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>n-by-d matrix of input values (n is the number of observations and d the input dimension).
Can also be a vector of length n if the model has only a single input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of n output (target) values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>Vector of length n giving the number of trials for each observation in binomial
(and beta binomial) model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Vector of constant values added to the latent values f_i (i = 1,...,n).
For Poisson models, this is the logarithm of the exposure time in each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>Magnitude of diagonal jitter for covariance matrices for numerical stability.
Default is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently ignored</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An updated GP model object.
</p>


<h3>References</h3>

<p>Rasmussen, C. E. and Williams, C. K. I. (2006). Gaussian processes for machine learning.
MIT Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate some toy data
set.seed(32004)
n &lt;- 150
sigma &lt;- 0.1
x &lt;- rnorm(n)
ycont &lt;- sin(3 * x) * exp(-abs(x)) + rnorm(n) * sigma
y &lt;- rep(0, n)
y[ycont &gt; 0] &lt;- 1
trials &lt;- rep(1, n)

# Fit the model using Laplace approximation (with the specified hyperparameters)
cf &lt;- cf_sexp(lscale = 0.3, magn = 3)
gp &lt;- gp_init(cf, lik_binomial())
gp &lt;- gp_fit(gp, x, y, trials = trials)


</code></pre>


</div>