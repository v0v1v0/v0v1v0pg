<div class="container">

<table style="width: 100%;"><tr>
<td>as_rtf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Save a summary table object as an RTF file</h2>

<h3>Description</h3>

<p>Convert and save the summary table object created with <code>as_table</code>
to an RTF file using r2rtf; currently only implemented for
<code>gsBinomialExact</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">as_rtf(x, ...)

## S3 method for class 'gsBinomialExactTable'
as_rtf(
  x,
  file,
  ...,
  title = paste("Operating Characteristics by Underlying Response Rate for",
    "Exact Binomial Group Sequential Design"),
  theta_label = "Underlying Response Rate",
  response_outcome = TRUE,
  bound_label = if (response_outcome) c("Futility Bound", "Efficacy Bound") else
    c("Efficacy Bound", "Futility Bound"),
  en_label = "Expected Sample Sizes",
  prob_decimals = 2,
  en_decimals = 1,
  rr_decimals = 0
)

## S3 method for class 'gsBoundSummary'
as_rtf(
  x,
  file,
  ...,
  title = "Boundary Characteristics for Group Sequential Design",
  footnote_p_onesided = "one-side p-value for experimental better than control",
  footnote_appx_effect_at_bound = NULL,
  footnote_p_cross_h0 = "Cumulative type I error assuming binding futility bound",
  footnote_p_cross_h1 = "Cumulative power under the alternate hypothesis",
  footnote_specify = NULL,
  footnote_text = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object to be saved as RTF file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters that may be specific to the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>File path for the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Title of the report.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_label</code></td>
<td>
<p>Label for theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response_outcome</code></td>
<td>
<p>Logical values indicating if the outcome is
response rate (<code>TRUE</code>) or failure rate (<code>FALSE</code>).
The default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound_label</code></td>
<td>
<p>Label for bounds.
If the outcome is response rate, then the label is "Futility bound"
and "Efficacy bound".
If the outcome is failure rate, then the label is "Efficacy bound"
and "Futility bound".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>en_label</code></td>
<td>
<p>Label for expected number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_decimals</code></td>
<td>
<p>Number of decimal places for probability of crossing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>en_decimals</code></td>
<td>
<p>Number of decimal places for expected number of
observations when bound is crossed or when trial ends without crossing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rr_decimals</code></td>
<td>
<p>Number of decimal places for response rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footnote_p_onesided</code></td>
<td>
<p>Footnote for one-side p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footnote_appx_effect_at_bound</code></td>
<td>
<p>Footnote for approximate effect treatment at bound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footnote_p_cross_h0</code></td>
<td>
<p>Footnote for cumulative type I error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footnote_p_cross_h1</code></td>
<td>
<p>Footnote for cumulative power under the alternate hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footnote_specify</code></td>
<td>
<p>Vector of string to put footnote super script.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>footnote_text</code></td>
<td>
<p>Vector of string of footnote text.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Currently only implemented for <code>gsBinomialExact</code> objects.
Creates a table to summarize an object.
For <code>gsBinomialExact</code>, this summarized operating characteristics
across a range of effect sizes.
</p>


<h3>Value</h3>

<p><code>as_rtf()</code> returns the input <code>x</code> invisibly.
</p>


<h3>See Also</h3>

<p><code>vignette("binomialSPRTExample")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># as_rtf for gsBinomialExact
zz &lt;- gsBinomialExact(
  k = 3, theta = seq(0.1, 0.9, 0.1), n.I = c(12, 24, 36),
  a = c(-1, 0, 11), b = c(5, 9, 12)
)
zz %&gt;%
  as_table() %&gt;%
  as_rtf(
    file = tempfile(fileext = ".rtf"),
    title = "Power/Type I Error and Expected Sample Size for a Group Sequential Design"
  )

safety_design &lt;- binomialSPRT(
  p0 = .04, p1 = .1, alpha = .04, beta = .2, minn = 4, maxn = 75
)
safety_power &lt;- gsBinomialExact(
  k = length(safety_design$n.I),
  theta = seq(.02, .16, .02),
  n.I = safety_design$n.I,
  a = safety_design$lower$bound,
  b = safety_design$upper$bound
)
safety_power %&gt;%
  as_table() %&gt;%
  as_rtf(
    file = tempfile(fileext = ".rtf"),
    theta_label = "Underlying\nAE Rate",
    prob_decimals = 3,
    bound_label = c("Low Rate", "High Rate")
  )
# as_rtf for gsBoundSummary
xgs &lt;- gsSurv(lambdaC = .2, hr = .5, eta = .1, T = 2, minfup = 1.5)
gsBoundSummary(xgs, timename = "Year", tdigits = 1) %&gt;% as_rtf(file = tempfile(fileext = ".rtf"))

ss &lt;- nSurvival(
  lambda1 = .2, lambda2 = .1, eta = .1, Ts = 2, Tr = .5,
  sided = 1, alpha = .025, ratio = 2
)
xs &lt;- gsDesign(nFixSurv = ss$n, n.fix = ss$nEvents, delta1 = log(ss$lambda2 / ss$lambda1))
gsBoundSummary(xs, logdelta = TRUE, ratio = ss$ratio) %&gt;% as_rtf(file = tempfile(fileext = ".rtf"))

xs &lt;- gsDesign(nFixSurv = ss$n, n.fix = ss$nEvents, delta1 = log(ss$lambda2 / ss$lambda1))
gsBoundSummary(xs, logdelta = TRUE, ratio = ss$ratio) %&gt;% 
  as_rtf(file = tempfile(fileext = ".rtf"),
  footnote_specify = "Z",
  footnote_text = "Z-Score")
</code></pre>


</div>