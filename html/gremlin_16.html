<div class="container">

<table style="width: 100%;"><tr>
<td>reml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>REML optimization algorithms for mixed-effect models.</h2>

<h3>Description</h3>

<p>Evaluate the REML likelihood and algorithms for iterating to find maximum 
REML estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reml(
  nu,
  skel,
  thetaG,
  sLc,
  modMats,
  W,
  Bpinv,
  nminffx,
  nminfrfx,
  rfxlvls,
  rfxIncContrib2loglik,
  thetaR = NULL,
  tWW = NULL,
  RHS = NULL
)

em(nuvin, thetaG, thetaR, conv, modMats, nminffx, sLc, ndgeninv, sln, r)

ai(nuvin, skel, thetaG, modMats, W, sLc, sln, r, thetaR = NULL, sigma2e = NULL)

gradFun(
  nuvin,
  thetaG,
  modMats,
  Cinv,
  sln,
  sigma2e = NULL,
  r = NULL,
  nminfrfx = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nu, nuvin</code></td>
<td>
<p>A <code>list</code> or <code>vector</code> of (co)variance parameters to
estimate on the transformed, or nu, scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skel</code></td>
<td>
<p>A skeleton for reconstructing the list of (co)variance parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaG, thetaR</code></td>
<td>
<p><code>Integer</code> vectors indexing the G-structure or
R-structure of the (co)variance parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sLc</code></td>
<td>
<p>A sparse <code>Matrix</code> containing the symbolic Cholesky
factorization of the coefficient matrix of the Mixed Model Equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modMats</code></td>
<td>
<p>A <code>list</code> of the model matrices used to construct the
mixed model equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W, tWW</code></td>
<td>
<p>A sparse <code>Matrix</code> containing the design matrices for the fixed
and random effects (<code>W</code>) and the crossproduct of this (<code>tWW</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bpinv</code></td>
<td>
<p>A matrix inverse of the matrix containing the prior specification
for fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nminffx, nminfrfx, rfxlvls</code></td>
<td>
<p><code>Integers</code> specifying: (1) the difference
between the number of observations and fixed effects (of the full rank fixed
effects design matrix (X), (2) <code>nminffx</code> minus the total number of
random effects, and (3) a <code>vector</code> of levels for each term in the 
random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rfxIncContrib2loglik</code></td>
<td>
<p>A <code>numeric</code> indicating the sum of constrant
contributions to the log-likelihood across all terms in the random effects
that have non-diagonal generalized inverse matrices (<code>ginverse</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RHS</code></td>
<td>
<p>A sparse <code>Matrix</code> containing the Right-Hand Side to the 
Mixed Model Equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>A <code>character</code> vector of (co)variance parameter constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndgeninv</code></td>
<td>
<p>A <code>logical</code> vector indicating if each random term is
associated with a generalized inverse (<code>ginverse</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sln, r</code></td>
<td>
<p>Sparse <code>Matrices</code> containing the solutions or residuals
of the Mixed Model Equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2e</code></td>
<td>
<p>A <code>numeric</code> value for the residual variance estimate
when it has been factored out of the Coefficient matrix of the Mixed Model
Equations, thus converting the (co)variance components to ratios
(represented by the variable lambda).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cinv</code></td>
<td>
<p>A sparse <code>Matrix</code> containing the inverse of the Coefficient
matrix to the Mixed Model Equations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> or <code>matrix</code> containing any of the previous
parameters described above, or the following that are in addition to or
instead of parameters above:
</p>

<dl>
<dt>loglik </dt>
<dd>
<p>The REML log-likelihood.</p>
</dd>
<dt>tyPy,logDetC </dt>
<dd>
<p>Components of the REML log-likelihood derived from the 
Cholesky factor of the Coefficient matrix to the Mixed Model Equations.</p>
</dd>
<dt>Cinv_ii </dt>
<dd>
<p>A vector containing the diagonal elements of the inverse
of the Coefficient matrix to the Mixed Model Equations (i.e., the
diagonal entries of <code>Cinv</code>).</p>
</dd>
<dt>AI </dt>
<dd>
<p>A <code>matrix</code> of values containing the Average Information
matrix, or second partial derivatives of the likelihood with respect to
the transformed (co)variance components (nu). The inverse of this matrix
gives the sampling variances of these transformed (co)variance components.</p>
</dd>
<dt>dLdnu </dt>
<dd>
<p>A single column <code>matrix</code> of first derivatives of
the transformed (co)variance parameters (nu) with respect to the
log-Likelihood.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p><a href="mailto:matthewwolak@gmail.com">matthewwolak@gmail.com</a>
</p>


</div>