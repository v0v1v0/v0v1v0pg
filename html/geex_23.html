<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_sandwich_matrices</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate component matrices of the empirical sandwich covariance estimator</h2>

<h3>Description</h3>

<p>For a given set of estimating equations computes the 'meat' (<code class="reqn">B_m</code>
in Stefanski and Boos notation) and 'bread' (<code class="reqn">A_m</code> in Stefanski and
Boos notation) matrices necessary to compute the covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_sandwich_matrices(.basis, .theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.basis</code></td>
<td>
<p>basis an object of class <code>m_estimation_basis</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.theta</code></td>
<td>
<p>vector of parameter estimates (i.e. estimated roots)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a set of estimating equations (<code class="reqn">\sum_i \psi(O_i, \theta) = 0</code>),
this function computes:
</p>
<p style="text-align: center;"><code class="reqn">A_i =  \partial \psi(O_i, \theta)/\partial \theta</code>
</p>

<p style="text-align: center;"><code class="reqn">A =  \sum_i A_i</code>
</p>

<p style="text-align: center;"><code class="reqn">B_i =  \psi(O_i, \theta)\psi(O_i, \theta)^T</code>
</p>

<p style="text-align: center;"><code class="reqn">B =  \sum_i B_i</code>
</p>

<p>where all of the above are evaluated at <code class="reqn">\hat{\theta}</code>. The partial derivatives in <code class="reqn">A_i</code>
numerically approximated by the function defined in <code>deriv_control</code>.
</p>
<p>Note that <code class="reqn">A =  \sum_i A_i</code> and not <code class="reqn">\sum_i A_i/m</code>, and the same for <code class="reqn">B</code>.
</p>


<h3>Value</h3>

<p>a <code>sandwich_components</code> object
</p>


<h3>References</h3>

<p>Stefanski, L. A., &amp; Boos, D. D. (2002). The calculus of m-estimation. The American Statistician, 56(1), 29-38.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
myee &lt;- function(data){
  function(theta){
    c(data$Y1 - theta[1],
     (data$Y1 - theta[1])^2 - theta[2])
   }
 }

# Start with a basic basis
mybasis &lt;- create_basis(
  estFUN = myee,
  data   = geexex)

# Now estimate sandwich matrices
estimate_sandwich_matrices(
 mybasis, c(mean(geexex$Y1), var(geexex$Y1)))
</code></pre>


</div>