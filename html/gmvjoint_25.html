<div class="container">

<table style="width: 100%;"><tr>
<td>vcov.joint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract the variance-covariance matrix from a <code>joint</code> fit.</h2>

<h3>Description</h3>

<p>Extract the variance-covariance matrix from a <code>joint</code> fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'joint'
vcov(object, corr = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a joint model fit by the <code>joint</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>should the correlation matrix be returned instead of the variance-covariance?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments (none used).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses the observed-empirical <strong>approximation</strong> of information matrix 
(Mclachlan &amp; Krishnan, 2008). The standard errors for the baseline hazard are not estimated.
</p>


<h3>Value</h3>

<p>A variance-covariance matrix for the joint model object.
</p>


<h3>Methodology</h3>

<p>Many competing ways exist for obtaining the observed information matrix in an EM algorithm. 
In the context of joint modelling, the observed empirical approximation of the information 
matrix has been used previously (<code>joineRML</code>, Hickey et al. 2018). Elsewhere,
estimation of the observed information in a semi-parametric setting is outlined neatly in
Xu et al. (2014). Here, they advocate for approximation of this information matrix by 
numerical differentiation of the profile Fisher Score vector. We do not consider this 
methodology owing to its computational expense. That is, for each element of <code class="reqn">\Omega</code> 
which is perturbed by some small amount <code class="reqn">\tilde{\Omega}^{p}</code>, we must re-calculate
<code class="reqn">\hat{b}_i</code> and <code class="reqn">\hat{\Sigma}_i</code>.
</p>


<h3>Author(s)</h3>

<p>James Murray <a href="mailto:j.murray7@ncl.ac.uk">j.murray7@ncl.ac.uk</a>
</p>


<h3>References</h3>

<p>Hickey GL, Philipson P, Jorgensen A, Kolamunnage-Dona R. <code>joineRML</code>: a joint model and
software package for time-to-event and multivariate longitudinal outcomes.
<em>BMC Med. Res. Methodol.</em> 2018; <strong>50</strong>
</p>
<p>McLachlan GJ, Krishnan T. <em>The EM Algorithm and Extensions.</em> Second Edition. 
Wiley-Interscience; 2008.
</p>
<p>Xu C, Baines PD, Wang J. Standard error estimation using the EM algorithm for the joint 
modeling of survival and longitudinal data. <em>Biostatistics</em> 2014; <strong>15</strong>(4).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Univariate fit on PBC data -------------------------------------------
data(PBC)

# Subset data and remove NAs
PBC &lt;- subset(PBC, select = c('id', 'survtime', 'status', 'drug', 'time',
                              'albumin'))
PBC &lt;- na.omit(PBC) 

# Specify univariate fit
long.formulas &lt;- list(
  albumin ~ time + (1 + time|id)
)
surv.formula &lt;- Surv(survtime, status) ~ drug

fit &lt;- joint(long.formulas, surv.formula, PBC, family = list('gaussian'))

vcov(fit)
</code></pre>


</div>