<div class="container">

<table style="width: 100%;"><tr>
<td>fitAncestralGraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting of Gaussian Ancestral Graph Models</h2>

<h3>Description</h3>

<p>Iterative conditional fitting of Gaussian Ancestral Graph Models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitAncestralGraph(amat, S, n, tol = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amat</code></td>
<td>
<p>a square matrix, representing the adjacency matrix of
an ancestral graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>a symmetric positive definite matrix with row and col names, the
sample covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the sample size, a positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a small positive number indicating the tolerance
used in convergence checks.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the Gaussian case, the models can be parameterized
using precision parameters, regression coefficients, and error
covariances (compare Richardson and Spirtes, 2002, Section 8). This
function finds the MLE <code class="reqn">\hat \Lambda</code> of the precision 
parameters by fitting a concentration  
graph model. The MLE <code class="reqn">\hat B</code> of the regression coefficients and
the MLE <code class="reqn">\hat\Omega</code> of the error covariances are obtained by
iterative conditional fitting (Drton and Richardson, 2003, 2004). The
three sets of parameters are 
combined to the MLE <code class="reqn">\hat\Sigma</code> of the covariance matrix by
matrix multiplication: 
</p>
<p style="text-align: center;"><code class="reqn">\hat\Sigma = \hat B^{-1}(\hat \Lambda+\hat\Omega)\hat
    B^{-T}.</code>
</p>

<p>Note that in Richardson and Spirtes (2002), the matrices <code class="reqn">\Lambda</code>
and <code class="reqn">\Omega</code> are defined as submatrices. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Shat</code></td>
<td>
<p>the fitted covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lhat</code></td>
<td>
<p>matrix of the fitted precisions associated with undirected
edges and vertices that do not have an arrowhead pointing at them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bhat</code></td>
<td>
<p>matrix of the fitted regression coefficients
associated to the directed edges.  Precisely said <code>Bhat</code>
contains ones on the diagonal and the off-diagonal entry
<code class="reqn">(i,j)</code> equals the <em>negated</em> MLE of the regression
coefficient for variable <code class="reqn">j</code> in the regression of variable
<code class="reqn">i</code> on its parents. Note that this <code class="reqn">(i,j)</code> entry
in <code>Bhat</code> corresponds to a directed edge <code class="reqn">j \to i</code>,
and thus to a one as <code class="reqn">(j,i)</code> entry in the adjacency matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ohat</code></td>
<td>
<p>matrix of the error covariances and variances of the residuals 
between regression equations associated with bi-directed edges and
vertices with an arrowhead pointing at them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev</code></td>
<td>
<p>the ‘deviance’ of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p>the iterations.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mathias Drton</p>


<h3>References</h3>

 
<p>Drton, M. and Richardson, T. S. (2003). A new algorithm for
maximum likelihood estimation in Gaussian graphical models for
marginal independence. <em>Proceedings
of the Nineteenth Conference on Uncertainty in Artificial
Intelligence</em>, 184-191.
</p>
<p>Drton, M. and Richardson, T. S. (2004). Iterative Conditional Fitting
for Gaussian Ancestral Graph Models.  Proceedings
of the 20th Conference on Uncertainty in Artificial Intelligence,
Department of Statistics, 130-137.
</p>
<p>Richardson, T. S. and Spirtes, P. (2002). Ancestral Graph Markov
Models. <em>Annals of Statistics</em>. 30(4), 962-1030.
</p>


<h3>See Also</h3>

<p><code>fitCovGraph</code>, <code>icf</code>,
<code>makeMG</code>, <code>fitDag</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## A covariance matrix
"S" &lt;- structure(c(2.93, -1.7, 0.76, -0.06,
                  -1.7, 1.64, -0.78, 0.1,
                   0.76, -0.78, 1.66, -0.78,
                  -0.06, 0.1, -0.78, 0.81), .Dim = c(4,4),
                 .Dimnames = list(c("y", "x", "z", "u"), c("y", "x", "z", "u")))
## The following should give the same fit.   
## Fit an ancestral graph y -&gt; x &lt;-&gt; z &lt;- u
fitAncestralGraph(ag1 &lt;- makeMG(dg=DAG(x~y,z~u), bg = UG(~x*z)), S, n=100)

## Fit an ancestral graph y &lt;-&gt; x &lt;-&gt; z &lt;-&gt; u
fitAncestralGraph(ag2 &lt;- makeMG(bg= UG(~y*x+x*z+z*u)), S, n=100)

## Fit the same graph with fitCovGraph
fitCovGraph(ag2, S, n=100)    

## Another example for the mathematics marks data

data(marks)
S &lt;- var(marks)
mag1 &lt;- makeMG(bg=UG(~mechanics*vectors*algebra+algebra*analysis*statistics))
fitAncestralGraph(mag1, S, n=88)

mag2 &lt;- makeMG(ug=UG(~mechanics*vectors+analysis*statistics),
               dg=DAG(algebra~mechanics+vectors+analysis+statistics))
fitAncestralGraph(mag2, S, n=88) # Same fit as above
</code></pre>


</div>