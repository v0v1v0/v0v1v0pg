<div class="container">

<table style="width: 100%;"><tr>
<td>plotUncertainty</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot I-splines With Error Bands Using Bootstrapping.</h2>

<h3>Description</h3>

<p>This function estimates uncertainty in the fitted I-splines
by fitting many GDMs using a subsample of the data. The function can run in parallel
on multicore machines to reduce computation time (recommended for large number
of iterations). I-spline plots with error bands (+/- one standard deviation)
are produced showing (1) the variance of I-spline coefficients and (2) a rug plot
indicating how sites used in model fitting are distributed along each gradient.
Function result optionally can be saved to disk as a csv for custom plotting, etc.
The result output table will have 6 columns per predictor, three each for the
x and y values containing the lower bound, full model, and upper bound.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotUncertainty(spTable, sampleSites, bsIters, geo=FALSE,
splines=NULL, knots=NULL, splineCol="blue", errCol="grey80",
plot.linewidth=2.0, plot.layout=c(2,2), parallel=FALSE, cores=2, save=FALSE,
fileName="gdm.plotUncertainy.csv")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spTable</code></td>
<td>
<p>A site-pair table, same as used to fit a <code>gdm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleSites</code></td>
<td>
<p>The fraction (0-1) of sites to retain from the full
site-pair table when subsampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bsIters</code></td>
<td>
<p>The number of bootstrap iterations to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geo</code></td>
<td>
<p>Same as the <code>gdm</code> geo argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splines</code></td>
<td>
<p>Same as the <code>gdm</code> splines argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Same as the <code>gdm</code> knots argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splineCol</code></td>
<td>
<p>The color of the plotted mean spline. The default is "blue".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errCol</code></td>
<td>
<p>The color of shading for the error bands (+/- one standard
deviation around the mean line). The default is "grey80".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.linewidth</code></td>
<td>
<p>The line width of the plotted mean spline line. The
default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.layout</code></td>
<td>
<p>Same as the <code>plot.gdm</code> plot.layout argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Perform the uncertainty assessment using multiple
cores? Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>When the parallel argument is set to TRUE, the number of
cores to be registered for the foreach loop. Must be &lt;= the number of cores
in the machine running the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>
<p>Save the function result (e.g., for custom plotting)? Default=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileName</code></td>
<td>
<p>Name of the csv file to save the data frame that contains the function
result. Default = gdm.plotUncertainy.csv. Ignored if save=FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>plotUncertainty returns NULL. Saves a csv to disk if save=TRUE.
</p>


<h3>References</h3>

<p>Shryock, D. F., C. A. Havrilla, L. A. DeFalco, T. C. Esque,
N. A. Custer, and T. E. Wood. 2015. Landscape genomics of <em>Sphaeralcea ambigua</em>
in the Mojave Desert: a multivariate, spatially-explicit approach to guide
ecological restoration. <em>Conservation Genetics</em> 16:1303-1317.
</p>


<h3>See Also</h3>

<p><code>plot.gdm, formatsitepair, subsample.sitepair</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##set up site-pair table using the southwest data set
sppData &lt;- southwest[c(1,2,13,14)]
envTab &lt;- southwest[c(2:ncol(southwest))]
sitePairTab &lt;- formatsitepair(sppData, 2, XColumn="Long", YColumn="Lat",
                              sppColumn="species", siteColumn="site", predData=envTab)

##plot GDM uncertainty using one core
#not run
#plotUncertainty(sitePairTab, sampleSites=0.70, bsIters=5, geo=TRUE, plot.layout=c(3,3))

##plot GDM uncertainty in parallel
#not run
#plotUncertainty(sitePairTab, sampleSites=0.70, bsIters=50, geo=TRUE, plot.layout=c(3,3),
                 #parallel=T, cores=10)

</code></pre>


</div>