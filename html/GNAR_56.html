<div class="container">

<table style="width: 100%;"><tr>
<td>weights_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes the weights matrix corresponding to the GNAR network object linked to the vector time series.

</h2>

<h3>Description</h3>

<p>Computes the weights matrix with normalised weights (i.e., add up to one) for the network time series with underlying network provided by the user. If the network is unweighted, then each r-stage neighbour is considered equally relevant, i.e., <code class="reqn">w_{ij}</code> = <code class="reqn">\{ \mathcal{N}_r (i)\}^{-1} \mathbb{I} (d(i, j) = r) </code>, where <code class="reqn">\mathbb{I}</code> is the indicator function and the distance is the shortest path in the underlying network.

</p>


<h3>Usage</h3>

<pre><code class="language-R">weights_matrix(network, max_r_stage)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>network</code></td>
<td>
<p>Network linked to the vector time series under study, must be a GNARnet object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_r_stage</code></td>
<td>
<p>Longest shortest path for which weights are non-zero. If not specified, then its set equal to the upper bound, which is the longest shortest path in the underlying network.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Weight matrix <code class="reqn">\mathbf{W}</code>, each entry is the weight <code class="reqn">w_{ij}</code> between a pair of nodes. The matrix is not symmetric, and each row adds up to one when considering r-stage neighbours for a particular r.





</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason.

</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Weights matrix linked to the mechanical ventilation beds time series. 
# This network has a longest shortest path equal to six.
# 
#data(fiveNet)
W_norm = weights_matrix(fiveNet, 6)
</code></pre>


</div>