<div class="container">

<table style="width: 100%;"><tr>
<td>dist_max_corr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the distance at which the correlation between genetic distance
and landscape distance is maximal</h2>

<h3>Description</h3>

<p>The function enables to compute the distance at which the
correlation between genetic distance and landscape distance is maximal,
using a method similar to that employed by van Strien et al. (2015).
Iteratively, distance threshold values are tested. For each value, all the
population pairs separated by a landscape distance larger than the threshold
are removed before the Mantel correlation coefficient between genetic
distance and landscape distance is computed.
The distance threshold at which the correlation is the strongest is then
identified. A figure showing the evolution of the correlation coefficients
when landscape distance threshold increases is plotted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dist_max_corr(
  mat_gd,
  mat_ld,
  interv,
  from = NULL,
  to = NULL,
  fig = TRUE,
  thr_gd = NULL,
  line_col = "black",
  pts_col = "#999999"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat_gd</code></td>
<td>
<p>A symmetric <code>matrix</code> or <code>dist</code> object with pairwise
genetic distances between populations or sample sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_ld</code></td>
<td>
<p>A symmetric <code>matrix</code> or <code>dist</code> object with pairwise
landscape distances between populations or sample sites. These distances
can be Euclidean distances, cost-distances or resistance distances,
among others.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interv</code></td>
<td>
<p>A numeric or integer value indicating the interval between
the different distance thresholds for which the correlation coefficients
are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>(optional) The minimum distance threshold value at which the
correlation coefficient is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>(optional) The maximum distance threshold value at which the
correlation coefficient is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fig</code></td>
<td>
<p>Logical (default = TRUE) indicating whether a figure is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr_gd</code></td>
<td>
<p>(optional) A numeric or integer value used to remove
genetic distance values from the data before the calculation.
All genetic distances values above 'thr_gd' are removed from the data.
This parameter can be used especially when there are outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line_col</code></td>
<td>
<p>(optional, if fig = TRUE) A character string indicating the
color used to plot the line (default: "blue"). It must be a hexadecimal color
code or a color used by default in R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts_col</code></td>
<td>
<p>(optional, if fig = TRUE) A character string indicating the
color used to plot the points (default: "#999999"). It must be a hexadecimal
color code or a color used by default in R.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>IDs in 'mat_gd' and 'mat_ld' must be the same and refer to the same
sampling sites or populations, and both matrices must be ordered
in the same way.
The correlation coefficient between genetic distance and landscape distance
computed is a Mantel correlation coefficient. If there are less than 50
pairwise values, the correlation is not computed, as in
van Strien et al. (2015). Such a method can be subject to criticism from
a strict statistical point of view given correlation coefficients computed
from samples of different size are compared.
The matrix of genetic distance 'mat_gd' can be computed using
<code>mat_gen_dist</code>.
The matrix of landscape distance 'mat_ld' can be computed using
<code>mat_geo_dist</code> when the landscape distance needed is a
Euclidean geographical distance.
Mantel correlation coefficients are computed using
the function <code>mantel</code>.
</p>


<h3>Value</h3>

<p>A list of objects:
</p>

<ul>
<li>
<p>The distance at which the correlation is the highest.
</p>
</li>
<li>
<p>The vector of correlation coefficients at the different
distance thresholds
</p>
</li>
<li>
<p>The vector of the different distance thresholds
</p>
</li>
<li>
<p>A ggplot2 object to plot
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>P. Savary
</p>


<h3>References</h3>

<p>Van Strien MJ, Holderegger R, Van Heck HJ (2015).
“Isolation-by-distance in landscapes: considerations for landscape genetics.”
<em>Heredity</em>, <b>114</b>(1), 27.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("data_tuto")
mat_gen &lt;- data_tuto[[1]]
mat_dist &lt;- data_tuto[[2]]*1000
res_dmc &lt;- dist_max_corr(mat_gd = mat_gen,
                         mat_ld = mat_dist,
                         from = 32000, to = 42000,
                         interv = 5000,
                         fig = FALSE)
</code></pre>


</div>