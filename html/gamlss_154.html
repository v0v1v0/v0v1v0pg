<div class="container">

<table style="width: 100%;"><tr>
<td>rqres.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creating and Plotting Randomized Quantile Residuals</h2>

<h3>Description</h3>

<p>This function plots worm plots, van Buuren and Fredriks M. (2001),  or QQ-plots of the normalized randomized quantile residuals (Dunn and Smyth, 1996) for a model using a discrete GAMLSS family distribution.    
</p>


<h3>Usage</h3>

<pre><code class="language-R">rqres.plot(obj = NULL, howmany = 6, plot.type = c("few", "all"), 
           type = c("wp", "QQ"),  xlim = NULL, ylim = NULL, ...)
get.rqres(obj = NULL, howmany = 10, order = FALSE)           
           
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a fitted GAMLSS model object from a "discrete" type of family </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>howmany</code></td>
<td>
<p>The number randomise  quantile residuals required i.e. <code>howmany=6</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p>whether to plot few of the randomised quantile residual realisations, <code>"few"</code> in a separate plots (there must be less than 8)  or all   <code>"all"</code> in one plot (with their median)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>whether to plot worm plots <code>"wp"</code>or QQ plots <code>"QQ"</code> with default worm plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>setting manually the <code>xlim</code> of the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>setting manually the <code>ylim</code> of the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>whether to order the ealization of randomised quantile residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra arguments to be passed to <code>wp()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For discrete family distributions, the <code>gamlss()</code> function saves on exit one realization of randomized quantile residuals which 
can be plotted using the generic function <code>plot</code> which calls the <code>plot.gamlss</code>. Looking at only one realization can be misleading, so the 
current function creates QQ-plots for several 
realizations. The function allows up to 10 QQ-plots to be plotted. Occasionally  one wishes to create a lot of realizations 
and then take a median of them (separately for each ordered value) to create a single median realization. The option <code>all</code> in combinations 
with the option <code>howmany</code> creates a 
QQ-plot of the medians of the normalized randomized quantile residuals. These 'median' randomized quantile residuals can be saved using the option
(<code>save=TRUE</code>).  
</p>


<h3>Value</h3>

<p>If <code>save</code> it is TRUE then the vector of the median residuals is saved. 
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos</p>


<h3>References</h3>

<p> Dunn, P. K. and Smyth, G. K. (1996) Randomised quantile residuals,
<em>J. Comput. Graph. Statist.</em>, <b>5</b>, 236–244
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>
<p>van Buuren and Fredriks M. (2001) Worm plot: simple diagnostic device for modelling growth reference curves. 
<em>Statistics in Medicine</em>, <b>20</b>, 1259–1277
</p>


<h3>See Also</h3>

 <p><code>plot.gamlss</code>, <code>gamlss</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">data(aids) # fitting a model from a discrete distribution 
h&lt;-gamlss(y~pb(x)+qrt, family=NBI, data=aids) # 
plot(h)
# plot qq- plots from 6 realization of the randomized quantile residuals
rqres.plot(h) 
# a worm-plot of the medians from 10 realizations
rqres.plot(h,howmany=40,plot="all") # 
</code></pre>


</div>