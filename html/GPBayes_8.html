<div class="container">

<table style="width: 100%;"><tr>
<td>GaSP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Building, fitting, predicting for a GaSP model</h2>

<h3>Description</h3>

<p>This function serves as a wrapper to build, fit, and make prediction 
for a Gaussian process model. It calls on functions <code>gp</code>, <code>gp.mcmc</code>,
<code>gp.optim</code>, <code>gp.predict</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GaSP(
  formula = ~1,
  output,
  input,
  param,
  smooth.est = FALSE,
  input.new = NULL,
  cov.model = list(family = "CH", form = "isotropic"),
  model.fit = "Cauchy_prior",
  prior = list(),
  proposal = list(range = 0.35, tail = 2, nugget = 0.8, nu = 0.8),
  nsample = 5000,
  burnin = 1000,
  opt = NULL,
  bound = NULL,
  dtype = "Euclidean",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of <code>formula</code> class that specifies regressors; see <code>formula</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>a numerical vector including observations or outputs in a GaSP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>a matrix including inputs in a GaSP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a list including values for regression parameters, covariance parameters, 
and nugget variance parameter.
The specification of <strong>param</strong> should depend on the covariance model. 
</p>

<ul>
<li>
<p>The regression parameters are denoted by <strong>coeff</strong>. Default value is <code class="reqn">\mathbf{0}</code>.
</p>
</li>
<li>
<p>The marginal variance or partial sill is denoted by <strong>sig2</strong>. Default value is 1.
</p>
</li>
<li>
<p>The nugget variance parameter is denoted by <strong>nugget</strong> for all covariance models. 
Default value is 0.
</p>
</li>
<li>
<p>For the Confluent Hypergeometric class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\beta</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li>
<p>For the generalized Cauchy class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>tail</strong> is used to denote the tail decay parameter <code class="reqn">\alpha</code>. <strong>nu</strong> is used to denote the 
smoothness parameter <code class="reqn">\nu</code>.
</p>
</li>
<li>
<p>For the Matérn class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>. 
<strong>nu</strong> is used to denote the smoothness parameter <code class="reqn">\nu</code>. When <code class="reqn">\nu=0.5</code>, the 
Matérn class corresponds to the exponential covariance.  
</p>
</li>
<li>
<p>For the powered-exponential class, <strong>range</strong> is used to denote the range parameter <code class="reqn">\phi</code>.
<strong>nu</strong> is used to denote the smoothness parameter. When <code class="reqn">\nu=2</code>, the powered-exponential class
corresponds to the Gaussian covariance.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.est</code></td>
<td>
<p>a logical value indicating whether smoothness parameter will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input.new</code></td>
<td>
<p>a matrix of new input locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.model</code></td>
<td>
<p>a list of two strings: <strong>family</strong>, <strong>form</strong>, where <strong>family</strong> indicates the family of covariance functions 
including the Confluent Hypergeometric class, the Matérn class, the Cauchy class, the powered-exponential class. <strong>form</strong> indicates the 
specific form of covariance structures including the isotropic form, tensor form, automatic relevance determination form. 
</p>

<dl>
<dt><strong>family</strong></dt>
<dd>

<dl>
<dt>CH</dt>
<dd>
<p>The Confluent Hypergeometric correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \frac{\Gamma(\nu+\alpha)}{\Gamma(\nu)} 
\mathcal{U}\left(\alpha, 1-\nu, \left(\frac{h}{\beta}\right)^2\right),</code>
</p>

<p>where <code class="reqn">\alpha</code> is the tail decay parameter. <code class="reqn">\beta</code> is the range parameter.
<code class="reqn">\nu</code> is the smoothness parameter. <code class="reqn">\mathcal{U}(\cdot)</code> is the confluent hypergeometric
function of the second kind. For details about this covariance, 
see Ma and Bhadra (2023; <a href="https://doi.org/10.1080/01621459.2022.2027775">doi:10.1080/01621459.2022.2027775</a>).  
</p>
</dd>
<dt>cauchy</dt>
<dd>
<p>The generalized Cauchy covariance is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h) = \left\{ 1 + \left( \frac{h}{\phi} \right)^{\nu}  
            \right\}^{-\alpha/\nu},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\alpha</code> is the tail decay parameter.
<code class="reqn">\nu</code> is the smoothness parameter with default value at 2.
</p>
</dd>
<dt>matern</dt>
<dd>
<p>The Matérn correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{2^{1-\nu}}{\Gamma(\nu)} \left( \frac{h}{\phi} \right)^{\nu} 
\mathcal{K}_{\nu}\left( \frac{h}{\phi} \right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter. 
<code class="reqn">\mathcal{K}_{\nu}(\cdot)</code> is the modified Bessel function of the second kind of order <code class="reqn">\nu</code>.
</p>
</dd>
<dt>exp</dt>
<dd>
<p>The exponential correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp(-h/\phi),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. This is the Matérn correlation with <code class="reqn">\nu=0.5</code>.
</p>
</dd>
<dt>matern_3_2</dt>
<dd>
<p>The Matérn correlation with <code class="reqn">\nu=1.5</code>.</p>
</dd>
<dt>matern_5_2</dt>
<dd>
<p>The Matérn correlation with <code class="reqn">\nu=2.5</code>.</p>
</dd>
<dt>powexp</dt>
<dd>
<p>The powered-exponential correlation function is given by
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left\{-\left(\frac{h}{\phi}\right)^{\nu}\right\},</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter. <code class="reqn">\nu</code> is the smoothness parameter.
</p>
</dd>
<dt>gauss</dt>
<dd>
<p>The Gaussian correlation function is given by 
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-\frac{h^2}{\phi^2}\right),</code>
</p>

<p>where <code class="reqn">\phi</code> is the range parameter.
</p>
</dd>
</dl>
</dd>
<dt><strong>form</strong></dt>
<dd>

<dl>
<dt>isotropic</dt>
<dd>
<p>This indicates the isotropic form of covariance functions. That is,
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0(\|\mathbf{h}\|; \boldsymbol \theta),</code>
</p>
<p> where <code class="reqn">\| \mathbf{h}\|</code> denotes the 
Euclidean distance or the great circle distance for data on sphere. <code class="reqn">C^0(\cdot)</code> denotes 
any isotropic covariance family specified in <strong>family</strong>.</p>
</dd>
<dt>tensor</dt>
<dd>
<p>This indicates the tensor product of correlation functions. That is, 
</p>
<p style="text-align: center;"><code class="reqn"> C(\mathbf{h}) = \prod_{i=1}^d C^0(|h_i|; \boldsymbol \theta_i),</code>
</p>

<p>where <code class="reqn">d</code> is the dimension of input space. <code class="reqn">h_i</code> is the distance along the <code class="reqn">i</code>th input dimension. This type of covariance structure has been often used in Gaussian process emulation for computer experiments.
</p>
</dd>
<dt>ARD</dt>
<dd>
<p>This indicates the automatic relevance determination form. That is, 
</p>
<p style="text-align: center;"><code class="reqn">C(\mathbf{h}) = C^0\left(\sqrt{\sum_{i=1}^d\frac{h_i^2}{\phi^2_i}}; \boldsymbol \theta \right),</code>
</p>

<p>where <code class="reqn">\phi_i</code> denotes the range parameter along the <code class="reqn">i</code>th input dimension.</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.fit</code></td>
<td>
<p>a string indicating the choice of priors on correlation parameters:
</p>

<dl>
<dt>Cauchy_prior</dt>
<dd>
<p>This indicates that a fully Bayesian approach with objective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with half-Cauchy priors (default). 
</p>
</dd>
<dt>Ref_prior</dt>
<dd>
<p>This indicates that a fully Bayesian approach with objective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with reference priors. This is only supported for isotropic
covariance functions. For details, see <code>gp.mcmc</code>.
</p>
</dd>
<dt>Beta_prior</dt>
<dd>
<p>This indicates that a fully Bayesian approach with subjective priors is used
for parameter estimation, where location-scale parameters are assigned with constant priors and 
correlation parameters are assigned with beta priors parameterized as <code class="reqn">Beta(a, b, lb, ub)</code>.
In the beta distribution, <strong>lb</strong> and <strong>ub</strong> are the support for correlation parameters, and
they should be determined based on domain knowledge. <strong>a</strong> and <strong>b</strong> are two shape parameters with default values at 1,
corresponding to the uniform prior over the support <code class="reqn">(lb, ub)</code>. 
</p>
</dd>
<dt>MPLE</dt>
<dd>
<p>This indicates that the <em>maximum profile likelihood estimation</em> 
(<strong>MPLE</strong>) is used.</p>
</dd>
<dt>MMLE</dt>
<dd>
<p>This indicates that the <em>maximum marginal likelihood estimation</em> 
(<strong>MMLE</strong>) is used.</p>
</dd>
<dt>MAP</dt>
<dd>
<p>This indicates that the marginal/integrated posterior is maximized.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list containing tuning parameters in prior distribution. This is used only if a subjective Bayes estimation method with informative priors is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proposal</code></td>
<td>
<p>a list containing tuning parameters in proposal distribution. This is used only if a Bayes estimation method is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsample</code></td>
<td>
<p>an integer indicating the number of MCMC samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>an integer indicating the burn-in period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>a list of arguments to setup the <code>optim</code> routine. Current implementation uses three arguments: 
</p>

<dl>
<dt>method</dt>
<dd>
<p>The optimization method: <code>Nelder-Mead</code> or <code>L-BFGS-B</code>.</p>
</dd>
<dt>lower</dt>
<dd>
<p>The lower bound for parameters.</p>
</dd>
<dt>upper</dt>
<dd>
<p>The upper bound for parameters.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>
<p>Default value is <code>NULL</code>. Otherwise, it should be a list
containing the following elements depending on the covariance class:
</p>

<dl>
<dt><strong>nugget</strong></dt>
<dd>
<p>a list of bounds for the nugget parameter.
It is a list containing lower bound <strong>lb</strong> and 
upper bound <strong>ub</strong> with default value 
<code>list(lb=0, ub=Inf)</code>.</p>
</dd>
<dt><strong>range</strong></dt>
<dd>
<p>a list of bounds for the range parameter. It has default value
<code>range=list(lb=0, ub=Inf)</code> for the Confluent Hypergeometric covariance, the Matérn covariance, exponential covariance, Gaussian 
covariance, powered-exponential covariance, and Cauchy covariance. The log of range parameterization
is used: <code class="reqn">\log(\phi)</code>.</p>
</dd>
<dt><strong>tail</strong></dt>
<dd>
<p>a list of bounds for the tail decay parameter. It has default value
<code>list(lb=0, ub=Inf)</code></p>
</dd>
</dl>
<p> for the Confluent Hypergeometric covariance and the Cauchy covariance.
</p>
<dl>
<dt><strong>nu</strong></dt>
<dd>
<p>a list of bounds for the smoothness parameter. It has default value 
<code>list(lb=0, ub=Inf)</code> for the Confluent Hypergeometric covariance and the Matérn covariance.
when the powered-exponential or Cauchy class 
is used, it has default value <strong>nu</strong>=<code>list(lb=0, ub=2)</code>. 
This can be achieved by specifying the <strong>lower</strong> bound in <code>opt</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtype</code></td>
<td>
<p>a string indicating the type of distance:
</p>

<dl>
<dt>Euclidean</dt>
<dd>
<p>Euclidean distance is used. This is the default choice.</p>
</dd>
<dt>GCD</dt>
<dd>
<p>Great circle distance is used for data on sphere.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value. If it is <code>TRUE</code>, the MCMC progress bar is shown.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the <code>S4</code> object gp and prediction results
</p>


<h3>Author(s)</h3>

<p>Pulong Ma <a href="mailto:mpulong@gmail.com">mpulong@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>GPBayes-package</code>, <code>gp</code>, <code>gp.mcmc</code>, <code>gp.optim</code>, <code>gp.predict</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
code = function(x){
y = (sin(pi*x/5) + 0.2*cos(4*pi*x/5))*(x&lt;=9.6) + (x/10-1)*(x&gt;9.6) 
return(y)
}
n=100
input = seq(0, 20, length=n)
XX = seq(0, 20, length=99)
Ztrue = code(input)
set.seed(1234)
output = Ztrue + rnorm(length(Ztrue), sd=0.1)

# fitting a GaSP model with the objective Bayes approach
fit = GaSP(formula=~1, output, input,  
          param=list(range=3, nugget=0.1, nu=2.5), 
          smooth.est=FALSE, input.new=XX,
          cov.model=list(family="matern", form="isotropic"),
          proposal=list(range=.35, nugget=.8, nu=0.8),
          dtype="Euclidean", model.fit="Cauchy_prior", nsample=50, 
          burnin=10, verbose=TRUE)

</code></pre>


</div>