<div class="container">

<table style="width: 100%;"><tr>
<td>estPI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Probabilistic Index
</h2>

<h3>Description</h3>

<p>This function calculates the probabilistic indices <code class="reqn">\hat{P}_t</code> , <code class="reqn">\hat{P}_{tt'}</code> and <code class="reqn">\hat{P}_{tt't''}</code> 
to compare the groups of observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  estPI(X, g, type="pair", goi=NULL, mc=1, order=TRUE, alg="Cnaive")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix or vector with observations. The rows refer to individuals, the columns to variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Vector of group numbers for observations in <code>X</code>. Its length has to be the number of observations in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of probabilistic index, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>goi</code></td>
<td>
<p>Groups Of Interest, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc</code></td>
<td>
<p>Multiple Cores, set the amount of cores to use for parallel calculation (only available for Linux).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Boolean, calculate probabilistic index only for a specified order of groups or for all possible orders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>Internal function, which algorithm should be used to calculate the probabilistic index.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrix <code>X</code> contains the data. Each column refers to a variable, each row to an observation. 
The group memberships of the observations are given in <code>g</code>. In the case of one dimensional data,  
<code>X</code> is a vector.
</p>
<p>There is also an option to calculate the probabilistic indices (PI) only for a subset of the groups. 
In that case those group labels can be specified with the <code>goi</code> option by giving the corresponding
group labels. 
</p>
<p>Different types of PI can be calculated: <code>"single"</code> calculates the probability <code class="reqn">\hat{P}_t</code> for each group,
<code>"pair"</code> produces the probabilistic indices <code class="reqn">\hat{P}_{tt'}</code> for all pairs of groups <code class="reqn">t&lt;t'</code>, and
<code>"triple"</code> provides the probabilities <code class="reqn">\hat{P}_{tt't''}</code> for all triples of groups <code class="reqn">t&lt;t'&lt;t''</code>.
See Fischer et al. (2013) for more details.
</p>
<p>Note that the PIs are calculated using the group numbering as given in <code>g</code>. See also the function
<code>createGroups</code> for renumbering the group labels. By specifying the option <code>order=FALSE</code>
the PIs for all possible group orders will be calculated. The default is that the PI is only calculated for the
natural order given by <code>g</code>.
</p>
<p>In case this code is executed on a Linux machine and <code>X</code> is a data matrix, the calculation can be parallelized
using the option <code>mc</code> to specify the amount of used calculation cores. 
</p>
<p>Different algorithms are available for the  calculation of the PIs. The default is the fastest
possible option and the user should not change this option. Different algorithms are only provided for validation and testing
purposes. Options here are currently <code>Cnaive</code>, <code>Rnaive</code>, <code>Rgrid</code>, <code>Rsub</code>, <code>Csub</code> but not all combinations
of <code>type</code>/<code>alg</code> are available.
</p>


<h3>Value</h3>

<p>A list with class 'estPI' containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Matrix or vector of the  PIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String, storing the type of PI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>goi</code></td>
<td>
<p>Vector, the Groups Of Interest, as given in the function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Boolean, PI just for the specified order or for all orders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Matrix, the original data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Vector, the original group vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>String, the requested algorithm.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daniel Fischer
</p>


<h3>References</h3>

<p>Fischer, D., Oja, H., Schleutker, Sen, P.K., J., Wahlfors, T. (2013): Generalized Mann-Whitney Type Tests for Microarray Experiments, Scandinavian Journal of Statistics, to appear.<br></p>
<p>Fischer, D., Oja, H. (2013): Mann-Whitney Type Tests for Microarray Experiments: The R Package gMWT, submitted article.
</p>


<h3>See Also</h3>

<p><code>createGroups</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
X &lt;- c(sample(15))
g &lt;- c(1,1,1,2,2,2,2,3,3,3,4,4,4,4,4)
estPI(X,g,type="single")

X &lt;- matrix(c(rnorm(5000,1.5,2),rnorm(6000,2,2),rnorm(4000,3.5,1)),byrow=TRUE, ncol=10)
colnames(X) &lt;- letters[1:10]
g &lt;- c(rep(1,500),rep(2,600),rep(3,400))

estPI(X,g,type="single",mc=1)

</code></pre>


</div>