<div class="container">

<table style="width: 100%;"><tr>
<td>ggseqiplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sequence Index Plot</h2>

<h3>Description</h3>

<p>Function for rendering sequence index plots with
<code>ggplot2</code> (Wickham 2016) instead
of base R's <code>plot</code> function that is used by
<code>TraMineR::seqplot</code>
(Gabadinho et al. 2011).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ggseqiplot(
  seqdata,
  no.n = FALSE,
  group = NULL,
  sortv = NULL,
  weighted = TRUE,
  border = FALSE,
  facet_scale = "free_y",
  facet_ncol = NULL,
  facet_nrow = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seqdata</code></td>
<td>
<p>State sequence object (class <code>stslist</code>) created with the <code>TraMineR::seqdef</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.n</code></td>
<td>
<p>specifies if number of (weighted) sequences is shown as part of
the y-axis title or group/facet title (default is <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A vector of the same length as the sequence data indicating group membership. When not NULL, a distinct plot is generated for each level of group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortv</code></td>
<td>
<p>Vector of numerical values sorting the sequences or a sorting
method (either <code>"from.start"</code> or <code>"from.end"</code>). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Controls if weights (specified in <code>TraMineR::seqdef</code>) should be used. Default is <code>TRUE</code>, i.e. if available weights are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>if <code>TRUE</code> bars are plotted with black outline; default is <code>FALSE</code> (also accepts <code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_scale</code></td>
<td>
<p>Specifies if y-scale in faceted plot should be free
(<code>"free_y"</code> is default) or <code>"fixed"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_ncol</code></td>
<td>
<p>Number of columns in faceted (i.e. grouped) plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_nrow</code></td>
<td>
<p>Number of rows in faceted (i.e. grouped) plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>if group is specified additional arguments of <code>ggplot2::facet_wrap</code>
such as <code>"labeller"</code> or <code>"strip.position"</code> can be used to change the appearance of the plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Sequence index plots have been introduced by
Scherer (2001) and display each sequence as
horizontally stacked bar or line. For a more detailed discussion of this
type of sequence visualization see, for example,
Brzinsky-Fay (2014),
Fasang and Liao (2014),
and Raab and Struffolino (2022).
</p>
<p>The function uses <code>TraMineR::seqformat</code>
to reshape <code>seqdata</code> stored in wide format into a spell/episode format.
Then the data are further reshaped into the long format, i.e. for
every sequence each row in the data represents one specific sequence
position. For example, if we have 5 sequences of length 10, the long file
will have 50 rows. In the case of sequences of unequal length not every
sequence will contribute the same number of rows to the long data.
</p>
<p>The reshaped data are used as input for rendering the index plot using
ggplot2's <code>geom_rect</code>. <code>ggseqiplot</code> uses
<code>geom_rect</code> instead of <code>geom_tile</code>
because this allows for a straight forward implementation of weights.
If weights are specified for <code>seqdata</code> and <code>weighted=TRUE</code>
the sequence height corresponds to its weight.
</p>
<p>If weights and a grouping variable are used, and <code>facet_scale="fixed"</code>
the values of the y-axis are not labeled, because
<code>ggplot2</code> reasonably does not allow for varying scales
when the facet scale is fixed.
</p>
<p>When a <code>sortv</code> is specified, the sequences are arranged in the order of
its values. With <code>sortv="from.start"</code> sequence data are sorted
according to the states of the alphabet in ascending order starting with the
first sequence position, drawing on succeeding positions in the case of
ties. Likewise, <code>sortv="from.end"</code> sorts a reversed version of the
sequence data, starting with the final sequence position turning to
preceding positions in case of ties.
</p>
<p>Note that the default aspect ratio of <code>ggseqiplot</code> is different from
<code>TraMineR::seqIplot</code>. This is most obvious
when <code>border=TRUE</code>. You can change the ratio either by adding code to
<code>ggseqiplot</code> or by specifying the ratio when saving the code with
<code>ggsave</code>.
</p>


<h3>Value</h3>

<p>A sequence index plot. If stored as object the resulting list object
also contains the data (spell format) used for rendering the plot.
</p>


<h3>Author(s)</h3>

<p>Marcel Raab
</p>


<h3>References</h3>

<p>Brzinsky-Fay C (2014).
“Graphical Representation of Transitions and Sequences.”
In Blanchard P, Bühlmann F, Gauthier J (eds.), <em>Advances in Sequence Analysis: Theory, Method, Applications</em>,  Life Course Research and Social Policies, 265–284.
Springer, Cham.
<a href="https://doi.org/10.1007/978-3-319-04969-4_14">doi:10.1007/978-3-319-04969-4_14</a>.<br><br> Fasang AE, Liao TF (2014).
“Visualizing Sequences in the Social Sciences: Relative Frequency Sequence Plots.”
<em>Sociological Methods &amp; Research</em>, <b>43</b>(4), 643–676.
<a href="https://doi.org/10.1177/0049124113506563">doi:10.1177/0049124113506563</a>.<br><br> Gabadinho A, Ritschard G, Müller NS, Studer M (2011).
“Analyzing and Visualizing State Sequences in R with TraMineR.”
<em>Journal of Statistical Software</em>, <b>40</b>(4), 1–37.
<a href="https://doi.org/10.18637/jss.v040.i04">doi:10.18637/jss.v040.i04</a>.<br><br> Raab M, Struffolino E (2022).
<em>Sequence Analysis</em>, volume 190 of <em>Quantitative Applications in the Social Sciences</em>.
SAGE, Thousand Oaks, CA.
<a href="https://sa-book.github.io/">https://sa-book.github.io/</a>.<br><br> Scherer S (2001).
“Early Career Patterns: A Comparison of Great Britain and West Germany.”
<em>European Sociological Review</em>, <b>17</b>(2), 119–144.
<a href="https://doi.org/10.1093/esr/17.2.119">doi:10.1093/esr/17.2.119</a>.<br><br> Wickham H (2016).
<em>ggplot2: Elegant Graphics for Data Analysis</em>,  Use R!, 2nd ed. edition.
Springer, Cham.
<a href="https://doi.org/10.1007/978-3-319-24277-4">doi:10.1007/978-3-319-24277-4</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Use example data from TraMineR: actcal data set
data(actcal)

# We use only a sample of 300 cases
set.seed(1)
actcal &lt;- actcal[sample(nrow(actcal), 300), ]
actcal.lab &lt;- c("&gt; 37 hours", "19-36 hours", "1-18 hours", "no work")
actcal.seq &lt;- seqdef(actcal, 13:24, labels = actcal.lab)

# ex1 using weights
data(ex1)
ex1.seq &lt;- seqdef(ex1, 1:13, weights = ex1$weights)

# sequences sorted by age in 2000 and grouped by sex
# with TraMineR::seqplot
seqIplot(actcal.seq, group = actcal$sex, sortv = actcal$age00)
# with ggseqplot
ggseqiplot(actcal.seq, group = actcal$sex, sortv = actcal$age00)

# sequences of unequal length with missing state, and weights
seqIplot(ex1.seq)
ggseqiplot(ex1.seq)

# ... turn weights off and add border
seqIplot(ex1.seq, weighted = FALSE, border = TRUE)
ggseqiplot(ex1.seq, weighted = FALSE, border = TRUE)

</code></pre>


</div>