<div class="container">

<table style="width: 100%;"><tr>
<td>nh.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
using the Freckleton and Harvey node-height test
</h2>

<h3>Description</h3>

<p>Fits a linear model between the absolute magnitude of the standardized independent contrasts and the height above the root of the node at which they were being compared to identify early bursts of trait evolution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nh.test(phy, d, regression.type, log = TRUE, rlm.maxit = 20 , show.plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>

<p>A time calibrated phylogeny in "phylo" format
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>A named vector of trait values. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regression.type</code></td>
<td>

<p>The type of regression to be used. Specify <code>regression.type="lm"</code> to fit a standard linear model or <code>regression.type="rlm"</code> to fit a robust regression model 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>

<p>Whether the data should be logged or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlm.maxit</code></td>
<td>

<p>The maximum number of iterations to fit the robust regression model. This is ignored if <code>regression.type="lm"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plot</code></td>
<td>

<p>Binary argument indicating whether plot should be made.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments passed to plot
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Function returns a <code>lm</code> or <code>rlm</code> object and outputs a plot if <code>show.plot=TRUE</code>
</p>


<h3>Author(s)</h3>

<p>Graham Slater
</p>


<h3>References</h3>

<p>Slater GJ and MW Pennell (in press) Robust regression and posterior predictive simulation increase power to detect early bursts of trait evolution. <em>Systematic Biology</em>.
</p>
<p>Freckleton RP and PH Harvey (2006) Detecting non-brownian evolution in adaptive radiations. <em>PLoS Biology</em> 4:e373.
</p>


<h3>See Also</h3>

<p><code>pp.mcmc</code>, <code>pic</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(whales)

tmp &lt;- treedata(whales$phy, whales$dat[,1])

phy &lt;- tmp$phy
dat &lt;- tmp$data[,1]

nh.test(phy, dat, regression.type="lm", show.plot=TRUE)

</code></pre>


</div>