<div class="container">

<table style="width: 100%;"><tr>
<td>gofArchmGamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The ArchmGamma Gof test using the Anderson-Darling test
statistic and the gamma distribution</h2>

<h3>Description</h3>

<p><code>gofArchmGamma</code> contains the Gamma gof test with a Rosenblatt 
transformation for archimedean copulae, described in Hering and Hofert (2015).
The test follows the RosenblattChisq test as described in Genest (2009) 
and Hofert (2014), and compares the empirical copula against a parametric 
estimate of the copula derived under the null hypothesis. The margins can be 
estimated by a bunch of distributions and the time which is necessary for 
the estimation can be given. The approximate p-values are computed with a 
parametric bootstrap, which computation can be accelerated by enabling 
in-build parallel computation. The gof statistics are computed with the 
function <code>gofTstat</code> from the package copula. 
It is possible to insert datasets of all dimensions above 1 
(except for the <code>"amh"</code> copula) and the possible copulae are 
<code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and 
<code>"amh"</code>. The parameter estimation is performed with pseudo maximum
likelihood method. In case the estimation fails, inversion of Kendall's tau
is used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofArchmGamma(
  copula = c("clayton", "gumbel", "frank", "joe", "amh"),
  x,
  param = 0.5,
  param.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"clayton"</code>, 
<code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and <code>"amh"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This Anderson-Darling test statistic (supposedly) computes
U[0,1]-distributed (under <code class="reqn">H_0</code>) random variates via the
distribution function of the gamma distribution, see Hofert et al. (2014).
As written in Hofert et al. (2014) computes this Anderson-Darling test
statistic for (supposedly) U[0,1]-distributed (under H_0) random variates
via the distribution function of the gamma distribution. The <code class="reqn">H_0</code>
hypothesis is </p>
<p style="text-align: center;"><code class="reqn">C \in \mathcal{C}_0</code>
</p>
<p> with
<code class="reqn">\mathcal{C}_0</code> as the true class of copulae under <code class="reqn">H_0</code>.
</p>
<p>This test is based on the Rosenblatt transformation for archimedean copula
which uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d 
\rightarrow (0,1)^d</code>. Following 
Hering and Hofert (2015) the mapping provides 
pseudo observations <code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 = \mathcal{R}(U_1), 
\dots, E_n = \mathcal{R}(U_n).</code>
</p>
 
<p>Let <code class="reqn">C</code> be an Archimedean copula with <code class="reqn">d</code> monotone generator 
<code class="reqn">\psi</code> and continuous Kendall distribution function <code class="reqn">K_{C}</code>. Then, 
</p>
<p style="text-align: center;"><code class="reqn">e_{j}=\left(\frac{\sum_{k=1}^{j} \psi^{-1}\left(u_{k}
\right)}{\sum_{k=1}^{j+1} \psi^{-1}\left(u_{k}\right)}\right)^{j}, 
j \in\{1, \ldots, d-1\}</code>
</p>
<p> and 
</p>
<p style="text-align: center;"><code class="reqn">e_{d}= \frac{n}{n+1} K_{C}(C(u))</code>
</p>
<p>.
</p>
<p>The Anderson-Darling test statistic of the variates
</p>
<p style="text-align: center;"><code class="reqn">G(x_j) = \Gamma_d \left( x_j \right)</code>
</p>

<p>is computed (via <code>ADGofTest::ad.test</code>), where <code class="reqn">x_j = \sum_{i=1}^d
(- \ln e_{ij})</code>,
<code class="reqn">\Gamma_d()</code> denotes the distribution function of
the gamma distribution with shape parameter d and shape parameter one (being
equal to an Erlang(d) distribution function).
</p>
<p>The test statistic is then given by </p>
<p style="text-align: center;"><code class="reqn">T = -n - \sum_{j=1}^n \frac{2j -
1}{n} [\ln(G(x_j)) + \ln(1 - G(x_{n+1-j}))].</code>
</p>

<p>The approximate p-value is computed by the formula,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br><br> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br><br>
Christian Hering, Marius Hofert (2015) Goodness-of-fit tests for 
Archimedean copulas in high dimensions. <em>In: Glau K., Scherer M., 
Zagst R. (eds) Innovations in Quantitative Risk Management, 
Springer Proceedings in Mathematics &amp; Statistics, Volume 99, 
Springer, Cham, 357-373</em>.
doi: <a href="https://doi.org/10.1007/978-3-319-09114-3_21">10.1007/978-3-319-09114-3_21</a> <br><br></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(IndexReturns2D)

gofArchmGamma("clayton", IndexReturns2D, M = 10)

</code></pre>


</div>