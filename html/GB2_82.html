<div class="container">

<table style="width: 100%;"><tr>
<td>Compound</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compound Distribution based on the Generalized Beta Distribution of the Second Kind
</h2>

<h3>Description</h3>

<p>Mixture distribution based on the compounding property of the GB2, in short "compound GB2". Decomposition of the GB2 distribution with respect to the left and right tail of the distribution. Calculation of the component densities and cumulative distribution functions. 
Calculation of the compound density function and the compound cumulative distribution function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fg.cgb2(x, shape1, scale, shape2, shape3, pl0, decomp="r")
dl.cgb2(x, shape1, scale, shape2, shape3, pl0, decomp="r") 
pl.cgb2(y, shape1, scale, shape2, shape3, pl0, decomp="r", tol=1e-05)
dcgb2(x, shape1, scale, shape2, shape3, pl0, pl, decomp="r")
pcgb2(y, shape1, scale, shape2, shape3, pl0, pl, decomp="r")
prcgb2(y1, y2, shape1, scale, shape2, shape3, pl0, pl, decomp="r", tol=1e-08, 
debug=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric; can be a vector. The value(s) at which the compound density and the component densities are calculated, <code>x</code> is positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric; can be a vector. The value(s) at which the compound distribution function and the component distribution functions are calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1, y2</code></td>
<td>
<p>numeric values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1, scale ,shape2, shape3</code></td>
<td>
<p>numeric; positive parameters of the GB2 distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl0</code></td>
<td>
<p>numeric; a vector of initial proportions defining the number of components and the weight of each component density in the decomposition. Sums to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p>numeric; a vector of fitted proportions. Sums to one. If <code>pl</code> is equal to <code>pl0</code>, we obtain the GB2 distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decomp</code></td>
<td>
<p>string; specifying if the decomposition of the GB2 is done with respect to the right tail ("r") or the left tail ("l") of the distribution.
By default, <code>decomp</code> = "r" - right tail decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>logical; By default, <code>debug = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric; tolerance with default 0, meaning to iterate until additional terms do not change the partial sum.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The number of components <code class="reqn">L</code> is given by the length of the vector <code>pl0</code>. In our examples <code class="reqn">L=3</code>. Let <code class="reqn">N</code> denote the length of the vector <code>x</code>. Function <code>fg.cgb2</code> calculates the <code class="reqn">L</code> gamma factors which multiply the GB2 density in order to obtain the component density <code class="reqn">f_\ell</code>. These component densities are calculated using the function <code>dl.cgb2</code>. Function <code>pl.cgb2</code> calculates the corresponding <code class="reqn">L</code> cumulative component distribution functions. Function <code>dcgb2</code> calculates the resulting compound density function. Function <code>pcgb2</code> calculates the compound cumulative distribution function for a vector of values <code>y</code> and function <code>prcgb2</code>, given  2 arguments <code>y1</code> and <code>y2</code>, calculates the probability <code class="reqn">P(min(y1,y2) &lt; Y &lt; max(y1,y2))</code>, where the random variable <code class="reqn">Y</code> follows a compound GB2 distribution.
</p>


<h3>Value</h3>

<p><code>fg.cgb2</code> returns a matrix of size <code class="reqn">N \times L</code> of the Gamma factors, <code>dl.cgb2</code> returns a matrix of size <code class="reqn">N \times L</code> of component densities, <code>pl.cgb2</code> returns a matrix containing the <code class="reqn">L</code> component cdfs, <code>dcgb2</code> returns a matrix of size <code class="reqn">N \times 1</code> of the GB2 compound density function, <code>pcgb2</code> returns a matrix of size <code class="reqn">N \times 1</code> of the GB2 compound distribution function and <code>prcgb2</code> returns a probability between 0 and 1.  
</p>


<h3>Author(s)</h3>

<p>Monique Graf and Desislava Nedyalkova
</p>


<h3>References</h3>

<p>Graf, M., Nedyalkova, D., Muennich, R., Seger, J. and Zins, S. (2011)
AMELI Deliverable 2.1: Parametric Estimation of Income Distributions and
Indicators of Poverty and Social Exclusion.
<em>Technical report</em>, AMELI-Project.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#\dontrun{

#\library{cubature}

# GB2 parameters
af &lt;- 5
bf &lt;- 20000
pf &lt;- 0.45 
qf &lt;- 0.75

p0 &lt;- rep(1/3,3)
p1 &lt;- c(0.37,0.43,0.2)

# a vector of values
x &lt;- rep(20000*seq(1,2,length.out=9))

#Gamma components
fg.cgb2(20000,af,bf,pf,qf,p0)
fg.cgb2(Inf,af,bf,pf,qf,p0,"l")

#Component densities
dl.cgb2(x,af,bf,pf,qf,p0)
dl.cgb2(20000,af,bf,pf,qf,p0,"l")

#Component cdf
pl.cgb2(25000,af,bf,pf,qf,p0)

#Compound cdf
pcgb2(x,af,bf,pf,qf,p0,p1)
prcgb2(37000,38000,af,bf,pf,qf,p0,p1,"l")
#}
</code></pre>


</div>