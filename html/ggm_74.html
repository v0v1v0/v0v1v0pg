<div class="container">

<table style="width: 100%;"><tr>
<td>rnormDag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random sample from a decomposable Gaussian model</h2>

<h3>Description</h3>

<p>Generates a sample from a mean centered  multivariate normal
distribution whose covariance matrix has a given triangular
decomposition.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rnormDag(n, A, Delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>an integer &gt; 0, the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a square, upper triangular matrix with ones along the
diagonal. It defines, together with <code>Delta</code>,
the concentration matrix (and also the covariance matrix)
of the multivariate normal. The order of <code>A</code> is the
number of components of the normal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>a numeric vector of length equal to the number of columns
of <code>A</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The value in position <code class="reqn">(i,j)</code> of  <code>A</code> (with <code class="reqn">i &lt; j</code>) is
a regression coefficient (with  sign changed) in the regression of
variable <code class="reqn">i</code> on variables <code class="reqn">i+1, \dots, d</code>.
</p>
<p>The value in position <code class="reqn">i</code> of <code>Delta</code> is the residual
variance in the above regression.
</p>


<h3>Value</h3>

<p>a matrix with <code>n</code> rows and <code>nrow(A)</code> columns,
a sample from a multivariate normal distribution with mean zero
and covariance matrix
<code>S = solve(A) %*% diag(Delta) %*% t(solve(A))</code>.
</p>


<h3>Author(s)</h3>

<p>Giovanni M. Marchetti</p>


<h3>References</h3>

<p>Cox, D. R. &amp; Wermuth, N. (1996). <em>Multivariate
dependencies</em>. London: Chapman &amp; Hall.</p>


<h3>See Also</h3>

<p><code>triDec</code>, <code>fitDag</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate a sample of 100 observation from a multivariate normal
## The matrix of the path coefficients
A &lt;- matrix(
c(1, -2, -3,  0, 0,  0,  0,
  0,  1,  0, -4, 0,  0,  0,
  0,  0,  1,  2, 0,  0,  0,
  0,  0,  0,  1, 1, -5,  0,
  0,  0,  0,  0, 1,  0,  3,
  0,  0,  0,  0, 0,  1, -4,
  0,  0,  0,  0, 0,  0,  1), 7, 7, byrow=TRUE)
D &lt;- rep(1, 7)
X &lt;- rnormDag(100, A, D)

## The true covariance matrix
solve(A) %*% diag(D) %*% t(solve(A))

## Triangular decomposition of the sample covariance matrix
triDec(cov(X))$A
</code></pre>


</div>