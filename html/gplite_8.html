<div class="container">

<table style="width: 100%;"><tr>
<td>cf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Initialize covariance function</h2>

<h3>Description</h3>

<p>Functions for initializing the covariance functions which can then be passed
to <code>gp_init</code>. See section Details for explanation of what covariance
function is what.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cf_const(magn = 1, prior_magn = prior_logunif())

cf_lin(vars = NULL, magn = 1, prior_magn = prior_logunif(), normalize = FALSE)

cf_sexp(
  vars = NULL,
  lscale = 0.3,
  magn = 1,
  prior_lscale = prior_logunif(),
  prior_magn = prior_logunif(),
  normalize = FALSE
)

cf_matern32(
  vars = NULL,
  lscale = 0.3,
  magn = 1,
  prior_lscale = prior_logunif(),
  prior_magn = prior_logunif(),
  normalize = FALSE
)

cf_matern52(
  vars = NULL,
  lscale = 0.3,
  magn = 1,
  prior_lscale = prior_logunif(),
  prior_magn = prior_logunif(),
  normalize = FALSE
)

cf_nn(
  vars = NULL,
  sigma0 = 1,
  sigma = 3,
  magn = 1,
  prior_sigma0 = prior_half_t(),
  prior_sigma = prior_half_t(),
  prior_magn = prior_logunif(),
  normalize = TRUE
)

cf_periodic(
  vars = NULL,
  period = 1,
  cf_base = cf_sexp(),
  prior_period = prior_logunif()
)

cf_prod(...)

## S3 method for class 'cf'
cf1 * cf2
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>magn</code></td>
<td>
<p>Initial value for the magnitude hyperparameter (depicts the magnitude of
the variation captured by the given covariance function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_magn</code></td>
<td>
<p>Prior for hypeparameter <code>magn</code>. See <code>priors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>Indices of the inputs which are taken into account when calculating this
covariance. If the input matrix has named columns, can also be a vector of column names.
Default is all the inputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Whether to automatically scale and center the inputs for the given
covariance function. Can be useful for inputs with mean and variance far from 0 and 1, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lscale</code></td>
<td>
<p>Initial value for the length-scale hyperparameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_lscale</code></td>
<td>
<p>Prior for hyperparameter <code>lscale</code>. See <code>priors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0</code></td>
<td>
<p>Prior std for the bias in the neural network covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Prior std for the weights in the hidden layers of the neural network
covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_sigma0</code></td>
<td>
<p>Prior for hyperparameter <code>sigma0</code>. See <code>priors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_sigma</code></td>
<td>
<p>Prior for hyperparameter <code>sigma</code>. See <code>priors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>Period length for the periodic covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cf_base</code></td>
<td>
<p>Base covariance function that is used to model the variability within each period
in periodic covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_period</code></td>
<td>
<p>Prior for hyperparameter <code>period</code>. See <code>priors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Meaning depends on context. For <code>cf_prod</code> pass in the covariance functions in the product.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cf1</code></td>
<td>
<p>Instance of a covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cf2</code></td>
<td>
<p>Instance of a covariance function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The supported covariance functions are (see Rasmussen and Williams, 2006):
</p>

<dl>
<dt><code>cf_const</code></dt>
<dd>
<p> Constant covariance function. Can be used to model the intercept. </p>
</dd>
<dt><code>cf_lin</code></dt>
<dd>
<p> Linear covariance function. Produces linear functions. </p>
</dd>
<dt><code>cf_sexp</code></dt>
<dd>
<p> Squared exponential (or exponentiated quadratic, or Gaussian) covariance function.</p>
</dd>
<dt><code>cf_matern32</code></dt>
<dd>
<p> Matern nu=3/2 covariance function. </p>
</dd>
<dt><code>cf_matern52</code></dt>
<dd>
<p> Matern nu=5/2 covariance function. </p>
</dd>
<dt><code>cf_nn</code></dt>
<dd>
<p> Neural network covariance function. </p>
</dd>
<dt><code>cf_periodic</code></dt>
<dd>
<p> Periodic covariance function. The periodicity is achieved by mapping the
original inputs through sine and cosine functions, and then applying the base kernel in this new space.</p>
</dd>
<dt><code>cf_prod</code></dt>
<dd>
<p> Product of two or more covariance functions. </p>
</dd>
</dl>
<h3>Value</h3>

<p>The covariance function object.
</p>


<h3>References</h3>

<p>Rasmussen, C. E. and Williams, C. K. I. (2006). Gaussian processes for machine learning. MIT Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate some toy data
set.seed(1242)
n &lt;- 50
x &lt;- matrix(rnorm(n * 3), nrow = n)
f &lt;- sin(x[, 1]) + 0.5 * x[, 2]^2 + x[, 3]
y &lt;- f + 0.5 * rnorm(n)
x &lt;- data.frame(x1 = x[, 1], x2 = x[, 2], x3 = x[, 3])

# Basic usage (single covariance function)
cf &lt;- cf_sexp()
lik &lt;- lik_gaussian()
gp &lt;- gp_init(cf, lik)
gp &lt;- gp_optim(gp, x, y)
plot(gp_pred(gp, x)$mean, y)

# More than one covariance function; one for x1 and x2, and another one for x3
cf1 &lt;- cf_sexp(c("x1", "x2"))
cf2 &lt;- cf_lin("x3")
cfs &lt;- list(cf1, cf2)
lik &lt;- lik_gaussian()
gp &lt;- gp_init(cfs, lik)
gp &lt;- gp_optim(gp, x, y, maxiter = 500)
plot(gp_pred(gp, x)$mean, y)
plot(x[, 3], gp_pred(gp, x, cfind = 2)$mean) # plot effect w.r.t x3 only


</code></pre>


</div>