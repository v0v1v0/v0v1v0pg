<div class="container">

<table style="width: 100%;"><tr>
<td>fixed2Zcor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct zcor vector</h2>

<h3>Description</h3>

<p>Construct zcor vector (of fixed correlations) from a fixed
working correlation matrix, a specification of clusters and a
specifcation of waves.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fixed2Zcor(cor.fixed, id, waves)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cor.fixed</code></td>
<td>
<p>Matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waves</code></td>
<td>
<p>Vector giving the ordering of observations within clusters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector which can be passed as the zcor argument to geeglm.
</p>


<h3>Author(s)</h3>

<p>Søren Højsgaard, <a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a>
</p>


<h3>See Also</h3>

<p><code>genZcor</code>, <code>geeglm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
timeorder &lt;- rep(1:5, 6)
tvar      &lt;- timeorder + rnorm(length(timeorder))
idvar &lt;- rep(1:6, each=5)
uuu   &lt;- rep(rnorm(6), each=5)
yvar  &lt;- 1 + 2*tvar + uuu + rnorm(length(tvar))
simdat &lt;- data.frame(idvar, timeorder, tvar, yvar)
head(simdat,12)

simdatPerm &lt;- simdat[sample(nrow(simdat)),]
simdatPerm &lt;- simdatPerm[order(simdatPerm$idvar),]
head(simdatPerm)

cor.fixed &lt;- matrix(c(1    , 0.5  , 0.25,  0.125, 0.125,
                      0.5  , 1    , 0.25,  0.125, 0.125,
                      0.25 , 0.25 , 1   ,  0.5  , 0.125,
                      0.125, 0.125, 0.5  , 1    , 0.125,
                      0.125, 0.125, 0.125, 0.125, 1     ), nrow=5, ncol=5)
cor.fixed

zcor &lt;- fixed2Zcor(cor.fixed, id=simdatPerm$idvar, waves=simdatPerm$timeorder)
zcor

mod4 &lt;- geeglm(yvar~tvar, id=idvar, data=simdatPerm, corstr="fixed", zcor=zcor)
mod4

</code></pre>


</div>