<div class="container">

<table style="width: 100%;"><tr>
<td>ploglik_xycholv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the log-likelihood of a model</h2>

<h3>Description</h3>

<p><code>ll_xycholv</code> computes the log-likelihood of
multivariate normal data using components typically found
in a <code>geolm</code>. For <code>ploglik_xycholv</code>, 
<code>cholv</code> is the cholesky decomposition of the 
covariance matrix for the observed data after dividing
the matrix by the (estimated) <code>psill</code>. See the
examples below.
Depending on parameter choices, the
function can return the log-likelihood, the restricted
log-likelihood, -2 times the log-likelihood or restricted
log-likelihood, or the estimated partial sill for both a
maximum likelihood and restricted maximum likelihood
setting. This is intended to be an internal function, so
minimal error checking is done.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ploglik_xycholv(
  x,
  y,
  cholv,
  mu = NULL,
  reml = FALSE,
  minus2 = TRUE,
  return_ll = TRUE
)

ll_xycholv(
  x,
  y,
  cholv,
  mu = NULL,
  reml = FALSE,
  minus2 = TRUE,
  return_ll = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The matrix of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The vector of observed responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cholv</code></td>
<td>
<p>The cholesky decomposition of the covariance
matrix of <code>y</code> (or of that matrix divided by <code>psill</code> for
<code>loglik_xycholv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A single numeric value indicating the assumed
mean of the underlying process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reml</code></td>
<td>
<p>A logical value. Should the Restricted
Maximum Likelihood be returned. The default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minus2</code></td>
<td>
<p>A logical value. Should -2 times the
log-likelihood be returned. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_ll</code></td>
<td>
<p>A logical value. Should the
log-liklihood be returned? Default is <code>TRUE</code>. If
<code>FALSE</code>, the estimated partial sill is returned.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A likelihood value, -2 times the likelihood
value, or the estimated partial sill, depending on the
user's argument choices.
</p>


<h3>References</h3>

<p>Statistical Methods for Spatial Data
Analysis. Oliver Schabenberger and Carol A. Gotway
(Chapman &amp; Hall/CRC Press) 2005. pp. 259-263
</p>


<h3>Examples</h3>

<pre><code class="language-R">y = rnorm(10)
x = matrix(rep(1, length(y)))
coords = matrix(runif(length(y) * 2), ncol = 2)
d = as.matrix(dist(coords))
pv = exp(-d/3) + 0.1 * diag(length(y))
est_psill = ploglik_xycholv(x, y, chol(pv), return_ll = FALSE)
v = pv * est_psill
# same result
ploglik_xycholv(x, y, chol(pv), minus2 = FALSE)
ll_xycholv(x, y, chol(v), minus2 = FALSE)
</code></pre>


</div>