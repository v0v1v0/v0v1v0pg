<div class="container">

<table style="width: 100%;"><tr>
<td>amult</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized array multiplication.</h2>

<h3>Description</h3>

<p>Default to Einstein summation convention, without explicitly subscripts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">amult(X, Y, FUN = "*", SUM = "sum", BY = NULL, MoreArgs = NULL,
  ..., SIMPLIFY = TRUE, VECTORIZED = TRUE)

X %X% Y
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X, Y</code></td>
<td>
<p>Generalized arrays that can be multiplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>The 'multiply' function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SUM</code></td>
<td>
<p>The 'reduce' function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BY</code></td>
<td>
<p>margins excluded from summary by SUM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MoreArgs, SIMPLIFY, VECTORIZED</code></td>
<td>
<p>Argument used by 'amap()'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Argument used by 'areduce()'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Margins shared by X and Y are parallelly mapped by FUN,
and then reduced by SUM (inner product like <code>%*%</code>);
margins in BY and shared by X and Y are simply mapped by FUN
but excluded from reducing (parallel product like <code>*</code>);
other margins are extended repeatly (outer product like <code>%o%</code>).
Shared margins not to be mapped have to be renamed (like outer product).
For special FUN and SUM, fast algorithms are implemented.
</p>


<h3>Examples</h3>

<pre><code class="language-R">a &lt;- garray(1:24, c(4,6), list(X=LETTERS[1:4], Y=letters[1:6]),
	sdim=list(XX=c(x1=3,x2=1), YY=c(y1=1,y2=2)))
b &lt;- garray(1:20, c(Z=5, X=4))
c &lt;- garray(1:120, c(X=4,Y=6,Z=5))
m1 &lt;- amult(a, b)
m2 &lt;- amult(a, b, `*`, sum)
m3 &lt;- amult(b, a)
all.equal(m1, m2)
all.equal(m1, m3)
all.equal(m1, t(m3))
n1 &lt;- amult(a, c, `*`, sum)
n2 &lt;- a%X%c
all.equal(n1, n2)
amult(garray(1:5,margins="I"), garray(1:8,margins="J"))
amult(garray(1:8,c(I=2,J=4)), garray(1:9,c(K=3,L=3)))
</code></pre>


</div>