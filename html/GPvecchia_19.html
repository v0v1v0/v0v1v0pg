<div class="container">

<table style="width: 100%;"><tr>
<td>vecchia_estimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>estimate mean and covariance parameters of a Matern covariance function using Vecchia</h2>

<h3>Description</h3>

<p>estimate mean and covariance parameters of a Matern covariance function using Vecchia
</p>


<h3>Usage</h3>

<pre><code class="language-R">vecchia_estimate(
  data,
  locs,
  X,
  m = 20,
  covmodel = "matern",
  theta.ini,
  output.level = 1,
  reltol = sqrt(.Machine$double.eps),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data vector of length n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locs</code></td>
<td>
<p>n x d matrix of spatial locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>n x p matrix of trend covariates. default is vector of ones (constant trend).
set to NULL if data are already detrended</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of neighbors for vecchia approximation. default is 20</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmodel</code></td>
<td>
<p>covariance model. default is Matern.
see <code>vecchia_likelihood</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.ini</code></td>
<td>
<p>initial values of covariance parameters. nugget variance must be last.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.level</code></td>
<td>
<p>passed on to trace in the <code>stats::optim</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>tolerance for the optimization function; by default set to the sqrt of machine
precision</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional input parameters for <code>vecchia_specify</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>object containing detrended data z, trend coefficients beta.hat,
covariance parameters theta.hat, and other quantities necessary for prediction
</p>


<h3>Examples</h3>

<pre><code class="language-R">
n=10^2; locs=cbind(runif(n),runif(n))
covparms=c(1,.1,.5); nuggets=rep(.1,n)
Sigma=exp(-fields::rdist(locs)/covparms[2])+diag(nuggets)
z=as.numeric(t(chol(Sigma))%*%rnorm(n));
data=z+1
vecchia.est=vecchia_estimate(data,locs,theta.ini=c(covparms,nuggets[1]))

</code></pre>


</div>