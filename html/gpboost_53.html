<div class="container">

<table style="width: 100%;"><tr>
<td>predict.GPModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make predictions for a <code>GPModel</code>
</h2>

<h3>Description</h3>

<p>Make predictions for a <code>GPModel</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'GPModel'
predict(object, y = NULL, group_data_pred = NULL,
  group_rand_coef_data_pred = NULL, gp_coords_pred = NULL,
  gp_rand_coef_data_pred = NULL, cluster_ids_pred = NULL,
  predict_cov_mat = FALSE, predict_var = FALSE, cov_pars = NULL,
  X_pred = NULL, use_saved_data = FALSE, predict_response = TRUE,
  offset = NULL, offset_pred = NULL, fixed_effects = NULL,
  fixed_effects_pred = NULL, vecchia_pred_type = NULL,
  num_neighbors_pred = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a <code>GPModel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observed data (can be NULL, e.g. when the model has been estimated 
already and the same data is used for making predictions)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_data_pred</code></td>
<td>
<p>A <code>vector</code> or <code>matrix</code> with elements being group levels 
for which predictions are made (if there are grouped random effects in the <code>GPModel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_rand_coef_data_pred</code></td>
<td>
<p>A <code>vector</code> or <code>matrix</code> with covariate data 
for grouped random coefficients (if there are some in the <code>GPModel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp_coords_pred</code></td>
<td>
<p>A <code>matrix</code> with prediction coordinates (=features) for 
Gaussian process (if there is a GP in the <code>GPModel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp_rand_coef_data_pred</code></td>
<td>
<p>A <code>vector</code> or <code>matrix</code> with covariate data for 
Gaussian process random coefficients (if there are some in the <code>GPModel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_ids_pred</code></td>
<td>
<p>A <code>vector</code> with elements indicating the realizations of 
random effects / Gaussian processes for which predictions are made 
(set to NULL if you have not specified this when creating the <code>GPModel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict_cov_mat</code></td>
<td>
<p>A <code>boolean</code>. If TRUE, the (posterior) 
predictive covariance is calculated in addition to the (posterior) predictive mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict_var</code></td>
<td>
<p>A <code>boolean</code>. If TRUE, the (posterior) 
predictive variances are calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_pars</code></td>
<td>
<p>A <code>vector</code> containing covariance parameters which are used if the 
<code>GPModel</code> has not been trained or if predictions should be made for other 
parameters than the trained ones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_pred</code></td>
<td>
<p>A <code>matrix</code> with prediction covariate data for the 
fixed effects linear regression term (if there is one in the <code>GPModel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_saved_data</code></td>
<td>
<p>A <code>boolean</code>. If TRUE, predictions are done using 
a priory set data via the function '$set_prediction_data' (this option is not used by users directly)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict_response</code></td>
<td>
<p>A <code>boolean</code>. If TRUE, the response variable (label) 
is predicted, otherwise the latent random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>A <code>numeric</code> <code>vector</code> with 
additional fixed effects contributions that are added to the linear predictor (= offset). 
The length of this vector needs to equal the number of training data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset_pred</code></td>
<td>
<p>A <code>numeric</code> <code>vector</code> with 
additional fixed effects contributions that are added to the linear predictor for the prediction points (= offset). 
The length of this vector needs to equal the number of prediction points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_effects</code></td>
<td>
<p>This is discontinued. Use the renamed equivalent argument <code>offset</code> instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_effects_pred</code></td>
<td>
<p>This is discontinued. Use the renamed equivalent argument <code>offset_pred</code> instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vecchia_pred_type</code></td>
<td>
<p>A <code>string</code> specifying the type of Vecchia approximation used for making predictions.
This is discontinued here. Use the function 'set_prediction_data' to specify this</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_neighbors_pred</code></td>
<td>
<p>an <code>integer</code> specifying the number of neighbors for making predictions.
This is discontinued here. Use the function 'set_prediction_data' to specify this</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(not used, ignore this, simply here that there is no CRAN warning)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Predictions from a <code>GPModel</code>. A list with three entries is returned:
</p>

<ul>
<li>
<p> "mu" (first entry): predictive (=posterior) mean. For (generalized) linear mixed
effects models, i.e., models with a linear regression term, this consists of the sum of 
fixed effects and random effects predictions 
</p>
</li>
<li>
<p> "cov" (second entry): predictive (=posterior) covariance matrix. 
This is NULL if 'predict_cov_mat=FALSE'  
</p>
</li>
<li>
<p> "var" (third entry) : predictive (=posterior) variances. 
This is NULL if 'predict_var=FALSE'  
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Fabio Sigrist
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See https://github.com/fabsig/GPBoost/tree/master/R-package for more examples


data(GPBoost_data, package = "gpboost")
# Add intercept column
X1 &lt;- cbind(rep(1,dim(X)[1]),X)
X_test1 &lt;- cbind(rep(1,dim(X_test)[1]),X_test)

#--------------------Grouped random effects model: single-level random effect----------------
gp_model &lt;- fitGPModel(group_data = group_data[,1], y = y, X = X1,
                       likelihood="gaussian", params = list(std_dev = TRUE))
summary(gp_model)
# Make predictions
pred &lt;- predict(gp_model, group_data_pred = group_data_test[,1], 
                X_pred = X_test1, predict_var = TRUE)
pred$mu # Predicted mean
pred$var # Predicted variances
# Also predict covariance matrix
pred &lt;- predict(gp_model, group_data_pred = group_data_test[,1], 
                X_pred = X_test1, predict_cov_mat = TRUE)
pred$mu # Predicted mean
pred$cov # Predicted covariance


#--------------------Gaussian process model----------------
gp_model &lt;- fitGPModel(gp_coords = coords, cov_function = "exponential",
                       likelihood="gaussian", y = y, X = X1, params = list(std_dev = TRUE))
summary(gp_model)
# Make predictions
pred &lt;- predict(gp_model, gp_coords_pred = coords_test, 
                X_pred = X_test1, predict_cov_mat = TRUE)
pred$mu # Predicted (posterior) mean of GP
pred$cov # Predicted (posterior) covariance matrix of GP


</code></pre>


</div>