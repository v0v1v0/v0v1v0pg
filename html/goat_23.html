<div class="container">

<table style="width: 100%;"><tr>
<td>partition_genes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Classify genes into 2 groups, e.g. to define significant or topN genes, resulting in a 'signif' column with boolean values</h2>

<h3>Description</h3>

<p>This can be convenient to prepare the significant/test/foreground set for classical ORA,
e.g. <code>test_genesets()</code> with parameter <code>method = "fisherexact"</code>. Note that the GOAT geneset
enrichment algorithm does not use data in the 'signif' column of the input genelist.
</p>


<h3>Usage</h3>

<pre><code class="language-R">partition_genes(
  genes,
  col,
  decreasing = FALSE,
  use_abs = FALSE,
  cutoff = NULL,
  fraction = NULL,
  topn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genes</code></td>
<td>
<p>gene tibble where each row is a unique gene, must contain column name <code>col</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>column name in <code>genes</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p>order <code>col</code> in descending (set TRUE) or ascending order (set FALSE, default) prior to partitioning?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_abs</code></td>
<td>
<p>use absolute values (default FALSE), e.g. when setting a threshold on effect-sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>threshold for values in <code>col</code> to select  (must provide exactly 1 parameter for filtering, either <code>cutoff</code>, <code>fraction</code> or <code>topn</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fraction</code></td>
<td>
<p>fraction of rows in <code>genes</code> tibble to select  (must provide exactly 1 parameter for filtering, either <code>cutoff</code>, <code>fraction</code> or <code>topn</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topn</code></td>
<td>
<p>number of rows in <code>genes</code> tibble to select  (must provide exactly 1 parameter for filtering, either <code>cutoff</code>, <code>fraction</code> or <code>topn</code>)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>input table <code>genes</code> with results in the "signif" column
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# note: this example will download 1 files of approx 4MB

# store the downloaded files in the following directory. Here, the temporary file
# directory is used. Alternatively, consider storing this data in a more permanent location.
# e.g. output_dir="~/data/goat" on unix systems or output_dir="C:/data/goat" on Windows
output_dir = tempdir()

# Download an example gene list, i.e. one of the datasets analyzed in the GOAT manuscript.
datasets = download_goat_manuscript_data(output_dir)
genelist = datasets$`Wingo 2020:mass-spec:PMID32424284`

# example 1: significant hits
genelist = partition_genes(genelist, col="pvalue_adjust", decreasing=FALSE, cutoff=0.01)
cat(sum(genelist$signif), "/", nrow(genelist), "are signif\n")

# example 2: abs(effectsize) &gt;= 5
genelist = partition_genes(genelist, col="effectsize", decreasing=TRUE, use_abs=TRUE, cutoff=5)
cat(sum(genelist$signif), "/", nrow(genelist), "are signif\n")

# example 3: top 10% 'best' p-values
genelist = partition_genes(genelist, col="pvalue", decreasing=FALSE, fraction = 0.1)
cat(sum(genelist$signif), "/", nrow(genelist), "are signif\n")

</code></pre>


</div>