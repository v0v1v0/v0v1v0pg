<div class="container">

<table style="width: 100%;"><tr>
<td>cooks.distance.glmgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cook's Distance for Generalized Estimating Equations</h2>

<h3>Description</h3>

<p>Produces an approximation, better known as the <em>one-step aproximation</em>,
of the Cook's distance, which is aimed to measure the effect on the estimates of the parameters in the linear predictor
of deleting each cluster/observation in turn. This function also can produce a cluster/observation-index plot of the
Cook's distance for all parameters in the linear predictor or for some subset of them (via the argument <code>coefs</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'glmgee'
cooks.distance(
  model,
  method = c("Preisser-Qaqish", "full"),
  level = c("clusters", "observations"),
  plot.it = FALSE,
  coefs,
  identify,
  varest = c("robust", "df-adjusted", "model", "bias-corrected"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of class <em>glmgee</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>an (optional) character string indicating the method of calculation for the <em>one-step approximation</em>. The options are: the <em>one-step approximation</em> described by Preisser and Qaqish (1996) in which the working-correlation matrix is assumed to be known ("Preisser-Qaqish"); and the "authentic" <em>one-step approximation</em> ("full"). As default, <code>method</code> is set to "Preisser-Qaqish".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an (optional) character string indicating the level for which the Cook's distance is required. The options are: cluster-level ("clusters") and observation-level ("observations"). As default, <code>level</code> is set to "clusters".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot of Cook's distance is required or just the data matrix in which that plot is based. As default, <code>plot.it</code> is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some of the parameters in the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identify</code></td>
<td>
<p>an (optional) integer indicating the number of clusters to identify on the plot of Cook's distance. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest</code></td>
<td>
<p>an (optional) character string indicating the type of estimator which should be used to the variance-covariance matrix of the interest parameters. The available options are: robust sandwich-type estimator ("robust"), degrees-of-freedom-adjusted estimator ("df-adjusted"), bias-corrected estimator ("bias-corrected"), and the model-based or naive estimator ("model"). As default, <code>varest</code> is set to "robust".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example,  <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Cook's distance consists of the <em>distance</em> between two estimates of the
parameters in the linear predictor using a metric based on the (estimate of the) variance-covariance matrix. For the cluster-level,
the first one set of estimates is computed from a dataset including all clusters/observations, and the second one is computed from a dataset in which the <em>i</em>-th cluster is excluded. To avoid computational burden, the second set of estimates is replaced by its <em>one-step approximation</em>. See the dfbeta.glmgee documentation.
</p>


<h3>Value</h3>

<p>A matrix as many rows as clusters/observations in the sample and one column with the values of the Cook's distance.
</p>


<h3>References</h3>

<p>Pregibon D. (1981). Logistic regression diagnostics. <em>The Annals of Statistics</em> 9, 705-724.
</p>
<p>Preisser J.S., Qaqish B.F. (1996) Deletion diagnostics for generalised estimating equations.
<em>Biometrika</em> 83:551â€“562.
</p>
<p>Hammill B.G., Preisser J.S. (2006) A SAS/IML software program for GEE and regression diagnostics.
<em>Computational Statistics &amp; Data Analysis</em> 51:1197-1212.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces, corstr="AR-M-dependent")

### Cook's distance for all parameters in the linear predictor
cooks.distance(fit1, method="full", plot.it=TRUE, col="red", lty=1, lwd=1, cex=0.8,
               col.lab="blue", col.axis="blue", col.main="black", family="mono")

### Cook's distance for the parameter associated to the variable 'treat'
cooks.distance(fit1, coef="treat", method="full", plot.it=TRUE, col="red", lty=1,
               lwd=1, col.lab="blue", col.axis="blue", col.main="black", cex=0.8)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent", data=depression)

### Cook's distance for all parameters in the linear predictor
cooks.distance(fit2, method="full", plot.it=TRUE, col="red", lty=1, lwd=1, cex=0.8,
               col.lab="blue", col.axis="blue", col.main="black", family="mono")

### Cook's distance for the parameter associated to the variable 'group'
cooks.distance(fit2, coef="group", method="full", plot.it=TRUE, col="red", lty=1,
               lwd=1, col.lab="blue", col.axis="blue", col.main="black", cex=0.8)

</code></pre>


</div>