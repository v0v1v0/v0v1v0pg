<div class="container">

<table style="width: 100%;"><tr>
<td>Fst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fst</h2>

<h3>Description</h3>

<p>This function calculates the fixation index (Fst) between two populations from a VCF file using the method of Weir and Cockerham (1984).
The formula used for this is equivalent to the one used in vcftools â€“weir-fst-pop (https://vcftools.sourceforge.net/man_latest.html).
For batch processing, it uses <code>process_vcf_in_batches</code>. For windowed analysis, it uses a similar
approach tailored to process specific genomic windows (<code>process_vcf_in_windows</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Fst(
  vcf_path,
  pop1_individuals,
  pop2_individuals,
  weighted = FALSE,
  batch_size = 10000,
  threads = 1,
  write_log = FALSE,
  logfile = "log.txt",
  window_size = NULL,
  skip_size = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vcf_path</code></td>
<td>
<p>Path to the VCF file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop1_individuals</code></td>
<td>
<p>Vector of individual names belonging to the first population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop2_individuals</code></td>
<td>
<p>Vector of individual names belonging to the second population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Logical, whether weighted Fst or mean Fst is returned (Default = FALSE (mean Fst is returned)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>The number of variants to be processed in each batch
(used in batch mode only, default of 10,000 should be suitable for most use cases).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>Number of threads to use for parallel processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write_log</code></td>
<td>
<p>Logical, indicating whether to write progress logs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logfile</code></td>
<td>
<p>Path to the log file where progress will be logged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_size</code></td>
<td>
<p>Size of the window for windowed analysis in base pairs (optional).
When specified, <code>skip_size</code> must also be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_size</code></td>
<td>
<p>Number of base pairs to skip between windows (optional).
Used in conjunction with <code>window_size</code> for windowed analysis.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>In batch mode (no window_size or skip_size provided): Fst value (either mean or weighted).
In window mode (window_size and skip_size provided): A data frame with columns 'Chromosome', 'Start', 'End', and 'Fst', representing the fixation index within each window.
</p>


<h3>Examples</h3>

<pre><code class="language-R">vcf_file &lt;- system.file("tests/testthat/sim.vcf.gz", package = "GenoPop")
index_file &lt;- system.file("tests/testthat/sim.vcf.gz.tbi", package = "GenoPop")
pop1_individuals &lt;- c("tsk_0", "tsk_1", "tsk_2")
pop2_individuals &lt;- c("tsk_3", "tsk_4", "tsk_5")
# Batch mode example
fst_value &lt;- Fst(vcf_file, pop1_individuals, pop2_individuals, weighted = TRUE)
# Window mode example
fst_windows &lt;- Fst(vcf_file, pop1_individuals, pop2_individuals, weighted = TRUE,
                   window_size = 100000, skip_size = 50000)

</code></pre>


</div>