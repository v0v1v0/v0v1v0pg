<div class="container">

<table style="width: 100%;"><tr>
<td>Filter gene sets</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Filtering of gene sets
</h2>

<h3>Description</h3>

<p>Filters gene sets according to different criteria.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filterGeneSets(
	geneSets,
	includedGenes = NULL,
	minIntersectSize = length(includedGenes),
	adjMatrix = NULL,
	steps = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geneSets</code></td>
<td>

<p>A list of gene sets, where each gene set is a vector of gene names corresponding to the row names of <code>dat</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>includedGenes</code></td>
<td>

<p>A vector of gene names whose occurence in each of the gene sets is checked. The further parameters how these genes are used to filter gene sets
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minIntersectSize</code></td>
<td>

<p>If this parameter is not <code>NULL</code>, only gene sets with an intersection of at least <code>minIntersectSize</code> genes with respect to <code>includedGenes</code> (or <code>includedGenes</code> expanded by its interactions if <code>adjMatrix</code> and <code>steps</code> are supplied) are included in the result set. By default, this is the size of <code>includedGenes</code>, requiring <code>includedGenes</code> to be a subset of each gene set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjMatrix</code></td>
<td>

<p>An optional adjacency matrix in which an entry is <code>1</code> if there is a direct interaction between the corresponding genes and <code>0</code> otherwise. If this is non-null, the set of genes in <code>includedGenes</code> is expanded by adding all genes whose distance in the adjacency graph is at most <code>steps</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>

<p>The maximum distance of interacting genes to the genes in <code>includedGenes</code> according to <code>adjMatrix</code> to be added to the expanded gene list. E.g., <code>steps = 1</code> means that all genes which are direct interaction partners of the initial genes in <code>includedGenes</code> are added to <code>includedGenes</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a filtered list of gene sets with the same structure as <code>geneSets</code>.
</p>


<h3>See Also</h3>

<p><code>geneSetAnalysis</code>, <code>preprocessGs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">geneSets &lt;- list(
		gs1 = paste("gene",1:20,sep=""),
		gs2 = paste("gene",50:60,sep=""),
		gs3 = paste("gene",90:92,sep=""),
		gs4 = paste("gene",55:65,sep="")
	)

newGeneSets1 &lt;- filterGeneSets(
	geneSets = geneSets,
	includedGenes = c("gene55","gene60"))

newGeneSets2 &lt;- filterGeneSets(
	geneSets = geneSets,
	includedGenes = c("gene1","gene55","gene20","gene100"),
	minIntersectSize = 2)

examplePathway &lt;- c("gene1","gene2","gene3","gene4")
pathwayAdjMatrix &lt;- matrix(0,100,100)
rownames(pathwayAdjMatrix) &lt;- paste("gene",1:100,sep="")
colnames(pathwayAdjMatrix) &lt;- paste("gene",1:100,sep="")

# gene1 interacts with gene2 and gene3
# -&gt; step 1 if gene1 is starting point
pathwayAdjMatrix[1,2:3] &lt;- 1
pathwayAdjMatrix[2:3,1] &lt;- 1

# gene3 interacts with gene4
# -&gt; step 2 if gene1 is starting point
pathwayAdjMatrix[3,4] &lt;- 1
pathwayAdjMatrix[4,3] &lt;- 1

newGeneSets3 &lt;- filterGeneSets(
	geneSets = geneSets,
	includedGenes = "gene1",
	adjMatrix = pathwayAdjMatrix,
	steps = 2)
</code></pre>


</div>