<div class="container">

<table style="width: 100%;"><tr>
<td>gesso.coefnum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Get model coefficients with specified number of non-zero interactions 
</h2>

<h3>Description</h3>

<p>A function to obtain coefficients with <code>target_b_gxe_non_zero</code> specified to control the desired sparsity of interactions in the model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gesso.coefnum(cv_model, target_b_gxe_non_zero, less_than = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cv_model</code></td>
<td>
<p>cross-validated model fit object obtained by using function <code>gesso.cv</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_b_gxe_non_zero</code></td>
<td>
<p>number of non-zero interactions we want to inlcude in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>less_than</code></td>
<td>
<p><code>TRUE</code> if we want to control a number of <em>at most</em> non-zero interactions, <code>FALSE</code> if we want to control a number of <em>at least</em> non-zero interactions</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of model coefficients corresponding to the best model that contains at most or at least <code>target_b_gxe_non_zero</code> non-zero interaction terms. 
</p>
<p>The target model is selected based on the averaged cross-validation (cv) results: for each pair of  parameters <code>lambda</code>=(lambda_1, lambda_2) in the grid and each cv fold we obtain a number of non-zero estimated interaction terms, then average cv results by <code>lambda</code> and choose the tuning parameters corresponding to the minimum average cv loss that have <em>at most</em> or <em>at least</em> <code>target_b_gxe_non_zero</code> non-zero interaction terms. Returned coefficients are obtained by fitting the model on the full data with the selected tuning parameters. 
</p>
<p>Note that the number of estimated non-zero interactions will only approximately reflect the numbers obtained on cv datasets.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta_0 </code></td>
<td>
<p>estimated intercept value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_e</code></td>
<td>
<p>estimated environmental coefficient value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_g</code></td>
<td>
<p>a vector of estimated main effect coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_gxe</code></td>
<td>
<p>a vector of estimated interaction coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_c</code></td>
<td>
<p>a vector of estimated confounders coefficients</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data = data.gen()
model = gesso.cv(data$G_train, data$E_train, data$Y_train)
model_coefficients = gesso.coefnum(model, 5)
gxe_coefficients = model_coefficients$beta_gxe; sum(gxe_coefficients!=0)              
</code></pre>


</div>