<div class="container">

<table style="width: 100%;"><tr>
<td>design_gsnb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Group sequential design with negative binomial outcomes</h2>

<h3>Description</h3>

<p>Design a group sequential trial with negative binomial outcomes
</p>


<h3>Usage</h3>

<pre><code class="language-R">design_gsnb(
  rate1,
  rate2,
  dispersion,
  ratio_H0 = 1,
  random_ratio = 1,
  power,
  sig_level,
  timing,
  esf = obrien,
  esf_futility = NULL,
  futility = NULL,
  t_recruit1 = NULL,
  t_recruit2 = NULL,
  study_period = NULL,
  accrual_period = NULL,
  followup_max = NULL,
  accrual_speed = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rate1</code></td>
<td>
<p>numeric; assumed rate of treatment group 1 in the alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate2</code></td>
<td>
<p>numeric; assumed rate of treatment group 2 in the alternative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>
<p>numeric; dispersion (shape) parameter of negative binomial distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_H0</code></td>
<td>
<p>numeric; positive number denoting the rate ratio <code class="reqn">\mu_1/\mu_2</code>
under the null hypothesis, i.e. the non-inferiority or superiority margin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_ratio</code></td>
<td>
<p>numeric; randomization ratio n1/n2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>numeric; target power of group sequential design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_level</code></td>
<td>
<p>numeric; Type I error / significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timing</code></td>
<td>
<p>numeric vector; 0 &lt; <code>timing[1]</code> &lt; ... &lt; <code>timing[K]</code> = 1
with <code>K</code> the number of analyses, i.e. (K-1) interim analyses and final analysis.
When the timing of efficacy and futility analyses differ, timing should not be defined.
Instead, the arguments <code>timing_eff</code> and <code>timing_fut</code> have to be used to specify
the timing of the efficacy and futility analyses, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>esf</code></td>
<td>
<p>function; error spending function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>esf_futility</code></td>
<td>
<p>function; futility error spending function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>futility</code></td>
<td>
<p>character; either <code>"binding"</code>, <code>"nonbinding"</code>, or 
<code>NULL</code> for binding, nonbinding, or no futility boundaries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_recruit1</code></td>
<td>
<p>numeric vector; recruit (i.e. study entry) times in group 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_recruit2</code></td>
<td>
<p>numeric vector; recruit (i.e. study entry) times in group 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>study_period</code></td>
<td>
<p>numeric; study duration;
to be set when follow-up times are not identical between subjects, NULL otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrual_period</code></td>
<td>
<p>numeric; accrual period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followup_max</code></td>
<td>
<p>numeric; maximum exposure time of a subject; 
to be set when follow-up times are to be equal for each subject, NULL otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrual_speed</code></td>
<td>
<p>numeric; determines accrual speed; values larger than 1
result in accrual slower than linear; values between 0 and 1 result in accrual 
faster than linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments. Will be passed to the error spending function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Denote  <code class="reqn">\mu_1</code> and <code class="reqn">\mu_2</code> the event rates in treatment groups 1 and 2.
This function considers smaller event rates to be better. 
The statistical hypothesis testing problem of interest is 
</p>
<p style="text-align: center;"><code class="reqn">H_0: \frac{\mu_1}{\mu_2} \ge \delta  vs.  H_1: \frac{\mu_1}{\mu_2} &lt; \delta,</code>
</p>

<p>with <code class="reqn">\delta=</code><code>ratio_H0</code>.
Non-inferiority of treatment group 1 compared to treatment group 2 is tested for <code class="reqn">\delta\in (1,\infty)</code>.
Superiority of treatment group 1 over treatment group 2 is tested for <code class="reqn">\delta \in (0,1]</code>.
The calculation of the efficacy and (non-)binding futility boundaries are performed
under the hypothesis <code class="reqn">H_0: \frac{\mu_1}{\mu_2}= \delta</code> and 
under the alternative <code class="reqn">H_1: \frac{\mu_1}{\mu_2} = </code><code>rate1</code> / <code>rate2</code>.
</p>
<p>The argument 'accrual_speed' is used to adjust the accrual speed.
Number of subjects in the study at study time t is given by
<code class="reqn">f(t)=a * t^b</code> with  <code class="reqn">a = n / accrual_period</code> and <code class="reqn">b=accrual_speed</code>  
For linear recruitment, <code class="reqn">b=1</code>. 
<code class="reqn">b &gt; 1</code> results is slower than linear recruitment for <code class="reqn">t &lt; accrual_period</code> and 
faster than linear recruitment for <code class="reqn">t &gt; accrual_period</code>. Vice verse for <code class="reqn">b &lt; 1</code>.
</p>


<h3>Value</h3>

<p>A list with class "gsnb" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rate1</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate2</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timing</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_H0</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio_H1</code></td>
<td>
<p>ratio <code>rate1</code>/<code>rate2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_level</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_ratio</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power_fix</code></td>
<td>
<p>power of fixed design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected_info</code></td>
<td>
<p>list; expected information under <code>ratio_H0</code> and <code>ratio_H1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efficacy</code></td>
<td>
<p>list; contains the elements <code>esf</code> (type I error spending function), 
<code>spend</code> (type I error spend at each look), and 
<code>critical</code> (critical value for efficacy testing)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>futility</code></td>
<td>
<p>list; only part of the output if argument <code>futility</code> is
defined in the input. Contains the elements <code>futility</code> 
(input argument <code>futility</code>), <code>esf</code> 
(type II error spending function), <code>spend</code> (type II 
error spend at each look), and <code>critical</code> (critical 
value for futility testing)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_prob</code></td>
<td>
<p>list; contains the element <code>efficacy</code> with the probabilities
for stopping for efficacy and, if futility bounds are calculated, 
the element <code>futility</code> with the probabilities for stopping 
for futility</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_recruit1</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_recruit2</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>study_period</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followup_max</code></td>
<td>
<p>as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_info</code></td>
<td>
<p>maximum information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calendar</code></td>
<td>
<p>calendar times of data looks; only calculated when exposure times are not identical</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>MÃ¼tze, T., Glimm, E., Schmidli, H., &amp; Friede, T. (2018). 
Group sequential designs for negative binomial outcomes. 
Statistical Methods in Medical Research,  &lt;doi:10.1177/0962280218773115&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate the sample sizes for a given accrual period and study period (without futility)
out &lt;- design_gsnb(rate1 = 0.0875, rate2 = 0.125, dispersion = 5, 
                   power = 0.8, timing = c(0.5, 1), esf = obrien,
                   ratio_H0 = 1, sig_level = 0.025,
                   study_period = 3.5, accrual_period = 1.25, random_ratio = 1)
out

# Calculate the sample sizes for a given accrual period and study period with binding futility
out &lt;- design_gsnb(rate1 = 0.0875, rate2 = 0.125, dispersion = 5, 
                   power = 0.8, timing = c(0.5, 1), esf = obrien,
                   ratio_H0 = 1, sig_level = 0.025, study_period = 3.5, 
                   accrual_period = 1.25, random_ratio = 1, futility = "binding", 
                   esf_futility = obrien)
out


# Calculate study period for given recruitment times
expose &lt;- seq(0, 1.25, length.out = 1042)
out &lt;- design_gsnb(rate1 = 0.0875, rate2 = 0.125, dispersion = 5, 
                   power = 0.8, timing = c(0.5, 1), esf = obrien,
                   ratio_H0 = 1, sig_level = 0.025, t_recruit1 = expose, 
                   t_recruit2 = expose, random_ratio = 1)
out

# Calculate sample size for a fixed exposure time
out &lt;- design_gsnb(rate1 = 0.0875, rate2 = 0.125, dispersion = 5, 
                   power = 0.8, timing = c(0.5, 1), esf = obrien,
                   ratio_H0 = 1, sig_level = 0.025,
                   followup_max = 0.5, random_ratio = 1)
                   
# Different timing for efficacy and futility analyses
 design_gsnb(rate1 = 1, rate2 = 2, dispersion = 5,
             power = 0.8, esf = obrien,
             ratio_H0 = 1, sig_level = 0.025, study_period = 3.5,
             accrual_period = 1.25, random_ratio = 1, futility = "binding",
             esf_futility = pocock, 
             timing_eff = c(0.8, 1),
             timing_fut = c(0.2, 0.5, 1))                    
</code></pre>


</div>