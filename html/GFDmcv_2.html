<div class="container">

<table style="width: 100%;"><tr>
<td>e_mcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimators and confidence intervals of four multivariate coefficients of variation and their reciprocals</h2>

<h3>Description</h3>

<p>Calculates the estimators with respective <code class="reqn">(1-\alpha)</code>-confidence intervals for the four different variants of the multivariate coefficients (MCV) and their reciprocals
by Reyment (1960), Van Valen (1974), Voinov and Nikulin (1996) and Albert and Zhang (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">e_mcv(x, conf_level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of data of size <code class="reqn">n\times d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>a confidence level. By default, it is equal to 0.95.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>e_mcv()</code> calculates four different variants of multivariate coefficient of variation for <code class="reqn">d</code>-dimensional data. These variant were introduced by
by Reyment (1960, RR), Van Valen (1974, VV), Voinov and Nikulin (1996, VN) and Albert and Zhang (2010, AZ):
</p>
<p style="text-align: center;"><code class="reqn">
    {\widehat C}^{RR}=\sqrt{\frac{(\det\mathbf{\widehat\Sigma})^{1/d}}{\boldsymbol{\widehat\mu}^{\top}\boldsymbol{\widehat\mu}}},\ 
    {\widehat C}^{VV}=\sqrt{\frac{\mathrm{tr}\mathbf{\widehat\Sigma}}{\boldsymbol{\widehat\mu}^{\top}\boldsymbol{\widehat\mu}}},\ 
    {\widehat C}^{VN}=\sqrt{\frac{1}{\boldsymbol{\widehat\mu}^{\top}\mathbf{\widehat\Sigma}^{-1}\boldsymbol{\widehat\mu}}},\ 
    {\widehat C}^{AZ}=\sqrt{\frac{\boldsymbol{\widehat\mu}^{\top}\mathbf{\widehat\Sigma}\boldsymbol{\widehat\mu}}{(\boldsymbol{\widehat\mu}^{\top}\boldsymbol{\widehat\mu})^2}},
     </code>
</p>

<p>where <code class="reqn">n</code> is the sample size, <code class="reqn">\boldsymbol{\widehat\mu}</code> is the empirical mean vector and <code class="reqn">\mathbf{\widehat \Sigma}</code> is the empirical covariance matrix:
</p>
<p style="text-align: center;"><code class="reqn">
     \boldsymbol{\widehat\mu}_i = \frac{1}{n}\sum_{j=1}^{n} \mathbf{X}_{j},\; \mathbf{\widehat \Sigma} =\frac{1}{n}\sum_{j=1}^{n} (\mathbf{X}_{j} - \boldsymbol{\widehat \mu})(\mathbf{X}_{j} - \boldsymbol{\widehat \mu})^{\top}.
   </code>
</p>

<p>In the univariate case (<code class="reqn">d=1</code>), all four variants reduce to coefficient of variation. Furthermore, their reciprocals, the so-called standardized means, are determined:     
</p>
<p style="text-align: center;"><code class="reqn">
     {\widehat B}^{RR}=\sqrt{\frac{\boldsymbol{\widehat\mu}^{\top}\boldsymbol{\widehat\mu}}{(\det\mathbf{\widehat\Sigma})^{1/d}}},\ 
     {\widehat B}^{VV}=\sqrt{\frac{\boldsymbol{\widehat\mu}^{\top}\boldsymbol{\widehat\mu}}{\mathrm{tr}\mathbf{\widehat\Sigma}}},\ 
     {\widehat B}^{VN}=\sqrt{\boldsymbol{\widehat\mu}^{\top}\mathbf{\widehat\Sigma}^{-1}\boldsymbol{\widehat\mu}},\ 
     {\widehat B}^{AZ}=\sqrt{\frac{(\boldsymbol{\widehat\mu}^{\top}\boldsymbol{\widehat\mu})^2}{\boldsymbol{\widehat\mu}^{\top}\mathbf{\widehat\Sigma}\boldsymbol{\widehat\mu}}}.
   </code>
</p>

<p>In addition to the estimators, the respective confidence intervals [<code>C_lwr</code>, <code>C_upr</code>] for a given confidence level <code class="reqn">1-\alpha</code> are calculated by the <code>e_mcv()</code> function. 
These confidence intervals are based on an asymptotic approximation by a normal distribution, see Ditzhaus and Smaga (2023) for the technical details. These approximations
do not rely on any specific (semi-)parametric assumption on the distribution and are valid nonparametrically, even for tied data.
</p>


<h3>Value</h3>

<p>When <code class="reqn">d&gt;1</code> (respectively <code class="reqn">d=1</code>) a data frame with four rows (one row) corresponding to the four  MCVs (the univariate CV)
and six columns containing the estimators <code>C_est</code> for the MCV (CV) and the estimators <code>B_est</code> for their reciprocals  as well as the upper and lower bounds of the corresponding
confidence intervals  [<code>C_lwr</code>, <code>C_upr</code>] and [<code>B_lwr</code>, <code>B_upr</code>].
</p>


<h3>References</h3>

<p>Albert A., Zhang L. (2010) A novel definition of the multivariate coefficient of variation. Biometrical Journal 52:667-675.
</p>
<p>Ditzhaus M., Smaga L. (2023) Inference for all variants of the multivariate coefficient of variation in factorial designs. Preprint https://arxiv.org/abs/2301.12009.
</p>
<p>Reyment R.A. (1960) Studies on Nigerian Upper Cretaceous and Lower Tertiary Ostracoda: part 1. Senonian and Maastrichtian Ostracoda, Stockholm Contributions in Geology, vol 7.
</p>
<p>Van Valen L. (1974) Multivariate structural statistics in natural history. Journal of Theoretical Biology 45:235-247.
</p>
<p>Voinov V., Nikulin M. (1996) Unbiased Estimators and Their Applications, Vol. 2, Multivariate Case. Kluwer, Dordrecht.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># d &gt; 1 (MCVs)
data_set &lt;- lapply(list(iris[iris$Species == "setosa", 1:3],
                        iris[iris$Species == "versicolor", 1:3],
                        iris[iris$Species == "virginica", 1:3]),
                   as.matrix)
lapply(data_set, e_mcv)
# d = 1 (CV)
data_set &lt;- lapply(list(iris[iris$Species == "setosa", 1],
                        iris[iris$Species == "versicolor", 1],
                        iris[iris$Species == "virginica", 1]),
                   as.matrix)
lapply(data_set, e_mcv)

</code></pre>


</div>