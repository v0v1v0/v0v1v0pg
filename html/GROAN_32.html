<div class="container">

<table style="width: 100%;"><tr>
<td>phenoRegressor.rrBLUP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SNP-BLUP or G-BLUP using rrBLUP package</h2>

<h3>Description</h3>

<p>This is a wrapper around <code>rrBLUP</code> function <code>mixed.solve</code>.
It can either work with genotypes (in form of a SNP matrix) or with kinships (in form of a covariance
matrix). In the first case the function will implement a SNP-BLUP, in the second a G-BLUP. An error is
returned if both SNPs and covariance matrix are passed.<br>
In rrBLUP terms, genotypes are modeled as random effects (matrix Z), covariances as matrix K, and
extra covariates, if present, as fixed effects (matrix X).<br>
Please note that this function won't work if rrBLUP package is not installed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phenoRegressor.rrBLUP(
  phenotypes,
  genotypes = NULL,
  covariances = NULL,
  extraCovariates = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phenotypes</code></td>
<td>
<p>phenotypes, a numeric array (n x 1), missing values are predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>SNP genotypes, one row per phenotype (n), one column per marker (m), values in 0/1/2 for
diploids or 0/1/2/...ploidy for polyploids. Can be NULL if <code>covariances</code> is present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariances</code></td>
<td>
<p>square matrix (n x n) of covariances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraCovariates</code></td>
<td>
<p>optional extra covariates set, one row per phenotype (n), one column per covariate (w).
If NULL no extra covariates are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra parameters are passed to rrBLUP::mixed.solve</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the following fields:
</p>

<ul>
<li> <p><code>predictions</code> : an array of (k) predicted phenotypes
</p>
</li>
<li> <p><code>hyperparams</code> : named vector with the following keys: Vu, Ve, beta, LL
</p>
</li>
<li> <p><code>extradata</code>   : list with information on trained model, coming from <code>mixed.solve</code>
</p>
</li>
</ul>
<h3>See Also</h3>

<p>mixed.solve
</p>
<p>Other phenoRegressors: 
<code>phenoRegressor.BGLR()</code>,
<code>phenoRegressor.RFR()</code>,
<code>phenoRegressor.SVR()</code>,
<code>phenoRegressor.dummy()</code>,
<code>phenoregressor.BGLR.multikinships()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#using the GROAN.KI dataset, we regress on the dataset and predict the first ten phenotypes
phenos = GROAN.KI$yield
phenos[1:10]  = NA

#calling the regressor with ridge regression BLUP on SNPs and kinship
results.SNP.BLUP = phenoRegressor.rrBLUP(
  phenotypes = phenos,
  genotypes = GROAN.KI$SNPs,
  SE = TRUE, return.Hinv = TRUE #rrBLUP-specific parameters
)
results.G.BLUP = phenoRegressor.rrBLUP(
  phenotypes = phenos,
  covariances = GROAN.KI$kinship,
  SE = TRUE, return.Hinv = TRUE #rrBLUP-specific parameters
)

#examining the predictions
plot(GROAN.KI$yield, results.SNP.BLUP$predictions,
     main = '[SNP-BLUP] Train set (black) and test set (red) regressions',
     xlab = 'Original phenotypes', ylab = 'Predicted phenotypes')
abline(a=0, b=1)
points(GROAN.KI$yield[1:10], results.SNP.BLUP$predictions[1:10], pch=16, col='red')

plot(GROAN.KI$yield, results.G.BLUP$predictions,
     main = '[G-BLUP] Train set (black) and test set (red) regressions',
     xlab = 'Original phenotypes', ylab = 'Predicted phenotypes')
abline(a=0, b=1)
points(GROAN.KI$yield[1:10], results.G.BLUP$predictions[1:10], pch=16, col='red')

#printing correlations
correlations = data.frame(
  model = 'SNP-BLUP',
  test_set_correlations = cor(GROAN.KI$yield[1:10], results.SNP.BLUP$predictions[1:10]),
  train_set_correlations = cor(GROAN.KI$yield[-(1:10)], results.SNP.BLUP$predictions[-(1:10)])
)
correlations = rbind(correlations, data.frame(
  model = 'G-BLUP',
  test_set_correlations = cor(GROAN.KI$yield[1:10], results.G.BLUP$predictions[1:10]),
  train_set_correlations = cor(GROAN.KI$yield[-(1:10)], results.G.BLUP$predictions[-(1:10)])
))
print(correlations)

## End(Not run)
</code></pre>


</div>