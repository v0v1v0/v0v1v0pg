<div class="container">

<table style="width: 100%;"><tr>
<td>passage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability of passage</h2>

<h3>Description</h3>

<p>Calculates for each cell the number of passages of a random-walk
or randomised shortest paths with given origin(s) and destination(s).
Either the total or the net number of passages can be calculated.
In the case of multiple origins or destinations, each receives equal
weight.
</p>


<h3>Usage</h3>

<pre><code class="language-R">passage(x, origin, goal, theta, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>Transition*</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p><code>SpatialPoints</code>, matrix or numeric
object with coordinates or RasterLayer object with origin
cells set to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>goal</code></td>
<td>
<p><code>SpatialPoints</code>, matrix or numeric object
with coordinates or RasterLayer object with origin
cells set to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>If zero or missing, a random walk results.
If a numeric value 0 &lt; theta &lt; 20 is given, randomised
shortest paths are calculated; theta is the degree
from which the path randomly deviates from the shortest path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments:
totalNet ("total" or "net"), and output ("RasterLayer" or "Transition")</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The net number of passages between i and j is defined as:
abs( passages from i to j - passages from j to i ).
</p>
<p>Defaults for additional argument <code>totalNet</code> is "net"
and for <code>output</code> it is "RasterLayer".
</p>
<p>Random walk requires a symmetric transition matrix.
</p>


<h3>Value</h3>

<p>RasterLayer or Transition object, depending on the output argument
</p>


<h3>Author(s)</h3>

<p>Jacob van Etten. Implementation of randomised shortest
paths based on Matlab code by Marco Saerens
</p>


<h3>References</h3>

<p>McRae B.H., B.G. Dickson, and T. Keitt. 2008.
Using circuit theory to model connectivity in ecology,
evolution, and conservation.
<em>Ecology</em> 89:2712-2724.
</p>
<p>Saerens M., L. Yen, F. Fouss, and Y. Achbany. 2009.
Randomized shortest-path problems: two related models.
<em>Neural Computation</em>, 21(8):2363-2404.
</p>


<h3>See Also</h3>

<p><code>commuteDistance</code>,
<code>pathInc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#create a new raster and set all its values to unity.
raster &lt;- raster(nrows=18, ncols=36)
raster &lt;- setValues(raster,rep(1,ncell(raster)))

#create a Transition object from the raster
tr &lt;- transition(raster,mean,4)
trC &lt;- geoCorrection(tr, type="c", scl=TRUE)
trR &lt;- geoCorrection(tr, type="r", scl=TRUE)

#create two coordinates
sP1 &lt;- SpatialPoints(cbind(-105,55))
sP2 &lt;- SpatialPoints(cbind(105,-55))

#randomised shortest paths with theta = 2
rSPraster &lt;- passage(trC, sP1, sP2, 2)
plot(rSPraster)
points(sP1)
points(sP2)

#randomised shortest paths with theta = 0.05
rSPraster &lt;- passage(trC, sP1, sP2, 0.05)
plot(rSPraster)
points(sP1)
points(sP2)

#randomised shortest paths with theta = 0.05
#and total
rSPraster &lt;- passage(trC, sP1, sP2, 0.05, totalNet = "total")
plot(rSPraster)
points(sP1)
points(sP2)

#random walk
rwraster &lt;- passage(trR, sP1, sP2)
plot(rwraster)
points(sP1)
points(sP2)

</code></pre>


</div>