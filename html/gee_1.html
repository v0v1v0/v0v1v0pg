<div class="container">

<table style="width: 100%;"><tr>
<td>gee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to solve a Generalized Estimation Equation Model
</h2>

<h3>Description</h3>

<p>Produces an object of class <code>"gee"</code> which is a Generalized Estimation 
Equation fit of the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gee(formula, id,
    data, subset, na.action,
    R = NULL, b = NULL,
    tol = 0.001, maxiter = 25,
    family = gaussian, corstr = "independence",
    Mv = 1, silent = TRUE, contrasts = NULL,
    scale.fix = FALSE, scale.value = 1, v4.4compat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a formula expression as for other regression models, of the form
<code>response ~ predictors</code>. See the documentation of
<code>lm</code> and <code>formula</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>a vector which identifies the clusters.  The length of <code>id</code> should be
the same as the number of observations.  Data are assumed to be sorted
so that observations on a cluster are contiguous rows for all entities
in the formula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame in which to interpret the variables occurring
in the <code>formula</code>, along with the <code>id</code> and <code>n</code> variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>expression saying which subset of the rows of the data should be used
in the fit.  This can be a logical vector (which is replicated to have
length equal to the number of observations), or a numeric vector
indicating which observation numbers are to be included, or a
character vector of the row names to be included.
All observations are included by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>a function to filter missing data.  For <code>gee</code> only <code>na.omit</code>
should be used here.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>a square matrix of dimension maximum cluster size containing the user
specified correlation.  This is only appropriate if <code>corstr = "fixed"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>an initial estimate for the parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>the tolerance used in the fitting algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>the maximum number of iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>a <code>family</code> object: a list of functions and expressions for
defining link and variance functions.  Families supported
in <code>gee</code> are <code>gaussian</code>, <code>binomial</code>, <code>poisson</code>,
<code>Gamma</code>, and <code>quasi</code>;
see the <code>glm</code> and <code>family</code> documentation.
Some links are not currently available: <code>1/mu^2</code> and <code>sqrt</code> have
not been hard-coded in the ‘<span class="samp">⁠cgee⁠</span>’ engine at present.
The inverse gaussian variance function is not available.
All combinations of remaining functions can be obtained
either by family selection or by the use of <code>quasi</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>

<p>a character string specifying the correlation structure.
The following are permitted:
<code>"independence"</code>,
<code>"fixed"</code>,
<code>"stat_M_dep"</code>,
<code>"non_stat_M_dep"</code>,
<code>"exchangeable"</code>,
<code>"AR-M"</code> and
<code>"unstructured"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mv</code></td>
<td>

<p>When <code>corstr</code> is <code>"stat_M_dep"</code>, <code>"non_stat_M_dep"</code>,
or <code>"AR-M"</code> then <code>Mv</code> must be specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>a logical variable controlling whether parameter estimates at each
iteration are printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>

<p>a list giving contrasts for some or all of the factors appearing
in the model formula.  The elements of the list should have the
same name as the variable and should be either a contrast matrix
(specifically, any full-rank matrix with as many rows as there are
levels in the factor), or else a function to compute such a matrix
given the number of levels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.fix</code></td>
<td>

<p>a logical variable; if true, the scale parameter is fixed at
the value of <code>scale.value</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.value</code></td>
<td>

<p>numeric variable giving the value to which the scale parameter
should be fixed; used only if <code>scale.fix == TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v4.4compat</code></td>
<td>

<p>logical variable requesting compatibility of correlation
parameter estimates with previous versions; the current
version revises to be more faithful to the Liang and Zeger (1986)
proposals (compatible with the Groemping SAS macro, version 2.03)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Though input data need not be sorted by the variable
named <code>"id"</code>, the program
will interpret physically contiguous records possessing the
same value of <code>id</code> as members of the same cluster.  Thus it
is possible to use the following vector as an <code>id</code> vector
to discriminate 4 clusters of size 4: 
<code>c(0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1)</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"gee"</code> representing the fit.
</p>


<h3>Side Effects</h3>

<p>Offsets must be specified in the model formula, as in <code>glm</code>.
</p>


<h3>Note</h3>

<p>This is version 4.8 of this user documentation file, revised
98/01/27.  The assistance of Dr B Ripley is gratefully acknowledged.
</p>


<h3>References</h3>

<p>Liang, K.Y. and Zeger, S.L. (1986)
Longitudinal data analysis using generalized linear models.
<em>Biometrika</em>, <b>73</b> 13–22. 
</p>
<p>Zeger, S.L. and Liang, K.Y. (1986)
Longitudinal data analysis for discrete and continuous outcomes.
<em>Biometrics</em>, <b>42</b> 121–130.
</p>


<h3>See Also</h3>

<p><code>glm</code>, <code>lm</code>, <code>formula</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(warpbreaks)
## marginal analysis of random effects model for wool
summary(gee(breaks ~ tension, id=wool, data=warpbreaks, corstr="exchangeable"))
## test for serial correlation in blocks
summary(gee(breaks ~ tension, id=wool, data=warpbreaks, corstr="AR-M", Mv=1))

if(require(MASS)) {
data(OME)
## not fully appropriate link for these data.
(fm &lt;- gee(cbind(Correct, Trials-Correct) ~ Loud + Age + OME, id = ID,
           data = OME, family = binomial, corstr = "exchangeable"))
summary(fm)
}</code></pre>


</div>