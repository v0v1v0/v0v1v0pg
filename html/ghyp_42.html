<div class="container">

<table style="width: 100%;"><tr>
<td>fit.ghypmv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting generalized hyperbolic distributions to multivariate data</h2>

<h3>Description</h3>

<p>Perform a maximum likelihood estimation of the parameters of a
multivariate generalized hyperbolic distribution by using an
Expectation Maximization (EM) based algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.ghypmv(data, lambda = 1, alpha.bar = 1, mu = NULL, sigma = NULL,
           gamma = NULL, opt.pars = c(lambda = TRUE, alpha.bar = TRUE, mu = TRUE,
                                      sigma = TRUE, gamma = !symmetric),
           symmetric = FALSE, standardize = FALSE, nit = 2000, reltol = 1e-8,
           abstol = reltol * 10, na.rm = FALSE, silent = FALSE, save.data = TRUE,
           trace = TRUE, ...)

fit.hypmv(data,
          opt.pars = c(alpha.bar = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
          symmetric = FALSE, ...)

fit.NIGmv(data,
          opt.pars = c(alpha.bar = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
          symmetric = FALSE, ...)

fit.VGmv(data, lambda = 1,
         opt.pars = c(lambda = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
         symmetric = FALSE, ...)

fit.tmv(data, nu = 3.5,
        opt.pars = c(lambda = TRUE, mu = TRUE, sigma = TRUE, gamma = !symmetric),
        symmetric = FALSE, ...)

fit.gaussmv(data, na.rm = TRUE, save.data = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object coercible to a <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Starting value for the shape parameter <code>lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.bar</code></td>
<td>
<p>Starting value for the shape parameter <code>alpha.bar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Starting value for the shape parameter <code>nu</code> (only used
in case of a student-t distribution. It determines the
degree of freedom and is defined as <code>-2*lambda</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Starting value for the location parameter <code>mu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Starting value for the dispersion matrix <code>sigma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Starting value for the skewness vecotr <code>gamma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.pars</code></td>
<td>
<p>A named logical <code>vector</code> which states which parameters should be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>If <code>TRUE</code> the skewness parameter <code>gamma</code> keeps zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>If <code>TRUE</code> the sample will be standardized
before fitting.  Afterwards, the parameters and
log-likelihood et cetera will be back-transformed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.data</code></td>
<td>
<p>If <code>TRUE</code> <code>data</code> will be stored within the
<code>mle.ghyp</code> object
(cf. <code>ghyp.data</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>If <code>TRUE</code> the evolution of the parameter values
during the fitting procedure will be traced and stored
(cf. <code>ghyp.fit.info</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>If <code>TRUE</code> missing values will be removed from <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>If <code>TRUE</code> no prompts will appear in the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nit</code></td>
<td>
<p>Maximal number of iterations of the expectation maximation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>Relative convergence tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abstol</code></td>
<td>
<p>Absolute convergence tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>optim</code> and to <code>fit.ghypmv</code> when
fitting special cases of the generalized hyperbolic distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses a modified EM algorithm which is called Multi-Cycle
Expectation Conditional Maximization (MCECM) algorithm. This algorithm
is sketched in the vignette of this package which can be found in the
<code>doc</code> folder. A more detailed description is provided by the book
<em>Quantitative Risk Management, Concepts, Techniques and Tools</em>
(see “References”). <br></p>
<p>The general-purpose optimization routine <code>optim</code> is used
to maximize the loglikelihood function of the univariate mixing
distribution.  The default method is that of Nelder and Mead which
uses only function values. Parameters of <code>optim</code> can be
passed via the ... argument of the fitting routines.
</p>


<h3>Value</h3>

<p>An object of class <code>mle.ghyp</code>.
</p>


<h3>Note</h3>

<p>The variance gamma distribution becomes singular when <code class="reqn">\mathbf{x}
  - \mathbf{\mu} = 0</code>. This singularity is catched and the
reduced density function is computed. Because the transition is not
smooth in the numerical implementation this can rarely result in
nonsensical fits.
</p>
<p>Providing both arguments, <code>opt.pars</code> and <code>symmetric</code> respectively,
can result in a conflict when <code>opt.pars['gamma']</code> and <code>symmetric</code>
are <code>TRUE</code>. In this case <code>symmetric</code> will dominate and
<code>opt.pars['gamma']</code> is set to <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Wolfgang Breymann, David Luethi
</p>


<h3>References</h3>

<p>Alexander J. McNeil, Ruediger Frey, Paul Embrechts (2005)
<em>Quantitative Risk Management, Concepts, Techniques and Tools</em>
<br></p>
<p><code>ghyp</code>-package vignette in the <code>doc</code> folder or on
<a href="https://cran.r-project.org/package=ghyp">https://cran.r-project.org/package=ghyp</a>.<br></p>
<p>S-Plus and R library <em>QRMlib</em>)
</p>


<h3>See Also</h3>

<p><code>fit.ghypuv</code>, <code>fit.hypuv</code>,
<code>fit.NIGuv</code>, <code>fit.VGuv</code>,
<code>fit.tuv</code> for univariate fitting routines.
<code>ghyp.fit.info</code> for information regarding the
fitting procedure.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(smi.stocks)

  fit.ghypmv(data = smi.stocks, opt.pars = c(lambda = FALSE), lambda = 2,
             control = list(rel.tol = 1e-5, abs.tol = 1e-5), reltol = 0.01)
</code></pre>


</div>