<div class="container">

<table style="width: 100%;"><tr>
<td>InducedGraphs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphs induced by marginalization or conditioning</h2>

<h3>Description</h3>

<p>Functions to find induced graphs after conditioning on a set of variables and marginalizing over another set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">inducedCovGraph(amat, sel = rownames(amat), cond = NULL)
inducedConGraph(amat, sel = rownames(amat), cond = NULL)
inducedRegGraph(amat, sel = rownames(amat), cond = NULL)
inducedChainGraph(amat, cc=rownames(amat), cond = NULL, type="LWF")
inducedDAG(amat, order, cond = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amat</code></td>
<td>
<p>a square Boolean matrix, the adjacency matrix of a directed
acyclic graph. The names of rows and of the columns
are the nodes of the DAG.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel</code></td>
<td>
<p>a character vector representing a subset
of selected variables.
The elements of the  vector must be a subset of
the names of the nodes i.e. of <code>rownames(A)</code>.
By default <code>sel</code> is the set of the nodes of the DAG.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond</code></td>
<td>
<p>a character vector representing the variables on which you
want to condition. <code>cond</code> must be disjoint from <code>sel</code> and
their union must be a subset of the set of nodes. The set difference
between the set of nodes and the union of <code>sel</code> and
<code>cond</code> are  the variables over which we marginalize.
<code>cond</code> may be the null vector (the default), meaning that you want
to condition on the empty set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p>a list of character vectors specifying the chain components
for the chain graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string indicating the interpretation of the chain
graph. It can be either "LWF" (Lauritzen, Wermuth, Frydenberg
interpretation), "AMP" (Andersson, Madigan, Perlman interpretation)
or "MRG" (Multivariate regression graph interpretation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>a character vector indicating the ordering of the vertices
of a DAG (left to right, past to future).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a directed acyclic graph representing a set of
conditional independencies it is possible to obtain other graphs
of conditional independence implied after marginalizingover and
conditionig on sets of nodes. Such graphs are
the covariance graph, the concentration graph, the multivariate
regression graph and the chain graph with different interpretations  (see Cox &amp; Wermuth, 1996, 2004).
</p>


<h3>Value</h3>

<p><code>inducedCovGraph</code> returns the adjacency matrix of the covariance
graph of the variables in set <code>sel</code> given the variables
in set <code>cond</code>, implied by the original directed acyclic graph
with adjacency matrix <code>amat</code>.
</p>
<p><code>inducedConGraph</code> returns the adjacency matrix of the concentration
graph of the variables in set <code>sel</code> given the variables
in set <code>cond</code>, implied by the original directed acyclic graph
with adjacency matrix <code>amat</code>.
</p>
<p><code>inducedRegGraph</code> returns the adjacency matrix of the
multivariate regression graph of the variables in set <code>sel</code>
given the variables in set  <code>cond</code>, implied by the original
directed acyclic graph with adjacency matrix <code>amat</code>.
</p>
<p><code>inducedChainGraph</code> returns the adjacency matrix of the
chain graph for the variables in chain components
<code>cc</code>, given the variables in set  <code>cond</code>, with
interpretation specified by string <code>type</code>, implied by the original
directed acyclic graph with adjacency matrix <code>amat</code>.
</p>
<p><code>inducedDAG</code> returns the adjacency matrix of the DAG with
the ordering <code>order</code>, implied by the  original directed acyclic
graph with adjacency matrix <code>amat</code>.
</p>


<h3>Note</h3>

<p>If <code>sel</code> is <code>NULL</code> the functions return the null matrix.
If <code>cond</code> is <code>NULL</code>, the conditioning set is empty and the
functions <code>inducedConGraph</code> and <code>inducedCovGraph</code>
return the overall induced covariance or concentration
matrices of the selected variables. If you do not specify <code>sel</code>
you cannot specify a non <code>NULL</code> value of <code>cond</code>.
</p>


<h3>Author(s)</h3>

<p>Giovanni M. Marchetti</p>


<h3>References</h3>

<p>Cox, D. R. &amp; Wermuth, N. (1996). <em>Multivariate
dependencies</em>. London: Chapman &amp; Hall.
</p>
<p>Wermuth, N. &amp; Cox, D.R. (2004). Joint response graphs
and separation induced by triangular systems. <em>J.R. Statist. Soc. B</em>,
66, Part 3, 687-717.
</p>


<h3>See Also</h3>

<p><code>DAG</code>, <code>UG</code>,<code>isAcyclic</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Define a DAG
dag &lt;- DAG(a ~ x, c ~ b+d, d~ x)
dag
## Induced covariance graph of a, b, d given the empty set.
inducedCovGraph(dag, sel=c("a", "b", "d"), cond=NULL)

## Induced concentration graph of a, b, c given x
inducedConGraph(dag, sel=c("a", "b", "c"), cond="x")

## Overall covariance graph
inducedCovGraph(dag)

## Overall concentration graph
inducedConGraph(dag)

## Induced covariance graph of x, b, d given c, x.
inducedCovGraph(dag, sel=c("a", "b", "d"), cond=c("c", "x"))

## Induced concentration graph of a, x, c given d, b.
inducedConGraph(dag, sel=c("a", "x", "c"), cond=c("d", "b"))

## The DAG on p. 198 of Cox &amp; Wermuth (1996)
dag &lt;- DAG(y1~ y2 + y3, y3 ~ y5, y4 ~ y5)

## Cf. figure 8.7 p. 203 in Cox &amp; Wermuth (1996)
inducedCovGraph(dag, sel=c("y2", "y3", "y4", "y5"), cond="y1")
inducedCovGraph(dag, sel=c("y1", "y2", "y4", "y5"), cond="y3")
inducedCovGraph(dag, sel=c("y1", "y2", "y3", "y4"), cond="y5")

## Cf. figure 8.8 p. 203 in Cox &amp; Wermuth (1996)
inducedConGraph(dag, sel=c("y2", "y3", "y4", "y5"), cond="y1")
inducedConGraph(dag, sel=c("y1", "y2", "y4", "y5"), cond="y3")
inducedConGraph(dag, sel=c("y1", "y2", "y3", "y4"), cond="y5")

## Cf. figure 8.9 p. 204 in Cox &amp; Wermuth (1996)
inducedCovGraph(dag, sel=c("y2", "y3", "y4", "y5"), cond=NULL)
inducedCovGraph(dag, sel=c("y1", "y2", "y4", "y5"), cond=NULL)
inducedCovGraph(dag, sel=c("y1", "y2", "y3", "y4"), cond=NULL)

## Cf. figure 8.10 p. 204 in Cox &amp; Wermuth (1996)
inducedConGraph(dag, sel=c("y2", "y3", "y4", "y5"), cond=NULL)
inducedConGraph(dag, sel=c("y1", "y2", "y4", "y5"), cond=NULL)
inducedConGraph(dag, sel=c("y1", "y2", "y3", "y4"), cond=NULL)

## An induced regression graph
dag2 = DAG(Y ~ X+U, W ~ Z+U)
inducedRegGraph(dag2, sel="W",  cond=c("Y", "X", "Z"))

## An induced DAG
inducedDAG(dag2, order=c("X","Y","Z","W"))

## An induced multivariate regression graph
inducedRegGraph(dag2, sel=c("Y", "W"), cond=c("X", "Z"))

## An induced chain graph with LWF interpretation
dag3 = DAG(X~W, W~Y, U~Y+Z)
cc = list(c("W", "U"), c("X", "Y", "Z"))
inducedChainGraph(dag3, cc=cc, type="LWF")

## ... with AMP interpretation
inducedChainGraph(dag3, cc=cc, type="AMP")

## ... with multivariate regression interpretation
cc= list(c("U"), c("Z", "Y"), c("X", "W"))
inducedChainGraph(dag3, cc=cc, type="MRG")
</code></pre>


</div>