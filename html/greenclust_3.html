<div class="container">

<table style="width: 100%;"><tr>
<td>greencut</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cut a Greenclust Tree into Optimal Groups</h2>

<h3>Description</h3>

<p>Cuts a <code>greenclust</code> tree at an automatically-determined number
of groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">greencut(g, k = NULL, h = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a tree as producted by <code>greenclust</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>an integer scalar with the desired number of groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>numeric scalar with the desired height where the tree should be cut</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The cut point is calculated by finding the number of groups/clusters that
results in a collapsed contingency table with the most-significant (lowest
p-value) chi-squared test. If there are ties, the smallest number of
groups wins.
</p>
<p>If a certain number of groups is required or a specific r-squared
(1 - height) threshold is targeted, values for either <code>k</code> or <code>h</code>
may be provided. (While the regular <code>cutree</code> function could
also be used in this circumstance, it may still be useful to have the
additional attributes that <code>greencut()</code> provides.)
</p>
<p>As with <code>cutree()</code>, <code>k</code> overrides <code>h</code> if both are given.
</p>


<h3>Value</h3>

<p><code>greencut</code> returns a vector of group memberships, with the
resulting r-squared value and p-value as object attributes,
accessable via <code>attr</code>.
</p>


<h3>References</h3>

<p>Greenacre, M.J. (1988) "Clustering the Rows and Columns of
a Contingency Table," <em>Journal of Classification 5</em>, 39-51.
<a href="https://doi.org/10.1007/BF01901670">doi:10.1007/BF01901670</a>
</p>


<h3>See Also</h3>

<p><code>greenclust</code>, <code>greenplot</code>,
<code>assign.cluster</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Combine Titanic passenger attributes into a single category
# and create a contingency table for the non-zero levels
tab &lt;- t(as.data.frame(apply(Titanic, 4:1, FUN=sum)))
tab &lt;- tab[apply(tab, 1, sum) &gt; 0, ]

grc &lt;- greenclust(tab)
greencut(grc)

plot(grc)
rect.hclust(grc, max(greencut(grc)),
            border=unique(greencut(grc))+1)
</code></pre>


</div>