<div class="container">

<table style="width: 100%;"><tr>
<td>gemIntertemporal_EndogenousEquilibriumInterestRate_MoneyVelocity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An Example Illustrating Endogenous Equilibrium Interest Rates and the Velocity of Money in a (Timeline) Transitional Equilibrium Path</h2>

<h3>Description</h3>

<p>This example illustrates (endogenous) equilibrium primitive interest rates and the velocity of money in a transitional equilibrium path.
The (primitive) interest rate here can be divided into two types, namely the interest rate in the case of lump-sum interest payment and the interest rate in the case of installment interest payment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gemIntertemporal_EndogenousEquilibriumInterestRate_MoneyVelocity(...)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to the function sdm2.</p>
</td>
</tr></table>
<h3>See Also</h3>

<p><code>gemIntertemporal_EndogenousEquilibriumInterestRate</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
vm &lt;- 4 # the velocity of money
eis &lt;- 0.8 # the elasticity of intertemporal substitution
Gamma.beta &lt;- 0.8 # the subjective discount factor
gr &lt;- 0 # the steady-state growth rate
np &lt;- 20 # the number of economic periods

f &lt;- function(ir.installment = rep(0.25, np - 1), return.ge = FALSE,
              y1 = 10, # the product supply in the first period
              alpha.firm = rep(2, np - 1) # the efficiency parameters of firms
) {
  n &lt;- 2 * np # the number of commodity kinds
  m &lt;- np + 1 # the number of agent kinds

  names.commodity &lt;- c(
    paste0("prod", 1:np),
    paste0("lab", 1:(np - 1)),
    "money"
  )
  names.agent &lt;- c(
    paste0("firm", 1:(np - 1)),
    "laborer", "moneyOwner"
  )

  # the exogenous supply matrix.
  S0Exg &lt;- matrix(NA, n, m, dimnames = list(names.commodity, names.agent))
  S0Exg[paste0("lab", 1:(np - 1)), "laborer"] &lt;- 100 * (1 + gr)^(0:(np - 2))
  S0Exg["money", "moneyOwner"] &lt;- 100
  S0Exg["prod1", "laborer"] &lt;- y1

  # the output coefficient matrix.
  B &lt;- matrix(0, n, m, dimnames = list(names.commodity, names.agent))
  for (k in 1:(np - 1)) {
    B[paste0("prod", k + 1), paste0("firm", k)] &lt;- 1
  }

  dstl.firm &lt;- list()
  for (k in 1:(np - 1)) {
    dstl.firm[[k]] &lt;- node_new(
      "prod",
      type = "FIN", rate = c(1, ir.installment[k] / vm),
      "cc1", "money"
    )
    node_set(dstl.firm[[k]], "cc1",
      type = "CD", alpha = alpha.firm[k], beta = c(0.5, 0.5),
      paste0("prod", k), paste0("lab", k)
    )
  }

  dst.laborer &lt;- node_new(
    "util",
    type = "CES", es = eis,
    alpha = 1, beta = prop.table(Gamma.beta^(1:np)),
    paste0("cc", 1:(np - 1)), paste0("prod", np)
  )

  for (k in 1:(np - 1)) {
    node_set(dst.laborer, paste0("cc", k),
      type = "FIN", rate = c(1, ir.installment[k] / vm),
      paste0("prod", k), "money"
    )
  }

  dst.moneyOwner &lt;- node_new(
    "util",
    type = "CES", es = eis,
    alpha = 1, beta = prop.table(Gamma.beta^(1:(np - 1))),
    paste0("cc", 1:(np - 1))
  )
  for (k in 1:(np - 1)) {
    node_set(dst.moneyOwner, paste0("cc", k),
      type = "FIN", rate = c(1, ir.installment[k] / vm),
      paste0("prod", k), "money"
    )
  }

  ge &lt;- sdm2(
    A = c(dstl.firm, dst.laborer, dst.moneyOwner),
    B = B,
    S0Exg = S0Exg,
    names.commodity = names.commodity,
    names.agent = names.agent,
    numeraire = "prod1",
    policy = makePolicyHeadTailAdjustment(gr = gr, np = np, type = c("tail"))
  )

  tmp &lt;- rowSums(ge$SV)
  ts.exchange.value &lt;- tmp[paste0("prod", 1:(np - 1))] + tmp[paste0("lab", 1:(np - 1))]
  # The lump-sum interest rate equals the yield rate of money.
  ir.lumpsum &lt;- ts.exchange.value[1:(np - 2)] / ts.exchange.value[2:(np - 1)] - 1
  ir.lumpsum &lt;- pmax(1e-6, ir.lumpsum)
  ir.lumpsum[np - 1] &lt;- ir.lumpsum[np - 2]
  ir.installment.new &lt;- 1 / (1 / ir.lumpsum + 1 - 1 / vm)

  ir.installment &lt;- c(ir.installment * ratio_adjust(ir.installment.new / ir.installment, 0.3))
  cat("ir.installment: ", ir.installment, "\n")

  if (return.ge) {
    ge$ts.exchange.value &lt;- ts.exchange.value
    return(ge)
  } else {
    return(ir.installment)
  }
}

## Calculate equilibrium installment interest rates.
## Warning: Running the program below takes about several minutes.
## mat.ir.installment &lt;- iterate(rep(0.1, np - 1), f, tol = 1e-4)
## # the lump-sum interest rate in the steady-state equilibrium.
## ir.lumpsum.steadyState &lt;- sserr(eis, Gamma.beta, gr, prepaid = TRUE)
## # the installment interest rate in the steady-state equilibrium.
## 1 / (1 / ir.lumpsum.steadyState + 1 - 1 / vm)

## Below are the calculated equilibrium installment interest rates.
(ir.installment &lt;- c(
  0.3723, 0.2981, 0.2580, 0.2363, 0.2245, 0.2181, 0.2147,
  0.2128, 0.2118, 0.2112, 0.2109, 0.2107, 0.2106, 0.2106,
  0.2106, 0.2105, 0.2105, 0.2106, 0.2106
))

ge &lt;- f(ir.installment, TRUE)

plot(ge$z[1:(np - 1)], type = "o")

# The yield rate is the interest rate for a lump-sum payment.
(ir.lumpsum &lt;- ge$ts.exchange.value[1:(np - 2)] / ge$ts.exchange.value[2:(np - 1)] - 1)
1 / (1 / ir.lumpsum + 1 - 1 / vm) # consistent with the installment interest rates
# consistent with the lump-sum interest rates.
ir.installment / (1 + ir.installment / vm - ir.installment)

## Calculate the growth rate of the money supply and the equilibrium nominal
## lump-sum interest rates when the current price of the product remains constant.
price.money &lt;- 1 / c(1, cumprod(ir.installment + 1))
currentPrice.prod &lt;- ge$p[1:np] / price.money
gr.moneySupply &lt;- unname(growth_rate(1 / currentPrice.prod))
# the equilibrium nominal lump-sum interest rates
(1 + ir.lumpsum) * (gr.moneySupply[2:(np - 1)] + 1) - 1
(1 + ir.installment / (1 + ir.installment / vm - ir.installment)) * (gr.moneySupply[2:np] + 1) - 1

## the corresponding sequential model with the same steady-state equilibrium.
dividend.rate &lt;- sserr(eis, Gamma.beta, prepaid = TRUE)
ir.installment &lt;- 1 / (1 / dividend.rate + 1 - 1 / vm)

np &lt;- 5
ge.ss &lt;- f(ir.installment = rep(ir.installment, np - 1), return.ge = TRUE, y1 = 152)

dst.firm &lt;- node_new("prod",
  type = "FIN", rate = c(1, ir.installment / vm, (1 + ir.installment / vm) * dividend.rate),
  "cc1", "money", "equity.share"
)
node_set(dst.firm, "cc1",
  type = "CD",
  alpha = 2, beta = c(0.5, 0.5),
  "prod", "lab"
)

dst.laborer &lt;- node_new("util",
  type = "FIN", rate = c(1, ir.installment / vm),
  "prod", "money"
)

dst.moneyOwner &lt;- node_new("util",
  type = "FIN", rate = c(1, ir.installment / vm),
  "prod", "money"
)

ge2 &lt;- sdm2(
  A = list(dst.firm, dst.laborer, dst.moneyOwner),
  B = matrix(c(
    1, 0, 0,
    0, 0, 0,
    0, 0, 0,
    0, 0, 0
  ), 4, 3, TRUE),
  S0Exg = matrix(c(
    NA, NA, NA,
    NA, 100, NA,
    NA, NA, 100,
    NA, 100, NA
  ), 4, 3, TRUE),
  names.commodity = c(
    "prod", "lab", "money", "equity.share"
  ),
  names.agent = c("firm", "laborer", "moneyOwner"),
  numeraire = "prod"
)

ge2$p
ge.ss$z[np - 1]
ge2$z
ge.ss$D[paste0("prod", np - 1), c("laborer", "moneyOwner")]
ge2$D

</code></pre>


</div>