<div class="container">

<table style="width: 100%;"><tr>
<td>testLMNormal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply Goodness of Fit Test to Residuals of a Linear Model</h2>

<h3>Description</h3>

<p><code>testLMNormal</code> is used to check the normality assumption of residuals in a linear model. This function
can take the response variable and design matrix, fit a linear model, and apply the goodness-of-fit test. Conveniently,
it can take an object of class "lm" and directly applies the goodness-of-fit test. The function returns a goodness-of-fit
statistic along with an approximate pvalue.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testLMNormal(
  x,
  y,
  fit = NULL,
  ngrid = length(y),
  gridpit = FALSE,
  hessian = FALSE,
  method = "cvm"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>is either a numeric vector or a design matrix. In the design matrix, rows indicate observations and columns
presents covariats.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>is a vector of numeric values with the same number of observations or number of rows as x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>an object of class "lm" returned by  <code>lm</code> function in <code>stats</code> package. The default value of
fit is NULL. If any object is provided, <code>x</code> and <code>y</code> will be ignored and the class of object is checked. If you pass
an object to <code>fit</code> make sure to return the design matrix by setting <code>x</code> = <code>TRUE</code> and the response variable by
setting in <code>y</code> = <code>TRUE</code> in <code>lm</code> function. To read more about this see the help documentation for
<code>lm</code> function or see the example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>the number of equally spaced points to discretize the (0,1) interval for computing the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridpit</code></td>
<td>
<p>logical. If <code>TRUE</code> (the default value), the parameter ngrid is ignored and (0,1) interval is divided
based on probability inverse transformed values obtained from the sample. If <code>FALSE</code>, the interval is divided into ngrid
equally spaced points for computing the covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>logical. If <code>TRUE</code> the Fisher information matrix is estimated by the observed Hessian Matrix based on
the sample. If <code>FALSE</code> (the default value) the Fisher information matrix is estimated by the variance of the
observed score matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating which goodness-of-fit statistic is to be computed. The default value is
'cvm' for the Cramer-von-Mises statistic. Other options include 'ad' for the Anderson-Darling statistic, and 'both'
to compute both cvm and ad.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of two containing the following components:
</p>

<ul>
<li>
<p> Statistic: the value of goodness-of-fit statistic.
</p>
</li>
<li>
<p> p-value: the approximate p-value for the goodness-of-fit test based on empirical distribution function.
if method = 'cvm' or method = 'ad', it returns a numeric value for the statistic and p-value. If method = 'both', it
returns a numeric vector with two elements and one for each statistic.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
n &lt;- 50
p &lt;- 5
x &lt;- matrix( runif(n*p), nrow = n, ncol = p)
e &lt;- rnorm(n)
b &lt;- runif(p)
y &lt;- x %*% b + e
testLMNormal(x, y)
# Or pass lm.fit object directly:
lm.fit &lt;- lm(y ~ x, x = TRUE, y = TRUE)
testLMNormal(fit = lm.fit)
</code></pre>


</div>