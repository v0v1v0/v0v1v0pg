<div class="container">

<table style="width: 100%;"><tr>
<td>graph_topo_compar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute an index comparing graph topologies</h2>

<h3>Description</h3>

<p>The function computes several indices in order to compare two
graph topologies. One of the graph has the "true" topology the other is
supposed to reproduce. The indices are then a way to assess the reliability
of the latter graph.
Both graphs must have the same number of nodes, but not necessarily the
same number of links. They must also have the same node names and in
the same order.
</p>


<h3>Usage</h3>

<pre><code class="language-R">graph_topo_compar(obs_graph, pred_graph, mode = "mcc", directed = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs_graph</code></td>
<td>
<p>A graph object of class <code>igraph</code> with n nodes.
It is the observed graph that <code>pred_graph</code> is supposed to approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_graph</code></td>
<td>
<p>A graph object of class <code>igraph</code> with n nodes.
It is the predicted graph that is supposed to be akin to <code>obs_graph</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>A character string specifying which index to compute in order
to compare the topologies of the graphs.
</p>

<ul>
<li>
<p>If 'mode = 'mcc” (default), the Matthews Correlation
Coefficient (MCC) is computed.
</p>
</li>
<li>
<p>If 'mode = 'kappa”, the Kappa index is computed.
</p>
</li>
<li>
<p>If 'mode = 'fdr”, the False Discovery Rate (FDR) is computed.
</p>
</li>
<li>
<p>If 'mode = 'acc”, the Accuracy is computed.
</p>
</li>
<li>
<p>If 'mode = 'sens”, the Sensitivity is computed.
</p>
</li>
<li>
<p>If 'mode = 'spec”, the Specificity is computed.
</p>
</li>
<li>
<p>If 'mode = 'prec”, the Precision is computed.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directed</code></td>
<td>
<p>Logical (TRUE or FALSE) specifying whether both graphs
are directed or not.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The indices are calculated from a confusion matrix counting
the number of links that are in the "observed" graph ("true") and also
in the "predicted" graph (true positives : TP), that are in the "observed"
graph but not in the "predicted" graph (false negatives : FN), that are not
in the "observed" graph but in the "predicted" graph (false positives : FP)
and that are not in the "observed" graph and not in the "predicted" graph
neither (true negatives: TN). K is the total number of links in the graphs.
K is equal to <code class="reqn">n\times(n-1)</code> if the graphs are directed and to
<code class="reqn">\frac{n\times(n-1)}{2}</code> if they are not directed, with n the number
of nodes.
OP = TP + FN, ON = TN + FP, PP = TP + FP and PN = FN + TN.
</p>
<p>The Matthews Correlation Coefficient (MCC) is computed as follows:
<code class="reqn">MCC = \frac{TP\times TN-FP\times FN}{\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}</code>
</p>
<p>The Kappa index is computed as follows:
<code class="reqn">Kappa = \frac{K\times (TP + TN) - (ON \times PN) - (OP \times PP)}{K^{2} - (ON \times PN) - (OP \times PP)}</code>
</p>
<p>The False Discovery Rate (FDR) is calculated as follows:
<code class="reqn">FDR = \frac{FP}{TP+FP}</code>
</p>
<p>The Accuracy is calculated as follows:
<code class="reqn">Acc = \frac{TP + TN}{K}</code>
</p>
<p>The Sensitivity is calculated as follows:
<code class="reqn">Sens = \frac{TP}{TP+FN}</code>
</p>
<p>The Specificity is calculated as follows:
<code class="reqn">Spec = \frac{TN}{TN+FP}</code>
</p>
<p>The Precision is calculated as follows:
<code class="reqn">Prec = \frac{TP}{TP+FP}</code>
</p>
<p>Self loops are not taken into account.
</p>


<h3>Value</h3>

<p>The value of the index computed
</p>


<h3>Author(s)</h3>

<p>P. Savary
</p>


<h3>References</h3>

<p>Dyer RJ, Nason JD (2004).
“Population graphs: the graph theoretic shape of genetic structure.”
<em>Molecular ecology</em>, <b>13</b>(7), 1713–1727.
Baldi P, Brunak S, Chauvin Y, Andersen CA, Nielsen H (2000).
“Assessing the accuracy of prediction algorithms for classification: an overview.”
<em>Bioinformatics</em>, <b>16</b>(5), 412–424.
Matthews BW (1975).
“Comparison of the predicted and observed secondary structure of T4 phage lysozyme.”
<em>Biochimica et Biophysica Acta (BBA)-Protein Structure</em>, <b>405</b>(2), 442–451.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data_ex_genind)
data(pts_pop_ex)
mat_dist &lt;- suppressWarnings(graph4lg::mat_geo_dist(data=pts_pop_ex,
      ID = "ID",
      x = "x",
      y = "y"))
mat_dist &lt;- mat_dist[order(as.character(row.names(mat_dist))),
                      order(as.character(colnames(mat_dist)))]
graph_obs &lt;- gen_graph_thr(mat_w = mat_dist, mat_thr = mat_dist,
                            thr = 15000, mode = "larger")
mat_gen &lt;- mat_gen_dist(x = data_ex_genind, dist = "DPS")
graph_pred &lt;- gen_graph_topo(mat_w = mat_gen, mat_topo = mat_dist,
                            topo = "gabriel")
graph_topo_compar(obs_graph = graph_obs,
                  pred_graph = graph_pred,
                  mode = "mcc",
                  directed = FALSE)
</code></pre>


</div>