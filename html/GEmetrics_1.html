<div class="container">

<table style="width: 100%;"><tr>
<td>BGLR_format</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Format the phenotypic response matrix for BGLR</h2>

<h3>Description</h3>

<p>This function formats the phenotypic data as well as the kinship
matrix for BGLR
</p>


<h3>Usage</h3>

<pre><code class="language-R">BGLR_format(Pheno, K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pheno</code></td>
<td>
<p>a data frame with three columns: "Y" for phenotypic values,
"Genotype" for genotype names and "Environment" for environment names.
All genotypes names must be included in the set or row/column names of
the "K" matrix. The number of environments (J) must be at least two</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a square kinship or genomic relationship matrix for N genotypes
whose row and column names include those of the "Genotype" column of
the "Pheno" matrix</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of two elements: a "BGLR_pheno" phenotypic response matrix
with J columns to be used in BGLR and the corresponding "BGLR_K" kinship matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Set seed for reproductibility
set.seed(123)

## Load "wheat" dataset from BGLR
data("wheat",package = "BGLR")

## Generate a design data frame for all genotypes in 5 environments
Design &lt;- expand.grid(Genotype=rownames(wheat.A),Environment=paste0("Env",1:5))

## Set sparseness by discarding 75% of the combinations
Design &lt;- Design[-sample(nrow(Design),round(nrow(Design)*3/4)),]

## Simulate phenotypic data with default parameter values
DataSim &lt;- Simulate_MET_data(Design=Design,K=wheat.A)

## Generate the phenotypic response matrix for BGLR and the corresponding kinship matrix
BGLR_data &lt;- BGLR_format(Pheno=DataSim$Pheno,K=wheat.A)
head(BGLR_data$BGLR_pheno)
</code></pre>


</div>