<div class="container">

<table style="width: 100%;"><tr>
<td>GeoFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Max-Likelihood-Based Fitting of Gaussian and non Gaussian random fields.</h2>

<h3>Description</h3>

<p>Maximum weighted composite-likelihood fitting for Gaussian  and some Non-Gaussian  
univariate spatial, spatio-temporal and bivariate spatial random fieldss
The function allows to fix any of the parameters and setting upper/lower bound in the optimization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GeoFit(data, coordx, coordy=NULL, coordt=NULL, coordx_dyn=NULL,copula=NULL,
      corrmodel=NULL,distance="Eucl",fixed=NULL,anisopars=NULL,
      est.aniso=c(FALSE,FALSE),GPU=NULL, grid=FALSE, likelihood='Marginal',
     local=c(1,1),  lower=NULL,maxdist=Inf,neighb=NULL,
      maxtime=Inf, memdist=TRUE,method="cholesky", 
      model='Gaussian',n=1, onlyvar=FALSE ,
      optimizer='Nelder-Mead', parallel=FALSE, 
      radius=6371,  sensitivity=FALSE,sparse=FALSE, 
      start=NULL, taper=NULL, tapsep=NULL, 
      type='Pairwise', upper=NULL, varest=FALSE, 
      vartype='SubSamp', weighted=FALSE, winconst=NULL, winstp=NULL, 
      winconst_t=NULL, winstp_t=NULL,X=NULL,nosym=FALSE,spobj=NULL,spdata=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector (a single spatial realisation)  or a (<code class="reqn">d \times d</code>)-matrix (a single spatial realisation on regular grid)
or a
(<code class="reqn">t \times d</code>)-matrix (a single spatial-temporal realisation)   or an (<code class="reqn">d \times d \times t \times n </code>)-array
(a single spatial-temporal realisation on regular grid).
For the description see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx</code></td>
<td>
<p>A numeric (<code class="reqn">d \times 2</code>)-matrix (where
<code>d</code> is the number of spatial sites) assigning 2-dimensions of spatial coordinates or a numeric <code class="reqn">d</code>-dimensional vector assigning
1-dimension of spatial coordinates.  Coordinates on a sphere for a  fixed radius <code>radius</code> 
are passed in lon/lat format expressed in decimal degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordy</code></td>
<td>
<p>A numeric vector assigning 1-dimension of
spatial coordinates; <code>coordy</code> is interpreted only if <code>coordx</code> is a numeric
vector or <code>grid=TRUE</code> otherwise it will be ignored. Optional argument, the default is <code>NULL</code> then <code>coordx</code> is expected to
be numeric a (<code class="reqn">d \times 2</code>)-matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordt</code></td>
<td>
<p>A numeric vector assigning 1-dimension of
temporal coordinates.  Optional argument, the default is <code>NULL</code>
then a spatial random fields is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx_dyn</code></td>
<td>
<p>A list of <code class="reqn">m</code> numeric (<code class="reqn">d_t \times 2</code>)-matrices
containing dynamical (in time) spatial coordinates. Optional argument, the default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>String; the type of copula. It can be "Clayton" or "Gaussian"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrmodel</code></td>
<td>
<p>String; the name of a correlation model, for the
description see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>String; the name of the spatial distance. The default is <code>Eucl</code>, the euclidean distance.
See the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>An optional named list giving the values of the parameters that
will be considered as known values. The listed parameters for a
given correlation function will be not estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anisopars</code></td>
<td>
<p> A list of two elements: "angle" and "ratio" i.e. the anisotropy angle and the anisotropy ratio, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.aniso</code></td>
<td>
<p> A bivariate logical vector  providing which  anisotropic parameters must be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GPU</code></td>
<td>
<p>Numeric; if <code>NULL</code> (the default) 
no OpenCL computation is performed. The user can choose the device to be used. Use <code>DeviceInfo()</code> function to see available devices, only double precision devices are allowed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical; if <code>FALSE</code> (the default) the data
are interpreted as spatial or spatial-temporal realisations on a set
of non-equispaced spatial sites (irregular grid).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>String; the configuration of the composite
likelihood. <code>Marginal</code> is the default, see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local</code></td>
<td>
<p>Numeric; number of local work-items of the OpenCL setup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>An optional named list giving the values  for the lower bound of the space parameter
when the optimizer is  <code>L-BFGS-B</code> or <code>nlminb</code>  or <code>optimize</code>. The 
names of the list must be the same of the names in the   <code>start</code> list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>Numeric; an optional positive value indicating the maximum
spatial distance considered in the composite or tapered likelihood
computation. See the Section <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighb</code></td>
<td>
<p>Numeric; an optional positive integer indicating the 
order of neighborhood  in the composite likelihood
computation. See the Section <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>Numeric; an optional positive integer indicating the 
order of temporal neighborhood  in the composite likelihood
computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memdist</code></td>
<td>
<p> Logical; if <code>TRUE</code> then  all  the distances  useful in the  composite likelihood 
estimation are computed before  the optimization. <code>FALSE</code> is deprecated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String; the type of matrix decomposition used in the simulation. Default is cholesky.
The other possible choices is <code>svd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>String; the type of random fields and therefore the densities associated to the likelihood
objects. <code>Gaussian</code> is the default, see the Section
<b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Numeric; number of trials in a binomial random fields; number of successes in a negative binomial random fields </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyvar</code></td>
<td>
<p>Logical; if <code>TRUE</code>  (and varest is  <code>TRUE</code>) only the variance covariance matrix is computed
without optimizing. <code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>String; the optimization algorithm
(see <code>optim</code> for details). <code>Nelder-Mead</code> is the
default. Other possible choices are <code>nlm</code>, <code>BFGS</code>, <code>SANN</code>, <code>L-BFGS-B</code> and <code>nlminb</code>. 
In these last two cases upper and lower bounds can be passed by the user. In the case
of one-dimensional optimization, the function <code>optimize</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical; if <code>TRUE</code> optmization is performed using optimParallel using the maximum number of cores,  when optimizer is  <code>L-BFGS-B</code>.<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Numeric; the radius of the sphere in the case of lon-lat coordinates.
The default is 6371, the radius of the earth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensitivity</code></td>
<td>
<p>Logical; if <code>TRUE</code> then  the sensitivy  matrix is computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>Logical; if <code>TRUE</code> then  maximum likelihood is computed
using sparse matrices algorithms (spam packake).It should be used
with compactly supported covariance models.<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>An optional named list with the initial values of the
parameters that are used by the numerical routines in maximization
procedure. <code>NULL</code> is the default (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taper</code></td>
<td>
<p>String; the name of the type of covariance matrix.
It can be <code>Standard</code> (the default value) or
<code>Tapering</code> for taperd covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tapsep</code></td>
<td>
<p>Numeric; an optional  value indicating the separabe parameter in the 
space time adaptive taper (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String; the type of the likelihood objects. If <code>Pairwise</code> (the
default) then the marginal composite likelihood is formed by
pairwise marginal likelihoods (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>An optional named list giving the values  for the upper bound 
of the space parameter when the optimizer is or <code>L-BFGS-B</code> or  <code>nlminb</code> or <code>optimize</code>. 
The names of the list must be the same of the names in the   <code>start</code> list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest</code></td>
<td>
<p>Logical; if <code>TRUE</code> the estimates' variances and
standard errors are returned. For composite likelihood estimation it is deprecated.
Use sensitivity TRUE and update the object using the function <code>GeoVarestbootstrap</code>
<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vartype</code></td>
<td>
<p>String; (<code>SubSamp</code> the default) the type of
method used for computing
the estimates' variances, see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Logical; if <code>TRUE</code> the likelihood objects are
weighted, see the Section <b>Details</b>. If <code>FALSE</code> (the
default) the composite likelihood is not weighted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winconst</code></td>
<td>
<p>Numeric; a bivariate positive vector for computing the spatial  sub-window
in the sub-sampling procedure. See <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winstp</code></td>
<td>
<p>Numeric; a value in <code class="reqn">(0,1]</code> for defining the the proportion of 
overlapping in the spatial  sub-sampling procedure. The case <code class="reqn">1</code> 
correspond to no overlapping. See <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winconst_t</code></td>
<td>
<p>Numeric; a positive value for computing the temporal sub-window
in the sub-sampling procedure. See <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winstp_t</code></td>
<td>
<p>Numeric; a value in <code class="reqn">(0,1]</code> for defining the the proportion of 
overlapping in the temporal  sub-sampling procedure. The case <code class="reqn">1</code> 
correspond to no overlapping. See <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric; Matrix of spatio(temporal)covariates in the linear mean specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosym</code></td>
<td>
<p>Logical; if TRUE simmetric weights are not considered. This allows a faster but less efficient CL estimation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spobj</code></td>
<td>
<p>An object of class sp or spacetime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spdata</code></td>
<td>
<p>Character:The name of data in the sp or spacetime object</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>GeoFit</code> provides  weighted composite likelihood  estimation based on pairs and independence composite likelihood estimation
for Gaussian and non Gaussian  random fields. Specifically, marginal and conditional  pairwise 
likelihood are considered for each type of random field (Gaussian and not Gaussian).
The optimization method is specified using <code>optimizer</code>. The default method is <code>Nelder-mead</code> and other available methods are <code>ucminf</code>, <code>nlm</code>, <code>BFGS</code>, <code>SANN</code>, <code>L-BFGS-B</code>,
and  <code>nlminb</code>. In the last two cases upper and lower bounds constraints in the optimization can be specified using <code>lower</code> and <code>upper</code> parameters.
</p>
<p>Depending on the dimension of <code>data</code> and on  the name of the correlation model, 
the observations   are assumed as a realization of
a spatial, spatio-temporal or bivariate random field.
Specifically, with <code>data</code>, <code>coordx</code>, <code>coordy</code>, <code>coordt</code> parameters:
</p>

<ul>
<li>
<p> If <code>data</code> is a numeric <code class="reqn">d</code>-dimensional vector, <code>coordx</code> and <code>coordy</code> are two
numeric <code class="reqn">d</code>-dimensional vectors (or <code>coordx</code> is (<code class="reqn">d \times 2</code>)-matrix and <code>coordy=NULL</code>), then the data are interpreted as a single spatial
realisation observed on <code class="reqn">d</code> spatial sites;
</p>
</li>
<li>
<p> If <code>data</code> is a numeric (<code class="reqn">t \times d</code>)-matrix, <code>coordx</code> and <code>coordy</code> are two
numeric <code class="reqn">d</code>-dimensional vectors (or <code>coordx</code> is (<code class="reqn">d \times 2</code>)-matrix and <code>coordy=NULL</code>),
<code>coordt</code> is a numeric <code class="reqn">t</code>-dimensional vector, then the data
are interpreted as a single spatial-temporal realisation of a random fields observed on <code>d</code> spatial sites and for <code>t</code> times.
</p>
</li>
<li>
<p> If <code>data</code> is a numeric (<code class="reqn">2 \times d</code>)-matrix, <code>coordx</code> and <code>coordy</code> are two
numeric <code class="reqn">d</code>-dimensional vectors (or <code>coordx</code> is (<code class="reqn">d \times 2</code>)-matrix and <code>coordy=NULL</code>), then the data
are interpreted as a single spatial realisation of a bivariate random fields observed on <code>d</code> spatial sites. 
</p>
</li>
<li>
<p> If <code>data</code> is a list,  <code>coordxdyn</code>  is a list and   <code>coordt</code> is a numeric <code class="reqn">t</code>-dimensional vector, then the data
are interpreted as a single spatial-temporal realisation of a random fields observed on dynamical spatial sites (different locations sites for each temporal instants) and for <code>t</code> times.
</p>
</li>
</ul>
<p>Is is also possible to specify a matrix of covariates using <code>X</code>.
Specifically:
</p>

<ul>
<li>
<p>  In the spatial case  <code>X</code> must be a (<code class="reqn">d \times k</code>) covariates matrix associated to  <code>data</code>  a numeric <code class="reqn">d</code>-dimensional vector;
</p>
</li>
<li>
<p>  In the spatiotemporal case  <code>X</code> must be a (<code class="reqn">N \times k</code>) covariates matrix associated to  <code>data</code>  a numeric (<code class="reqn">t \times d</code>)-matrix, where <code class="reqn">N=t\times d</code>;
</p>
</li>
<li>
<p>  In the spatiotemporal case  <code>X</code> must be a (<code class="reqn">N \times k</code>) covariates matrix associated to  <code>data</code>  a numeric (<code class="reqn">t \times d</code>)-matrix, where <code class="reqn">N=2\times d</code>;
</p>
</li>
</ul>
<p>The <code>corrmodel</code> parameter allows to select a specific correlation
function for the random fields. (See   <code>GeoCovmatrix</code> ).
</p>
<p>The <code>distance</code> parameter allows to consider differents kinds of spatial distances.
The settings alternatives are:
</p>

<ol>
<li> <p><code>Eucl</code>, the euclidean distance (default value);
</p>
</li>
<li> <p><code>Chor</code>, the chordal distance;
</p>
</li>
<li> <p><code>Geod</code>, the geodesic distance;
</p>
</li>
</ol>
<p>The <code>likelihood</code> parameter represents the composite-likelihood
configurations. The settings alternatives are:
</p>

<ol>
<li> <p><code>Conditional</code>, the composite-likelihood is formed by
conditionals likelihoods;
</p>
</li>
<li> <p><code>Marginal</code>, the composite-likelihood is formed by
marginals likelihoods (default value);
</p>
</li>
<li> <p><code>Full</code>, the composite-likelihood turns out to be the standard likelihood;
</p>
</li>
</ol>
<p>It must be coupled with the  <code>type</code> parameter that can be fixed to 
</p>

<ol>
<li> <p><code>Pairwise</code>, the composite-likelihood is based on pairs;
</p>
</li>
<li> <p><code>Independence</code>, the composite-likelihood is based on indepedence;
</p>
</li>
<li> <p><code>Standard</code>, this is the option for  the standard likelihood;
</p>
</li>
</ol>
<p>The possible combinations are:
</p>

<ol>
<li>  <p><code>likelihood="Marginal"</code> and <code>type="Pairwise"</code> for  maximum marginal pairwise likelihood estimation (the default setting)
</p>
</li>
<li>  <p><code>likelihood="Conditional"</code> and <code>type="Pairwise"</code> for maximum  conditional pairwise likelihood estimation
</p>
</li>
<li>  <p><code>likelihood="Marginal"</code> and <code>type="Independence"</code> for  maximum independence composite likelihood estimation
</p>
</li>
<li>  <p><code>likelihood="Full"</code> and <code>type="Standard"</code> for  maximum stardard likelihood estimation 
</p>
</li>
</ol>
<p>The first three combinations can be used for any model. The standard likelihood can be used only for some specific model.
</p>
<p>The <code>model</code> parameter indicates the type of random field
considered. The available options are:
</p>
<p>random fields with marginal symmetric distribution:
</p>

<ul>
<li> <p><code>Gaussian</code>, for a Gaussian random field.   
</p>
</li>
<li> <p><code>StudentT</code>, for a StudentT random field (see  Bevilacqua M., Caamaño C., Arellano Valle R.B., Morales-Oñate V., 2020).
</p>
</li>
<li> <p><code>Tukeyh</code>, for a Tukeyh random field.
</p>
</li>
<li> <p><code>Tukeyh2</code>, for a Tukeyhh random field. (see Caamaño et al., 2023)
</p>
</li>
<li> <p><code>Logistic</code>, for a Logistic random field.
</p>
</li>
</ul>
<p>random fields with positive values and  right skewed marginal distribution:
</p>

<ul>
<li> <p><code>Gamma</code> for a Gamma  random fields (see  Bevilacqua M., Caamano C.,  Gaetan, 2020)
</p>
</li>
<li> <p><code>Weibull</code> for a Weibull  random fields (see  Bevilacqua M., Caamano C.,  Gaetan, 2020)
</p>
</li>
<li> <p><code>LogGaussian</code> for a  LogGaussian  random fields (see  Bevilacqua M., Caamano C.,  Gaetan, 2020)
</p>
</li>
<li> <p><code>LogLogistic</code> for a  LogLogistic random fields. 
</p>
</li>
</ul>
<p>random fields with with possibly asymmetric marginal distribution:
</p>

<ul>
<li> <p><code>SkewGaussian</code> for a skew Gaussian  random field (see   Alegrıa et al. (2017)).
</p>
</li>
<li> <p><code>SinhAsinh</code> for a Sinh-arcsinh  random field  (see Blasi et. al 2022).
</p>
</li>
<li> <p><code>TwopieceGaussian</code> for a Twopiece Gaussian random field   (see Bevilacqua et. al 2022).
</p>
</li>
<li> <p><code>TwopieceTukeyh</code> for a Twopiece Tukeyh random field   (see Bevilacqua et. al 2022).
</p>
</li>
</ul>
<p>random fields with for directional data
</p>
   
<ul><li> <p><code>Wrapped</code> for a wrapped Gaussian  random field (see  Alegria A., Bevilacqua, M., Porcu, E. (2016))
</p>
</li></ul>
<p>random fields with marginal counts data
</p>
  
<ul>
<li> <p><code>Poisson</code> for a Poisson  random field (see Morales-Navarrete et. al 2021).
</p>
</li>
<li> <p><code>PoissonZIP</code> for a zero inflated Poisson  random field (see Morales-Navarrete et. al 2021).
</p>
</li>
<li> <p><code>Binomial</code> for a Binomial  random field.
</p>
</li>
<li> <p><code>BinomialNeg</code> for a negative Binomial random field.
</p>
</li>
<li> <p><code>BinomialNegZINB</code> for a zero inflated negative Binomial random field.
</p>
</li>
</ul>
<p>random fields using Gaussian and Clayton copula (see Bevilacqua, Alvarado  and Caamaño, 2023) with the following marginal distribution:
</p>
   
<ul>
<li> <p><code>Gaussian</code> for Gaussian random field.
</p>
</li>
<li> <p><code>Beta2</code>  for Beta   random field.
</p>
</li>
</ul>
<p>For  a given <code>model</code> the associated parameters are given by nuisance and correlation parameters. In order to obtain the nuisance parameters associated with a specific model use <code>NuisParam</code>. 
In order to obtain the correlation parameters associated with a given correlation model use 
<code>CorrParam</code>.
</p>
<p>All the nuisance and covariance parameters must be specified
by the user using  the  <code>start</code>  and  the <code>fixed</code> parameter.
Specifically:
</p>
<p>The option <code>start</code> sets the starting values  parameters in the optimization process for the parameters  to be estimated.
The option <code>fixed</code> parameter allows to fix  some of the parameters.
</p>
<p>Regression parameters in the linear specification must be specified as <code>mean,mean1,..meank</code> (see <code>NuisParam</code>).
In this case a matrix of covariates with suitable dimension must be specified using   <code>X</code>. 
In the case of a single mean then <code>X</code> should not be specified and it is interpreted as a vector of ones.
It is also possible to fix a vector of spatial or spatio-temporal means (estimated with other methods for instance).
</p>
<p>Two types  of binary weights can be used in  the weighted composite likelihood estimation based on pairs,
one based on neighboords and one based on distances.
</p>
<p>In the first  case  binary weights are set to 1 or 0 depending if the pairs are neighboords of a certain order (1, 2, 3, ..) specified by the parameter (<code>neighb</code>). This weighting scheme is effecient for large-data sets since the computation of the 'useful' pairs  in based on  fast nearest neighbour 
search (Caamaño et al., 2023).
</p>
<p>In the second case, binary weights are set to 1 or 0 depending if the pairs have distance lower than  (<code>maxdist</code>).
This weighting scheme is less inefficient for large data.
The same arguments of <code>neighb</code> applies  for <code>maxtime</code> that sets
the  order (1, 2, 3, ..) of temporal neighboords in spatial-temporal field.
</p>
<p>For estimation of the variance-covariance matrix of  the  weighted composite likelihood  estimates
the option <code>sensitivity=TRUE</code> must be specified. Then the  <code>GeoFit</code>  object  must be updated   using the function <code>GeoVarestbootstrap</code>. This allows to estimate  the Godambe Information matrix  (see  Bevilacqua et. al. (2012) , Bevilacqua and Gaetan (2013)).
Then standard error estimation, confidence intervals,  pvalues  and composite likelihood information critera can be obtained.
</p>
<p>The option  <code>varest=TRUE</code>  is deprecated.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>GeoFit</code>.
An object of class <code>GeoFit</code> is a list containing
at most the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bivariate</code></td>
<td>
<p>Logical:<code>TRUE</code> if the Gaussian random fields is bivariate, otherwise  <code>FALSE</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clic</code></td>
<td>
<p>The composite information criterion, if the full
likelihood is considered then it coincides with the Akaike information
criterion;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordy</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordt</code></td>
<td>
<p>A <code class="reqn">t</code>-dimensional vector of temporal coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx_dyn</code></td>
<td>
<p>A  list of dynamical (in time) spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>Confidence intervals for  standard maximum likelihood estimation;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>A string that denotes if convergence is reached;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>The type of copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrmodel</code></td>
<td>
<p>The correlation model;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The vector or matrix or array of data;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The type of spatial distance;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A list of the  fixed parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>The number of iteration used by the numerical routine;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>The configuration of the composite likelihood;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logCompLik</code></td>
<td>
<p>The value of the log composite-likelihood at the maximum;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>The maximum spatial distance used in the weigthed composite likelihood. 
If no spatial distance is specified then it is NULL;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>The 
order of temporal neighborhood  in the composite likelihood
computation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>Extra message passed from the numerical routines;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The density associated to the likelihood objects;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missp</code></td>
<td>
<p>True if a misspecified  Gaussian model is ued in  the composite likelihhod;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of trials in a binominal random fields;the number of successes in a  negative Binomial random fieldss;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighb</code></td>
<td>
<p>The 
order of spatial neighborhood  in the composite likelihood
computation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>The number of (different) location sites in the bivariate case;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nozero</code></td>
<td>
<p>In the case of tapered likelihood  the percentage of non zero values in the covariance matrix.
Otherwise is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numcoord</code></td>
<td>
<p>The number of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numtime</code></td>
<td>
<p>The number of the temporal realisations of the random fields;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A list of the   parameters' estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>The radius of the sphere in the case of great  circle distance;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderr</code></td>
<td>
<p>The vector of standard errors for  standard maximum likelihood estimation;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensmat</code></td>
<td>
<p>The sensitivity matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>
<p>The matrix of the variance-covariance of the estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varimat</code></td>
<td>
<p>The variability matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vartype</code></td>
<td>
<p>The method used to compute the variance of the estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of the likelihood objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winconst</code></td>
<td>
<p>The constant used to compute the window size in the
spatial sub-sampling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winstp</code></td>
<td>
<p>The step used for moving the window in the spatial sub-sampling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winconst_t</code></td>
<td>
<p>The constant used to compute the window size in the
spatio-temporal sub-sampling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winstp_</code></td>
<td>
<p>The step used for moving the window in the spatio-temporal sub-sampling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The matrix of covariates;</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Moreno Bevilacqua, <a href="mailto:moreno.bevilacqua89@gmail.com">moreno.bevilacqua89@gmail.com</a>,<a href="https://sites.google.com/view/moreno-bevilacqua/home">https://sites.google.com/view/moreno-bevilacqua/home</a>,
Víctor Morales Oñate, <a href="mailto:victor.morales@uv.cl">victor.morales@uv.cl</a>, <a href="https://sites.google.com/site/moralesonatevictor/">https://sites.google.com/site/moralesonatevictor/</a>,
Christian", Caamaño-Carrillo, <a href="mailto:chcaaman@ubiobio.cl">chcaaman@ubiobio.cl</a>,<a href="https://www.researchgate.net/profile/Christian-Caamano">https://www.researchgate.net/profile/Christian-Caamano</a>
</p>


<h3>References</h3>

<p><b>General Composite-likelihood</b>:
</p>
<p>Varin, C., Reid, N. and Firth, D. (2011). An Overview of Composite
Likelihood Methods. <em>Statistica Sinica</em>, <b>21</b>, 5–42.
</p>
<p>Varin, C. and Vidoni, P. (2005)
A Note on Composite Likelihood Inference and Model Selection.
<em>Biometrika</em>, <b>92</b>, 519–528.
</p>
<p><b>Non Gaussian random fields</b>: 
</p>
<p>Alegrıa A., Caro S., Bevilacqua M., Porcu E., Clarke J. (2017) <em>Estimating covariance functions of multivariate skew-Gaussian random fields on the sphere</em>. Spatial Statistics <b>22</b> 388-402
</p>
<p>Alegria A., Bevilacqua, M., Porcu, E. (2016) 
Likelihood-based inference for multivariate space-time wrapped-Gaussian fields. 
<em>Journal of Statistical Computation and Simulation</em>. <b>86(13)</b>, 2583–2597.
</p>
<p>Bevilacqua M., Caamano C.,  Gaetan C. (2020) On modeling positive continuous data with spatio-temporal dependence.  <em>Environmetrics</em>   <b>31(7)</b>
</p>
<p>Bevilacqua M., Caamaño C., Arellano Valle R.B., Morales-Oñate V.  (2020) Non-Gaussian Geostatistical Modeling using (skew) t Processes. <em>Scandinavian Journal of Statistics</em>.
</p>
<p>Blasi F., Caamaño C., Bevilacqua M., Furrer R. (2022) A selective view of climatological data and likelihood estimation  <em>Spatial Statistics</em>   10.1016/j.spasta.2022.100596
</p>
<p>Bevilacqua M., Caamaño C., Arellano-Valle R. B., Camilo Gomez C. (2022) A class of random fields with two-piece marginal distributions for modeling point-referenced data with spatial outliers. <em>Test</em>  10.1007/s11749-021-00797-5
</p>
<p>Morales-Navarrete D., Bevilacqua M., Caamaño C., Castro  L.M. (2022) Modelling Point Referenced Spatial Count Data: A Poisson Process Approach   <em>TJournal of the American Statistical Association</em> To appear
</p>
<p>Caamaño C., Bevilacqua M., López C., Morales-Oñate V. (2023) Nearest neighbours weighted composite likelihood based on pairs for (non-)Gaussian massive spatial data with an application to Tukey-hh random fields estimation  <em>Computational Statistics and Data Analysis</em> To appear
</p>
<p>Bevilacqua M., Alvarado E., Caamaño C., (2023) A flexible Clayton-like spatial copula with application to bounded support data <em>Journal of Multivariate Analysis</em> To appear 
</p>
<p><b>Weighted Composite-likelihood for (non-)Gaussian random fields</b>:
</p>
<p>Bevilacqua, M. Gaetan, C., Mateu, J. and Porcu, E. (2012)
Estimating space and space-time covariance functions for large data
sets: a weighted composite likelihood approach.
<em>Journal of the American Statistical Association, Theory &amp;
Methods</em>, <b>107</b>, 268–280.
</p>
<p>Bevilacqua, M., Gaetan, C. (2015) Comparing composite likelihood methods based on pairs for spatial Gaussian random fields.  <em>Statistics and Computing</em>, <b>25(5)</b>,  877-892.
</p>
<p>Caamaño C., Bevilacqua M., López C., Morales-Oñate V. (2023) Nearest neighbours weighted composite likelihood based on pairs for (non-)Gaussian massive spatial data with an application to Tukey-hh random fields estimation  <em>Computational Statistics and Data Analysis</em> To appear
</p>
<p><b>Sub-sampling estimation</b>:
</p>
<p>Heagerty, P. J. and Lumley T. (2000) Window Subsampling of Estimating
Functions with Application to Regression Models.
<em>Journal of the American Statistical Association, Theory &amp;
Methods</em>, <b>95</b>, 197–211.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(GeoModels)

###############################################################
############ Examples of spatial Gaussian random fieldss ################
###############################################################


# Define the spatial-coordinates of the points:
set.seed(3)
N=300  # number of location sites
x &lt;- runif(N, 0, 1)
y &lt;- runif(N, 0, 1)
coords &lt;- cbind(x,y)

# Define spatial matrix covariates and regression parameters
X=cbind(rep(1,N),runif(N))
mean &lt;- 0.2
mean1 &lt;- -0.5

# Set the covariance model's parameters:
corrmodel &lt;- "Matern"
sill &lt;- 1
nugget &lt;- 0
scale &lt;- 0.2/3
smooth=0.5


param&lt;-list(mean=mean,mean1=mean1,sill=sill,nugget=nugget,scale=scale,smooth=smooth)

# Simulation of the spatial Gaussian random fields:
data &lt;- GeoSim(coordx=coords,corrmodel=corrmodel, param=param,X=X)$data



################################################################
###
### Example 0. Maximum independence composite likelihood fitting of
### a Gaussian random fields (no dependence parameters)
### 
###############################################################
# setting starting parameters to be estimated
start&lt;-list(mean=mean,mean1=mean1,sill=sill)

fit1 &lt;- GeoFit(data=data,coordx=coords,likelihood="Marginal",
                    type="Independence", start=start,X=X)
print(fit1)


################################################################
###
### Example 1. Maximum conditional pairwise likelihood fitting of
### a Gaussian random fields using BFGS
### 
###############################################################
# setting fixed and starting parameters to be estimated
fixed&lt;-list(nugget=nugget,smooth=smooth)
start&lt;-list(mean=mean,mean1=mean1,scale=scale,sill=sill)

fit1 &lt;- GeoFit(data=data,coordx=coords,corrmodel=corrmodel, 
                    neighb=3,likelihood="Conditional",optimizer="BFGS",
                    type="Pairwise", start=start,fixed=fixed,X=X)
print(fit1)

################################################################
###
### Example 2. Standard Maximum likelihood fitting of
### a Gaussian random fields using nlminb
###
###############################################################
# Define the spatial-coordinates of the points:
set.seed(3)
N=250  # number of location sites
x &lt;- runif(N, 0, 1)
y &lt;- runif(N, 0, 1)
coords &lt;- cbind(x,y)

param&lt;-list(mean=mean,sill=sill,nugget=nugget,scale=scale,smooth=smooth)

data &lt;- GeoSim(coordx=coords,corrmodel=corrmodel, param=param)$data

# setting fixed and parameters to be estimated
fixed&lt;-list(nugget=nugget,smooth=smooth)
start&lt;-list(mean=mean,scale=scale,sill=sill)

I=Inf
lower&lt;-list(mean=-I,scale=0,sill=0)
upper&lt;-list(mean=I,scale=I,sill=I)
fit2 &lt;- GeoFit(data=data,coordx=coords,corrmodel=corrmodel,
                    optimizer="nlminb",upper=upper,lower=lower,
                    likelihood="Full",type="Standard", 
                    start=start,fixed=fixed)
print(fit2)


###############################################################
############ Examples of spatial non-Gaussian random fieldss #############
###############################################################


################################################################
###
### Example 3. Maximum pairwise likelihood fitting of a Weibull  random fields 
### with Generalized Wendland correlation with Nelder-Mead
### 
###############################################################
set.seed(524)
# Define the spatial-coordinates of the points:
N=300
x &lt;- runif(N, 0, 1)
y &lt;- runif(N, 0, 1)
coords &lt;- cbind(x,y)
X=cbind(rep(1,N),runif(N))
mean=1; mean1=2 # regression parameters
nugget=0
shape=2
scale=0.2
smooth=0

model="Weibull"
corrmodel="GenWend"
param=list(mean=mean,mean1=mean1,scale=scale,
                     shape=shape,nugget=nugget,power2=4,smooth=smooth)
# Simulation of a  non stationary weibull random fields:
data &lt;- GeoSim(coordx=coords, corrmodel=corrmodel,model=model,X=X,
           param=param)$data


fixed&lt;-list(nugget=nugget,power2=4,smooth=smooth)
start&lt;-list(mean=mean,mean1=mean1,scale=scale,shape=shape)

# Maximum independence likelihood:
fit &lt;- GeoFit(data=data, coordx=coords, X=X, 
           likelihood="Marginal",type="Independence", corrmodel=corrmodel,
         ,model=model, start=start, fixed=fixed)
print(unlist(fit$param))

## estimating  dependence parameter fixing vector mean   parameter
Xb=as.numeric(X %*% c(mean,mean1))
fixed&lt;-list(nugget=nugget,power2=4,smooth=smooth,mean=Xb)
start&lt;-list(scale=scale,shape=shape)

# Maximum conditional composite-likelihood fitting of the random fields:
fit1 &lt;- GeoFit(data=data,coordx=coords,corrmodel=corrmodel, model=model,
                    neighb=3,likelihood="Conditional",type="Pairwise",
                    optimizer="Nelder-Mead",
                    start=start,fixed=fixed)
print(unlist(fit1$param))



### joint estimation  of the dependence parameter and  mean   parameters
fixed&lt;-list(nugget=nugget,power2=4,smooth=smooth)
start&lt;-list(mean=mean,mean1=mean1,scale=scale,shape=shape)
fit2 &lt;- GeoFit(data=data,coordx=coords,corrmodel=corrmodel, model=model,
                    neighb=3,likelihood="Conditional",type="Pairwise",X=X,
                    optimizer="Nelder-Mead",
                    start=start,fixed=fixed)
print(unlist(fit2$param))



################################################################
###
### Example 4. Maximum pairwise likelihood fitting of
### a SinhAsinh-Gaussian spatial  random fields with Wendland correlation
###
###############################################################
set.seed(261)
model="SinhAsinh"
# Define the spatial-coordinates of the points:
x &lt;- runif(500, 0, 1)
y &lt;- runif(500, 0, 1)
coords &lt;- cbind(x,y)

corrmodel="Wend0"
mean=0;nugget=0
sill=1
skew=-0.5
tail=1.5
power2=4
c_supp=0.2

# model parameters
param=list(power2=power2,skew=skew,tail=tail,
             mean=mean,sill=sill,scale=c_supp,nugget=nugget)
data &lt;- GeoSim(coordx=coords, corrmodel=corrmodel,model=model, param=param)$data

plot(density(data))
fixed=list(power2=power2,nugget=nugget)
start=list(scale=c_supp,skew=skew,tail=tail,mean=mean,sill=sill)
# Maximum marginal pairwise likelihood:
fit1 &lt;- GeoFit(data=data,coordx=coords,corrmodel=corrmodel, model=model,
                    neighb=3,likelihood="Marginal",type="Pairwise",
                    start=start,fixed=fixed)
print(unlist(fit1$param))


################################################################
###
### Example 5. Maximum pairwise likelihood fitting of 
### a Binomial random fields with exponential correlation 
###
###############################################################

set.seed(422)
N=250
x &lt;- runif(N, 0, 1)
y &lt;- runif(N, 0, 1)
coords &lt;- cbind(x,y)
mean=0.1; mean1=0.8; mean2=-0.5 # regression parameters
X=cbind(rep(1,N),runif(N),runif(N)) # marix covariates
corrmodel &lt;- "Wend0"
param=list(mean=mean,mean1=mean1,mean2=mean2,nugget=0,scale=0.2,power2=4)
# Simulation of the spatial Binomial-Gaussian random fields:
data &lt;- GeoSim(coordx=coords, corrmodel=corrmodel, model="Binomial", n=10,X=X,
             param=param)$data


## estimating the marginal parameters using independence cl
fixed &lt;- list(power2=4,scale=0.2,nugget=0)
start &lt;- list(mean=mean,mean1=mean1,mean2=mean2)

# Maximum independence likelihood:
fit &lt;- GeoFit(data=data, coordx=coords,n=10, X=X, 
           likelihood="Marginal",type="Independence",corrmodel=corrmodel,
         ,model="Binomial", start=start, fixed=fixed)
                  
print(fit)


## estimating  dependence parameter fixing vector mean   parameter
Xb=as.numeric(X %*% c(mean,mean1,mean2))
fixed &lt;- list(nugget=0,power2=4,mean=Xb)
start &lt;- list(scale=0.2)

# Maximum conditional pairwise likelihood:
fit1 &lt;- GeoFit(data=data, coordx=coords, corrmodel=corrmodel,n=10, 
          likelihood="Conditional",type="Pairwise",  neighb=3
         ,model="Binomial", start=start, fixed=fixed)
                  
print(fit1)


## estimating jointly marginal   and dependnce parameters
fixed &lt;- list(nugget=0,power2=4)
start &lt;- list(mean=mean,mean1=mean1,mean2=mean2,scale=0.2)

# Maximum conditional pairwise likelihood:
fit2 &lt;- GeoFit(data=data, coordx=coords, corrmodel=corrmodel,n=10, X=X, 
          likelihood="Conditional",type="Pairwise",  neighb=3
         ,model="Binomial", start=start, fixed=fixed)
                  
print(fit2)


###############################################################
######### Examples of Gaussian spatio-temporal random fieldss ###########
###############################################################
set.seed(52)
# Define the temporal sequence:
time &lt;- seq(1, 9, 1)

# Define the spatial-coordinates of the points:
x &lt;- runif(20, 0, 1)
y &lt;- runif(20, 0, 1)
coords=cbind(x,y)

# Set the covariance model's parameters:
scale_s=0.2/3;scale_t=1
smooth_s=0.5;smooth_t=0.5
sill=1
nugget=0
mean=0

param&lt;-list(mean=0,scale_s=scale_s,scale_t=scale_t,
 smooth_t=smooth_t, smooth_s=smooth_s ,sill=sill,nugget=nugget)

# Simulation of the spatial-temporal Gaussian random fields:
data &lt;- GeoSim(coordx=coords,coordt=time,corrmodel="Matern_Matern",
              param=param)$data

################################################################
###
### Example 6. Maximum pairwise likelihood fitting of a
### space time Gaussian random fields with double-exponential correlation
###
###############################################################
# Fixed parameters
fixed&lt;-list(nugget=nugget,smooth_s=smooth_s,smooth_t=smooth_t)
# Starting value for the estimated parameters
start&lt;-list(mean=mean,scale_s=scale_s,scale_t=scale_t,sill=sill)

# Maximum composite-likelihood fitting of the random fields:
fit &lt;- GeoFit(data=data,coordx=coords,coordt=time,
                    corrmodel="Matern_Matern",maxtime=1,neighb=3,
                    likelihood="Marginal",type="Pairwise",
                     start=start,fixed=fixed)
print(fit)



###############################################################
######### Examples of a bivariate Gaussian  random fields ###########
###############################################################

################################################################
### Example 7. Maximum pairwise  likelihood fitting of a
### bivariate Gaussian random fields with separable Bivariate  matern 
### (cross) correlation model 
###############################################################

# Define the spatial-coordinates of the points:
set.seed(89)
x &lt;- runif(300, 0, 1)
y &lt;- runif(300, 0, 1)
coords=cbind(x,y)
# parameters
param=list(mean_1=0,mean_2=0,scale=0.1,smooth=0.5,sill_1=1,sill_2=1,
           nugget_1=0,nugget_2=0,pcol=0.2)

# Simulation of a spatial bivariate Gaussian random fields:
data &lt;- GeoSim(coordx=coords, corrmodel="Bi_Matern_sep", 
              param=param)$data

# selecting fixed and estimated parameters
fixed=list(mean_1=0,mean_2=0,nugget_1=0,nugget_2=0,smooth=0.5)
start=list(sill_1=var(data[1,]),sill_2=var(data[2,]),
           scale=0.1,pcol=cor(data[1,],data[2,]))


# Maximum marginal pairwise likelihood
fitcl&lt;- GeoFit(data=data, coordx=coords, corrmodel="Bi_Matern_sep",
                     likelihood="Marginal",type="Pairwise",
                     optimizer="BFGS" , start=start,fixed=fixed,
                     neighb=c(4,4,4))
print(fitcl)

</code></pre>


</div>