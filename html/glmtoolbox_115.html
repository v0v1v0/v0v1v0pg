<div class="container">

<table style="width: 100%;"><tr>
<td>wglmgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Weighted Generalized Estimating Equations</h2>

<h3>Description</h3>

<p>Produces an object of the class <code>wglmgee</code> in which the main results of a Weighted Generalized Estimating Equation (WGEE) fitted to the data are stored.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wglmgee(
  formula,
  level = c("observations", "clusters"),
  family = gaussian(),
  weights,
  id,
  data,
  subset,
  corstr,
  corr,
  start = NULL,
  scale.fix = FALSE,
  scale.value = 1,
  toler = 1e-05,
  maxit = 50,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an <code>Formula</code> expression of the form <code>response ~ x1 + x2 + ... | z1 + z2 + ...</code>, whose first part is a symbolic description of the linear predictor of the GEE model to be fitted to the data, whereas the second part is a symbolic description of the linear predictor of the logistic model to be used to calculate the missingness probabilities under the MAR assumption. Then, those probabilities are used to computed the weights to be included in the parameter estimation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an (optional) character string which allows to specify the weighted GEE method. The available options are: "observations" and "clusters" for Observation- and Cluster-specified Weighted GEE, respectively. As default, <em>level</em> is set to "observations".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>an (optional) <code>family</code> object, that is, a list of functions and expressions for defining link and variance functions. Families (and links) supported are the same supported by glm using its family argument, that is,
<code>gaussian</code>, <code>binomial</code>, <code>poisson</code>, <code>Gamma</code>, <code>inverse.gaussian</code>, and <code>quasi</code>. The family <code>negative.binomial</code> in the library <span class="pkg">MASS</span> are also available. As default, the argument <code>family</code> is set to <code>gaussian(identity)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an (optional) vector of positive "prior weights" to be used in the fitting process. The length of <code>weights</code> should be the same as the total number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>a vector which identifies the subjects or clusters. The length of <code>id</code> should be the same as the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression, as well as for variables specified in the arguments <code>id</code> and <code>weights</code>. The data are assumed to be sorted by <code>id</code> and time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>an (optional) character string which allows to specify the working-correlation structure. The available options are: "Independence", "Unstructured", "Stationary-M-dependent(<em>m</em>)", "Non-Stationary-M-dependent(<em>m</em>)", "AR-M-dependent(<em>m</em>)", "Exchangeable" and "User-defined", where <em>m</em> represents the lag of the dependence. As default, <code>corstr</code> is set to "Independence".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>an (optional) square matrix of the same dimension of the maximum cluster size containing the user specified correlation. This is only appropriate if <code>corstr</code> is specified to be "User-defined".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an (optional) vector of starting values for the parameters in the linear predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.fix</code></td>
<td>
<p>an (optional) logical variable. If TRUE, the scale parameter is fixed at the value of <code>scale.value</code>. As default, <code>scale.fix</code> is set to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.value</code></td>
<td>
<p>an (optional) numeric value at which the scale parameter should be fixed. This is only appropriate if <code>scale.fix=TRUE</code>. As default, <code>scale.value</code> is set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toler</code></td>
<td>
<p>an (optional) positive value which represents the <em>convergence tolerance</em>. The convergence is reached when the maximum of the absolute relative differences between the values of the parameters in the linear predictor in consecutive iterations of the fitting algorithm is lower than <code>toler</code>. As default, <code>toler</code> is set to 0.00001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an (optional) integer value which represents the maximum number of iterations allowed for the fitting algorithm. As default, <code>maxit</code> is set to 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>an (optional) logical variable. If TRUE, output is produced for each iteration of the estimating algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The values of the multivariate response variable measured on <code class="reqn">n</code> subjects or clusters,
denoted by <code class="reqn">y_{i}=(y_{i1},\ldots,y_{in_i})^{\top}</code> for <code class="reqn">i=1,\ldots,n</code>, are assumed to be
realizations of independent random vectors denoted by <code class="reqn">Y_{i}=(Y_{i1},\ldots,Y_{in_i})^{\top}</code>
for <code class="reqn">i=1,\ldots,n</code>. The random variables associated to the <code class="reqn">i</code>-th subject or
cluster, <code class="reqn">Y_{ij}</code> for <code class="reqn">j=1,\ldots,n_i</code>, are assumed to satisfy
<code class="reqn">\mu_{ij}=</code> E<code class="reqn">(Y_{ij})</code>,Var<code class="reqn">(Y_{ij})=\frac{\phi}{\omega_{ij}}</code>V<code class="reqn">(\mu_{ij})</code>
and Corr<code class="reqn">(Y_{ij},Y_{ik})=r_{jk}(\rho)</code>,
where <code class="reqn">\phi&gt;0</code> is the dispersion parameter,
V<code class="reqn">(\mu_{ij})</code> is the variance function, <code class="reqn">\omega_{ij}&gt;0</code> is a known weight, and
<code class="reqn">\rho=(\rho_1,\ldots,\rho_q)^{\top}</code> is a parameter vector.
In addition, <code class="reqn">\mu_{ij}</code> is assumed to be dependent on the regressors vector <code class="reqn">x_{ij}</code>
by <code class="reqn">g(\mu_{ij})=z_{ij} + x_{ij}^{\top}\beta</code>, where <code class="reqn">g(\cdot)</code> is the link function,
<code class="reqn">z_{ij}</code> is a known <em>offset</em> and <code class="reqn">\beta=(\beta_1,\ldots,\beta_p)^{\top}</code> is
a vector of regression parameters. The probabilities <code class="reqn">Pr[T_{ij}=1|T_{i,j-1}=1,x_{i1},\ldots,x_{ij},Y_{i1},\ldots,Y_{i,j-1}]</code>
are estimated by using a logistic model whose covariates are given by <code class="reqn">z_{1},\ldots,z_{r}</code>. Then, those
probabilities are used to computed the weights to be included in the parameter estimation algorithm.
</p>
<p>A set of standard extractor functions for fitted model objects is available for objects of class  <em>glmgee</em>,
including methods to the generic functions such as <code>print</code>, <code>summary</code>,	<code>model.matrix</code>, <code>estequa</code>,
<code>coef</code>, <code>vcov</code>, <code>fitted</code>, <code>confint</code> and <code>predict</code>. The input data are assumed to be ordered
in time within each cluster.
</p>


<h3>Value</h3>

<p>an object of class <em>wglmgee</em> in which the main results of the weighted GEE model fitted to the data are stored,
i.e., a list with components including
</p>

<table>
<tr>
<td style="text-align: left;">
<code>coefficients</code> </td>
<td style="text-align: left;"> a vector with the estimates of <code class="reqn">\beta_1,\ldots,\beta_p</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>fitted.values</code>
</td>
<td style="text-align: left;"> a vector with the estimates of <code class="reqn">\mu_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>start</code>        </td>
<td style="text-align: left;"> a vector with the starting values used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>iter</code>         </td>
<td style="text-align: left;"> a numeric constant with the number of iterations,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>prior.weights</code>
</td>
<td style="text-align: left;"> a vector with the values of <code class="reqn">\omega_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>offset</code>       </td>
<td style="text-align: left;"> a vector with the values of <code class="reqn">z_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>terms</code>        </td>
<td style="text-align: left;"> an object containing the terms objects,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>estfun</code>       </td>
<td style="text-align: left;"> a vector with the estimating equations evaluated at the parameter</td>
</tr>
<tr>
<td style="text-align: left;">
                    </td>
<td style="text-align: left;"> estimates and the observed data,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>formula</code>      </td>
<td style="text-align: left;"> the formula,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>levels</code>       </td>
<td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>contrasts</code>    </td>
<td style="text-align: left;"> an object containing the contrasts corresponding to levels,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>converged</code>    </td>
<td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>model</code>        </td>
<td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>y</code>            </td>
<td style="text-align: left;"> a vector with the values of <code class="reqn">y_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>family</code>       </td>
<td style="text-align: left;"> an object containing the family object used,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>linear.predictors</code> </td>
<td style="text-align: left;"> a vector with the estimates of <code class="reqn">g(\mu_{ij})</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>R</code>            </td>
<td style="text-align: left;"> a matrix with the (robust) estimate of the variance-covariance,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>corr</code>         </td>
<td style="text-align: left;"> a matrix with the estimate of the working-correlation,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>corstr</code>       </td>
<td style="text-align: left;"> a character string specifying the working-correlation structure,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>level</code>        </td>
<td style="text-align: left;"> a character string specifying the weighted GEE method,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>id</code>           </td>
<td style="text-align: left;"> a vector which identifies the subjects or clusters,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>sizes</code>        </td>
<td style="text-align: left;"> a vector with the values of <code class="reqn">n_i</code> for <code class="reqn">i=1,\ldots,n</code>,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>call</code>         </td>
<td style="text-align: left;"> the original function call,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Fitzmaurice G.M., Laird N.M., Ware J.H. (2011). <em>Applied Longitudinal Analysis. 2nd ed.</em> John Wiley &amp; Sons.
</p>
<p>Preisser J.S., Lohman K.K., Rathouz P.J. (2002). Performance of Weighted Estimating Equations for
Longitudinal Binary Data with Drop-Outs Missing at Random. <em>Statistics in Medicine</em> 21:3035–3054.
</p>
<p>Robins J.M., Rotnitzky A., Zhao L.P. (1995) Analysis of Semiparametric Regression Models for Repeated
Outcomes in the Presence of Missing Data. <em>Journal of the American Statistical Association</em> 90:122–129.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p>glmgee, gnmgee
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example: Amenorrhea rates over time
data(amenorrhea)
amenorrhea2 &lt;- within(amenorrhea,{
							 Ctime &lt;- factor(Time)
							 Ctime &lt;- relevel(Ctime,ref="1")
							 ylag1 &lt;- c(0,amenorrhea[-length(ID)])
							 ylag1 &lt;- ifelse(Time==0,0,ylag1)})

mod &lt;- amenorrhea ~ poly(Time,2) + Dose | Ctime + Dose + ylag1

### Observation-specified Weighted GEE
fit1 &lt;- wglmgee(mod, family=binomial, data=amenorrhea2, id=ID,
                corstr="AR-M-dependent(1)", level="observations")
summary(fit1)

### Cluster-specified Weighted GEE
fit2 &lt;- wglmgee(mod, family=binomial, data=amenorrhea2, id=ID,
                corstr="Exchangeable", level="clusters")
summary(fit2)

</code></pre>


</div>