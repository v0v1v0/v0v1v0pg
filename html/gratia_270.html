<div class="container">

<table style="width: 100%;"><tr>
<td>simulate.gam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate from the posterior distribution of a GAM</h2>

<h3>Description</h3>

<p>Simulations from the posterior distribution of a fitted GAM model involve
computing predicted values for the observation data for which simulated
data are required, then generating random draws from the probability
distribution used when fitting the model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gam'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  data = newdata,
  weights = NULL,
  ...,
  newdata = NULL
)

## S3 method for class 'gamm'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  data = newdata,
  weights = NULL,
  ...,
  newdata = NULL
)

## S3 method for class 'scam'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  data = newdata,
  weights = NULL,
  ...,
  newdata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted GAM, typically the result of a call to mgcv::gam'
or <code>mgcv::gamm()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>numeric; the number of posterior simulations to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>numeric; a random seed for the simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame; new observations at which the posterior draws
from the model should be evaluated. If not supplied, the data used to fit
the model will be used for <code>newdata</code>, if available in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>numeric; a vector of prior weights. If <code>newdata</code> is null
then defaults to <code>object[["prior.weights"]]</code>, otherwise a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to methods. <code>simulate.gam()</code> and
<code>simulate.scam()</code> pass <code>...</code> on to <code>predict.gam()</code>. As such you can pass
additional arguments such as <code>terms</code>, <code>exclude</code>, to select which model
terms are included in the predictions. This may be useful, for example,
for excluding the effects of random effect terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Deprecated. Use <code>data</code> instead.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>simulate.gam()</code> to function, the <code>family</code> component of the fitted
model must contain, or be updateable to contain, the required random
number generator. See <code>mgcv::fix.family.rd()</code>.
</p>


<h3>Value</h3>

<p>(Currently) A matrix with <code>nsim</code> columns.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>Examples</h3>

<pre><code class="language-R">load_mgcv()
dat &lt;- data_sim("eg1", n = 400, dist = "normal", scale = 2, seed = 2)
m1 &lt;- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat, method = "REML")

sims &lt;- simulate(m1, nsim = 5, seed = 42)
head(sims)
</code></pre>


</div>