<div class="container">

<table style="width: 100%;"><tr>
<td>citest-ordinal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A function to compute Monte Carlo and asymptotic tests of conditional
independence for ordinal and/or nominal variables.</h2>

<h3>Description</h3>

<p>The function computes tests of independence of two variables,
say u and v, given a set of variables, say S. The deviance, Wilcoxon,
Kruskal-Wallis and Jonkheere-Terpstra tests are supported.  Asymptotic
and Monte Carlo p-values are computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ciTest_ordinal(x, set = NULL, statistic = "dev", N = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A dataframe or table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set</code></td>
<td>
<p>The variable set (u,v,S), given either as an integer vector of the
column numbers of a dataframe or dimension numbers of a table, or as a
character vector with the corresponding variable or dimension names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>Either "deviance", "wilcoxon", "kruskal" or "jt".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The number of Monte Carlo samples. If N&lt;=0 then Monte Carlo p-values
are not computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments, currently not used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The deviance test is appropriate when u and v are nominal; Wilcoxon,
when u is binary and v is ordinal; Kruskal-Wallis, when u is nominal and
v is ordinal; Jonckheere-Terpstra, when both u and v are ordinal.
</p>


<h3>Value</h3>

<p>A list including the test statistic, the asymptotic p-value and, when
computed, the Monte Carlo p-value.  </p>
<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Asymptotic p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>montecarlo.P</code></td>
<td>
<p>Monte Carlo p-value</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Flaminia Musella, David Edwards, Søren Højsgaard,
<a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a>
</p>


<h3>References</h3>

<p>See Edwards D. (2000), "Introduction to Graphical Modelling", 2nd
ed., Springer-Verlag, pp. 130-153.
</p>


<h3>See Also</h3>

<p><code>ciTest_table</code>, <code>ciTest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(gRim)
data(dumping, package="gRbase")

ciTest_ordinal(dumping, c(2,1,3), stat="jt", N=1000)
ciTest_ordinal(dumping, c("Operation", "Symptom", "Centre"), stat="jt", N=1000)
ciTest_ordinal(dumping, ~Operation + Symptom + Centre, stat="jt", N=1000)

data(reinis)
ciTest_ordinal(reinis, c(1,3,4:6), N=1000)

# If data is a dataframe
dd     &lt;- as.data.frame(dumping)
ncells &lt;- prod(dim(dumping))
ff     &lt;- dd$Freq
idx    &lt;- unlist(mapply(function(i,n) rep(i,n),1:ncells,ff))
dumpDF &lt;- dd[idx, 1:3]
rownames(dumpDF) &lt;- 1:NROW(dumpDF)

ciTest_ordinal(dumpDF, c(2,1,3), stat="jt", N=1000)
ciTest_ordinal(dumpDF, c("Operation","Symptom","Centre"), stat="jt", N=1000)
ciTest_ordinal(dumpDF, ~ Operation + Symptom + Centre, stat="jt", N=1000)
</code></pre>


</div>