<div class="container">

<table style="width: 100%;"><tr>
<td>make.gbm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
tailor reversible-jump Markov chain Monte Carlo sampling</h2>

<h3>Description</h3>

<p>controlling reversible-jump Markov chain Monte Carlo sampling</p>


<h3>Usage</h3>

<pre><code class="language-R">make.gbm(phy, dat, SE=NA, type = c("bm", "rbm", "jump-bm", "jump-rbm"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of class 'phylo'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>a named vector of continuous trait values, associated with each species in <code>phy</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>a named vector of standard errors for each trait value; applied to all trait values if given a single value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the class of model to use (see <code>rjmcmc.bm</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed internally to control other settings (see <b>Details</b>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>...</code> controls the substitution of default settings for Markov-chain Monte Carlo sampling. Below are the settings that are controllable by the user. 
These parameters and their default settings can also be found with an <em>empty</em> call to the function (e.g., <code>make.gbm()</code>).
</p>
<p><b>measurement error (SE)</b>: one of the arguments necessary for running <code>rjmcmc.bm</code> is <code>SE</code>, which is a statement about the error associated with the values 
given in <code>dat</code>.  Measurement error (whose argument is <code>SE</code>) can be a named vector of numeric values (including <code>NA</code>) or a single value (including <code>NA</code>).  If given as 
a vector, <code>SE</code> must have names that correspond to the those found for <code>dat</code>. If given a single value for 
<code>SE</code>, the sampler will apply that value of measurement error to all tips in the tree. If <code>NA</code> appears for the measurement error for <em>any</em> species, 
<code>SE</code> becomes an additional parameter of the model: this density is consequently sampled by <code>rjmcmc.bm</code>. The default for <code>rjmcmc.bm</code> is to estimate a single <code>SE</code> 
(which is applied to all species).  
</p>
<p><b>control settings</b>: default settings for each control parameter are given below.  Note that for the discrete random variables (for which <code>dlnSHIFT</code> and <code>dlnJUMP</code>) apply, 
certain criteria must be met if the user prefers to supply a different prior density. The function <code>dcount</code> is useful for building a custom prior density function 
for discrete variables.
</p>


<h3>Value</h3>

<p>The items that can be tailored in the resulting control object are as follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code><b>method</b></code></td>
<td>
<p>default <code>direct</code>; this defines the implementation for computing model likelihood (currently with only the default available)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>constrainSHIFT</b></code></td>
<td>
<p>default <code>FALSE</code>; if integer given, this constrains the number of local clocks in the diffusive process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>constrainJUMP</b></code></td>
<td>
<p>default <code>FALSE</code>; if integer given, this constrains the number of pulses in the jump process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>dlnSHIFT</b></code></td>
<td>
<p>default <code>dcount(0:(nn - 1), FUN = dpois, lambda = log(2))</code>, where <code>nn</code> is the number of branches in the tree; this controls the prior density on the number of shifts between local clocks in the tree (and applies only if the <code>type</code> argument to <code>rjmcmc.bm</code> is <code>"rbm"</code> or <code>"jump-rbm"</code>) and if <code>constrainSHIFT</code> is <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>dlnJUMP</b></code></td>
<td>
<p>default <code>dcount(0:nn, FUN = dlunif, min = 0, max = nn, dzero = 0.5)</code>, where <code>nn</code> is the number of branches in the tree; this controls the prior density on the number of evolutionary pulses across the tree (and applies only if the <code>type</code> argument to <code>rjmcmc.bm</code> is <code>"jump-bm"</code> or <code>"jump-rbm"</code> and if <code>constrainJUMP</code> is <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>dlnRATE</b></code></td>
<td>
<p>default <code>function (x) dexp(x, rate = 1/(10^3), log = TRUE)</code>; this defines the prior density on rate scalars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>dlnSE</b></code></td>
<td>
<p>default <code>function (x) dexp(x, rate = 1/(10^3), log = TRUE)</code>; this defines the prior density on measurement error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>dlnPULS</b></code></td>
<td>
<p>default <code>function (x) dexp(x, rate = 1/(10^3), log = TRUE)</code>; this defines the prior density on jump variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>dlnROOT</b></code></td>
<td>
<p>default <code>function (x) dunif(x, min=-10^3, max=10^3, log=TRUE)</code>; this defines the prior density on root state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>rate.lim</b></code></td>
<td>
<p>default <code>list(min=0, max=Inf)</code>; this defines the numerical limits on the rate scalars</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>se.lim</b></code></td>
<td>
<p>default <code>list(min=0, max=Inf)</code>; this defines the numerical limits on the measurement error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>root.lim</b></code></td>
<td>
<p>default <code>list(min=-Inf, max=Inf)</code>; this defines the numerical limits on the root state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>jump.lim</b></code></td>
<td>
<p>default <code>1</code>; determines the number of jumps permissible along each branch (1 is currently supported)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>excludeSHIFT</b></code></td>
<td>
<p>default <code>c()</code>; if this argument is not empty, these are branches (specified by numeric node-identifiers) which cannot be chosen for a novel local clock</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>excludeJUMP</b></code></td>
<td>
<p>default <code>c()</code>; if this argument if not empty, these are branches (specified by numeric node-identifiers) which cannot be chosen for an evolutionary pulse</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>bm.jump</b></code></td>
<td>
<p>default <code>0.5</code>; this defines the ratio between proposals for the diffusion and jump processes (0.5 is perfectly balanced)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>mergesplit.shift</b></code></td>
<td>
<p>default <code>0.5</code>; this defines the ratio between proposals that scale model complexity and those that do not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>tune.scale</b></code></td>
<td>
<p>default <code>0.65</code>; this defines the ratio between proposals that modify the model branchwise versus treewide</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>slide.mult</b></code></td>
<td>
<p>default <code>0.25</code>; this defines the ratio between sliding window and multiplier proposals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>prob.dimension</b></code></td>
<td>
<p>default <code>0.65</code>; this defines the proportion of proposals used to modify model dimensionality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>prob.effect</b></code></td>
<td>
<p>default <code>0.3</code>; this defines the proportion of proposals that do not alter dimensionality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>prob.SE</b></code></td>
<td>
<p>default <code>0.03</code>; this defines the proportion of proposals that alter the (unknown) measurement error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>prob.root</b></code></td>
<td>
<p>default <code>0.02</code>; this defines the proportion of proposals that alter the root state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>prop.width</b></code></td>
<td>
<p>default <code>1</code>; this defines the proposal width used for multiplier and sliding-window proposals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>simple.start</b></code></td>
<td>
<p>default <code>TRUE</code>; this determines whether to start the MCMC sampler with minimal dimensionality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code><b>filebase</b></code></td>
<td>
<p>default <code>"result"</code>; this defines a 'base' filename for the output</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>JM Eastman</p>


<h3>See Also</h3>

<p><code>rjmcmc.bm</code>
</p>


</div>