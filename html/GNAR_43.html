<div class="container">

<table style="width: 100%;"><tr>
<td>r_corbit_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produces a R-Corbit plot for the specified choice of covariate-levels and/or time-slices.
</h2>

<h3>Description</h3>

<p>Produces a R-Corbit plot for comparing the network autocorrelation (NACF) and partial network autocorrelation function (PNACF) values for a choice of maximum lag and maximum <code class="reqn">r</code>-stage depth. Starting from the first and continuing to the outermost ring, each ring corresponds to said choice of <code class="reqn">r</code>-stage depth. The numbers on the outermost ring are time-lags, and each dot corresponds to a specific time-slice or covariate-level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">r_corbit_plot(vts_frames, network_list, max_lag, max_stage, weight_matrices, 
frame_names, same_net="no", viridis_color_option="viridis", size_option="absolute_val", 
partial="no", r_corbit="yes")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vts_frames</code></td>
<td>
<p>List containing the vector time series linked to each of the covariate-levels and/or time-slices, which the R-Corbit plot compares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network_list</code></td>
<td>
<p>List of network objects for which the R-Corbit plot compares network autocorrelation or partial network autocorrelation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_lag</code></td>
<td>
<p>Maximum lag for the R-Corbit plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_stage</code></td>
<td>
<p>Maximum <code class="reqn">r</code>-stage depth for the R-Corbit plot (i.e., the number of rings in the R-Corbit plot).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_matrices</code></td>
<td>
<p>List of weigth matrices, each weight matrix corresponds to a particular choice of time-slice or covariate-level. If all the time-slices have the same weight matrix, then the argument is a list, where all the entries are equal to the unique weight matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame_names</code></td>
<td>
<p>Indicates the name of each time-slice or covariate-level time series. Order should be the same as in the weight matrices and vector time series lists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same_net</code></td>
<td>
<p>Indicates whether or not all time-slices or covariate-levels share the same weight matrix. Default choice is no, if the time-slices or covariate-levels share the same weight matrix, then this argument should be set to "yes" (i.e., same_net = "yes").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>viridis_color_option</code></td>
<td>
<p>Colour scale for the R-Corbit plot. The default option is <code>viridis</code>, each option is colout blind friendly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_option</code></td>
<td>
<p>Point size scale for the R-Corbit plot. Default is the absolute value of the network autocorrelation function (i.e., <code>|nacf(h, r)|</code> or  <code>|pnacf(h, r)|)</code>. Alternate option is the coefficient of determination coming from a global-<code class="reqn">\alpha</code> model constrained to a specific lag and stage pair.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>Option for selecting between computing the network autocorrelation function or the partial network autocorrelation function. Default choice is network autocorrelation (i.e., partial="no"). Change argument to "yes" for computing the partial network autocorrelation function (PNACF).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_corbit</code></td>
<td>
<p>Choice for distinguishing between Corbit and R-Corbit plots, default is set to Corbit (inner function call). For producing R-Corbit plots one should use <code>corbit_plot</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>R-Corbit plots compare the network autocorrelation function (NACF) and partial network autocorrelation function (PNACF) values for a choice of different time-slices and/or covariate-levels. R-Corbit plots are read in the same manner as Corbit plots <code>corbit_plot</code>, and include a legend on the right-hand side for distinguishing between covariate-levels and/or time-slices. The point at the centre is the mean value of the NACF or PNACF values arising from the time-slices and/or covariate-levels data splits. Essentially, if <code class="reqn">c \in \{1, \dots, C\}</code>, where <code class="reqn">C \in \mathbb{N}</code> is the number of covariate-levels or time-slices, then the value at the centre is <code class="reqn">\mathrm{(p)nacf}(h, r) = C^{-1} \sum_{c = 1}^{C} \mathrm{(p)nacf}_c (h, r),</code> where <code class="reqn">\mathrm{(p)nacf}_c(h, r)</code> is the (P)NACF value corresponding to the covariate-level/time-slice <code class="reqn">c</code>. The number of covariate-levels and time-slices <code class="reqn">C</code> must be equal to the length of the lists used for producing the R-Corbit plot.
</p>


<h3>Value</h3>

<p>Produces the specified, i.e., NACF or PNACF, values for a choice of lag and <code class="reqn">r</code>-stage depth, <code class="reqn">(h, r)</code>, R-Corbit plot. Does not print (P)NACF values, these are stored as invisble data frames (matrices), and can be accessed by printing or calling the object produced by the <code>r_corbit_plot</code> call. The invisible object is a list of matrices, one matrix for each covariate-level/time-slice.
</p>


<h3>Author(s)</h3>

<p>Guy Nason and Daniel Salnikov

</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
#
# Produces a R-Corbit plot, which compares three stationary GNAR simulations, where 
# the underlying network is fiveNet.
#
# Compute the weight matrix
W = weights_matrix(fiveNet)
#
# Simulate three stationary GNAR processe
sim1 &lt;-  GNARsim(n = 100, net=fiveNet, alphaParams = list(c(0.1, 0.12, 0.16, 0.075, 0.21),
                                                          c(0.12, 0.14, 0.15, 0.6, 0.22)), 
                 betaParams = list(c(0.1, 0.16), c(0.11, 0.14)))

sim2 &lt;-  GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(.25, 5)), 
                 betaParams = list(c(0.1, 0.16)))

sim3 &lt;- GNARsim(n = 100, net=fiveNet, alphaParams = list(rep(.25, 5), rep(0.13, 5)), 
                betaParams = list(c(0.1, 0.16), c(0.11)))
                
# Produce NACF R-Corbit plot with the same network and weights matrix
r_corbit_plot(list(sim1, sim2, sim3), list(fiveNet), 10, 3, list(W), 
		c("sim1", "sim2", "sim3"), same_net = "yes")
# 
# Produce PNACF R-Corbit with different networks and weight matrices
print(r_corbit_plot(list(sim1, sim2, sim3), list(fiveNet, fiveNet, fiveNet), 10, 3, list(W, W, W),
		 c("sim1", "sim2", "sim3"), same_net = "no", partial = "yes"))


## End(Not run)

</code></pre>


</div>