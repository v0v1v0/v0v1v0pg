<div class="container">

<table style="width: 100%;"><tr>
<td>dual1d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dual Solution of one-dimensional Optimal Transport</h2>

<h3>Description</h3>

<p>Calculate an optimal dual pair for the optimal transport between discrete one-dimensional measures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dual1d(a, b, wa, wb, p = 1, right.margin = 1e-15, sorted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>first vector of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>second vector of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wa</code></td>
<td>
<p>weight vector of the first vector of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wb</code></td>
<td>
<p>weight vector of the second vector of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the power <code class="reqn">\geq 1</code> of the cost function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right.margin</code></td>
<td>
<p>small amount the points are moved by.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorted</code></td>
<td>
<p>logical value indicating whether or not <code>a</code> and <code>b</code> are sorted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The pair <code class="reqn">f, g</code> is an optimal dual pair if the optimal transport distance between the two distributions
with respect to the cost function <code class="reqn">c(x, y) = | x - y |^p</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\langle f, w_a \rangle + \langle g, w_b \rangle</code>
</p>

<p>and the condition <code class="reqn">f_i + g_j \leq | a_i - b_j |^p</code> holds.
</p>


<h3>Value</h3>

<p>a list containing the dual vectors <code>pot.a</code> and <code>pot.b</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
a &lt;- 1:5
wa &lt;- rep(1/5, 5)
b &lt;- 1:6
wb &lt;- runif(6)
wb &lt;- wb / sum(wb)

d &lt;- dual1d(a, b, wa, wb, p = 1)

dc &lt;- sum(d$pot.a * wa) + sum(d$pot.b * wb)
print(all.equal(dc, transport_cost(a, b, wa, wb, p = 1)))
</code></pre>


</div>