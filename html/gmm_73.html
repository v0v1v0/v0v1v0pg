<div class="container">

<table style="width: 100%;"><tr>
<td>smoothG</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kernel smoothing of a matrix of time series</h2>

<h3>Description</h3>

<p>It applies the required kernel smoothing to the moment function in order for the GEL estimator to be valid. It is used by the <code>gel</code> function.</p>


<h3>Usage</h3>

<pre><code class="language-R">smoothG(x, bw = bwAndrews, prewhite = 1, ar.method = "ols", weights = weightsAndrews,
	kernel = c("Bartlett", "Parzen", "Truncated", "Tukey-Hanning"), 
	approx = c("AR(1)", "ARMA(1,1)"), tol = 1e-7) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code class="reqn">n\times q</code> matrix of time series, where n is the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>The method to compute the bandwidth parameter. By default, it uses the bandwidth proposed by Andrews(1991). As an alternative, we can choose bw=bwNeweyWest (without "") which is proposed by Newey-West(1996).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prewhite</code></td>
<td>
<p>logical or integer. Should the estimating functions
be prewhitened? If <code>TRUE</code> or greater than 0 a VAR model of
order <code>as.integer(prewhite)</code> is fitted via <code>ar</code> with
method <code>"ols"</code> and <code>demean = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.method</code></td>
<td>
<p>character. The <code>method</code> argument passed to
<code>ar</code> for prewhitening.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>The smoothing weights can be computed by <code>weightsAndrews</code> of it can be provided manually. If provided, it has to be a <code class="reqn">r\times 1</code>vector (see details). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>a character specifying the approximation method if the
bandwidth has to be chosen by <code>bwAndrews</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric. Weights that exceed <code>tol</code> are used for computing
the covariance matrix, all other weights are treated as 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>The choice of kernel</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample moment conditions <code class="reqn">\sum_{t=1}^n g(\theta,x_t)</code> is replaced by:
<code class="reqn">\sum_{t=1}^n g^k(\theta,x_t)</code>, where <code class="reqn">g^k(\theta,x_t)=\sum_{i=-r}^r k(i) g(\theta,x_{t+i})</code>,
where <code class="reqn">r</code> is a truncated parameter that depends on the bandwidth and <code class="reqn">k(i)</code> are normalized weights so that they sum to 1.
</p>
<p>If the vector of weights is provided, it gives only one side weights. For exemple, if you provide the vector (1,.5,.25), <code class="reqn">k(i)</code> will become <code class="reqn">(.25,.5,1,.5,.25)/(.25+.5+1+.5+.25) =  (.1,.2,.4,.2,.1)</code>
</p>


<h3>Value</h3>

<p>smoothx: A <code class="reqn">q \times q</code> matrix containing an estimator of the asymptotic variance of <code class="reqn">\sqrt{n} \bar{x}</code>, where <code class="reqn">\bar{x}</code> is <code class="reqn">q\times 1</code>vector with typical element <code class="reqn">\bar{x}_i = \frac{1}{n}\sum_{j=1}^nx_{ji}</code>. This function is called by <code>gel</code> but can also be used by itself.
</p>
<p><code>kern_weights</code>: Vector of weights used for the smoothing.
</p>


<h3>References</h3>

<p>Anatolyev, S. (2005), GMM, GEL, Serial Correlation, and Asymptotic Bias. <em>Econometrica</em>, <b>73</b>, 983-1002.
</p>
<p>Andrews DWK (1991),
Heteroskedasticity and Autocorrelation Consistent Covariance Matrix Estimation.
<em>Econometrica</em>, <b>59</b>,
817–858.
</p>
<p>Kitamura, Yuichi (1997), Empirical Likelihood Methods With Weakly Dependent Processes.
<em>The Annals of Statistics</em>, <b>25</b>, 2084-2102.
</p>
<p>Zeileis A (2006), Object-oriented Computation of Sandwich Estimators.
<em>Journal of Statistical Software</em>, <b>16</b>(9), 1–16.
URL <a href="https://doi.org/10.18637/jss.v016.i09">doi:10.18637/jss.v016.i09</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">g &lt;- function(tet, x)
	{
	n &lt;- nrow(x)
	u &lt;- (x[7:n] - tet[1] - tet[2]*x[6:(n-1)] - tet[3]*x[5:(n-2)])
	f &lt;- cbind(u, u*x[4:(n-3)], u*x[3:(n-4)], u*x[2:(n-5)], u*x[1:(n-6)])
	return(f)
	}
n = 500
phi&lt;-c(.2, .7)
thet &lt;- 0.2
sd &lt;- .2
x &lt;- matrix(arima.sim(n = n, list(order = c(2, 0, 1), ar = phi, ma = thet, sd = sd)), ncol = 1)
gt &lt;- g(c(0, phi), x) 
sgt &lt;- smoothG(gt)$smoothx
plot(gt[,1])
lines(sgt[,1])
</code></pre>


</div>