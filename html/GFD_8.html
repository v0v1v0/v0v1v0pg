<div class="container">

<table style="width: 100%;"><tr>
<td>QANOVA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>QANOVA: Quantile-based analyis-of-variance</h2>

<h3>Description</h3>

<p>The function <code>qanova</code> calculates the Wald-type statistic based on the
quantiles and/or their linear combinations, e.g. the interquartile range. Respective p-values
are obtained by a <code class="reqn">\chi^2</code>-approximation and a permutation approach, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">QANOVA(formula, data = NULL, quantiles = c(0.5), lin_mat = NULL,
  var_method = "interval", nperm = 1999, var_level = 0.95,
  nested.levels.unique = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A model <code>formula</code> object. The left hand side contains the response variable and the right
hand side contains the factor variables of interest. An interaction term must be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame, list or environment containing the variables in formula
and the censoring status
indicator. Default option is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>
<p>A vector of probabilties corresponding to the quantiles of interest.
By default is c(0.5), i.e. just the median is included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lin_mat</code></td>
<td>
<p>A matrix specifying which linear combination of the quantiles should be
included for the analysis. By default (<code>NULL</code>) the identity matrix is chosen, i.e.
all chosen quantiles are considered simulatenously.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_method</code></td>
<td>
<p>Method for the variance estimation of the sample quantiles. The default
("interval") is the interval-based estimator of Price and Bonett (2001). Additionally, the bootstrap
method ("boot") of Efron (1987) or a kernel density approach ("kernel") can be chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>The number of permutations used for calculating the permuted p-value.
The default option is 1999.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_level</code></td>
<td>
<p>A number between 0 and 1 specifying the confidence level for the
interval variance estimation method; the default value is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nested.levels.unique</code></td>
<td>
<p>A logical specifying whether the levels of the nested
factor(s) are labeled uniquely or not.
Default is FALSE, i.e., the levels of the nested factor are the same for each
level of the main factor.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>qanova</code> function calculates the Wald-type statistic based on quantiles
and linear combinations of them for general factorial designs. The procedure is fully
nonparametric and no specific assumption of the underlying distribution is required.
In particular, heteroscedastic settings can be studied. The analysis can be based on a single
quantile (e.g. the median, default choice), a linear combination of quantiles (e.g. the
interquartile range, set <code>quantiles=c(0.25,0.75)</code> and <code>lin_mat = matrix(c(-1,1),ncol=2)</code>)
or on several (combinations of) quantiles simulatenously.
</p>
<p>The <code>qanova</code> function returns the test statistic as well as two
corresponding p-values: the first is based on a <code class="reqn">chi^2</code> approximation and
the second one is based on a permutation procedure.
</p>
<p>@return A <code>qanova</code> object containing the following components:
</p>

<ul>
<li>
<p>pvalues_statThe p-values obtained by <code class="reqn">\chi^2</code>-approximation
</p>
</li>
<li>
<p>pvalues_perThe p-values of the permutation approach
</p>
</li>
<li>
<p>statisticsThe value of the qanova along with degrees of freedom of the
central chi-square distribution and p-value, as well as the p-value of the
permutation procedure.
</p>
</li>
<li>
<p>npermThe number of permutations used for calculating the permuted p-value.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Philipp Steinhauer
</p>


<h3>References</h3>

<p>Ditzhaus, M., Fried, R. and Pauly, M. (2021). QANOVA: Quantile-based Permutation Methods For General
Factorial Designs. TEST (to appear, ArXiv preprint arXiv:1912.09146).
Efron, B. (1979). Bootstrap methods: Another look at the jackknife. Ann. Statist., 7:1-26.
Price, R. and Bonett, D. (2001). Estimating the variance of the sample median. J. Stat. Comput.
Simul, 68:295-305.
</p>


<h3>Examples</h3>

<pre><code class="language-R">QANOVA(weightgain ~ source*type, data = HSAUR::weightgain,var_method = "interval", nperm =199)

</code></pre>


</div>