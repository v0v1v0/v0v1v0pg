<div class="container">

<table style="width: 100%;"><tr>
<td>sim.data.ts.two</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Generate two-level simulation data
</h2>

<h3>Description</h3>

<p> This function generates a two-level dataset with given parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.data.ts.two(Z.list, N, theta, Sigma, W, Delta = NULL, p = NULL, 
  Lambda = diag(rep(1, 3)), nburn = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z.list</code></td>
<td>
<p> a list of data. Each list is a vector containing the treatment/exposure assignment at each time point for the subject.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p> an integer, indicates the number of subjects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p> a vector of length 3, contains the population level causal effect coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p> a 2 by 2 matrix, is the covariance matrix of the two Gaussian white noise processes in the single level model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p> a <code class="reqn">2p</code> by 2 matrix, is the transition matrix in the single level model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p> a 2 by 2 matrix, is the covariance matrix of the initial condition in the single level model. Default is <code>NULL</code>, will be the same as <code>Sigma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> an integer, indicates the order of the vector autoregressive (VAR) model in the single level model. Default is <code>NULL</code>, will be calculated based on <code>W</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p> the covariance matrix of the model errors in the linear model of the model coefficients. Default is a 3 by 3 identity matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p> a integer indicating the number of burning sample in the single level model. Default is 100.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> For the time series of length <code class="reqn">n_{i}</code> of subject <code class="reqn">i</code>, the single level GMA model is
</p>
<p style="text-align: center;"><code class="reqn">M_{i_{t}}=Z_{i_{t}}A_{i}+E_{i_{1t}},</code>
</p>

<p style="text-align: center;"><code class="reqn">R_{i_{t}}=Z_{i_{t}}C_{i}+M_{i_{t}}B_{i}+E_{i_{2t}},</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">E_{i_{1t}}=\sum_{j=1}^{p}\omega_{i_{11_{j}}}E_{i_{1,t-j}}+\sum_{j=1}^{p}\omega_{i_{21_{j}}}E_{i_{2,t-j}}+\epsilon_{i_{1t}},</code>
</p>

<p style="text-align: center;"><code class="reqn">E_{i_{2t}}=\sum_{j=1}^{p}\omega_{i_{12_{j}}}E_{i_{1,t-j}}+\sum_{j=1}^{p}\omega_{i_{22_{j}}}E_{i_{2,t-j}}+\epsilon_{i_{2t}},</code>
</p>

<p>where <code>Sigma</code> is the covariance matrix of <code class="reqn">(\epsilon_{i_{1t}},\epsilon_{i_{2t}})</code> (for simplicity, <code>Sigma</code> is the same across subjects). For coefficients <code class="reqn">A_{i}</code>, <code class="reqn">B_{i}</code> and <code class="reqn">C_{i}</code>, we assume a multivariate regression model. The model errors are from a trivariate normal distribution with mean zero and covariance <code>Lambda</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list of data. Each list is a data frame of <code class="reqn">(Z_{t},M_{t},R_{t})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>a list of data. Each list is a data frame of <code class="reqn">(E_{1t},E_{2t})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a vector of length <code>N</code>, the value of <code class="reqn">A</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a vector of length <code>N</code>, the value of <code class="reqn">B</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>a vector of length <code>N</code>, the value of <code class="reqn">C</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character indicates the type of the dataset.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Yi Zhao, Brown University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
Xi Luo, Brown University, <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao, Y., &amp; Luo, X. (2017). <em>Granger Mediation Analysis of Multiple Time Series with an Application to fMRI.</em> arXiv preprint arXiv:1709.05328.
</p>


<h3>Examples</h3>

<pre><code class="language-R">###################################################
# Generate a two-level dataset

# covariance matrix of errors
delta&lt;-0.5
Sigma&lt;-matrix(c(1,2*delta,2*delta,4),2,2)

# model coefficients
A0&lt;-0.5
B0&lt;--1
C0&lt;-0.5

theta&lt;-c(A0,B0,C0)

# number of time points
N&lt;-50
set.seed(2000)
n&lt;-matrix(rpois(N,100),N,1)

# treatment assignment list
set.seed(1000)
Z.list&lt;-list()
for(i in 1:N)
{
  Z.list[[i]]&lt;-matrix(rbinom(n[i,1],size=1,prob=0.5),n[i,1],1)
}

# Lambda
Lambda&lt;-diag(0.5,3)

# VAR(1) model
p&lt;-1

# Delta and W matrices
Delta&lt;-matrix(c(2,delta*sqrt(2*8),delta*sqrt(2*8),8),2,2)
W&lt;-matrix(c(-0.809,0.154,-0.618,-0.5),2,2)

# number of burning samples
nburn&lt;-1000

# set.seed(2000)
# data2&lt;-sim.data.ts.two(Z.list,N,theta=theta,Sigma,W,Delta,p,Lambda,nburn)
###################################################
</code></pre>


</div>