<div class="container">

<table style="width: 100%;"><tr>
<td>Sieve_NPMLE_Bootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sieve_NPMLE_Bootstrap function
</h2>

<h3>Description</h3>

<p>This function is used for calculating standard error estimates and 95% confidence bands in quantile using the bootstrap method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Sieve_NPMLE_Bootstrap ( fam_ID, Y0, Delta0, p0G0, fix_t1, fix_t2,
                        Grid, Knot, degree=3, Bn, maxiter=400, ep=1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fam_ID</code></td>
<td>
<p>family ID numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y0</code></td>
<td>
<p>observed event times or censoring times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta0</code></td>
<td>
<p>indicators of event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0G0</code></td>
<td>
<p>probabilities of being a carrier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_t1</code></td>
<td>
<p>a vector of fixed points at which the carrier's cumulative distribution function values are estimated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_t2</code></td>
<td>
<p>a vector of fixed points at which the non-carrier's cumulative distribution function values are estimated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Grid</code></td>
<td>
<p>a vector of grid points used for plotting the estimated distribution functions of carrier and non-carrier groups. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Knot</code></td>
<td>
<p>number of knots of the B-spline base functions. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>degree of the B-spline base functions. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bn</code></td>
<td>
<p>number of bootstrap samples. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ep</code></td>
<td>
<p>convergence criterion, default is ep= 1e-05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using bootstrap for standard error estimation and 95% confidence bands calculation. We do the Bootstrap resample according to <code>fam_ID</code>. 
</p>


<h3>Value</h3>

<p>This function returns a list
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Boot.L1</code></td>
<td>
<p>estimated cumulative hazard function for the carrier group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boot.L2</code></td>
<td>
<p>estimated cumulative hazard function for the non-carrier group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE_F1_fix_t</code></td>
<td>
<p>estimated standard errors for the carrier group at given points <code>fix_t1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE_F2_fix_t</code></td>
<td>
<p>estimated standard errors for the non-carrier group at given points <code>fix_t2</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wang, Y., Liang, B., Tong, X., Marder, K., Bressman, S., Orr-Urtreger, A., Giladi, N. &amp; Zeng, D. (2015). Efficient estimation of nonparametric genetic risk function with censored data. <em>Biometrika</em>, <b>102</b>(3), 515-532.
</p>


<h3>See Also</h3>

 <p><code>p0G_Func()</code>, <code>Sieve_NPMLE_Switch()</code>. </p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Simulated_data");

OID = Simulated_data[,1];
OY = Simulated_data[,2];
ind = order(OY);
ODelta = Simulated_data[,3];
Op0G = Simulated_data[,4];

Y = OY[ind];
Delta = ODelta[ind];
p0G = Op0G[ind];

Grid = seq(0.2, 3.65, 0.05);
fix_t1 = c(0.288, 0.693, 1.390);
fix_t2 = c(0.779, 1.860, 3.650);
px = seq(0.1, 3, 0.1);

SieveNPMLE_result = Sieve_NPMLE_Switch( Y=Y, Delta=Delta, p0G=p0G, px=px,
                                        Grid=Grid, Knot=7, degree=3  );

Lambda_1.hat = cumsum( SieveNPMLE_result$lamb1.hat );
Lambda_2.hat = cumsum( SieveNPMLE_result$lamb2.hat );

F_carr_func = function(x){ 1 - exp( - max( Lambda_1.hat[Y &lt;= x] ) ) }
F_non_func  = function(x){ 1 - exp( - max( Lambda_2.hat[Y &lt;= x] ) ) }

est.f1 = apply(matrix(fix_t1, ncol=1), 1, F_carr_func );
est.f2 = apply(matrix(fix_t2, ncol=1), 1, F_non_func  );

# ---------------- #
#    Bootstrap     #
# ---------------- #

 Boot = Sieve_NPMLE_Bootstrap( fam_ID=OID, Y0=OY, Delta0=ODelta, p0G0=Op0G,
                               fix_t1=fix_t1, fix_t2=fix_t2, Grid = Grid,
                               Knot=6, degree =3, Bn=10  );

 SE1 = Boot$SE_F1_fix_t;
 SE2 = Boot$SE_F2_fix_t;

 estp = data.frame( fix_t1 = fix_t1, F1.hat = est.f1, SE_F1 = SE1,
                    fix_t2 = fix_t2, F2.hat = est.f2, SE_F2 = SE2  );

 print(estp)

</code></pre>


</div>