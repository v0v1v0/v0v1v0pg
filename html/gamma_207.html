<div class="container">

<table style="width: 100%;"><tr>
<td>smooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooth</h2>

<h3>Description</h3>

<p>Smoothes intensities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">signal_smooth(object, ...)

smooth_rectangular(object, ...)

smooth_triangular(object, ...)

smooth_savitzky(object, ...)

## S4 method for signature 'GammaSpectrum'
signal_smooth(object, method = c("rectangular", "triangular", "savitzky"), ...)

## S4 method for signature 'GammaSpectra'
signal_smooth(object, method = c("rectangular", "triangular", "savitzky"), ...)

## S4 method for signature 'GammaSpectrum'
smooth_rectangular(object, m = 3, ...)

## S4 method for signature 'GammaSpectra'
smooth_rectangular(object, m = 3, ...)

## S4 method for signature 'GammaSpectrum'
smooth_savitzky(object, m = 3, p = 2, ...)

## S4 method for signature 'GammaSpectra'
smooth_savitzky(object, m = 3, p = 2, ...)

## S4 method for signature 'GammaSpectrum'
smooth_triangular(object, m = 3, ...)

## S4 method for signature 'GammaSpectra'
smooth_triangular(object, m = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A GammaSpectrum or GammaSpectra
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra parameters to be passed to further methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A <code>character</code> string specifying the smoothing method to be
used. It must be one of "<code>unweighted</code>" (default), "<code>weighted</code>" or
"<code>savitzky</code>" (see details). Any unambiguous substring can be given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>An odd <code>integer</code> giving the number of adjacent points to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>An <code>integer</code> giving the polynomial degree. Only used if <code>method</code>
is "<code>savitzky</code>".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following smoothing methods are available:
</p>

<dl>
<dt><code>rectangular</code></dt>
<dd>
<p>Unweighted sliding-average or rectangular smooth.
It replaces each point in the signal with the average of <code class="reqn">m</code> adjacent
points.</p>
</dd>
<dt><code>triangular</code></dt>
<dd>
<p>Weighted sliding-average or triangular smooth.
It replaces each point in the signal with the weighted mean of <code class="reqn">m</code>
adjacent points.</p>
</dd>
<dt><code>savitzky</code></dt>
<dd>
<p>Savitzky-Golay filter. This method is based on the
least-squares fitting of polynomials to segments of <code class="reqn">m</code> adjacent
points.</p>
</dd>
</dl>
<p>There will be <code class="reqn">(m - 1) / 2</code> points both at the beginning and at the end
of the spectrum for which a complete <code class="reqn">m</code>-width smooth cannot be
calculated. To prevent data loss, progressively smaller smooths are used at
the ends of the spectrum if <code>method</code> is <code>unweighted</code> or <code>weighted</code>. If the
Savitzky-Golay filter is used, the original <code class="reqn">(m - 1) / 2</code> points at the
ends of the spectrum are preserved.
</p>


<h3>Value</h3>

<p>A GammaSpectrum or GammaSpectra object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Gorry, P. A. (1990). General Least-Squares Smoothing and Differentiation by
the Convolution (Savitzky-Golay) Method. <em>Analytical Chemistry</em>, 62(6),
p. 570-573. <a href="https://doi.org/10.1021/ac00205a007">doi:10.1021/ac00205a007</a>.
</p>
<p>Savitzky, A. &amp; Golay, M. J. E. (1964). Smoothing and Differentiation of
Data by Simplified Least Squares Procedures. <em>Analytical Chemistry</em>,
36(8), p. 1627-1639. <a href="https://doi.org/10.1021/ac60214a047">doi:10.1021/ac60214a047</a>.
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code>baseline</code>,
<code>peaks_find()</code>,
<code>peaks_search()</code>,
<code>signal_integrate()</code>,
<code>signal_slice()</code>,
<code>signal_split()</code>,
<code>signal_stabilize()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Import CNF files
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(spc_file)
spc &lt;- signal_slice(spc, -c(1:35))

# Plot raw spectrum
spc_clean &lt;- signal_correct(spc)
plot(spc_clean)

# Rectangular smooth
spc_unweighted &lt;- smooth_rectangular(spc, m = 3)
spc_unweighted_clean &lt;- signal_correct(spc_unweighted)
plot(spc_unweighted_clean)

# Triangular smooth
spc_weighted &lt;- smooth_triangular(spc, m = 5)
spc_weighted_clean &lt;- signal_correct(spc_weighted)
plot(spc_weighted_clean)

# Savitzkyâ€“Golay
spc_savitzky &lt;- smooth_savitzky(spc, m = 21, p = 2)
spc_savitzky_clean &lt;- signal_correct(spc_savitzky)
plot(spc_savitzky_clean)
</code></pre>


</div>