<div class="container">

<table style="width: 100%;"><tr>
<td>gofar_p</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalize Exclusive factor extraction via co-sparse unit-rank estimation (GOFAR(P)) using k-fold crossvalidation</h2>

<h3>Description</h3>

<p>Divide and conquer approach for low-rank and sparse coefficent matrix estimation: Exclusive extraction
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofar_p(
  Yt,
  X,
  nrank = 3,
  nlambda = 40,
  family,
  familygroup = NULL,
  cIndex = NULL,
  ofset = NULL,
  control = list(),
  nfold = 5,
  PATH = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Yt</code></td>
<td>
<p>response matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>covariate matrix; when X = NULL, the fucntion performs unsupervised learning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrank</code></td>
<td>
<p>an integer specifying the desired rank/number of factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>number of lambda values to be used along each path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>set of family gaussian, bernoulli, possion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>familygroup</code></td>
<td>
<p>index set of the type of multivariate outcomes: "1" for Gaussian, "2" for Bernoulli, "3" for Poisson outcomes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cIndex</code></td>
<td>
<p>control index, specifying index of control variable in the design matrix X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofset</code></td>
<td>
<p>offset matrix specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of internal parameters controlling the model fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>
<p>number of fold for cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PATH</code></td>
<td>
<p>TRUE/FALSE for generating solution path of sequential estimate after cross-validation step</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>estimated coefficient matrix; based on GIC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>estimated control variable coefficient matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>estimted dispersion parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>estimated U matrix (generalize latent factor weights)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>estimated singular values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>estimated V matrix (factor loadings)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>selected lambda values based on the chosen information criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lampath</code></td>
<td>
<p>sequences of lambda values used in model fitting. In each sequential unit-rank estimation step,
a sequence of length nlambda is first generated between (lamMax<em>lamMaxFac, lamMax</em>lamMaxFac*lamMinFac) equally
spaced on the log scale, in which lamMax is estimated and the other parameters are specified in gofar_control.
The model fitting starts from the largest lambda and stops when the maximum proportion of nonzero elements is reached in
either u or v, as specified by spU and spV in gofar_control.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC</code></td>
<td>
<p>values of information criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Upath</code></td>
<td>
<p>solution path of U</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dpath</code></td>
<td>
<p>solution path of D</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vpath</code></td>
<td>
<p>solution path of D</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ObjDec</code></td>
<td>
<p>boolian type matrix outcome showing if objective function is monotone decreasing or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>familygroup</code></td>
<td>
<p>spcified familygroup of outcome variables.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p><em> Mishra, Aditya, Dipak K. Dey, Yong Chen, and Kun Chen. Generalized co-sparse factor regression. Computational Statistics &amp; Data Analysis 157 (2021): 107127</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
family &lt;- list(gaussian(), binomial(), poisson())
control &lt;- gofar_control()
nlam &lt;- 40 # number of tuning parameter
SD &lt;- 123

# Simulated data for testing

data('simulate_gofar')
attach(simulate_gofar)
q &lt;- ncol(Y)
p &lt;- ncol(X)
# Simulate data with 20% missing entries
miss &lt;- 0.20 # Proportion of entries missing
t.ind &lt;- sample.int(n * q, size = miss * n * q)
y &lt;- as.vector(Y)
y[t.ind] &lt;- NA
Ym &lt;- matrix(y, n, q)
naind &lt;- (!is.na(Ym)) + 0 # matrix(1,n,q)
misind &lt;- any(naind == 0) + 0
#
# Model fitting begins:
control$epsilon &lt;- 1e-7
control$spU &lt;- 50 / p
control$spV &lt;- 25 / q
control$maxit &lt;- 1000
# Model fitting: GOFAR(P) (full data)
set.seed(SD)
rank.est &lt;- 5

fit.eea &lt;- gofar_p(Y, X,
  nrank = rank.est, nlambda = nlam,
  family = family, familygroup = familygroup,
  control = control, nfold = 5
)

# Model fitting: GOFAR(P) (missing data)
set.seed(SD)
rank.est &lt;- 5
fit.eea.m &lt;- gofar_p(Ym, X,
  nrank = rank.est, nlambda = nlam,
  family = family, familygroup = familygroup,
  control = control, nfold = 5
)

</code></pre>


</div>