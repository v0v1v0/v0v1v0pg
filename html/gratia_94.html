<div class="container">

<table style="width: 100%;"><tr>
<td>draw.rootogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw a rootogram</h2>

<h3>Description</h3>

<p>A rootogram is a model diagnostic tool that assesses the goodness of fit of
a statistical model. The observed values of the response are compared with
those expected from the fitted model. For discrete, count responses, the
frequency of each count (0, 1, 2, etc) in the observed data and expected
from the conditional distribution of the response implied by the model are
compared. For continuous variables, the observed and expected frequencies
are obtained by grouping the data into bins. The rootogram is drawn using
<code>ggplot2::ggplot()</code> graphics. The design closely follows Kleiber &amp; Zeileis
(2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'rootogram'
draw(
  object,
  type = c("hanging", "standing", "suspended"),
  sqrt = TRUE,
  ref_line = TRUE,
  warn_limits = TRUE,
  fitted_colour = "steelblue",
  bar_colour = NA,
  bar_fill = "grey",
  ref_line_colour = "black",
  warn_line_colour = "black",
  ylab = NULL,
  xlab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>and R object to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character; the type of rootogram to draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqrt</code></td>
<td>
<p>logical; show the observed and fitted frequencies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_line</code></td>
<td>
<p>logical; draw a reference line at zero?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn_limits</code></td>
<td>
<p>logical; draw Tukey's warning limit lines at +/- 1?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted_colour, bar_colour, bar_fill, ref_line_colour, warn_line_colour</code></td>
<td>
<p>colours used to draw the respective element of the rootogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>character; labels for the x and y axis of the rootogram.
May be missing (<code>NULL</code>), in which case suitable labels will be used.
'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A 'ggplot' object.
</p>


<h3>References</h3>

<p>Kleiber, C., Zeileis, A., (2016) Visualizing Count Data
Regressions Using Rootograms. <em>Am. Stat.</em> <strong>70</strong>, 296â€“303.
<a href="https://doi.org/10.1080/00031305.2016.1173590">doi:10.1080/00031305.2016.1173590</a>
</p>


<h3>See Also</h3>

<p><code>rootogram()</code> to compute the data for the rootogram.
</p>


<h3>Examples</h3>

<pre><code class="language-R">load_mgcv()
df &lt;- data_sim("eg1", n = 1000, dist = "poisson", scale = 0.1, seed = 6)

# A poisson example
m &lt;- gam(y ~ s(x0, bs = "cr") + s(x1, bs = "cr") + s(x2, bs = "cr") +
  s(x3, bs = "cr"), family = poisson(), data = df, method = "REML")
rg &lt;- rootogram(m)

# plot the rootogram
draw(rg)

# change the type of rootogram
draw(rg, type = "suspended")
</code></pre>


</div>