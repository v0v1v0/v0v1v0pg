<div class="container">

<table style="width: 100%;"><tr>
<td>GNE.minpb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non smooth equation reformulation of the GNE problem.</h2>

<h3>Description</h3>

<p>Non smooth equation reformulation via the extended KKT system of the GNE problem.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GNE.minpb(init, dimx, obj, argobj, grobj, arggrobj, 
	heobj, argheobj, joint, argjoint, jacjoint, argjacjoint, 
	method="default", problem = c("NIR", "VIR"), control.outer=list(), 
	control.inner=list(), silent=TRUE, param=list(), 
	optim.type=c("free","constr"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Initial values for the parameters to be optimized over: <code class="reqn">z=(x, lambda, mu)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimx</code></td>
<td>
<p>a vector of dimension for <code class="reqn">x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>objective function (to be minimized), see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argobj</code></td>
<td>
<p>a list of additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grobj</code></td>
<td>
<p>gradient of the objective function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arggrobj</code></td>
<td>
<p>a list of additional arguments of the objective gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heobj</code></td>
<td>
<p>Hessian of the objective function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argheobj</code></td>
<td>
<p>a list of additional arguments of the objective Hessian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint</code></td>
<td>
<p>joint function (<code class="reqn">h(x)&lt;=0</code>), see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argjoint</code></td>
<td>
<p>a list of additional arguments of the joint function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jacjoint</code></td>
<td>
<p>Jacobian of the joint function, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>argjacjoint</code></td>
<td>
<p>a list of additional arguments of the Jacobian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either <code>"BB"</code>, <code>"CG"</code> or <code>"BFGS"</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>problem</code></td>
<td>
<p>either <code>"NIR"</code>, <code>"VIP"</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.type</code></td>
<td>
<p>either <code>"free"</code>, <code>"constr"</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.outer</code></td>
<td>
<p>a list with control parameters for the minimization algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.inner</code></td>
<td>
<p>a list with control parameters for the minimization function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the optimization routine. 
NOT to the functions <code>phi</code> and <code>jacphi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>a logical to show some traces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a list of parameters for the computation of the minimization function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions in argument must respect the following template:
</p>

<ul>
<li>
<p><code>obj</code> must have arguments the current iterate <code>z</code>, the player number <code>i</code> 
and optionnally additional arguments given in a list.
</p>
</li>
<li>
<p><code>grobj</code> must have arguments the current iterate <code>z</code>, the player number <code>i</code>, 
the derivative index <code>j</code> and optionnally additional arguments given in a list.
</p>
</li>
<li>
<p><code>heobj</code> must have arguments the current iterate <code>z</code>, the player number <code>i</code>, 
the derivative indexes <code>j</code>, <code>k</code> and optionnally additional arguments given in a list.
</p>
</li>
<li>
<p><code>joint</code> must have arguments the current iterate <code>z</code>
and optionnally additional arguments given in a list.
</p>
</li>
<li>
<p><code>jacjoint</code> must have arguments the current iterate <code>z</code>,
the derivative index <code>j</code> and optionnally additional arguments given in a list.
</p>
</li>
</ul>
<p>The gap function minimization consists in minimizing a gap function <code class="reqn">min V(x)</code>. The function <code>minGap</code>
provides two optimization methods to solve this minimization problem.
</p>

<dl>
<dt>Barzilai-Borwein algorithm</dt>
<dd>
<p>when <code>method = "BB"</code>, we use Barzilai-Borwein iterative scheme
to find the minimum.</p>
</dd>
<dt>Conjugate gradient algorithm</dt>
<dd>
<p>when <code>method = "CG"</code>, we use the CG iterative
scheme implemented in <code>R</code>, an Hessian-free method. </p>
</dd>	
<dt>Broyden-Fletcher-Goldfarb-Shanno algorithm</dt>
<dd>
<p>when <code>method = "BFGS"</code>, we use the BFGS iterative
scheme implemented in <code>R</code>, a quasi-Newton method with line search. </p>
</dd>	
</dl>
<p>In the game theory literature, there are two main gap functions: the regularized 
Nikaido-Isoda (NI) function and the regularized QVI gap function.
This correspond to <code>type="NI"</code> and <code>type="VI"</code>, respectively. 
See von Heusinger &amp; Kanzow (2009) for details on the NI function and 
Kubota &amp; Fukushima (2009) for the QVI regularized gap function.
</p>
<p>The <code>control.outer</code> argument is a list that can supply any of the following components:
</p>

<dl>
<dt><code>tol</code></dt>
<dd>
<p>The absolute convergence tolerance. Default to 1e-6.</p>
</dd>
<dt><code>maxit</code></dt>
<dd>
<p>The maximum number of iterations. Default to 100.</p>
</dd>
<dt><code>echo</code></dt>
<dd>
<p>A logical or an integer (0, 1, 2, 3) to print traces. 
Default to <code>FALSE</code>, i.e. 0.</p>
</dd>
<dt><code>stepinit</code></dt>
<dd>
<p>Initial step size for the BB method (should be 
small if gradient is “big”). Default to 1.</p>
</dd>
</dl>
<p>Note that the <code>Gap</code> function can return a numeric or a list with computation details. In the
latter case, the object return must be a list with the following components
<code>value</code>, <code>counts</code>, <code>iter</code>, see the example below.
</p>


<h3>Value</h3>

<p>A list with components:
</p>

<dl>
<dt><code>par</code></dt>
<dd>
<p>The best set of parameters found.</p>
</dd>
<dt><code>value</code></dt>
<dd>
<p>The value of the merit function.</p>
</dd>
<dt><code>outer.counts</code></dt>
<dd>
<p>A two-element integer vector giving the number of 
calls to <code>Gap</code> and <code>gradGap</code> respectively.</p>
</dd>				
<dt><code>outer.iter</code></dt>
<dd>
<p>The outer iteration number.</p>
</dd>
<dt><code>code</code></dt>
<dd>
<p>The values returned are
</p>

<dl>
<dt><code>1</code></dt>
<dd>
<p>Function criterion is near zero.
Convergence of function values has been achieved.</p>
</dd>
<dt><code>2</code></dt>
<dd>
<p>x-values within tolerance. This means that the relative distance between two
consecutive x-values is smaller than <code>xtol</code>.</p>
</dd>
<dt><code>3</code></dt>
<dd>
<p>No better point found.
This means that the algorithm has stalled and cannot find an acceptable new point.
This may or may not indicate acceptably small function values.</p>
</dd>
<dt><code>4</code></dt>
<dd>
<p>Iteration limit <code>maxit</code> exceeded.</p>
</dd>
<dt><code>5</code></dt>
<dd>
<p>Jacobian is too ill-conditioned.</p>
</dd>
<dt><code>6</code></dt>
<dd>
<p>Jacobian is singular.</p>
</dd>
<dt><code>100</code></dt>
<dd>
<p>an error in the execution.</p>
</dd>
</dl>
</dd>
<dt><code>inner.iter</code></dt>
<dd>
<p>The iteration number when 
computing the minimization function.</p>
</dd>	
<dt><code>inner.counts</code></dt>
<dd>
<p>A two-element integer 
vector giving the number of calls to the gap function and its gradient 
when computing the minimization function.</p>
</dd>			
<dt><code>message</code></dt>
<dd>
<p>a string describing the termination code</p>
</dd>	
</dl>
<h3>Author(s)</h3>

<p>Christophe Dutang
</p>


<h3>References</h3>

<p>A. von Heusinger (2009),
<em>Numerical Methods for the Solution of the Generalized Nash Equilibrium Problem</em>,
Ph. D. Thesis.
</p>
<p>A. von Heusinger and C. Kanzow (2009),
<em>Optimization reformulations of the generalized Nash equilibrium problem using Nikaido-Isoda-type functions</em>,
Comput Optim Appl .
</p>
<p>K. Kubota and M. Fukushima (2009), 
<em>Gap function approach to the generalized Nash Equilibrium problem</em>,
Journal of Optimization theory and applications.
</p>


<h3>See Also</h3>

<p>See <code>GNE.fpeq</code>, <code>GNE.ceq</code> and <code>GNE.nseq</code> 
for other approaches.
</p>


</div>