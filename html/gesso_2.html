<div class="container">

<table style="width: 100%;"><tr>
<td>data.gen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Data Generation
</h2>

<h3>Description</h3>

<p>Generates genotypes data matrix G (<code>sample_size</code> by <code>p</code>), vector of environmental measurments E, and an outcome vector Y of size <code>sample_size</code>. Simulates training, validation, and test datasets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data.gen(sample_size = 100, p = 20, n_g_non_zero = 15, n_gxe_non_zero = 10, 
         family = "gaussian", mode = "strong_hierarchical", 
         normalize = FALSE, normalize_response = FALSE, 
         seed = 1, pG = 0.2, pE = 0.3,
         n_confounders = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>sample size of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>total number of main effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_g_non_zero</code></td>
<td>
<p>number of non-zero main effects to generate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_gxe_non_zero</code></td>
<td>
<p>number of non-zero interaction effects to generate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>"gaussian" for continous outcome Y and "binomial" for binary 0/1 outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>either "strong_hierarchical", "hierarchical", or "anti_hierarchical".
In the <em>strong hierarchical</em> mode the hierarchical structure is maintained (beta_g = 0  then beta_gxe = 0) and also |beta_g| &gt;= |beta_gxe|. In the <em>hierarchical</em> mode the  hierarchical structure is maintained, but |beta_G| &lt; |beta_gxe|. In the <em>anti_hierarchical</em> mode the hierarchical structure is violated (beta_g = 0  then beta_gxe != 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p><code>TRUE</code> to normalize matrix <code>G</code> and vector <code>E</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize_response</code></td>
<td>
<p><code>TRUE</code> to normalize vector <code>Y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pG</code></td>
<td>
<p>genotypes prevalence, value from 0 to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pE</code></td>
<td>
<p>environment prevalence, value from 0 to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_confounders</code></td>
<td>
<p>number of confounders to generate, either <code>NULL</code> or <code>&gt;1</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of simulated datasets and generating coefficients
</p>
<table>
<tr style="vertical-align: top;">
<td><code>G_train, G_valid, G_test</code></td>
<td>
<p>generated genotypes matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E_train, E_valid, E_test</code></td>
<td>
<p>generated vectors of environmental values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_train, Y_valid, Y_test</code></td>
<td>
<p>generated outcome vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_train, C_valid, C_test</code></td>
<td>
<p>generated confounders matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GxE_train, GxE_valid, GxE_test</code></td>
<td>
<p>generated GxE matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta_G</code></td>
<td>
<p>main effect coefficients vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta_GxE</code></td>
<td>
<p>interaction coefficients vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_0</code></td>
<td>
<p>intercept coefficient value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_E</code></td>
<td>
<p>environment coefficient value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta_C</code></td>
<td>
<p>confounders coefficient values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_beta_non_zero, 
index_beta_gxe_non_zero,
index_beta_zero, 
index_beta_gxe_zero</code></td>
<td>
<p>inner data generation variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_g_non_zero</code></td>
<td>
<p>number of non-zero main effects generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_gxe_non_zero</code></td>
<td>
<p>number of non-zero interactions generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_total_non_zero</code></td>
<td>
<p>total number of non-zero variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNR_g</code></td>
<td>
<p>signal-to-noise ratio for the main effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNR_gxe</code></td>
<td>
<p>signal-to-noise ratio for the interactions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family, p, sample_size, mode, seed</code></td>
<td>
<p>input simulation parameters</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data = data.gen(sample_size=100, p=100)
G = data$G_train; GxE = data$GxE_train
E = data$E_train; Y = data$Y_train
</code></pre>


</div>