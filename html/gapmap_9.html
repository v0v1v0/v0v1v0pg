<div class="container">

<table style="width: 100%;"><tr>
<td>gapmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to draw a gapped cluster heatmap</h2>

<h3>Description</h3>

<p>This function draws a gapped cluster heatmap using the ggplot2 package. The input for the
function is the a matrix, two dendrograms, and parameters for gaps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gapmap(
  m,
  d_row,
  d_col,
  mode = c("quantitative", "threshold"),
  mapping = c("exponential", "linear"),
  ratio = 0.2,
  scale = 0.5,
  threshold = 0,
  row_threshold = NULL,
  col_threshold = NULL,
  rotate_label = TRUE,
  verbose = FALSE,
  left = "dendrogram",
  top = "dendrogram",
  right = "label",
  bottom = "label",
  col = c("#053061", "#2166AC", "#4393C3", "#92C5DE", "#D1E5F0", "#F7F7F7", "#FDDBC7",
    "#F4A582", "#D6604D", "#B2182B", "#67001F"),
  h_ratio = c(0.2, 0.7, 0.1),
  v_ratio = c(0.2, 0.7, 0.1),
  label_size = 5,
  show_legend = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_row</code></td>
<td>
<p>a dendrogram class object for rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_col</code></td>
<td>
<p>a dendrogram class object for columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>gap mode, either "threshold" or "quantitative"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>in case of quantitative mode, either "linear" or "exponential" mapping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>the percentage of width allocated for the sum of gaps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>the sclae log base for the exponential mapping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>the height at which the dendrogram is cut to infer clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_threshold</code></td>
<td>
<p>the height at which the row dendrogram is cut</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_threshold</code></td>
<td>
<p>the height at which the column dendrogram is cut</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate_label</code></td>
<td>
<p>a logical to rotate column labels or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical for whether in verbose mode or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left</code></td>
<td>
<p>a character indicating "label" or "dendrogram" for composition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top</code></td>
<td>
<p>a character indicating "label" or "dendrogram" for composition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p>a character indicating "label" or "dendrogram" for composition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bottom</code></td>
<td>
<p>a character indicating "label" or "dendrogram" for composition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colors used for heatmap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_ratio</code></td>
<td>
<p>a vector to set the horizontal ratio of the grid. It should add up to 1. top, center, bottom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_ratio</code></td>
<td>
<p>a vector to set the vertical ratio of the grid. It should add up to 1. left, center, right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_size</code></td>
<td>
<p>a numeric to set the label text size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_legend</code></td>
<td>
<p>a logical to set whether to show a legend or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
#generate sample data
x &lt;- rnorm(10, mean=rep(1:5, each=2), sd=0.4)
y &lt;- rnorm(10, mean=rep(c(1,2), each=5), sd=0.4)
dataFrame &lt;- data.frame(x=x, y=y, row.names=c(1:10))
#calculate distance matrix. default is Euclidean distance
distxy &lt;- dist(dataFrame)
#perform hierarchical clustering. default is complete linkage.
hc &lt;- hclust(distxy)
dend &lt;- as.dendrogram(hc)
#make a cluster heatmap plot
gapmap(m = as.matrix(distxy), d_row= rev(dend), d_col=dend)

</code></pre>


</div>