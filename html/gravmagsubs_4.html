<div class="container">

<table style="width: 100%;"><tr>
<td>rectprismmag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
rectprismmag
</h2>

<h3>Description</h3>

<p>Calculates the magnetic effect of 3-D rectangular prisms.
Calculates anomalies of <code>N</code> prisms at <code>M</code> observation stations.
</p>
<p>Stations cannot be positioned inside a prism, or on its edges or faces.
Stations cannot be positioned directly below the corners of a prism.
</p>
<p>Coordinates of stations and prisms are assumed to share a common coordinate system.
</p>
<p>Returns total field magnetic anomaly in nanoteslas (nT).
</p>
<p>N.B. Demagnetization effects are ignored in this subroutine.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rectprismmag(xstation, ystation, zstation, xmin, xmax, ymin, ymax,
             zdeep, zshallow, suscvolsi, nrmstr, nrmincl, nrmdecl,
             fieldtotal, fieldincl, fielddecl, bycell=FALSE)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xstation</code></td>
<td>
<p>vector of length <code>M</code> with the x-coordinates of each station, in km, positive east;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ystation</code></td>
<td>
<p>vector of length <code>M</code> with the y-coordinates of each station, in km, positive north;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zstation</code></td>
<td>
<p>vector of length <code>M</code> with the z-coordinates of each station, in km, positive up;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>vector of length <code>N</code> with the minimum x-coordinates of each prism, in km, positive east;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>vector of length <code>N</code> with the maximum x-coordinates of each prism, in km, positive east;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymin</code></td>
<td>
<p>vector of length <code>N</code> with the minimum y-coordinates of each prism, in km, positive north;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>vector of length <code>N</code> with the maximum y-coordinates of each prism, in km, positive north;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zdeep</code></td>
<td>
<p>vector of length <code>N</code> with the bottom z-coordinates of each prism, in km, positive up;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zshallow</code></td>
<td>
<p>vector of length <code>N</code> with the top z-coordinates of each prism, in km, positive up;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suscvolsi</code></td>
<td>
<p>vector of length <code>N</code> with the volume susceptibility (unitless);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrmstr</code></td>
<td>
<p>vector of length <code>N</code> with the remanent magnetization of each prism, in Amperes per meter (A/m);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrmincl</code></td>
<td>
<p>vector of length <code>N</code> with the inclination angle of the remanent magnetization for each prism, in degrees, positive below horizontal;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrmdecl</code></td>
<td>
<p>vector of length <code>N</code> with the declination angle of the remanent magnetization for each prism, in degrees, positive east of true north;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fieldtotal</code></td>
<td>
<p>vector of length <code>N</code> with the Earth's field intensity at each prism, in nanoteslas (nT);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fieldincl</code></td>
<td>
<p>vector of length <code>N</code> with the Earth's field inclination at each prism, in degrees, positive below horizontal;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fielddecl</code></td>
<td>
<p>vector of length <code>N</code> with the Earth's field declination at each prism, in degrees, positive east of true north;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bycell</code></td>
<td>
<p>returns <code>M</code>-by-<code>N</code> matrix with anomaly values generated by individual prisms (default FALSE).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a matrix of length <code>M</code> rows.
</p>
<p>If <code>bycell=FALSE</code>, there will be <code>M</code> rows and 1 column, and the
element in the <code>i</code>-th row represents the total magnetic anomaly generated
by all <code>N</code> prisms as observed at the <code>i</code>-th station.
</p>
<p>If <code>bycell=TRUE</code>, the matrix will have <code>M</code> rows and <code>N</code> columns,
with the element <code>[i,j]</code> representing the anomaly value generated by the
<code>j</code>-th prism as observed at the <code>i</code>-th station.
</p>


<h3>References</h3>


<ul><li>
<p> Plouff, D., 1975, Derivation of formulas and FORTRAN programs to compute magnetic anomalies of prisms, National Technical Information Service No. PB-243-525, U.S. Department of Commerce, Springfield, VA.  <br><a href="https://ntrl.ntis.gov/NTRL/dashboard/searchResults/titleDetail/PB243525.xhtml">https://ntrl.ntis.gov/NTRL/dashboard/searchResults/titleDetail/PB243525.xhtml</a>.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>rectprismgrav</code>,
<code>gravmagsubs</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#########################################################
## magnetic anomaly of single prism at a single point  ##

# location of the point where the magnetic anomaly will be calculated
magstation &lt;- data.frame(x=0, y=0, z=0)

# the rectangular prism is defined by its six edges
prism1 &lt;- data.frame(xmin=-5, xmax=5,
                     ymin=-5, ymax=5,
                     zmin=-10, zmax=-5)

susc &lt;- 5       # susceptiblity (SI)
mstr &lt;- 0       # remanent magnetization (A/m)
mincl &lt;- 0      # remanent inclination (deg)
mdecl &lt;- 0      # remanent declination (deg)
ftotal &lt;- 48800 # Earth's field intensity (nT)
fincl &lt;- 60     # field inclination (deg)
fdecl &lt;- 12     # field declination (deg)

maganom &lt;- rectprismmag(magstation$x, magstation$y, magstation$z,
                        prism1$xmin, prism1$xmax,
                        prism1$ymin, prism1$ymax,
                        prism1$zmin, prism1$zmax, susc,
                        mstr, mincl, mdecl,
                        ftotal, fincl, fdecl)

#########################################################

</code></pre>


</div>