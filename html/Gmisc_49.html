<div class="container">

<table style="width: 100%;"><tr>
<td>getDescriptionStatsBy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creating of description statistics</h2>

<h3>Description</h3>

<p>A function that returns a description statistic that can be used
for creating a publication "table 1" when you want it by groups.
The function identifies if the variable is a continuous, binary
or a factored variable. The format is inspired by NEJM, Lancet &amp;
BMJ.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getDescriptionStatsBy(
  x,
  ...,
  by,
  digits = 1,
  digits.nonzero = NA,
  html = TRUE,
  numbers_first = TRUE,
  statistics = FALSE,
  statistics.sig_lim = 10^-4,
  statistics.two_dec_lim = 10^-2,
  statistics.suppress_warnings = TRUE,
  useNA = c("ifany", "no", "always"),
  useNA.digits = digits,
  continuous_fn = describeMean,
  prop_fn = describeProp,
  factor_fn = describeFactors,
  show_all_values = FALSE,
  hrzl_prop = FALSE,
  add_total_col,
  total_col_show_perc = TRUE,
  use_units = FALSE,
  units_column_name = "Units",
  default_ref = NULL,
  NEJMstyle = FALSE,
  percentage_sign = TRUE,
  header_count = NULL,
  missing_value = "-",
  names_of_missing = NULL
)

## S3 method for class 'Gmisc_getDescriptionStatsBy'
htmlTable(x, ...)

## S3 method for class 'Gmisc_getDescriptionStatsBy'
print(x, ...)

## S3 method for class 'Gmisc_getDescriptionStatsBy'
knit_print(x, ...)

## S3 method for class 'Gmisc_getDescriptionStatsBy'
length(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>If a data.frame it will be used as the data source for the variables in the <code>...</code> parameter.
If it is a single variable it will be the core value that want the statistics for.
In the print this is equivalent to the output of this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>The variables that you want you statistic for. In the print all thes parameters
are passed on as [htmlTable::htmlTable] arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>The variable that you want to split into different columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of decimals used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits.nonzero</code></td>
<td>
<p>The number of decimals used for values that are close to zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>html</code></td>
<td>
<p>If HTML compatible output should be used. If <code>FALSE</code>
it outputs LaTeX formatting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numbers_first</code></td>
<td>
<p>If the number should be given or if the percentage
should be presented first. The second is encapsulated in parentheses ().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics</code></td>
<td>
<p>Add statistics, fisher test for proportions and Wilcoxon
for continuous variables. See details below for more customization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics.sig_lim</code></td>
<td>
<p>The significance limit for &lt; sign, i.e. p-value 0.0000312
should be &lt; 0.0001 with the default setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics.two_dec_lim</code></td>
<td>
<p>The limit for showing two decimals. E.g.
the p-value may be 0.056 and we may want to keep the two decimals in order
to emphasize the proximity to the all-mighty 0.05 p-value and set this to
<code class="reqn">10^-2</code>. This allows that a value of 0.0056 is rounded to 0.006 and this
makes intuitive sense as the 0.0056 level as this is well below
the 0.05 value and thus not as interesting to know the exact proximity to
0.05. <em>Disclaimer:</em> The 0.05-limit is really silly and debated, unfortunately
it remains a standard and this package tries to adapt to the current standards in order
to limit publication associated issues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics.suppress_warnings</code></td>
<td>
<p>Hide warnings from the statistics function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useNA</code></td>
<td>
<p>This indicates if missing should be added as a separate
row below all other. See <code>table</code> for <code>useNA</code>-options.
<em>Note:</em> defaults to ifany and not "no" as <code>table</code> does.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useNA.digits</code></td>
<td>
<p>The number of digits to use for the
missing percentage, defaults to the overall <code>digits</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>continuous_fn</code></td>
<td>
<p>The method to describe continuous variables. The
default is <code>describeMean</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_fn</code></td>
<td>
<p>The method used to describe proportions, see <code>describeProp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_fn</code></td>
<td>
<p>The method used to describe factors, see <code>describeFactors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_all_values</code></td>
<td>
<p>Show all values in proportions. For factors with only two values
it is most sane to only show one option as the other one will just be a complement
to the first, i.e. we want to convey a proportion. For instance sex - if you know
gender then automatically you know the distribution of the other sex as it's 100 % - other %.
To choose which one you want to show then set the <code>default_ref</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hrzl_prop</code></td>
<td>
<p>This is default FALSE and indicates
that the proportions are to be interpreted in a vertical manner.
If we want the data to be horizontal, i.e. the total should be shown
and then how these differ in the different groups then set this to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_total_col</code></td>
<td>
<p>This adds a total column to the resulting table.
You can also specify if you want the total column "first" or "last"
in the column order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_col_show_perc</code></td>
<td>
<p>This is by default true but if
requested the percentages are suppressed as this sometimes may be confusing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_units</code></td>
<td>
<p>If the Hmisc package's units() function has been employed
it may be interesting to have a column at the far right that indicates the
unit measurement. If this column is specified then the total column will
appear before the units (if specified as last). You can also set the value to
<code>"name"</code> and the units will be added to the name as a parenthesis,
e.g. Age (years).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units_column_name</code></td>
<td>
<p>The name of the units column. Used if use_units = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default_ref</code></td>
<td>
<p>The default reference when dealing with proportions. When using
'dplyr' syntax ('tidyselect') you can specify a named vector/list for each column name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NEJMstyle</code></td>
<td>
<p>Adds - no (%) at the end to proportions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percentage_sign</code></td>
<td>
<p>If you want to suppress the percentage sign you
can set this variable to FALSE. You can also choose something else that
the default % if you so wish by setting this variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header_count</code></td>
<td>
<p>Set to <code>TRUE</code> if you want to add a header count,
e.g. Smoking; No. 25 observations, where there is a new line after the
factor name. If you want a different text for the second line you can
specifically use the <code>sprintf</code> formatting, e.g. "No. %s patients".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing_value</code></td>
<td>
<p>Value that is substituted for empty cells. Defaults to "-"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names_of_missing</code></td>
<td>
<p>Optional character vector containing the names of returned statistics,
in case all returned values for a given <code>by</code> level are missing. Defaults to NULL</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns <code>matrix</code> if a single value was provided, otherwise a <code>list</code>
of matrices with the class <code>"Gmisc_getDescriptionStatsBy"</code>.
</p>


<h3>Customizing statistics</h3>

<p>You can specify what function that you want for statistic by providing a function
that takes two arguments <code>x</code> and <code>by</code> and returns a p-value. There are
a few functions already prepared for this see <code>getPvalAnova</code>,
<code>getPvalChiSq</code>
<code>getPvalFisher</code>
<code>getPvalKruskal</code>
<code>getPvalWilcox</code>.
The default functions used are <code>getPvalFisher</code> and <code>getPvalWilcox</code> (unless the by
argument has more than three unique levels where it defaults to <code>getPvalAnova</code>).
</p>
<p>If you want the function to select functions depending on the type of input
you can provide a list with the names <code>'continuous'</code>, <code>'proportion'</code>, <code>'factor'</code> and
the function will choose accordingly. If you fail to define a certain category
it will default to the above.
</p>
<p>You can also use a custom function that returns a string with the attribute <code>'colname'</code>
set that will be appended to the results instead of the p-value column.
</p>


<h3>See Also</h3>

<p>Other descriptive functions: 
<code>describeFactors()</code>,
<code>describeMean()</code>,
<code>describeMedian()</code>,
<code>describeProp()</code>,
<code>getPvalWilcox()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(magrittr)
library(dplyr)
library(htmlTable)

data(mtcars)
mtcars %&lt;&gt;%
  mutate(am = factor(am, levels = 0:1, labels = c("Automatic", "Manual")),
         vs = factor(vs, levels = 0:1, labels = c("V-shaped", "straight")),
         drat_prop = drat &gt; median(drat),
         drat_prop = factor(drat_prop,
                            levels = c(FALSE, TRUE),
                            labels = c("High ratio", "Low ratio")),
         carb_prop = carb &gt; 2,
         carb_prop = factor(carb_prop,
                            levels = c(FALSE, TRUE),
                            labels = c("&amp;le; 2", "&amp;gt; 2")),
         across(c(gear, carb, cyl), factor))

# A simple bare-bone example
mtcars %&gt;%
  getDescriptionStatsBy(`Miles per gallon` = mpg,
                        Weight = wt,
                        `Carborators &amp;le; 2` = carb_prop,
                        by = am) %&gt;%
  htmlTable(caption  = "Basic continuous stats from the mtcars dataset")
invisible(readline(prompt = "Press [enter] to continue"))

# For labeling &amp; units we use set_column_labels/set_column_unit that use
# the Hmisc package annotation functions
mtcars %&lt;&gt;%
  set_column_labels(am = "Transmission",
                    mpg = "Gas",
                    wt = "Weight",
                    gear = "Gears",
                    disp = "Displacement",
                    vs = "Engine type",
                    drat_prop = "Rear axel ratio",
                    carb_prop = "Carburetors") %&gt;%
  set_column_units(mpg = "Miles/(US) gallon",
                   wt = "10&lt;sup&gt;3&lt;/sup&gt; lbs",
                   disp = "cu.in.")

mtcars %&gt;%
  getDescriptionStatsBy(mpg,
                        wt,
                        `Gear&amp;dagger;` = gear,
                        drat_prop,
                        carb_prop,
                        vs,
                        by = am,
                        header_count = TRUE,
                        use_units = TRUE,
                        show_all_values = TRUE)  %&gt;%
  addHtmlTableStyle(pos.caption = "bottom") %&gt;%
  htmlTable(caption  = "Stats from the mtcars dataset",
            tfoot = "&amp;dagger; Number of forward gears")
invisible(readline(prompt = "Press [enter] to continue"))

# Using the default parameter we can
mtcars %&gt;%
  getDescriptionStatsBy(mpg,
                        wt,
                        `Gear&amp;dagger;` = gear,
                        drat_prop,
                        carb_prop,
                        vs,
                        by = am,
                        header_count = TRUE,
                        use_units = TRUE,
                        default_ref = c(drat_prop = "Low ratio",
                                        carb_prop = "&amp;gt; 2"))  %&gt;%
  addHtmlTableStyle(pos.caption = "bottom") %&gt;%
  htmlTable(caption  = "Stats from the mtcars dataset",
            tfoot = "&amp;dagger; Number of forward gears")
invisible(readline(prompt = "Press [enter] to continue"))

# We can also use lists
tll &lt;- list()
tll[["Gear (3 to 5)"]] &lt;- getDescriptionStatsBy(mtcars$gear, mtcars$am)
tll &lt;- c(tll,
         list(getDescriptionStatsBy(mtcars$disp, mtcars$am)))

mergeDesc(tll,
          htmlTable_args = list(caption  = "Factored variables")) %&gt;%
  htmlTable::addHtmlTableStyle(css.rgroup = "")
invisible(readline(prompt = "Press [enter] to continue"))

tl_no_units &lt;- list()
tl_no_units[["Gas (mile/gallons)"]] &lt;-
  getDescriptionStatsBy(mtcars$mpg, mtcars$am,
                        header_count = TRUE)
tl_no_units[["Weight (10&lt;sup&gt;3&lt;/sup&gt; kg)"]] &lt;-
  getDescriptionStatsBy(mtcars$wt, mtcars$am,
                        header_count = TRUE)
mergeDesc(tl_no_units,
          tll) %&gt;%
  htmlTable::addHtmlTableStyle(css.rgroup = "")
invisible(readline(prompt = "Press [enter] to continue"))

# Other settings
mtcars$mpg[sample(1:NROW(mtcars), size = 5)] &lt;- NA
getDescriptionStatsBy(mtcars$mpg,
                      mtcars$am,
                      statistics = TRUE)
invisible(readline(prompt = "Press [enter] to continue"))

# Do the horizontal version
getDescriptionStatsBy(mtcars$gear,
                      mtcars$am,
                      statistics = TRUE,
                      hrzl_prop = TRUE)
invisible(readline(prompt = "Press [enter] to continue"))

mtcars$wt_with_missing &lt;- mtcars$wt
mtcars$wt_with_missing[sample(1:NROW(mtcars), size = 8)] &lt;- NA
getDescriptionStatsBy(mtcars$wt_with_missing, mtcars$am, statistics = TRUE,
                      hrzl_prop = TRUE, total_col_show_perc = FALSE)
invisible(readline(prompt = "Press [enter] to continue"))

## Not run: 
  ## There is also a LaTeX wrapper
  tll &lt;- list(
    getDescriptionStatsBy(mtcars$gear, mtcars$am),
    getDescriptionStatsBy(mtcars$col, mtcars$am))

  latex(mergeDesc(tll),
        caption  = "Factored variables",
        file = "")

## End(Not run)
</code></pre>


</div>