<div class="container">

<table style="width: 100%;"><tr>
<td>schtrig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Schmitt Trigger</h2>

<h3>Description</h3>

<p>Multisignal Schmitt trigger with levels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">schtrig(x, lvl, st = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input data, specified as a numeric vector or matrix. In case of a
vector it represents a single signal; in case of a matrix each column is a
signal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lvl</code></td>
<td>
<p>threshold levels against which <code>x</code> is compared, specified as
a vector. If this is a scalar, the thresholds are symmetric around 0, i.e.
<code>c(-lvl, lvl)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>trigger state, specified as a vector of length <code>ncol(x</code>. The
trigger state is returned in the output list and may be passed again to a
subsequent call to <code>schtrig</code>. Default: NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The trigger works compares each column in <code>x</code> to the levels in
<code>lvl</code>, when the value is higher than <code>max(lvl)</code>, the output
<code>v</code> is high (i.e. 1); when the value is below <code>min(lvl)</code> the output
is low (i.e. 0); and when the value is between the two levels the output
retains its value.
</p>


<h3>Value</h3>

<p>a <code>list</code> containing the following variables:
</p>

<dl>
<dt>v</dt>
<dd>
<p>vector or matrix of 0's and 1's, according to whether <code>x</code> is
above or below <code>lvl</code>, or the value of <code>x</code> if indeterminate</p>
</dd>
<dt>rng</dt>
<dd>
<p>ranges in which the output is high, so the indexes
<code>rng[1,i]:rng[2,i]</code> point to the i-th segment of 1s in <code>v</code>. See
<code>clustersegment</code> for a detailed explanation.</p>
</dd>
<dt>st</dt>
<dd>
<p>trigger state, returned as a vector with a length of the number
of columns in <code>x</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Juan Pablo Carbajal, <a href="mailto:carbajal@ifi.uzh.ch">carbajal@ifi.uzh.ch</a>.<br>
Conversion to R by Geert van Boxtel, <a href="mailto:G.J.M.vanBoxtel@gmail.com">G.J.M.vanBoxtel@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code>clustersegment</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">t &lt;- seq(0, 1, length.out = 100)
x &lt;- sin(2 * pi * 2 * t) + sin(2 * pi * 5 * t) %*% matrix(c(0.8, 0.3), 1, 2)
lvl &lt;- c(0.8, 0.25)
trig  &lt;- schtrig (x, lvl)

op &lt;- par(mfrow = c(2, 1))
plot(t, x[, 1], type = "l", xlab = "", ylab = "")
abline(h = lvl, col = "blue")
lines(t, trig$v[, 1], col = "red", lwd = 2)
plot(t, x[, 2], type = "l", xlab = "", ylab = "")
abline(h = lvl, col = "blue")
lines(t, trig$v[, 2], col = "red", lwd = 2)
par(op)

</code></pre>


</div>