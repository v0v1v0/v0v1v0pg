<div class="container">

<table style="width: 100%;"><tr>
<td>term.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot regression terms for a specified parameter of a fitted GAMLSS object</h2>

<h3>Description</h3>

<p>Plots regression terms against their predictors, optionally with
standard errors and partial residuals added. It is based on the R function <code>termplot</code> but is suitably changed to apply to GAMLSS objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">term.plot(object, what = c("mu", "sigma", "nu", "tau"), 
         parameter= NULL, data = NULL, 
         envir = environment(formula(object)), partial.resid = FALSE, 
         rug = FALSE, terms = NULL, se = TRUE, ylim = c("common", "free"), 
         scheme = c("shaded", "lines"), xlabs = NULL, ylabs = NULL, 
         main = NULL, pages = 0, col.term = "darkred", 
         col.se = "orange", col.shaded = "gray", col.res = "lightblue", 
         col.rug = "gray", lwd.term = 1.5, lty.se = 2, lwd.se = 1, 
         cex.res = 1, pch.res = par("pch"), 
         ask = interactive() &amp;&amp; nb.fig &lt; n.tms &amp;&amp; .Device != "postscript", 
         use.factor.levels = TRUE, surface.gam = FALSE,     
         polys = NULL, polys.scheme = "topo",...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted GAMLSS object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>the required parameter of the GAMLSS distribution i.e. "mu"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>equivalent to <code>what</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame in which variables in <code>object</code> can be found</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>environment in which variables in <code>object</code> can be found </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial.resid</code></td>
<td>
<p>logical; should partial residuals be plotted or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p> add rug plots (jitter 1-d histograms) to the axes?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>which terms to be plotted (default 'NULL' means all terms) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>plot point-wise standard errors?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>there are two options here a) "common" and b) "free". 
The "common" option plots all figures with the same <code>ylim</code> 
range and therefore allows the viewer to check the relative 
contribution of each terms compare to the rest.  
In the‘free’ option the limits are computed for each plot separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scheme</code></td>
<td>
<p>whether the se's should appear shaded or as lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabs</code></td>
<td>
<p>vector of labels for the x axes </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabs</code></td>
<td>
<p>vector of labels for the y axes </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>logical, or vector of main titles;  if 'TRUE', the model's
call is taken as main title, 'NULL' or 'FALSE' mean no
titles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pages</code></td>
<td>
<p>in how many pages the plot should appear. The default 
is 0 which allows different page for each plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.term</code></td>
<td>
<p>the colour of the term line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.se</code></td>
<td>
<p>the colour of the se's lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.shaded</code></td>
<td>
<p>the colour of the shaded area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.res</code></td>
<td>
<p>the colour of the partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.rug</code></td>
<td>
<p>the colour of the rug</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.term</code></td>
<td>
<p>line width of the fitted terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.se</code></td>
<td>
<p>line ype for standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.se</code></td>
<td>
<p>line width for the stadard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.res</code></td>
<td>
<p> plotting character expansion for the partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.res</code></td>
<td>
<p>characters for points in the partial residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if 'TRUE', the user is asked before each plot, see
'par(ask=.)'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.factor.levels</code></td>
<td>
<p>Should x-axis ticks use factor levels or numbers for
factor terms? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surface.gam</code></td>
<td>
<p>whether to use surface plot if a <code>ga()</code> term is fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polys</code></td>
<td>
<p>The polygon information file for MRF models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polys.scheme</code></td>
<td>
<p>Color scheme for polygons for RMF models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other graphical parameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function uses the <code>lpred</code> function of GAMLSS.  
The 'data' argument should rarely be needed, but in some cases
'termplot' may be unable to reconstruct the original data frame.
Using 'na.action=na.exclude' makes these problems less likely.
Nothing sensible happens for interaction terms.
</p>


<h3>Value</h3>

<p>a plot of fitted terms.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos based on the existing termplot() function</p>


<h3>References</h3>

<p> Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code>termplot</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(aids)
a&lt;-gamlss(y~pb(x)+qrt,data=aids,family=NBI)
term.plot(a, pages=1)
rm(a)
</code></pre>


</div>