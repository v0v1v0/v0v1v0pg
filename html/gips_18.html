<div class="container">

<table style="width: 100%;"><tr>
<td>plot.gips</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot optimized matrix or optimization <code>gips</code> object</h2>

<h3>Description</h3>

<p>Plot the heatmap of the MAP covariance matrix estimator
or the convergence of the optimization method.
The plot depends on the <code>type</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gips'
plot(
  x,
  type = NA,
  logarithmic_y = TRUE,
  logarithmic_x = FALSE,
  color = NULL,
  title_text = "Convergence plot",
  xlabel = NULL,
  ylabel = NULL,
  show_legend = TRUE,
  ylim = NULL,
  xlim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of a <code>gips</code> class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character vector of length 1. One of
<code>c("heatmap", "MLE", "best", "all", "both", "block_heatmap")</code>:
</p>

<ul>
<li> <p><code>"heatmap"</code>, <code>"MLE"</code> - Plots a heatmap of the Maximum Likelihood
Estimator of the covariance matrix given the permutation.
That is, the <code>S</code> matrix inside the <code>gips</code> object
projected on the permutation in the <code>gips</code> object.
</p>
</li>
<li> <p><code>"best"</code> - Plots the line of the biggest a posteriori found over time.
</p>
</li>
<li> <p><code>"all"</code> - Plots the line of a posteriori for all visited states.
</p>
</li>
<li> <p><code>"both"</code> - Plots both lines from "all" and "best".
</p>
</li>
<li> <p><code>"block_heatmap"</code> - Plots a heatmap of diagonally block representation of <code>S</code>.
Non-block entries (equal to 0) are white for better clarity.
For more information, see <strong>Block Decomposition - [1], Theorem 1</strong>
section in <code>vignette("Theory", package = "gips")</code> or in its
<a href="https://przechoj.github.io/gips/articles/Theory.html">pkgdown page</a>.
</p>
</li>
</ul>
<p>The default value is <code>NA</code>, which will be changed to "heatmap" for
non-optimized <code>gips</code> objects and to "both" for optimized ones.
Using the default produces a warning.
All other arguments are ignored for
the <code>type = "heatmap"</code>, <code>type = "MLE"</code>, or <code>type = "block_heatmap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logarithmic_y, logarithmic_x</code></td>
<td>
<p>A boolean.
Sets the axis of the plot in logarithmic scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Vector of colors to be used to plot lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title_text</code></td>
<td>
<p>Text to be in the title of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>Text to be on the bottom of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabel</code></td>
<td>
<p>Text to be on the left of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_legend</code></td>
<td>
<p>A boolean. Whether or not to show a legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Limits of the y axis. When <code>NULL</code>,
the minimum, and maximum of the <code>log_posteriori_of_gips()</code> are taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Limits of the x axis. When <code>NULL</code>,
the whole optimization process is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to
other various elements of the plot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>When <code>type</code> is one of <code>"best"</code>, <code>"all"</code> or <code>"both"</code>,
returns an invisible <code>NULL</code>.
When <code>type</code> is one of <code>"heatmap"</code>, <code>"MLE"</code> or <code>"block_heatmap"</code>,
returns an object of class <code>ggplot</code>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>find_MAP()</code> - Usually, the <code>plot.gips()</code>
is called on the output of <code>find_MAP()</code>.
</p>
</li>
<li> <p><code>project_matrix()</code> - The function used with <code>type = "MLE"</code>.
</p>
</li>
<li> <p><code>gips()</code> - The constructor of a <code>gips</code> class.
The <code>gips</code> object is used as the <code>x</code> parameter.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">require("MASS") # for mvrnorm()

perm_size &lt;- 6
mu &lt;- runif(6, -10, 10) # Assume we don't know the mean
sigma_matrix &lt;- matrix(
  data = c(
    1.0, 0.8, 0.6, 0.4, 0.6, 0.8,
    0.8, 1.0, 0.8, 0.6, 0.4, 0.6,
    0.6, 0.8, 1.0, 0.8, 0.6, 0.4,
    0.4, 0.6, 0.8, 1.0, 0.8, 0.6,
    0.6, 0.4, 0.6, 0.8, 1.0, 0.8,
    0.8, 0.6, 0.4, 0.6, 0.8, 1.0
  ),
  nrow = perm_size, byrow = TRUE
) # sigma_matrix is a matrix invariant under permutation (1,2,3,4,5,6)
number_of_observations &lt;- 13
Z &lt;- MASS::mvrnorm(number_of_observations, mu = mu, Sigma = sigma_matrix)
S &lt;- cov(Z) # Assume we have to estimate the mean

g &lt;- gips(S, number_of_observations)
if (require("graphics")) {
  plot(g, type = "MLE")
}

g_map &lt;- find_MAP(g, max_iter = 30, show_progress_bar = FALSE, optimizer = "hill_climbing")
if (require("graphics")) {
  plot(g_map, type = "both", logarithmic_x = TRUE)
}

if (require("graphics")) {
  plot(g_map, type = "MLE")
}
# Now, the output is (most likely) different because the permutation
  # `g_map[[1]]` is (most likely) not an identity permutation.
</code></pre>


</div>