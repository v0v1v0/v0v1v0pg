<div class="container">

<table style="width: 100%;"><tr>
<td>QPCorr.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust identification of gene-environment interactions using a
quantile partial correlation approach</h2>

<h3>Description</h3>

<p>A robust gene-environment interaction identification approach using the quantile partial
correlation technique. This approach is a marginal analysis approach built on the quantile
regression technique, which can accommodate long-tailed or contaminated outcomes. For response
with right censoring, Kaplan-Meier (KM) estimator-based weights are adopted to easily
accommodate censoring. In addition, it adopts partial correlation to identify important
interactions while properly controlling for the main genetic (G) and environmental (E) effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">QPCorr.matrix(G, E, Y, tau, w = NULL, family = c("continuous", "survival"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Input matrix of <code>p</code> G measurements consisting of <code>n</code> rows. Each row is an
observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Input matrix of <code>q</code> E risk factors. Each row is an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response variable. A quantitative vector for <code>family="continuous"</code>. For
<code>family="survival"</code>, <code>Y</code> should be a two-column matrix with the first column being
the log(survival time) and the second column being the censoring indicator. The indicator is a
binary variable, with "1" indicating dead, and "0" indicating right censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Weight for accommodating censoring if <code>family</code>="survival". Default is NULL and a
Kaplan-Meier estimator-based weight is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Response type of <code>Y</code> (see above).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Matrix of (censored) quantile partial correlations for interactions.
</p>


<h3>References</h3>

<p>Yaqing Xu, Mengyun Wu, Qingzhao Zhang, and Shuangge Ma.
<em>Robust identification of gene-environment interactions for prognosis using a quantile
partial correlation approach. Genomics, 111(5):1115-1123, 2019.</em>
</p>


<h3>See Also</h3>

<p><code>QPCorr.pval</code> method.
</p>


<h3>Examples</h3>

<pre><code class="language-R">alpha=matrix(0,5,1)
alpha[1:2]=1
beta=matrix(0,6,100)
beta[1,1:5]=1
beta[2:3,1:5]=2
beta[4:6,6:7]=2
sigmaG&lt;-AR(rho=0.3,100)
sigmaE&lt;-AR(rho=0.3,5)
G&lt;-MASS::mvrnorm(200,rep(0,100),sigmaG)
E&lt;-MASS::mvrnorm(200,rep(0,5),sigmaE)
e1&lt;-rnorm(200*.05,50,1);e2&lt;-rnorm(200*.05,-50,1);e3&lt;-rnorm(200*.9)
e&lt;-c(e1,e2,e3)

# continuous
y1=simulated_data(G=G,E=E,alpha=alpha,beta=beta,error=e,family="continuous")
cpqcorr_stat1&lt;-QPCorr.matrix(G,E,y1,tau=0.5,w=NULL,family="continuous")

# survival
y2=simulated_data(G,E,alpha,beta,rnorm(200,0,1),family="survival",0.7,0.9)
cpqcorr_stat&lt;-QPCorr.matrix(G,E,y2,tau=0.5,w=NULL,family="survival")

</code></pre>


</div>