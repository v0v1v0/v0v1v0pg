<div class="container">

<table style="width: 100%;"><tr>
<td>upfirdn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Upsample, apply FIR filter, downsample</h2>

<h3>Description</h3>

<p>Filter and resample a signal using polyphase interpolation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">upfirdn(x, h, p = 1, q = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input data, specified as a numeric vector or matrix. In case of a
vector it represents a single signal; in case of a matrix each column is a
signal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Impulse response of the FIR filter specified as a numeric vector or
matrix. If it is a vector, then it represents one FIR filter to may be
applied to multiple signals in <code>x</code>; if it is a matrix, then each
column is a separate FIR impulse response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Upsampling factor, specified as a positive integer (default: 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>downsampling factor, specified as a positive integer (default: 1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>upfirdn performs a cascade of three operations:
</p>

<ol>
<li>
<p> Upsample the input data in the matrix <code>x</code> by a factor of the
integer <code>p</code> (inserting zeros)
</p>
</li>
<li>
<p> FIR filter the upsampled signal data with the impulse response
sequence given in the vector or matrix <code>h</code>
</p>
</li>
<li>
<p> Downsample the result by a factor of the integer <code>q</code> (throwing
away samples)
</p>
</li>
</ol>
<p>The FIR filter is usually a lowpass filter, which you must design using
another function such as <code>fir1</code>.
</p>


<h3>Value</h3>

<p>output signal, returned as a vector or matrix. Each column has length
<code>ceiling(((length(x) - 1) * p + length(h)) / q)</code>.
</p>


<h3>Note</h3>

<p>This function uses a polyphase implementation, which is generally
faster than using <code>filter</code> by a factor equal to the downsampling
factor, since it only calculates the needed outputs.
</p>


<h3>Author(s)</h3>

<p>Geert van Boxtel, <a href="mailto:G.J.M.vanBoxtel@gmail.com">G.J.M.vanBoxtel@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code>fir1</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x &lt;- c(1, 1, 1)
h &lt;- c(1, 1)

## FIR filter
y &lt;- upfirdn(x, h)

## FIR filter + upsampling
y &lt;- upfirdn(x, h, 5)

## FIR filter + downsampling
y &lt;- upfirdn(x, h, 1, 2)

## FIR filter + up/downsampling
y &lt;- upfirdn(x, h, 5, 2)

</code></pre>


</div>