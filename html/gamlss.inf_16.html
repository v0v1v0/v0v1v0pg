<div class="container">

<table style="width: 100%;"><tr>
<td>predict.gamlssZadj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Predictor Values and Standard Errors For New Data in a gamlssZadj Model </h2>

<h3>Description</h3>

<p><code>predict.gamlssZadj</code> is the specific method which produce predictors for a new data set   
for a specified parameter from a gamlssZadj objects.  
The <code>predict.gamlssZadj</code> can be used to extract the linear predictors, fitted values and specific  terms in the model at new 
data values in the same way that the <code>predict.lm()</code> and <code>predict.glm()</code> functions can be used for 
<code>lm</code> or <code>glm</code> objects. Note that linear predictors, fitted values and specific terms in the model at the current  
data values can also be extracted using the function <code>lpred()</code> (which is called from predict if new data is NULL).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gamlssZadj'
predict(object, parameter = c("mu", "sigma", "nu", "tau", "xi0"), 
 newdata = NULL, type = c("link", "response", "terms"),                           
   terms = NULL, se.fit = FALSE,data = NULL, ...)                                         
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a gamlssZadj fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p> which distribution (or inflation) parameter is required, default <code>parameter="mu"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a data frame containing new values for the explanatory variables used in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the default, gets the linear predictor for the specified distribution (or inflation) parameter. 
<code>type="response"</code> gets the fitted values for the parameter while <code>type="terms"</code> gets the fitted terms contribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>if <code>type="terms"</code>, which terms to be selected (default is all terms)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>if TRUE the approximate standard errors of the appropriate type are extracted if exist</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> the data frame used in the original fit if is not defined in the call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> for extra arguments </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The predict function  assumes that the object given in <code>newdata</code> is a data frame containing the right x-variables
used in the model. This could possible cause problems if transformed variables are used in the fitting of the original model.
For example, let us assume that a transformation of age is needed in the model i.e. <code>nage&lt;-age^.5</code>. This could be fitted as 
<code>mod&lt;-gamlss(y~cs(age^.5),data=mydata)</code> or as  <code>nage&lt;-age^.5;  mod&lt;-gamlss(y~cs(nage), data=mydata)</code>.
The later could more efficient if the data are in thousands rather in hundreds. In the first case,   
the code <code>predict(mod,newdata=data.frame(age=c(34,56)))</code> would produce the right results.  
In the second case a new data frame has to be created containing the old data plus any new transform data. This data frame has to 
be declared in the <code>data</code> option. The option <code>newdata</code> should 
contain a data.frame with the new names and the transformed values in which prediction is required, (see the last example). </p>


<h3>Value</h3>

<p>A vector or a matrix  depending on the options.
</p>


<h3>Author(s)</h3>

<p>Abu Hossain, Mikis Stasinopoulos <a href="mailto:mikis.stasinopoulos@gamlss.org">mikis.stasinopoulos@gamlss.org</a>, Bob Rigby and Marco Enea </p>


<h3>References</h3>

<p>Hossain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. <em>Statistics in Medicine</em>,  doi: 10.1002/sim.6748. <br></p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2003) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>


<h3>See Also</h3>

  <p><code>gamlssZadj</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(3210)
x &lt;- (runif(800)*4)-2
data(sda)
fmu &lt;- splinefun(sda$x, sda$mu)
curve(fmu, -2,2)
fsigma &lt;- splinefun(sda$x, sda$sigma)
curve(fsigma, -2,2)
fnu &lt;- function(x)
  {f &lt;- splinefun(sda$x, sda$nu)
f(x)/6
}
curve(fnu, -2,2)
set.seed(321)
y0 &lt;- rZAGA(800, mu=fmu(x), sigma=fsigma(x), nu=fnu(x))
da &lt;- data.frame(y0,x)
g0p &lt;- gamlss(y0~pb(x), sigma.fo=~pb(x), nu.fo=~pb(x), data=da, family=ZAGA)
t0p &lt;- gamlssZadj(y=y0, mu.fo=~pb(x), sigma.fo=~pb(x),data=da,
                  trace=TRUE, xi0.fo=~pb(x), family="GA")

plot(predict(g0p,"nu",type="link"),
     predict(t0p,"xi0",type="link")) 
</code></pre>


</div>