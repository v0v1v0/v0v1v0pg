<div class="container">

<table style="width: 100%;"><tr>
<td>gpr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gaussian process regression (GPR) model</h2>

<h3>Description</h3>

<p>Gaussian process regression for a single or multiple independent
realisations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpr(
  response,
  input,
  Cov = "pow.ex",
  m = NULL,
  hyper = NULL,
  NewHyper = NULL,
  meanModel = 0,
  mu = NULL,
  gamma = 2,
  nu = 1.5,
  useGradient = T,
  iter.max = 100,
  rel.tol = 8e-10,
  trace = 0,
  nInitCandidates = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>Response data. It should be a matrix, where each column is a
realisation. It can be a vector if there is only one realisation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>Input covariates. It must be either a matrix, where each column
represents a covariate, or a vector if there is only one covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cov</code></td>
<td>
<p>Covariance function(s) to use. Options are: 'linear', 'pow.ex',
'rat.qu', and 'matern'. Default to 'power.ex'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>If Subset of Data is to be used, m denotes the subset size and
cannot be larger than the total sample size. Default to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>The hyperparameters. Default to NULL. If not NULL, then it must
be a list with appropriate names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NewHyper</code></td>
<td>
<p>Vector of names of the new hyperparameters of the customized
kernel function. These names must have the format: xxxxxx.x, i.e. '6 digit'
followed by 'a dot' followed by '1 digit'. This is required for both
'hyper' and 'NewHyper'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanModel</code></td>
<td>
<p>Type of mean function. It can be </p>
 <dl>
<dt>0</dt>
<dd>
<p>Zero
mean function</p>
</dd> <dt>1</dt>
<dd>
<p>Constant mean function to be estimated</p>
</dd>
<dt>'t'</dt>
<dd>
<p>Linear model for the mean function</p>
</dd> <dt>'avg'</dt>
<dd>
<p>The average
across replications is used as the mean function. This is only used if
there are more than two realisations observed at the same input coordinate
values.</p>
</dd> </dl>
<p> Default to 0. If argument 'mu' is specified, then 'meanModel'
will be set to 'userDefined'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Mean function specified by the user. It must be a vector. Its
length must be the same as the sample size, that is, nrow(response).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Power parameter used in powered exponential kernel function. It
must be 0&lt;gamma&lt;=2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Smoothness parameter of the Matern class. It must be a positive
value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useGradient</code></td>
<td>
<p>Logical. If TRUE, first derivatives will be used in the
optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>Maximum number of iterations allowed. Default to 100. If
'rel.tol' is reduced, then the number of iterations needed will be less.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol</code></td>
<td>
<p>Relative convergence tolerance. Default to 8e-10. Smaller
rel.tol means higher accuracy and more time to converge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>The value of the objective function and the parameters is
printed every trace'th iteration. Defaults to 0 which indicates no trace
information is to be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nInitCandidates</code></td>
<td>
<p>Number of initial hyperparameter vectors. The
optimization starts with the best.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The most important function of the package. It fits the GPR model
and stores everything necessary for prediction. The optimization used in
the function is 'nlminb'. The names for the hyperparameters should be:
"linear.a" for linear covariance function, "pow.ex.w", "pow.ex.v" for power
exponential, "rat.qu.s", "rat.qu.a" for rational quadratic, "matern.w",
"matern.v" for Matern, "vv" for variance of Gaussian white noise. All
hyperparameters should be in one list.
</p>


<h3>Value</h3>

<p>A list containing: </p>
 <dl>
<dt>hyper</dt>
<dd>
<p>Hyperparameters vector
estimated from training data</p>
</dd> <dt>var.hyper</dt>
<dd>
<p> Variance of the estimated
hyperparameters</p>
</dd> <dt>fitted.mean </dt>
<dd>
<p>Fitted values for the training data </p>
</dd>
<dt>fitted.sd </dt>
<dd>
<p>Standard deviation of the fitted values for the training 
data</p>
</dd>
<dt>train.x </dt>
<dd>
<p> Training covariates</p>
</dd> <dt>train.y </dt>
<dd>
<p> Training response</p>
</dd>
<dt> train.yOri</dt>
<dd>
<p>Original training response </p>
</dd> <dt>train.DataOri </dt>
<dd>
<p>Original training covariates</p>
</dd> <dt>idxSubset </dt>
<dd>
<p>Index vector identifying
which observations were selected if Subset of Data was used.</p>
</dd> <dt>
CovFun</dt>
<dd>
<p> Covariance function type</p>
</dd> <dt> gamma</dt>
<dd>
<p>Parameter used in powered
exponential covariance function </p>
</dd> <dt>nu </dt>
<dd>
<p>Parameter used in Matern
covariance function </p>
</dd> <dt>Q</dt>
<dd>
<p>Covariance matrix </p>
</dd> <dt>mean</dt>
<dd>
<p>Mean
function </p>
</dd> <dt>meanModel</dt>
<dd>
<p>Mean model used</p>
</dd> <dt>meanLinearModel</dt>
<dd>
<p>'lm'
object if mean is a linear regression. NULL otherwise.</p>
</dd> <dt>conv</dt>
<dd>
<p>An
integer. 0 means converge; 1 otherwise. </p>
</dd> <dt>hyper0</dt>
<dd>
<p>Starting point of
the hyperparameters vector.</p>
</dd> </dl>
<h3>References</h3>

<p>Shi, J. Q., and Choi, T. (2011), “Gaussian Process Regression
Analysis for Functional Data”, CRC Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See examples in vignettes:

# vignette("gpr_ex1", package = "GPFDA")
# vignette("gpr_ex2", package = "GPFDA")
# vignette("co2", package = "GPFDA")
</code></pre>


</div>