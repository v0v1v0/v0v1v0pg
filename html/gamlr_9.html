<div class="container">

<table style="width: 100%;"><tr>
<td>hockey</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> NHL hockey data </h2>

<h3>Description</h3>

<p>Every NHL goal from fall 2002 through the 2014 cup finals.</p>


<h3>Details</h3>

<p> The data comprise of information about 
play configuration and the
players on ice  (including goalies) for every
goal from 2002-03 to 2012-14 NHL seasons. 
Collected using A. C. Thomas's <code>nlhscrapr</code> package. 
See the Chicago hockey analytics project at <code>github.com/mataddy/hockey</code>.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>goal</code></td>
<td>
<p> Info about each goal scored, including <code>homegoal</code> â€“ an indicator for the home team scoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>player</code></td>
<td>
<p> Sparse Matrix with entries for who was on the ice for each goal: +1 for a home team player, -1 for an away team player, zero otherwise. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>team</code></td>
<td>
<p> Sparse Matrix with indicators for each team*season interaction: +1 for home team, -1 for away team. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>config</code></td>
<td>
<p> Special teams info. For example,
<code>S5v4</code> is a 5 on 4 powerplay,
+1 if it is for the home-team and -1 for the away team.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matt Taddy, <a href="mailto:mataddy@gmail.com">mataddy@gmail.com</a>
</p>


<h3>References</h3>

<p>Gramacy, Jensen, and Taddy (2013): "Estimating Player
Contribution in Hockey with Regularized Logistic Regression", the Journal of Quantitative Analysis in Sport.
</p>
<p>Gramacy, Taddy, and Tian (2015): "Hockey Player Performance via Regularized Logistic Regression", the Handbook of statistical methods for design and analysis in sports.
</p>


<h3>See Also</h3>

<p>gamlr</p>


<h3>Examples</h3>

<pre><code class="language-R">## design 
data(hockey)
x &lt;- cbind(config,team,player)
y &lt;- goal$homegoal

## fit the plus-minus regression model
## (non-player effects are unpenalized)

fit &lt;- gamlr(x, y, 
  lambda.min.ratio=0.05, nlambda=40, ## just so it runs in under 5 sec
  free=1:(ncol(config)+ncol(team)),
  standardize=FALSE, family="binomial")
plot(fit)

## look at estimated player [career] effects
B &lt;- coef(fit)[colnames(player),]
sum(B!=0) # number of measurable effects (AICc selection)
B[order(-B)[1:10]] # 10 biggest

## convert to 2013-2014 season partial plus-minus
now &lt;- goal$season=="20132014"
pm &lt;- colSums(player[now,names(B)]*c(-1,1)[y[now]+1]) # traditional plus minus
ng &lt;- colSums(abs(player[now,names(B)])) # total number of goals
# The individual effect on probability that a
# given goal is for vs against that player's team
p &lt;- 1/(1+exp(-B)) 
# multiply ng*p - ng*(1-p) to get expected plus-minus
ppm &lt;- ng*(2*p-1)

# organize the data together and print top 20
effect &lt;- data.frame(b=round(B,3),ppm=round(ppm,3),pm=pm)
effect &lt;- effect[order(-effect$ppm),]
print(effect[1:20,])
</code></pre>


</div>