<div class="container">

<table style="width: 100%;"><tr>
<td>density.reflected</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Kernel Density Estimation with Reflection
</h2>

<h3>Description</h3>

<p>The function <code>density.reflected</code> computes kernel density estimates for univariate observations using reflection in the borders.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'reflected'
density(x, lower = -Inf, upper = Inf, weights= NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data from which the estimate is to be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>the lower limit of the interval to which x is theoretically constrained, default -Inf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>the upper limit of the interval to which x is theoretically constrained, default, Inf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as x.
The default NULL is equivalent to weights = rep(1/length(x), length(x)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further <code>density</code> arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>density.reflected</code> is called by <code>dgeometric.test</code> and computes the density
kernel estimate of a univariate random sample <code>x</code> of a random variable defined in
the interval <code>(lower,upper)</code> using the default options of <code>density</code> and reflection in the borders.
This avoids the density kernel estimate being underestimated in the proximity of <code>lower</code> or <code>upper</code>.
For unbounded variables, <code>density.reflected</code> generates the same output as <code>density</code> with its default options.</p>


<h3>Value</h3>

<p>An object of the class <code>density</code> with borders correction, whose underlying structure
is a list containing the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the <code>n</code> coordinates of the points where the density is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the estimated density values. These will be non-negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>the bandwidth used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the sample size after elimination of missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call which produced the result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>the deparsed name of the <code>x</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>has.na</code></td>
<td>
<p>logical, for compatibility (always <code>FALSE</code>).</p>
</td>
</tr>
</table>
<p>The <code>print</code> method reports <code>summary</code> values on the <code>x</code> and <code>y</code> components.
</p>


<h3>Note</h3>

<p>The function is based on <code>density</code>.
</p>


<h3>Author(s)</h3>

<p>Jose M. Pavia
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) "The New S Language." Wadsworth &amp; Brooks/Cole (for S version).
</p>
<p>Scott, D. W. (1992) "Multivariate Density Estimation. Theory, Practice and Visualization." New York: Wiley.
</p>
<p>Sheather, S. J. and Jones M. C. (1991) "A reliable data-based bandwidth selection method for kernel density estimation." J. Roy. Statist. Soc. B, 683â€“690.
</p>
<p>Silverman, B. W. (1986) "Density Estimation." London: Chapman and Hall.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) "Modern Applied Statistics with S." New York: Springer.
</p>


<h3>See Also</h3>

<p><code>dgeometric.test</code> and <code>density</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(234)
x &lt;- runif(2000)
dx &lt;- density.reflected(x,0,1)

## Plot of the density estimate with and without reflection
par(mfcol=c(1,2))
plot(dx, xlim=c(-0.1,1.1), ylim=c(0,1.1))
abline(h=1, col="red")

plot(density(x), xlim=c(-0.1,1.1), ylim=c(0,1.1))
abline(h=1, col="blue")
</code></pre>


</div>