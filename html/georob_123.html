<div class="container">

<table style="width: 100%;"><tr>
<td>georobS3methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Common S3 Methods for Class <code>georob</code>
</h2>

<h3>Description</h3>

<p>This page documents the methods <code>coef</code>, <code>fixef</code>,
<code>fixed.effects</code>, <code>model.frame</code>, <code>model.matrix</code>,
<code>nobs</code>, <code>print</code>, <code>ranef</code>, <code>random.effects</code>,
<code>resid</code>, <code>residuals</code>, <code>rstandard</code>, 
<code>summary</code> and <code>vcov</code> for the class <code>georob</code> which extract
the respective components or summarize a <code>georob</code> object.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'georob'
coef(object, what = c("trend", "variogram"), ...)

## S3 method for class 'georob'
fixef(object, ...)

## S3 method for class 'georob'
fixed.effects(object, ...)

## S3 method for class 'georob'
model.frame(formula, ...)

## S3 method for class 'georob'
model.matrix(object, ...)

## S3 method for class 'georob'
nobs(object, ...)

## S3 method for class 'georob'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'georob'
ranef(object, standard = FALSE, ...)

## S3 method for class 'georob'
random.effects(object, standard = FALSE, ...)

## S3 method for class 'georob'
resid(object,
    type = c("working", "response", "deviance", "pearson", "partial"),
    terms = NULL,
    level = 1, ...)

## S3 method for class 'georob'
residuals(object,
    type = c("working", "response", "deviance", "pearson", "partial"),
    terms  = NULL,
    level = 1, ...)

## S3 method for class 'georob'
rstandard(model, level = 1, ...)

## S3 method for class 'georob'
summary(object, correlation = FALSE, signif = 0.95, ...)

## S3 method for class 'georob'
vcov(object, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object, model, x</code></td>
<td>
<p>an object of class <code>georob</code>, see
<code>georobObject</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a model <code>formula</code> or
<code>terms</code> object or an object of class <code>georob</code>, see
<code>georobObject</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>a logical scalar controlling whether the correlation
matrix of the estimated regression coefficients and of the fitted
variogram parameters (only for non-robust fits) is computed (default
<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>a positive integer indicating the number of decimal digits to print.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>an optional integer giving the level for extracting the
residuals from <code>object</code>.  <code>level = 0</code> extracts the regression
residuals <code class="reqn">\widehat{B}(\boldsymbol{s}) +
  \widehat{\varepsilon}(\boldsymbol{s})</code> and <code>level = 1</code> (default) only the estimated errors
<code class="reqn">\widehat{\varepsilon}(\boldsymbol{s})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif</code></td>
<td>
<p>a numeric with the confidence level for computing
confidence intervals for variogram parameters (default <code>0.95</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard</code></td>
<td>
<p>a logical scalar controlling whether the spatial random effects
<code class="reqn">\boldsymbol{B}</code> should be standardized (default
<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character keyword indicating the type of residuals to
compute, see <code>residuals.lm</code>.
<code>type = "huber"</code>
computes ‘huberized’ residuals <code class="reqn">\widehat{\sigma} /
  \gamma_1\psi(\widehat{\varepsilon}(\boldsymbol{s}) /
  \widehat{\sigma})</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>If <code>type = "terms"</code>, which terms (default is all terms).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>If <code>what = "trend"</code> (default) the function <code>coef</code>
extracts the coefficients of the trend model and for <code>what =
  "variogram"</code> the variogram parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For robust REML fits <code>deviance</code> returns (possibly with a warning)
the deviance of the Gaussian REML fit of the equivalent Gaussian spatial
linear model with heteroscedastic nugget.
</p>
<p>The methods <code>model.frame</code>, <code>model.matrix</code> and <code>nobs</code>
extract the model frame, model matrix and the number of observations, see
help pages of respective generic functions.
</p>
<p>The methods <code>residuals</code> (and <code>resid</code>) extract either the
estimated independent errors
<code class="reqn">\widehat{\varepsilon}(\boldsymbol{s})</code>
or the sum of the latter quantities and the spatial random effects
<code class="reqn">\widehat{B}(\boldsymbol{s})</code>.
<code>rstandard</code> does the same but standardizes the residuals to unit
variance.  <code>ranef</code> (<code>random.effects</code>) extracts the spatial
random effects with the option to standardize them as well, and
<code>fixef</code> (<code>fixed.effects</code>) extracts the fitted fixed-effects
regression coefficients, which may of course also be obtained by
<code>coef</code>.
</p>
<p>For Gaussian REML the method <code>summary</code> computes confidence intervals
of the estimated variogram and anisotropy parameters from the Hessian
matrix of the (restricted) log-likelihood (= observed Fisher
information), based on the asymptotic normal distribution of (RE)ML
estimates.  Note that the Hessian matrix with respect to the
<em>transformed</em> variogram and anisotropy parameters is used for this.
Hence the inverse Hessian matrix is the covariance matrix of the
transformed parameters, confidence intervals are first computed for the
transformed parameters and the limits of these intervals are transformed
back to the orginal scale of the parameters.  Optionally, <code>summary</code>
reports the correlation matrix of the <em>transformed</em> parameters, also
computed from the Hessian matrix.
</p>
<p>Note that the methods <code>coef</code> and <code>summary</code> generate objects of
class <code>coef.georob</code> and <code>summary.georob</code>, respectively, for
which only <code>print</code> methods are available.
</p>
<p>Besides, the default methods of the generic functions
<code>confint</code>,
<code>df.residual</code>, <code>fitted</code>,
<code>formula</code>, <code>termplot</code> and
<code>update</code> can be used for objects of class
<code>georob</code>.
</p>


<h3>Value</h3>

<p>The methods <code>fixef.georob</code> and <code>fixed.effects.georob</code> return
the numeric vector of estimated fixed-effects regression coefficients, and
<code>vcov.georob</code> returns the covariance matrix of the estimated
regression coefficients.
</p>
<p>The method <code>coef.georob</code> returns an object of class
<code>coef.georob</code> which is a numeric vector with estimated fixed-effects
regression coefficients or variogram and anisotropy parameters.  There is
a <code>print</code> method for objects of class <code>coef.georob</code> which
returns invisibly the object unchanged.
</p>
<p>The methods <code>resid.georob</code>, <code>residuals.georob</code> and
<code>rstandard.georob</code> return numeric vectors of (standardized)
residuals, and <code>ranef.georob</code> and <code>random.effects.georob</code> the
numeric vector of (standardized) spatial random effects, see
<em>Details</em>.
</p>
<p>The methods <code>model.frame.georob</code> and <code>model.matrix.georob</code>
return a model frame and the fixed-effects model matrix, respectively,
and <code>nobs.georob</code> returns the number of observations used to fit a
spatial linear model.
</p>
<p>The method <code>summary.georob</code> generates an object of class
<code>summary.georob</code> which is a list with components extracted directly
from <code>object</code> (<code>call</code>, <code>residuals</code>, <code>bhat</code>,
<code>rweights</code>, <code>converged</code>, <code>convergence.code</code>, <code>iter</code>,
<code>loglik</code>, <code>variogram.object</code>, <code>gradient</code>,
<code>tuning.psi</code>, <code>df.residual</code>, <code>control</code>, <code>terms</code>)
and complemented by the following components:
</p>

<dl>
<dt><code>scale</code></dt>
<dd>
<p>the square root of the estimated nugget effect
<code class="reqn">\tau^2</code>.</p>
</dd>
<dt><code>coefficients</code></dt>
<dd>
<p>a 4-column matrix with estimated regression
coefficients, their standard errors, <var>t</var>-statistics and
corresponding (two-sided) <var>p</var>-values.</p>
</dd>
<dt><code>correlation</code></dt>
<dd>
<p>an optional <code>compress</code>ed
lower-triagonal matrix with the Pearson correlation coefficients of the
estimated regression coefficients.</p>
</dd>
<dt><code>param.aniso</code></dt>
<dd>
<p>either a vector (robust REML) or a 3-column
matrix (Gaussian REML) with estimated variogram and anisotropy
parameters, complemented for Gaussian REML with confidence limits, see
<em>Details</em>.</p>
</dd>
<dt><code>cor.tf.param</code></dt>
<dd>
<p>an optional <code>compress</code>ed
lower-triagonal matrix with the Pearson correlation coefficients of
estimated transformed variogram and anisotropy parameters, see
<em>Details</em>.</p>
</dd>
<dt><code>se.residuals</code></dt>
<dd>
<p>a vector with the standard errors of the
estimated <code class="reqn">\varepsilon</code>.</p>
</dd>
</dl>
<p>There is a <code>print</code> methods for class <code>summary.georob</code> which
invisibly returns the object unchanged.
</p>
<p>The method <code>print.georob</code> invisibly returns the object unchanged.
</p>


<h3>Author(s)</h3>

<p>Andreas Papritz <a href="mailto:papritz@retired.ethz.ch">papritz@retired.ethz.ch</a>.
</p>


<h3>See Also</h3>

<p><code>georobPackage</code> for a description of the model and a brief summary of the algorithms;
</p>
<p><code>georob</code> for (robust) fitting of spatial linear models;
</p>
<p><code>georobObject</code> for a description of the class <code>georob</code>;
</p>
<p><code>profilelogLik</code> for computing profiles of Gaussian likelihoods;
</p>
<p><code>plot.georob</code> for display of RE(ML) variogram estimates;
</p>
<p><code>control.georob</code> for controlling the behaviour of <code>georob</code>;
</p>
<p><code>georobModelBuilding</code> for stepwise building models of class <code>georob</code>;
</p>
<p><code>cv.georob</code> for assessing the goodness of a fit by <code>georob</code>;

</p>
<p><code>predict.georob</code> for computing robust Kriging predictions;

</p>
<p><code>lgnpp</code> for unbiased back-transformation of Kriging prediction
of log-transformed data;
</p>
<p><code>georobSimulation</code> for simulating realizations of a Gaussian process
from model fitted by <code>georob</code>; and finally
</p>
<p><code>sample.variogram</code> and <code>fit.variogram.model</code>
for robust estimation and modelling of sample variograms.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(meuse)

## Gaussian REML fit
r.logzn.reml &lt;- georob(log(zinc) ~ sqrt(dist), data = meuse, locations = ~ x + y,
    variogram.model = "RMexp",
    param = c(variance = 0.15, nugget = 0.05, scale = 200),
    tuning.psi = 1000)
summary(r.logzn.reml, correlation = TRUE)

## robust REML fit
r.logzn.rob &lt;- update(r.logzn.reml, tuning.psi = 1)

summary(r.logzn.rob, correlation = TRUE)

## residual diagnostics
old.par &lt;- par(mfrow = c(2,3))

plot(fitted(r.logzn.reml), rstandard(r.logzn.reml))
abline(h = 0, lty = "dotted")
qqnorm(rstandard(r.logzn.reml))
abline(0, 1)
qqnorm(ranef(r.logzn.reml, standard = TRUE))
abline(0, 1)
plot(fitted(r.logzn.rob), rstandard(r.logzn.rob))
abline(h = 0, lty = "dotted")
qqnorm(rstandard(r.logzn.rob))
abline(0, 1)
qqnorm(ranef(r.logzn.rob, standard = TRUE))
abline(0, 1)

par(old.par)
</code></pre>


</div>