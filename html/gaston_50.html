<div class="container">

<table style="width: 100%;"><tr>
<td>lmm.diago.likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Likelihood of a linear mixed model </h2>

<h3>Description</h3>

<p>Compute the Restricted or the Full Likelihood of a linear mixed model, using the "diagonalization trick".
</p>


<h3>Usage</h3>

<pre><code class="language-R"> lmm.diago.likelihood(tau, s2, h2, Y, X, eigenK, p = 0) 
 lmm.diago.profile.likelihood(tau, s2, h2, Y, X, eigenK, p = 0) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p> Value(s) of model parameter (see Details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>  Value(s) of model parameter (see Details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>  Value(s) of heritability (see Details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> Phenotype vector </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> Covariable matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenK</code></td>
<td>
<p> Eigen decomposition of <code class="reqn">K</code> (a positive symmetric matrix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> Number of Principal Components included in the mixed model with fixed effect </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Theses function respectively compute the Restricted and the Profile Likelihood under the linear 
mixed model
</p>
<p style="text-align: center;"><code class="reqn"> Y = (X|PC)\beta + \omega + \varepsilon </code>
</p>

<p>with <code class="reqn"> \omega \sim N(0,\tau K) </code> and 
<code class="reqn"> \varepsilon \sim N(0,\sigma^2 I_n) </code>. 
</p>
<p>The matrix <code class="reqn">K</code> is given through its eigen decomposition, as produced by <code>eigenK = eigen(K, symmetric = TRUE)</code>.
The matrix <code class="reqn">(X|PC)</code> is the concatenation of the covariable matrix <code class="reqn">X</code> and 
of the first <code class="reqn">p</code> eigenvectors of <code class="reqn">K</code>, included in the model with fixed effects.
</p>
<p>If both <code>tau</code> and <code>s2</code> (for <code class="reqn">\sigma^2</code>) are provided, <code>lmm.diago.likelihood</code>
computes the restricted
likelihood for these values of the parameters; if these parameters are vectors of length <code class="reqn">&gt; 1</code>,
then a matrix of likelihood values is computed. 
</p>
<p>The function <code>lmm.diago.profile.likelihood</code> computes the full likelihood, profiled for <code class="reqn">\beta</code>.
That is, the value <code class="reqn">\beta</code> which maximizes the full likelihood for the given values of <code class="reqn">\tau</code>
and <code class="reqn">\sigma^2</code> is computed, and then the full likelihood is computed.
</p>
<p>If <code>h2</code> is provided, both functions compute <code class="reqn">\tau</code> and <code class="reqn">\sigma^2</code> which
maximizes the likelihood under the constraint <code class="reqn"> {\tau \over \tau + \sigma^2 } = h^2 </code>,
and output these values as well as the likelihood value at this point.
</p>


<h3>Value</h3>

<p>If <code>tau</code> and <code>s2</code> are provided, the corresponding likelihood values.
</p>
<p>If <code>tau</code> or <code>s2</code> are missing, and <code>h2</code> is provided, a named list with members
</p>
<table>
<tr style="vertical-align: top;">
<td><code> tau </code></td>
<td>
<p> Corresponding values of <code class="reqn">\tau</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> sigma2 </code></td>
<td>
<p> Corresponding values of <code class="reqn">\sigma^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> likelihood </code></td>
<td>
<p> Corresponding likelihood values </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Herv√© Perdry and Claire Dandine-Roulland </p>


<h3>See Also</h3>

 <p><code>lmm.restricted.likelihood</code>, <code>lmm.profile.restricted.likelihood</code>,  <code>lmm.diago</code>, <code>lmm.aireml</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data
data(AGT)
x &lt;- as.bed.matrix(AGT.gen, AGT.fam, AGT.bim)

# Compute Genetic Relationship Matrix
K &lt;- GRM(x)

# eigen decomposition of K
eiK &lt;- eigen(K)

# simulate a phenotype
set.seed(1)
y &lt;- 1 + lmm.simu(tau = 1, sigma2 = 2, eigenK = eiK)$y
     
# Likelihood
TAU &lt;- seq(0.5,1.5,length=30)
S2 &lt;- seq(1,3,length=30)
lik1 &lt;- lmm.diago.likelihood(tau = TAU, s2 = S2, Y = y, eigenK = eiK)

H2 &lt;- seq(0,1,length=51)
lik2 &lt;- lmm.diago.likelihood(h2 = H2, Y = y, eigenK = eiK)

# Plotting
par(mfrow=c(1,2))
lik.contour(TAU, S2, lik1, heat = TRUE, xlab = "tau", ylab = "sigma^2")
lines(lik2$tau, lik2$sigma2)
plot(H2, exp(lik2$likelihood), type="l", xlab="h^2", ylab = "likelihood")
</code></pre>


</div>