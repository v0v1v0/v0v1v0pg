<div class="container">

<table style="width: 100%;"><tr>
<td>affine_transform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Translate, scale, and rotate ggplot2 layers (Layer operation)</h2>

<h3>Description</h3>

<p>Transform objects within a single layer (geom) or across multiple layers (geoms)
using affine transformations, like translation, scale, and rotation. Uses
the built-in compositing support in graphical devices added in R 4.2.
</p>


<h3>Usage</h3>

<pre><code class="language-R">affine_transform(object, x = 0, y = 0, width = 1, height = 1, angle = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>One of:
</p>

<ul>
<li>
<p> A layer-like object: applies this operation to the layer.
</p>
</li>
<li>
<p> A missing argument: creates an operation
</p>
</li>
<li>
<p> A <code>numeric()</code> or <code>unit()</code> giving the x-axis translation,
which takes the place of the <code>x</code> argument.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>numeric()</code> or <code>unit()</code> giving the x translation to apply.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A <code>numeric()</code> or <code>unit()</code> giving the y translation to apply.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>A <code>numeric()</code> or <code>unit()</code> giving the width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>A <code>numeric()</code> or <code>unit()</code> giving the height.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>A <code>numeric()</code> giving the angle to rotate, in degrees.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Applies an affine transformation (translation, scaling, rotation) to a layer.
</p>
<p><strong>Note:</strong> due to limitations in the implementation of scaling and rotation,
currently these operations can only be performed relative to the center of
the plot. In future versions, the translation and rotation origin may be
configurable.
</p>


<h3>Value</h3>

<p>A layer-like object (if <code>object</code> is layer-like) or an operation (if not).
</p>


<h3>Supported devices</h3>

<p>Transformation is not currently supported by all graphics devices. As of this writing,
at least <code>png(type = "cairo")</code>, <code>svg()</code>, and <code>cairo_pdf()</code> are known to support
blending.
</p>
<p><code>affine_transform()</code> attempts to auto-detect support for affine transformation using <code>dev.capabilities()</code>.
You may receive a warning when using <code>affine_transform()</code> if it appears transformation is not
supported by the current graphics device. This warning <strong>either</strong> means (1)
your graphics device does not support transformation (in which case you should
switch to one that does) or (2) your graphics device
supports transformation but incorrectly reports that it does not. Unfortunately,
not all graphics devices that support transformation appear to correctly <em>report</em>
that they support transformation, so even if auto-detection fails, <code>blend()</code> will
still attempt to apply the transformation, just in case.
</p>
<p>If the warning is issued and the output is still correctly transformed, this is
likely a bug in the graphics device. You can report the bug to the authors of
the graphics device if you wish; in the mean time, you can use
<code>options(ggblend.check_affine_transform = FALSE)</code> to disable the check.
</p>


<h3>References</h3>

<p>Murrell, Paul (2021):
<a href="https://www.stat.auckland.ac.nz/~paul/Reports/GraphicsEngine/groups/groups.html">Groups, Compositing Operators, and Affine Transformations in R Graphics</a>.
The University of Auckland. Report.
<a href="https://doi.org/10.17608/k6.auckland.17009120.v1">doi:10.17608/k6.auckland.17009120.v1</a>.
</p>


<h3>See Also</h3>

<p>operation for a description of layer operations.
</p>
<p>Other layer operations: 
<code>adjust</code>,
<code>blend</code>,
<code>copy</code>,
<code>nop</code>,
<code>partition()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(ggplot2)

# a simple dataset:
set.seed(1234)
data.frame(x = rnorm(100), y = rnorm(100)) |&gt;
  ggplot(aes(x, y)) +
  geom_point() +
  xlim(-5, 5)

# we could scale and translate copies of the point cloud
# (though I'm not sure why...)
data.frame(x = rnorm(100), y = rnorm(100)) |&gt;
  ggplot(aes(x, y)) +
  geom_point() * (
    affine_transform(x = -unit(100, "pt"), width = 0.5) |&gt; adjust(color = "red") +
    affine_transform(width = 0.5) +
    affine_transform(x = unit(100, "pt"), width = 0.5) |&gt; adjust(color = "blue")
  ) +
  xlim(-5, 5)

</code></pre>


</div>