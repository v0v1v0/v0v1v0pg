<div class="container">

<table style="width: 100%;"><tr>
<td>gssanova0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Smoothing Spline ANOVA Models with Non-Gaussian Responses</h2>

<h3>Description</h3>

<p>Fit smoothing spline ANOVA models in non-Gaussian regression.  The
symbolic model specification via <code>formula</code> follows the same
rules as in <code>lm</code> and <code>glm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gssanova0(formula, family, type=NULL, data=list(), weights, subset,
          offset, na.action=na.omit, partial=NULL, method=NULL,
          varht=1, nu=NULL, prec=1e-7, maxiter=30)

gssanova1(formula, family, type=NULL, data=list(), weights, subset,
          offset, na.action=na.omit, partial=NULL, method=NULL,
          varht=1, alpha=1.4, nu=NULL, id.basis=NULL, nbasis=NULL,
          seed=NULL, random=NULL, skip.iter=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Symbolic description of the model to be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Description of the error distribution.  Supported
are exponential families <code>"binomial"</code>, <code>"poisson"</code>,
<code>"Gamma"</code>, <code>"inverse.gaussian"</code>, and
<code>"nbinomial"</code>.  Also supported are accelerated life model
families <code>"weibull"</code>, <code>"lognorm"</code>, and
<code>"loglogis"</code>.  Further more, proportional odds logistic
regression <code>"polr"</code> for ordinal response is also
supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>List specifying the type of spline for each variable.
See <code>mkterm</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional data frame containing the variables in the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of weights to be used in the
fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Optional offset term with known parameter 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Function which indicates what should happen when
the data contain NAs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>Optional symbolic description of parametric terms in
partial spline models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Score used to drive the performance-oriented
iteration.  Supported are <code>method="v"</code> for GCV,
<code>method="m"</code> for GML, and <code>method="u"</code> for Mallows' CL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varht</code></td>
<td>
<p>Dispersion parameter needed for <code>method="u"</code>.
Ignored when <code>method="v"</code> or <code>method="m"</code> are
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Inverse scale parameter in accelerated life model
families.  Ignored for exponential families.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>Precision requirement for the iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for
performance-oriented iteration, and for inner-loop multiple
smoothing parameter selection when applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Tuning parameter modifying GCV or Mallows' CL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.basis</code></td>
<td>
<p>Index designating selected "knots".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>Number of "knots" to be selected.  Ignored when
<code>id.basis</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for reproducible random selection of "knots".
Ignored when <code>id.basis</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>Input for parametric random effects in nonparametric
mixed-effect models.  See <code>mkran</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip.iter</code></td>
<td>
<p>Flag indicating whether to use initial values of
theta and skip theta iteration.  See <code>ssanova</code> for
notes on skipping theta iteration.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model specification via <code>formula</code> is intuitive.  For
example, <code>y~x1*x2</code> yields a model of the form
</p>
<p style="text-align: center;"><code class="reqn">
	y = C + f_{1}(x1) + f_{2}(x2) + f_{12}(x1,x2) + e
    </code>
</p>

<p>with the terms denoted by <code>"1"</code>, <code>"x1"</code>, <code>"x2"</code>, and
<code>"x1:x2"</code>.
</p>
<p>The model terms are sums of unpenalized and penalized
terms. Attached to every penalized term there is a smoothing
parameter, and the model complexity is largely determined by the
number of smoothing parameters.
</p>
<p>Only one link is implemented for each <code>family</code>.  It is the
logit link for <code>"binomial"</code>, and the log link for
<code>"poisson"</code>, <code>"Gamma"</code>, and <code>"inverse.gaussian"</code>.
For <code>"nbinomial"</code>, the working parameter is the logit of the
probability <code class="reqn">p</code>; see <code>NegBinomial</code>.  For
<code>"weibull"</code>, <code>"lognorm"</code>, and <code>"loglogis"</code>, it is the
location parameter for the log lifetime.
</p>
<p>The models are fitted by penalized likelihood method through the
performance-oriented iteration as described in the reference.  For
<code>family="binomial"</code>, <code>"poisson"</code>, <code>"nbinomial"</code>,
<code>"weibull"</code>, <code>"lognorm"</code>, and <code>"loglogis"</code>, the score
driving the performance-oriented iteration defaults to
<code>method="u"</code> with <code>varht=1</code>.  For <code>family="Gamma"</code>
and <code>"inverse.gaussian"</code>, the default is <code>method="v"</code>.
</p>
<p><code>gssanova0</code> uses the algorithm of <code>ssanova0</code> for
the iterated penalized least squares problems, whereas
<code>gssanova1</code> uses the algorithm of <code>ssanova</code>.
</p>
<p>In <code>gssanova1</code>, a subset of the observations are selected as
"knots."  Unless specified via <code>id.basis</code> or <code>nbasis</code>, the
number of "knots" <code class="reqn">q</code> is determined by <code class="reqn">max(30,10n^{2/9})</code>,
which is appropriate for the default cubic splines for numerical
vectors.
</p>


<h3>Value</h3>

<p><code>gssanova0</code> returns a list object of class
<code>c("gssanova0","ssanova0","gssanova")</code>.
</p>
<p><code>gssanova1</code> returns a list object of class
<code>c("gssanova","ssanova")</code>.
</p>
<p>The method <code>summary.gssanova0</code> or
<code>summary.gssanova</code> can be used to obtain summaries of
the fits.  The method <code>predict.ssanova0</code> or
<code>predict.ssanova</code> can be used to evaluate the fits at
arbitrary points along with standard errors, on the link scale.  The
methods <code>residuals.gssanova</code> and
<code>fitted.gssanova</code> extract the respective traits from the
fits.
</p>


<h3>Responses</h3>

<p>For <code>family="binomial"</code>, the response can be specified either
as two columns of counts or as a column of sample proportions plus a
column of total counts entered through the argument <code>weights</code>,
as in <code>glm</code>.
</p>
<p>For <code>family="nbinomial"</code>, the response may be specified as two
columns with the second being the known sizes, or simply as a single
column with the common unknown size to be estimated through the
maximum likelihood.
</p>
<p>For <code>family="weibull"</code>, <code>"lognorm"</code>, or <code>"loglogis"</code>,
the response consists of three columns, with the first giving the
follow-up time, the second the censoring status, and the third the
left-truncation time.  For data with no truncation, the third column
can be omitted.
</p>
<p>For <code>family="polr"</code>, the response should be an ordered factor.
</p>


<h3>Note</h3>

<p>The direct cross-validation of <code>gssanova</code> can be more
effective, and more stable for complex models.
</p>
<p>For large sample sizes, the approximate solutions of
<code>gssanova1</code> and <code>gssanova</code> can be faster than
<code>gssanova0</code>.
</p>
<p>The results from <code>gssanova1</code> may vary from run to run. For
consistency, specify <code>id.basis</code> or set <code>seed</code>.
</p>
<p>The method <code>project</code> is not implemented for
<code>gssanova0</code>, nor is the mixed-effect model support through
<code>mkran</code>.
</p>
<p>In <em>gss</em> versions earlier than 1.0, <code>gssanova0</code> was under
the name <code>gssanova</code>.
</p>


<h3>References</h3>

<p>Gu, C. (1992), Cross-validating non Gaussian data. <em>Journal
of Computational and Graphical Statistics</em>, <b>1</b>, 169-179.
</p>
<p>Gu, C. (2013), <em>Smoothing Spline ANOVA Models (2nd Ed)</em>.  New
York: Springer-Verlag.
</p>
<p>GU, C. (2014), Smoothing Spline ANOVA Models: R Package
gss. <em>Journal of Statistical Software</em>, 58(5), 1-25. URL
http://www.jstatsoft.org/v58/i05/.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fit a cubic smoothing spline logistic regression model
test &lt;- function(x)
        {.3*(1e6*(x^11*(1-x)^6)+1e4*(x^3*(1-x)^10))-2}
x &lt;- (0:100)/100
p &lt;- 1-1/(1+exp(test(x)))
y &lt;- rbinom(x,3,p)
logit.fit &lt;- gssanova0(cbind(y,3-y)~x,family="binomial")
## The same fit
logit.fit1 &lt;- gssanova0(y/3~x,"binomial",weights=rep(3,101))
## Obtain estimates and standard errors on a grid
est &lt;- predict(logit.fit,data.frame(x=x),se=TRUE)
## Plot the fit and the Bayesian confidence intervals
plot(x,y/3,ylab="p")
lines(x,p,col=1)
lines(x,1-1/(1+exp(est$fit)),col=2)
lines(x,1-1/(1+exp(est$fit+1.96*est$se)),col=3)
lines(x,1-1/(1+exp(est$fit-1.96*est$se)),col=3)
## Clean up
## Not run: rm(test,x,p,y,logit.fit,logit.fit1,est)
dev.off()
## End(Not run)
</code></pre>


</div>