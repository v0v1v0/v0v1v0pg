<div class="container">

<table style="width: 100%;"><tr>
<td>NormalizeBaseline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normalization to a baseline</h2>

<h3>Description</h3>

<p>Normalizes data in a grandR object to a baseline and puts the normalized data into a new slot
</p>


<h3>Usage</h3>

<pre><code class="language-R">NormalizeBaseline(
  data,
  baseline = FindReferences(data, reference = Condition == levels(Condition)[1]),
  name = "baseline",
  slot = DefaultSlot(data),
  set.to.default = FALSE,
  LFC.fun = lfc::PsiLFC,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the grandR object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline</code></td>
<td>
<p>matrix defining the corresponding baseline (row) for each column (sample or cell; see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>the name of the new slot for the normalized data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>the name of the slot for the data to normalize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.to.default</code></td>
<td>
<p>set the new slot as the default slot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LFC.fun</code></td>
<td>
<p>either NormLFC or PsiLFC from the lfc package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>forwarded to LFC.fun</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Baseline normalization computes the log2 fold change for a column (i.e. sample or cell) to a baseline columns (or several baseline columns). This is by default done using the
<code>PsiLFC</code> function from the lfc package, which, by default, also normalizes log2 fold changes by adding a constant
such that the median is zero.
</p>
<p>Baselines are defined by a square logical matrix, defining for each sample or cell of the grandR object, represented by the column of the matrix,
which samples or cells are indeed the baseline (represented by the rows). Such matrices can conveniently be obtained by <code>FindReferences</code>.
</p>


<h3>Value</h3>

<p>a new grandR object with an additional slot
</p>


<h3>See Also</h3>

<p><code>Normalize</code>,<code>FindReferences</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sars &lt;- ReadGRAND(system.file("extdata", "sars.tsv.gz", package = "grandR"),
                  design=c("Cell",Design$dur.4sU,Design$Replicate))
blmat &lt;- FindReferences(sars,reference = duration.4sU==0, group = "Cell")
# the Mock.no4sU or SARS.no4sU sample are the baselines for each sample
sars &lt;- NormalizeBaseline(sars,baseline=blmat)
head(GetTable(sars,type="baseline"))
</code></pre>


</div>