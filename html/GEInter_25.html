<div class="container">

<table style="width: 100%;"><tr>
<td>PTReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust gene-environment interaction analysis using penalized trimmed regression</h2>

<h3>Description</h3>

<p>Gene-environment interaction analysis using penalized trimmed regression, which is robust to
outliers in both predictor and response spaces. The objective function is based on trimming
technique, where the samples with extreme absolute residuals are trimmed. A decomposition
framework is adopted for accommodating "main effects-interactions" hierarchy, and minimax
concave penalty (MCP) is adopted for regularized estimation and interaction (and main genetic
effect) selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PTReg(
  G,
  E,
  Y,
  lambda1,
  lambda2,
  gamma1 = 6,
  gamma2 = 6,
  max_init,
  h = NULL,
  tau = 0.4,
  mu = 2.5,
  family = c("continuous", "survival")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Input matrix of <code>p</code> genetic (G) measurements consisting of <code>n</code> rows. Each
row is an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Input matrix of <code>q</code> environmental (E) risk factors. Each row is an observation
vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response variable. A quantitative vector for <code>family="continuous"</code>. For
<code>family="survival"</code>, <code>Y</code> should be a two-column matrix with the first column being
the log(survival time) and the second column being the censoring indicator. The indicator is a
binary variable, with "1" indicating dead, and "0" indicating right censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>A user supplied lambda for MCP accommodating main G effect selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>A user supplied lambda for MCP accommodating G-E interaction selecton.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma1</code></td>
<td>
<p>The regularization parameter of the MCP penalty corresponding to G effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma2</code></td>
<td>
<p>The regularization parameter of the MCP penalty corresponding to G-E
interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_init</code></td>
<td>
<p>The number of initializations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>The number of the trimmed samples if the parameter <code>mu</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The threshold value used in stability selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The parameter for screening outliers with extreme absolute residuals if the number
of the trimmed samples <code>h</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Response type of <code>Y</code> (see above).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with S3 class <code>"PTReg"</code> is returned, which is a list with the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call that produced this object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>The intercept estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The matrix of the coefficients for main E effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The matrix of the regression coefficients for all main G effects (the first row)
and interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The number of nonzeros.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>Bayesian Information Criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_sample</code></td>
<td>
<p>Selected samples where samples with extreme absolute residuals are
trimmed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The same as input <code>family</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Yaqing Xu, Mengyun Wu, Shuangge Ma, and Syed Ejaz Ahmed.
<em>Robust gene-environment interaction analysis using penalized trimmed regression. Journal
of Statistical Computation and Simulation, 88(18):3502-3528, 2018.</em>
</p>


<h3>See Also</h3>

<p><code>coef</code>, <code>predict</code>, and <code>plot</code> methods, and <code>bic.PTReg</code> method.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sigmaG&lt;-AR(rho=0.3,p=30)
sigmaE&lt;-AR(rho=0.3,p=3)
set.seed(300)
G=MASS::mvrnorm(150,rep(0,30),sigmaG)
EC=MASS::mvrnorm(150,rep(0,2),sigmaE[1:2,1:2])
ED = matrix(rbinom((150),1,0.6),150,1)
E=cbind(EC,ED)
alpha=runif(3,0.8,1.5)
beta=matrix(0,4,30)
beta[1,1:4]=runif(4,1,1.5)
beta[2,c(1,2)]=runif(2,1,1.5)


#continuous response
y1=simulated_data(G=G,E=E,alpha=alpha,beta=beta,error=c(rnorm(130),
rcauchy(20,0,5)),family="continuous")
fit1&lt;-PTReg(G=G,E=E,y1,lambda1=0.3,lambda2=0.3,gamma1=6,gamma2=6,
max_init=50,h=NULL,tau=0.6,mu=2.5,family="continuous")
coef1=coef(fit1)
y_hat1=predict(fit1,E,G)
plot(fit1)

# survival response
y2=simulated_data(G,E,alpha,beta,rnorm(150,0,1),
family="survival",0.7,0.9)
fit2&lt;-PTReg(G=G,E=E,y2,lambda1=0.3,lambda2=0.3,gamma1=6,gamma2=6,
max_init=50,h=NULL,tau=0.6,mu=2.5,family="survival")
coef2=coef(fit2)
y_hat2=predict(fit2,E,G)
plot(fit2)


</code></pre>


</div>