<div class="container">

<table style="width: 100%;"><tr>
<td>GaSPModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a <code>GaSPModel</code> object.</h2>

<h3>Description</h3>

<p>Return a template for a <code>GaSPModel</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GaSPModel(
  x,
  y,
  reg_model,
  sp_model = NULL,
  cor_family = c("PowerExponential", "Matern"),
  cor_par,
  random_error = c(FALSE, TRUE),
  sp_var,
  error_var = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data frame containing the input (explanatory variable) training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector or a data frame with one column
containing the output (response) training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_model</code></td>
<td>
<p>The regression model, specified as a formula,
but note the left-hand side of the formula is unused; see example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp_model</code></td>
<td>
<p>An optional stochastic process model, specified as a formula,
but note the left-hand side of the formula and the intercept are unused.
The default <code>NULL</code> uses all column names in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_family</code></td>
<td>
<p>A character string specifying the
(product, anisoptropic) correlation-function family:
"PowerExponential" for the power-exponential family
or "Matern" for the Matern family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_par</code></td>
<td>
<p>A data frame containing the correlation parameters
with one row per <code>sp_model</code> term and two columns (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_error</code></td>
<td>
<p>A boolean for the presence or not of a
random (measurement, white-noise) error term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp_var</code></td>
<td>
<p>The stochastic process variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_var</code></td>
<td>
<p>The random error variance, with default 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data frame <code>cor_par</code> contains one row for each term
in the stochastic process model.
There are two columns.  The first is named <code>Theta</code>,
and the second is either <code>Alpha</code> (power-exponential)
or <code>Derivatives</code> (Matern).
Let <code class="reqn">h_j</code> be a distance between points for term <code class="reqn">j</code>
in the stochastic-process model.
For power-exponential, the contribution to the product correlation
from term <code class="reqn">j</code> depends on
a distance-scale parameter <code class="reqn">\theta_j</code> from the <code>Theta</code> column and
a smoothness parameter <code class="reqn">\alpha_j</code> from the <code>Alpha</code> column;
the contribution is <code class="reqn">exp(-\theta_j h_j^{2 - \alpha_j})</code>.
For example, <code class="reqn">\alpha_j = 0</code> gives the squared-exponential (Gaussian) correlation.
The contribution to the product correlation for Matern also depends on <code class="reqn">\theta_j</code>,
and the second parameter is the number of derivatives <code class="reqn">\delta_j = 0, 1, 2, 3</code>
from the <code>Derivatives</code> column.
The contribution is
<code class="reqn">exp(-\theta_j h_j)</code> for <code class="reqn">\delta_j = 0</code> (the exponential correlation),
<code class="reqn">exp(-\theta_j h_j) (\theta_j h_j + 1)</code> for <code class="reqn">\delta_j = 1</code>,
<code class="reqn">exp(-\theta_j h_j) ((\theta_j h_j)^2 / 3 + \theta_j h_j + 1)</code> for <code class="reqn">\delta_j = 2</code>, and
<code class="reqn">exp(-\theta_j h_j^2)</code> for <code class="reqn">\delta_j = 3</code> (the squared-exponential correlation).
Note that <code class="reqn">\delta_j = 3</code> codes for a limiting infinite number of derivatives.
This is not the usual parameterization of the Matern, but it is
consistent with power-exponential for the exponential and squared-exponential
special cases common to both.
</p>
<p>A value should be given to <code>error_var</code> if the model
has a random-error term (<code>random_error = TRUE</code>),
and a small "nugget" such as <code class="reqn">10^{-9}</code> may be needed for improved
numerical conditioning.
</p>


<h3>Value</h3>

<p>A <code>GaSPModel</code> object, which is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The data frame containing the input training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The training output data, now as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_model</code></td>
<td>
<p>The regression model, now in the form of a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp_model</code></td>
<td>
<p>The stochastic process model,
now in the form of a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_family</code></td>
<td>
<p>The correlation family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_par</code></td>
<td>
<p>The data frame containing the correlation parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_error</code></td>
<td>
<p>The boolean for the presence or not of a random error term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp_var</code></td>
<td>
<p>The stochastic process variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_var</code></td>
<td>
<p>The random error variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A placeholder for a data frame to hold the regression-model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>
<p>A placeholder for the maximum fit objective.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond_num</code></td>
<td>
<p>A placeholder for the condition number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVRMSE</code></td>
<td>
<p>A placeholder for the model's
cross-validated root mean squared error.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function does not excecute <code>Fit</code> and is intended
for <code>CrossValidate</code>, <code>Predict</code> and <code>Visualize</code>
with models trained otherwise by the user.
Placeholders do not need to be specified to excecute these further functions,
as they are always recomputed as needed.
</p>


<h3>References</h3>

<p>Sacks, J., Welch, W.J., Mitchell, T.J., and Wynn, H.P. (1989)
"Design and Analysis of Computer Experiments", <em>Statistical Science</em>, 4, pp. 409-423,
doi:10.1214/ss/1177012413.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- borehole$x
y &lt;- borehole$y
theta &lt;- c(
  5.767699e+01, 0.000000e+00, 0.000000e+00, 1.433571e-06,
  0.000000e+00, 2.366557e-06, 1.695619e-07, 2.454376e-09
)
alpha &lt;- c(
  1.110223e-16, 0.000000e+00, 0.000000e+00, 0.000000e+00,
  0.000000e+00, 0.000000e+00, 2.494862e-03, 0.000000e+00
)
cor_par &lt;- data.frame(Theta = theta, Alpha = alpha)
rownames(cor_par) &lt;- colnames(borehole$x)
sp_var &lt;- 38783.7
borehole_gasp &lt;- GaSPModel(
  x = borehole$x, y = borehole$y,
  reg_model = ~1, cor_family = "PowerExponential",
  cor_par = cor_par, random_error = FALSE,
  sp_var = sp_var
)
</code></pre>


</div>