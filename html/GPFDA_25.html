<div class="container">

<table style="width: 100%;"><tr>
<td>nsgpCovMat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a NSGP covariance matrix given a vector of hyperparameters</h2>

<h3>Description</h3>

<p>Calculate a NSGP covariance matrix given a vector of hyperparameters
</p>


<h3>Usage</h3>

<pre><code class="language-R">nsgpCovMat(
  hp,
  input,
  inputSubsetIdx = NULL,
  nBasis = 5,
  corrModel = corrModel,
  gamma = NULL,
  nu = NULL,
  cyclic = NULL,
  whichTau = NULL,
  calcCov = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hp</code></td>
<td>
<p>Vector of hyperparameters estimated by function nsgpr.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>List of Q input variables (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputSubsetIdx</code></td>
<td>
<p>A list identifying a subset of the input values to be
used in the estimation (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nBasis</code></td>
<td>
<p>Number of B-spline basis functions in each coordinate direction
along which parameters change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrModel</code></td>
<td>
<p>Correlation function specification used for g(.). It can be
either "pow.ex" or "matern".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Power parameter used in powered exponential kernel function. It
must be 0&lt;gamma&lt;=2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Smoothness parameter of the Matern class. It must be a positive
value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cyclic</code></td>
<td>
<p>Logical vector of dimension Q which defines which covariates
are cyclic (periodic). For example, if basis functions should be cyclic
only in the first coordinate direction, then cyclic=c(T,F). cyclic must
have the same dimension of whichTau. If cyclic is TRUE for some coordinate
direction, then cyclic B-spline functions will be used and the varying
parameters (and their first two derivatives) will match at the boundaries
of that coordinate direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichTau</code></td>
<td>
<p>Logical vector of dimension Q identifying which input
coordinates the parameters are function of. For example, if Q=2 and
parameters change only with respect to the first coordinate, then we set
whichTau=c(T,F).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calcCov</code></td>
<td>
<p>Logical. Calculate covariance matrix or not. If FALSE, time or
spatially-varying parameters are still provided.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing  </p>
 
<dl>
<dt>Cov</dt>
<dd>
<p>Covariance matrix</p>
</dd>
<dt>vareps</dt>
<dd>
<p>Noise variance</p>
</dd>
<dt>As_perTau</dt>
<dd>
<p>List of varying anisotropy matrix over the input space</p>
</dd>
<dt>sig2_perTau</dt>
<dd>
<p>Vector of signal variance over the input space</p>
</dd>
</dl>
<h3>References</h3>

<p>Konzen, E., Shi, J. Q. and Wang, Z. (2020) "Modeling
Function-Valued Processes with Nonseparable and/or Nonstationary Covariance
Structure" &lt;arXiv:1903.09981&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## See examples in vignette:
# vignette("nsgpr", package = "GPFDA")
</code></pre>


</div>