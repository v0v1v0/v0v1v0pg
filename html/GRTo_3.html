<div class="container">

<table style="width: 100%;"><tr>
<td>bvmed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Repeated medians regression for the determination of the Gutenberg-Richter b-value </h2>

<h3>Description</h3>

<p>This function determines the Gutenberg-Richter <em>b</em>-value from a set of magnitude values, using the repeated medians regression method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bvmed(file, lis, hd = FALSE, colid = 1, nrep = 200, tm = NULL,
findtm = TRUE, title = "bvmed")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p> file to be loaded </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lis</code></td>
<td>
<p> list to be loaded </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hd</code></td>
<td>
<p> whether <code>file</code> contains header or not </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colid</code></td>
<td>
<p> field number for the magnitude values in <code>file</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p> number of replicates for the bootstrap (calculation of the standard-error for the <em>b</em>-value) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tm</code></td>
<td>
<p> threshold magnitude value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>findtm</code></td>
<td>
<p> logical. Whether an automatic procedure is engaged to determine the threshold magnitude value <code>tm</code> or not </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p> character. The title of the plot. The name for the PNG file that includes the plot begins with <code>title</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function reads magnitude values in the field which number is indicated by <code>colid</code> in <code>file</code>. Magnitude values are read in the
list <code>lis</code> if the file does not exist.
This function produces a plot showing the FMD and the linear model line. The plot is stored into a file with name <code>file</code>_bvmed.png (png format file).
It includes the mblm function from the version 0.11 (2007) of the mblm library by Lukasz Komsta (known e-mail address : luke@novum.am.lublin.pl).
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>quantm</code></td>
<td>
<p> the 5%, 50% and 95% quantiles of the bootstrap replicates for the threshold magnitude value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mmed</code></td>
<td>
<p> the median of the bootstrap replicates for the threshold magnitude value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantb</code></td>
<td>
<p> the 5%, 50% and 95% quantiles of the bootstrap replicates for the <em>b</em>-value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valid</code></td>
<td>
<p> the number of valid replicates </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brm</code></td>
<td>
<p> the <em>b</em>-value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bse</code></td>
<td>
<p> the bootstrap standard-error value for the <em>b</em>-value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bme</code></td>
<td>
<p> the bootstrap margin of errors value for the <em>b</em>-value </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Thanks to Paul Friberg for telling us about the bug in the graphical part of bvmed.R. Thanks to Scott Kostyshak for telling us about the extra bootstrap package dependency. GRTo version 1.2 fixes these issues. Thanks to Andrew Barbour (USGS) for detecting and fixing minor problems of bvmed.R of version 1.2. In version 1.3, an option coded by Andrew Barbour allows the processing of data from a list. Willy Aspinall (University of Bristol) highlights bugs in the graphical parts of bvmed: An inappropriate magnitude shift in the FMD plot is definitely fixed in version 1.3. Many thanks to Willy!
</p>


<h3>Author(s)</h3>

<p> Daniel Amorese &lt;amorese@ipgp.fr&gt;, Paul A. Rydelek &lt;prydelek@memphis.edu&gt; and Jean-Robert Grasso &lt;grasso@obs.ujf-grenoble.fr&gt;
</p>
<p>Maintainer: Daniel Amorese &lt;amorese@ipgp.fr&gt;
</p>


<h3>References</h3>

<p>D. Amorese, J.-R. Grasso and P. A. Rydelek, "On varying <em>b</em>-values with depth: results from computer-intensive tests for Southern California", <em>Geophys. J. Int.</em> (2010) 180, 347-360 
</p>
<p>Siegel, A.F., "Robust regression using repeated medians", <em>Biometrika</em> (1982) 69, 242-244.
</p>


<h3>Examples</h3>

<pre><code class="language-R">bvmed(file=system.file("extdata","IDYLLdeep.data.txt",package="GRTo"), colid = 15, nrep = 150, 
tm = NULL, findtm = TRUE, title = "IDYLLWILD")
</code></pre>


</div>