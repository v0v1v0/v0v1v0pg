<div class="container">

<table style="width: 100%;"><tr>
<td>pcat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Reduction for the Levels of a Factor.
</h2>

<h3>Description</h3>

<p>The function is trying to merged similar levels of a given factor. Its based on ideas given by 
Tutz (2013). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcat(fac, df = NULL, lambda = NULL, method = c("ML", "GAIC"), start = 0.001, 
         Lp = 0, kappa = 1e-05, iter = 100, c.crit = 1e-04, k = 2)

gamlss.pcat(x, y, w, xeval = NULL, ...)

plotDF(y, factor = NULL, formula = NULL, data, along = seq(0, nlevels(factor)), 
         kappa = 1e-06, Lp = 0, ...)

plotLambda(y, factor = NULL, formula = NULL, data, along = seq(-2, 2, 0.1), 
         kappa = 1e-06, Lp = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fac, factor</code></td>
<td>
<p>a factor to reduce its levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the effective degrees of freedom df</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the smoothing parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>which method is used for the estimation of the smoothing parameter, <code>"ML"</code> or <code>"GAIC"</code> are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p> starting value for <code>lambda</code> if it estimated using <code>"ML"</code> or <code>"GAIC"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lp</code></td>
<td>

<p>The type of penalty required, <code>Lp=0</code> is the default. Use <code>Lp=1</code> for lasso type and different values for different required penalty.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>a regulation parameters used for the weights in the penalties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>

<p>the number of internal iteration allowed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.crit</code></td>
<td>
<p>the convergent criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the penalty if <code>"GAIC"</code> method is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>explanatory factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response or iterative response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>iterative weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xeval</code></td>
<td>
<p>indicator whether to predict</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>along</code></td>
<td>
<p>a sequence of values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra variables</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>pcat()</code> is used for the fitting of the factor. The function shrinks the levels of the categorical factor (not towards the overall mean as the function <code>random()</code> is doing) but towards each other.  This results to a reduction of the number if levels of the factors.  Different norms can be used for the shrinkage by specifying the argument <code>Lp</code>.  
</p>


<h3>Value</h3>

<p>The function <code>pcat</code> reruns a vector  endowed with a number of attributes. 
The vector itself is used in the construction of the model matrix, while the attributes are needed for the backfitting algorithms additive.fit(). The backfitting is done in <code>gamlss.pcat</code>.
</p>


<h3>Note</h3>

<p>Note that <code>pcat</code> itself does no smoothing; it simply sets things up for <code>gamlss.pcat()</code> to do the smoothing within the backfitting.</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos,  Paul Eilers and Marco Enea</p>


<h3>References</h3>

<p>Tutz G. (2013) Regularization and Sparsity in Discrete Structures in the <em>Proceedings of the 29th International Workshop on Statistical Modelling</em>, Volume 1, p 29-42, Gottingen, Germany
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code>random</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate data 1
    n &lt;- 10  # number of levels 
    m &lt;- 200 # number of observations  
set.seed(2016)
level &lt;-  as.factor(floor(runif(m) * n) + 1)
  a0  &lt;-  rnorm(n)
sigma &lt;-  0.4
   mu &lt;-  a0[level]
   y &lt;-  mu + sigma * rnorm(m)
plot(y~level)
points(1:10,a0, col="red")
 da1 &lt;- data.frame(y, level)
#------------------
  mn &lt;- gamlss(y~1,data=da1 ) # null model 
  ms &lt;- gamlss(y~level-1, data=da1) # saturated model 
  m1 &lt;- gamlss(y~pcat(level), data=da1) # calculating lambda ML
AIC(mn, ms, m1)
## Not run: 
m11 &lt;- gamlss(y~pcat(level, method="GAIC", k=log(200)), data=da1) # GAIC
AIC(mn, ms, m1, m11) 
#gettng the fitted object -----------------------------------------------------
getSmo(m1)
coef(getSmo(m1))
fitted(getSmo(m1))[1:10]
plot(getSmo(m1)) # 
# After the fit a new factor is created  this factor has the reduced levels
 levels(getSmo(m1)$factor)
# -----------------------------------------------------------------------------

## End(Not run)
</code></pre>


</div>