<div class="container">

<table style="width: 100%;"><tr>
<td>residuals.gw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract and Visualize GWRM Model Residuals</h2>

<h3>Description</h3>

<p>residuals is a method which extracts model residuals from <code>"gw"</code>, commonly returned by <code>gw</code> function. Optionally, it produces a normal plot with a simulated envelope of the residuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gw'
residuals(
  object,
  type = "pearson",
  rep = 19,
  envelope = FALSE,
  title = "Simulated Envelope of Residuals",
  trace = FALSE,
  parallel = TRUE,
  ncores = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>"gw"</code> holding the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of residuals to be extracted. Default is <code>"pearson"</code>. <code>"response"</code> and <code>"deviance"</code> are also available. Deviance residuals are defined as <code class="reqn">2[ln f(y_i|y_i)-ln f(\widehat{\mu}_i|y_i)]</code>, so that their sum is the value of the deviance statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>number of replications for envelope construction. Default is 19, that is the smallest 95 percent band that can be built.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envelope</code></td>
<td>
<p>a logical value to specify if the envelope is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a title for the envelope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>if <code>TRUE</code> a sort of information is printed during the running time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>if <code>TRUE</code> use parallel executation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>is the number of cores that we use if <code>parallel</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The usual Q-Q plot may show an unsatisfactory pattern of the residuals of a model fitted: then we are led to think that the model is badly specificated. The normal plot with simulated envelope indicates that under the distribution of the response variable the model is OK if only a few points fall off the envelope.
</p>


<h3>Value</h3>

<p>Residuals values and plot
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(goals)
set.seed(1)
fit0 &lt;- gw(goals ~ position, data = goals[sample(1:nrow(goals), 75), ])
residuals(fit0, type = "pearson", rep = 19, envelope = TRUE, trace = FALSE, ncores = 2)

</code></pre>


</div>