<div class="container">

<table style="width: 100%;"><tr>
<td>plot_spline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot spline curve for a fitted additive model</h2>

<h3>Description</h3>

<p>Plots a spline curve for a single variable using a <code>grpreg</code> or <code>cv.grpreg</code> object for which an additive model was fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_spline(
  fit,
  variable,
  lambda,
  which = NULL,
  partial = FALSE,
  type = "contrast",
  warnings = TRUE,
  points.par = NULL,
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A <code>grpreg</code> object. The model must have been fit using a <code>expand_spline</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>The name of the variable which will be plotted (character).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Values of the regularization parameter <code>lambda</code> which will be used for the plot. If a vector is passed, a curve will be drawn for each value of lambda (numeric vector; if a <code>cv.grpreg</code> object is passed, the <code>lambda</code> value minimizing cross-validation error will be used as a default; otherwise, there is no default value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Index of penalty parameter <code>lambda</code> which will be used for the plot. If both <code>lambda</code> and <code>which</code> are specified, <code>lambda</code> takes precedence (integer vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>If <code>TRUE</code>, a scatter plot of the partial residuals is superimposed on the curve (logical; default = <code>FALSE</code>). If multiple lambdas are specified, the largest value is used to calculate the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of plot to be produced (default = <code>"contrast"</code>). The following options are supported:
</p>

<ul>
<li>
<p> If <code>"conditional"</code>, the plot returned shows the value of the variable on the x-axis and the change in linear predictor on the y-axis, holding all other variables constant at their mean value.
</p>
</li>
<li>
<p> If <code>"contrast"</code>, the plot returned shows the effect on the linear predictor by moving the x variable away from its mean.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnings</code></td>
<td>
<p>If <code>FALSE</code>, warnings will be suppressed (default = <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points.par</code></td>
<td>
<p>List of parameters (see <code>par()</code> to pass to <code>points()</code> when <code>partial=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Add spline to existing plot? (default: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>plot()</code>. Note that these arguments also control the appearance of the lines.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plot_spline()</code> takes a model fit using both the <code>grpreg()</code> and <code>expand_spline()</code> functions and plots a spline curve for a given variable.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
Data &lt;- gen_nonlinear_data(n=1000)
X &lt;- expand_spline(Data$X)
fit &lt;- grpreg(X, Data$y)
plot_spline(fit, "V02", lambda = 0.03)
plot_spline(fit, "V02", which = c(10, 90))
plot_spline(fit, "V02", lambda = 0.03, partial=TRUE)
plot_spline(fit, "V02", lambda = 0.03, partial=TRUE, type='conditional')
plot_spline(fit, "V02", lambda = 0.03, partial=TRUE, lwd=6, col='yellow',
            points.par=list(pch=9, col='blue'))

op &lt;- par(mfrow=c(3,2), mar=c(4.5, 4.5, 0.25, 0.25))
for (i in 1:6) plot_spline(fit, sprintf("V%02d", i), lambda = 0.03, partial=TRUE)
par(op)

cvfit &lt;- cv.grpreg(X, Data$y)
plot_spline(cvfit, "V02")
plot_spline(cvfit, "V02", partial=TRUE)
</code></pre>


</div>