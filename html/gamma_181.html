<div class="container">

<table style="width: 100%;"><tr>
<td>signal_integrate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Signal Integration</h2>

<h3>Description</h3>

<p>Integration of the spectrum including uncertainty calculation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">signal_integrate(object, background, ...)

## S4 method for signature 'GammaSpectrum,missing'
signal_integrate(object, range = NULL, energy = FALSE)

## S4 method for signature 'GammaSpectrum,GammaSpectrum'
signal_integrate(object, background, range = NULL, energy = FALSE)

## S4 method for signature 'GammaSpectrum,numeric'
signal_integrate(object, background, range = NULL, energy = FALSE)

## S4 method for signature 'GammaSpectra,missing'
signal_integrate(object, range = NULL, energy = FALSE, simplify = TRUE)

## S4 method for signature 'GammaSpectra,GammaSpectrum'
signal_integrate(
  object,
  background,
  range = NULL,
  energy = FALSE,
  simplify = TRUE
)

## S4 method for signature 'GammaSpectra,numeric'
signal_integrate(
  object,
  background,
  range = NULL,
  energy = FALSE,
  simplify = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A GammaSpectrum or GammaSpectra object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>A GammaSpectrum object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>A length-two <code>numeric</code> vector giving the energy range to
integrate within (in keV).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>energy</code></td>
<td>
<p>A <code>logical</code> scalar: use the energy or count threshold for the signal integration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>A <code>logical</code> scalar: should the result be simplified to a
<code>matrix</code>? The default value, <code>FALSE</code>, returns a <code>list</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function supports two integration techniques (see Guérin &amp; Mercier 2011),
the (1) count threshold integration and the (2) energy integration method:
</p>
<p>The count integration technique (<code>energy = FALSE</code>) integrates
all counts in given <code>range</code>:
</p>
<p style="text-align: center;"><code class="reqn">
   A = \frac{\Sigma_{i}^{N}S_i}{t_{live}}
 </code>
</p>

<p>Contrary, the energy integration techniques is the integrated cross-product
of counts and corresponding energy per channel:
</p>
<p style="text-align: center;"><code class="reqn">
  A = \frac{\Sigma_{i}^{N}S_i \times E_i}{t_{live}}
 </code>
</p>

<p><code class="reqn">A</code> is the area, <code class="reqn">S_i</code> is the signal in the <code class="reqn">i^{th}</code> channel,
<code class="reqn">N</code> the number of channels, <code class="reqn">E_i</code> the energy of the corresponding
channel in keV. <code class="reqn">t_{live}</code> is the live time of the measurement in <em>s</em>.
</p>
<p>For calculating the uncertainties, Poisson statistics are assumed and hence
the errors is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">
 \sigma_A = \frac{\sqrt{A}}{t_{live}}
 </code>
</p>



<h3>Value</h3>

<p>If <code>simplify</code> is <code>FALSE</code> (the default) returns a <code>list</code> of numeric vectors
(the signal value and its error), else returns a <code>matrix</code>.
</p>


<h3>Note</h3>

<p>The integration assumes that each spectrum has an energy scale.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Guérin, G. &amp; Mercier, M. (2011). Determining Gamma Dose Rates by Field Gamma
Spectroscopy in Sedimentary Media: Results of Monte Carlo Simulations.
<em>Radiation Measurements</em>, 46(2), p. 190-195.
<a href="https://doi.org/10.1016/j.radmeas.2010.10.003">doi:10.1016/j.radmeas.2010.10.003</a>.
</p>
<p>Mercier, N. &amp; Falguères, C. (2007). Field Gamma Dose-Rate Measurement with
a NaI(Tl) Detector: Re-Evaluation of the "Threshold" Technique.
<em>Ancient TL</em>, 25(1), p. 1-4.
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code>baseline</code>,
<code>peaks_find()</code>,
<code>peaks_search()</code>,
<code>signal_slice()</code>,
<code>signal_split()</code>,
<code>signal_stabilize()</code>,
<code>smooth()</code>
</p>


</div>