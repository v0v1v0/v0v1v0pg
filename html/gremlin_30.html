<div class="container">

<table style="width: 100%;"><tr>
<td>covFun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Co)variance parameter transformations.</h2>

<h3>Description</h3>

<p>Converts lists of (co)variance parameters either between <code>list</code> and 
<code>vector</code> format or between the theta and nu scales.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stTrans(x)

conTrans(Gcon, Rcon)

start2theta(Gstart, Rstart, name = NULL)

matlist2vech(theta)

vech2matlist(vech, skeleton)

theta2nu_trans(theta)

nu2theta_trans(nu)

theta2nu_lambda(theta, thetaG, thetaR)

nu2theta_lambda(nu, sigma2e, thetaG, thetaR)

nuVar2thetaVar_lambda(object)

nuAI2thetaAIinv_lambda(object)

nu2theta_noTrans(nu, thetaG, thetaR)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, theta, nu</code></td>
<td>
<p>A <code>list</code> of matrices containing the (co)variance
parameters of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gcon, Rcon</code></td>
<td>
<p>A <code>list</code> of starting (co)variance constraints for the
G-structure (random effects terms) or R-structure (residual).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gstart, Rstart</code></td>
<td>
<p>A <code>list</code> of starting (co)variance values for the
G-structure (random effects terms) or R-structure (residual).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>An (optional) character <code>vector</code> containing the (co)variance
component names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vech</code></td>
<td>
<p>A <code>vector</code> of (co)variance parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skeleton</code></td>
<td>
<p>An example structure to map <code>vech</code> onto.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaG, thetaR</code></td>
<td>
<p>A <code>vector</code> indexing the G-structure or R-structure
components, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2e</code></td>
<td>
<p>A <code>numeric</code> estimate of the factored out residual
variance from the mixed model equations (i.e., the ‘lambda’ scale)
<code class="reqn">\sigma^{2}_{e}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of <code>class</code> ‘gremlin’.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li>
<p><code>stTrans</code> Transform start parameters into lower triangle
matrices of class <code>dsCMatrix</code>.
</p>
</li>
<li>
<p><code>conTrans</code> Transformation of starting constraints to correct
format.
</p>
</li>
<li>
<p><code>start2theta</code> Converts lists of starting values for (co)variance
parameters to a theta object used to structure the (co)variance components
within gremlin.
</p>
</li>
<li>
<p><code>matlist2vech</code> Converts a <code>list</code> of (co)variance parameter
matrices to a vector with a “skel” attribute.
</p>
</li>
<li>
<p><code>vech2matlist</code> Converts a vector of (co)variance parameters to
a list of covariance matrices.
</p>
</li>
<li>
<p><code>theta2nu_trans</code> Transforms theta to nu scale by taking the
Cholesky factor of each covariance matrix and then replacing the diagonals
with  their (natural) logarithms. Done to ensure matrices are positive
definite.
</p>
</li>
<li>
<p><code>nu2theta_trans</code> Back transformation from
<code>theta2nu_trans</code>: exponentiates the diagonal elements of each matrix
then calculates the cross-product.
</p>
</li>
<li>
<p><code>theta2nu_lambda</code> Transformation that factors out a residual
variance so that <code>nu</code> contains the ‘lambda’ parameterization:
ratios of variance parameters with the residual variance.
</p>
</li>
<li>
<p><code>nu2theta_lambda</code> Back transformation from
<code>theta2nu_lambda</code>.
</p>
</li>
<li>
<p><code>nuVar2thetaVar_lambda</code> Transformation of Sampling Variances
from <code>lambda</code> Scale for <code>theta</code>.
</p>
</li>
<li>
<p><code>nuAI2thetaAIinv_lambda</code> Transform AI matrix from <code>lambda</code>
Scale to AI-inverse of <code>theta</code>.
</p>
</li>
<li>
<p><code>nu2theta_noTrans</code> Structures <code>theta</code> when not
transformed.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Functions are specified to mostly return either a <code>list</code> of
matrices (structure as defined by the “skel” attribute or in
the <code>skeleton</code> object) or a <code>vector</code> containing the (co)variance
parameters of the model. Additional list elements returned can be:
</p>

<dl>
<dt>thetaG </dt>
<dd>
<p>A <code>vector</code> indexing the G-structure components.</p>
</dd>
<dt>thetaR </dt>
<dd>
<p>A <code>vector</code> indexing the R-structure components.</p>
</dd>
</dl>
<p>Alternatively, <code>nuVar2thetaVar_lambda</code> and <code>nuAI2thetaAIinv_lambda</code>
return a <code>vector</code> and <code>matrix</code>, respectively, holding the sampling
(co)variances of the model (co)variance parameters both on the <code>theta</code>
scale. These are elements of the inverse Average Information matrix.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:matthewwolak@gmail.com">matthewwolak@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # User-specified starting parameters
  thetaOut &lt;- start2theta(Gstart = list(matrix(1), matrix(2)),
    Rstart = matrix(3))
  ## convert to a vector and then back into a matrix list
  thetav &lt;- matlist2vech(thetaOut$theta)
  theta &lt;- vech2matlist(thetav, attr(thetav, "skel"))
    identical(thetaOut$theta, theta)  #&lt;-- should be TRUE
  # lambda parameterization transformation
  nu &lt;- theta2nu_lambda(theta, thetaOut$thetaG, thetaOut$thetaR)
  # back-transform from (lambda scale) nu to theta
  ## For example, when the sigma2e estimate=0.5
  theta2 &lt;- nu2theta_lambda(nu, sigma2e = 0.5, thetaOut$thetaG, thetaOut$thetaR)
</code></pre>


</div>