<div class="container">

<table style="width: 100%;"><tr>
<td>ssanova0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Smoothing Spline ANOVA Models</h2>

<h3>Description</h3>

<p>Fit smoothing spline ANOVA models in Gaussian regression.  The
symbolic model specification via <code>formula</code> follows the same
rules as in <code>lm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssanova0(formula, type=NULL, data=list(), weights, subset,
         offset, na.action=na.omit, partial=NULL, method="v",
         varht=1, prec=1e-7, maxiter=30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Symbolic description of the model to be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>List specifying the type of spline for each variable.
See <code>mkterm</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional data frame containing the variables in the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional vector of weights to be used in the
fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>Optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Optional offset term with known parameter 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Function which indicates what should happen when
the data contain NAs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>Optional symbolic description of parametric terms in
partial spline models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for smoothing parameter selection.  Supported
are <code>method="v"</code> for GCV, <code>method="m"</code> for GML (REML),
and <code>method="u"</code> for Mallow's CL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varht</code></td>
<td>
<p>External variance estimate needed for
<code>method="u"</code>.  Ignored when <code>method="v"</code> or
<code>method="m"</code> are specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>Precision requirement in the iteration for multiple
smoothing parameter selection.  Ignored when only one smoothing
parameter is involved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations allowed for multiple
smoothing parameter selection.  Ignored when only one smoothing
parameter is involved.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model specification via <code>formula</code> is intuitive.  For
example, <code>y~x1*x2</code> yields a model of the form
</p>
<p style="text-align: center;"><code class="reqn">
	y = C + f_{1}(x1) + f_{2}(x2) + f_{12}(x1,x2) + e
    </code>
</p>

<p>with the terms denoted by <code>"1"</code>, <code>"x1"</code>, <code>"x2"</code>, and
<code>"x1:x2"</code>.
</p>
<p>The model terms are sums of unpenalized and penalized
terms. Attached to every penalized term there is a smoothing
parameter, and the model complexity is largely determined by the
number of smoothing parameters.
</p>
<p><code>ssanova0</code> and the affiliated methods provide a front end to
RKPACK, a collection of RATFOR routines for nonparametric regression
via the penalized least squares.  The algorithms implemented in
RKPACK are of the order <code class="reqn">O(n^{3})</code>.
</p>


<h3>Value</h3>

<p><code>ssanova0</code> returns a list object of class
<code>c("ssanova0","ssanova")</code>.
</p>
<p>The method <code>summary.ssanova0</code> can be used to obtain
summaries of the fits.  The method <code>predict.ssanova0</code>
can be used to evaluate the fits at arbitrary points along with
standard errors.  The methods <code>residuals.ssanova</code> and
<code>fitted.ssanova</code> extract the respective traits from the
fits.
</p>


<h3>Note</h3>

<p>For complex models and large sample sizes, the approximate solution
of <code>ssanova</code> can be faster.
</p>
<p>The method <code>project</code> is not implemented for
<code>ssanova0</code>, nor is the mixed-effect model support through
<code>mkran</code>.
</p>
<p>In <em>gss</em> versions earlier than 1.0, <code>ssanova0</code> was under
the name <code>ssanova</code>.
</p>


<h3>References</h3>

<p>Wahba, G. (1990), <em>Spline Models for Observational Data</em>.
Philadelphia: SIAM.
</p>
<p>Gu, C. (2013), <em>Smoothing Spline ANOVA Models (2nd Ed)</em>.  New
York: Springer-Verlag.
</p>
<p>Gu, C. (2014), Smoothing Spline ANOVA Models: R Package gss.
<em>Journal of Statistical Software</em>, 58(5), 1-25. URL
http://www.jstatsoft.org/v58/i05/.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fit a cubic spline
x &lt;- runif(100); y &lt;- 5 + 3*sin(2*pi*x) + rnorm(x)
cubic.fit &lt;- ssanova0(y~x,method="m")
## Obtain estimates and standard errors on a grid
new &lt;- data.frame(x=seq(min(x),max(x),len=50))
est &lt;- predict(cubic.fit,new,se=TRUE)
## Plot the fit and the Bayesian confidence intervals
plot(x,y,col=1); lines(new$x,est$fit,col=2)
lines(new$x,est$fit+1.96*est$se,col=3)
lines(new$x,est$fit-1.96*est$se,col=3)
## Clean up
## Not run: rm(x,y,cubic.fit,new,est)
dev.off()
## End(Not run)

## Fit a tensor product cubic spline
data(nox)
nox.fit &lt;- ssanova0(log10(nox)~comp*equi,data=nox)
## Fit a spline with cubic and nominal marginals
nox$comp&lt;-as.factor(nox$comp)
nox.fit.n &lt;- ssanova0(log10(nox)~comp*equi,data=nox)
## Fit a spline with cubic and ordinal marginals
nox$comp&lt;-as.ordered(nox$comp)
nox.fit.o &lt;- ssanova0(log10(nox)~comp*equi,data=nox)
## Clean up
## Not run: rm(nox,nox.fit,nox.fit.n,nox.fit.o)
</code></pre>


</div>