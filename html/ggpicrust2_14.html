<div class="container">

<table style="width: 100%;"><tr>
<td>pathway_errorbar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The function pathway_errorbar() is used to visualize the results of functional pathway differential abundance analysis as error bar plots.</h2>

<h3>Description</h3>

<p>The function pathway_errorbar() is used to visualize the results of functional pathway differential abundance analysis as error bar plots.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>abundance</code></td>
<td>
<p>A data frame with row names representing pathways and column names representing samples. Each element represents the relative abundance of the corresponding pathway in the corresponding sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>daa_results_df</code></td>
<td>
<p>A data frame containing the results of the differential abundance analysis of the pathways, generated by the pathway_daa function. x_lab should be a column name of daa_results_df.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Group</code></td>
<td>
<p>A data frame or a vector that assigns each sample to a group. The groups are used to color the samples in the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ko_to_kegg</code></td>
<td>
<p>A logical parameter indicating whether there was a convertion that convert ko abundance to kegg abundance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_values_threshold</code></td>
<td>
<p>A numeric parameter specifying the threshold for statistical significance of differential abundance. Pathways with p-values below this threshold will be considered significant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>A parameter controlling the ordering of the rows in the figure. The options are: "p_values" (order by p-values), "name" (order by pathway name), "group" (order by the group with the highest mean relative abundance), or "pathway_class" (order by the pathway category).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>A vector of pathway names to be included in the figure. This can be used to limit the number of pathways displayed. If NULL, all pathways will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value_bar</code></td>
<td>
<p>A logical parameter indicating whether to display a bar showing the p-value threshold for significance. If TRUE, the bar will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>A vector of colors to be used to represent the groups in the figure. Each color corresponds to a group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_lab</code></td>
<td>
<p>A character string to be used as the x-axis label in the figure. The default value is "description" for KOs'descriptions and "pathway_name" for KEGG pathway names.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A figure showing the error bar plot of the differential abundance analysis results for the functional pathways.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Example 1: Analyzing KEGG pathway abundance
metadata &lt;- read_delim(
  "path/to/your/metadata.txt",
  delim = "\t",
  escape_double = FALSE,
  trim_ws = TRUE
)

# data(metadata)

kegg_abundance &lt;- ko2kegg_abundance(
  "path/to/your/pred_metagenome_unstrat.tsv"
)

# data(kegg_abundance)

# Please change group to "your_group_column" if you are not using example dataset
group &lt;- "Environment"

daa_results_df &lt;- pathway_daa(
  abundance = kegg_abundance,
  metadata = metadata,
  group = group,
  daa_method = "ALDEx2",
  select = NULL,
  reference = NULL
)

# Please check the unique(daa_results_df$method) and choose one
daa_sub_method_results_df &lt;- daa_results_df[daa_results_df$method
== "ALDEx2_Welch's t test", ]

daa_annotated_sub_method_results_df &lt;- pathway_annotation(
  pathway = "KO",
  daa_results_df = daa_sub_method_results_df,
  ko_to_kegg = TRUE
)

# Please change Group to metadata$your_group_column if you are not using example dataset
Group &lt;- metadata$Environment

p &lt;- pathway_errorbar(
  abundance = kegg_abundance,
  daa_results_df = daa_annotated_sub_method_results_df,
  Group = Group,
  p_values_threshold = 0.05,
  order = "pathway_class",
  select = daa_annotated_sub_method_results_df %&gt;%
  arrange(p_adjust) %&gt;%
  slice(1:20) %&gt;%
  select("feature") %&gt;% pull(),
  ko_to_kegg = TRUE,
  p_value_bar = TRUE,
  colors = NULL,
  x_lab = "pathway_name"
)

# Example 2: Analyzing EC, MetaCyc, KO without conversions
metadata &lt;- read_delim(
  "path/to/your/metadata.txt",
  delim = "\t",
  escape_double = FALSE,
  trim_ws = TRUE
)
# data(metadata)

ko_abundance &lt;- read.delim("path/to/your/metacyc_abundance.tsv")

# data(metacyc_abundance)

group &lt;- "Environment"

daa_results_df &lt;- pathway_daa(
  abundance = metacyc_abundance %&gt;% column_to_rownames("pathway"),
  metadata = metadata,
  group = group,
  daa_method = "LinDA",
  select = NULL,
  reference = NULL
)


daa_annotated_results_df &lt;- pathway_annotation(
  pathway = "MetaCyc",
  daa_results_df = daa_results_df,
  ko_to_kegg = FALSE
)

Group &lt;- metadata$Environment

p &lt;- pathway_errorbar(
  abundance = metacyc_abundance %&gt;% column_to_rownames("pathway"),
  daa_results_df = daa_annotated_results_df,
  Group = Group,
  p_values_threshold = 0.05,
  order = "group",
  select = NULL,
  ko_to_kegg = FALSE,
  p_value_bar = TRUE,
  colors = NULL,
  x_lab = "description"
)

## End(Not run)
</code></pre>


</div>