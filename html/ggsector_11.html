<div class="container">

<table style="width: 100%;"><tr>
<td>SectorPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw sector for seurat object</h2>

<h3>Description</h3>

<p>A better alternative to <code>Seurat::DotPlot()</code>.
For more details, please type <code>vignette("ggsector")</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SectorPlot(
  object,
  features,
  features.level,
  assay,
  slot = c("data", "scale.data", "counts"),
  group.by,
  group.level,
  split.by,
  split.level,
  col_low = "blue",
  col_mid = "white",
  col_high = "red",
  col_midpoint,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Seurat object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>Input vector of genes list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features.level</code></td>
<td>
<p>Levels of genes list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>Specific assay to get data from or set data for; defaults to the default assay.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>Specific assay data to get or set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.by</code></td>
<td>
<p>Column of metadata to group the cells by, default is Idents().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.level</code></td>
<td>
<p>Levels of group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.by</code></td>
<td>
<p>Column of metadata to split the cells by, default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.level</code></td>
<td>
<p>Levels of split vars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_low</code></td>
<td>
<p>Colours for low ends of the gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_mid</code></td>
<td>
<p>Colour for mid point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_high</code></td>
<td>
<p>Colours for high ends of the gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_midpoint</code></td>
<td>
<p>The midpoint (in data value) of the diverging scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments for <code>ggplot2::facet_wrap()</code>.
Defaults to quantile(exp, 0.5)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ggplot
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Download pbmc data from
# https://cf.10xgenomics.com/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz
library(Seurat)
path &lt;- paste0(tempdir(), "/pbmc3k.tar.gz")
file &lt;- paste0(tempdir(), "/filtered_gene_bc_matrices/hg19")
download.file(
    "https://cf.10xgenomics.com/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz",
    path
)
untar(path, exdir = tempdir())
pbmc.data &lt;- Read10X(data.dir = file)
pbmc &lt;- CreateSeuratObject(
    counts = pbmc.data,
    project = "pbmc3k",
    min.cells = 3,
    min.features = 200
)
pbmc &lt;- NormalizeData(pbmc)
pbmc &lt;- FindVariableFeatures(pbmc, selection.method = "vst", nfeatures = 2000)
pbmc &lt;- ScaleData(pbmc, features = rownames(pbmc))
pbmc &lt;- RunPCA(pbmc)
pbmc &lt;- RunUMAP(pbmc, dim = 1:10)
pbmc &lt;- FindNeighbors(pbmc, dims = 1:10)
pbmc &lt;- FindClusters(pbmc, resolution = 1)
pbmc &lt;- FindClusters(pbmc, resolution = 0.5)
markers &lt;- tibble::tribble(
    ~type, ~marker,
    "Naive CD4+ T", "IL7R,CCR7",
    "CD14+ Mono", "CD14,LYZ",
    "Memory CD4+", "IL7R,S100A4",
    "B", "MS4A1",
    "CD8+ T", "CD8A",
    "FCGR3A+ Mono", "FCGR3A,MS4A7",
    "NK", "GNLY,NKG7",
    "DC", "FCER1A,CST3",
    "Platelet", "PPBP",
) %&gt;%
    tidyr::separate_rows(marker, sep = ", *") %&gt;%
    dplyr::distinct()

# Dotplot
DotPlot(pbmc, features = unique(markers$marker)) + coord_flip()

# contrast with DotPlot
SectorPlot(pbmc, markers$marker, features.level = unique(rev(markers$marker)))

SectorPlot(pbmc, markers$marker, group.by = "RNA_snn_res.1")

# split plot
# Assume a variable 'day', expressed as the number of days of cell development.
set.seed(1)
pbmc[["day"]] &lt;- sample(1:3, ncol(pbmc), TRUE)
SectorPlot(pbmc, markers$marker, group.by = "RNA_snn_res.0.5", split.by = "day")
SectorPlot(
    pbmc, markers$marker,
    group.by = "day", split.by = "RNA_snn_res.0.5", nrow = 1
)


</code></pre>


</div>