<div class="container">

<table style="width: 100%;"><tr>
<td>cr_build_upload_gcs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a StorageSource</h2>

<h3>Description</h3>

<p>This creates a StorageSource object after uploading to Google Cloud Storage
</p>


<h3>Usage</h3>

<pre><code class="language-R">cr_build_upload_gcs(
  local,
  remote = paste0(local, format(Sys.time(), "%Y%m%d%H%M%S"), ".tar.gz"),
  bucket = cr_bucket_get(),
  predefinedAcl = "bucketOwnerFullControl",
  deploy_folder = "deploy"
)

cr_buildstep_source_move(deploy_folder)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>local</code></td>
<td>
<p>Local directory containing the Dockerfile etc. you wish to deploy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remote</code></td>
<td>
<p>The name of the folder in your bucket</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bucket</code></td>
<td>
<p>The Google Cloud Storage bucket to upload to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predefinedAcl</code></td>
<td>
<p>The ACL rules for the object uploaded. Set to "bucketLevel" for buckets with bucket level access enabled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deploy_folder</code></td>
<td>
<p>Which folder to deploy from - this will mean the files uploaded will be by default in <code>/workspace/deploy/</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>cr_build_upload_gcs</code> copies the files into the <code>deploy_folder</code> in your working directory, then tars it for upload.  Files will be available on Cloud Build at <code>/workspace/deploy_folder/*</code>.
</p>
<p><code>cr_buildstep_source_move</code> is a way to move the StorageSource files in <code>/workspace/deploy_folder/*</code> into the root <code>/workspace/*</code> location, which is more consistent with RepoSource objects or GitHub build triggers created using cr_buildtrigger_repo.  This means the same runtime code can run for both sources.
</p>


<h3>Value</h3>

<p>A Source object
</p>


<h3>See Also</h3>

<p>Other Cloud Build functions: 
<code>Build()</code>,
<code>RepoSource()</code>,
<code>Source()</code>,
<code>StorageSource()</code>,
<code>cr_build_artifacts()</code>,
<code>cr_build_list()</code>,
<code>cr_build_logs()</code>,
<code>cr_build_make()</code>,
<code>cr_build_status()</code>,
<code>cr_build_targets()</code>,
<code>cr_build_wait()</code>,
<code>cr_build_write()</code>,
<code>cr_build_yaml_artifact()</code>,
<code>cr_build_yaml_secrets()</code>,
<code>cr_build_yaml()</code>,
<code>cr_build()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
cr_project_set("my-project")
cr_bucket_set("my-bucket")
my_gcs_source &lt;- cr_build_upload_gcs("my_folder")
build1 &lt;- cr_build("cloudbuild.yaml", source = my_gcs_source)

## End(Not run)
cr_buildstep_source_move("deploy")

</code></pre>


</div>