<div class="container">

<table style="width: 100%;"><tr>
<td>estfun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extracts the empirical moment function</h2>

<h3>Description</h3>

<p>It extracts the matrix of empirical moments so that it can be used by the <code>kernHAC</code> function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'gmmFct'
estfun(x, y = NULL, theta = NULL, ...)
## S3 method for class 'gmm'
estfun(x, ...)
## S3 method for class 'gel'
estfun(x, ...)
## S3 method for class 'tsls'
estfun(x, ...)
## S3 method for class 'tsls'
model.matrix(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A function of the form <code class="reqn">g(\theta,y)</code> or a <code class="reqn">n \times q</code> matrix with typical element <code class="reqn">g_i(\theta,y_t)</code> for <code class="reqn">i=1,...q</code> and <code class="reqn">t=1,...,n</code> or an object of class <code>gmm</code>. See <code>gmm</code> for more details. For <code>tsls</code>, it is an object of class <code>tsls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>tsls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The matrix or vector of data from which the function <code class="reqn">g(\theta,y)</code> is computed if <code>g</code> is a function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Vector of parameters if <code>g</code> is a function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments when <code>estfun</code> is applied to another class object</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>estfun.gmmFct</code>, it returns a <code class="reqn">n \times q</code> matrix with typical element <code class="reqn">g_i(\theta,y_t)</code> for <code class="reqn">i=1,...q</code> and <code class="reqn">t=1,...,n</code>. It is only used by <code>gmm</code> to obtain the estimates.
</p>
<p>For <code>estfun.gmm</code>, it returns the matrix of first order conditions of <code class="reqn">\min_\theta \bar{g}'W\bar{g}/2</code>, which is a <code class="reqn">n \times k</code> matrix with the <code class="reqn">t^{th}</code> row being <code class="reqn">g(\theta, y_t)W G</code>, where <code class="reqn">G</code> is <code class="reqn">d\bar{g}/d\theta</code>. It allows to compute the sandwich covariance matrix using <code>kernHAC</code> or <code>vcovHAC</code> when <code class="reqn">W</code> is not the optimal matrix.
</p>
<p>The method if not yet available for <code>gel</code> objects.
</p>
<p>For tsls, model.matrix and estfun are used by <code>vcov()</code> to compute different covariance matrices using the <code>sandwich</code> package. See <code>vcov.tsls</code>. <code>model.matrix</code> returns the fitted values frin the first stage regression and <code>esfun</code> the residuals.
</p>


<h3>Value</h3>

<p>A <code class="reqn">n \times q</code> matrix (see details). 
</p>


<h3>References</h3>

<p>Zeileis A (2006), Object-oriented Computation of Sandwich Estimators.
<em>Journal of Statistical Software</em>, <b>16</b>(9), 1â€“16.
URL <a href="https://doi.org/10.18637/jss.v016.i09">doi:10.18637/jss.v016.i09</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
n = 500
phi&lt;-c(.2,.7)
thet &lt;- 0
sd &lt;- .2
x &lt;- matrix(arima.sim(n=n,list(order=c(2,0,1),ar=phi,ma=thet,sd=sd)),ncol=1)
y &lt;- x[7:n]
ym1 &lt;- x[6:(n-1)]
ym2 &lt;- x[5:(n-2)]
H &lt;- cbind(x[4:(n-3)], x[3:(n-4)], x[2:(n-5)], x[1:(n-6)])
g &lt;- y ~ ym1 + ym2
x &lt;- H
res &lt;- gmm(g, x,weightsMatrix = diag(5))

gt &lt;- res$gt
G &lt;- res$G

foc &lt;- gt
foc2 &lt;- estfun(res)

foc[1:5,]
foc2[1:5,]

</code></pre>


</div>