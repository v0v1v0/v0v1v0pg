<div class="container">

<table style="width: 100%;"><tr>
<td>calc_gradient</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate gradient or Hessian matrix</h2>

<h3>Description</h3>

<p><code>calc_gradient</code> or <code>calc_hessian</code> calculates the gradient or Hessian matrix
of the given function at the given point using central difference numerical approximation.
<code>get_gradient</code> or <code>get_hessian</code> calculates the gradient or Hessian matrix of the
log-likelihood function at the parameter estimates of a class <code>'gsmvar'</code> object. <code>get_soc</code>
returns eigenvalues of the Hessian matrix, and <code>get_foc</code> is the same as <code>get_gradient</code>
but named conveniently.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_gradient(x, fn, h = 6e-06, varying_h = NULL, ...)

calc_hessian(x, fn, h = 6e-06, varying_h = NULL, ...)

get_gradient(gsmvar, custom_h = NULL)

get_hessian(gsmvar, custom_h = NULL)

get_foc(gsmvar, custom_h = NULL)

get_soc(gsmvar, custom_h = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector specifying the point where the gradient or Hessian should be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>a function that takes in argument <code>x</code> as the <strong>first</strong> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>difference used to approximate the derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varying_h</code></td>
<td>
<p>a numeric vector with the same length as <code>x</code> specifying the difference <code>h</code>
for each dimension separately. If <code>NULL</code> (default), then the difference given as parameter <code>h</code>
will be used for all dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>fn</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gsmvar</code></td>
<td>
<p>an object of class <code>'gsmvar'</code>, typically created with <code>fitGSMVAR</code> or <code>GSMVAR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_h</code></td>
<td>
<p>same as <code>varying_h</code> except thaqt if <code>NULL</code> (default), then the difference used
for differentiating overly large degrees of freedom parameters is adjusted to avoid numerical problems,
and the difference <code>6e-6</code> is used for the other parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In particular, the functions <code>get_foc</code> and <code>get_soc</code> can be used to check whether
the found estimates denote a (local) maximum point, a saddle point, or something else. Note that
profile log-likelihood functions can be conveniently plotted with the function <code>profile_logliks</code>.
</p>


<h3>Value</h3>

<p>Gradient functions return numerical approximation of the gradient and Hessian functions return
numerical approximation of the Hessian. <code>get_soc</code> returns eigenvalues of the Hessian matrix.
</p>


<h3>Warning</h3>

<p>No argument checks!
</p>


<h3>See Also</h3>

<p><code>profile_logliks</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Simple function
  foo &lt;- function(x) x^2 + x
  calc_gradient(x=1, fn=foo)
  calc_gradient(x=-0.5, fn=foo)

  # More complicated function
  foo &lt;- function(x, a, b) a*x[1]^2 - b*x[2]^2
  calc_gradient(x=c(1, 2), fn=foo, a=0.3, b=0.1)

  
  # GMVAR(1,2), d=2 model:
  params12 &lt;- c(0.55, 0.112, 0.344, 0.055, -0.009, 0.718, 0.319, 0.005,
   0.03, 0.619, 0.173, 0.255, 0.017, -0.136, 0.858, 1.185, -0.012,
   0.136, 0.674)
  mod12 &lt;- GSMVAR(gdpdef, p=1, M=2, params=params12)
  get_gradient(mod12)
  get_hessian(mod12)
  get_soc(mod12)
  
</code></pre>


</div>