<div class="container">

<table style="width: 100%;"><tr>
<td>cv.grpCoxOverlap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cross-validation for grpCoxOverlap
</h2>

<h3>Description</h3>

<p>Does k-fold cross-validation for grpCoxOverlap
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.grpCoxOverlap(X0, y, group, penalty=c("glasso", "gSCAD", "gMCP"), 
lambda=NULL, nlambda=100, rlambda=NULL,gamma=switch(penalty, SCAD = 3.7, 3), 
standardize=TRUE, thresh=1e-3, maxit=1e+4, nfolds=10, foldid=NULL, 
returnLatent=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X0</code></td>
<td>
<p>The design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response vector includes time corresponding to failure/censor times, and   status indicating failure (1) or censoring (0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A list of groups, each includes indices of covariates in the group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>The penalty to be applied to the model. It is one of <code>glasso</code>, <code>gSCAD</code>, or <code>gMCP</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A user supplied sequence of <code>lambda</code> values. If it is left unspecified, and the function automatically computes a grid of lambda values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>The number of <code>lambda</code> values to use in the regularization path.  Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rlambda</code></td>
<td>
<p>Smallest value for lambda, as a fraction of the maximum lambda, the data derived entry value, i.e. the smallest value for which all coefficients are zero. The default depends on the sample size relative to the number of covariates. If sample size&gt;#covariates, the default is 0.001, close to zero.  If sample size&gt;#covariates, the default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Tuning parameter of the group SCAD/MCP penalty. Default is 3.7 for SCAD and 3 for MCP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Logical flag for variable standardization prior to fitting the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>Convergence threshold for one-step coordinate descent. Defaults value is 1E-7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of passes over the data for all lambda values; default is 1E+5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>The number of cross-validation folds. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>An optional vector of values between 1 and nfolds identifying what fold each observation is in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnLatent</code></td>
<td>
<p>Return the coefficient matrix in latent space. Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>aBetaLatent</code></td>
<td>
<p>A coefficient matrix whose columns correspond to nlambda values of lambda in latent space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aBetaOri</code></td>
<td>
<p>A coefficient matrix whose columns correspond to nlambda values of lambda in original space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mBetaLatent</code></td>
<td>
<p>The coefficient in latent space gives maximum log-likelihood value using the first cross-validation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mBetaOri</code></td>
<td>
<p>The coefficient in original space gives maximum log-likelihood value using the first cross-validation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pBetaLatent</code></td>
<td>
<p>The coefficient in latent space gives maximum log-likelihood value using the penalized cross-validation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pBetaOri</code></td>
<td>
<p>The coefficient in original space gives maximum log-likelihood value using the penalized cross-validation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A matrix includes lambda value, the mean cross-validation error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The lambda values used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A list of groups, each includes indices of covariates in the group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glatent</code></td>
<td>
<p>A vector indicating the group structure of the covariates in latent space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvmax</code></td>
<td>
<p>The maximum value of log likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.max</code></td>
<td>
<p>The value of lambda corresponds to the maximum value of log likelihood using the first cross-validation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.pcvl</code></td>
<td>
<p>The value of lambda corresponds to the maximum value of log likelihood using the penalized cross-validation method.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Xuan Dang &lt;<a href="mailto:xuandang11289@gmail.com">xuandang11289@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Verweij PJ, Houwelingen HC. Cross-validation in survival analysis. Statistics in Medicine 1993; 12(24): 385-395.
</p>
<p>Ternes N, Rotolo F, Michiels S. Empirical extensions of the lasso penalty to reduce the false discovery rate in highdimensional Cox regression models. Statistics in Medicine 2016; 35(15): 2561-73.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(100001)
N &lt;- 50
p &lt;- 6
times &lt;- 1:p
rho &lt;- 0.5
H &lt;- abs(outer(times, times, "-"))
C &lt;- 1 * rho^H
C[cbind(1:p, 1:p)] &lt;- C[cbind(1:p, 1:p)] 
sigma &lt;- matrix(C,p,p)
mu &lt;- rep(0,p)
x &lt;- mvrnorm(n=N, mu, sigma)

beta &lt;- c(0, .8, 1, 2, 1, 0)
hx &lt;- exp(x %*% beta) 
ty &lt;- rexp(N,hx) 
tcens &lt;- 1 - rbinom(n=N, prob = 0.2, size = 1)
y &lt;- data.frame(illt=ty, ills=tcens)
names(y) &lt;- c("time", "status")

group &lt;- list(g1 = c(1,2,3,4), g2 = c(1,2,6), g3 = c(2,3), 
              g4 = c(4,5), g5 = c(5))
cvfit &lt;- cv.grpCoxOverlap(x, y, group, penalty="glasso", nlambda=50)
plot.llCV(cvfit)
</code></pre>


</div>