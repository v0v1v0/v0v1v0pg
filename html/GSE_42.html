<div class="container">

<table style="width: 100%;"><tr>
<td>gy.filt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gervini-Yohai filter for detecting cellwise outliers</h2>

<h3>Description</h3>

<p>Flags cellwise outliers detected using Gervini-Yohai filter as described in Agostinelli et al. (2015) and Leung and Zamar (2016). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">gy.filt(x, alpha=c(0.95,0.85), bivarQt=0.99, bivarCellPr=0.1, miter=5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix or data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a vector of the quantiles of the univariate and bivariate reference distributions, respectively. 
Filtering turns off when alpha is 0. For univariate filtering only, <code>alpha=c(0.95,0)</code>.
Default value is <code>c(0.95,0.85)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bivarQt</code></td>
<td>
<p>quantile of the binomial model for the number of flagged pairs in the bivariate filter. Default is 0.99.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bivarCellPr</code></td>
<td>
<p>probability of the binomial model for the number of flagged pairs in the bivariate filter. Default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miter</code></td>
<td>
<p>maximum number of iteration of filtering. Default value is 5.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements the univariate filter and the univariate-plus-bivariate filter as described in Agostinelli et al. (2015)
and Leung and Zamar (2016), respectively. 
</p>
<p>In the univariate filter, outliers are flagged by comparing the empirical tail distribution of each marginal 
with a reference (normal) distribution using Gervini-Yohai approach. 
</p>
<p>In the univiarate-plus-bivariate filter, outliers are first flagged by applying the univariate filter. Then, the bivariate filter
is applied to flag any additional outliers. In the bivariate filter, outliers are flagged by comparing the empirical tail distribution 
of each bivariate marginal with a reference (chi-square with 2 d.f.) distribution using Gervini-Yohai approach. The number of 
flagged pairs associated with each cell approximately follows a binomial model under Independent Cellwise Contamination Model. 
A cell is additionally flagged if the number of flagged pairs exceeds a large quantile of the binomial model. 
</p>


<h3>Value</h3>

<p>a matrix or data frame of the filtered data.
</p>


<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Claudio Agostinelli, Ruben H. Zamar, Victor J. Yohai</p>


<h3>References</h3>

<p>Agostinelli, C., Leung, A. , Yohai, V.J., and Zamar, R.H. (2015) Robust estimation of multivariate location and scatter in the presence of cellwise and casewise contamination. TEST.
</p>
<p>Leung, A. and Zamar, R.H. (2016). Multivariate Location and Scatter Matrix Estimation Under Cellwise and Casewise Contamination.
Submitted.        
</p>


<h3>See Also</h3>

<p><code>TSGS</code>, <code>generate.cellcontam</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(12345)

# Generate 5% cell-wise contaminated normal data 
x &lt;- generate.cellcontam(n=100, p=10, cond=100, contam.size=5, contam.prop=0.05)$x

## Using univariate filter only
xna &lt;- gy.filt(x, alpha=c(0.95,0))
mean(is.na(xna))

## Using univariate-and-bivariate filter
xna &lt;- gy.filt(x, alpha=c(0.95,0.95))
mean(is.na(xna))
</code></pre>


</div>