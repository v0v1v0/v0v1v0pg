<div class="container">

<table style="width: 100%;"><tr>
<td>gsl_nls_control</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tunable Nonlinear Least Squares iteration parameters</h2>

<h3>Description</h3>

<p>Allow the user to tune the characteristics of the <code>gsl_nls</code> and <code>gsl_nls_large</code>
nonlinear least squares algorithms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsl_nls_control(
  maxiter = 100,
  scale = "more",
  solver = "qr",
  fdtype = "forward",
  factor_up = 2,
  factor_down = 3,
  avmax = 0.75,
  h_df = sqrt(.Machine$double.eps),
  h_fvv = 0.02,
  xtol = sqrt(.Machine$double.eps),
  ftol = sqrt(.Machine$double.eps),
  gtol = sqrt(.Machine$double.eps),
  mstart_n = 30,
  mstart_p = 5,
  mstart_q = mstart_n%/%10,
  mstart_r = 4,
  mstart_s = 2,
  mstart_tol = 0.25,
  mstart_maxiter = 10,
  mstart_maxstart = 250,
  mstart_minsp = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>positive integer, termination occurs when the number of iterations reaches <code>maxiter</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>character, scaling method or damping strategy determining the diagonal scaling matrix D. The following options
are supported:
</p>

<ul>
<li> <p><code>"more"</code> Moré rescaling (default). This method makes the problem scale-invariant and has
been proven effective on a large class of problems.
</p>
</li>
<li> <p><code>"levenberg"</code> Levenberg rescaling. This method has also proven effective on a large class of problems,
but is not scale-invariant. It may perform better for problems susceptible to <em>parameter evaporation</em> (parameters going to infinity).
</p>
</li>
<li> <p><code>"marquardt"</code> Marquardt rescaling. This method is scale-invariant, but it is generally
considered inferior to both the Levenberg and Moré strategies.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solver</code></td>
<td>
<p>character, method used to solve the linear least squares system resulting as a subproblem in each iteration.
For large-scale problems fitted with <code>gsl_nls_large</code>, the Cholesky solver (<code>"cholesky"</code>) is always selected
and this parameter is not used. For least squares problems fitted with <code>gsl_nls</code> the following choices are supported:
</p>

<ul>
<li> <p><code>"qr"</code> QR decomposition of the Jacobian (default). This method will produce reliable solutions in cases
where the Jacobian is rank deficient or near-singular but does require more operations than the Cholesky method.
</p>
</li>
<li> <p><code>"cholesky"</code> Cholesky decomposition of the Jacobian. This method is faster than the QR approach, however
it is susceptible to numerical instabilities if the Jacobian matrix is rank deficient or near-singular.
</p>
</li>
<li> <p><code>"svd"</code> SVD decomposition of the Jacobian. This method will produce the most reliable solutions for
ill-conditioned Jacobians but is also the slowest.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdtype</code></td>
<td>
<p>character, method used to numerically approximate the Jacobian and/or second-order derivatives
when geodesic acceleration is used. Either <code>"forward"</code> for forward finite differencing or <code>"center"</code>
for centered finite differencing. For least squares problems solved with <code>gsl_nls_large</code>, numerical
approximation of the Jacobian matrix is not available and this parameter is only used to numerically approximate
the second-order derivatives (if geodesic acceleration is used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_up</code></td>
<td>
<p>numeric factor by which to increase the trust region radius when a search step is accepted.
Too large values may destabilize the search, too small values slow down the search, defaults to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_down</code></td>
<td>
<p>numeric factor by which to decrease the trust region radius when a search step is rejected.
Too large values may destabilize the search, too small values slow down the search, defaults to 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avmax</code></td>
<td>
<p>numeric value, the ratio of the acceleration term to the velocity term when using geodesic acceleration to
solve the nonlinear least squares problem. Any steps with a ratio larger than <code>avmax</code> are rejected, defaults to 0.75.
For problems which experience difficulty converging, this threshold could be lowered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_df</code></td>
<td>
<p>numeric value, the step size for approximating the Jacobian matrix with finite differences, defaults to <code>sqrt(.Machine$double.eps)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h_fvv</code></td>
<td>
<p>numeric value, the step size for approximating the second directional derivative when geodesic acceleration
is used to solve the nonlinear least squares problem, defaults to 0.02. This is only used if no analytic second
directional derivative (<code>fvv</code>) is specified in <code>gsl_nls</code> or <code>gsl_nls_large</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtol</code></td>
<td>
<p>numeric value, termination occurs when the relative change in parameters between iterations is <code>&lt;= xtol</code>.
A general guideline for selecting the step tolerance is to choose <code>xtol = 10^(-d)</code> where <code>d</code> is the number of accurate
decimal digits desired in the parameters, defaults to <code>sqrt(.Machine$double.eps)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftol</code></td>
<td>
<p>numeric value, termination occurs when the relative change in sum of squared residuals between iterations is <code>&lt;= ftol</code>,
defaults to <code>sqrt(.Machine$double.eps)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gtol</code></td>
<td>
<p>numeric value, termination occurs when the relative size of the gradient of the sum of squared residuals is <code>&lt;= gtol</code>,
indicating a local minimum, defaults to <code>.Machine$double.eps^(1/3)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_n</code></td>
<td>
<p>positive integer, number of quasi-random points drawn in each major iteration, parameter <code>N</code> in Hickernell and Yuan (1997). Default is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_p</code></td>
<td>
<p>positive integer, number of iterations of inexpensive local search to concentrate the sample, parameter <code>p</code> in Hickernell and Yuan (1997). Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_q</code></td>
<td>
<p>positive integer, number of points retained in the concentrated sample, parameter <code>q</code> in Hickernell and Yuan (1997). Default is <code>mstart_n %/% 10</code>..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_r</code></td>
<td>
<p>positive integer, scaling factor of number of stationary points determining when the multi-start algorithm terminates, parameter <code>r</code> in Hickernell and Yuan (1997). Default is 4.
If the starting ranges for one or more parameters are unbounded and updated dynamically, <code>mstart_r</code> is multiplied by a factor 10 to avoid early termination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_s</code></td>
<td>
<p>positive integer, minimum number of iterations a point needs to be retained before starting an efficient local search, parameter <code>s</code> in Hickernell and Yuan (1997). Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_tol</code></td>
<td>
<p>numeric value, multiplicative tolerance <code>(1 + mstart_tol)</code> used as criterion to start an efficient local search (epsilon in Algorithm 2.1, Hickernell and Yuan (1997)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_maxiter</code></td>
<td>
<p>positive integer, maximum number of iterations in the efficient local search algorithm (Algorithm B, Hickernell and Yuan (1997)), defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_maxstart</code></td>
<td>
<p>positive integer, minimum number of major iterations (Algorithm 2.1, Hickernell and Yuan (1997)) before the multi-start algorithm terminates, defaults to 250.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstart_minsp</code></td>
<td>
<p>positive integer, minimum number of detected stationary points before the multi-start algorithm terminates, defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any additional arguments (currently not used).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> with exactly twenty-one components:
</p>

<ul>
<li>
<p> maxiter
</p>
</li>
<li>
<p> scale
</p>
</li>
<li>
<p> solver
</p>
</li>
<li>
<p> fdtype
</p>
</li>
<li>
<p> factor_up
</p>
</li>
<li>
<p> factor_down
</p>
</li>
<li>
<p> avmax
</p>
</li>
<li>
<p> h_df
</p>
</li>
<li>
<p> h_fvv
</p>
</li>
<li>
<p> xtol
</p>
</li>
<li>
<p> ftol
</p>
</li>
<li>
<p> gtol
</p>
</li>
<li>
<p> mstart_n
</p>
</li>
<li>
<p> mstart_p
</p>
</li>
<li>
<p> mstart_q
</p>
</li>
<li>
<p> mstart_r
</p>
</li>
<li>
<p> mstart_s
</p>
</li>
<li>
<p> mstart_tol
</p>
</li>
<li>
<p> mstart_maxiter
</p>
</li>
<li>
<p> mstart_maxstart
</p>
</li>
<li>
<p> mstart_minsp
</p>
</li>
</ul>
<p>with meanings as explained under 'Arguments'.
</p>


<h3>Note</h3>

<p><code>ftol</code> is disabled in some versions of the GSL library.
</p>


<h3>References</h3>

<p>M. Galassi et al., <em>GNU Scientific Library Reference Manual (3rd Ed.)</em>, ISBN 0954612078.
</p>
<p>Hickernell, F.J. and Yuan, Y. (1997) <em>“A simple multistart algorithm for global optimization”</em>, OR Transactions, Vol. 1 (2).
</p>


<h3>See Also</h3>

<p><code>nls.control</code>
</p>
<p><a href="https://www.gnu.org/software/gsl/doc/html/nls.html#tunable-parameters">https://www.gnu.org/software/gsl/doc/html/nls.html#tunable-parameters</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## default tuning parameters
gsl_nls_control()
</code></pre>


</div>