<div class="container">

<table style="width: 100%;"><tr>
<td>fwhm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Full width at half maximum</h2>

<h3>Description</h3>

<p>Compute peak full-width at half maximum or at another level of peak maximum
for a vector or matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fwhm(
  x = seq_len(length(y)),
  y,
  ref = c("max", "zero", "middle", "min", "absolute"),
  level = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>samples at which <code>y</code> is measured, specified as a vector. I.e.,
<code>y</code> is sampled as <code>y[x]</code>. Default: <code>seq_len(length(y))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>signal to find the width of. If <code>y</code> is a matrix, widths of all
columns are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>reference. Compute the width with reference to:
</p>

<dl>
<dt><code>"max" | "zero"</code></dt>
<dd>
<p><code>max(y)</code></p>
</dd>
<dt><code>"middle" | "min"</code></dt>
<dd>
<p><code>min(y) + max(y)</code></p>
</dd>
<dt><code>"absolute"</code></dt>
<dd>
<p>an absolute level of <code>y</code></p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the level at which to compute the width. Default: 0.5.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Full width at half maximum, returned as a vector with a length equal
to the number of columns in <code>y</code>, or 1 in case of a vector.
</p>


<h3>Author(s)</h3>

<p>Petr Mikulik.<br>
Conversion to R by Geert van Boxtel, <a href="mailto:G.J.M.vanBoxtel@gmail.com">G.J.M.vanBoxtel@gmail.com</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- seq(-pi, pi, 0.001)
y &lt;- cos(x)
w &lt;- fwhm(x, y)
m &lt;- x[which.max(y)]
f &lt;- m - w/2
t &lt;- m + w/2
plot(x, y, type="l",
     panel.first = {
       usr &lt;- par('usr')
       rect(f, usr[3], t, usr[4], col = rgb(0, 1, 0, 0.4), border = NA)
     })
abline(h = max(y) / 2, lty = 2, col = "gray")

</code></pre>


</div>