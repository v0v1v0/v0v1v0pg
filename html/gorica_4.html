<div class="container">

<table style="width: 100%;"><tr>
<td>gorica</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate informative hypotheses using the GORICA</h2>

<h3>Description</h3>

<p>GORICA is an acronym for "generalized order-restricted information criterion
approximation". It can be utilized to evaluate informative hypotheses, which
specify directional relationships between model parameters in terms of
(in)equality constraints.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gorica(x, hypothesis, comparison = "unconstrained", iterations = 1e+05, ...)

## S3 method for class 'lavaan'
gorica(
  x,
  hypothesis,
  comparison = "unconstrained",
  iterations = 1e+05,
  ...,
  standardize = FALSE
)

## S3 method for class 'table'
gorica(x, hypothesis, comparison = "unconstrained", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An R object containing the outcome of a statistical analysis.
Currently, the following objects can be processed:
</p>

<ul>
<li> <p><code>lm()</code> objects (anova, ancova, multiple regression).
</p>
</li>
<li> <p><code>t_test()</code> objects.
</p>
</li>
<li> <p><code>lavaan</code> objects.
</p>
</li>
<li> <p><code>lmerMod</code> objects.
</p>
</li>
<li>
<p> A named vector containing the estimates resulting from a statistical
analysis, when the argument <code>Sigma</code> is also specified.
Note that, named means that each estimate has to be labeled such that it can
be referred to in <code>hypotheses</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypothesis</code></td>
<td>
<p>A character string containing the informative hypotheses to
evaluate (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comparison</code></td>
<td>
<p>A character string indicating what the <code>hypothesis</code>
should be compared to. Defaults to <code>comparison = "unconstrained"</code>;
options include <code>c("unconstrained", "complement", "none")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Integer. Number of samples to draw from the parameter space
when computing the <code>gorica</code> penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the internal function
<code>compare_hypotheses</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Logical. For <code>lavaan</code> objects, whether or not to
extract the standardized model coefficients. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The GORICA is applicable to not only normal linear models, but also applicable to generalized linear models (GLMs) (McCullagh &amp; Nelder, 1989), generalized linear
mixed models (GLMMs) (McCullogh &amp; Searle, 2001), and structural equation
models (SEMs) (Bollen, 1989). In addition, the GORICA can be utilized in the context of contingency tables for which (in)equality constrained hypotheses do not necessarily contain linear restrictions on cell probabilities, but instead often contain non-linear restrictions on cell probabilities.
</p>
<p><code>hypotheses</code> is a character string that specifies which informative
hypotheses have to be evaluated. A simple example is <code>hypotheses &lt;- "a &gt;
b &gt; c; a = b = c;"</code> which specifies two hypotheses using three estimates with
names "a", "b", and "c", respectively.
</p>
<p>The hypotheses specified have to adhere to the following rules:
</p>

<ol>
<li>
<p> Parameters are referred to using the names specified in <code>names()</code>.
</p>
</li>
<li>
<p> Linear combinations of parameters must be specified adhering to the
following rules:
</p>
 <ol>
<li>
<p> Each parameter name is used at most once.
</p>
</li>
<li>
<p> Each parameter name may or may not be
pre-multiplied with a number.
</p>
</li>
<li>
<p> A constant may be added or subtracted from each
parameter name.
</p>
</li>
<li>
<p> A linear combination can also be a single number.</p>
</li>
</ol>
<p>Examples are: <code>3 * a + 5</code>; <code>a + 2 * b + 3 * c - 2</code>; <code>a - b</code>;
and <code>5</code>.
</p>
</li>
<li>
<p> (Linear combinations of) parameters can be constrained using &lt;, &gt;, and
=. For example, <code>a &gt; 0</code> or
<code>a &gt; b = 0</code> or <code>2 * a &lt; b + c &gt; 5</code>.
</p>
</li>
<li>
<p> The ampersand &amp; can be used to combine different parts of a hypothesis.
For example, <code>a &gt; b &amp; b &gt; c</code> which is equivalent to <code>a &gt; b &gt; c</code> or
<code>a &gt; 0 &amp; b &gt; 0 &amp; c &gt; 0</code>.
</p>
</li>
<li>
<p> Sets of (linear combinations of) parameters subjected to the same
constraints can be specified using (). For
example, <code>a &gt; (b,c)</code> which is equivalent to <code>a &gt; b &amp; a &gt; c</code>.
</p>
</li>
<li>
<p> The specification of a hypothesis is completed by typing ; For example,
<code>hypotheses &lt;- "a &gt; b &gt; c; a = b = c;"</code>, specifies two hypotheses.
</p>
</li>
<li>
<p> Hypotheses have to be compatible, non-redundant and possible. What
these terms mean will be elaborated below.
</p>
</li>
</ol>
<p><em>The set of hypotheses has to be compatible</em>. For the statistical
background of this requirement see Gu, Mulder, Hoijtink (2018). Usually the
sets of hypotheses specified by researchers are compatible, and if not,
<code>gorica</code> will return an error message. The following steps can be used to
determine if a set of hypotheses is compatible:
</p>

<ol>
<li>
<p>	Replace a range constraint, e.g., <code>1 &lt; a1 &lt; 3</code>, by an equality
constraint in which the parameter involved is equated to the midpoint of the
range, that is, <code>a1 = 2</code>.
</p>
</li>
<li>
<p> Replace in each hypothesis the &lt; and &gt; by =. For example, <code>a1 = a2
&gt; a3 &gt; a4</code> becomes <code>a1 = a2 = a3 = a4</code>.
</p>
</li>
<li>
<p> The hypotheses are compatible if there is at least one solution to the
resulting set of equations. For the two hypotheses considered under 1. and
2., the solution is a1 = a2 = a3 = a4 = 2. An example of two non-compatible
hypotheses is <code>hypotheses &lt;- "a = 0; a &gt; 2;"</code> because there is no
solution to the equations <code>a=0</code> and <code>a=2</code>.
</p>
</li>
</ol>
<p><em>Each hypothesis in a set of hypotheses has to be non-redundant.</em> A
hypothesis is redundant if it can also be specified with fewer constraints.
For example, <code>a = b &amp; a &gt; 0 &amp; b &gt; 0</code> is redundant because it can also be
specified as <code>a = b &amp; a &gt; 0</code>. <code>gorica</code> will work correctly if
hypotheses specified using only &lt; and &gt; are redundant. <code>gorica</code> will
return an error message if hypotheses specified using at least one = are
redundant.
</p>
<p><em>Each hypothesis in a set of hypotheses has to be possible.</em> An
hypothesis is impossible if estimates in agreement with the hypothesis do not
exist. For example: values for <code>a</code> in agreement with <code>a = 0 &amp;
a &gt; 2</code> do not exist. It is the responsibility of the user to ensure that the
hypotheses specified are possible. If not, <code>gorica</code> will either return an
error message or render an output table containing <code>Inf</code>'s.
</p>


<h3>Value</h3>

<p>An object of class <code>gorica</code>, containing the following elements:
</p>

<ul>
<li> <p><code>fit</code>  A <code>data.frame</code> containing the loglikelihood, penalty
(for complexity), the GORICA value, and the GORICA weights. The GORICA
weights are calculated by taking into account the misfits and complexities of
the hypotheses under evaluation. These weights are used to quantify the
support in the data for each hypothesis under evaluation. By looking at the
pairwise ratios between the GORICA weights, one can determine the relative
importance of one hypothesis over another hypothesis.
</p>
</li>
<li> <p><code>call</code>  The original function call.
</p>
</li>
<li> <p><code>model</code>  The original model object (<code>x</code>).
</p>
</li>
<li> <p><code>estimates</code>  The parameters extracted from the <code>model</code>.
</p>
</li>
<li> <p><code>Sigma</code>  The asymptotic covariance matrix of the
<code>estimates</code>.
</p>
</li>
<li> <p><code>comparison</code>  Which alternative hypothesis was used.
</p>
</li>
<li> <p><code>hypotheses</code>  The hypotheses evaluated in <code>fit</code>.
</p>
</li>
<li> <p><code>relative_weights</code>  The relative weights of each hypothesis (rows)
versus each other hypothesis in the set (cols). The diagonal is equal to one,
as each hypothesis is equally likely as itself. A value of, e.g., 6, means
that the hypothesis in the row is 6 times more likely than the hypothesis in
the column.
</p>
</li>
</ul>
<h3>Contingency tables</h3>

<p>When specifying hypotheses about contingency tables, the asymptotic
covariance matrix of the model estimates is derived by means of
bootstrapping. This makes it possible for users to define derived parameters:
For example, a ratio between cell probabilities. For this purpose, the
<code>bain</code> syntax has been enhanced with the command <code>:=</code>.
Thus, the syntax <code>"a := x[1,1]/(x[1,1]+x[1,2])"</code> defines a new parameter
<code>a</code> by reference to specific cells of the table <code>x</code>. This new
parameter can now be named in hypotheses.
</p>


<h3>Author(s)</h3>

<p>Caspar van Lissa, Yasin Altinisik, Rebecca Kuiper
</p>


<h3>References</h3>

<p>Altinisik, Y., Van Lissa, C. J., Hoijtink, H., Oldehinkel, A. J.,
&amp; Kuiper, R. M. (2021). Evaluation of inequality constrained hypotheses using
a generalization of the AIC. Psychological Methods, 26(5), 599â€“621.
<a href="https://doi.org/10.31234/osf.io/t3c8g">doi:10.31234/osf.io/t3c8g</a>.
</p>
<p>Bollen, K. (1989). Structural equations with latent variables. New York, NY:
John Wiley and Sons.
</p>
<p>Kuiper, R. M., Hoijtink, H., &amp; Silvapulle, M. J. (2011).
An Akaike-type information criterion for model selection under inequality
constraints. Biometrika, 98, 495-501.
<a href="https://doi.org/10.31219/osf.io/ekxsn">doi:10.31219/osf.io/ekxsn</a>
</p>
<p>Kuiper, R. M., Hoijtink, H., &amp; Silvapulle, M. J. (2012).
Generalization of the order-restricted information criterion for multivariate
normal linear models. Journal of statistical planning and inference, 142(8),
2454-2463. <a href="https://doi.org/10.1016/j.jspi.2012.03.007">doi:10.1016/j.jspi.2012.03.007</a>
</p>
<p>Vanbrabant, L., Van Loey, N., and Kuiper, R.M. (2019).
Evaluating a theory-based hypothesis against its complement using an AIC-type
information criterion with an application to facial burn injury.
Psychological Methods. <a href="https://doi.org/10.31234/osf.io/n6ydv">doi:10.31234/osf.io/n6ydv</a>
</p>
<p>McCullagh, P. &amp; Nelder, J. (1989). Generalized linear models (2nd ed.). Boca
Raton, FL: Chapman &amp; Hall / CRC.
</p>
<p>McCulloch, C. E., &amp; Searle, S. R. (2001). Generalized linear and mixed
models. New York, NY: Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# EXAMPLE 1. One-sample t test
ttest1 &lt;- t_test(iris$Sepal.Length,mu=5)
gorica(ttest1,"x&lt;5.8")

# EXAMPLE 2. ANOVA
aov1 &lt;- aov(yield ~ block-1 + N * P + K, npk)
gorica(aov1,hypothesis="block1=block5;
   K1&lt;0")

# EXAMPLE 3. glm
counts &lt;- c(18,17,15,20,10,20,25,13,12)
outcome &lt;- gl(3,1,9)
treatment &lt;- gl(3,3)
fit &lt;- glm(counts ~ outcome-1 + treatment, family = poisson())
gorica(fit, "outcome1 &gt; (outcome2, outcome3)")

# EXAMPLE 4. ANOVA
res &lt;- lm(Sepal.Length ~ Species-1, iris)
est &lt;- get_estimates(res)
est
gor &lt;- gorica(res, "Speciessetosa &lt; (Speciesversicolor, Speciesvirginica)",
comparison = "complement")
gor

</code></pre>


</div>