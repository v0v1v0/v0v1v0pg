<div class="container">

<table style="width: 100%;"><tr>
<td>Ghat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantifying evolution and selection on complex traits</h2>

<h3>Description</h3>

<p>G-hat: R function to estimate G-hat from allele frequency and effect size data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Ghat(effects = effects, change = change, method = "scale",
  perms = 1000, plot = "Both", blockSize = 1000, num_eff = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>Vector of allele effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>change</code></td>
<td>
<p>Vector of changes in allele frequency (could be positive, negative or zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>"vanilla" (assumes complete linkage equilibrium between markers), "trim" (excludes markers to approximate linkage equilibrium some of the extreme values) or "scale" (scales results to reflect underlying levels of linkage LD)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p>Number of permutations to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>"Ghat", "Cor", or "Both", Should a plot of the Ghat or correlation test be returned?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockSize</code></td>
<td>
<p>How large should blocks for trimming be? Only required if method = "trim".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_eff</code></td>
<td>
<p>The effective number of independent markers, to be used only in conjunction with the “scale” method, above (see “ld_decay” function or use help (?ld_decay).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Ghat Ghat-value
</p>
<p>Cor  Correlation between alleles frequencies and their effects
</p>
<p>p.val two-sided P-value of Evidence of selection
</p>
<p>plot relationship between estimated allelic effects at individual SNPs and the change in allele frequency over generations
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Example-1 Both SNP effects and change in allele frequency are known
maize		&lt;- Maize_wqs[[1]]
result.adf	&lt;- Ghat(effects =maize[,1], change=maize[,2], method="scale",
                     perms=1000, plot="Ghat", num_eff=54.74819)
mtext(paste("WQS ADF test for selection, pval = ", round(result.adf$p.val,4)))
message (c(result.adf$Ghat , result.adf$Cor , result.adf$p.va))


## Not run: 
#Example-2 Both SNP effects and change in allele frequency are known
##################################################################
## step 1: #run rrBLUP and estimating allels effects            ##
##################################################################

library(Ghat)
library(parallel)
library(rrBLUP)
phe                 &lt;- Maize_wqs[[2]]
map                 &lt;- Maize_wqs[[3]]
gen                 &lt;- Maize_wqs[[4]]
phe                 &lt;-phe[which(is.na(phe[,2])==FALSE),]
gen                 &lt;-gen[which(is.na(phe[,2])==FALSE),]
result              &lt;- mixed.solve(phe[,2],
                                   Z= as.matrix(gen[,2:ncol(gen)]),
                                   X= model.matrix(phe[,2]~phe[,3]),
                                   K=NULL, SE=FALSE, return.Hinv=FALSE,
                                   method="ML")
                                   
##################################################################
## step 2: is to calculate the allele frequency at Cycle 1 and 3##
##################################################################
CycleIndicator      &lt;- as.numeric(unlist(strsplit(gen$X,
                       split="_C")) [seq(2,2*nrow(gen),2)])
Cycle1              &lt;- gen[which(CycleIndicator == 1),]
Cycle3              &lt;- gen[which(CycleIndicator == 3),]
CycleList           &lt;- list(Cycle1,Cycle3)
frequencies         &lt;- matrix(nrow=ncol(gen)-1,ncol=2)
for(i in 1:2){
  frequencies[,i]   &lt;- colMeans(CycleList[[i]][,-1],na.rm=TRUE)/2
}
frequencies         &lt;- as.data.frame(frequencies)
names(frequencies)  &lt;- c("Cycle1","Cycle3")
change&lt;-frequencies$Cycle3-frequencies$Cycle1

################################################################
## step 3: Calculate LD Decay                                   ##
################################################################
ld                  &lt;- ld_decay (gen=gen, map=map,
                                 max_win_snp=2000, max.chr=10,
                                 cores=1, max_r2=0.03)

##################################################################
## step 4: Calculate Ghat                                       ##
##################################################################
Ghat.adf    &lt;- Ghat(effects=result$u, change=change, method = "scale",
                    perms=1000,plot="Ghat", num_eff = 54.74819)

message (paste("Ghat=" , Ghat.adf$Ghat,
            "Cor="  , Ghat.adf$Cor ,
            "P-val=", Ghat.adf$p.va, sep = " "))

## End(Not run)

</code></pre>


</div>