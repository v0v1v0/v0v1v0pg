<div class="container">

<table style="width: 100%;"><tr>
<td>sampler.mrf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MCMC samplers for Gibbs Random Fields
</h2>

<h3>Description</h3>

<p>sampler.mrf gives approximate sample from the likelihood of a general Potts model defined on a rectangular <code class="reqn">h x w</code> lattice (<code class="reqn">h \le w</code>) with either a first order or a second order dependency structure. Available options are the Gibbs sampler (Geman and Geman (1984)) and the Swendsen-Wang algorithm (Swendsen and Wang (1987)).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampler.mrf(iter, sampler = "Gibbs" , h, w, 
          param, ncolors = 2, nei = 4, pot = NULL, 
          top = NULL, left = NULL, bottom = NULL, right = NULL, 
          corner = NULL, initialise = TRUE, random = TRUE, view = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampler</code></td>
<td>
<p>The method to be used. The latter must be one of "Gibbs" or "SW" corresponding respectively to the Gibbs sampler and the Swendsen-Wang algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the number of rows of the rectangular lattice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>the number of columns of the rectangular lattice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>numeric entry setting the interaction parameter (edges parameter)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolors</code></td>
<td>
<p>the number of states for the discrete random variables. By default, ncolors = 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nei</code></td>
<td>
<p>the number of neighbors. The latter must be one of nei = 4 or nei = 8, which respectively correspond to a first order and a second order dependency structure. By default, nei = 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pot</code></td>
<td>
<p>numeric entry setting homogeneous potential on singletons (vertices parameter). By default, pot = NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top, left, bottom, right, corner</code></td>
<td>
<p>numeric entry setting constant borders for the lattice. By default, top = NULL, left = NULL, bottom = NULL, right = NULL, corner = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialise</code></td>
<td>
<p>Logical value indicating whether initial guess should be randomly drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>Logical value indicating whether the sites should be updated sequentially or randomdly. Used only with the "Gibbs" option.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>view</code></td>
<td>
<p>Logical value indicating whether the draw should be printed. Do not display the optional borders.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Geman, S. and Geman, D. (1984). Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images. <em>IEEE Transactions on Pattern Analysis and Machine Intellignence</em>, <b>6(6)</b>:721-741.
</p>
<p>Swendsen, R. H. and Wang, J.-S. (1987). Nonuniversal critical dynamics in Monte Carlo simulations. <em>Pysical Review Letters</em>, <b>58(2)</b>:86-88.
</p>


<h3>See Also</h3>

<p>The “GiRaF-introduction” vignette
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Algorithm settings
n &lt;- 200
method &lt;- "Gibbs"

# Dimension of the lattice
height &lt;- width &lt;- 100

# Interaction parameter
Beta &lt;- 0.6 # Isotropic configuration
# Beta &lt;- c(0.6, 0.6) # Anisotropic configuration when nei = 4
# Beta &lt;- c(0.6, 0.6, 0.6, 0.6) # Anisotropic configuration when nei = 8

# Number of colors
K &lt;- 2 
# Number of neighbors 
G &lt;- 4

# Optional potential on sites
potential &lt;- runif(K,-1,1)
# Optional borders. 
Top &lt;- Bottom &lt;- sample(0:(K-1), width, replace = TRUE)
Left &lt;- Right &lt;- sample(0:(K-1), height, replace = TRUE)
Corner &lt;- sample(0:(K-1), 4, replace = TRUE)

# Sampling method for the default setting
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            param = Beta, view = TRUE)
            
# Sampling using an existing configuration as starting point
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            ncolors = K, nei = G, param = Beta, 
            initialise = FALSE, view = TRUE)
            
# Specifying optional arguments. The users may omit to mention all
# the non-existing borders
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            ncolors = K, nei = G, param = Beta,
            pot = potential, top = Top, left = Left, bottom = Bottom, 
            right = Right, corner = Corner, view = TRUE)
            
# Gibbs sampler with sequential updates of the sites. 
sampler.mrf(iter = n, sampler = "Gibbs", h = height, w = width, 
            ncolors = K, nei = G, param = Beta,
            random = FALSE, view = TRUE)
</code></pre>


</div>