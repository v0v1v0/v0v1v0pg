<div class="container">

<table style="width: 100%;"><tr>
<td>FindReferences</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain reference columns (samples or cells) for all columns (samples or cells) in the data set</h2>

<h3>Description</h3>

<p>In some situations (see examples) it is required to find a reference sample of some kind for each sample in a data set.
This is a convenience method to find such reference samples, and provide them as a lookup table.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FindReferences(
  data,
  reference = NULL,
  reference.function = NULL,
  group = NULL,
  as.list = FALSE,
  columns = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A grandR object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>Expression evaluating to a logical vector to indicate which columns are reference columns; evaluated in an environment having the columns of Coldata(data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference.function</code></td>
<td>
<p>Function evaluating to a logical vector to indicate which columns are reference columns; called with the data frame row corresponding to the sample, and evaluated in an environment having the columns of Coldata(data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>a vector of colnames in Coldata(data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.list</code></td>
<td>
<p>return it as a list (names correspond to each sample, elements are the reference samples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>find references only for a subset of the columns (samples or cells; can be NULL)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Without any group, the list simply contains all references for each sample/cell. With groups defined, each list entry consists of all references from the same group.
</p>
<p>Columns can be given as a logical, integer or character vector representing a selection of the columns (samples or cells).
The expression is evaluated in an environment havin the <code>Coldata</code>, i.e. you can use names of <code>Coldata</code> as variables to
conveniently build a logical vector (e.g., columns=Condition=="x").
</p>


<h3>Value</h3>

<p>A logical matrix that contains for each sample or cell (in columns) a TRUE for the corresponding corresponding reference samples or cells in rows
</p>


<h3>See Also</h3>

<p>Coldata,Findno4sUPairs, Condition
</p>


<h3>Examples</h3>

<pre><code class="language-R">sars &lt;- ReadGRAND(system.file("extdata", "sars.tsv.gz", package = "grandR"),
                  design=c("Condition",Design$dur.4sU,Design$Replicate))
FindReferences(sars,reference=no4sU)
# obtain the corresponding no4sU sample for each sample; use the Condition column
FindReferences(sars,Condition=="Mock",group="duration.4sU.original")
# obtain for each sample the corresponding sample in the Mock condition
FindReferences(sars,Condition=="Mock",group=c("duration.4sU.original","Replicate"))
# obtain for each sample the corresponding Mock sample, paying attention to replicates

</code></pre>


</div>