<div class="container">

<table style="width: 100%;"><tr>
<td>PseudoEMAlgorithm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM-like algorithm for the GMCM</h2>

<h3>Description</h3>

<p>An fast and modified implementation of the Li et. al. (2011) EM-like
algorithm for estimating the maximizing parameters of the GMCM-likelihood
function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PseudoEMAlgorithm(x, theta, eps = 1e-04, max.ite = 1000,
  verbose = FALSE, trace.theta = FALSE, meta.special.case = FALSE,
  convergence.criterion = c("absGMCM", "GMCM", "GMM", "Li", "absLi"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of observations where rows corresponds to features and
columns to experiments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>A list of parameters formatted as described in
<code>rtheta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>The maximum difference required to achieve convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.ite</code></td>
<td>
<p>The maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Set to <code>TRUE</code> to increase verbosity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.theta</code></td>
<td>
<p>Logical. If <code>TRUE</code>, a trace of the estimated thetas
are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meta.special.case</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimators used are for
the special case GMCM of Li et. al. (2011).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence.criterion</code></td>
<td>
<p>Character. Sets the convergence criterion.  If
<code>"absGMCM"</code> the absolute value of difference in GMCM is used. If
<code>"GMCM"</code> the difference in GMCM-likelihoods are used as convergence
criterion. If <code>"GMM"</code>, the guaranteed non-decreasing difference of
GMM-likelihoods are used. If <code>"Li"</code>, the convergence criterion used by
Li et. al. (2011) is used. If <code>"absLi"</code>, the absolute values of the Li
et. al. criterion.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When either <code>"absGMCM"</code> or <code>"absLi"</code> are used, the parameters
corresponding to the biggest observed likelihood is returned. This is not
necessarily the last iteration.
</p>


<h3>Value</h3>

<p>A list of 3 or 4 is returned depending on the value of
<code>trace.theta</code> </p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>A list containing the final parameter
estimate in the format of <code>rtheta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik.tr</code></td>
<td>
<p>A matrix
with different log-likelihood traces in each row.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>A matrix
where the (i,j)'th entry is the probability that <code>x[i, ]</code> belongs to
the j'th component. Usually the returned value of <code>EStep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.tr</code></td>
<td>
<p>A list of each obtained parameter estimates in the format of
<code>rtheta</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The algorithm is highly sensitive to the starting parameters which
therefore should be carefully chosen.
</p>


<h3>Author(s)</h3>

<p>Anders Ellern Bilgrau &lt;anders.ellern.bilgrau@gmail.com&gt;
</p>


<h3>References</h3>

<p>Li, Q., Brown, J. B. J. B., Huang, H., &amp; Bickel, P. J. (2011).
Measuring reproducibility of high-throughput experiments. The Annals of
Applied Statistics, 5(3), 1752-1779. doi:10.1214/11-AOAS466
</p>


<h3>See Also</h3>

<p><code>rtheta</code>, <code>EMAlgorithm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)

# Choosing the true parameters and simulating data
true.par &lt;- c(0.8, 3, 1.5, 0.4)
data &lt;- SimulateGMCMData(n = 1000, par = true.par, d = 2)
uhat &lt;- Uhat(data$u)  # Observed ranks

# Plot of latent and observed data colour coded by the true component
par(mfrow = c(1,2))
plot(data$z, main = "Latent data", cex = 0.6,
     xlab = "z (Experiment 1)", ylab = "z (Experiment 2)",
     col = c("red","blue")[data$K])
plot(uhat, main = "Observed data", cex = 0.6,
     xlab = "u (Experiment 1)", ylab = "u (Experiment 2)",
     col = c("red","blue")[data$K])

# Fit the model using the Pseudo EM algorithm
init.par &lt;- c(0.5, 1, 1, 0.5)
res &lt;- GMCM:::PseudoEMAlgorithm(uhat, meta2full(init.par, d = 2),
                                verbose = TRUE,
                                convergence.criterion = "absGMCM",
                                eps = 1e-4,
                                trace.theta = FALSE,
                                meta.special.case = TRUE)

# Compute posterior cluster probabilities
IDRs &lt;- get.IDR(uhat, par = full2meta(res$theta))

# Plot of observed data colour coded by the MAP estimate
plot(res$loglik[3,], main = "Loglikelihood trace", type = "l",
     ylab = "log GMCM likelihood")
abline(v = which.max(res$loglik[3,])) # Chosen MLE
plot(uhat, main = "Clustering\nIDR &lt; 0.05", xlab = "", ylab = "", cex = 0.6,
     col = c("Red","Blue")[IDRs$Khat])

# View parameters
rbind(init.par, true.par, estimate = full2meta(res$theta))

# Confusion matrix
table("Khat" = IDRs$Khat, "K" = data$K)
</code></pre>


</div>