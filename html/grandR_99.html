<div class="container">

<table style="width: 100%;"><tr>
<td>LikelihoodRatioTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute a likelihood ratio test.</h2>

<h3>Description</h3>

<p>The test is computed on any of total/old/new counts using DESeq2 based on two nested models
specified using formulas.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LikelihoodRatioTest(
  data,
  name = "LRT",
  mode = "total",
  slot = "count",
  normalization = mode,
  target = ~Condition,
  background = ~1,
  columns = NULL,
  logFC = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A grandR object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>the user defined analysis name to store the results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>either "total", "new" or "old"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>which slot to use (should be a count slot, not normalized values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalization</code></td>
<td>
<p>normalize on "total", "new", or "old" (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>formula specifying the target model (you can use any column name from the <code>Coldata(data)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>formula specifying the background model (you can use any column name from the <code>Coldata(data)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>logical vector of which columns (samples or cells) to use (or NULL: use all)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logFC</code></td>
<td>
<p>compute and add the log2 fold change as well</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print status updates</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a convenience wrapper around the likelihood ratio test implemented in DESeq2.
</p>
<p>DESeq2 by default performs size factor normalization. When computing differential expression of new RNA,
it might be sensible to normalize w.r.t. to total RNA, i.e. use the size factors computed from total RNA instead of computed from new RNA.
This can be accomplished by setting mode to "new", and normalization to "total"!
</p>


<h3>Value</h3>

<p>a new grandR object including a new analysis table. The columns of the new analysis table are
</p>
<table>
<tr style="vertical-align: top;">
<td><code>"M"</code></td>
<td>
<p>the base mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"S"</code></td>
<td>
<p>the difference in deviance between the reduced model and the full model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"P"</code></td>
<td>
<p>the likelihood ratio test P value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"Q"</code></td>
<td>
<p>same as P but Benjamini-Hochberg multiple testing corrected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"LFC"</code></td>
<td>
<p>the log2 fold change for the target model (only with the logFC parameter set to TRUE)</p>
</td>
</tr>
</table>
</div>