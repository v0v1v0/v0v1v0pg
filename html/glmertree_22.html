<div class="container">

<table style="width: 100%;"><tr>
<td>plot.glmertree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting (Generalized) Linear Mixed Model Trees</h2>

<h3>Description</h3>

<p><code>plot</code> method for <code>(g)lmertree</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lmertree'
plot(x, which = "all", nodesize_level = 1L, 
    cluster = NULL, ask = TRUE, type = "extended", 
    observed = TRUE, fitted = "combined", tp_args = list(), 
    drop_terminal = TRUE, terminal_panel = NULL, dotplot_args = list(), ...)
## S3 method for class 'glmertree'
plot(x, which = "all", nodesize_level = 1L, 
    cluster = NULL, ask = TRUE, type = "extended", 
    observed = TRUE, fitted = "combined", tp_args = list(), 
    drop_terminal = TRUE, terminal_panel = NULL, dotplot_args = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>lmertree</code> or <code>glmertree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>character; <code>"all"</code> (default), <code>"tree"</code>, 
<code>"random"</code>, <code>"tree.coef"</code> of <code>"growth"</code>. Specifies whether the tree, random          
effects, or both should be plotted. <code>"growth"</code> should only be used
in longitudinal models, it yields a tree with growth curves for each of the
subjects in the tree nodes, instead of individual datapoints, and a 
thick red curve for the estimated node-specific fixed effectsm representing the
average trajectory within the terminal node.
<code>"tree.coef"</code>           
yields caterpillar plots of the estimated fixed-effects coefficients
in every terminal node of the tree, but omits the tree structure 
(see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodesize_level</code></td>
<td>
<p>numeric. At which grouping level should sample size 
printed above each terminal node be computed? Defaults to 1, which
is the lowest level of observation. If a value of 2 is specified,
sample size at the cluster level will be printed above each terminal node.
This only works if <code>x</code> (the (g)lmertree) was fitted using 
the <code>cluster</code> argument. Alternatively, a character vector of length
one can be supplied, which gives the name of the grouping indicator
in the <code>data.frame</code> used to fit <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>vector of cluster ids. Only used if <code>which = "growth"</code>.
Need not be specified if clustered covariances were used for partitioning 
(i.e., argument <code>cluster</code> was specified). If <code>cluster</code> was not
specified in the call to functions <code>(g)lmertree</code>, this argument 
should be specified for the plotting function to identify which
individual observations belong to the same subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical. Should user be asked for input, before a new figure
is drawn?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character; <code>"extended"</code> (default) or <code>"simple"</code>.
<code>"extended"</code> yields a plotted tree with observed data and/or
fitted means plotted in the terminal nodes; <code>"simple"</code> yields a 
plotted tree with the value of fixed and/or random effects coefficients 
reported in the terminal nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>logical. Should observed datapoints be plotted in the tree?
Defaults to <code>TRUE</code>, <code>FALSE</code> is only supported for objects of 
class <code>lmertree</code>, not of class<code>glmertree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>character. <code>"combined"</code> (default), <code>"marginal"</code> 
or <code>"none"</code>. Specifies whether and how fitted values should be 
computed and visualized. Only used when predictor variables for the 
node-specific (G)LMs were specified. If <code>"combined"</code>, fitted 
values will computed, using observed values of the remaining 
(random and fixed-effects) predictor variables, which can yield
very wiggly curves. If <code>"marginal"</code>, fitted values will be calculated, 
fixing all remaining predictor variables (with random and/or fixed effects) 
at the observed sample mean (or majority class).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tp_args</code></td>
<td>
<p>list of arguments to be passed to panel generating function
<code>node_glmertree</code>. See arguments <code>node_bivplot</code> in 
<code>panelfunctions</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_terminal</code></td>
<td>
<p>logical. Should all terminal nodes be plotted at the 
bottom of the plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terminal_panel</code></td>
<td>
<p>an optional panel generating function to be passed to 
<code>plot.party()</code>, but will most likely be ignored. For passing 
arguments to the panel generating functions, use argument
<code>tp_args</code>. For using a custom panel generating function,
see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dotplot_args</code></td>
<td>
<p>Optional list of additional arguments to be passed to 
<code>dotplot</code>. Only relevant when random- or fixed-effects plots
are requested by specifying <code>which</code> as <code>"ranef"</code>, <code>"all"</code>, or 
<code>"ranef"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to <code>plot.party()</code>.
See <code>party-plot</code> documentation for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the node-specific model of the <code>(g)lmertree</code> object specified by 
argument <code>x</code> is an intercept-only model, observed data distributions
will be plotted in the terminal nodes of the tree (using 
<code>node_barplot</code> (for categorical responses) or 
<code>node_boxplot</code> (for numerical responses). Otherwise, 
fitted values will be plotted, in addition to observed datapoints, using a
function taking similar arguments as <code>node_bivplot</code>.
</p>
<p>Exceptions:
</p>
<p>If <code>fitted = "marginal"</code>, fitted values will be plotted by assuming the
mean (continuous predictors) or mode (categorical predictors) for all 
predictor variables, except the variable on the x-axis of the current plot.
</p>
<p>If <code>which = "growth"</code>, individual growth curves will be plotted as thin grey
lines in the terminal nodes, while the node-specific fixed effect will be plotted
on top of that as a thicker red curve. 
</p>
<p>If <code>which = "tree.coef"</code>), caterpillar plot(s) are created for the local 
(node-specific) fixed effects. These depict the estimated fixed-effects 
coefficients with 95% confidence intervals, but note that these CIs do not 
account for the searching of the tree structure and are therefore likely 
too narrow. There is currently no way to adjust CIs for searching of the tree 
structure, but the CIs can be useful to obtain an indication of the variability 
of the coefficient estimates, not for statistical significance testing. 
</p>
<p>If <code>which = "ranef"</code> or <code>"all"</code>, caterpillar plot(s) for the random 
effect(s) created, depicting the predicted random effects with 95% confidence 
intervals. See also <code>ranef</code> for more info. Note that the CIs
do not account for the searching of the tree structure and may be too narrow.
</p>
<p>If users want to specify custom panel generating functions, it might be best to
not use the plotting method for (g)lmertrees. Instead, extract the (g)lmtree from
the fitted (g)lmertree object (which is a list containing, amongst others, an element 
<code>$tree</code>). On this tree, most of the customization options from 
<code>party-plot</code> can then be applied.
</p>
<p>The code is still under development and might change in future versions.
</p>


<h3>References</h3>

<p>Fokkema M, Smits N, Zeileis A, Hothorn T, Kelderman H (2018).
“Detecting Treatment-Subgroup Interactions in Clustered Data
with Generalized Linear Mixed-Effects Model Trees”. Behavior Research 
Methods, 50(5), 2016-2034. <a href="https://doi.org/10.3758/s13428-017-0971-x">doi:10.3758/s13428-017-0971-x</a>
</p>


<h3>See Also</h3>

<p><code>lmertree</code>, <code>glmertree</code>, 
<code>party-plot</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">
## load artificial example data
data("DepressionDemo", package = "glmertree")

## fit linear regression LMM tree for continuous outcome
lt &lt;- lmertree(depression ~ treatment + age | cluster | anxiety + duration,
  data = DepressionDemo)
plot(lt)
plot(lt, type = "simple")
plot(lt, which = "tree", fitted = "combined")
plot(lt, which = "tree", fitted = "none")
plot(lt, which = "tree", observed = FALSE)
plot(lt, which = "tree.coef")
plot(lt, which = "ranef")

## fit logistic regression GLMM tree for binary outcome
gt &lt;- glmertree(depression_bin ~ treatment + age | cluster | 
  anxiety + duration, data = DepressionDemo)
plot(gt)  
plot(gt, type = "simple")
plot(gt, which = "tree", fitted = "combined")
plot(gt, which = "tree", fitted = "none")
plot(gt, which = "tree.coef")
plot(gt, which = "ranef")

</code></pre>


</div>