<div class="container">

<table style="width: 100%;"><tr>
<td>p_value_contrast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hypothesis tests on contrasts</h2>

<h3>Description</h3>

<p>This S3 generic function allows the computation of P-values associated to
hypothesis tests of contrasts (i.e. linear combinations) of fixed-effects in a model.
The default implementation computes Wald's P-values with any model as long as it consistently implements <code>fixcoef</code>, <code>vcov_fixcoef</code> and <code>df_for_wald</code>.
It is also specialized for GLMs and negative binomial models (see <code>MASS::glm.nb</code>) with Wald's, LRT and Rao's P-values and may be specialized with other models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p_value_contrast(
  model,
  contrast,
  alternative = c("two.sided", "less", "greater"),
  H0 = 0,
  method = NULL,
  ...
)

## S3 method for class 'glm'
p_value_contrast(
  model,
  contrast,
  alternative = c("two.sided", "less", "greater"),
  H0 = 0,
  method = c("LRT", "Rao", "Chisq", "F", "Wald", "wald"),
  ...,
  debuglevel = 1,
  force = FALSE
)

## Default S3 method:
p_value_contrast(
  model,
  contrast,
  alternative = c("two.sided", "less", "greater"),
  H0 = 0,
  method = "Wald",
  ...,
  debuglevel = 0,
  force = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a fitted statistical model such as a glm or a coxph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>numeric vector of the same length as the number of coefficients in the model; it describes the contrast <code>sum(contrast*fixcoef(model))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of "two.sided" (default), "greater" or "less". You can specify just the initial letter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0</code></td>
<td>
<p>numeric value; the value of the contrast under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string value; specification of the algorithm used (implementation dependent).
Suggested values are "Wald", "LRT", "Rao" and "exact" for, respectively, Wald's asymptotic normality and/or student test,
the Generalized Likelihood Ratio Test, Rao's score test and non-asymptotic exact tests. Other values may be allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters that may be used by some implementations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debuglevel</code></td>
<td>
<p>integer value; set to 0 (default) to disable warnings, 1 to enable warnings and 2 to enable warnings and notes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>logical; if TRUE, force computation of P-values in case of convergence problems.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Every implementation MUST support specification of the alternative hypothesis
(alternative argument) and null hypothesis (H0 argument).
</p>


<h3>Value</h3>

<p>A single numeric value (vector of length 1) equal to the one-sided (for alternative="less" or "greater") or two-sided P-value
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>glm</code>: It supports Wald (method="Wald"),
Generalized Likelihood Ratio Tests (method="LRT") and Rao's score tests (method="Rao").
It works for <code>stats::glm</code> models and negative binomial models (<code>MASS::glm.nb</code>) with method="LRT" and method="Wald".
</p>
</li>
<li> <p><code>default</code>: Supports Wald's test on a wide range of models, including <code>lm</code>, <code>mlm</code>,
<code>stats::glm</code>, <code>negbin</code>, <code>MASS::polr</code>,
<code>MASS::rlm</code> (with normality assumptions, defeating the purpose of rlm), <code>nlme::lme</code>, 
<code>nlme::gls</code>, <code>lme4::lmer</code>, <code>lme4::glmer</code>, 
<code>mgcv::gam</code>, <code>gam::gam</code>, <code>survival::coxph</code>, 
<code>survival::survreg</code>, 
<code>nnet::multinom</code>, <code>stats::nls</code>.
</p>
<p>It can be easily extended by implementing three generic functions:
<code>fixcoef</code>, <code>vcov_fixcoef</code> and <code>df_for_wald</code>.
If the implementations of <code>coef</code>, <code>vcov</code> and <code>df.residual</code> are consistent,
you do not have to implement <code>fixcoef</code>, <code>vcov_fixcoef</code> and <code>df_for_wald</code>.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>Other Wald-related functions: 
<code>df_for_wald()</code>,
<code>fixcoef()</code>,
<code>vcov_fixcoef()</code>
</p>
<p>Other Contrast functions: 
<code>confint_contrast()</code>,
<code>estimate_confint_contrast()</code>,
<code>estimate_contrast()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mtcars)
model1 = glm(family="gaussian", data=mtcars, hp ~ 0+factor(gear))
# do cars with 5 gears have more horse power (hp) than cars with 4 gears ?
p_value_contrast(model1, c(0,-1,1), alternative="greater")

# now, we fit an equivalent model (same distribution and same predictions)
model2 = glm(family=gaussian(log), data=mtcars, hp ~ 0+factor(gear))

# do cars with 5 gears have at least twice the horse power than cars with 4 gears ?

# the following two tests are equivalent
p_value_contrast(model1, c(0,-1,0.5), alternative="greater", method="LRT", H0=0)
p_value_contrast(model2, c(0,-1,1), alternative="greater", method="LRT", H0=log(2))

# the following two tests are close but not equivalent
p_value_contrast(model1, c(0,-1,0.5), alternative="greater", method="Wald", H0=0)
p_value_contrast(model2, c(0,-1,1), alternative="greater", method="Wald", H0=log(2))
</code></pre>


</div>