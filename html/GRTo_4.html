<div class="container">

<table style="width: 100%;"><tr>
<td>fmddisc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Analysis of Discontinuities in Frequency Magnitude Distributions </h2>

<h3>Description</h3>

<p>This function finds significant discontinuities in Frequency Magnitude Distributions (FMD).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmddisc(file, header = FALSE, colid = 1, nrep = 200, title = "fmddisc")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p> filename of the file to be loaded </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>
<p> whether <code>file</code> contains headers or not </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colid</code></td>
<td>
<p> field number for the magnitude values in <code>file</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p> number of replicates for the bootstrap </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p> main title for the plot </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function reads magnitude values in the field which number is indicated by <code>colid</code> in <code>file</code>.
The function returns values of significant magnitude discontinuities (e. g. deviations from linearity) in the FMD. A bootstrap procedure is used to obtain the 90% confidence interval for magnitude 
discontinuities. We assumed the distribution of the <code>nrep</code> bootstrap replicates is not skewed. Therefore, the 90% confidence interval is simply formed by taking 5% and 95% quantiles of the bootstrap replicates as the lower and upper bound of the interval respectively. These values and the 50% quantile (median) are returned in a list by the function.
The function also returns bootstrap mean and bootstrap standard-error (standard deviation of bootstrap replicate estimates). The bootstrap margin of errors at the 90% normal confidence level is returned as the result of 1.645 \* bootstrap standard-error. 
The function produces a plot showing the FMD and histograms of magnitude values for the significant 
discontinuities in the FMD. The plot is stored into a file with name <code>file</code>\_disc.png (png format file).
Values of counts in histograms are controlled by the number of replicates <code>nrep</code> that are
used. 
</p>


<h3>Value</h3>

<p>This function returns a list containing the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>quant1 </code></td>
<td>
<p>the 5%, 50% and 95% quantiles of the bootstrap replicates for the main discontinuity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valid </code></td>
<td>
<p>the numbers of valid replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bmean </code></td>
<td>
<p>the bootstrap mean values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bse </code></td>
<td>
<p>the bootstrap standard-error values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bme </code></td>
<td>
<p>the bootstrap margin of errors values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant2 </code></td>
<td>
<p>the 5%, 50% and 95% quantiles of the bootstrap replicates for the auxiliary discontinuity</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Thanks to Scott Kostyshak for telling us about the extra bootstrap package dependency. GRTo version 1.2 fixes this issue.
</p>


<h3>Author(s)</h3>

<p> Daniel Amorese </p>


<h3>References</h3>

 
<p>D. Amorese, "Applying a change-point detection method on frequency-magnitude distributions", <em>Bull. seism. Soc. Am.</em> (2007) 97, doi:10.1785\/0120060181
</p>


<h3>Examples</h3>

<pre><code class="language-R">fmddisc(file=system.file("extdata","IDYLLdeep.data.txt",package="GRTo"),
header=FALSE,colid=15,nrep=200,"FMD mag discontinuities")
</code></pre>


</div>