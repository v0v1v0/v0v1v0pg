<div class="container">

<table style="width: 100%;"><tr>
<td>probPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability plots to check the goodness of fit of parametric models</h2>

<h3>Description</h3>

<p><code>probPlot</code> provides four types of probability plots: P-P plot, Q-Q plot, Stabilised probability plot, and Empirically Rescaled plot to check if a certain distribution is an appropiate choice for the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
probPlot(times, cens = rep(1, length(times)),
         distr = c("exponential", "gumbel", "weibull", "normal",
                   "lognormal", "logistic", "loglogistic", "beta"),
         plots = c("PP", "QQ", "SP", "ER"),
         colour = c("green4", "deepskyblue4", "yellow3",
                    "mediumvioletred"), mtitle = TRUE, ggp = FALSE,
         m = NULL, betaLimits = c(0, 1), igumb = c(10, 10),
         prnt = TRUE, degs = 3, 
         params0 = list(shape = NULL, shape2 = NULL,
                        location = NULL, scale = NULL), ...)
## S3 method for class 'formula'
probPlot(formula, data, ...)                     
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Numeric vector of times until the event of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>
<p>Status indicator (1, exact time; 0, right-censored time). If not 
provided, all times are assumed to be exact.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>A string specifying the name of the distribution to be studied. 
The possible distributions are the exponential (<code>"exponential"</code>), 
the Weibull (<code>"weibull"</code>), the Gumbel (<code>"gumbel"</code>), 
the normal (<code>"normal"</code>), the lognormal (<code>"lognormal"</code>),
the logistic (<code>"logistic"</code>), the loglogistic (<code>"loglogistic"</code>),
and the beta (<code>"beta"</code>) distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>Vector stating the plots to be displayed. Possible choices are 
the P-P plot (<code>"PP"</code>), the Q-Q plot (<code>"QQ"</code>), 
the Stabilised Probability plot (<code>"SP"</code>), and the 
Empirically Rescaled plot (<code>"ER"</code>). By default, all four 
plots are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colour</code></td>
<td>
<p>Vector indicating the colours of the displayed plots. 
The vector will be recycled if its length is smaller 
than the number of plots to be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtitle</code></td>
<td>
<p>Logical to add or not the title "Probability plots for a <code>distr</code>
distribution" to the plot. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggp</code></td>
<td>
<p>Logical to use or not the <span class="pkg">ggplot2</span> package to draw the plots. 
Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Optional layout for the plots to be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaLimits</code></td>
<td>
<p>Two-components vector with the lower and upper bounds of the 
Beta distribution. This argument is only required, if the beta
distribution is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>igumb</code></td>
<td>
<p>Two-components vector with the initial values for the estimation 
of the Gumbel distribution parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prnt</code></td>
<td>
<p>Logical to indicate if the maximum likelihood estimates of the 
parameters should be printed. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degs</code></td>
<td>
<p>Integer indicating the number of decimal places of the numeric 
results of the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params0</code></td>
<td>
<p>List specifying the parameters of the theoretical distribution. 
By default, parameters are set to <code>NULL</code> and estimated with 
the maximum likelihood method. This argument is only considered, 
if all parameters of the studied distribution are specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula with a numeric vector as response (which assumes no censoring) or <code>Surv</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame for variables in <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments for function <code>par</code>, if <code>ggp = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, function <code>probPlot</code> draws four plots: P-P plot, 
SP plot, Q-Q plot, and EP plot. Following, a description is given for 
each plot.
</p>
<p>The <b>Probability-Probability plot</b> (P-P plot) depicts the empirical
distribution, <code class="reqn">\widehat{F}(t)</code>, which is obtained with the Kaplan-Meier
estimator if data are right-censored, versus the theoretical cumulative
distribution function (cdf), <code class="reqn">\widehat{F_0}(t)</code>. If the data come 
from the chosen distribution, the points of the resulting graph are 
expected to lie on the identity line.
</p>
<p>The <b>Stabilised Probability plot</b> (SP plot), proposed by Michael (1983), 
is a transformation of the P-P plot. It stabilises the variance of the 
plotted points. If <code class="reqn">F_0 = F</code> and the parameters of <code class="reqn">F_0</code> are known,
<code class="reqn">\widehat{F_0}(t)</code> corresponds to the cdf of a uniform order statistic, 
and the arcsin transformation stabilises its variance. If the data come 
from distribution <code class="reqn">F_0</code>, the SP plot will resemble the identity line.
</p>
<p>The <b>Quartile-Quartile plot</b> (Q-Q plot) is similar to the P-P plot, 
but it represents the sample quantiles versus the theoretical ones, 
that is, it plots <code class="reqn">t</code> versus <code class="reqn">\widehat{F}_0^{-1}(\widehat{F}(t))</code>. 
Hence, if <code class="reqn">F_0</code> fits the data well, the resulting plot will resemble 
the identity line.
</p>
<p>A drawback of the Q-Q plot is that the plotted points are not evenly spread.
Waller and Turnbull (1992) proposed the <b>Empirically Rescaled plot</b> 
(EP plot), which plots <code class="reqn">\widehat{F}_u(t)</code> against 
<code class="reqn">\widehat{F}_u(\widehat{F}_0^{-1}(\widehat{F}(t)))</code>, where 
<code class="reqn">\widehat{F}_u(t)</code> is the empirical cdf of the points corresponding 
to the uncensored observations. Again, if <code class="reqn">\widehat{F}_0</code> fits the 
data well, the ER plot will resemble the identity line.
</p>
<p>By default, all four probability plots are drawn and the maximum 
likelihood estimates of the parameters of the chosen parametric model
are returned. The parameter estimation is acomplished with the 
<code>fitdistcens</code> function of the <span class="pkg">fitdistrplus</span> package.
</p>


<h3>Value</h3>

<p>If <code>prnt = TRUE</code>, the following output is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Distribution</code></td>
<td>
<p>Distribution under study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Parameters</code></td>
<td>
<p>Parameters used to draw the plots (if <code>params0</code> 
is provided).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Estimates</code></td>
<td>
<p>Maximum likelihood estimates of the parameters.</p>
</td>
</tr>
</table>
<p>In addition, a list with the same contents is returned invisibly.
</p>


<h3>Author(s)</h3>

<p>K. Langohr, M. Besalú, M. Francisco, G. Gómez.</p>


<h3>References</h3>

<p>J. R. Michael. <em>The Stabilized Probability Plot</em>. In: Biometrika 70 (1) (1983), 
11-17.
</p>
<p>L.A. Waller and B.W. Turnbull. <em>Probability Plotting with Censored Data</em>. In:
American Statistician 46 (1) (1992), 5-12.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># P-P, Q-Q, SP, and EP plots for complete data
set.seed(123)
x &lt;- rlnorm(1000, 3, 2)
probPlot(x) 
probPlot(x, distr = "lognormal") 

# P-P, Q-Q, SP, and EP plots for censored data using ggplot2
data(colon)
probPlot(Surv(time, status) ~ 1, colon, "weibull", ggp = TRUE) 

# P-P, Q-Q and SP plots for censored data and lognormal distribution
data(nba)
probPlot(Surv(survtime, cens) ~ 1, nba, "lognorm", plots = c("PP", "QQ", "SP"),
         ggp = TRUE, m = matrix(1:3, nr = 1))
</code></pre>


</div>