<div class="container">

<table style="width: 100%;"><tr>
<td>cr_run_schedule_http</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a Cloud Scheduler HTTP target for a private Cloud Run URI</h2>

<h3>Description</h3>

<p>This enables Cloud Scheduler to trigger Cloud Run endpoints when they are not public.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cr_run_schedule_http(uri, email, http_method = "GET", body = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>uri</code></td>
<td>
<p>The URI of your Cloud Run application</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>email</code></td>
<td>
<p>The service email that has invoke access to the Cloud Run application.  If using cr_run and derivatives to make the email this will include <code>(name)-cloudrun-invoker@(project-id).iam.gserviceaccount.com</code> - see cr_run_email to help make the email.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>http_method</code></td>
<td>
<p>The HTTP verb you have set up your Cloud Run application to receive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>body</code></td>
<td>
<p>(optional) An R list object that will be turned into JSON via toJSON and turned into a base64-encoded string if you are doing a POST, PUT or PATCH request.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Ensure you have a service email with cr_email_set of format <code>service-{project-number}@gcp-sa-cloudscheduler.iam.gserviceaccount.com</code> with Cloud Scheduler Service Agent role as per https://cloud.google.com/scheduler/docs/http-target-auth#add
</p>


<h3>Value</h3>

<p>A HttpTarget object for use in cr_schedule
</p>


<h3>See Also</h3>

<p>https://cloud.google.com/run/docs/triggering/using-scheduler
</p>
<p>cr_schedule_http and cr_run and cr_deploy_run
</p>
<p>Other Cloud Scheduler functions: 
<code>HttpTarget()</code>,
<code>Job()</code>,
<code>PubsubTarget()</code>,
<code>cr_build_schedule_http()</code>,
<code>cr_schedule_delete()</code>,
<code>cr_schedule_get()</code>,
<code>cr_schedule_list()</code>,
<code>cr_schedule_pause()</code>,
<code>cr_schedule_run()</code>
</p>
<p>Other Cloud Run functions: 
<code>cr_jwt_create()</code>,
<code>cr_plumber_pubsub()</code>,
<code>cr_run_email()</code>,
<code>cr_run_get()</code>,
<code>cr_run_list()</code>,
<code>cr_run()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# for unauthenticated apps create a HttpTarget
run_me &lt;- HttpTarget(
  uri = "https://public-ewjogewawq-ew.a.run.app/echo?msg=blah",
  http_method = "GET"
)
cr_schedule("cloud-run-scheduled",
  schedule = "16 4 * * *",
  httpTarget = run_me
)

# for authenticated Cloud Run apps - create with allowUnauthenticated=FALSE
cr_deploy_run("my-app", allowUnauthenticated = TRUE)

## End(Not run)

# deploying via R will help create a service email called my-app-cloudrun-invoker
cr_run_email("my-app")
## Not run: 
# use that email to schedule the Cloud Run private micro-service

# schedule the endpoint
my_run_name &lt;- "my-app"
my_app &lt;- cr_run_get(my_run_name)
email &lt;- cr_run_email(my_run_name)
endpoint &lt;- paste0(my_app$status$url, "/fetch_stuff")

app_sched &lt;- cr_run_schedule_http(endpoint,
  http_method = "GET",
  email = email
)

cr_schedule("cloud-run-scheduled-1",
  schedule = "4 16 * * *",
  httpTarget = app_sched
)

## End(Not run)

</code></pre>


</div>