<div class="container">

<table style="width: 100%;"><tr>
<td>gdpc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Dynamic Principal Components</h2>

<h3>Description</h3>

<p>Computes a single Generalized Dynamic Principal Component with a given number of lags.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gdpc(Z, k, f_ini = NULL, tol = 1e-4, niter_max = 500, crit = 'LOO')</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Data matrix. Each column is a different time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Integer. Number of lags to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_ini</code></td>
<td>
<p>(Optional). Numeric vector. Starting point for the iterations. If no argument is passed the ordinary (non-dynamic) first principal component completed with k lags is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Relative precision. Default is 1e-4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter_max</code></td>
<td>
<p>Integer. Maximum number of iterations. Default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>A string specifying the criterion to be used to evaluate the fitted model. Options are 'LOO', 'AIC', 'BIC' and 'BNG'. Default is 'LOO'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>auto.gdpc</code> for the definition of criterion that is part of the output of this function.
</p>


<h3>Value</h3>

<p>An object of class <code>gdpc</code>, that is, a list with entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>expart</code></td>
<td>
<p>Proportion of the variance explained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>Mean squared error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>The value of the criterion of the reconstruction, according to what the user specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of lags used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Vector of intercepts corresponding to f.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Matrix of loadings corresponding to f. Column number <code class="reqn">k</code> is the vector of <code class="reqn">k-1</code> lag loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Coordinates of the first dynamic principal component corresponding to the periods <code class="reqn">1,\dots,T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_f</code></td>
<td>
<p>Coordinates of the first dynamic principal component corresponding to the periods <code class="reqn">-k+1,\dots,0</code>. Only for the case <code class="reqn">k&gt;0</code>, otherwise 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>Logical. Did the iterations converge?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Integer. Number of iterations.</p>
</td>
</tr>
</table>
<p><code>fitted</code>, <code>plot</code> and <code>print</code> methods are available for this class.
</p>


<h3>Author(s)</h3>

<p>Daniel Pe√±a, Ezequiel Smucler, Victor Yohai
</p>


<h3>See Also</h3>

<p><code>auto.gdpc</code>, <code>plot.gdpc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">T &lt;- 200 #length of series
m &lt;- 500 #number of series
set.seed(1234)
f &lt;- rnorm(T + 1)
x &lt;- matrix(0, T, m)
u &lt;- matrix(rnorm(T * m), T, m)
for (i in 1:m) {
    x[, i] &lt;- 10 * sin(2 * pi * (i/m)) * f[1:T] + 10 * cos(2 * pi * (i/m)) * f[2:(T + 1)] + u[, i]
}
fit &lt;- gdpc(x, k = 1) #find first DPC with one lag
fit
par(mfrow = c(1, 2)) #plot loadings
plot(fit, which = 'Loadings', which_load = 0, xlab = '', ylab = '') 
plot(fit, which = 'Loadings', which_load = 1, xlab = '', ylab = '') 
</code></pre>


</div>