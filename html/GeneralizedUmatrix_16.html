<div class="container">

<table style="width: 100%;"><tr>
<td>plotTopographicMap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Visualizes the generalized U-matrix in 3D
</h2>

<h3>Description</h3>

<p>The generalized U-matrix is visualized as the topographic map with hypsometric tints. The topographic map represents high-dimensional distance and density-based structurs in form of a 3D landscape.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotTopographicMap(GeneralizedUmatrix, BestMatchingUnits,

Cls=NULL,ClsColors=NULL,Imx=NULL,Names=NULL,

BmSize=0.5,RenderingContourLines=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>GeneralizedUmatrix</code></td>
<td>
<p>[1:Lines,1:Columns] U-matrix to be plotted, numerical
matrix storing the U-heights, see [Thrun, 2018] for definition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BestMatchingUnits</code></td>
<td>
<p>[1:n,1:2], Positions of bestmatches to be plotted as
spheres onto the topographic map</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cls</code></td>
<td>
<p>[1:n], numerical vector of classification of <code>k</code> clusters, one
label for each bestmatch at that given point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClsColors</code></td>
<td>
<p>Vector of colors that will be used to colorize the different
clusters, default is GeneralizedUmatrix::DefaultColorSequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Imx</code></td>
<td>
<p>a mask (Imx) that will be used to cut out the U-matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Names</code></td>
<td>
<p>If set: [1:k] character vector naming the k clusters for the
legend. In this case, further parameters with the possibility to adjust are:
<code>NamesCex</code>: (size); <code>NamesPosition</code>: Legend position;
<code>NamesTitle</code>: title of legend; <code>NamesColors</code>: colors if ClsColors are
not default (NULL), etc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BmSize</code></td>
<td>
<p>size(diameter) of the points in the visualizations. The points
represent the BestMatchingUnits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RenderingContourLines</code></td>
<td>
<p>FALSE: disables plotting of contour lines resulting
in a much faster plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Besides the legend/names parameter the list of further parameters,
use only of you know what you are doing:
</p>

<dl>
<dt>Tiled</dt>
<dd>
<p>Should the U-matrix be drawn 4times?</p>
</dd>
<dt>ShowAxis</dt>
<dd>
<p>shall the axis be shown?</p>
</dd>
<dt>NoLevels</dt>
<dd>
<p>number of contour lines</p>
</dd>
<dt>ExtendBorders</dt>
<dd>
<p>scalar, extends U-matrix by toroidal continuation of the given U-matrix</p>
</dd>
<dt>Colormap</dt>
<dd>
<p>in the case of density p matrix...</p>
</dd>
<dt>title</dt>
<dd>
<p>same as main</p>
</dd>
<dt>main</dt>
<dd>
<p>same as title</p>
</dd>
<dt>sub</dt>
<dd>
<p>same as in <code>plot</code></p>
</dd>
<dt>xlab</dt>
<dd>
<p>same as in <code>plot</code></p>
</dd>   
<dt>ylab</dt>
<dd>
<p>same as in <code>plot</code></p>
</dd>
<dt>zlab</dt>
<dd>
<p>same as in <code>plot</code></p>
</dd>
<dt>NamesPosition</dt>
<dd>
<p>same as in <code>bgplot3d</code></p>
</dd>
<dt>NamesColors</dt>
<dd>
<p>same as col in <code>bgplot3d</code></p>
</dd>
<dt>NamesCex</dt>
<dd>
<p>same as cex in <code>bgplot3d</code></p>
</dd>
<dt>NamesTitle</dt>
<dd>
<p>same as title in <code>bgplot3d</code></p>
</dd>
<dt>NamesPch</dt>
<dd>
<p>same as pch in <code>bgplot3d</code></p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The visualization of this function is a topographic map with hypsometric tints (Thrun, Lerch, L?tsch, &amp; Ultsch, 2016).
"Hypsometric tints are surface colors that represent ranges of elevation (Patterson and Kelso 2004). Here, contour lines are combined with a specific color scale. The color scale is chosen to display various valleys, ridges, and basins: blue colors indicate small distances (sea level), green and brown colors indicate middle distances (low hills), and white colors indicate vast distances (high mountains covered with snow and ice). Valleys and basins represent clusters, and the watersheds of hills and mountains represent the borders between clusters. In this 3D landscape, the borders of the visualization are cyclically connected with a periodicity (L,C). The number of clusters can be estimated by the number of valleys of the visualization. The clustering is valid if mountains do not partition clusters indicated by colored points of the same color and colored regions of points (see examples in section 4.1 and 4.2)."[Thrun/Ultsch, 2020].  
</p>
<p>A central problem in clustering is the correct estimation of the number of clusters. This is addressed by the topographic map which allows assessing the number of clusters as the number of valleys (Thrun et al., 2016). Please see chapter 5 of [Thrun, 2018] for further details.
</p>


<h3>Value</h3>

<p>An object of class "htmlwidget" in mode invisible, please <code>rglwidget</code> for details.
</p>


<h3>Note</h3>

<p>First version of algorithm was partly based on the U-matrix package.
</p>


<h3>Author(s)</h3>

<p>Michael Thrun
</p>


<h3>References</h3>

<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, doctoral dissertation 2017, Springer, Heidelberg, ISBN: 978-3-658-20539-3, <a href="https://doi.org/10.1007/978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>, 2018. 
</p>
<p>[Thrun et al., 2016]  Thrun, M. C., Lerch, F., Loetsch, J., &amp; Ultsch, A.: Visualization and 3D Printing of Multivariate Data of Biomarkers, in Skala, V. (Ed.), International Conference in Central Europe on Computer Graphics, Visualization and Computer Vision (WSCG), Vol. 24, Plzen, http://wscg.zcu.cz/wscg2016/short/A43-full.pdf, 2016.
</p>
<p>[Thrun/Ultsch, 2020]  Thrun, M. C., &amp; Ultsch, A. : Using Projection based Clustering to Find Distance and Density based Clusters in High-Dimensional Data, Journal of Classification, DOI 10.1007/s00357-020-09373-2, in press, Springer, 2020. 
</p>


<h3>See Also</h3>

<p><code>GeneralizedUmatrix</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data("Chainlink")
Data=Chainlink$Data
Cls=Chainlink$Cls
InputDistances=as.matrix(dist(Data))
res=cmdscale(d=InputDistances, k = 2, eig = TRUE, add = FALSE, x.ret = FALSE)
ProjectedPoints=as.matrix(res$points)
#see also ProjectionBasedClustering package for other common projection methods

resUmatrix=GeneralizedUmatrix(Data,ProjectedPoints)
## visualization
plotTopographicMap(GeneralizedUmatrix = resUmatrix$Umatrix,resUmatrix$Bestmatches)


## Open window in specific resolution
#relevant if Names given

library(rgl)
r3dDefaults$windowRect = c(0,0,1200,1200) 
plotTopographicMap(GeneralizedUmatrix = resUmatrix$Umatrix,resUmatrix$Bestmatches)

## Not run: 
## To save as STL for 3D printing
 rgl::writeSTL("GenerelizedUmatrix_3d_model.stl")

## Save the visualization as a picture with
library(rgl)
rgl.snapshot('test.png')

## End(Not run)

## Save interactive html file
## Not run: 
widgets=plotTopographicMap(GeneralizedUmatrix = resUmatrix$Umatrix,resUmatrix$Bestmatches)
if(requireNamespace("htmlwidgets"))
  htmlwidgets::saveWidget(widgets,file = "interactiveTopographicMap.html")

## End(Not run)

</code></pre>


</div>