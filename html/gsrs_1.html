<div class="container">

<table style="width: 100%;"><tr>
<td>gssvd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Train the group-specific model and test model performance</h2>

<h3>Description</h3>

<p>This gssvd() function uses ratings dataset to train a group-specific recommender system, tests the performance, and output the key matrix for prediction.
To make the training process run in parallel, doParallel package is recommended to use.
For more details regarding how the simulated dataset created, please refer to http://dx.doi.org/10.1080/01621459.2016.1219261.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gssvd(
  train,
  test,
  B = 10,
  C = 10,
  K,
  tol_1 = 0.001,
  tol_2 = 1e-05,
  lambda = 2,
  max_iter = 100,
  verbose = 0,
  user_group = NULL,
  item_group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>train</code></td>
<td>
<p>Train set, a matrix with three columns (userID, movieID, ratings)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Test set, a matrix with three columns (userID, movieID, ratings)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of user groups, 10 by default, don't need to specify if user_group prarmeter is not NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Number of item groups, 10 by default, don't need to specify if item_group prarmeter is not NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of latent factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_1</code></td>
<td>
<p>The stopping criterion for outer loop in the proposed algorithm, 1e-3 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_2</code></td>
<td>
<p>The stopping criterion for sub-loops, 1e-5 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Value of penalty term in ridge regression for ALS, 2 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of iterations in the training process, 100 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean, if print out the detailed intermediate computations in the training process, 0 by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_group</code></td>
<td>
<p>Optional parameter, should be a n-dim vector, n is total number of users, each element in the vector represents the group ID for that user (We will use missing pattern if not specified)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item_group</code></td>
<td>
<p>Optional parameter, should be a m-dim vector, m is total number of items, each element in the vector represents the group ID for that item (We will use missing pattern if not specified)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return the list of result, including matrix <code>P</code>, <code>Q</code>, <code>S</code>, <code>T</code> and RMSE of test set (<code>RMSE_Test</code>)
</p>


<h3>Author(s)</h3>

<p>Yifei Zhang, Xuan Bi
</p>


<h3>References</h3>

<p>Xuan Bi, Annie Qu, Junhui Wang &amp; Xiaotong Shen
A Group-Specific Recommender System, Journal of the American Statistical Association, 112:519, 1344-1353
DOI: 10.1080/01621459.2016.1219261. Please contact the author should you encounter any problems
A fast version written in Matlab is available at https://sites.google.com/site/xuanbigts/software.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Training model on the simulated data file
library(doParallel)
registerDoParallel(cores=2)
# CRAN limits the number of cores available to packages to 2,
# you can use cores = detectCores()-1 in the real work setting.
getDoParWorkers()
example_data_path = system.file("extdata", "sim_data.txt", package="gsrs")
ratings = read.table(example_data_path, sep =":", header = FALSE)[1:100,]
# Initialization Parameters
K=3
B=10
C=10
lambda = 2
max_iter = 1 # usually more than 10;
tol_1=1e-1
tol_2=1e-1
# Train Test Split
N=dim(ratings)[1]
test_rate = 0.3
train.row=which(rank(ratings[, 1]) &lt;= floor((1 - test_rate) * N))
test.row=which(rank(ratings[, 1]) &gt; floor((1 - test_rate) * N))
train.data=ratings[train.row,1:3]
test.data=ratings[test.row,1:3]
# Call gssvd function
a = gssvd(train=train.data, test=test.data, B=B, C=C, K=K,
lambda=lambda, max_iter=max_iter, verbose=1)
stopImplicitCluster()
# Output the result
a$RMSE_Test
head(a$P)
head(a$Q)
head(a$S)
head(a$T)
</code></pre>


</div>