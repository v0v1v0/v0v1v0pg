<div class="container">

<table style="width: 100%;"><tr>
<td>predict_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot estimated functions both at estimated and predicted time points with 95% credible intervals.</h2>

<h3>Description</h3>

<p>Uses as input the output object from the gpdpgrow.predict() and 
gmrfdpgrow.predict() methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_plot(
  object = NULL,
  units_label = NULL,
  type_label = c("fitted", "predicted"),
  time_points = NULL,
  date_label = NULL,
  x.axis.label = NULL,
  y.axis.label = NULL,
  single_unit = FALSE,
  credible = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>gpdpgrow.predict</code> or <code>gmrfdpgrow.predict</code> object, obtained from 
<code>predict_functions(object,...)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units_label</code></td>
<td>
<p>A vector of labels to apply to experimental units with length equal to the number of
unique units.  Defaults to sequential numeric values as input with data, <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_label</code></td>
<td>
<p>A character vector assigning a "fitted" or "predicted
label for the <code>time_points</code> input. Defaults to <code>type_label = c("fitted","predicted")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_points</code></td>
<td>
<p>A list input of length 2 with each entry containing a numeric vector
of times -  one for the observed times for the set of "fitted" functions and the other denotes 
time values at which "predicted" values were rendered for the functions.  This input variable
only applies to <code>gpdpgrow</code> objects and not <code>gmrfdpgrow</code> objects because the latter 
covariance structure is based on adjacency for equally-spaced time points.
Defaults to <code>1:T_train</code> for the list entry pointed to "fitted" and 
<code>(T_train+1):(T_train + T_test)</code> for the list entry pointed to "predicted".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date_label</code></td>
<td>
<p>A vector of <code>Date</code> values for labeling the x-axis tick marks.
Defaults to <code>1:T</code>  .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.axis.label</code></td>
<td>
<p>Text label for x-axis. Defaults to <code>"time"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.axis.label</code></td>
<td>
<p>Text label for y-axis. Defaults to <code>"function values"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>single_unit</code></td>
<td>
<p>A scalar boolean indicating whether to plot the fitted vs data curve for
only a single experimental units (versus a random sample of 6). 
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>credible</code></td>
<td>
<p>A scalar boolean indicating whether to plot 95 percent credible intervals for
estimated functions, <code>bb</code>, when plotting fitted functions versus data.  Defaults to
<code>credible = TRUE</code>  .</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list object containing the plot of estimated functions, faceted by cluster,
and the associated <code>data.frame</code> object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.cluster</code></td>
<td>
<p>A <code>ggplot2</code> plot object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat.cluster</code></td>
<td>
<p>A <code>data.frame</code> object used to generate <code>p.cluster</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Terrance Savitsky <a href="mailto:tds151@gmail.com">tds151@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>gpdpgrow</code>, <code>gmrfdpgrow</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(growfunctions)
data(cps)
y_short             &lt;- cps$y[,(cps$yr_label %in% c(2008:2013))]
t_train             &lt;- ncol(y_short)
N                   &lt;- nrow(y_short)
t_test              &lt;- 4
 
## Model Runs

res_gmrf            &lt;- gmrfdpgrow(y = y_short, 
                                q_order = c(2,4), 
                                q_type = c("tr","sn"), 
                                n.iter = 40, 
                                n.burn = 20, 
                                n.thin = 1) 

res_gp              &lt;- gpdpgrow(y = y_short
                              n.iter = 10, 
                              n.burn = 4, 
                              n.thin = 1, 
                              n.tune = 0) 

## Prediction Model Runs
T_test             &lt;- 4

pred_gmrf          &lt;- predict_functions( object = res_gmrf,
                                     J = 1000, 
                                     T_test = T_test )

T_yshort           &lt;- ncol(y_short)
pred_gp            &lt;- predict_functions( object = res_gp, 
                     test_times = (T_yshort+1):(T_yshort+T_test) )

## plot estimated and predicted functions
plot_gmrf       &lt;- predict_plot(object = pred_gmrf, 
                               units_label = cps$st, 
                               single_unit = TRUE, 
                               credible = FALSE)

plot_gp         &lt;- predict_plot(object = pred_gp, 
                               units_label = cps$st, 
                               single_unit = FALSE, 
                               credible = TRUE)  

## End(Not run)
</code></pre>


</div>