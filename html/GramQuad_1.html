<div class="container">

<table style="width: 100%;"><tr>
<td>create_gram_weights</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Gram weights</h2>

<h3>Description</h3>

<p>Computes weights for Gram quadrature of<code>m+1</code> points.</p>


<h3>Usage</h3>

<pre><code class="language-R">create_gram_weights(m)</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a positive integer value, the number of points minus one for
which weights will be computed. See 'Details'.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The numerical integration of an analytical function <code class="reqn">f(x)</code> using a
finite set of equidistant points can be performed by quadrature formulas
like the Newton-Cotes. Unlike Gaussian quadrature formulas however,
higher-order Newton-Cotes formulas are not stable, limiting the usable
order of such formulas. Existing work showed that by the use of
orthogonal polynomials, stable high-order quadrature formulas with
equidistant points can be developed. This algorithm improves upon such
work by making use of (orthogonal) Gram polynomials and deriving an
iterative algorithm, together allowing us to reduce the space-complexity
of the original algorithm significantly.
</p>


<h3>Value</h3>

<p>A double-precision vector of the specified length plus one, whose
elements are the weights for the Gram quadratures of the <code>m+1</code>
points in the interval <code class="reqn">[-1,1]</code>.
</p>


<h3>Author(s)</h3>

<p>Iago Giné-Vázquez, <a href="mailto:iago.gin-vaz@protonmail.com">iago.gin-vaz@protonmail.com</a>
</p>


<h3>References</h3>

<p>Muhammad, Irfan (2021) <em>Gram quadrature: Numerical integration with Gram
polynomials</em>. <a href="https://arxiv.org/pdf/2106.14875.pdf">arXiv:2106.14875 [math.NA]</a>
</p>


<h3>See Also</h3>

<p><code>gaussLegendre</code></p>


<h3>Examples</h3>

<pre><code class="language-R">m &lt;- 100
xs &lt;- seq(-1, 1, length.out = m + 1)
gram_weights &lt;- create_gram_weights(m)

# the sum of  stable  weights is  equal  to 2.
cat("Sum of Gram weights:", sum(gram_weights), "\n")

# test integration, integrate f below between [-1,1]
f = function(x){ 9 * x ^ 2 + 45 * 13 * x ^ 3 + 16 * x ^ 4}
gram_quad &lt;- sum(gram_weights * f(xs))
cat("Approx. integration:", gram_quad, "\n")
</code></pre>


</div>