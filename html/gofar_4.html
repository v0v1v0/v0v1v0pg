<div class="container">

<table style="width: 100%;"><tr>
<td>gofar_sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate data for GOFAR</h2>

<h3>Description</h3>

<p>Genertate random samples from a generalize sparse factor regression model
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofar_sim(U, D, V, n, Xsigma, C0, familygroup, snr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>specified value of U</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>specified value of D</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>specified value of V</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xsigma</code></td>
<td>
<p>covariance matrix for generating sample of X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C0</code></td>
<td>
<p>Specified coefficient matrix with first row being intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>familygroup</code></td>
<td>
<p>index set of the type of multivariate outcomes: "1" for Gaussian, "2" for Bernoulli, "3" for Poisson outcomes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snr</code></td>
<td>
<p>signal to noise ratio specified for gaussian type outcomes</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Generated response matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Generated predictor matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaG</code></td>
<td>
<p>standard deviation for gaussian error</p>
</td>
</tr>
</table>
<h3>References</h3>

<p><em> Mishra, Aditya, Dipak K. Dey, Yong Chen, and Kun Chen. Generalized co-sparse factor regression. Computational Statistics &amp; Data Analysis 157 (2021): 107127</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Model specification:
SD &lt;- 123
set.seed(SD)
n &lt;- 200
p &lt;- 100
pz &lt;- 0
# Model I in the paper
# n &lt;- 200; p &lt;- 300; pz &lt;- 0 ;           # Model II in the paper
# q1 &lt;- 0; q2 &lt;- 30; q3 &lt;- 0               # Similar response cases
q1 &lt;- 15
q2 &lt;- 15
q3 &lt;- 0 # mixed response cases
nrank &lt;- 3 # true rank
rank.est &lt;- 4 # estimated rank
nlam &lt;- 40 # number of tuning parameter
s &lt;- 1 # multiplying factor to singular value
snr &lt;- 0.25 # SNR for variance Gaussian error
#
q &lt;- q1 + q2 + q3
respFamily &lt;- c("gaussian", "binomial", "poisson")
family &lt;- list(gaussian(), binomial(), poisson())
familygroup &lt;- c(rep(1, q1), rep(2, q2), rep(3, q3))
cfamily &lt;- unique(familygroup)
nfamily &lt;- length(cfamily)
#
control &lt;- gofar_control()
#
#
## Generate data
D &lt;- rep(0, nrank)
V &lt;- matrix(0, ncol = nrank, nrow = q)
U &lt;- matrix(0, ncol = nrank, nrow = p)
#
U[, 1] &lt;- c(sample(c(1, -1), 8, replace = TRUE), rep(0, p - 8))
U[, 2] &lt;- c(rep(0, 5), sample(c(1, -1), 9, replace = TRUE), rep(0, p - 14))
U[, 3] &lt;- c(rep(0, 11), sample(c(1, -1), 9, replace = TRUE), rep(0, p - 20))
#
if (nfamily == 1) {
  # for similar type response type setting
  V[, 1] &lt;- c(rep(0, 8), sample(c(1, -1), 8,
    replace =
      TRUE
  ) * runif(8, 0.3, 1), rep(0, q - 16))
  V[, 2] &lt;- c(rep(0, 20), sample(c(1, -1), 8,
    replace =
      TRUE
  ) * runif(8, 0.3, 1), rep(0, q - 28))
  V[, 3] &lt;- c(
    sample(c(1, -1), 5, replace = TRUE) * runif(5, 0.3, 1), rep(0, 23),
    sample(c(1, -1), 2, replace = TRUE) * runif(2, 0.3, 1), rep(0, q - 30)
  )
} else {
  # for mixed type response setting
  # V is generated such that joint learning can be emphasised
  V1 &lt;- matrix(0, ncol = nrank, nrow = q / 2)
  V1[, 1] &lt;- c(sample(c(1, -1), 5, replace = TRUE), rep(0, q / 2 - 5))
  V1[, 2] &lt;- c(
    rep(0, 3), V1[4, 1], -1 * V1[5, 1],
    sample(c(1, -1), 3, replace = TRUE), rep(0, q / 2 - 8)
  )
  V1[, 3] &lt;- c(
    V1[1, 1], -1 * V1[2, 1], rep(0, 4),
    V1[7, 2], -1 * V1[8, 2], sample(c(1, -1), 2, replace = TRUE),
    rep(0, q / 2 - 10)
  )
  #
  V2 &lt;- matrix(0, ncol = nrank, nrow = q / 2)
  V2[, 1] &lt;- c(sample(c(1, -1), 5, replace = TRUE), rep(0, q / 2 - 5))
  V2[, 2] &lt;- c(
    rep(0, 3), V2[4, 1], -1 * V2[5, 1],
    sample(c(1, -1), 3, replace = TRUE), rep(0, q / 2 - 8)
  )
  V2[, 3] &lt;- c(
    V2[1, 1], -1 * V2[2, 1], rep(0, 4),
    V2[7, 2], -1 * V2[8, 2],
    sample(c(1, -1), 2, replace = TRUE), rep(0, q / 2 - 10)
  )
  #
  V &lt;- rbind(V1, V2)
}
U[, 1:3] &lt;- apply(U[, 1:3], 2, function(x) x / sqrt(sum(x^2)))
V[, 1:3] &lt;- apply(V[, 1:3], 2, function(x) x / sqrt(sum(x^2)))
#
D &lt;- s * c(4, 6, 5) # signal strength varries as per the value of s
or &lt;- order(D, decreasing = TRUE)
U &lt;- U[, or]
V &lt;- V[, or]
D &lt;- D[or]
C &lt;- U %*% (D * t(V)) # simulated coefficient matrix
intercept &lt;- rep(0.5, q) # specifying intercept to the model:
C0 &lt;- rbind(intercept, C)
#
Xsigma &lt;- 0.5^abs(outer(1:p, 1:p, FUN = "-"))
# Simulated data
sim.sample &lt;- gofar_sim(U, D, V, n, Xsigma, C0, familygroup, snr)
# Dispersion parameter
pHI &lt;- c(rep(sim.sample$sigmaG, q1), rep(1, q2), rep(1, q3))
X &lt;- sim.sample$X[1:n, ]
Y &lt;- sim.sample$Y[1:n, ]
simulate_gofar &lt;- list(Y = Y,X = X, U = U, D = D, V = V, n=n,
Xsigma = Xsigma, C0 = C0, familygroup = familygroup)


</code></pre>


</div>