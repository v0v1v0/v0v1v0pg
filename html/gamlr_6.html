<div class="container">

<table style="width: 100%;"><tr>
<td>doubleML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>double ML</h2>

<h3>Description</h3>

<p>double (i.e., double) Machine Learning for treatment effect estimation </p>


<h3>Usage</h3>

<pre><code class="language-R">doubleML(x, d, y, nfold=2, foldid=NULL, family="gaussian", cl=NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> Covariates; see <code>gamlr</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p> The matrix of treatment variables.  Each column is used as a response by <code>gamlr</code> during the residualization procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> Response; see <code>gamlr</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>
<p> The number of cross validation folds. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p> An optional length-n vector of fold memberships for each observation.  If specified, this dictates <code>nfold</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p> Response model type for the treatment prediction; 
either "gaussian", "poisson", or "binomial".  This can be either be a single family shared by all columns of <code>d</code> or a vector of families of length <code>ncol(d)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>possible <code>parallel</code> library cluster.  If this is not-<code>NULL</code>, the CV folds are executed in parallel.  This copies the data <code>nfold</code> times, so make sure you have the memory space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Arguments to all the <code>gamlr</code> regressions. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> Performs the double ML procedure of Chernozhukov et al. (2017) to produce an unbiased estimate of the average linear treatment effects of <code>d</code> on <code>y</code>.  This procedure uses <code>gamlr</code> to regress <code>y</code> and each column of <code>d</code> onto <code>x</code>.  In the cross-fitting routine described in Taddy (2019), these regressions are trained on a portion of the data and the out-of-sample residuals are calculated on the left-out fold.  Model selection for these residualization steps is based on the AICc selection rule.  The response residuals are then regressed onto the treatment residuals using <code>lm</code> and the resulting estimates and standard errors are unbiased for the treatment effects under the assumptions of Chernozhukov et al.
</p>


<h3>Value</h3>

<p>A fitted <code>lm</code> object estimating the treatment effect of <code>d</code> on <code>y</code>.  The <code>lm</code> function has been called with <code>x=TRUE, y=TRUE</code> such that this object contains the residualized <code>d</code> as <code>x</code> and residualized <code>y</code> as <code>y</code>.
</p>


<h3>Author(s)</h3>

<p>Matt Taddy <a href="mailto:mataddy@gmail.com">mataddy@gmail.com</a>
</p>


<h3>References</h3>

<p>Chernozhukov, Victor and Chetverikov, Denis and Demirer, Mert and Duflo, Esther and Hansen, Christian and Newey, Whitney and Robins, James (The Econometrics Journal, 2017), Double/debiased machine learning for treatment and structural parameters
</p>
<p>Matt Taddy, 2019.  Business Data Science, McGraw-Hill</p>


<h3>See Also</h3>

<p>gamlr, hockey, AICc</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(hockey)
who &lt;- which(colnames(player)=="SIDNEY_CROSBY")
s &lt;- sample.int(nrow(player),10000) # subsample for a fast example
doubleML(x=player[s,-who], d=player[s,who], y=goal$homegoal[s], standardize=FALSE)

</code></pre>


</div>