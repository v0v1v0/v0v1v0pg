<div class="container">

<table style="width: 100%;"><tr>
<td>active_node_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produces an active node matrix heat-map.

</h2>

<h3>Description</h3>

<p>Produces an active node matrix heat-map, which compares the local impact each node has on all the other ones (i.e., regressing <code class="reqn">j</code> on <code class="reqn">i</code>) once a model order has been chosen. The local relevance indes is 
<code class="reqn">\mathrm{local} (i, j) := \bigg ( w_{ij} \sum_{k = 1}^{p} |\hat{\beta}_{kr}| \bigg ) \bigg \{ \sum_{l \in \mathcal{N} (i)} \sum_{r = 1}^{r^*} \sum_{k = 1}^{p}  w_{il} |\hat{\beta}_{kr}| \bigg) \bigg \}^{-1},</code>
which is closer to one the more relevant <code class="reqn">j</code> is when forecasting <code class="reqn">i</code>.

</p>


<h3>Usage</h3>

<pre><code class="language-R">  active_node_plot(vts, network, max_lag, r_stages)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vts</code></td>
<td>
<p>Vector time series under study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network</code></td>
<td>
<p>GNAR network object, which is the underlying network for the time series under study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_lag</code></td>
<td>
<p>Maximum lag of the fitted GNAR model - i.e., <code class="reqn">\mathrm{GNAR}(p, [s_1, \dots, s_p]).</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_stages</code></td>
<td>
<p>Neighbourhood regression oreder of the fitted GNAR model - i.e., <code class="reqn">(s_1, \dots, s_p)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Produces the local influence matrix heat-map for a specific model order. Does not return any values.
</p>


<h3>Author(s)</h3>

<p>Daniel Salnikov and Guy Nason

</p>


<h3>References</h3>

<p>Nason, G.P., Salnikov, D. and Cortina-Borja, M. (2023)
New tools for network time series with an application to COVID-19
hospitalisations. <a href="https://arxiv.org/abs/2312.00530">https://arxiv.org/abs/2312.00530</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Produces an active node heat-map matrix from a stationary GNAR(2, [2, 1]) simulation.
#
gnar_simulation &lt;- GNARsim(n = 100, net=fiveNet,
	alphaParams = list(rep(0.25, 5), rep(0.12, 5)), 
        betaParams = list(c(0.25, 0.13), c(0.20)), sigma=1)
#
# Active node plot
#
active_node_plot(gnar_simulation, fiveNet, 2, c(2, 1))
</code></pre>


</div>