<div class="container">

<table style="width: 100%;"><tr>
<td>GPCMlasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GPCMlasso</h2>

<h3>Description</h3>

<p>Performs GPCMlasso, a method to identify differential item functioning (DIF) in Generalized Partial Credit Models. 
A joint parametric model is set up based on an IRT model chosen by the user. Several variables can be considered simultaneously.
For each pair between variable and item, a parametric DIF effect is introduced which
indicates DIF if the respective parameter is selected (estimated to be unequal zero). 
Parameter selection is done using a lasso-type penalization term.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GPCMlasso(
  formula,
  data,
  DSF = FALSE,
  model = c("PCM", "RSM", "GPCM", "GRSM", "RM", "2PL"),
  control = ctrl_GPCMlasso(),
  cv = FALSE,
  main.effects = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula to indicate which items are considered and which covariates 
should be used to find DIF. Items are considered to be the response and are 
concatenated by <code>cbind()</code>. If the RHS of the formula is <code>~0</code>, simply the 
model specified in <code>model</code> is calulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing the ordinal item response data 
(as ordered factors) and all covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DSF</code></td>
<td>
<p>Should Differential Step Functioning (DSF) be considered? If <code>DSF = TRUE</code>, one parameter per step between two response categories is introduced. For binary items, DSF and DIF conincide.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Specify the underlying basic model. Currently, you can choose 
between the partial credit model and the rating scale model and
the respective generalized versions of both models called 'PCM', 'RSM', 
'GPCM' and 'GRSM'. Generalized models allow for different discrimination 
parameters between items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Control argument to specify further arguments for the algorithm
and numerical optimization, specified by <code>ctrl_GPCMlasso</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>Should cross-validation be performed? Cross-validation can be used as an alternative to BIC to select the optimal tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.effects</code></td>
<td>
<p>Should also main effects of the variables be included in the model? Default is <code>TRUE</code>. Here, positive parameter estimates correspond 
to an increase of the respective trait if the variable increases.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Matrix containing all parameters for the GPCMlasso model, one row
per tuning parameter lambda. Due to the penalty the parameters are scaled and, therefore,
are comparable with respect to their size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>Vector of log-likelihoods, one value per tuning parameter lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The function call of <code>GPCMlasso</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv_error</code></td>
<td>
<p>Vector of cv_errors, one per tuning parameter. Only relevant if <code>cv = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Basic IRT model chosen by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data from call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Control list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DSF</code></td>
<td>
<p>DSF from call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula from call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item.names</code></td>
<td>
<p>Item names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Matrix containing item responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_list</code></td>
<td>
<p>List containing several helpful objects for internal use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>Vector of AIC values, one per tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>Vector of BIC values, one per tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cAIC</code></td>
<td>
<p>Vector of corrected AIC values, one per tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Vector of degrees of freedom, one per tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.rescal</code></td>
<td>
<p>Matrix containing all rescaled parameters for the GPCMlasso model, one row
per tuning parameter lambda. In contrast to <code>coefficients</code>, all parameters are rescaled back
to their original scales.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gunther Schauberger<br><a href="mailto:gunther.schauberger@tum.de">gunther.schauberger@tum.de</a>
</p>


<h3>References</h3>

<p>Schauberger, Gunther and Mair, Patrick (2019): A Regularization Approach for the Detection of Differential 
Item Functioning in Generalized Partial Credit Models, <em>Behavior Research Methods</em>, <a href="https://link.springer.com/article/10.3758/s13428-019-01224-2">https://link.springer.com/article/10.3758/s13428-019-01224-2</a>
</p>


<h3>See Also</h3>

<p><code>GPCMlasso-package</code>, <code>ctrl_GPCMlasso</code>, <code>print.GPCMlasso</code>, 
<code>plot.GPCMlasso</code>, <code>predict.GPCMlasso</code>, <code>trait.posterior</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(tenseness_small)

## formula for simple model without covariates
form.0 &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~0"))

######
## fit simple RSM where loglikelihood and score function are evaluated parallel on 2 cores
rsm.0 &lt;- GPCMlasso(form.0, tenseness_small, model = "RSM", 
control= ctrl_GPCMlasso(cores=2))
rsm.0

## Not run: 
## formula for model with covariates (and DIF detection)
form &lt;- as.formula(paste("cbind(",paste(colnames(tenseness_small)[1:5],collapse=","),")~."))

######
## fit GPCM model with 10 different tuning parameters
gpcm &lt;- GPCMlasso(form, tenseness_small, model = "GPCM", 
                  control = ctrl_GPCMlasso(l.lambda = 10))
gpcm
plot(gpcm)
pred.gpcm &lt;- predict(gpcm)
trait.gpcm &lt;- trait.posterior(gpcm)

######
## fit RSM, detect differential step functioning (DSF)
rsm.DSF &lt;- GPCMlasso(form, tenseness_small, model = "RSM", DSF = TRUE, 
                     control = ctrl_GPCMlasso(l.lambda = 10))
rsm.DSF
plot(rsm.DSF)

## create binary data set
tenseness_small_binary &lt;- tenseness_small
tenseness_small_binary[,1:5][tenseness_small[,1:5]&gt;1] &lt;- 2

######
## fit and cross-validate Rasch model
set.seed(1860)
rm.cv &lt;- GPCMlasso(form, tenseness_small_binary, model = "RM", cv = TRUE, 
                   control = ctrl_GPCMlasso(l.lambda = 10))
rm.cv
plot(rm.cv)

## End(Not run)
</code></pre>


</div>