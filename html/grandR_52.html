<div class="container">

<table style="width: 100%;"><tr>
<td>dropoutpercent</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate 4sU dropout percentages</h2>

<h3>Description</h3>

<p>For several potential reasons, a sample specific percentage of reads from labelled RNA might be lost.
This percentage can be estimated from data of this sample and an equivalent 4sU naive control (see details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Estimate4sUDropoutPercentage(data, pairs = Findno4sUPairs(data), ...)

Estimate4sUDropoutPercentageForSample(
  data,
  w4sU,
  no4sU,
  ntr = w4sU,
  LFC.fun = lfc::PsiLFC,
  type = c("spearman", "quantreg", "linear", "lowess"),
  bootstrap = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a grandR object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pairs</code></td>
<td>
<p>a no4sU pairs list as generated by Findno4sUPairs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w4sU</code></td>
<td>
<p>the name of a 4sU sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no4sU</code></td>
<td>
<p>the name(s) of equivalent no4sU sample(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntr</code></td>
<td>
<p>the name of a sample to take NTRs from (usually equal to w4sU)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LFC.fun</code></td>
<td>
<p>function to compute log fold change (default: PsiLFC, other viable option: NormLFC)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>one of "spearman","quantreg","linear" or "lowess" (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>if TRUE, perform a single bootstrap sample  (by drawing genes with replacement)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The percentage of 4sU dropout is estimated by numerical optimization of the factor f
that has to be multiplied with the NTR to mitigate the effect of 4sU dropout. The exact objective function depends on the type parameter:
</p>

<ul>
<li>
<p>spearman: f is estimated such that the spearman correlation coefficient of the log2 fold change 4sU/no4sU vs the ntr rank is 0
</p>
</li>
<li>
<p>quantreg: f is estimated such that the slope of a median regression with the the ntr rank as independent variable and the log2 fold change 4sU/no4sU as dependent variable is 0
</p>
</li>
<li>
<p>linear: f is estimated such that the slope of a linear regression with the the ntr rank as independent variable and the log2 fold change 4sU/no4sU as dependent variable is 0
</p>
</li>
<li>
<p>lowess: f is estimated by minimizing the sum-of-squares of the residuals from a lowess regression with the the ntr rank as independent variable and the log2 fold change 4sU/no4sU as dependent variable is 0
</p>
</li>
</ul>
<p>Once f is computed the percentage of 4sU dropout is f/(f+1).
</p>


<h3>Value</h3>

<p>the percentage of 4sU dropout for a single sample (Estimate4sUDropoutPercentageForSample) or all samples (Estimate4sUDropoutPercentage)
</p>


<h3>See Also</h3>

<p>Correct4sUDropoutHLFactor,ComputeSummaryStatistics
</p>


</div>