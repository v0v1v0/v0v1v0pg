<div class="container">

<table style="width: 100%;"><tr>
<td>peak_interspace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the observed space between peaks within chromatograms</h2>

<h3>Description</h3>

<p>The parameter <code>min_diff_peak2peak</code> is a major determinant in the alignment of a dataset with <code>align_chromatograms</code>. This function helps to infer a suitable value based on the input data. The underlying assumption here is that distinct peaks within a separated by a larger gap than homologous peaks across samples. Tightly spaced peaks within a sample will appear on the left side of the plotted distribution and can indicate the presence of split peaks in the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">peak_interspace(
  data,
  rt_col_name = NULL,
  sep = "\t",
  quantiles = NULL,
  quantile_range = c(0, 1),
  by_sample = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataset containing peaks that need to be aligned and matched. For every peak a arbitrary number of numerical variables can be included (e.g. peak height, peak area) in addition to the mandatory retention time. The standard format is a tab-delimited text file according to the following layout: (1) The first row contains sample names, the (2) second row column names of the corresponding peak lists. Starting with the third row, peak lists are included for every sample that needs to be incorporated in the dataset. Here, a peak list contains data for individual peaks in rows, whereas columns specify variables in the order given in the second row of the text file. Peak lists of individual samples are concatenated horizontally and need to be of the same width (i.e. the same number of columns in consistent order). Alternatively, the input may be a list of data frames. Each data frame contains the peak data for a single individual. Variables (i.e.columns) are named consistently across data frames. The names of elements in the list are used as sample identifiers. Cells may be filled with numeric or integer values but no factors or characters are allowed. NA and 0 may be used to indicate empty rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rt_col_name</code></td>
<td>
<p>A character giving the name of the column containing the retention times. The decimal separator needs to be a point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>The field separator character. The default is tab separated (<code>sep = '\t'</code>).
See the "sep" argument in <code>read.table</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>
<p>A numeric vector. Specified quantiles are calculated from the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile_range</code></td>
<td>
<p>A numeric vector of length two that allows to subset an arbitrary interquartile range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_sample</code></td>
<td>
<p>A logical that allows to calculate peak interspaces individually for each sample. By default all samples are combined to give the global distribution of next-peak differences in retention times. When <code>by_sample = TRUE</code>, a series of plots (one for each sample) is created and a keystroke is required to proceed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing summary statistics of the peak interspace distribution
</p>


<h3>Author(s)</h3>

<p>Martin Stoffel (martin.adam.stoffel@gmail.com) &amp; Meinolf Ottensmann (meinolf.ottensmann@web.de)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## plotting with defaults
peak_interspace(data = peak_data, rt_col_name = "time")
## plotting up to the 0.95 quantile
peak_interspace(data = peak_data,rt_col_name = "time",quantile_range = c(0,0.95))
## return the 0.1 quantile
peak_interspace(data = peak_data,rt_col_name = "time", quantiles = 0.1)

</code></pre>


</div>