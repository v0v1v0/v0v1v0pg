<div class="container">

<table style="width: 100%;"><tr>
<td>GauPro_kernel_model_LOO</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Corr Gauss GP using inherited optim</h2>

<h3>Description</h3>

<p>Corr Gauss GP using inherited optim
</p>
<p>Corr Gauss GP using inherited optim
</p>


<h3>Format</h3>

<p><code>R6Class</code> object.
</p>


<h3>Value</h3>

<p>Object of <code>R6Class</code> with methods for fitting GP model.
</p>


<h3>Super class</h3>

<p><code>GauPro::GauPro</code> -&gt; <code>GauPro_kernel_model_LOO</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>tmod</code></dt>
<dd>
<p>A second GP model for the t-values of leave-one-out predictions</p>
</dd>
<dt><code>use_LOO</code></dt>
<dd>
<p>Should the leave-one-out error corrections be used?</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-GauPro_kernel_model_LOO-new"><code>GauPro_kernel_model_LOO$new()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_model_LOO-update"><code>GauPro_kernel_model_LOO$update()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_model_LOO-pred_one_matrix"><code>GauPro_kernel_model_LOO$pred_one_matrix()</code></a>
</p>
</li>
<li> <p><a href="#method-GauPro_kernel_model_LOO-clone"><code>GauPro_kernel_model_LOO$clone()</code></a>
</p>
</li>
</ul>
<details><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="AIC"><a href="../../GauPro/html/GauPro.html#method-GauPro-AIC"><code>GauPro::GauPro$AIC()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="AugmentedEI"><a href="../../GauPro/html/GauPro.html#method-GauPro-AugmentedEI"><code>GauPro::GauPro$AugmentedEI()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="CorrectedEI"><a href="../../GauPro/html/GauPro.html#method-GauPro-CorrectedEI"><code>GauPro::GauPro$CorrectedEI()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="EI"><a href="../../GauPro/html/GauPro.html#method-GauPro-EI"><code>GauPro::GauPro$EI()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="KG"><a href="../../GauPro/html/GauPro.html#method-GauPro-KG"><code>GauPro::GauPro$KG()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="cool1Dplot"><a href="../../GauPro/html/GauPro.html#method-GauPro-cool1Dplot"><code>GauPro::GauPro$cool1Dplot()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="deviance"><a href="../../GauPro/html/GauPro.html#method-GauPro-deviance"><code>GauPro::GauPro$deviance()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="deviance_fngr"><a href="../../GauPro/html/GauPro.html#method-GauPro-deviance_fngr"><code>GauPro::GauPro$deviance_fngr()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="deviance_grad"><a href="../../GauPro/html/GauPro.html#method-GauPro-deviance_grad"><code>GauPro::GauPro$deviance_grad()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="fit"><a href="../../GauPro/html/GauPro.html#method-GauPro-fit"><code>GauPro::GauPro$fit()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="get_optim_functions"><a href="../../GauPro/html/GauPro.html#method-GauPro-get_optim_functions"><code>GauPro::GauPro$get_optim_functions()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="grad"><a href="../../GauPro/html/GauPro.html#method-GauPro-grad"><code>GauPro::GauPro$grad()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="grad_dist"><a href="../../GauPro/html/GauPro.html#method-GauPro-grad_dist"><code>GauPro::GauPro$grad_dist()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="grad_norm"><a href="../../GauPro/html/GauPro.html#method-GauPro-grad_norm"><code>GauPro::GauPro$grad_norm()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="grad_norm2_dist"><a href="../../GauPro/html/GauPro.html#method-GauPro-grad_norm2_dist"><code>GauPro::GauPro$grad_norm2_dist()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="grad_norm2_mean"><a href="../../GauPro/html/GauPro.html#method-GauPro-grad_norm2_mean"><code>GauPro::GauPro$grad_norm2_mean()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="grad_norm2_sample"><a href="../../GauPro/html/GauPro.html#method-GauPro-grad_norm2_sample"><code>GauPro::GauPro$grad_norm2_sample()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="grad_sample"><a href="../../GauPro/html/GauPro.html#method-GauPro-grad_sample"><code>GauPro::GauPro$grad_sample()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="gradpredvar"><a href="../../GauPro/html/GauPro.html#method-GauPro-gradpredvar"><code>GauPro::GauPro$gradpredvar()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="hessian"><a href="../../GauPro/html/GauPro.html#method-GauPro-hessian"><code>GauPro::GauPro$hessian()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="importance"><a href="../../GauPro/html/GauPro.html#method-GauPro-importance"><code>GauPro::GauPro$importance()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="loglikelihood"><a href="../../GauPro/html/GauPro.html#method-GauPro-loglikelihood"><code>GauPro::GauPro$loglikelihood()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="maxEI"><a href="../../GauPro/html/GauPro.html#method-GauPro-maxEI"><code>GauPro::GauPro$maxEI()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="maxqEI"><a href="../../GauPro/html/GauPro.html#method-GauPro-maxqEI"><code>GauPro::GauPro$maxqEI()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="optim"><a href="../../GauPro/html/GauPro.html#method-GauPro-optim"><code>GauPro::GauPro$optim()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="optimRestart"><a href="../../GauPro/html/GauPro.html#method-GauPro-optimRestart"><code>GauPro::GauPro$optimRestart()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="optimize_fn"><a href="../../GauPro/html/GauPro.html#method-GauPro-optimize_fn"><code>GauPro::GauPro$optimize_fn()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="param_optim_lower"><a href="../../GauPro/html/GauPro.html#method-GauPro-param_optim_lower"><code>GauPro::GauPro$param_optim_lower()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="param_optim_start"><a href="../../GauPro/html/GauPro.html#method-GauPro-param_optim_start"><code>GauPro::GauPro$param_optim_start()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="param_optim_start0"><a href="../../GauPro/html/GauPro.html#method-GauPro-param_optim_start0"><code>GauPro::GauPro$param_optim_start0()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="param_optim_start_mat"><a href="../../GauPro/html/GauPro.html#method-GauPro-param_optim_start_mat"><code>GauPro::GauPro$param_optim_start_mat()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="param_optim_upper"><a href="../../GauPro/html/GauPro.html#method-GauPro-param_optim_upper"><code>GauPro::GauPro$param_optim_upper()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="plot"><a href="../../GauPro/html/GauPro.html#method-GauPro-plot"><code>GauPro::GauPro$plot()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="plot1D"><a href="../../GauPro/html/GauPro.html#method-GauPro-plot1D"><code>GauPro::GauPro$plot1D()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="plot2D"><a href="../../GauPro/html/GauPro.html#method-GauPro-plot2D"><code>GauPro::GauPro$plot2D()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="plotLOO"><a href="../../GauPro/html/GauPro.html#method-GauPro-plotLOO"><code>GauPro::GauPro$plotLOO()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="plot_track_optim"><a href="../../GauPro/html/GauPro.html#method-GauPro-plot_track_optim"><code>GauPro::GauPro$plot_track_optim()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="plotkernel"><a href="../../GauPro/html/GauPro.html#method-GauPro-plotkernel"><code>GauPro::GauPro$plotkernel()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="plotmarginal"><a href="../../GauPro/html/GauPro.html#method-GauPro-plotmarginal"><code>GauPro::GauPro$plotmarginal()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="plotmarginalrandom"><a href="../../GauPro/html/GauPro.html#method-GauPro-plotmarginalrandom"><code>GauPro::GauPro$plotmarginalrandom()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred"><code>GauPro::GauPro$pred()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred_LOO"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred_LOO"><code>GauPro::GauPro$pred_LOO()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred_mean"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred_mean"><code>GauPro::GauPro$pred_mean()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred_meanC"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred_meanC"><code>GauPro::GauPro$pred_meanC()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred_var"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred_var"><code>GauPro::GauPro$pred_var()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred_var_after_adding_points"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred_var_after_adding_points"><code>GauPro::GauPro$pred_var_after_adding_points()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred_var_after_adding_points_sep"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred_var_after_adding_points_sep"><code>GauPro::GauPro$pred_var_after_adding_points_sep()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred_var_reduction"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred_var_reduction"><code>GauPro::GauPro$pred_var_reduction()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="pred_var_reductions"><a href="../../GauPro/html/GauPro.html#method-GauPro-pred_var_reductions"><code>GauPro::GauPro$pred_var_reductions()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="predict"><a href="../../GauPro/html/GauPro.html#method-GauPro-predict"><code>GauPro::GauPro$predict()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="print"><a href="../../GauPro/html/GauPro.html#method-GauPro-print"><code>GauPro::GauPro$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="sample"><a href="../../GauPro/html/GauPro.html#method-GauPro-sample"><code>GauPro::GauPro$sample()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="summary"><a href="../../GauPro/html/GauPro.html#method-GauPro-summary"><code>GauPro::GauPro$summary()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="update_K_and_estimates"><a href="../../GauPro/html/GauPro.html#method-GauPro-update_K_and_estimates"><code>GauPro::GauPro$update_K_and_estimates()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="update_corrparams"><a href="../../GauPro/html/GauPro.html#method-GauPro-update_corrparams"><code>GauPro::GauPro$update_corrparams()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="update_data"><a href="../../GauPro/html/GauPro.html#method-GauPro-update_data"><code>GauPro::GauPro$update_data()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="update_fast"><a href="../../GauPro/html/GauPro.html#method-GauPro-update_fast"><code>GauPro::GauPro$update_fast()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="update_nugget"><a href="../../GauPro/html/GauPro.html#method-GauPro-update_nugget"><code>GauPro::GauPro$update_nugget()</code></a></span></li>
<li><span class="pkg-link" data-pkg="GauPro" data-topic="GauPro" data-id="update_params"><a href="../../GauPro/html/GauPro.html#method-GauPro-update_params"><code>GauPro::GauPro$update_params()</code></a></span></li>
</ul></details><hr>
<a id="method-GauPro_kernel_model_LOO-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a kernel model that uses a leave-one-out GP model
to fix the standard error predictions.
</p>


<h5>Usage</h5>

<div class="r"><pre>GauPro_kernel_model_LOO$new(..., LOO_kernel, LOO_options = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>Passed to super$initialize.</p>
</dd>
<dt><code>LOO_kernel</code></dt>
<dd>
<p>The kernel that should be used for the
leave-one-out model. Shouldn't be too smooth.</p>
</dd>
<dt><code>LOO_options</code></dt>
<dd>
<p>Options passed to the leave-one-out model.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_model_LOO-update"></a>



<h4>Method <code>update()</code>
</h4>

<p>Update the model. Should only give in
(Xnew and Znew) or (Xall and Zall).
</p>


<h5>Usage</h5>

<div class="r"><pre>GauPro_kernel_model_LOO$update(
  Xnew = NULL,
  Znew = NULL,
  Xall = NULL,
  Zall = NULL,
  restarts = 5,
  param_update = self$param.est,
  nug.update = self$nug.est,
  no_update = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Xnew</code></dt>
<dd>
<p>New X values to add.</p>
</dd>
<dt><code>Znew</code></dt>
<dd>
<p>New Z values to add.</p>
</dd>
<dt><code>Xall</code></dt>
<dd>
<p>All X values to be used. Will replace existing X.</p>
</dd>
<dt><code>Zall</code></dt>
<dd>
<p>All Z values to be used. Will replace existing Z.</p>
</dd>
<dt><code>restarts</code></dt>
<dd>
<p>Number of optimization restarts.</p>
</dd>
<dt><code>param_update</code></dt>
<dd>
<p>Are the parameters being updated?</p>
</dd>
<dt><code>nug.update</code></dt>
<dd>
<p>Is the nugget being updated?</p>
</dd>
<dt><code>no_update</code></dt>
<dd>
<p>Are no parameters being updated?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_model_LOO-pred_one_matrix"></a>



<h4>Method <code>pred_one_matrix()</code>
</h4>

<p>Predict for a matrix of points
</p>


<h5>Usage</h5>

<div class="r"><pre>GauPro_kernel_model_LOO$pred_one_matrix(
  XX,
  se.fit = F,
  covmat = F,
  return_df = FALSE,
  mean_dist = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>XX</code></dt>
<dd>
<p>points to predict at</p>
</dd>
<dt><code>se.fit</code></dt>
<dd>
<p>Should standard error be returned?</p>
</dd>
<dt><code>covmat</code></dt>
<dd>
<p>Should covariance matrix be returned?</p>
</dd>
<dt><code>return_df</code></dt>
<dd>
<p>When returning se.fit, should it be returned in
a data frame?</p>
</dd>
<dt><code>mean_dist</code></dt>
<dd>
<p>Should mean distribution be returned?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-GauPro_kernel_model_LOO-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>GauPro_kernel_model_LOO$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 12
x &lt;- matrix(seq(0,1,length.out = n), ncol=1)
y &lt;- sin(2*pi*x) + rnorm(n,0,1e-1)
gp &lt;- GauPro_kernel_model_LOO$new(X=x, Z=y, kernel=Gaussian)
y &lt;- x^2 * sin(2*pi*x) + rnorm(n,0,1e-3)
gp &lt;- GauPro_kernel_model_LOO$new(X=x, Z=y, kernel=Matern52)
y &lt;- exp(-1.4*x)*cos(7*pi*x/2)
gp &lt;- GauPro_kernel_model_LOO$new(X=x, Z=y, kernel=Matern52)
</code></pre>


</div>