<div class="container">

<table style="width: 100%;"><tr>
<td>cv.gamsel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation Routine for Gamsel</h2>

<h3>Description</h3>

<p>A routine for performing K-fold cross-validation for gamsel.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.gamsel(
  x,
  y,
  lambda = NULL,
  family = c("gaussian", "binomial"),
  degrees = rep(10, p),
  dfs = rep(5, p),
  bases = pseudo.bases(x, degrees, dfs, parallel = parallel, ...),
  type.measure = c("mse", "mae", "deviance", "class"),
  nfolds = 10,
  foldid,
  keep = FALSE,
  parallel = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>x</code> matrix as in <code>gamsel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response <code>y</code> as in <code>gamsel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Optional use-supplied lambda sequence.  If <code>NULL</code>,
default behaviour is for <code>gamsel</code> routine to automatically select a
good lambda sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p><code>family</code> as in <code>gamsel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degrees</code></td>
<td>
<p><code>degrees</code> as in <code>gamsel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfs</code></td>
<td>
<p><code>dfs</code> as in <code>gamsel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bases</code></td>
<td>
<p><code>bases</code> as in <code>gamsel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.measure</code></td>
<td>
<p>Loss function for cross-validated error calculation.
Currently there are four options: <code>mse</code> (mean squared error),
<code>mae</code> (mean absolute error), <code>deviance</code> (deviance, same as
<code>mse</code> for <code>family="gaussian"</code>), <code>class</code> (misclassification
error, for use with <code>family="binomial"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Numer of folds (default is 10).  Maximum value is <code>nobs</code>.
Small values of <code>nfolds</code> are recommended for large data sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>Optional vector of length <code>nobs</code> with values between 1
and <code>nfolds</code> specifying what fold each observation is in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>If <code>keep=TRUE</code>, a <em>prevalidated</em> array is returned
containing fitted values for each observation and each value of
<code>lambda</code>. This means these fits are computed with this observation and
the rest of its fold omitted. The <code>folid</code> vector is also returned.
Default is keep=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>If <code>TRUE</code>, use parallel <code>foreach</code> to fit each
fold. See the example below for usage details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>gamsel</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function has the effect of running <code>gamsel</code> <code>nfolds</code>+1 times.
The initial run uses all the data and gets the <code>lambda</code> sequence.  The
remaining runs fit the data with each of the folds omitted in turn.  The
error is accumulated, and the average error and standard deviation over the
folds is computed.  Note that <code>cv.gamsel</code> does NOT search for values
for <code>gamma</code>. A specific value should be supplied, else <code>gamma=.4</code>
is assumed by default. If users would like to cross-validate <code>gamma</code> as
well, they should call <code>cv.gamsel</code> with a pre-computed vector
<code>foldid</code>, and then use this same fold vector in separate calls to
<code>cv.gamsel</code> with different values of <code>gamma</code>. Note also that the
results of <code>cv.gamsel</code> are random, since the folds are selected at
random. Users can reduce this randomness by running <code>cv.gamsel</code> many
times, and averaging the error curves.
</p>


<h3>Value</h3>

<p>an object of class <code>"cv.gamsel"</code> is returned, which is a list
with the ingredients of the cross-validation fit.  </p>
<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the values
of <code>lambda</code> used in the fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvm</code></td>
<td>
<p>The mean cross-validated
error - a vector of length <code>length(lambda)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvsd</code></td>
<td>
<p>estimate of
standard error of <code>cvm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvup</code></td>
<td>
<p>upper curve = <code>cvm+cvsd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvlo</code></td>
<td>
<p>lower curve = <code>cvm-cvsd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nzero</code></td>
<td>
<p>number of non-zero
coefficients at each <code>lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>a text string indicating
type of measure (for plotting purposes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamsel.fit</code></td>
<td>
<p>a fitted gamsel
object for the full data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.min</code></td>
<td>
<p>value of <code>lambda</code> that
gives minimum <code>cvm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.1se</code></td>
<td>
<p>largest value of <code>lambda</code>
such that error is within 1 standard error of the minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.preval</code></td>
<td>
<p>if <code>keep=TRUE</code>, this is the array of prevalidated
fits. Some entries can be <code>NA</code>, if that and subsequent values of
<code>lambda</code> are not reached for that fold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>if
<code>keep=TRUE</code>, the fold assignments used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index.min</code></td>
<td>
<p>the sequence
number of the minimum lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index.1se</code></td>
<td>
<p>the sequence number of the
1se lambda value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alexandra Chouldechova and Trevor Hastie<br> Maintainer: Trevor
Hastie <a href="mailto:hastie@stanford.edu">hastie@stanford.edu</a>
</p>


<h3>References</h3>

<p>Chouldechova, A. and Hastie, T. (2015) <em>Generalized
Additive Model Selection</em>
</p>


<h3>See Also</h3>

<p><code>gamsel</code>, <code>plot</code> function for <code>cv.gamsel</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##data=gamsel:::gendata(n=500,p=12,k.lin=3,k.nonlin=3,deg=8,sigma=0.5)
data = readRDS(system.file("extdata/gamsel_example.RDS", package = "gamsel"))
attach(data)
bases=pseudo.bases(X,degree=10,df=6)
# Gaussian gam
gamsel.out=gamsel(X,y,bases=bases)
par(mfrow=c(1,2),mar=c(5,4,3,1))
summary(gamsel.out)
gamsel.cv=cv.gamsel(X,y,bases=bases)
par(mfrow=c(1,1))
plot(gamsel.cv)
par(mfrow=c(3,4))
plot(gamsel.out,newx=X,index=20)

</code></pre>


</div>