<div class="container">

<table style="width: 100%;"><tr>
<td>MCMCplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC plot</h2>

<h3>Description</h3>

<p>Trace plot, density plot and ACF plot for the output of CS/DS/HS. The plot is able to draw at most ten SNPs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MCMCplot(
  Result = Result,
  k = k,
  nchains = nchains,
  whichsnps = whichsnps,
  betatype = "l",
  acftype = "correlation",
  dencol = "white",
  denlty = 1,
  denbg = "white"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Result</code></td>
<td>
<p>All the generated results by CS/DS/HS function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of study for drawing plots, k=1,2,...,K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nchains</code></td>
<td>
<p>Number of Markov chains run in Result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichsnps</code></td>
<td>
<p>The name of SNPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betatype</code></td>
<td>
<p>The type of plot desired. The following values are possible: "p" for points, "l" for lines, "b" for both points and lines, "c" for empty points joined by lines, "o" for overplotted points and lines, "s" and "S" for stair steps and "h" for histogram-like vertical lines. Finally, "n" does not produce any points or lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acftype</code></td>
<td>
<p>String giving the type of ACF to be computed. Allowed values are "correlation" (the default), "covariance" or "partial". Will be partially matched.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dencol</code></td>
<td>
<p>The color for filling the density plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denlty</code></td>
<td>
<p>The line type to be used in the density plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denbg</code></td>
<td>
<p>The color to be used for the background of the density plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Trace plot, density plot and ACF plot for the output of CS/DS/HS for checking convergence of MCMC chains.
</p>


<h3>Author(s)</h3>

<p>Taban Baghfalaki.
</p>


<h3>References</h3>

<p>Baghfalaki, T., Sugier, P. E., Truong, T., Pettitt, A. N., Mengersen, K., &amp; Liquet, B. (2021). Bayesian meta analysis models for cross cancer genomic investigation of pleiotropic effects using group structure. Statistics in Medicine, 40(6), 1498-1518.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################Gene DNAJC1 ###############################################
data(DNAJC1)
Breast &lt;- DNAJC1$Breast
Thyroid &lt;- DNAJC1$Thyroid
genename &lt;- "DNAJC1"
snpnames &lt;- Breast$snp
Betah &lt;- list(Breast$beta, Thyroid$beta)
Sigmah &lt;- list(diag(Breast$se^2), diag(Thyroid$se^2))
K &lt;- 2
m &lt;- 14


RES1 &lt;- DS(Betah, Sigmah,
           kappa0 = 0.5, sigma20 = 1,
           m = m, K = K, niter = 2000, burnin = 1000, nthin = 2, nchains = 1,
           a1 = 0.1, a2 = 0.1, d1 = 0.1, d2 = 0.1, snpnames, genename
)


MCMCplot(Result = RES1, k = 2, nchains = 1, whichsnps = sample(snpnames, 7),
                     betatype = "l",
                     acftype = "correlation",
                     dencol = "white", denlty = 1, denbg = "white")
###################Simulated summary level data with K=5 ###############################
## Not run: 
data(Simulated_summary)
genename &lt;- Simulated_summary$genename
snpnames &lt;- Simulated_summary$snpnames
Betah &lt;- Simulated_summary$simBeta
Sigmah &lt;- Simulated_summary$simSIGMA
K &lt;- 5
m &lt;- 10

RES1 &lt;- DS(Betah, Sigmah,
 kappa0 = c(0.2, 0.5), sigma20 = c(1, 2),
 m = m, K = K, niter = 2000, burnin = 1000, nthin = 2, nchains = 2,
 a1 = 0.1, a2 = 0.1, d1 = 0.1, d2 = 0.1, snpnames, genename)

MCMCplot(Result = RES1, k = 3, nchains = 2, whichsnps = sample(snpnames, 3),
         betatype = "l",
         acftype = "partial",
         dencol = "blue", denlty = 1, denbg = "black")

RES1 &lt;- DS(Betah, Sigmah,
 kappa0 = c(0.2, 0.5, 0.6), sigma20 = c(1, 2, 1.5),
 m = m, K = K, niter = 2000, burnin = 1000, nthin = 2, nchains = 3,
 a1 = 0.1, a2 = 0.1, d1 = 0.1, d2 = 0.1, snpnames, genename)

MCMCplot(Result = RES1, k = 3, nchains = 3, whichsnps = sample(snpnames, 5),
         betatype = "l",
         acftype = "partial",
         dencol = "white", denlty = 1, denbg = "white")
#############################Gene DNAJC1 ###############################################
pvalue &lt;- matrix(0, K, m)
for (k in 1:K) {
  pvalue[k, ] &lt;- 2 * pnorm(-abs(Betah[[k]] / sqrt(diag(Sigmah[[k]]))))
}

zinit &lt;- rep(0, K)
for (j in 1:K) {
  index &lt;- 1:m
  PVALUE &lt;- p.adjust(pvalue[j, ])
 SIGNALS &lt;- index[PVALUE &lt; 0.05]
 modelf1 &lt;- rep(0, m)
 modelf1[SIGNALS] &lt;- 1
  if (max(modelf1) == 1) (zinit[j] &lt;- 1)
}

RES &lt;- CS(Betah, Sigmah,
  kappa0 = 0.5, tau20 = 1, zeta0 = zinit,
 m = m, K = K, niter = 2000, burnin = 1000, nthin = 2, nchains = 1, a1 = 0.1, a2 = 0.1,
c1 = 0.1, c2 = 0.1, sigma2 = 10^-3, snpnames = snpnames, genename = genename)

MCMCplot(Result = RES1, k = 1, nchains = 1, whichsnps = sample(snpnames, 7),
         betatype = "l",
         acftype = "correlation",
         dencol = "white", denlty = 1, denbg = "white")
###################################Gene PARP2 ##########################################
library(BhGLM)
data(PARP2)
Breast &lt;- PARP2$Breast
Thyroid &lt;- PARP2$Thyroid
genename &lt;- "PARP2"
snpnames &lt;- c("rs3093872", "rs3093921", "rs1713411", "rs3093926", "rs3093930", "rs878156")


Fit1 &lt;- BhGLM::bglm(y1~ ., family=binomial(link="logit"),data=Breast)
Betah1 &lt;-  Fit1$coefficients[-1]
Sigmah1 &lt;- cov(coef(arm::sim(Fit1)))[-1,-1]

Fit2 &lt;- BhGLM::bglm(y2~ ., family=binomial(link="logit"),data=Thyroid)
Betah2 &lt;-  Fit2$coefficients[-1]
Sigmah2 &lt;- cov(coef(arm::sim(Fit2)))[-1,-1]

Betah &lt;- list(Betah1,Betah2)
Sigmah &lt;- list(Sigmah1,Sigmah2)
K &lt;- 2
m &lt;- 6


RES1 &lt;- DS(Betah, Sigmah, kappa0=c(0.2,0.5), sigma20=c(1,2),
          m=m, K=K, niter=1000, burnin=500, nthin=1, nchains=2,
          a1=0.1, a2=0.1, d1=0.1, d2=0.1, snpnames, genename)

MCMCplot(Result=RES1, k=1, nchains=2, whichsnps=snpnames,
         betatype = "l",
         acftype = "correlation",
         dencol = "red", denlty = 1, denbg = "white")


RES1 &lt;- DS(Betah, Sigmah, kappa0=c(0.2,0.5), sigma20=c(1,2),
          m=m, K=K, niter=2000, burnin=1000, nthin=2, nchains=2,
          a1=0.1, a2=0.1, d1=0.1, d2=0.1, snpnames, genename)

MCMCplot(Result=RES1, k=1, nchains=2, whichsnps=snpnames,
         betatype = "l",
         acftype = "correlation",
         dencol = "white", denlty = 1, denbg = "white")

## End(Not run)

</code></pre>


</div>