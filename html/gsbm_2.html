<div class="container">

<table style="width: 100%;"><tr>
<td>crossval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter selection by cross validation</h2>

<h3>Description</h3>

<p>Selection by cross validation of the regularization parameters (lambda1 and lambda2) for estimating the probabilities of connection in a Generalized Stochastic Block Model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crossval(
  A,
  epsilon = 0.1,
  nb.boot = 5,
  thresh = 1e-05,
  maxit = 100,
  lambda1.max = NULL,
  lambda2.max = NULL,
  lambda1.min = NULL,
  lambda2.min = NULL,
  length = 10,
  S0 = NULL,
  L0 = NULL,
  trace.it = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>nxn adjacency matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>regularization parameter for the L^2-norm penalty (positive number, if NULL, default method is applied)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.boot</code></td>
<td>
<p>number of folds for cross validation (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>convergence tolerance (positive number)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations (positive integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1.max</code></td>
<td>
<p>maximum regularization parameter for nuclear norm penalty (positive number)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2.max</code></td>
<td>
<p>maximum regularization parameter for 2,1-norm norm penalty (positive number)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1.min</code></td>
<td>
<p>minimum regularization parameter for nuclear norm penalty (positive number)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2.min</code></td>
<td>
<p>minimum regularization parameter for 2,1-norm norm penalty (positive number)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>size of cross-validation grid (integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0</code></td>
<td>
<p>initial value for the sparse component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L0</code></td>
<td>
<p>initial value for the low-rank component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.it</code></td>
<td>
<p>whether messages about convergence should be printed (boolean)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The values selected by cross-validation for the regularization parameters lambda1 and lambda2.
The return value is a list of components
</p>

<ul>
<li>
<p><code>lambda1</code> selected value for the parameter of the nuclear norm penalization.
</p>
</li>
<li>
<p><code>lambda2</code> selected value for the parameter of the 2,1-norm penalization.
</p>
</li>
<li>
<p><code>estim.cv</code> result of the gsbm_mcgd function for the parameters selected.
</p>
</li>
<li>
<p><code>error</code> a table containing the errors for all pairs of parameters on the grid.
</p>
</li>
<li>
<p><code>lambda1.grid</code> grid of value for the parameter lambda1.
</p>
</li>
<li>
<p><code>lambda2.grid</code> grid of value for the parameter lambda2.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Draw a 50x50 adjacency matrix
# Generalized SBM with 2 communities and 2 outliers
# Create low-rank matrix L
L &lt;- matrix(0,50,50) # low-rank component
L[1:25, 1:25] &lt;- 0.6 # connection probabilities within community 1
L[1:25, 26:48] &lt;- 0.1 # connection probabilities between communities 1 and 2
L[26:48, 1:25] &lt;- 0.1 # connection probabilities between communities 1 and 2
L[26:48, 26:48] &lt;- 0.6 # connection probabilities within community 2

# Create column-sparse matrix S
S &lt;- matrix(0,50,50) # column sparse component
S[49:50,1:48] &lt;- 0.6 # connection probabilities between outliers and inliers

# Draw connections and create the adjacency matrix
undir &lt;- rbinom(n=50*(50-1)/2, size=1, prob=(L+S+t(S))[upper.tri(L+S+t(S))]) # draw edges
A &lt;- matrix(0,50,50)
A[upper.tri(A)] &lt;- undir
A &lt;- (A+t(A))
</code></pre>


</div>