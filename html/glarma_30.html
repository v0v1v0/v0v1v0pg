<div class="container">

<table style="width: 100%;"><tr>
<td>normRandPIT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Random normal probability integral transformation
</h2>

<h3>Description</h3>

<p>Function to create the normalized conditional (randomized) quantile
residuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normRandPIT(object)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class "glarma"</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The function <code>glarmaPredProb</code> produces the non-randomized
probability integral transformation (PIT). It returns estimates of the
cumulative predictive probabilities as upper and lower bounds of a
collection of intervals. If the model is correct, a histogram drawn
using these estimated probabilities should resemble a histogram
obtained from a sample from the uniform distribution. This function
aims to produce observations which instead resemble a sample from a
normal distribution. Such a sample can then be examined by the usual
tools for checking normality, such as histograms, Q-Q normal plots and
for checking independence, autocorrelation and partial autocorrelation
plots, and associated portmanteau statistics.
</p>
<p>For each of the intervals produced by <code>glarmaPredProb</code>, a
random uniform observation is generated, which is then converted to a
normal observation by applying the inverse standard normal
distribution function (that is <code>qnorm</code>). The vector of
these values is returned by the function in the list element
<code>rt</code>. In addition non-random observations which should appear
similar to a sample from a normal distribution are obtained by
applying <code>qnorm</code> to the mid-points of the predictive distribution
intervals. The vector of these values is returned by the function in
the list element <code>rtMid</code>.
</p>


<h3>Value</h3>

<p>A list consisting of two elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rt</code></td>
<td>
<p>the normalized conditional (randomized) quantile residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtMid</code></td>
<td>
<p>the midpoints of the predictive probability intervals</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>"William T.M. Dunsmuir" &lt;w.dunsmuir@unsw.edu.au&gt; and
"David J Scott" &lt;d.scott@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Berkowitz, J. (2001) Testing density forecasts, with applications to
risk management. <em>Journal of Business \&amp; Economic Statistics</em>,
<b>19</b>, 465–474.
</p>
<p>Dunn, Peter K. and Smyth, Gordon K. (1996) Randomized quantile
residuals. <em>Journal of Computational and Graphical Statistics</em>,
<b>5</b>, 236–244.
</p>


<h3>See Also</h3>

<p>See also as <code>glarmaPredProb</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DriverDeaths)
y &lt;- DriverDeaths[, "Deaths"]
X &lt;- as.matrix(DriverDeaths[, 2:5])
Population &lt;- DriverDeaths[, "Population"]

### Offset included
glarmamodOffset &lt;- glarma(y, X, offset = log(Population/100000),
                          phiLags = c(12),
                          type = "Poi", method = "FS",
                          residuals = "Pearson", maxit = 100, grad = 1e-6)
rt &lt;- normRandPIT(glarmamodOffset)$rt
par(mfrow = c(2,2))
hist(rt, main = "Histogram of Randomized Residuals",
     xlab = expression(r[t]))
box()
qqnorm(rt, main = "Q-Q Plot of  Randomized Residuals" )
abline(0, 1, lty = 2)
acf(rt, main = "ACF of Randomized Residuals")
pacf(rt, main = "PACF of Randomized Residuals")
</code></pre>


</div>