<div class="container">

<table style="width: 100%;"><tr>
<td>gen_graph_thr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a graph of genetic differentiation
using a link weight threshold</h2>

<h3>Description</h3>

<p>The function allows to construct a genetic graph whose
links' weights are larger or lower than a specific threshold
</p>


<h3>Usage</h3>

<pre><code class="language-R">gen_graph_thr(mat_w, mat_thr = NULL, thr, mode = "larger")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat_w</code></td>
<td>
<p>A symmetric (pairwise) <code>matrix</code> or a <code>dist</code> object
whose elements will be the links' weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat_thr</code></td>
<td>
<p>(optional) A symmetric (pairwise) distance <code>matrix</code>
or a <code>dist</code> object whose values will be used for the pruning based
on the threshold value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr</code></td>
<td>
<p>The threshold value (logically between min(mat_thr)
and max(mat_thr))(integer or numeric)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>

<ul>
<li>
<p>If 'mode = 'larger” (default), all the links whose weight is larger
than 'thr' are removed.
</p>
</li>
<li>
<p>If 'mode = 'lower”, all the links whose weight is lower
than 'thr' are removed.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If 'mat_thr' is not defined, 'mat_w' is used for the pruning.
Matrices 'mat_w' and 'mat_thr' must have the same dimensions and the
same rows' and columns' names.
Values in 'mat_thr' matrix must be positive. Negative values from
'mat_w' are transformed into zeros.
The function works only for undirected graphs.
If dist objects are specified, it is assumed that colnames and
row.names of mat_w and mat_thr refer to the same populations/locations.
</p>


<h3>Value</h3>

<p>A graph object of class <code>igraph</code>
</p>


<h3>Author(s)</h3>

<p>P. Savary
</p>


<h3>Examples</h3>

<pre><code class="language-R">mat_w &lt;- mat_gen_dist(x = data_ex_genind, dist = 'DPS')
suppressWarnings(mat_thr &lt;- mat_geo_dist(pts_pop_ex,
                 ID = "ID",
                 x = "x",
                y = "y"))
mat_thr &lt;- mat_thr[row.names(mat_w), colnames(mat_w)]
graph &lt;- gen_graph_thr(mat_w, mat_thr, thr = 6000, mode = "larger")
</code></pre>


</div>