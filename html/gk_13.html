<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Markov chain Monte Carlo inference</h2>

<h3>Description</h3>

<p>Markov chain Monte Carlo (MCMC) inference for the g-and-k or g-and-h distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc(
  x,
  N,
  model = c("gk", "generalised_gh", "tukey_gh", "gh"),
  logB = FALSE,
  get_log_prior = improper_uniform_log_density,
  theta0,
  Sigma0,
  t0 = 100,
  epsilon = 1e-06,
  silent = FALSE,
  plotEvery = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of MCMC steps to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Which model to check: "gk", "generalised_gh" or "tukey_gh".
For backwards compatibility, "gh" acts the same as "generalised_gh".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logB</code></td>
<td>
<p>When true, the second parameter is log(B) rather than B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_log_prior</code></td>
<td>
<p>A function with one argument (corresponding to a vector of 4 parameters e.g. A,B,g,k) returning the log prior density. This should ensure the parameters are valid - i.e. return -Inf for invalid parameters - as the <code>mcmc</code> code will not check this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>Vector of initial value for 4 parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma0</code></td>
<td>
<p>MCMC proposal covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t0</code></td>
<td>
<p>Tuning parameter (number of initial iterations without adaptation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Tuning parameter (weight given to identity matrix in covariance calculation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>When <code>FALSE</code> (the default) a progress bar and intermediate results plots are shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotEvery</code></td>
<td>
<p>How often to plot the results if <code>silent==FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mcmc</code> performs Markov chain Monte Carlo inference for iid data from a g-and-k or g-and-h distribution, using the adaptive Metropolis algorithm of Haario et al (2001).
</p>


<h3>Value</h3>

<p>Matrix whose rows are MCMC states: the initial state <code>theta0</code> and N subsequent states.
</p>


<h3>References</h3>

<p>D. Prangle gk: An R package for the g-and-k and generalised g-and-h distributions, 2017.
H. Haario, E. Saksman, and J. Tamminen. An adaptive Metropolis algorithm. Bernoulli, 2001.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
x = rgk(10, A=3, B=1, g=2, k=0.5) ##An unusually small dataset for fast execution of this example
out = mcmc(x, N=1000, theta0=c(mean(x),sd(x),0,0), Sigma0=0.1*diag(4))
</code></pre>


</div>