<div class="container">

<table style="width: 100%;"><tr>
<td>evaluation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate the fitness of a population</h2>

<h3>Description</h3>

<p>Internal function of the genetic algorithm that evaluates the fitness (penalized log-likelihood) of a set (population) of permutations. It internally computes the best triangular matrix associated to each permutation of the population.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evaluation(Pop, X, XtX = NULL, lambda, grad.control = list(tol.obj = 1e-06,
  max.ite = 50), ncores = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pop</code></td>
<td>
<p>Population of permutations from [1,p]: matrix with <code>pop.size</code> rows and p columns, each row corresponding to one permutation of the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix, with samples (n) in rows and variables (p) in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XtX</code></td>
<td>
<p>(optional) Cross-product of X; computed if not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Parameter of penalization (&gt;0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad.control</code></td>
<td>
<p>A list containing the parameters for controlling the inner optimization, i.e. the gradient descent
</p>

<ul>
<li>
<p><code>tol.obj.inner</code> tolerance (&gt;0),
</p>
</li>
<li>
<p><code>max.ite.inner</code> maximum number of iterations (&gt;0).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores (&gt;1, depending on your computer).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li>
<p>Tpop Matrix with pxp columns, each column corresponding to the best triangular matrix (in a vector form) associated to each permutation of the population.
</p>
</li>
<li>
<p>f Fitness of the population.
</p>
</li>
</ul>
<p>A list with the following elements:
</p>

<ul>
<li>
<p><code>Tpop</code> Matrix with p rows and pop.size columns, each column corresponding to the best triangular matrix (in a vector form) associated to each permutation of the population.
</p>
</li>
<li>
<p><code>f</code> Fitness of the population.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Magali Champion, Victor Picheny and Matthieu Vignes
</p>


<h3>See Also</h3>

<p><code>GADAG</code>, <code>GADAG_Run</code>, <code>fitness</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> #############################################################
 # Loading toy data
 #############################################################
 data(toy_data)
 # toy_data is a list of two matrices corresponding to a "star"
 # DAG (node 1 activates all other nodes):
 # - toy_data$X is a 100x10 design matrix
 # - toy_data$G is the 10x10 adjacency matrix (ground trough)

 ########################################################
 # Creating a population of permutations
 ########################################################
 # first, define the parameters
 p &lt;- ncol(toy_data$G) # number of nodes
 pop.size &lt;- 10 # population size

 # then create your population of permutations
 Pop &lt;- matrix(data = 0, nrow = pop.size, ncol = p)
 for(i in 1:pop.size){
     Pop[i,] = sample(p)
 }

 ########################################################
 # Evaluating the fitness of the population
 ########################################################
 # evaluation of the whole population
 Evaluation &lt;- evaluation(Pop=Pop,X=toy_data$X,lambda=0.1)
 print(Evaluation$f) # here is the fitness of the whole population

 # evaluation of one of the permutation
 Perm &lt;- Pop[1,]
 Evaluation &lt;- evaluation(Pop=Perm,toy_data$X,lambda=0.1)

 # optimal matrix T associated to Perm:
 T &lt;- matrix(Evaluation$Tpop,p,p)
</code></pre>


</div>