<div class="container">

<table style="width: 100%;"><tr>
<td>add_risktable</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add risk table</h2>

<h3>Description</h3>

<p>Add risk tables below the plot showing the number at risk, events observed, and
number of censored observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_risktable(
  times = NULL,
  risktable_stats = c("n.risk", "cum.event"),
  risktable_group = c("auto", "strata", "risktable_stats"),
  risktable_height = NULL,
  stats_label = NULL,
  combine_groups = FALSE,
  theme = theme_risktable_default(),
  size = 3.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>numeric vector of times where risk table values will be placed.
Default are the times shown on the x-axis. The times passed here will not
modify the tick marks shown on the figure. To modify which tick marks are
shown, use <code>ggplot2::scale_x_continuous(breaks=)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>risktable_stats</code></td>
<td>
<p>character vector of statistics to show in the risk table.
Must be one or more of <code>c("n.risk", "cum.event", "cum.censor", "n.event", "n.censor")</code>.
Default is <code>c("n.risk", "cum.event")</code>.
</p>

<ul>
<li> <p><code>"n.risk"</code> Number of patients at risk
</p>
</li>
<li> <p><code>"cum.event"</code> Cumulative number of observed events
</p>
</li>
<li> <p><code>"cum.censor"</code> Cumulative number of censored observations
</p>
</li>
<li> <p><code>"n.event"</code> Number of events in time interval
</p>
</li>
<li> <p><code>"n.censor"</code> Number of censored observations in time interval
</p>
</li>
</ul>
<p>See additional details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>risktable_group</code></td>
<td>
<p>String indicating the grouping variable for the risk tables.
Default is <code>"auto"</code> and will select <code>"strata"</code> or <code>"risktable_stats"</code> based on context.
</p>

<ul>
<li> <p><code>"strata"</code> groups the risk tables per stratum when present.
</p>
</li>
<li> <p><code>"risktable_stats"</code> groups the risk tables per risktable_stats.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>risktable_height</code></td>
<td>
<p>A numeric value between 0 and 1 indicates the proportion of the
final plot the risk table will occupy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats_label</code></td>
<td>
<p>named vector or list of custom labels. Names are the statistics
from <code style="white-space: pre;">⁠risktable_stats=⁠</code> and the value is the custom label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine_groups</code></td>
<td>
<p>logical indicating whether to combine the statistics
in the risk table across groups. Default is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme</code></td>
<td>
<p>A risk table theme. Default is <code>theme_risktable_default()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size, ...</code></td>
<td>
<p>arguments passed to <code>ggplot2::geom_text(...)</code>. Pass arguments like, <code>size = 4</code>
to increase the size of the statistics presented in the table.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a ggplot2 figure
</p>


<h3>Customize Statistics</h3>

<p>You can customize how the statistics in the risk table are displayed by
utilizing <a href="https://glue.tidyverse.org/">glue</a>-like syntax in the <code>risktable_stats</code>
argument.
</p>
<p>For example, if you prefer to have the number at risk and the number of events
on the same row, you can use <code>risktable_stats = "{n.risk} ({cum.event})"</code>.
</p>
<p>You can further customize the table to include the risk estimates using
elements <code>c("estimate", "conf.low", "conf.high", "std.error")</code>. When using
these elements, you'll likely need to include a function to round the estimates
and multiply them by 100.
</p>
<div class="sourceCode r"><pre>add_risktable(
  risktable_stats =
    c("{n.risk} ({cum.event})",
      "{round(estimate*100)}% ({round(conf.low*100)}, {round(conf.high*100)})"),
  stats_label = c("At Risk (Cum. Events)", "Survival (95% CI)")
)
</pre></div>


<h3>Formatting Numbers</h3>

<p>You can also pass <a href="https://glue.tidyverse.org/">glue</a>-like syntax to
<code>risktable_stats</code> to format the numbers displayed in
the risk table. This is particularly helpful when working with weighted
<code>survfit2</code> objects for which the risk table may display too many decimals by
default e.g., for weighted patients at risk.
</p>
<div class="sourceCode r"><pre>add_risktable(
  risktable_stats = c("{format(round(n.risk, 2), nsmall = 2)}",
                      "{format(round(n.event, 2), nsmall = 2)}"),
  stats_label = c("N effective patients at risk",
                  "N effective events")
)
</pre></div>


<h3>Competing Risks</h3>

<p>The <code>ggcuminc()</code> can plot multiple competing events.
The <code>"cum.event"</code> and <code>"n.event"</code> statistics are the sum of all events across
outcomes <em>shown on the plot</em>.
</p>


<h3>See Also</h3>

<p>Visit the <a href="https://www.danieldsjoberg.com/ggsurvfit/articles/gallery.html">gallery</a> for examples modifying the default figures
</p>


<h3>Examples</h3>

<pre><code class="language-R">p &lt;-
  survfit2(Surv(time, status) ~ sex, data = df_lung) %&gt;%
  ggsurvfit() +
  add_censor_mark() +
  add_confidence_interval() +
  scale_ggsurvfit()

# using the function defaults
p + add_risktable()

# change the statistics shown and the label
p +
  add_risktable(
    risktable_stats = "n.risk",
    stats_label = list(n.risk = "Number at Risk"),
  )

p +
  add_risktable(
    risktable_stats = "{n.risk} ({cum.event})"
  )

p +
  add_risktable(
    risktable_stats = c("n.risk", "cum.event"),
    combine_groups = TRUE
  )
</code></pre>


</div>