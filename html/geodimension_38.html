<div class="container">

<table style="width: 100%;"><tr>
<td>relate_levels</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Relate levels in a dimension</h2>

<h3>Description</h3>

<p>Definition of a direct relationship between two levels of the dimension: the
lower level composes the higher level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">relate_levels(
  gd,
  lower_level_name,
  lower_level_attributes,
  upper_level_name,
  upper_level_key,
  by_geography
)

## S3 method for class 'geodimension'
relate_levels(
  gd,
  lower_level_name = NULL,
  lower_level_attributes = NULL,
  upper_level_name = NULL,
  upper_level_key = NULL,
  by_geography = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gd</code></td>
<td>
<p>A <code>geodimension</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_level_name</code></td>
<td>
<p>A string, name of the lower level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_level_attributes</code></td>
<td>
<p>A vector of attribute names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_level_name</code></td>
<td>
<p>A string, name of the upper lever.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_level_key</code></td>
<td>
<p>A vector of attribute names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_geography</code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The relationship may exist by having attributes with common values or by
their geographic attributes. In the latter case, the geometry of the upper
level must be of the polygon type.
</p>
<p>If no top-level attributes are indicated, the attributes that make up the key
are considered by default, only the corresponding attributes of the lower
level have to be indicated.
</p>
<p>To use the geometric relationship, it must be explicitly indicated by the
Boolean parameter. In this case, the attributes of the lower level must not
exist in the table, they will be added with the values of the key of the upper
level, according to the established relationship. If lower level attribute names
are not provided, they will be generated from the upper level key names, adding
a prefix.
</p>


<h3>Value</h3>

<p>A <code>geodimension</code>.
</p>


<h3>See Also</h3>

<p><code>geodimension</code>, <code>geolevel</code>
</p>
<p>Other relationship between geolevels: 
<code>complete_relation_by_geography()</code>,
<code>get_unrelated_instances()</code>,
<code>select_levels()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
layer_us_place &lt;- gd_us |&gt;
  get_level_layer("place")

layer_us_county &lt;-
  dplyr::inner_join(
    get_level_data_geo(gd_us, "county"),
    get_level_layer(gd_us, "county"),
    by = c("geoid", "statefp", "name", "type")
  ) |&gt;
  sf::st_as_sf()

place &lt;-
  geolevel(name = "place",
           layer = layer_us_place,
           attributes = c("statefp", "county_geoid", "name", "type"),
           key = "geoid")

county &lt;-
  geolevel(
    name = "county",
    layer = layer_us_county,
    attributes = c("statefp", "name", "type"),
    key = "geoid"
  ) |&gt;
  add_geometry(coordinates_to_geometry(layer_us_county,
                                       lon_lat = c("intptlon", "intptlat")))

gd &lt;-
  geodimension(name = "gd_us",
               level = place) |&gt;
  add_level(level = county)

gd &lt;- gd |&gt;
  relate_levels(
    lower_level_name = "place",
    lower_level_attributes = "county_geoid",
    upper_level_name = "county"
  )

gd_2 &lt;- gd |&gt;
  relate_levels(
    lower_level_name = "place",
    upper_level_name = "county",
    by_geography = TRUE
  )

</code></pre>


</div>