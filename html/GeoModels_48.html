<div class="container">

<table style="width: 100%;"><tr>
<td>Lik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimizes the Log Likelihood</h2>

<h3>Description</h3>

<p>Subroutine called by GeoFit.
The procedure estimates the model parameters by maximization of the
log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Lik(copula,bivariate,coordx,coordy,coordt,
coordx_dyn,corrmodel,data,fixed,flagcor,flagnuis,
           grid,lower,mdecomp,model,namescorr,
           namesnuis,namesparam,numcoord,
           numpairs,numparamcor,numtime,optimizer,
           onlyvar,parallel,param,radius,setup,
           spacetime,sparse,varest,taper,type,
           upper,ns,X,neighb,MM,aniso)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>String; the type of copula. It can be "Beta" or "Gaussian"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bivariate</code></td>
<td>
<p>Logical; if <code>TRUE</code> then the data come froma a bivariate random field.
Otherwise from a univariate random field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx</code></td>
<td>
<p>A numeric (<code class="reqn">d \times 2</code>)-matrix (where
<code>d</code> is the number of spatial sites) assigning 2-dimensions of spatial coordinates 
or a numeric <code class="reqn">d</code>-dimensional vector assigning
1-dimension of spatial coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordy</code></td>
<td>
<p>A numeric vector assigning 1-dimension of
spatial coordinates; <code>coordy</code> is interpreted only if <code>coordx</code> is a numeric
vector or <code>grid=TRUE</code> otherwise it will be ignored. Optional argument, 
the default is <code>NULL</code> then <code>coordx</code> is expected to
be numeric a (<code class="reqn">d \times 2</code>)-matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordt</code></td>
<td>
<p>A numeric vector assigning 1-dimension of
temporal coordinates. Optional argument, the default is <code>NULL</code>
then a spatial random field is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx_dyn</code></td>
<td>
<p>A list of <code class="reqn">m</code> numeric (<code class="reqn">d_t \times 2</code>)-matrices
containing dynamical (in time) spatial coordinates. Optional argument, the default is <code>NULL</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrmodel</code></td>
<td>
<p>Numeric; the id of the correlation model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector or a (<code class="reqn">n \times d</code>)-matrix or (<code class="reqn">d \times d
      \times n</code>)-matrix of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flagcor</code></td>
<td>
<p>A numeric vector of flags denoting which correlation
parameters have to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flagnuis</code></td>
<td>
<p>A numeric verctor of flags denoting which nuisance
parameters have to estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A numeric vector of parameters that
will be considered as known values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical; if <code>FALSE</code> (the default) the data
are interpreted as a vector or a (<code class="reqn">n \times d</code>)-matrix,
instead if <code>TRUE</code> then (<code class="reqn">d \times d
      \times n</code>)-matrix is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>An optional named list giving the values  for the lower bound of the space parameter
when the optimizer is  <code>L-BFGS-B</code> or <code>nlminb</code>  or <code>optimize</code>. The 
names of the list must be the same of the names in the   <code>start</code> list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Numeric; the id value of the density associated to the likelihood
objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>namescorr</code></td>
<td>
<p>String; the names of the correlation parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>namesnuis</code></td>
<td>
<p>String; the names of the nuisance parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>namesparam</code></td>
<td>
<p>String; the names of the parameters to be maximised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numcoord</code></td>
<td>
<p>Numeric; the number of coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numpairs</code></td>
<td>
<p>Numeric; the number of pairs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numparamcor</code></td>
<td>
<p>Numeric; the number of the correlation parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numtime</code></td>
<td>
<p>Numeric; the number of temporal observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mdecomp</code></td>
<td>
<p>String; the type of matrix decomposition used in the simulation. Default is cholesky.
The other possible choices is <code>svd</code> (Singular values decomposition).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>String; the optimization algorithm
(see <code>optim</code> for details). <code>Nelder-Mead</code> is the
default. Other possible choices are <code>nlm</code>, <code>BFGS</code>  <code>L-BFGS-B</code> and <code>nlminb</code>. 
In these last two cases upper and lower bounds can be passed by the user. In the case
of one-dimensional optimization, the function <code>optimize</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyvar</code></td>
<td>
<p>Logical; if <code>TRUE</code>  (and varest is  <code>TRUE</code>) only the variance covariance matrix is computed
without optimizing. <code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical; if <code>TRUE</code> optmization is performed using optimParallel 
using the maximum number of cores,  when optimizer is  
<code>L-BFGS-B</code>.<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A numeric vector of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>Logical; if <code>TRUE</code> then  maximum likelihood is computed
using sparse matrices algorithms.<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Numeric; the radius of the sphere when considering data on a sphere.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>Numeric: vector of number of location sites for each temporal instants</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setup</code></td>
<td>
<p>A List of useful components for the estimation based on the maximum tapered likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacetime</code></td>
<td>
<p>Logical; if the random field is spatial
(<code>FALSE</code>) or spatio-temporal (<code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest</code></td>
<td>
<p>Logical; if <code>TRUE</code> the estimate' variances and
standard errors are returned.
<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taper</code></td>
<td>
<p>String; the name of the taper correlation function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String; the type of the likelihood objects. If <code>Pairwise</code> (the
default) then the marginal composite likelihood is formed by
pairwise marginal likelihoods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>An optional named list giving the values  for the upper bound 
of the space parameter when the optimizer is or <code>L-BFGS-B</code> or  <code>nlminb</code> or <code>optimize</code>. 
The names of the list must be the same of the names in the   <code>start</code> list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric; Matrix of spatio(temporal)covariates in the linear mean specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighb</code></td>
<td>
<p>Numeric;parameter for vecchia approximation using GPvecchia package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MM</code></td>
<td>
<p>Numeric;a non constant fixed mean </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aniso</code></td>
<td>
<p>Logical; should anisotropy be considered?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Return a list from an <code>optim</code> call.</p>


<h3>Author(s)</h3>

<p>Moreno Bevilacqua, <a href="mailto:moreno.bevilacqua89@gmail.com">moreno.bevilacqua89@gmail.com</a>,<a href="https://sites.google.com/view/moreno-bevilacqua/home">https://sites.google.com/view/moreno-bevilacqua/home</a>,
Víctor Morales Oñate, <a href="mailto:victor.morales@uv.cl">victor.morales@uv.cl</a>, <a href="https://sites.google.com/site/moralesonatevictor/">https://sites.google.com/site/moralesonatevictor/</a>,
Christian", Caamaño-Carrillo, <a href="mailto:chcaaman@ubiobio.cl">chcaaman@ubiobio.cl</a>,<a href="https://www.researchgate.net/profile/Christian-Caamano">https://www.researchgate.net/profile/Christian-Caamano</a>
</p>


<h3>See Also</h3>

<p><code>GeoFit</code></p>


</div>