<div class="container">

<table style="width: 100%;"><tr>
<td>glmmML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Linear Models with random intercept</h2>

<h3>Description</h3>

<p>Fits GLMs with random intercept by Maximum Likelihood and numerical
integration via Gauss-Hermite quadrature.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glmmML(formula, family = binomial, data, cluster, weights,
cluster.weights, subset, na.action, 
offset, contrasts = NULL, prior = c("gaussian", "logistic", "cauchy"),
start.coef = NULL, start.sigma = NULL, fix.sigma = FALSE, x = FALSE, 
control = list(epsilon = 1e-08, maxit = 200, trace = FALSE),
method = c("Laplace", "ghq"), n.points = 8, boot = 0) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> a symbolic description of the model to be fit. The details of
model specification are given below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Currently, the only valid values are <code>binomial</code> and
<code>poisson</code>. The binomial family allows for the <code>logit</code> and
<code>cloglog</code> links.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from
‘environment(formula)’, typically the environment from which
‘glmmML’ is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Factor indicating which items are correlated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Case weights. Defaults to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.weights</code></td>
<td>
<p>Cluster weights. Defaults to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>See glm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.coef</code></td>
<td>
<p>starting values for the parameters in the linear predictor.
Defaults to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.sigma</code></td>
<td>
<p>starting value for the mixing standard
deviation. Defaults to 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.sigma</code></td>
<td>
<p>Should sigma be fixed at start.sigma?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>If TRUE, the design matrix is returned (as x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be
included in the linear predictor during fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the 'contrasts.arg' of 'model.matrix.default'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Which "prior" distribution (for the random effects)?
Possible choices are "gaussian" (default), "logistic", and "cauchy".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Controls the convergence criteria. See
<code>glm.control</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>There are two choices "Laplace" (default) and "ghq"
(Gauss-Hermite). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.points</code></td>
<td>
<p>Number of points in the Gauss-Hermite quadrature. If
n.points == 1, the Gauss-Hermite is the same as Laplace
approximation. If <code>method</code> is set to "Laplace", this parameter
is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Do you want a bootstrap estimate of cluster effect? The default
is <em>No</em> (<code>boot = 0</code>). If you want to say yes, enter a
positive integer here. It should be equal to the number of bootstrap
samples you want to draw. A recomended absolute <em>minimum value</em> is
<code>boot = 2000</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The integrals in the log likelihood function are evaluated by the
Laplace approximation (default) or Gauss-Hermite quadrature. The latter
is now fully adaptive; however, only approximate estimates of variances
are available for the Gauss-Hermite (n.points &gt; 1) method.
</p>
<p>For the binomial families, the response can be a two-column matrix, see
the help page for glm for details.</p>


<h3>Value</h3>

<p>The return value is a list, an object of class 'glmmML'. The components are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>No. of boot replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>Logical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Estimated regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.sd</code></td>
<td>
<p>Their standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The estimated random effects' standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.sd</code></td>
<td>
<p>Its standard error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>The estimated variance-covariance matrix. The last
column/row corresponds to the standard
deviation of the random effects (<code>sigma</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AIC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootP</code></td>
<td>
<p>Bootstrap p value from testing the null hypothesis of no
random effect (sigma = 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>Deviance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixed</code></td>
<td>
<p>Logical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>Degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.null.deviance</code></td>
<td>
<p>Deviance from a glm with no
clustering. Subtracting <code>deviance</code> gives a test statistic for
the null hypothesis of no clustering. Its asymptotic distribution is
a symmetric mixture a constant at zero and a chi-squared distribution
with one df. The printed p-value is based on this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.null.df</code></td>
<td>
<p>Its degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior.modes</code></td>
<td>
<p>Estimated posterior modes of the random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>The terms object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>From hessian inversion. Should be 0. If not, no variances
could be estimated. You could try fixing sigma at the estimated
value and rerun.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Which prior was used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The design matrix if asked for, otherwise not present</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The optimization may not converge with
the default value of <code>start.sigma</code>. In that case, try different
start values for sigma. If still no convergence, consider the
possibility to fix the value of sigma at several values and study the
profile likelihood.</p>


<h3>Author(s)</h3>

<p>G\"oran Brostr\"om</p>


<h3>References</h3>

<p>Brostr\"om, G. and Holmberg, H. (2011). Generalized linear models with
clustered data: Fixed and random effects models. Computational
Statistics and Data Analysis 55:3123-3134.
</p>


<h3>See Also</h3>

<p><code>glmmboot</code>, <code>glm</code>, <code>optim</code>,
<code>lmer</code> in <code>Matrix</code>and
<code>glmmPQL</code> in <code>MASS</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">id &lt;- factor(rep(1:20, rep(5, 20)))
y &lt;- rbinom(100, prob = rep(runif(20), rep(5, 20)), size = 1)
x &lt;- rnorm(100)
dat &lt;- data.frame(y = y, x = x, id = id)
glmmML(y ~ x, data = dat, cluster = id)
</code></pre>


</div>