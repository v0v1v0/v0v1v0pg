<div class="container">

<table style="width: 100%;"><tr>
<td>gseg2_discrete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graph-Based Change-Point Detection for Changed Interval for Data with Repeated Observations</h2>

<h3>Description</h3>

<p>This function finds an interval in the sequence where their underlying distribution differs from the rest of the sequence when data has repeated observations. It provides four graph-based test statistics.</p>


<h3>Usage</h3>

<pre><code class="language-R">gseg2_discrete(n, E, id, statistics=c("all","o","w","g","m"), l0=0.05*n, l1=0.95*n, 
   pval.appr=TRUE, skew.corr=TRUE, pval.perm=FALSE, B=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations in the sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>The edge matrix (a "number of edges" by 2 matrix) for the similarity graph. Each row contains the node indices of an edge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>The index of observations (order of observations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistics</code></td>
<td>
<p>The scan statistic to be computed. A character indicating the type of of scan statistic desired. The default is <code>"all"</code>.
</p>
<p><code>"all"</code>: specifies to compute <b>a</b>ll of the scan statistics: original, weighted, generalized, and max-type;
</p>
<p><code>"o", "ori"</code> or <code>"original"</code>: specifies the <b>o</b>riginal edge-count scan statistic;
</p>
<p><code>"w"</code> or <code>"weighted"</code>: specifies the <b>w</b>eighted edge-count scan statistic;
</p>
<p><code>"g"</code> or <code>"generalized"</code>: specifies the <b>g</b>eneralized edge-count scan statistic; and
</p>
<p><code>"m"</code> or <code>"max"</code>: specifies the <b>m</b>ax-type edge-count scan statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l0</code></td>
<td>
<p>The minimum length of the interval to be considered as a changed interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1</code></td>
<td>
<p>The maximum length of the interval to be considered as a changed interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.appr</code></td>
<td>
<p>If it is TRUE, the function outputs p-value approximation based on asymptotic properties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skew.corr</code></td>
<td>
<p>This argument is useful only when pval.appr=TRUE.  If skew.corr is TRUE, the p-value approximation would incorporate skewness correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.perm</code></td>
<td>
<p>If it is TRUE, the function outputs p-value from doing B permutations, where B is another argument that you can specify. Doing permutation could be time consuming, so use this argument with caution as it may take a long time to finish the permutation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>This argument is useful only when pval.perm=TRUE.  The default value for B is 100.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list <code>scanZ</code> with <code>tauhat</code>, <code>Zmax</code>, and a vector of the scan statistics for each type of scan statistic specified. See below for more details.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tauhat_a</code></td>
<td>
<p>An estimate of the two ends of the changed interval for averaging approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauhat_u</code></td>
<td>
<p>An estimate of the two ends of the changed interval for union approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_a_max</code></td>
<td>
<p>The test statistic (maximum of the scan statistics) for averaging approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_u_max</code></td>
<td>
<p>The test statistic (maximum of the scan statistics) for union approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zo_a</code></td>
<td>
<p>A matrix of the original scan statistics (standardized counts) for averaging approach if statistic specified is "all" or "o".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zo_u</code></td>
<td>
<p>A matrix of the original scan statistics (standardized counts) for union approach if statistic specified is "all" or "o".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zw_a</code></td>
<td>
<p>A matrix of the weighted scan statistics (standardized counts) for averaging approach if statistic specified is "all" or "w".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zw_u</code></td>
<td>
<p>A matrix of the weighted scan statistics (standardized counts) for union approach if statistic specified is "all" or "w".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_a</code></td>
<td>
<p>A matrix of the generalized scan statistics (standardized counts) for averaging approach if statistic specified is "all" or "g".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_u</code></td>
<td>
<p>A matrix of the generalized scan statistics (standardized counts) for union approach if statistic specified is "all" or "g".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_a</code></td>
<td>
<p>A matrix of the max-type scan statistics (standardized counts) for averaging approach if statistic specified is "all" or "m".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M_u</code></td>
<td>
<p>A matrix of the max-type scan statistics (standardized counts) for union approach if statistic specified is "all" or "m".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ro_a</code></td>
<td>
<p>A matrix of raw counts of the original scan statistic for averaging approach. This output only exists if the statistic specified is "all" or "o".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ro_u</code></td>
<td>
<p>A matrix of raw counts of the original scan statistic for union approach. This output only exists if the statistic specified is "all" or "o".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rw_a</code></td>
<td>
<p>A matrix of raw counts of the weighted scan statistic for averaging approach. This output only exists if statistic specified is "all" or "w".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rw_a</code></td>
<td>
<p>A matrix of raw counts of the weighted scan statistic for union approach. This output only exists if statistic specified is "all" or "w".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.appr</code></td>
<td>
<p>The approximated p-value based on asymptotic theory for each type of statistic specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.perm</code></td>
<td>
<p>This output exists only when the argument pval.perm is TRUE . It is the permutation p-value from B permutations and appears for each type of statistic specified (same for perm.curve, perm.maxZs, and perm.Z).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.curve</code></td>
<td>
<p>A B by 2 matrix with the first column being critical values corresponding to the p-values in the second column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.maxZs</code></td>
<td>
<p>A sorted vector recording the test statistics in the B permutaitons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm.Z</code></td>
<td>
<p>A B by n-squared matrix with each row being the vectorized scan statistics from each permutaiton run.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>gSeg</code>, <code>gseg2</code>, <code>nnl</code>, <code>gseg1_discrete</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">d = 50
mu = 2
tau = 100
n = 200

set.seed(500)
y1_temp = matrix(rnorm(d*tau),tau)
sam1 = sample(1:tau, replace = TRUE)
y1 = y1_temp[sam1,] 
y2_temp = matrix(rnorm(d*(n-tau),mu/sqrt(d)), n-tau)
sam2 = sample(1:tau, replace = TRUE)
y2 = y2_temp[sam2,] 

y = rbind(y1, y2)

# This data y has repeated observations
y_uni = unique(y)
E = nnl(dist(y_uni), 1)

cha = do.call(paste, as.data.frame(y))    
id = match(cha, unique(cha))

r1 = gseg2_discrete(n, E, id, statistics="all")
</code></pre>


</div>