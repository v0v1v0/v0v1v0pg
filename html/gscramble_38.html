<div class="container">

<table style="width: 100%;"><tr>
<td>sim_level_founder_haplos</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>computes the simulation-level founder haplotype index for each founder haplo</h2>

<h3>Description</h3>

<p>This takes the output of <code>segregate()</code> and deals with the multiple gpp's and reps
to come up with a unique index for each found haplotype, so that those haplotypes
can all, eventually, be accessed easily out of the genotype matrix.
Along the way, this function does some light checking to make sure that the
<code>rs_founder_haplo</code> values are dense within <code>gpp</code> and <code>index</code> as they should be.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_level_founder_haplos(S)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>tibble of segments like that produced by <code>segregate</code>.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>This function returns a result that is basically the output of <code>segregate()</code> with
an additional column added to it:  <code>sim_level_founder_haplo</code>.  This is the index
of the haplotype within each <code>group_origin</code> that should be used. For details of the
other columns in the output tibble, see the documentation for <code>segregate</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### Get output from segregate to use as input ####
# We construct an example here where we will request segregation
# down a GSP with two F1s and F1B backcrosses between two hypothetical
# populations, A and B.
gsp_f1f1b &lt;- create_GSP("A", "B", F1 = TRUE, F1B = TRUE)

# We will imagine that in our marker data there are three groups
# labelled "grp1", "grp2", and "grp3", and we want to create the F1Bs with backcrossing
# only to grp3.
reppop &lt;- tibble::tibble(
  index = as.integer(c(1, 1, 2, 2)),
  pop = c("A", "B", "A", "B"),
  group = c("grp3", "grp1", "grp3", "grp2")
)

# combine those into a request
request &lt;- tibble::tibble(
  gpp = list(gsp_f1f1b),
  reppop = list(reppop)
)

# now run it through segregate()
set.seed(5)  # just for reproducibility in example...
simSegs &lt;- segregate(request, RecRates)

#### Now we can run those through sim_level_founder_haplos() ####
fh &lt;- sim_level_founder_haplos(simSegs)
fh
</code></pre>


</div>