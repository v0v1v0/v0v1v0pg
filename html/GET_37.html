<div class="container">

<table style="width: 100%;"><tr>
<td>global_rq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global quantile regression</h2>

<h3>Description</h3>

<p>Global tests of significance for the effect of covariates in quantile regression
</p>


<h3>Usage</h3>

<pre><code class="language-R">global_rq(
  nsim,
  formula.full,
  formula.reduced,
  taus,
  data,
  contrasts = NULL,
  permutationstrategy = c("Freedman-Lane", "Freedman-Lane+remove zeros",
    "within nuisance", "remove location", "remove location scale", "remove quantile"),
  savefuns = FALSE,
  rq.args = NULL,
  lm.args = NULL,
  GET.args = NULL,
  mc.cores = 1L,
  mc.args = NULL,
  cl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>The number of random permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.full</code></td>
<td>
<p>The formula specifying the general linear model,
see <code>formula</code> in <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.reduced</code></td>
<td>
<p>The formula of the reduced model with nuisance factors only. This model
should be nested within the full model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>The quantiles to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame where to look for variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>Passed directly to <code>rq</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutationstrategy</code></td>
<td>
<p>The permutation strategy to be used. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savefuns</code></td>
<td>
<p>Logical. If TRUE, then the functions from permutations are saved to the attribute
simfuns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rq.args</code></td>
<td>
<p>Additional arguments passed to <code>rq</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm.args</code></td>
<td>
<p>A named list of additional arguments to be passed to <code>lm</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GET.args</code></td>
<td>
<p>A named list of additional arguments to be passed to <code>global_envelope_test</code>,
e.g. <code>typeone</code> specifies the type of multiple testing control, FWER or FDR.
See <code>global_envelope_test</code> for the defaults and available options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>The number of cores to use, i.e. at most how many child processes will be run simultaneously.
Must be at least one, and parallelization requires at least two cores. On a Windows computer mc.cores must be 1
(no parallelization). For details, see <code>mclapply</code>, for which the argument is passed.
Parallelization can be used in generating simulations and in calculating the second stage tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.args</code></td>
<td>
<p>A named list of additional arguments to be passed to <code>mclapply</code>.
Only relevant if <code>mc.cores</code> is more than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Allows parallelization through the use of <code>parLapply</code> (works also
in Windows), see the argument <code>cl</code> there, and examples.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The possible permutation strategies include
"Freedman-Lane" (FL), "Freedman-Lane+remove zeros" (FL+), "within nuisance" (WN),
"remove location" (RL), "remove location scale" (RLS), "remove quantile" (RQ),
which correspond to those in Mrkvička et al. (Section 4.1-4.6 and Table 1).
</p>


<h3>Value</h3>

<p>A <code>global_envelope</code> or <code>combined_global_envelope</code> object,
which can be printed and plotted directly.
</p>


<h3>References</h3>

<p>Mrkvička, T., Konstantinou, K., Kuronen, M. and Myllymäki, M. (2023) Global quantile regression. arXiv:2309.04746 [stat.ME]. https://doi.org/10.48550/arXiv.2309.04746
</p>
<p>Myllymäki, M and Mrkvička, T. (2023). GET: Global envelopes in R. arXiv:1911.06583 [stat.ME]. https://doi.org/10.48550/arXiv.1911.06583
</p>
<p>Freedman, D., &amp; Lane, D. (1983) A nonstochastic interpretation of reported significance levels. Journal of Business &amp; Economic Statistics, 1(4), 292-298. doi:10.2307/1391660
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require("quantreg", quietly=TRUE)) {
  data("stackloss")
  res &lt;- global_rq(nsim = 19, # Increase nsim for serious analysis!
    formula.full = stack.loss ~ Air.Flow + Water.Temp + Acid.Conc.,
    formula.reduced = stack.loss ~ Water.Temp,
    taus = seq(0.1, 0.9, length=10), permutationstrategy = "remove quantile",
    data = stackloss, GET.args = list(typeone = "fwer"))
  plot(res)
}

</code></pre>


</div>