<div class="container">

<table style="width: 100%;"><tr>
<td>cglmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit cosinor model with <code>{glmmTMB}</code>
</h2>

<h3>Description</h3>

<p>Given an outcome and time variable, fit the cosinor model with optional
covariate effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cglmm(
  formula,
  data,
  family = stats::gaussian(),
  quietly = TRUE,
  dispformula = ~1,
  ziformula = ~0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A <code>formula</code> specifying the cosinor model to be fit.
The cosinor portion of the formula is controlled by including
<code>amp_acro()</code> on the right hand side of the formula.
See <code>amp_acro</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> containing the variables used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A <code>family</code> function or a character string naming a family
function. See <code>?family</code> and <code>?glmmTMB::family_glmmTMB</code> for options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quietly</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, shows warning messages when
wrangling data and fitting model. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispformula</code></td>
<td>
<p>A one-sided (i.e., no response variable) <code>formula</code>
for dispersion combining fixed and random effects, including cosinor
components using <code>amp_acro()</code>. Defaults to <code>~1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ziformula</code></td>
<td>
<p>A one-sided (i.e., no response variable) <code>formula</code>
for zero-inflation combining fixed and random effects, including cosinor
components using <code>amp_acro()</code>. Defaults to <code>~0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional additional arguments passed to <code>glmmTMB::glmmTMB()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a fitted cosinor model as a <code>cglmm</code> object.
</p>


<h3>References</h3>

<p>Tong, YL. Parameter Estimation in Studying Circadian
Rhythms, Biometrics (1976). 32(1):85â€“94.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Single component cosinor model
cglmm(
  vit_d ~ amp_acro(time_col = time, group = "X", period = 12),
  data = vitamind
)

# 2-component cosinor model with simulated data
sim_data &lt;- simulate_cosinor(
  n = 500,
  mesor = 5,
  amp = c(2, 1),
  acro = c(1, 1.5),
  beta.mesor = 2,
  beta.amp = c(2, 1),
  beta.acro = c(1, 1.5),
  family = "gaussian",
  period = c(12, 6),
  n_components = 2,
  beta.group = TRUE,
)

cglmm(
  Y ~ group + amp_acro(times,
    n_components = 2,
    group = "group",
    period = c(12, 6)
  ),
  data = sim_data,
  family = gaussian
)
</code></pre>


</div>