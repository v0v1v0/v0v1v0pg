<div class="container">

<table style="width: 100%;"><tr>
<td>ggpmisc-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ggpmisc: Miscellaneous Extensions to 'ggplot2'</h2>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style="float: right" alt="logo" width="120"></p>
<p>Extensions to 'ggplot2' respecting the grammar of graphics paradigm. Statistics: locate and tag peaks and valleys; label plot with the equation of a fitted polynomial or other types of models; labels with P-value, R^2 or adjusted R^2 or information criteria for fitted models; label with ANOVA table for fitted models; label with summary for fitted models. Model fit classes for which suitable methods are provided by package 'broom' and 'broom.mixed' are supported. Scales and stats to build volcano and quadrant plots based on outcomes, fold changes, p-values and false discovery rates.
</p>


<h3>Details</h3>

<p>The new facilities for cleanly defining new stats and geoms added to
'ggplot2' in version 2.0.0 and the support for nested data frames and lists
and new syntax for mapping computed values to aesthetics added to 'ggplot2'
in version 3.0.0 are used in this package's code, as well as some features
added in more recent updates including 3.5.0. This means that current
'ggpmisc' versions require recent versions of ggplot2.
</p>
<p>Extensions provided:
</p>

<ul>
<li>
<p> Function for conversion of time series data into tibbles that can be
plotted with ggplot.
</p>
</li>
<li> <p><code>ggplot()</code> method for time series data.
</p>
</li>
<li>
<p> Stats for locating and tagging "peaks" and "valleys" (local or global
maxima and minima).
</p>
</li>
<li>
<p> Stat for generating labels from model fit objects, including
formatted equations. By default labels are R's plotmath expressions but LaTeX, markdown
and plain text formatted labels are optionaly assembled.
</p>
</li>
<li>
<p> Stats for extracting information from a any model fit supported by
package 'broom' and using it to generate various annotations and data labels.
</p>
</li>
<li>
<p> Stat for computing and generating labels for the results from multiple
comparisons, including adjusted <em>P</em>-values.</p>
</li>
</ul>
<p>The stats for peaks and valleys are coded so as to work correctly both with
numeric and POSIXct variables mapped to the x aesthetic. Special handling was
needed as text labels are generated from the data.
</p>


<h3>Note</h3>

<p>The signatures of <code>stat_peaks()</code> and <code>stat_valleys()</code> from
'ggpmisc' are identical to those of <code>stat_peaks</code> and
<code>stat_valleys</code> from package 'ggspectra' but the variables returned are
a subset as special handling of values related to light spectra is missing.
Furthermore the <code>stat_peaks()</code> and <code>stat_valleys()</code> from package
'ggpmisc' work correctly when date or datetime values are mapped to the
<em>x</em> statistic, while those from package 'ggspectra' do not generate
correct labels in this case.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pedro J. Aphalo <a href="mailto:pedro.aphalo@helsinki.fi">pedro.aphalo@helsinki.fi</a> (<a href="https://orcid.org/0000-0003-3385-972X">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li>
<p> Kamil Slowikowski (<a href="https://orcid.org/0000-0002-2843-6370">ORCID</a>) [contributor]
</p>
</li>
<li>
<p> Samer Mouksassi <a href="mailto:samermouksassi@gmail.com">samermouksassi@gmail.com</a> (<a href="https://orcid.org/0000-0002-7152-6654">ORCID</a>) [contributor]
</p>
</li>
</ul>
<h3>References</h3>

<p>Package suite 'r4photobiology' web site at
<a href="https://www.r4photobiology.info/">https://www.r4photobiology.info/</a><br> Package 'ggplot2' documentation at
<a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</a><br> Package 'ggplot2' source code at
<a href="https://github.com/tidyverse/ggplot2">https://github.com/tidyverse/ggplot2</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://docs.r4photobiology.info/ggpmisc/">https://docs.r4photobiology.info/ggpmisc/</a>
</p>
</li>
<li> <p><a href="https://github.com/aphalo/ggpmisc">https://github.com/aphalo/ggpmisc</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/aphalo/ggpmisc/issues">https://github.com/aphalo/ggpmisc/issues</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(tibble)

ggplot(lynx, as.numeric = FALSE) + geom_line() +
stat_peaks(colour = "red") +
  stat_peaks(geom = "text", colour = "red", angle = 66,
             hjust = -0.1, x.label.fmt = "%Y") +
  ylim(NA, 8000)

formula &lt;- y ~ poly(x, 2, raw = TRUE)
ggplot(cars, aes(speed, dist)) +
  geom_point() +
  stat_poly_line(formula = formula) +
  stat_poly_eq(use_label("eq", "R2", "P"),
               formula = formula,
               parse = TRUE) +
  labs(x = expression("Speed, "*x~("mph")),
       y = expression("Stopping distance, "*y~("ft")))

formula &lt;- y ~ x
ggplot(PlantGrowth, aes(group, weight)) +
  stat_summary(fun.data = "mean_se") +
  stat_fit_tb(method = "lm",
              method.args = list(formula = formula),
              tb.type = "fit.anova",
              tb.vars = c(Term = "term", "df", "M.S." = "meansq",
                          "italic(F)" = "statistic",
                          "italic(p)" = "p.value"),
              tb.params = c("Group" = 1, "Error" = 2),
              table.theme = ttheme_gtbw(parse = TRUE)) +
  labs(x = "Group", y = "Dry weight of plants") +
  theme_classic()

</code></pre>


</div>