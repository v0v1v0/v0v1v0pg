<div class="container">

<table style="width: 100%;"><tr>
<td>rectprismgrav</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
rectprismgrav
</h2>

<h3>Description</h3>

<p>Calculates the graviational attraction of 3-D rectangular prisms.
Calculates anomalies of <code>N</code> prisms at <code>M</code> observation stations.
</p>
<p>Stations cannot be positioned on the edge of a prism.
</p>
<p>Coordinates of stations and prisms are assumed to share a common coordinate system.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rectprismgrav(xstation, ystation, zstation, xmin, xmax, ymin, ymax,
                         zdeep, zshallow, deltarho, bycell=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xstation</code></td>
<td>
<p>vector of length <code>M</code> with the x-coordinates of each station, in km, positive east;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ystation</code></td>
<td>
<p>vector of length <code>M</code> with the y-coordinates of each station, in km, positive north;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zstation</code></td>
<td>
<p>vector of length <code>M</code> with the z-coordinates of each station, in km, positive up;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>vector of length <code>N</code> with the minimum x-coordinates of each prism, in km, positive east;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>vector of length <code>N</code> with the maximum x-coordinates of each prism, in km, positive east;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymin</code></td>
<td>
<p>vector of length <code>N</code> with the minimum y-coordinates of each prism, in km, positive north;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>vector of length <code>N</code> with the maximum y-coordinates of each prism, in km, positive north;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zdeep</code></td>
<td>
<p>vector of length <code>N</code> with the bottom z-coordinates of each prism, in km, positive up;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zshallow</code></td>
<td>
<p>vector of length <code>N</code> with the top z-coordinates of each prism, in km, positive up;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltarho</code></td>
<td>
<p>vector of length <code>N</code> with the density contrast of each prism, in grams per cubic centimeter (g/cc);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bycell</code></td>
<td>
<p>returns <code>M</code>-by-<code>N</code> matrix with anomaly values generated by individual prisms (default FALSE).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a matrix of length <code>M</code> rows.
</p>
<p>If <code>bycell=FALSE</code>, there will be <code>M</code> rows and 1 column, and the
element in the <code>i</code>-th row represents the total gravity anomaly generated
by all <code>N</code> prisms as observed at the <code>i</code>-th station.
</p>
<p>If <code>bycell=TRUE</code>, the matrix will have <code>M</code> rows and <code>N</code> columns,
with the element <code>[i,j]</code> representing the anomaly value generated by the
<code>j</code>-th prism as observed at the <code>i</code>-th station.
</p>


<h3>References</h3>


<ul><li>
<p> Plouff, D., 1975, Derivation of formulas and FORTRAN programs to compute gravity anomalies of prisms, National Technical Information Service No. PB-243-526, U.S. Department of Commerce, Springfield, VA.  <br><a href="https://ntrl.ntis.gov/NTRL/dashboard/searchResults/titleDetail/PB243526.xhtml">https://ntrl.ntis.gov/NTRL/dashboard/searchResults/titleDetail/PB243526.xhtml</a>.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>rectprismmag</code>,
<code>gravmagsubs</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#########################################################
## gravity anomaly of a single prism at a single point ##

# location of the point where the gravity anomaly will be calculated
gravstation &lt;- data.frame(x=0, y=0, z=0)

# the rectangular prism is defined by its six edges
prism1 &lt;- data.frame(xmin=-5, xmax=5,
                     ymin=-5, ymax=5,
                     zmin=-10, zmax=-5)

# density contrast in g/cc
drho &lt;- 0.3

gravanom &lt;- rectprismgrav(gravstation$x, gravstation$y, gravstation$z,
                          prism1$xmin, prism1$xmax,
                          prism1$ymin, prism1$ymax,
                          prism1$zmin, prism1$zmax, drho)

#########################################################

</code></pre>


</div>