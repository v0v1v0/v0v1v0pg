<div class="container">

<table style="width: 100%;"><tr>
<td>Dxy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dxy</h2>

<h3>Description</h3>

<p>This function calculates the average number of nucleotide differences per site (Dxy) between two populations from a VCF file (Nei &amp; Li, 1979 (https://doi.org/10.1073/pnas.76.10.5269)).
Handling missing alleles at one site is equivalent to Korunes &amp; Samuk, 2021 ( https://doi.org/10.1111/1755-0998.13326).
The function calculates the number of monomorphic sites using the sequence length and the number of variants in the VCF file. This assumes, that all sites not present in the VCF file are invariant sites, which will underestimate Pi, because of commonly done (and necessary) variant filtering. However, otherwise this calculation would only work with VCF files that include all monomorphic sites, which is quite unpractical for common use cases and will increase computational demands significantly.
If you happen to know the number of filtered our sites vs the number of monomorphic sites, please use the number of monomorphic + the number of polymorphic (number of variants in your VCF) sites as the sequence length to get the most accurate estimation of Pi. (This does not work for the window mode of this function, which assumes the sequence length to be the window size.)
For batch processing, it uses <code>process_vcf_in_batches</code>. For windowed analysis, it uses a similar
approach tailored to process specific genomic windows (<code>process_vcf_in_windows</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Dxy(
  vcf_path,
  pop1_individuals,
  pop2_individuals,
  seq_length,
  batch_size = 10000,
  threads = 1,
  write_log = FALSE,
  logfile = "log.txt",
  window_size = NULL,
  skip_size = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vcf_path</code></td>
<td>
<p>Path to the VCF file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop1_individuals</code></td>
<td>
<p>Vector of individual names belonging to the first population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop2_individuals</code></td>
<td>
<p>Vector of individual names belonging to the second population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq_length</code></td>
<td>
<p>Length of the sequence in number of bases, including monomorphic sites (used in batch mode only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>The number of variants to be processed in each batch
(used in batch mode only, default of 10,000 should be suitable for most use cases).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>Number of threads to use for parallel processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write_log</code></td>
<td>
<p>Logical, indicating whether to write progress logs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logfile</code></td>
<td>
<p>Path to the log file where progress will be logged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_size</code></td>
<td>
<p>Size of the window for windowed analysis in base pairs (optional).
When specified, <code>skip_size</code> must also be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_size</code></td>
<td>
<p>Number of base pairs to skip between windows (optional).
Used in conjunction with <code>window_size</code> for windowed analysis.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>In batch mode (no window_size or skip_size provided): The average number of nucleotide substitutions per site between the individuals of two populations (Dxy).
In window mode (window_size and skip_size provided): A data frame with columns 'Chromosome', 'Start', 'End', and 'Dxy', representing the average nucleotide differences within each window.
</p>


<h3>Examples</h3>

<pre><code class="language-R">vcf_file &lt;- system.file("tests/testthat/sim.vcf.gz", package = "GenoPop")
index_file &lt;- system.file("tests/testthat/sim.vcf.gz.tbi", package = "GenoPop")
pop1_individuals &lt;- c("tsk_0", "tsk_1", "tsk_2")
pop2_individuals &lt;- c("tsk_3", "tsk_4", "tsk_5")
total_sequence_length &lt;- 999299  # Total length of the sequence
# Batch mode example
dxy_value &lt;- Dxy(vcf_file, pop1_individuals, pop2_individuals, total_sequence_length)
# Window mode example
dxy_windows &lt;- Dxy(vcf_file, pop1_individuals, pop2_individuals, seq_length = total_sequence_length,
                   window_size = 100000, skip_size = 50000)

</code></pre>


</div>