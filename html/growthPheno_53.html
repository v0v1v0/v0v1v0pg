<div class="container">

<table style="width: 100%;"><tr>
<td>plotSmoothsDevnBoxplots</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produces boxplots for several sets of deviations of the smoothed values from a response, possibly along with growth rates.</h2>

<h3>Description</h3>

<p> Calculates and produces, using <code>plotDeviationsBoxes</code>, boxplots 
of the deviations of the supplied smoothed values from the observed response values for the 
traits and for combinations of the different smoothing parameters and for subsets of 
non-smoothing-<code>factor</code> combinations. Which traits are plotted is controlled by  
<code>trait.types</code> and may include the (<code>response</code>and the computed traits of the 
Absolute Growth Rates (AGR) and/or the Relative Growth Rates (RGR). The observed and smoothed 
values are supplied in long format i.e. with the values for each set of smoothing parameters  
stacked one under the other in the supplied <code>smooths.frame</code>. Such data can be 
generated using <code>probeSmooths</code>.
</p>
<p>Multiple plots, possibly each having multiple facets, are produced using <code>ggplot2</code>. 
The layout of these plots is controlled via the arguments <code>plots.by</code>, 
<code>facet.x</code> and <code>facet.y</code>. The basic principle is that the number of levels 
combinations of the smoothing-parameter <code>factor</code>s <code>Type</code>, <code>TunePar</code>, 
<code>TuneVal</code>, <code>Tuning</code> (the combination of (<code>TunePar</code> and <code>TuneVal</code>), and 
<code>Method</code> that are included  in <code>plots.by</code>, <code>facet.x</code> and <code>facet.y</code> 
must be the same as those covered by the combinations of the values incorporated 
into the <code>smooths.frame</code> input to <code>plotSmoothsDevnBoxplots</code> via the 
<code>data</code> argument. This ensures that smooths from different parameter sets are not 
pooled into the same plot. The <code>factor</code>s other than the smoothing-parameter 
<code>factor</code>s can be supplied to the <code>plots.by</code> and <code>facet</code> arguments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSmoothsDevnBoxplots(data, response, response.smoothed = NULL, 
                        individuals = "Snapshot.ID.Tag", times = "DAP", 
                        trait.types = c("response", "AGR", "RGR"), 
                        which.plots =  "absolute.boxplots", 
                        x.title = NULL, y.titles = NULL, 
                        devnboxes.plot.args = 
                          args4devnboxes_plot(plots.by = NULL, 
                                              facet.x = ".", facet.y = "."),
                        printPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>smooths.frame</code>, such as is produced by 
<code>probeSmooths</code> and that contains the data resulting from 
smoothing a response over time for a set of <code>individuals</code>, the data 
being arranged in long format both with respect to the 
times and the smoothing-parameter values used in the smoothing. That is, 
each response occupies a single column. The unsmoothed <code>response</code> and 
the <code>response.smoothed</code> are to be plotted for different sets of values 
for the smoothing parameters. The <code>smooths.frame</code> must include 
the columns <code>Type</code>, <code>TunePar</code>, <code>TuneVal</code>, <code>Tuning</code> and 
<code>Method</code>, and the columns nominated using the arguments 
<code>individuals</code>, <code>times</code>, <code>plots.by</code>, <code>facet.x</code>, <code>facet.y</code>, 
<code>response</code>, <code>response.smoothed</code>, and, if requested, 
the AGR and the RGR of the <code>response</code> and <code>response.smoothed</code>. 
The names of the growth rates should be formed from <code>response</code> and 
<code>response.smoothed</code> by adding <code>.AGR</code> and <code>.RGR</code> to both of them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A <code>character</code> specifying the response variable for which the 
observed values are supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response.smoothed</code></td>
<td>
<p>A <code>character</code> specifying the name of the column 
containing the values of the smoothed response variable, corresponding 
to <code>response</code> and obtained for the combinations of 
<code>smoothing.methods</code> and <code>df</code>, usually using smoothing splines. 
If <code>response.smoothed</code> is <code>NULL</code>, then 
<code>response.smoothed</code> is set to the <code>response</code> to which is added 
the prefix <code>s</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>A <code>character</code> giving the name of the column in 
<code>data</code> containing the times at which the data was 
collected, either as a <code>numeric</code>, <code>factor</code>, or 
<code>character</code>. It will be used to provide the values to be plotted 
on the x-axis. If a <code>factor</code> or <code>character</code>, 
the values should be numerics stored as characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>individuals</code></td>
<td>
<p>A <code>character</code> giving the name of the 
<code>factor</code> that defines the subsets of the <code>data</code> 
for which each subset corresponds to the <code>response</code> values for 
an individual (e.g. plant, pot, cart, plot or unit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.types</code></td>
<td>
<p>A <code>character</code> giving the <code>trait.types</code> that 
are to be plotted. If <code>all</code>, each of <code>response</code>, <code>AGR</code> and 
<code>RGR</code> is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.plots</code></td>
<td>
<p>A <code>logical</code> indicating which plots are to be produced. 
The options are either <code>none</code> or <code>absolute.deviations</code> and/or 
<code>relative.deviations</code>. Boxplots of the absolute deviations 
are specified by <code>absolute.boxplots</code>, the absolute deviations being 
the values of a trait minus their smoothed values (observed - smoothed). 
Boxplots of the relative deviations are specified by <code>relative.boxplots</code>, 
the relative deviations being the absolute deviations divided by the 
smoothed values of the trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.title</code></td>
<td>
<p>Title for the x-axis, used for all plots. If <code>NULL</code> then set to 
<code>times</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.titles</code></td>
<td>
<p>A <code>character</code> giving the titles for the y-axis, 
one for each trait specified by <code>trait.types</code> and used for all plots. 
If <code>NULL</code>, then set to the traits derived for <code>response</code> 
from <code>trait.types</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>devnboxes.plot.args</code></td>
<td>
<p>A named <code>list</code> that is most easily 
generated using <code>args4devnboxes_plot</code>, it documenting the 
options available for varying the boxplots. <em>Note 
that if <code>args4devnboxes_plot</code> is to be called to change 
from the default settings given in the default <code>probeSmooths</code> 
call and some of those settings are to be retained, then the arguments 
whose settings are to be retained must also be included in the call 
to <code>args4devnboxes_plot</code>; be aware that if you call 
<code>args4devnboxes_plot</code>, then the defaults for this call 
are those for <code>args4devnboxes_plot</code>, <b>NOT</b> the call 
to <code>args4devnboxes_plot</code> shown as the default for 
<code>probeSmooths</code>.</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printPlot</code></td>
<td>
<p>A <code>logical</code> indicating whether or not to print any 
plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>allows passing of arguments to <code>plotProfiles</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A multilevel <code>list</code> that contains the <code>ggplot</code> 
objects for the plots produced. The first-level <code>list</code> 
has a component for each <code>trait.types</code> and each of these is a 
second-level <code>list</code> with contains the deviations boxplots 
for a <code>response</code>. Each plot is in an object of class 
<code>ggplot</code>, which can be plotted using <code>print</code>. 
</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code>traitSmooth</code>, <code>probeSmooths</code>, <code>args4profile_plot</code>, <code>plotDeviationsBoxes</code>, <code>plotSmoothsMedianDevns</code>, <code>ggplot</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(exampleData)
traits &lt;- probeSmooths(data = longi.dat, 
                       response = "PSA", response.smoothed = "sPSA", 
                       times = "DAP", 
                       #only df is changed from the probeSmooth default
                       smoothing.args = 
                         args4smoothing(smoothing.methods = "direct", 
                                        spline.types = "NCSS", 
                                        df = c(4,7), lambdas = NULL), 
                       which.plots = "none")
plotSmoothsDevnBoxplots(data = traits, 
                        response = "PSA", response.smoothed = "sPSA", 
                        times = "DAP", x.title = "DAP",
                        #only facet.x is changed from the probeSmooth default
                        devnboxes.plot.args = 
                          args4devnboxes_plot(plots.by = NULL, 
                                              facet.x = "Tuning", facet.y = "."))
</code></pre>


</div>