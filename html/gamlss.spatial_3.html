<div class="container">

<table style="width: 100%;"><tr>
<td>gamlss.gmrf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gaussian Markov Random Field fitting within GAMLSS 
</h2>

<h3>Description</h3>

<p>The function <code>gmrf()</code> can be used to fit Markov Random Field additive terms within GAMLSS. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">gamlss.gmrf(x, y, w, xeval = NULL, ...)
gmrf(x, precision = NULL, neighbour = NULL, polys = NULL,
                 area = NULL, adj.weight = 1000, df = NULL, lambda =
                 NULL, start = 10, method = c("Q", "A"), control =
                 gmrf.control(...), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a factor containing the areas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>the precision matrix if set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighbour</code></td>
<td>
<p>an object containing the neighbour information for the area if set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polys</code></td>
<td>
<p>the polygon information if set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>this argument is here to allow more areas than the levels of the factor <code>x</code>, see example below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.weight</code></td>
<td>
<p>a value to adjust the iterative weight if necessary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom for fitting if required, only for <code>method="A"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The smoothing parameter <code>lambda</code> if known, only for <code>method="A"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting value for the smoothing parameter <code>lambda</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>"Q" for Q-function, or "A" for alternating method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>working response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>iterative weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xeval</code></td>
<td>
<p>whether to predict or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>to be use for some of the argument of <code>MRF()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>gmrf()</code> is to support  the function <code>MRF()</code> and <code>MRFA()</code> within GAMLSS. 
It is intended to be called within a GAMLSS formula. The function <code>gmrf()</code> is not intended to be used directly. It is calling the  function <code>MRFA()</code> and <code>MRF()</code> within the GAMLSS fitting algorithm.
The results using the option <code>method="Q"</code> or <code>method="A"</code> should produce identical results.
</p>


<h3>Value</h3>

<p>a fitted gamlss object
</p>


<h3>Author(s)</h3>

<p>Fernanda De Bastiani, Mikis Stasinopoulos, Robert Rigby and Vlasios Voudouris. 
</p>
<p>Maintainer: Fernanda &lt;fernandadebastiani@gmail.com&gt;
</p>


<h3>References</h3>

<p>De Bastiani, F. Rigby, R. A., Stasinopoulos, D. M.,  Cysneiros, A. H. M. A. and Uribe-Opazo, M. A. (2016) Gaussian Markov random spatial models in GAMLSS. <em>Journal of Applied Statistics</em>, pp 1-19.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Rue and Held (2005) <em>Gaussian markov random fields: theory and applications</em>, Chapman  &amp; Hall, USA. 
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code>MRF</code>, <code>MRFA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(gamlss)
library(mgcv)
data(columb)
data(columb.polys)
vizinhos=polys2nb(columb.polys)
precisionC &lt;- nb2prec(vizinhos,x=columb$district)
# MRFA
 m1&lt;- gamlss(crime~ gmrf(district, polys=columb.polys, method="Q"), data=columb)
 m2&lt;- gamlss(crime~ gmrf(district, polys=columb.polys, method="A"), data=columb)
AIC(m1,m2, k=0)
draw.polys(columb.polys, getSmo(m2), scheme="topo")
</code></pre>


</div>