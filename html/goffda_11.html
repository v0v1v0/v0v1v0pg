<div class="container">

<table style="width: 100%;"><tr>
<td>flm_term</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functional linear model term with bivariate kernel</h2>

<h3>Description</h3>

<p>Computation of the functional linear term
</p>
<p style="text-align: center;"><code class="reqn">\int_a^b \beta(s, t) X(s)\,\mathrm{d}s,</code>
</p>

<p>of a Functional Linear Model with Functional Response (FLMFR), where
<code class="reqn">X</code> is a random variable in the Hilbert space of
square-integrable functions in <code class="reqn">[a, b]</code>, <code class="reqn">L^2([a, b])</code>,
<code class="reqn">\beta</code> is the bivariate kernel of the FLMFR, and
<code class="reqn">\varepsilon</code> is a random variable in <code class="reqn">L^2([c, d])</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flm_term(X_fdata, beta, t, int_rule = "trapezoid", equispaced = NULL,
  concurrent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X_fdata</code></td>
<td>
<p>sample of functional data as an
<code>fdata</code> object of length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>matrix containing the values  <code class="reqn">\beta(s, t)</code>,
for each grid point <code class="reqn">s</code> in  <code class="reqn">[a, b]</code> and <code class="reqn">t</code> in <code class="reqn">[c, d]</code>. If
<code>concurrent = TRUE</code>, a row/column vector must be introduced, valued in
the same grid as <code>error_fdata</code>, with the same length as
<code>length(X_fdata$argvals)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>grid points where responses are valued.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_rule</code></td>
<td>
<p>quadrature rule for approximating the definite
unidimensional integral: trapezoidal rule (<code>int_rule = "trapezoid"</code>)
and extended Simpson rule (<code>int_rule = "Simpson"</code>) are available.
Defaults to <code>"trapezoid"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equispaced</code></td>
<td>
<p>flag to indicate if <code>X_fdata$data</code> is valued in
an equispaced grid or not. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concurrent</code></td>
<td>
<p>flag to consider a concurrent FLMFR (degenerate case).
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Functional linear model term as the integral (in <code>s</code>) between
<code>X_fdata</code> and <code>beta</code>, as an <code>fdata</code> object of
length <code>n</code>.
</p>


<h3>Author(s)</h3>

<p>Javier Álvarez-Liébana.
</p>


<h3>References</h3>

<p>García-Portugués, E., Álvarez-Liébana, J., Álvarez-Pérez, G. and
Gonzalez-Manteiga, W. (2021). A goodness-of-fit test for the functional
linear model with functional response. <em>Scandinavian Journal of
Statistics</em>, 48(2):502–528. <a href="https://doi.org/10.1111/sjos.12486">doi:10.1111/sjos.12486</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate a sample of functional responses via FLMFR

# Bivariate kernel beta(s,t) as an egg carton shape
s &lt;- seq(0, 1, l = 101)
t &lt;- seq(0, 1, l = 201)
beta &lt;- outer(s, t, FUN = function(s, t) sin(6 * pi * s) + cos(6 * pi * t))

# Functional data as zero-mean Gaussian process with exponential variogram
X_fdata &lt;- fda.usc::rproc2fdata(n = 50, t = s, sigma = "vexponential",
                                list = list(scale = 2.5))

# Functional error as an OU process with variance 0.075
sigma &lt;- sqrt(0.075) * 2
error_fdata &lt;- r_ou(n = 50, t = t, sigma = sigma)
Y_fdata &lt;- flm_term(X_fdata = X_fdata, beta = beta, t = t) + error_fdata
plot(Y_fdata)

## Generate a sample of functional responses via concurrent model

# Function beta(t)
s &lt;- seq(1, 3, l = 201)
t &lt;- seq(2, 5, l = 201)
beta &lt;- sin(pi * t) + cos(pi * t)

# Functional data as zero-mean Gaussian process with exponential variogram
X_fdata &lt;- fda.usc::rproc2fdata(n = 50, t = s, sigma = "vexponential",
                                list = list(scale = 2.5))

# Functional error as an OU process with variance 0.075
sigma &lt;- sqrt(0.075) * 2
error_fdata &lt;- r_ou(n = 50, t = t, sigma = sigma)
Y_fdata &lt;- flm_term(X_fdata = X_fdata, beta = beta, t = t,
                    concurrent = TRUE) + error_fdata
plot(Y_fdata)
</code></pre>


</div>