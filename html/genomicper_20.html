<div class="container">

<table style="width: 100%;"><tr>
<td>snps_permutation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
SNP-level permutations
</h2>

<h3>Description</h3>

<p>Performs SNP-level circular genomic permutations. In each permutation,<br> 
the complete set of SNP association p-values are permuted by rotation<br>
with respect to the SNPs' genomic locations.<br>
Once these 'simulated' p-values are assigned,the proportion of SNPs per<br>
set above a pre-defined threshold is calculated
</p>


<h3>Usage</h3>

<pre><code class="language-R">snps_permutation(ordered_alldata = "", pers_ids = "", ntraits = "", 
nper = 100, threshold = 0.05, seed=10,saveto = "workspace", 
gs_locs = "",envir ="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ordered_alldata</code></td>
<td>

<p>Return variable from "genome_order". Ordered genome and trait p-values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gs_locs</code></td>
<td>

<p>Return variable from "genome_order". SNP indexes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pers_ids</code></td>
<td>

<p>Return variable "per_ors" from "read2_paths". SNP indexes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits</code></td>
<td>

<p>Traits INDEX to be analysed. Index according to "ordered_alldata". <br>
Trait Columns index must start at 7. Example: ntraits=c(7:9), ntraits=7
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nper</code></td>
<td>

<p>Number of permutations.Example: nper=1000
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>

<p>Threshold to be set by the hypergeometric test. threshold=0.05
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Set number for random sampling
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveto</code></td>
<td>

<p>Save permutation results to "workspace" OR "directory"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>

<p>R environment to save the Permutations to when saveto is set to "workspace"
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns "Permus_genesetsname" variables or files (permutation datasets). 
</p>


<h3>See Also</h3>

<p><code>genes_permutation</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(demo,SNPsAnnotation)
all_data &lt;- read_pvals(data_name=demo,snps_ann=SNPsAnnotation)
genome_results &lt;-genome_order(all_data=all_data)
	# Results from genome_order
	ordered_alldata &lt;- genome_results$ordered_alldata
	gs_locs &lt;- genome_results$gs_locs

# Create new environment to save the permutations to:
gper.env &lt;- new.env()

data(RHSA164843,RHSA446343,RHSA8876384,RHSA8964572,RHSA109582,RHSA1474244,envir=gper.env)

paths_res &lt;- read2_paths(ordered_alldata=ordered_alldata,gs_locs=gs_locs,
sets_from="workspace",sets_prefix="RHSA",level="snp",envir=gper.env)
		pers_ids &lt;- paths_res$per_ors
		pathways&lt;- paths_res$pathways

		
# SNP permutations
snps_permutation(ordered_alldata=ordered_alldata,pers_ids=pers_ids,
ntraits=c(7,9),nper=10,saveto="workspace",threshold=0.05,
gs_locs=gs_locs,envir = gper.env)

# Get results						
results &lt;- get_results(res_pattern="Permus",level="snp",
from="workspace",threshold=0.05,envir = gper.env)

</code></pre>


</div>