<div class="container">

<table style="width: 100%;"><tr>
<td>gar_service_provision</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Provision a service account</h2>

<h3>Description</h3>

<p>This uses all the gar_service_create functions to enable creating service account roles more easily
</p>


<h3>Usage</h3>

<pre><code class="language-R">gar_service_provision(
  accountId,
  roles,
  json = Sys.getenv("GAR_CLIENT_JSON"),
  file = paste0(accountId, "-auth-key.json"),
  email = Sys.getenv("GARGLE_EMAIL")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>accountId</code></td>
<td>
<p>The service accountId</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roles</code></td>
<td>
<p>A character vector of roles to give the accountIds e.g. <code>roles/editor</code> - see list of roles here <a href="https://cloud.google.com/iam/docs/understanding-roles#predefined_roles">https://cloud.google.com/iam/docs/understanding-roles#predefined_roles</a> or in your GCP console <code>https://console.cloud.google.com/iam-admin/roles/details/roles</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>json</code></td>
<td>
<p>The file location of an OAuth 2.0 client ID json file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>The file to download the private JSON key to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>email</code></td>
<td>
<p>An existing gargle cached email to authenticate with or TRUE to authenticate with the only email available.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>You will need the OAuth2.0 Client ID JSON from your GCP project via 
<code>menu icon &gt; APIs &amp; Services &gt; Credentials &gt; Create Credentials &gt; OAuth client ID</code>
</p>
<p>You need to authenticate with a user with permission <code>iam.serviceAccounts.create</code> for the project.  Most often the user is an Owner/Editor
</p>


<h3>See Also</h3>

<p><a href="https://cloud.google.com/iam/docs/creating-managing-service-accounts#iam-service-accounts-create-rest">https://cloud.google.com/iam/docs/creating-managing-service-accounts#iam-service-accounts-create-rest</a>
</p>
<p>Other IAM functions: 
<code>gar_service_create()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

gar_service_provision("my-service-account", 
                      c("roles/viewer", "roles/bigquery.jobUser"))

## End(Not run)
</code></pre>


</div>