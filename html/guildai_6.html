<div class="container">

<table style="width: 100%;"><tr>
<td>guild_run_cli</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>guild_run_cli
Run an operation.</h2>

<h3>Description</h3>

<p>By default Guild tries to run <code>OPERATION</code> for the default model
defined in the current project.
</p>


<h3>Usage</h3>

<pre><code class="language-R">guild_run_cli(
  ...,
  label = NULL,
  tag = NULL,
  comment = NULL,
  run_dir = NULL,
  stage = NA,
  start = NULL,
  restart = NULL,
  proto = NULL,
  force_sourcecode = NA,
  gpus = NULL,
  no_gpus = NA,
  batch_label = NULL,
  batch_tag = NULL,
  batch_comment = NULL,
  optimizer = NULL,
  optimize = NA,
  minimize = NULL,
  maximize = NULL,
  opt_flag = NULL,
  max_trials = NULL,
  trials = NULL,
  stage_trials = NA,
  remote = NULL,
  force_flags = NA,
  force_deps = NA,
  stop_after = NULL,
  fail_on_trial_error = NA,
  needed = NA,
  background = NA,
  pidfile = NULL,
  no_wait = NA,
  save_trials = NULL,
  keep_run = NA,
  keep_batch = NA,
  dep = NULL,
  quiet = NA,
  print_cmd = NA,
  print_env = NA,
  print_trials = NA,
  help_model = NA,
  help_op = NA,
  test_output_scalars = NULL,
  test_sourcecode = NA,
  test_flags = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed on to the <code>guild</code> executable. Arguments are automatically quoted with <code>shQuote()</code>, unless they are protected with <code>I()</code>. Pass <code>'--help'</code> or <code>help = TRUE</code> to see all options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>Set a label for the run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag</code></td>
<td>
<p>Associate TAG with run. May be used multiple times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comment</code></td>
<td>
<p>Comment associated with the run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_dir</code></td>
<td>
<p>Use alternative run directory DIR. Cannot be used with <code>stage</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage</code></td>
<td>
<p>(bool) Stage an operation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Start a staged run or restart an existing run. Cannot be used with <code>proto</code> or <code>run_dir</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restart</code></td>
<td>
<p>Start a staged run or restart an existing run. Cannot be used with <code>proto</code> or <code>run_dir</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proto</code></td>
<td>
<p>Use the operation, flags and source code from RUN. Flags may be added or redefined in this operation. Cannot be used with <code>restart</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_sourcecode</code></td>
<td>
<p>(bool) Use working source code when <code>restart</code> or <code>proto</code> is specified. Ignored otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpus</code></td>
<td>
<p>Limit availabe GPUs to DEVICES, a comma separated list of device IDs. By default all GPUs are available. Cannot beused with <code>no_gpus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_gpus</code></td>
<td>
<p>(bool) Disable GPUs for run. Cannot be used with <code>gpus</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_label</code></td>
<td>
<p>Label to use for batch runs. Ignored for non-batch runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_tag</code></td>
<td>
<p>Associate TAG with batch. Ignored for non-batch runs. May be used multiple times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_comment</code></td>
<td>
<p>Comment associated with batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>Optimize the run using the specified algorithm. See Optimizing Runs for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimize</code></td>
<td>
<p>(bool) Optimize the run using the default optimizer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimize</code></td>
<td>
<p>Column to minimize when running with an optimizer. See help for compare command for details specifying a column. May not be used with <code>maximize</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximize</code></td>
<td>
<p>Column to maximize when running with an optimizer. See help for compare command for details specifying a column. May not be used with <code>minimize</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt_flag</code></td>
<td>
<p>Flag for OPTIMIZER. May be used multiple times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_trials</code></td>
<td>
<p>Maximum number of trials to run in batch operations. Default is optimizer specific. If optimizer is not specified, default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trials</code></td>
<td>
<p>Maximum number of trials to run in batch operations. Default is optimizer specific. If optimizer is not specified, default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage_trials</code></td>
<td>
<p>(bool) For batch operations, stage trials without running them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remote</code></td>
<td>
<p>Run the operation remotely.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_flags</code></td>
<td>
<p>(bool) Accept all flag assignments, even for undefined or invalid values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_deps</code></td>
<td>
<p>(bool) Continue even when a required resource is not resolved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_after</code></td>
<td>
<p>Stop operation after N minutes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail_on_trial_error</code></td>
<td>
<p>(bool) Stop batch operations when a trial exits with an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>needed</code></td>
<td>
<p>(bool) Run only if there is not an available matching run. A matching run is of the same operation with the same flag values that is not stopped due to an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>(bool) Run operation in background.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pidfile</code></td>
<td>
<p>Run operation in background, writing the background process ID to PIDFILE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_wait</code></td>
<td>
<p>(bool) Don't wait for a remote operation to complete. Ignored if run is local.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_trials</code></td>
<td>
<p>Saves generated trials to a CSV batch file. See BATCH FILES for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_run</code></td>
<td>
<p>(bool) Keep run even when configured with 'delete-on-success'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_batch</code></td>
<td>
<p>(bool) Keep batch run rather than delete it on success.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep</code></td>
<td>
<p>Include PATH as a dependency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>(bool) Do not show output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_cmd</code></td>
<td>
<p>(bool) Show operation command and exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_env</code></td>
<td>
<p>(bool) Show operation environment and exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_trials</code></td>
<td>
<p>(bool) Show generated trials and exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>help_model</code></td>
<td>
<p>(bool) Show model help and exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>help_op</code></td>
<td>
<p>(bool) Show operation help and exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_output_scalars</code></td>
<td>
<p>Test output scalars on output. Use '-' to read from standard intput.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_sourcecode</code></td>
<td>
<p>(bool) Test source code selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_flags</code></td>
<td>
<p>(bool) Test flag configuration.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>MODEL</code> is specified, Guild uses it instead of the default
model.
</p>
<p><code>OPERATION</code> may alternatively be a Python script. In this case any
current project is ignored and the script is run directly. Options
in the format <code>--NAME=VAL</code> can be passed to the script using
flags (see below).
</p>
<p><code style="white-space: pre;">⁠[MODEL]:OPERATION⁠</code> may be omitted if <code>restart</code> or <code>proto</code> is
specified, in which case the operation used in <code>RUN</code> is used.
</p>
<p>Specify <code>FLAG</code> values in the form <code>FLAG=VAL</code>.
</p>


<h4>Batch Files</h4>

<p>One or more batch files can be used to run multiple trials by
specifying the file path as <code style="white-space: pre;">⁠@PATH⁠</code>.
</p>
<p>For example, to run trials specified in a CSV file named
<code>trials.csv</code>, run:
</p>
<div class="sourceCode"><pre>guild run [MODEL:]OPERATION @trials.csv
</pre></div>
<p>NOTE: At this time you must specify the operation with batch files
</p>

<ul><li>
<p> batch files only contain flag values and cannot be used to run
different operations for the same command.
</p>
</li></ul>
<p>Batch files may be formatted as CSV, JSON, or YAML. Format is
determined by the file extension.
</p>
<p>Each entry in the file is used as a set of flags for a trial run.
</p>
<p>CSV files must have a header row containing the flag names. Each
subsequent row is a corresponding list of flag values that Guild
uses for a generated trial.
</p>
<p>JSON and YAML files must contain a top-level list of flag-to-value
maps.
</p>
<p>Use <code>print_trials</code> to preview the trials run for the specified
batch files.
</p>



<h4>Flag Lists</h4>

<p>A list of flag values may be specified using the syntax
<code style="white-space: pre;">⁠[VAL1[,VAL2]...]⁠</code>. Lists containing white space must be
quoted. When a list of values is provided, Guild generates a trial
run for each value. When multiple flags have list values, Guild
generates the cartesian product of all possible flag combinations.
</p>
<p>Flag lists may be used to perform grid search operations.
</p>
<p>For example, the following generates four runs for operation
<code>train</code> and flags <code>learning-rate</code> and <code>batch-size</code>:
</p>
<div class="sourceCode"><pre>guild run train learning-rate[0.01,0.1] batch-size=[10,100]
</pre></div>
<p>You can preview the trials generated from flag lists using
<code>print_trials</code>. You can save the generated trials to a batch
file using <code>save_trials</code>. For more information, see PREVIEWING
AND SAVING TRIALS below.
</p>
<p>When <code>optimizer</code> is specified, flag lists may take on different
meaning depending on the type of optimizer. For example, the
<code>random</code> optimizer randomly selects values from a flag list,
rather than generate trials for each value. See OPTIMIZERS for
more information.
</p>



<h4>Optimizers</h4>

<p>A run may be optimized using <code>optimizer</code>. An optimizer runs up
to <code>max_trials</code> runs using flag values and flag configuration.
</p>
<p>For details on available optimizers and their behavior, refer to
https://guild.ai/optimizers/.
</p>



<h4>Limit Trials</h4>

<p>When using flag lists or optimizers, which generate trials, you
can limit the number of trials with <code>max_trials</code>. By default,
Guild limits the number of generated trials to 20.
</p>
<p>Guild limits trials by randomly sampling the maximum number from
the total list of generated files. You can specify the seed used
for the random sample with <code>random_seed</code>. The random seed is
guaranteed to generate consistent results when used on the same
version of Python. When used across different versions of Python,
the results may be inconsistent.
</p>



<h4>Preview or Save Trials</h4>

<p>When flag lists (used for grid search) or an optimizer is used,
you can preview the generated trials using <code>print_trials</code>. You
can save the generated trials as a CSV batch file using
<code>save_trials</code>.
</p>



<h4>Start an Operation Using a Prototype Run</h4>

<p>If <code>proto</code> is specified, Guild applies the operation, flags, and
source code used in <code>RUN</code> to the new operation. You may add or
redefine flags in the new operation. You may use an alternative
operation, in which case only the flag values and source code from
<code>RUN</code> are applied. <code>RUN</code> must be a run ID or unique run ID prefix.
</p>



<h4>Restart an Operation</h4>

<p>If <code>restart</code> is specified, <code>RUN</code> is restarted using its
operation and flags. Unlike <code>proto</code>, restart does not create a
new run. You cannot change the operation, flags, source code, or
run directory when restarting a run.
</p>



<h4>Staging an Operation</h4>

<p>Use <code>stage</code> to stage an operation to be run later. Use <code>start</code>
with the staged run ID to start it.
</p>
<p>If <code>start</code> is specified, <code>RUN</code> is started using the same rules
applied to <code>restart</code> (see above).
</p>



<h4>Alternate Run Directory</h4>

<p>To run an operation outside of Guild's run management facility,
use <code>run_dir</code> or <code>stage-dir</code> to specify an alternative run
directory. These options are useful when developing or debugging
an operation. Use <code>stage-dir</code> to prepare a run directory for an
operation without running the operation itself. This is useful
when you want to verify run directory layout or manually run an
operation in a prepared directory.
</p>
<p><strong>NOTE:</strong> Runs started with <code>run_dir</code> are not visible to Guild
and do not appear in run listings.
</p>



<h4>Control Visible GPUs</h4>

<p>By default, operations have access to all available GPU
devices. To limit the GPU devices available to a run, use
<code>gpus</code>.
</p>
<p>For example, to limit visible GPU devices to <code>0</code> and <code>1</code>, run:
</p>
<div class="sourceCode"><pre>guild run gpus 0,1 ...
</pre></div>
<p>To disable all available GPUs, use <code>no_gpus</code>.
</p>
<p><strong>NOTE:</strong> <code>gpus</code> and <code>no_gpus</code> are used to construct the
<code>CUDA_VISIBLE_DEVICES</code> environment variable used for the run
process. If <code>CUDA_VISIBLE_DEVICES</code> is set, using either of these
options redefines that environment variable for the run.
</p>



<h4>Optimize Runs</h4>

<p>Use <code>optimizer</code> to run the operation multiple times in attempt
to optimize a result. Use <code>minimize</code> or <code>maximize</code> to indicate
what should be optimized. Use <code>--max-runs</code> to indicate the maximum
number of runs the optimizer should generate.
</p>



<h4>Edit Flags</h4>

<p>Use <code>edit_flags</code> to use an editor to review and modify flag
values. Guild uses the editor defined in <code>VISUAL</code> or <code>EDITOR</code>
environment variables. If neither environment variable is defined,
Guild uses an editor suitable for the current platform.
</p>



<h4>Debug Source Code</h4>

<p>Use <code>debug_sourcecode</code> to specify the location of project source
code for debugging. Guild uses this path instead of the location
of the copied soure code for the run. For example, when debugging
project files, use this option to ensure that modules are loaded
from the project location rather than the run directory.
</p>



<h4>Breakpoints</h4>

<p>Use <code>break</code> to set breakpoints for Python based operations.
<code>LOCATION</code> may be specified as <code style="white-space: pre;">⁠[FILENAME:]LINE⁠</code> or as
<code>MODULE.FUNCTION</code>.
</p>
<p>If <code>FILENAME</code> is not specified, the main module is assumed. Use
the value <code>1</code> to break at the start of the main module (line 1).
</p>
<p>Relative file names are resolved relative to the their location in
the Python system path. You can omit the <code>.py</code> extension.
</p>
<p>If a line number does not correspond to a valid breakpoint, Guild
attempts to set a breakpoint on the next valid breakpoint line in
the applicable module.
</p>



</div>