<div class="container">

<table style="width: 100%;"><tr>
<td>ghyp-distribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Generalized Hyperbolic Distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, expected-shortfall
and random generation for the univariate and multivariate generalized
hyperbolic distribution and its special cases.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dghyp(x, object = ghyp(), logvalue = FALSE)

pghyp(q, object = ghyp(), n.sim = 10000, subdivisions = 200,
      rel.tol = .Machine$double.eps^0.5, abs.tol = rel.tol,
      lower.tail = TRUE)

qghyp(p, object = ghyp(), method = c("integration", "splines"),
      spline.points = 200, subdivisions = 200,
      root.tol = .Machine$double.eps^0.5,
      rel.tol = root.tol^1.5, abs.tol = rel.tol)

rghyp(n, object = ghyp())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector, matrix or data.frame of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A vector, matrix or data.frame of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object inheriting from class <code>ghyp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logvalue</code></td>
<td>
<p>If <code>TRUE</code> the logarithm of the density will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>The number of simulations when computing <code>pghyp</code> of a multivariate
generalized hyperbolic distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdivisions</code></td>
<td>
<p>The number of subdivisions passed to <code>integrate</code> when
computing the distribution function <code>pghyp</code> of a
univariate generalized hyperbolic distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol</code></td>
<td>
<p>The relative accuracy requested from  <code>integrate</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.tol</code></td>
<td>
<p>The absolute accuracy requested from  <code>integrate</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>If TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method how quantiles are computed (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline.points</code></td>
<td>
<p>The number of support points when computing the quantiles with the method
“splines” instead of “integration”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.tol</code></td>
<td>
<p>The tolerance of <code>uniroot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>qghyp</code> only works for univariate generalized hyperbolic
distributions. <br></p>
<p><code>pghyp</code> performs a numeric integration of the density in the
univariate case. The multivariate cumulative distribution is computed
by means of monte carlo simulation. <br></p>
<p><code>qghyp</code> computes the quantiles either by using the
“integration” method where the root of the distribution
function is solved or via “splines” which interpolates the
distribution function and solves it with <code>uniroot</code>
afterwards. The “integration” method is recommended when only
few quantiles are required. If more than approximately 20 quantiles
are needed to be calculated the “splines” method becomes
faster.  The accuracy can be controlled with an adequate setting of
the parameters <code>rel.tol</code>, <code>abs.tol</code>, <code>root.tol</code> and
<code>spline.points</code>.<br></p>
<p><code>rghyp</code> uses the random generator for generalized inverse
Gaussian distributed random variates from the Rmetrics package
<em>fBasics</em> (cf. <code>rgig</code>).
</p>


<h3>Value</h3>

<p><code>dghyp</code> gives the density, <br><code>pghyp</code> gives the distribution function, <br><code>qghyp</code> gives the quantile function, <br><code>rghyp</code> generates random deviates.
</p>


<h3>Note</h3>

<p>Objects generated with <code>hyp</code>, <code>NIG</code>,
<code>VG</code> and <code>student.t</code> have to use <code>Xghyp</code>
as well. E.g. <code>dNIG(0, NIG())</code> does not work but <code>dghyp(0,
  NIG())</code>.<br></p>
<p>When the skewness becomes very large the functions using <code>qghyp</code>
may fail.  The functions <code>qqghyp</code>,
<code>pairs</code> and <code>portfolio.optimize</code>
are based on <code>qghyp</code>.
</p>


<h3>Author(s)</h3>

<p>David Luethi</p>


<h3>References</h3>

<p><code>ghyp</code>-package vignette in the <code>doc</code> folder or on
<a href="https://cran.r-project.org/package=ghyp">https://cran.r-project.org/package=ghyp</a> and references
therein.
</p>


<h3>See Also</h3>

<p><code>ghyp-class</code> definition, <code>ghyp</code> constructors,
fitting routines <code>fit.ghypuv</code> and <code>fit.ghypmv</code>,
risk and performance measurement <code>ESghyp</code> and <code>ghyp.omega</code>,
<code>transformation</code> and <code>subsettting</code> of <code>ghyp</code> objects,
<code>integrate</code>, <code>spline</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Univariate generalized hyperbolic distribution
  univariate.ghyp &lt;- ghyp()

  par(mfrow=c(5, 1))

  quantiles &lt;- seq(-4, 4, length = 500)
  plot(quantiles, dghyp(quantiles, univariate.ghyp))
  plot(quantiles, pghyp(quantiles, univariate.ghyp))

  probabilities &lt;- seq(1e-4, 1-1e-4, length = 500)
  plot(probabilities, qghyp(probabilities, univariate.ghyp, method = "splines"))

  hist(rghyp(n=10000,univariate.ghyp),nclass=100)

  ## Mutivariate generalized hyperbolic distribution
  multivariate.ghyp &lt;- ghyp(sigma=var(matrix(rnorm(10),ncol=2)),mu=1:2,gamma=-(2:1))

  par(mfrow=c(2, 1))

  quantiles &lt;- outer(seq(-4, 4, length = 50), c(1, 1))
  plot(quantiles[, 1], dghyp(quantiles, multivariate.ghyp))
  plot(quantiles[, 1], pghyp(quantiles, multivariate.ghyp, n.sim = 1000))

  rghyp(n = 10, multivariate.ghyp)
</code></pre>


</div>