<div class="container">

<table style="width: 100%;"><tr>
<td>phenoRegressor.BGLR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression using BGLR package</h2>

<h3>Description</h3>

<p>This is a wrapper around <code>BGLR</code>. As such, it won't work if BGLR package
is not installed.<br>
Genotypes are modeled using the specified <code>type</code>. If <code>type</code> is 'RKHS' (and only
in this case) the covariance/kinship matrix <code>covariances</code> is required, and it will be modeled
as matrix K in BGLR terms. In all other cases genotypes and covariances are put in the model
as X matrices.<br>
Extra covariates, if present, are modeled as FIXED effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phenoRegressor.BGLR(
  phenotypes,
  genotypes,
  covariances,
  extraCovariates,
  type = c("FIXED", "BRR", "BL", "BayesA", "BayesB", "BayesC", "RKHS"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phenotypes</code></td>
<td>
<p>phenotypes, a numeric array (n x 1), missing values are predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>SNP genotypes, one row per phenotype (n), one column per marker (m), values in 0/1/2 for
diploids or 0/1/2/...ploidy for polyploids. Can be NULL if <code>covariances</code> is present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariances</code></td>
<td>
<p>square matrix (n x n) of covariances. Can be NULL if <code>genotypes</code> is present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraCovariates</code></td>
<td>
<p>extra covariates set, one row per phenotype (n), one column per covariate (w).
If NULL no extra covariates are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character literal, one of the following: FIXED (Flat prior), BRR (Gaussian prior),
BL (Double-Exponential prior), BayesA (scaled-t prior),
BayesB (two component mixture prior with a point of mass at zero and a scaled-t slab),
BayesC (two component mixture prior with a point of mass at zero and a Gaussian slab)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra parameters are passed to <code>BGLR</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the following fields:
</p>

<ul>
<li> <p><code>predictions</code> : an array of (n) predicted phenotypes, with NAs filled and all other positions repredicted (useful for calculating residuals)
</p>
</li>
<li> <p><code>hyperparams</code> : empty, returned for compatibility
</p>
</li>
<li> <p><code>extradata</code>   : list with information on trained model, coming from <code>BGLR</code>
</p>
</li>
</ul>
<h3>See Also</h3>

<p>BGLR
</p>
<p>Other phenoRegressors: 
<code>phenoRegressor.RFR()</code>,
<code>phenoRegressor.SVR()</code>,
<code>phenoRegressor.dummy()</code>,
<code>phenoRegressor.rrBLUP()</code>,
<code>phenoregressor.BGLR.multikinships()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#using the GROAN.KI dataset, we regress on the dataset and predict the first ten phenotypes
phenos = GROAN.KI$yield
phenos[1:10]  = NA

#calling the regressor with Bayesian Lasso
results = phenoRegressor.BGLR(
  phenotypes = phenos,
  genotypes = GROAN.KI$SNPs,
  covariances = NULL,
  extraCovariates = NULL,
  type = 'BL', nIter = 2000 #BGLR-specific parameters
)

#examining the predictions
plot(GROAN.KI$yield, results$predictions,
     main = 'Train set (black) and test set (red) regressions',
     xlab = 'Original phenotypes', ylab = 'Predicted phenotypes')
points(GROAN.KI$yield[1:10], results$predictions[1:10], pch=16, col='red')

#printing correlations
test.set.correlation  = cor(GROAN.KI$yield[1:10], results$predictions[1:10])
train.set.correlation = cor(GROAN.KI$yield[-(1:10)], results$predictions[-(1:10)])
writeLines(paste(
  'test-set correlation :', test.set.correlation,
  '\ntrain-set correlation:', train.set.correlation
))

## End(Not run)
</code></pre>


</div>