<div class="container">

<table style="width: 100%;"><tr>
<td>GUniFrac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generalized UniFrac distances for comparing microbial communities.
</h2>

<h3>Description</h3>

<p>A generalized version of commonly used UniFrac distances. It is defined as:
</p>
<p style="text-align: center;"><code class="reqn">d^{(\alpha)} = \frac{\sum_{i=1}^m b_i (p^A_{i} + p^B_{i})^\alpha 
\left\vert \frac{ p^A_{i} - p^B_{i} }{p^A_{i} + p^B_{i}} \right\vert } { 
 \sum_{i=1}^m b_i (p^A_{i} + p^B_{i})^\alpha},</code>
</p>

<p>where <code class="reqn">m</code> is the number of branches, <code class="reqn">b_i</code> is the length of 
<code class="reqn">i</code>th branch, <code class="reqn">p^A_{i}, p^B_{i}</code> are the branch
proportion for community A and B. 
</p>
<p>Generalized UniFrac distance contains an extra parameter <code class="reqn">\alpha</code> 
controlling the weight on abundant lineages so the distance is not dominated 
by highly abundant lineages. <code class="reqn">\alpha=0.5</code> ("d_0.5") is overall very robust. 
</p>
<p>The unweighted ("d_1") and weighted UniFrac ("d_UW") are also implemented.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">GUniFrac(otu.tab, tree, size.factor = NULL, alpha = c(0, 0.5, 1), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>otu.tab</code></td>
<td>


<p>a matrix, the OTU count table, row - n sample, column - q OTU
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>


<p>a rooted phylogenetic tree of R class “phylo”
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.factor</code></td>
<td>

<p>a numeric vector of the normalizing factors to divide the counts. The length
is the number of samples. This provides the flexibility to normalize data using the 
preferred normalization method (e.g. GMPR normalizing factor). If not supplied, the total sum will be used. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>


<p>a numeric vector, parameters controlling the weight on abundant lineages
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>


<p>logical value, whether to print out the messages
</p>
</td>
</tr>
</table>
<h3>Value</h3>






<p>Return a list containing
</p>
<table><tr style="vertical-align: top;">
<td><code>unifracs</code></td>
<td>
<p>a three dimensional array containing all the UniFrac
distance matrices</p>
</td>
</tr></table>
<h3>Note</h3>


<p>The function only accepts rooted tree. To root a tree, you may consider using <code>midpoint</code> from the package <code>phangorn</code>.
</p>


<h3>Author(s)</h3>


<p>Jun Chen &lt;chen.jun2@mayo.edu&gt;
</p>


<h3>References</h3>


<p>Chen, J., Bittinger, K., Charlson, E.S., Hoffmann, C., Lewis, J., Wu, G.D., Collman, R.G., Bushman, F.D. and Li, H. (2012). Associating microbiome composition with 
environmental covariates using generalized UniFrac distances. 28(16): 2106–2113.
</p>


<h3>See Also</h3>


<p><code>Rarefy</code>, <code>PermanovaG</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(throat.otu.tab)
data(throat.tree)
data(throat.meta)

groups &lt;- throat.meta$SmokingStatus

# Rarefaction
otu.tab.rff &lt;- Rarefy(throat.otu.tab)$otu.tab.rff

# Calculate the UniFracs
unifracs &lt;- GUniFrac(otu.tab.rff, throat.tree, alpha=c(0, 0.5, 1))$unifracs

dw &lt;- unifracs[, , "d_1"]		# Weighted UniFrac
du &lt;- unifracs[, , "d_UW"]		# Unweighted UniFrac	
d0 &lt;- unifracs[, , "d_0"]     	# GUniFrac with alpha 0  
d5 &lt;- unifracs[, , "d_0.5"]   	# GUniFrac with alpha 0.5 

# Permanova - Distance based multivariate analysis of variance
adonis3(as.dist(d5) ~ groups)

## End(Not run)

</code></pre>


</div>