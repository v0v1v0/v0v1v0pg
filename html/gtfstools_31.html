<div class="container">

<table style="width: 100%;"><tr>
<td>get_stop_times_patterns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get stop times patterns</h2>

<h3>Description</h3>

<p>Identifies spatial and spatiotemporal patterns within the <code>stop_times</code>
table. Please see the details to understand what a "pattern" means in each of
these cases.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_stop_times_patterns(
  gtfs,
  trip_id = NULL,
  type = "spatial",
  sort_sequence = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gtfs</code></td>
<td>
<p>A GTFS object, as created by <code>read_gtfs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trip_id</code></td>
<td>
<p>A character vector including the <code>trip_id</code>s to have their
<code>stop_times</code> entries analyzed. If <code>NULL</code> (the default), the function
analyses the pattern of every <code>trip_id</code> in the GTFS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string specifying the type of patterns to be analyzed. Either
<code>"spatial"</code> (the default) or "spatiotemporal".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort_sequence</code></td>
<td>
<p>A logical specifying whether to sort timetables by
<code>stop_sequence</code>. Defaults to <code>FALSE</code>, otherwise spec-compliant feeds, in
which timetables points are already ordered by <code>stop_sequence</code>, would be
penalized through longer processing times. Pattern identification based on
unordered timetables may result in multiple ids identifying what would be
the same pattern, had the table been ordered.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.table</code> associating each <code>trip_id</code> to a <code>pattern_id</code>.
</p>


<h3>Details</h3>

<p>Two trips are assigned to the same spatial <code>pattern_id</code> if they travel along
the same sequence of stops. They are assigned to the same spatiotemporal
<code>pattern_id</code>, on the other hand, if they travel along the same sequence of
stops and they take the same time between stops. Please note that, in such
case, only the time between stops is taken into account, and the time that
the trip started is ignored (e.g. if two trips depart from stop A and follow
the same sequence of stops to arrive at stop B, taking both 1 hour to do so,
their spatiotemporal pattern will be considered the same, even if one
departed at 6 am and another at 7 am). Please also note that the
<code>stop_sequence</code> field is currently ignored - which means that two stops are
considered to follow the same sequence if one is listed right below the
other on the <code>stop_times</code> table (e.g. if trip X lists stops A followed by
stop B with <code>stop_sequence</code>s 1 and 2, and trip Y lists stops A followed by
stop B with <code>stop_sequence</code>s 1 and 3, they are assigned to the same
<code>pattern_id</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data_path &lt;- system.file("extdata/ber_gtfs.zip", package = "gtfstools")

gtfs &lt;- read_gtfs(data_path)

patterns &lt;- get_stop_times_patterns(gtfs)
head(patterns)

# use the trip_id argument to control which trips are analyzed
patterns &lt;- get_stop_times_patterns(
  gtfs,
  trip_id = c("143765658", "143765659", "143765660")
)
patterns

# use the type argument to control the type of pattern analyzed
patterns &lt;- get_stop_times_patterns(
  gtfs,
  trip_id = c("143765658", "143765659", "143765660"),
  type = "spatiotemporal"
)
patterns

</code></pre>


</div>