<div class="container">

<table style="width: 100%;"><tr>
<td>xcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-covariance</h2>

<h3>Description</h3>

<p>Compute covariance at various lags (= correlation(x-mean(x), y-mean(y))).
</p>


<h3>Usage</h3>

<pre><code class="language-R">xcov(
  x,
  y = NULL,
  maxlag = if (is.matrix(x)) nrow(x) - 1 else max(length(x), length(y)) - 1,
  scale = c("none", "biased", "unbiased", "coeff")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input, numeric or complex vector or matrix. Must not be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Input, numeric or complex vector data.  If <code>x</code> is a matrix (not
a vector), <code>y</code> must be omitted. <code>y</code> may be omitted if <code>x</code> is
a vector; in this case <code>xcov</code> estimates the autocovariance of
<code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlag</code></td>
<td>
<p>Integer scalar. Maximum covariance lag. If omitted, the
default value is <code>N-1</code>, where <code>N</code> is the greater of the lengths
of <code>x</code> and <code>y</code> or, if <code>x</code> is a matrix, the number of rows in
<code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Character string. Specifies the type of scaling applied to the
covariation vector (or matrix). matched to one of:
</p>

<dl>
<dt>"none"</dt>
<dd>
<p>return the unscaled covariance, C</p>
</dd>
<dt>"biased"</dt>
<dd>
<p>return the biased average, C/N</p>
</dd>
<dt>"unbiased"</dt>
<dd>
<p>return the unbiased average, C(k)/(N-|k|)</p>
</dd>
<dt>"coeff"</dt>
<dd>
<p>return C/(covariance at lag 0)</p>
</dd>
</dl>
<p>,
where <code>k</code> is the lag, and <code>N</code> is the length of <code>x</code>

If omitted, the default value is <code>"none"</code>. If <code>y</code> is supplied but
does not have the same length as <code>x</code>, scale must be <code>"none"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following variables:
</p>

<dl>
<dt>C</dt>
<dd>
<p>array of covariance estimates</p>
</dd>
<dt>lags</dt>
<dd>
<p>vector of covariance lags <code>[-maxlag:maxlag]</code></p>
</dd>
</dl>
<p>The array of covariance estimates has one of the following forms:
</p>

<ol>
<li>
<p> Cross-covariance estimate if X and Y are vectors.
</p>
</li>
<li>
<p> Autocovariance estimate if is a vector and Y is omitted.
</p>
</li>
<li>
<p> If <code>x</code> is a matrix, <code>C</code> is a matrix containing the
cross-covariance estimates of each column with every other column. Lag
varies with the first index so that <code>C</code> has <code>2 * maxlag + 1</code> rows
and <code class="reqn">P^2</code> columns where <code>P</code> is the number of columns in <code>x</code>.
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Paul Kienzle, <a href="mailto:pkienzle@users.sf.net">pkienzle@users.sf.net</a>.<br>
Conversion to R by Geert van Boxtel, <a href="mailto:G.J.M.vanBoxtel@gmail.com">G.J.M.vanBoxtel@gmail.com</a>.
</p>


<h3>See Also</h3>

<p><code>xcorr</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
N &lt;- 128
fs &lt;- 5
t &lt;- seq(0, 1, length.out = N)
x &lt;- sin(2 * pi * fs * t) + runif(N)
cl &lt;- xcov(x, maxlag = 20, scale = 'coeff')
plot (cl$lags, cl$C, type = "h", xlab = "", ylab = "")
points (cl$lags, cl$C)
abline(h = 0)

</code></pre>


</div>