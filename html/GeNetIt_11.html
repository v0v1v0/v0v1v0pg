<div class="container">

<table style="width: 100%;"><tr>
<td>gravity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gravity model</h2>

<h3>Description</h3>

<p>Implements Murphy et al., (2010) gravity model via a 
linear mixed effects model
</p>


<h3>Usage</h3>

<pre><code class="language-R">gravity(
  y,
  x,
  d,
  group,
  data,
  fit.method = c("REML", "ML"),
  ln = TRUE,
  constrained = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Name of dependent variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Character vector of independent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Name of column containing distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Name of grouping column (from or to)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame object containing model data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.method</code></td>
<td>
<p>Method used to fit model c("REML", "ML")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ln</code></td>
<td>
<p>Natural log transform data (TRUE/FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrained</code></td>
<td>
<p>Specify constrained model, if FALSE a linear model (lm) 
is run (TRUE/FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional argument passed to nlme or lm</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The "group" factor defines the singly constrained direction (from or to) and the 
grouping structure for the origins. To specify a null (distance only or IBD) 
model just omit the x argument. 
</p>
<p>By default constrained models are fit by maximizing the restricted log-likelihood 
(REML), for maximum likelihood use the type="ML" argument which is passed to the 
lme function. If ln=TRUE the input data will be log transformed
</p>


<h3>Value</h3>

<p>formula           Model formula call
</p>
<p>fixed.formula     Model formula for fixed effects
</p>
<p>random.formula    Model formula for random (group) effects 
(only for constrained models)
</p>
<p>gravity           Gravity model
</p>
<p>fit               Model Fitted Values
</p>
<p>AIC               AIC value for selected model
</p>
<p>RMSE              Root Mean Squared Error (based on bias corrected back transform)
</p>
<p>log.likelihood    Restricted log-likelihood at convergence
</p>
<p>group.names       Column name of grouping variable
</p>
<p>groups            Values of grouping variable
</p>
<p>x                 data.frame of x variables
</p>
<p>y                 Vector of y variable
</p>
<p>constrained       TRUE/FALSE indicating if model is constrained
</p>


<h3>Note</h3>

<p>Depends: nlme, lattice
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Evans  &lt;jeffrey_evans@tnc.org&gt; and 
Melanie A. Murphy &lt;melanie.murphy@uwyo.edu&gt;
</p>


<h3>References</h3>

<p>Murphy, M. A. &amp; J.S. Evans. (in prep). GenNetIt: graph theoretical gravity modeling 
for landscape genetics
</p>
<p>Murphy M.A., R. Dezzani, D.S. Pilliod &amp; A.S. Storfer (2010) Landscape genetics of 
high mountain frog metapopulations. Molecular Ecology 19(17):3634-3649
</p>


<h3>See Also</h3>

<p><code>groupedData</code> for how grouping works in constrained model
</p>
<p><code>lme</code> for constrained model ... options
</p>
<p><code>lm</code> for linear model ... options
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(nlme)
data(ralu.model)

# Gravity model	
x = c("DEPTH_F", "HLI_F", "CTI_F", "cti", "ffp")
( gm &lt;- gravity(y = "DPS", x = x, d = "DISTANCE", group = "FROM_SITE", 
                data = ralu.model, ln = FALSE) )

#' # Plot gravity results
 par(mfrow=c(2,3))
   for (i in 1:6) { plot(gm, type=i) } 

# log likelihood of competing models 
 x = c("DEPTH_F", "HLI_F", "CTI_F", "cti", "ffp")
 for(i in x[-1]) {
   x1 = c(x[1], x[-which(x %in% i)])  
   ll &lt;- gravity(y = "DPS", x = x1, d = "DISTANCE", group = "FROM_SITE", 
                 data = ralu.model, ln = FALSE)$log.likelihood
  cat("log likelihood for parameter set:", "(",x1,")", "=", ll, "\n") 
 }

# Distance only (IBD) model
gravity(y = "DPS", d = "DISTANCE", group = "FROM_SITE", 
        data = ralu.model, ln = FALSE)

</code></pre>


</div>