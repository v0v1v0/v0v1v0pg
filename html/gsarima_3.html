<div class="container">

<table style="width: 100%;"><tr>
<td>garsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Simulate a Generalized Autoregressive Time Series </h2>

<h3>Description</h3>

<p>Simulate a time series using a general autoregressive model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">garsim(n, phi, X = matrix(0, nrow = n), beta = as.matrix(0), sd = 1, 
	family = "gaussian", transform.Xbeta = "identity", link = "identity", 
	minimum = 0, zero.correction = "zq1", c = 1, theta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The number of simulated values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p> A vector of autoregressive parameters of length p. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> An n by m optional matrix of external covariates, optionally including an intercept (recommended for family = "poisson"). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p> An m vector of coefficients. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p> Standard deviation for Gaussian family. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p> Distribution family, defaults to "gaussian". </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform.Xbeta</code></td>
<td>
<p> Optional transformation for the product of covariates and coefficients, see Details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p> The link function, defaults to "identity". </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimum</code></td>
<td>
<p> A minimum value for the mean parameter of the Poisson and Negative Binomialdistributions 
(only applicable for link= "identity" and family = c("poisson","negative.binomial")). 
Defaults to 0. A small positive value will allow non-stationary series to "grow" 
after encountering a simulated value of 0. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.correction</code></td>
<td>
<p> Method for transformation for dealing with zero values (only applicable when link = "log"), see Details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p> The constant used for transformation before taking the logarithm (only applicable when link = "log"). A value between 0 and 1 is recommended. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p> Parameter theta (for family = "negative.binomial"). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Implemented are the following models:
1) family = "gaussian", link = "identity"
2) family = "poisson", link = "identity"
3) family = "poisson", link = "identity", transform.Xbeta = "exponential"
4) family = "poisson", link = "log", zero.correction = "zq1"
5) family = "poisson", link = "log", zero.correction = "zq2"
6) family = "negative.binomial", link = "identity"
7) family = "negative.binomial", link = "identity", transform.Xbeta = "exponential"
8) family = "negative.binomial", link = "log", zero.correction = "zq1"
9) family = "negative.binomial", link = "log", zero.correction = "zq2"
</p>
<p>Models 1 to 4 are within the family of GARMA models of Benjamin and colleagues 2003
Model 2 is the extension to higher order p of a Poisson CLAR(1) model proposed by Grunwald and  colleagues (2000).
Model 3 is a modification of the PAR(p) data generating process (<a href="https://personal.utdallas.edu/~pxb054000/code/pests.r">https://personal.utdallas.edu/~pxb054000/code/pests.r</a>) of Brandt and Williams (2001). Note that for psi = 0, the model reduces to a standard Poisson model with log-link function. For a model without external variables (only an intercept), the transformation of Xbeta has no consequence and then model 3 is the same as model 2.
Model 4 corresponds to model 2.2 of Zeger and Qaqish (1988). The value c is only added to values of zero prior to taking the log.
Models 6 to 9 are similar but with negative binomial distribution
</p>


<h3>Value</h3>

<p>  An autoregressive series of length n. Note that the first p data do not have autoregressive structure.
</p>


<h3>Note</h3>

<p>Version 0.1-2: bug corrected and garmaFit example given, Version 0.1-5: garmaFit example removed due to archiving of package gamlss.util</p>


<h3>Author(s)</h3>

<p> Olivier Briet <a href="mailto:o.briet@gmail.com">o.briet@gmail.com</a> </p>


<h3>References</h3>

<p>Briet OJT, Amerasinghe PH, Vounatsou P: Generalized seasonal autoregressive integrated moving average
models for count data with application to malaria time series with low case numbers.
PLoS ONE, 2013, 8(6): e65761. doi:10.1371/journal.pone.0065761  <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0065761">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0065761</a> If you use the gsarima package, please cite the above reference.
</p>
<p>Brandt PT, Williams JT: A linear Poisson autoregressive model: The PAR(p). Political Analysis 2001, 9.
</p>
<p>Benjamin MA, Rigby RA, Stasinopoulos DM: Generalized Autoregressive Moving Average Models. Journal of the American Statistical Association 2003, 98:214-223.
</p>
<p>Zeger SL, Qaqish B: Markov regression models for time series: a quasi-likelihood approach. Biometrics 1988, 44:1019-1031
</p>
<p>Grunwald G, Hyndman R, Tedesco L, Tweedie R: Non-Gaussian conditional linear AR(1) models. Australian &amp; New Zealand Journal of Statistics 2000, 42:479-495. 
</p>


<h3>See Also</h3>

<p> 'rnegbin(MASS)', 'arrep'. </p>


<h3>Examples</h3>

<pre><code class="language-R">  N&lt;-1000
  ar&lt;-c(0.8)
  intercept&lt;-2
  frequency&lt;-1
  x&lt;- rnorm(N)
  beta.x&lt;-0.7
  #Gaussian simulation with covariate
  X=matrix(c(rep(intercept, N+length(ar)), rep(0, length(ar)), x), ncol=2)
  y.sim &lt;- garsim(n=(N+length(ar)),phi=ar, X=X, beta=c(1,beta.x), sd=sqrt(1)) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  arima(tsy, order=c(1,0,0), xreg=x)

  #Gaussian simulation with covariate and deterministic seasonality through first order harmonic
  ar&lt;-c(1.4,-0.4)
  frequency&lt;-12
  beta.x&lt;-c(0.7,4,4)
  X&lt;-matrix(nrow= (N+ length(ar)), ncol=3)
  for (t in 1: length(ar)){
	X[t,1]&lt;-0
	X[t,2]&lt;-sin(2*pi*(t- length(ar))/frequency)
	X[t,3]&lt;- cos(2*pi*(t- length(ar))/frequency)
  }
  for (t in (1+ length(ar)): (N+ length(ar))){
	X[t,1]&lt;-x[t- length(ar)]
	X[t,2]&lt;-sin(2*pi*(t- length(ar))/frequency)
	X[t,3]&lt;- cos(2*pi*(t- length(ar))/frequency)
  }
  y.sim &lt;- garsim(n=(N+length(ar)),phi=ar, X=X, beta= beta.x, sd=sqrt(1)) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  Xreg&lt;-matrix(nrow= N, ncol=3)
  for (t in 1: N){
	Xreg[t,1]&lt;-x[t]
	Xreg[t,2]&lt;-sin(2*pi*t/frequency)
	Xreg[t,3]&lt;- cos(2*pi*t/frequency)
  }
  arimares&lt;-arima(tsy, order=c(1,1,0), xreg=Xreg)
  tsdiag(arimares)
  arimares

  #Negative binomial simulation with covariate
  ar&lt;-c(0.8)
  frequency&lt;-1
  beta.x&lt;-0.7
  X=matrix(c(rep(log(intercept), N+length(ar)), rep(0, length(ar)), x), ncol=2)
  y.sim &lt;- garsim(n=(N+length(ar)), phi=ar, beta=c(1,beta.x), link= "log", 
  	family= "negative.binomial", zero.correction = "zq1", c=1, theta=5, X=X) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  
    
  #Poisson ARMA(1,1) with identity link and negative auto correlation
  N&lt;-500
  phi&lt;-c(-0.8)
  theta&lt;-c(0.6)
  ar&lt;-arrep(phi=phi, theta=theta)
  check&lt;-(acf2AR(ARMAacf(ar=phi, ma=theta, lag.max = 100, pacf = FALSE))[100,1:length(ar)])
  as.data.frame(cbind(ar,check))
  intercept&lt;-100
  frequency&lt;-1
  X=matrix(c(rep(intercept, N+length(ar))), ncol=1)
  y.sim &lt;- garsim(n=(N+length(ar)), phi=ar, beta=c(1), link= "identity", 
  	family= "poisson", minimum = -100, X=X) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  
  #Poisson AR(1) with identity link and negative auto correlation
  N&lt;-1000
  ar&lt;-c(-0.8)
  intercept&lt;-100
  frequency&lt;-1
  X=matrix(c(rep(intercept, N+length(ar))), ncol=1)
  y.sim &lt;- garsim(n=(N+length(ar)), phi=ar, beta=c(1), link= "identity", 
  	family= "poisson", minimum = -100, X=X) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  
  #Example of negative binomial GSARIMA(2,1,0,0,0,1)x
  phi&lt;-c(0.5,0.2)
  theta&lt;-c(0)
  Theta&lt;-c(0.5)
  Phi&lt;-c(0)
  d&lt;-c(1)
  D&lt;-c(0)
  frequency&lt;-12
  ar&lt;-arrep(phi=phi, theta=theta, Phi=Phi, Theta=Theta, frequency= frequency, d=d, D=D)
  N&lt;-c(1000)
  intercept&lt;-c(10)
  x&lt;- rnorm(N)
  beta.x&lt;-c(0.7)
  X&lt;-matrix(c(rep(log(intercept), N+length(ar)), rep(0, length(ar)), x), ncol=2)
  c&lt;-c(1)
  y.sim &lt;- garsim(n=(N+length(ar)), phi=ar, beta=c(1,beta.x), link= "log", 
  	family= "negative.binomial", zero.correction = "zq1", c=c, theta=5, X=X) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  plot(log(tsy))
</code></pre>


</div>