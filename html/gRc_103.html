<div class="container">

<table style="width: 100%;"><tr>
<td>clever_trace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate trace of various matrix products.</h2>

<h3>Description</h3>

<p>Calculate trace of various matrix products.
</p>


<h3>Usage</h3>

<pre><code class="language-R">trA(A)

trAW(rA, rW)

trAWB(rA, rW, rB)

trAWBW(rA, rW, rB)

trAWBV(rA, rW, rB, rV)

trAWBlist(Alist, W, Blist, mode = 0L)

trAWBWlist(Alist, W, Blist, mode = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rA, rB</code></td>
<td>
<p>Square matrices represented as "sparse" matrices. The
dimension is inferred from dimension of V,W.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rW, rV, W</code></td>
<td>
<p>Square matrices; must be of same dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alist, Blist</code></td>
<td>
<p>Lists of such "sparse" matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>0 or 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A number
</p>


<h3>Author(s)</h3>

<p>Søren Højsgaard, <a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Turn list into "sparse" matrix
to_sp &lt;- function(x){
  ans &lt;- do.call("rbind", x)
  storage.mode(ans)&lt;-"double"
  return(ans)
}

## Turn "sparse" matrix into dense matrix
##
to_de &lt;- function(A,d){
  if (nrow(A) &lt; 1) stop("need non-empty matrix\n")
  ans &lt;- matrix(0,nr=d,nc=d)
  for (i in 1:nrow(A)){
    e &lt;- A[i,]
    if (length(e) == 1){
      ans[e,e] &lt;- 1
    } else { 
      ans[e[1],e[2]] &lt;-   ans[e[2],e[1]] &lt;- 1 
    }
  }  
  return(ans)
}

d &lt;- 5
W &lt;- matrix(rnorm(d * d), nr=d, nc=d);
V &lt;- matrix(rnorm(d * d), nr=d, nc=d); 
W &lt;- W + t(W)
V &lt;- V + t(V)


A1.lst &lt;- list(c(1,2),c(1,3))
A2.lst &lt;- list(1,3,5)

A1.sp &lt;- to_sp(A1.lst)
A2.sp &lt;- to_sp(A2.lst)

A1.de &lt;- to_de(A1.sp, d)
A2.de &lt;- to_de(A2.sp, d)

trAW(A1.sp, W)
sum(diag(A1.de %*% W))

trAW(A2.sp, W)
sum(diag(A2.de %*% W))

trAWB(A1.sp, W, A2.sp)
trAWB(A2.sp, W, A1.sp)
sum(diag(A1.de %*% W %*% A2.de))

trAWBW(A1.sp, W, A2.sp)
trAWBW(A2.sp, W, A1.sp)
sum(diag(A1.de %*% W %*% A2.de %*% W))

trAWBV(A1.sp, W, A2.sp, V)
trAWBV(A2.sp, W, A1.sp, V)
sum(diag(A1.de %*% W %*% A2.de %*% V))

</code></pre>


</div>