<div class="container">

<table style="width: 100%;"><tr>
<td>pso.velocity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Velocity</h2>

<h3>Description</h3>

<p>Calculates (updates) velocities of the particles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pso.velocity(
  population,
  method = "hypersphere",
  par = list(w = 1/(2 * log(2)), c1 = 0.5 + log(2), c2 = 0.5 + log(2)),
  velocity,
  best.pn,
  best.nh,
  best.pn.fitness,
  best.nh.fitness,
  iter = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>numeric matrix which rows are particles i.e. vectors of 
parameters values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string representing method to be used for velocities 
calculation. See 'Details' for additional information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>additional parameters to be passed depending on the <code>method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>velocity</code></td>
<td>
<p>matrix which i-th row is a velocity of the i-th particle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.pn</code></td>
<td>
<p>numeric matrix which i-th row is a best personal position 
known by the i-th particle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.nh</code></td>
<td>
<p>numeric matrix which i-th row is a best personal position 
in a neighbourhood of the i-th particle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.pn.fitness</code></td>
<td>
<p>numeric vector which i-th row is the value of
a fitness function at point <code>best.pn[i, ]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.nh.fitness</code></td>
<td>
<p>numeric vector which i-th row is the value of
a fitness function at point <code>best.nh[i, ]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>iteration number of the genetic algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>method = "classic"</code> then classical velocity formula
is used:
</p>
<p style="text-align: center;"><code class="reqn">v_{i,j,(t+1)}=w\times v_{i,j,t} + 
                     c_{1}\times u_{1,i,j} \times b^{pn}_{i,j,t} + 
                     c_{2}\times u_{2,i,j} \times b^{nh}_{i,j,t}</code>
</p>

<p>where <code class="reqn">v_{i, j, t}</code> is a velocity of the <code class="reqn">i</code>-th particle 
respect to the <code class="reqn">j</code>-th component at time <code class="reqn">t</code>. Random variables
<code class="reqn">u_{1,i,j}</code> and <code class="reqn">u_{2,i,j}</code> are i.i.d. respect to all indexes and
follow standard uniform distribution <code class="reqn">U(0, 1)</code>. 
Variable <code class="reqn">b^{pn}_{i,j,t}</code> is <code class="reqn">j</code>-th component of the best known
particle's (personal) position up to time period <code class="reqn">t</code>. 
Similarly <code class="reqn">b^{nh}_{i,j,t}</code> is <code class="reqn">j</code>-th component of the best of best 
known particle's position in a neighbourhood of the <code class="reqn">i</code>-th particle.
Hyperparameters <code class="reqn">w</code>, <code class="reqn">c_{1}</code> and <code class="reqn">c_{2}</code> may be provided
via <code>par</code> argument as a list with elements <code>par$w</code>, <code>par$c1</code>
and <code>par$c2</code> correspondingly. 
</p>
<p>If <code>method = "hypersphere"</code> then rotation invariant formula from
sections 3.4.2 and 3.4.3 of M. Clerc (2012) is used with arguments
identical to the classical method. To simulate a random variate from
the hypersphere function <code>rhypersphere</code> is used
setting <code>type = "non-uniform"</code>.
</p>
<p>In accordance with M. Clerc (2012) 
default values are <code>par$w = 1/(2 * log(2))</code>,
<code>par$c1 = 0.5 + log(2)</code> and <code>par$c2 = 0.5 + log(2)</code>.
</p>


<h3>Value</h3>

<p>This function returns a matrix which i-th row represents
updated velocity of the i-th particle.
</p>


<h3>References</h3>

<p>Maurice Clerc (2012). 
Standard Particle Swarm Optimisation.
<em>HAL archieve</em>.
</p>


</div>