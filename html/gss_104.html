<div class="container">

<table style="width: 100%;"><tr>
<td>mkfun.tp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Crafting Building Blocks for Thin-Plate and Spherical Splines
</h2>

<h3>Description</h3>

<p>Craft numerical functions to be used by <code>mkterm</code> to
assemble model terms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mkrk.tp(dm, order, mesh, weight)
mkphi.tp(dm, order, mesh, weight)
mkrk.tp.p(dm, order)
mkphi.tp.p(dm, order)

mkrk.sphere(order)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dm</code></td>
<td>
<p>Dimension of the variable <code class="reqn">d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Order of the differential operator <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mesh</code></td>
<td>
<p>Normalizing mesh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Normalizing weights.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>mkrk.tp</code>, <code>mkphi.tp</code>, <code>mkrk.tp.p</code>, and
<code>mkphi.tp.p</code> implement the construction in Gu (2002,
Sec. 4.4).  Thin-plate splines are defined for <code class="reqn">2m&gt;d</code>.
</p>
<p><code>mkrk.tp.p</code> generates the pseudo kernel, and <code>mkphi.tp.p</code>
generates the <code class="reqn">(m+d-1)!/d!/(m-1)!</code> lower order polynomials with
total order less than <code class="reqn">m</code>.
</p>
<p><code>mkphi.tp</code> generates normalized lower order polynomials
orthonormal w.r.t. a norm specified by <code>mesh</code> and
<code>weight</code>, and <code>mkrk.tp</code> conditions the pseudo kernel to
generate the reproducing kernel orthogonal to the lower order
polynomials w.r.t. the norm.
</p>
<p><code>mkrk.sphere</code> implements the reproducing kernel construction of
Wahba (1981) for <code class="reqn">m=2,3,4</code>.
</p>


<h3>Value</h3>

<p>A list of two elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>Function definition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>Portable local constants derived from the arguments.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><code>mkrk.tp</code> and <code>mkrk.sphere</code> create a bivariate function
<code>fun(x,y,env,outer=FALSE)</code>, where <code>x</code>, <code>y</code> are real
arguments and local constants can be passed in through <code>env</code>.
</p>
<p><code>mkphi.tp</code> creates a collection of univariate functions
<code>fun(x,nu,env)</code>, where <code>x</code> is the argument and <code>nu</code>
is the index.
</p>


<h3>References</h3>

<p>Gu, C. (2013), <em>Smoothing Spline ANOVA Models (2nd Ed)</em>.  New
York: Springer-Verlag.
</p>
<p>Wahba, G. (1981), Spline interpolation and smoothing on the sphere.
<em>SIAM Journal on Scientific and Statistical Computing</em>,
<b>2</b>, 5â€“16.
</p>


<h3>See Also</h3>

<p><code>mkterm</code>, <code>mkfun.poly</code>, and
<code>mkrk.nominal</code>.
</p>


</div>