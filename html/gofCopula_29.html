<div class="container">

<table style="width: 100%;"><tr>
<td>gofWhite</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>2 dimensional gof tests based on White's information matrix equality.</h2>

<h3>Description</h3>

<p><code>gofWhite</code> tests a given 2 dimensional dataset for a copula with
the gof test based on White's information matrix equality. The possible
copulae are <code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code> and <code>"joe"</code>. See for reference Schepsmeier et al. (2015). 
The parameter estimation is performed with pseudo maximum likelihood method. 
In case the estimation fails, inversion of Kendall's tau is used. The margins
can be estimated by a bunch of distributions and the time which is necessary
for the estimation can be given. The approximate p-values are computed with
a parametric bootstrap, which computation can be accelerated by enabling
in-build parallel computation. The computation of the test statistic and
p-values is performed by corresponding functions from the <code>VineCopula</code>
package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofWhite(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>The copula to test for. Possible are the copulae
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code> and <code>"joe"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>The parameter to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated with a maximum likelihood
estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The degrees of freedom, if not meant to be estimated. Only
necessary if tested for <code>"t"</code>-copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The details are obtained from Schepsmeier et al. (2015) who states that this
test uses the information matrix equality of White (1982). Under correct
model specification is the Fisher Information equivalently calculated as
minus the expected Hessian matrix or as the expected outer product of the
score function. The null hypothesis is </p>
<p style="text-align: center;"><code class="reqn">H_0 : \mathbf{V}(\theta) +
\mathbf{S}(\theta) = 0</code>
</p>
<p> where
<code class="reqn">\mathbf{V}(\theta)</code> is the expected Hessian matrix and
<code class="reqn">\mathbf{S}(\theta)</code> is the expected outer product of the
score function.
</p>
<p>The test statistic is derived by </p>
<p style="text-align: center;"><code class="reqn">T_n = n(\bar{d}(\theta_n))^\top
A_{\theta_n}^{-1} \bar{d}(\theta_n)</code>
</p>
<p> with </p>
<p style="text-align: center;"><code class="reqn">\bar{d}(\theta_n) = \frac{1}{n}
\sum_{i=1}^n vech(\mathbf{V}_n(\theta_n|\mathbf{u}) +
\mathbf{S}_n(\theta_n|\mathbf{u})),</code>
</p>

<p style="text-align: center;"><code class="reqn">d(\theta_n) = vech(\mathbf{V}_n(\theta_n|\mathbf{u}) +
\mathbf{S}_n(\theta_n|\mathbf{u})),</code>
</p>

<p style="text-align: center;"><code class="reqn">A_{\theta_n} = \frac{1}{n} \sum_{i=1}^n (d(\theta_n) - D_{\theta_n}
\mathbf{V}_n(\theta_n)^{-1} \delta l(\theta_n))(d(\theta_n) - D_{\theta_n}
\mathbf{V}_n(\theta_n)^{-1} \delta l(\theta_n))^\top</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">D_{\theta_n} = \frac{1}{n} \sum_{i=1}^n [\delta_{\theta_k}
d_l(\theta_n)]_{l=1, \dots, \frac{p(p+1)}{2}, k=1, \dots, p}</code>
</p>
<p> where <code class="reqn">l(\theta_n)</code> represents the log likelihood
function and <code class="reqn">p</code> is the length of the parameter vector
<code class="reqn">\theta</code>.
</p>
<p>The test statistic will be rejected if </p>
<p style="text-align: center;"><code class="reqn">T &gt; (1 - \alpha)
(\chi^2_{p(p+1)/2})^{-1}.</code>
</p>

<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>
<p>Please note, the test gofWhite may be unstable for t-copula. Please handle
the results carefully.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann,
Benedikt Graeler (2015). VineCopula: Statistical Inference of Vine Copulas.
<em>R package version 1.4.</em>.
<a href="https://cran.r-project.org/package=VineCopula">https://cran.r-project.org/package=VineCopula</a> <br><br> Schepsmeier, U.
and J. Stoeber (2014). Derivatives and Fisher information of bivariate
copulas. <em>Statistical Papers, 55(2), 525-542.</em>
<a href="https://link.springer.com/article/10.1007/s00362-013-0498-x">https://link.springer.com/article/10.1007/s00362-013-0498-x</a> <br><br>
Stoeber, J. and U. Schepsmeier (2013). Estimating standard errors in regular
vine copula models <em>Computational Statistics, 28 (6), 2679-2707</em> <br><br> Schepsmeier, U. (2015). Efficient information based goodness-of-fit
tests for vine copula models with fixed margins. <em>Journal of
Multivariate Analysis 138, 34-52.</em> Schepsmeier, U. (2014). A goodness-of-fit
test for regular vine copula models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(IndexReturns2D)

gofWhite("normal", IndexReturns2D, M = 10)

</code></pre>


</div>