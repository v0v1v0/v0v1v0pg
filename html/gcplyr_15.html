<div class="container">

<table style="width: 100%;"><tr>
<td>ExtremaFunctions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find local extrema of a numeric vector</h2>

<h3>Description</h3>

<p>These functions take a vector of <code>y</code> values and identify local extrema.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_local_extrema(
  y,
  x = NULL,
  window_width = NULL,
  window_width_n = NULL,
  window_height = NULL,
  window_width_frac = NULL,
  window_width_n_frac = NULL,
  return = "index",
  return_maxima = TRUE,
  return_minima = TRUE,
  return_endpoints = TRUE,
  subset = NULL,
  na.rm = TRUE,
  width_limit = NULL,
  width_limit_n = NULL,
  height_limit = NULL
)

first_maxima(
  y,
  x = NULL,
  window_width = NULL,
  window_width_n = NULL,
  window_height = NULL,
  window_width_frac = NULL,
  window_width_n_frac = 0.2,
  return = "index",
  return_endpoints = TRUE,
  ...
)

first_minima(
  y,
  x = NULL,
  window_width = NULL,
  window_width_n = NULL,
  window_height = NULL,
  window_width_frac = NULL,
  window_width_n_frac = 0.2,
  return = "index",
  return_endpoints = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector of y values in which to identify local extrema</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Optional numeric vector of corresponding x values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_width, window_width_n, window_height, window_width_frac, window_width_n_frac</code></td>
<td>
<p>Arguments that set the width/height of the window used to
search for local extrema.
</p>
<p><code>window_width</code> is in units of <code>x</code>.
</p>
<p><code>window_width_n</code> is in units of number of data points.
</p>
<p><code>window_height</code> is the maximum change in <code>y</code> 
a single extrema-search step is allowed to take.
</p>
<p><code>window_width_n_frac</code> is as a fraction of the total
number of data points.
</p>
<p>For example, the function will not pass a peak or valley
more than <code>window_width_n</code> data points wide, nor
a peak/valley taller or deeper than <code>window_height</code>.
</p>
<p>A narrower width will be more sensitive to narrow local 
maxima/minima, while a wider width will be less sensitive 
to local maxima/minima. A smaller height will be more 
sensitive to shallow local maxima/minima, while a larger 
height will be less sensitive to shallow maxima/minima.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return</code></td>
<td>
<p>One of c("index", "x", "y"), determining whether the function
will return the index, x value, or y value associated with the
identified extremas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_maxima, return_minima</code></td>
<td>
<p>logical for which classes of local extrema
to return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_endpoints</code></td>
<td>
<p>Should the first and last values in <code>y</code>
be included if they are in the returned 
vector of extrema?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>A vector of logical values indicating which x and y values
should be included (TRUE) or excluded (FALSE).
</p>
<p>If <code>return = "index"</code>, index will be for the whole 
vector and not the subset of the vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical whether NA's should be removed before analyzing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width_limit</code></td>
<td>
<p>Deprecated, use <code>window_width</code> instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width_limit_n</code></td>
<td>
<p>Deprecated, use <code>window_width_n</code> instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height_limit</code></td>
<td>
<p>Deprecated, use <code>window_height</code> instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(for <code>first_maxima</code> and <code>first_minima</code>), other 
parameters to pass to <code>find_local_extrema</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>find_local_extrema</code>, one of <code>window_width</code>, 
<code>window_width_n</code>, <code>window_height</code>, or <code>window_width_n_frac</code>
must be provided.
</p>
<p>For <code>first_minima</code> or <code>first_maxima</code>, set 
<code>window_width_n_frac = NULL</code> to override default width behavior.
</p>
<p>If multiple of <code>window_width</code>, <code>window_width_n</code>,
<code>window_height</code>, or <code>window_width_n_frac</code> are provided, steps 
are limited conservatively (a single step must meet all criteria).
</p>
<p>In the case of exact ties in <code>y</code> values within a window, only the 
first local extrema is returned.
</p>


<h3>Value</h3>

<p><code>find_local_extrema</code> returns a vector corresponding to all the 
found local extrema.
</p>
<p><code>first_maxima</code> returns only the first maxima, so is a shortcut for 
<code>find_local_extrema(return_maxima = TRUE, return_minima = FALSE)[1]</code>
</p>
<p><code>first_minima</code> returns only the first minima, so is a shortcut for
<code>find_local_extrema(return_maxima = FALSE, return_maxima = FALSE)[1]</code>
</p>
<p>If <code>return = "index"</code>, the returned value(s) are the indices
corresponding to local extrema in the data
</p>
<p>If <code>return = "x"</code>, the returned value(s) are the x value(s) 
corresponding to local extrema in the data
</p>
<p>If <code>return = "y"</code>, the returned value(s) are the y value(s)
corresponding to local extrema in the data
</p>


</div>