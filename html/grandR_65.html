<div class="container">

<table style="width: 100%;"><tr>
<td>FilterGenes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filter genes</h2>

<h3>Description</h3>

<p>Return a grandR object with fewer genes than the given grandR object (usually to filter out weakly expressed genes).
</p>


<h3>Usage</h3>

<pre><code class="language-R">FilterGenes(
  data,
  mode.slot = "count",
  minval = 100,
  mincol = ncol(data)/2,
  min.cond = NULL,
  use = NULL,
  keep = NULL,
  return.genes = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the grandR object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.slot</code></td>
<td>
<p>the mode.slot that is used for filtering (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minval</code></td>
<td>
<p>the minimal value for retaining a gene</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mincol</code></td>
<td>
<p>the minimal number of columns (i.e. samples or cells) a gene has to have a value &gt;= minval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cond</code></td>
<td>
<p>if not NULL, do not compare values per column, but per condition (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>if not NULL, defines the genes directly that are supposed to be retained (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>if not NULL, defines genes directly, that should be kept even though they do not adhere to the filtering criteria (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.genes</code></td>
<td>
<p>if TRUE, return the gene names instead of a new grandR object</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default genes are retained, if they have 100 read counts in at least half of the columns (i.e. samples or cells).
</p>
<p>The <code>use</code> parameter can be used to define genes to be retained directly. The <code>keep</code> parameter, in contrast, defines
<em>additional</em> genes to be retained. For both, genes can be referred to by their names, symbols, row numbers in the gene table,
or a logical vector referring to the gene table rows.
</p>
<p>To refer to data slots, the mode.slot syntax can be used: Each name is either a data slot, or one of (new,old,total)
followed by a dot followed by a slot. For new or old, the data slot value is multiplied by ntr or 1-ntr. This can be used e.g. to filter by <em>new counts</em>.
</p>
<p>if the <code>min.cond</code> parameter is given, first all columns belonging to the same <code>Condition</code> are summed up, and then the usual filtering
is performed by conditions instead of by columns.
</p>


<h3>Value</h3>

<p>either a new grandR object (if return.genes=FALSE), or a vector containing the gene names that would be retained
</p>


<h3>Examples</h3>

<pre><code class="language-R">
sars &lt;- ReadGRAND(system.file("extdata", "sars.tsv.gz", package = "grandR"),
                  design=c("Condition",Design$dur.4sU,Design$Replicate))

nrow(sars)
# This is already filtered and has 1045 genes
nrow(FilterGenes(sars,minval=1000))
# There are 966 genes with at least 1000 read counts in half of the samples
nrow(FilterGenes(sars,minval=10000,min.cond=1))
# There are 944 genes with at least 10000 read counts in the Mock or SARS condition
nrow(FilterGenes(sars,use=GeneInfo(sars,"Type")!="Cellular"))
# These are the 11 viral genes.

</code></pre>


</div>