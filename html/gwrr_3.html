<div class="container">

<table style="width: 100%;"><tr>
<td>gwl.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Geographically weighted lasso
</h2>

<h3>Description</h3>

<p>This function fits a geographically weighted lasso (GWL) model
</p>


<h3>Usage</h3>

<pre><code class="language-R">gwl.est(form, locs, data, kernel = "exp", cv.tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>

<p>A regression model forumula, as in the functions lm and glm
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locs</code></td>
<td>

<p>A matrix of spatial coordinates of data points, where the x coordinate is first, then the y coordinate;
coordinates are assumed to not be latitude and longitude, as Euclidean distance is calculated from coordinates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame with data to fit model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>

<p>A kernel weighting function, either exp or gauss, where exponential function is default
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.tol</code></td>
<td>

<p>A stopping tolerance in terms of cross-validation error for the bi-section search routine to estimate the kernel bandwidth using cross-validation;
if missing an internally calculated value is used   
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates penalized spatially varying coefficients using the geographically weighed regression
and lasso approaches. Spatial kernel weights are applied to observations using the estimated kernel bandwidth to 
estimate local models at each data point. The kernel bandwidth and lasso solutions are currently estimated using 
cross-validation with an exponential or Gaussian kernel function. Some regression coefficients may be penalized to zero. 
The function estimates regression coefficients, the outcome variable values, and the model fit.
</p>


<h3>Value</h3>

<p>A list with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>phi </code></td>
<td>
<p>Kernel bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMSPE </code></td>
<td>
<p>Root mean squared prediction error from bandwidth estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta </code></td>
<td>
<p>Matrix of estimated regression coefficients, where a row contains the coefficients
for one regression term for all data points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat </code></td>
<td>
<p>Estimated outcome variable values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMSE </code></td>
<td>
<p>Root mean squared error from estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsquare </code></td>
<td>
<p>Approximate R-square for GWR model</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>David Wheeler
</p>


<h3>References</h3>

<p>Wheeler DC (2009) Simultaneous coefficient penalization and model selection in geographically weighted regression: 
The geographically weighted lasso. Environment and Planning A, 41: 722-742
</p>


<h3>See Also</h3>

<p><code>gwrr.est</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(columbus)
locs &lt;- cbind(columbus$x, columbus$y)
col.gwl &lt;- gwl.est(crime ~ income + houseval, locs, columbus, "exp")
plot(col.gwl$beta[2,], col.gwl$beta[3,])
plot(columbus$x, columbus$y, cex=col.gwl$beta[1,]/10)
</code></pre>


</div>