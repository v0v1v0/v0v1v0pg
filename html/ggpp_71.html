<div class="container">

<table style="width: 100%;"><tr>
<td>position_stacknudge</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combined positions stack and nudge</h2>

<h3>Description</h3>

<p><code>position_stacknudge()</code> is useful when labelling plots such as stacked
bars, stacked columns, stacked lines, etc. In contrast to
<code>position_nudge</code>, <code>position_stacknudge()</code> returns
in <code>data</code> both the original coordinates and the nudged coordinates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">position_stacknudge(
  vjust = 1,
  reverse = FALSE,
  x = 0,
  y = 0,
  direction = c("none", "split", "split.x", "split.y"),
  kept.origin = c("stacked", "original", "none")
)

position_fillnudge(
  vjust = 1,
  reverse = FALSE,
  x = 0,
  y = 0,
  direction = c("none", "split", "split.x", "split.y"),
  kept.origin = c("stacked", "original", "none")
)

position_stack_keep(vjust = 1, reverse = FALSE, kept.origin = "original")

position_fill_keep(vjust = 1, reverse = FALSE, kept.origin = "original")

position_stack_minmax(
  vjust = 1,
  reverse = FALSE,
  x = 0,
  y = 0,
  direction = c("none", "split", "split.x", "split.y"),
  kept.origin = c("stacked", "original", "none")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vjust</code></td>
<td>
<p>Vertical adjustment for geoms that have a position (like points
or lines), not a dimension (like bars or areas). Set to 0 to align with the
bottom, 0.5 for the middle, and 1 (the default) for the top.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reverse</code></td>
<td>
<p>If TRUE, will reverse the default stacking order. This is
useful if you're rotating both the plot and legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Amount of vertical and horizontal distance to move. A numeric
vector of length 1, or of the same length as rows there are in <code>data</code>,
with nudge values in data rows order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>One of <code>"none"</code>, <code>"split"</code>, <code>"split.x"</code> or
<code>"split.y"</code>. A value of <code>"none"</code> replicates the behavior of
<code>position_nudge</code>. At the moment <code>"split"</code> changes
the sign of the nudge at zero, which is suitable for column plots with
negative slices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kept.origin</code></td>
<td>
<p>One of <code>"original"</code>, <code>"stacked"</code> or
<code>"none"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>position_fillnudge()</code> is useful when labelling plots such as filled
bars, filled columns, filled lines, etc. In contrast to
<code>position_nudge</code>, <code>position_fillnudge()</code> returns
in <code>data</code> both the original coordinates and the nudged coordinates.
</p>
<p>The wrapper <code>position_nudge_keep()</code> has the same signature and
behaviour as <code>position_nudge</code> nad provides an easier to
remember name when the need is only to have access to both the original and
nudged coordinates.
</p>
<p>These position functions are backwards compatible with
<code>position_nudge</code> but extends it by adding support for
stacking and for geometries that make use of the original position to draw
connecting segments or arrows.
</p>
<p>The wrapper <code>position_stack_keep()</code> has the same signature and
behaviour as <code>position_stack</code> and provides an easier to
remember name when the need is only to have access to both the original and
nudged coordinates.
</p>
<p>The wrapper <code>position_fill_keep()</code> has the same signature and
behaviour as <code>position_fill</code> and provides an easier to
remember name when the need is only to have access to both the original and
nudged coordinates.
</p>
<p>The wrapper <code>position_stack_minmax()</code> has the same signature and
behaviour as <code>position_stacknudge</code> but stacks y, ymin and
ymax in parallel, making it possible to stack summaries with error bars,
works correctly with <code>geom_pointrange()</code>, <code>geom_linerange()</code> and
<code>geom_errorbar()</code>.
</p>


<h3>Value</h3>

<p>A <code>"Position"</code> object.
</p>


<h3>Author(s)</h3>

<p>Micha≈Ç Krassowski, edited by Pedro J. Aphalo.
</p>


<h3>Source</h3>

<p><a href="https://github.com/slowkow/ggrepel/issues/161">https://github.com/slowkow/ggrepel/issues/161</a>.
</p>


<h3>See Also</h3>

<p><code>position_nudge</code>,
<code>position_stack</code>,
<code>position_nudge_repel</code>.
</p>
<p>Other position adjustments: 
<code>position_dodgenudge()</code>,
<code>position_jitternudge()</code>,
<code>position_nudge_center()</code>,
<code>position_nudge_keep()</code>,
<code>position_nudge_line()</code>,
<code>position_nudge_to()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
df &lt;- data.frame(x1 = c("a", "a", "b", "b", "b"),
                 x2 = c(1, 2, 1, 3, -1),
                 grp = c("some long name", "other name", "some name",
                         "another name", "some long name"))

# Add labels to a horizontal column plot (stacked by default)
ggplot(data = df, aes(x1, x2, group = grp)) +
  geom_col(aes(fill = grp), width=0.5) +
  geom_vline(xintercept = 0) +
  geom_text(
    aes(label = grp),
    position = position_stacknudge(vjust = 0.5, y = 0.3)) +
  theme(legend.position = "none")

# Add labels to a vertical column plot (stacked by default)
ggplot(data = df, aes(x2, x1, group = grp)) +
  geom_col(aes(fill = grp), width=0.5) +
  geom_vline(xintercept = 0) +
  geom_text(
    aes(label = grp),
    position = position_stacknudge(vjust = 0.5, x = -0.3),
    angle = 90) +
  theme(legend.position = "none")

# Add labels to a vertical column plot (stacked by default)
ggplot(data = subset(df, x1 &gt;= 0), aes(x1, x2, group = grp)) +
  geom_col(aes(fill = grp), width=0.5, position = position_fill()) +
  geom_vline(xintercept = 0) +
  geom_text(
    aes(label = grp),
    position = position_fillnudge(vjust = 0.5, x = -0.3),
    angle = 90) +
  theme(legend.position = "none")

# Add label at a fixed distance from the top of each column slice
ggplot(data = df, aes(x1, x2, group = grp)) +
  geom_col(aes(fill = grp), width=0.5) +
  geom_vline(xintercept = 0) +
  geom_text(
    aes(label = grp),
    position = position_stacknudge(vjust = 1, y = -0.2)) +
  theme(legend.position = "none")

# Use geom_text_s(), geom_text_repel() or geom_label_repel() to link
# label to labelled segment or object with an arrow
ggplot(data = df, aes(x2, x1, group = grp)) +
  geom_col(aes(fill = grp), width=0.5) +
  geom_vline(xintercept = 0) +
  geom_text_s(
    aes(label = grp),
    position = position_stacknudge(vjust = 0.5, y = 0.35),
    vjust = "bottom") +
  theme(legend.position = "none")

ggplot(birch_dw.df,
       aes(y = dry.weight * 1e-3, x = Density, fill = Part)) +
   stat_summary(geom = "col", fun = mean,
                position = "stack", alpha = 0.7, width = 0.67) +
   stat_summary(geom = "linerange", fun.data = mean_cl_normal,
                position = position_stack_minmax()) +
  labs(y = "Seedling dry mass (g)") +
  scale_fill_grey(start = 0.7, end = 0.3) +
  facet_wrap(facets = vars(Container))

</code></pre>


</div>