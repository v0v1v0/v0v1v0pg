<div class="container">

<table style="width: 100%;"><tr>
<td>vdtest.lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for Varying Dispersion Parameter in Normal Linear Models</h2>

<h3>Description</h3>

<p>Performs Rao's score test for varying dispersion parameter in weighted and unweighted normal linear models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lm'
vdtest(model, varformula, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an object of the class <em>lm</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varformula</code></td>
<td>
<p>an (optional) <code>formula</code> expression of the form <code>~ z1 + z2 + ... + zq</code> indicating the potential explanatory variables for the dispersion parameter. As default, the same explanatory variables are taken as in the model for the mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>From the heteroskedastic normal linear model in which
<code class="reqn">\log(\sigma^2)=\gamma_0 + \gamma_1z_1 + \gamma_2z_2 + ...+ \gamma_qz_q</code>, where
<code class="reqn">\sigma^2</code> is the dispersion parameter of the distribution of the
random errors, the Rao's score test (denoted here as <code class="reqn">S</code>) to assess the
hypothesis <code class="reqn">H_0: \gamma=0</code> versus <code class="reqn">H_1: \gamma\neq 0</code> is computed,
where <code class="reqn">\gamma=(\gamma_1,\ldots,\gamma_q)</code>. The corresponding <em>p</em>-value is
computed from the chi-squared distribution with <code class="reqn">q</code> degrees of freedom,
that is, <em>p</em>-value = Prob<code class="reqn">[\chi^2_{q} &gt; S]</code>. If the object
<code>model</code> corresponds to an unweighted normal linear model, then the
test assess the assumption of constant variance, which coincides with the
non-studentized Breusch-Pagan test against heteroskedasticity.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
<td style="text-align: left;">
<code>statistic</code> </td>
<td style="text-align: left;"> value of the Rao's score test (<code class="reqn">S</code>),</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>df</code>        </td>
<td style="text-align: left;"> number of degrees of freedom (<code class="reqn">q</code>),</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>p.value</code>   </td>
<td style="text-align: left;"> <em>p</em>-value of the test,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>vars</code>   </td>
<td style="text-align: left;"> names of explanatory variables for the dispersion parameter,</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Breusch T.S., Pagan A.R. (1979) A simple test for heteroscedasticity and random coefficient variation. <em>Econometrica</em> 47, 1287–1294.
</p>
<p>Cook R.D., Weisberg S. (1983) Diagnostics for heteroscedasticity in regression. <em>Biometrika</em> 70, 1–10.
</p>


<h3>See Also</h3>

<p>vdtest.glm
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Example 1: Fuel consumption of automobiles
fit1 &lt;- lm(mpg ~ log(hp) + log(wt), data=mtcars)
vdtest(fit1)
vdtest(fit1,varformula = ~ hp + wt)
vdtest(fit1,varformula = ~ hp + wt + hp*wt)

###### Example 2: Species richness in plots
data(richness)
fit2 &lt;- lm(Species ~ Biomass + pH, data=richness)
vdtest(fit2)

### The test conclusions change when the outlying observations are excluded
fit2a &lt;- lm(Species ~ Biomass + pH, data=richness, subset=-c(1,3,18,20))
vdtest(fit2a)

###### Example 3: Gas consumption in a home before and after insulation
whiteside &lt;- MASS::whiteside
fit3 &lt;- lm(Gas ~ Temp + Insul + Temp*Insul, data=whiteside)
vdtest(fit3)

### The test conclusions change when the outlying observations are excluded
fit3a &lt;- lm(Gas ~ Temp + Insul + Temp*Insul, data=whiteside, subset=-c(8,9,36,46,55))
vdtest(fit3a)

</code></pre>


</div>