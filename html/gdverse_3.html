<div class="container">

<table style="width: 100%;"><tr>
<td>cpsd_disc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>optimal spatial data discretization based on SPADE q-statistics</h2>

<h3>Description</h3>

<p>Function for determining the optimal spatial data discretization based on SPADE q-statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpsd_disc(
  formula,
  data,
  wt,
  discnum = 3:22,
  discmethod = "quantile",
  strategy = 2L,
  increase_rate = 0.05,
  cores = 1,
  return_disc = TRUE,
  seed = 123456789,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula of optimal spatial data discretization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame or tibble of observation data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>The spatial weight matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discnum</code></td>
<td>
<p>(optional) A vector of number of classes for discretization. Default is <code>3:22</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discmethod</code></td>
<td>
<p>(optional) The discretization methods. Default all use <code>quantile</code>.
Noted that <code>robust</code> will use <code>robust_disc()</code>; <code>rpart</code> will use <code>rpart_disc()</code>;
Others use <code>sdsfun::discretize_vector()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strategy</code></td>
<td>
<p>(optional) Discretization strategy. When <code>strategy</code> is <code>1L</code>, choose the highest SPADE model q-statistics to
determinate optimal spatial data discretization parameters. When <code>strategy</code> is <code>2L</code>, The optimal discrete parameters of
spatial data are selected by combining LOESS model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>increase_rate</code></td>
<td>
<p>(optional) The critical increase rate of the number of discretization.
Default is <code style="white-space: pre;">⁠5%⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>(optional) A positive integer(default is 1). If cores &gt; 1, a 'parallel' package
cluster with that many cores is created and used. You can also supply a cluster
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_disc</code></td>
<td>
<p>(optional) Whether or not return discretized result used the optimal parameter.
Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>(optional) Random seed number, default is <code>123456789</code>.Setting random seed is useful when
the sample size is greater than <code>3000</code>(the default value for <code>largeN</code>) and the data is discretized
by sampling <code style="white-space: pre;">⁠10%⁠</code>(the default value for <code>samp_prop</code> in <code>st_unidisc()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(optional) Other arguments passed to <code>st_unidisc()</code>,<code>robust_disc()</code> or <code>rpart_disc()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the optimal parameter in the provided parameter combination with <code>k</code>,
<code>method</code> and <code>disc</code>(when <code>return_disc</code> is <code>TRUE</code>).
</p>

<dl>
<dt><code>x</code></dt>
<dd>
<p>discretization variable name</p>
</dd>
<dt><code>k</code></dt>
<dd>
<p>optimal number of spatial data discreteization</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>optimal spatial data discretization method</p>
</dd>
<dt><code>disc</code></dt>
<dd>
<p>the result of optimal spatial data discretization</p>
</dd>
</dl>
<h3>Note</h3>

<p>When the <code>discmethod</code> is configured to <code>robust</code>, it will operate at a significantly reduced speed.
Consequently, the use of robust discretization is not advised.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Yongze Song &amp; Peng Wu (2021) An interactive detector for spatial associations,
International Journal of Geographical Information Science, 35:8, 1676-1701,
DOI:10.1080/13658816.2021.1882680
</p>


<h3>Examples</h3>

<pre><code class="language-R">data('sim')
wt = inverse_distance_weight(sim$lo,sim$la)
cpsd_disc(y ~ xa + xb + xc,
          data = sim,
          wt = wt)

</code></pre>


</div>