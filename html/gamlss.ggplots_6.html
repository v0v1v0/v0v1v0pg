<div class="container">

<table style="width: 100%;"><tr>
<td>centile_bucket</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Centile bucket plot
</h2>

<h3>Description</h3>

<p>A bucket plot is a graphical way to check the skewness and kurtosis of a continuous variable or the residuals of a fitted GAMLSS model. It plots the centile skewness (tail or central) and  transformed centile kurtosis of the variable (or residuals) together with a cloud of points obtained using a non-parametric bootstrap from the original variable (or residuals). It also provides a graphical way of performing a Monte Carlo simulation test on whether the centile skewness and transformed centile kurtosis of the variable of interest are simultaneously equal to zero. 
</p>
<p>There are two function here:
</p>
<p>i) <code>cenlile_bucket()</code> for a single bucket plot. Note that  <code>model_cent_bucket()</code>  and <code>centile_bucket()</code> are synonymous.
</p>
<p>ii) <code>centile_bucket_wrap()</code> for multiple bucket plots cut according to  terms in the model. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">centile_bucket(x, ..., type = c("tail", "central"), weights = NULL, 
       no_bootstrap = 99, col_bootstrap = hcl.colors(length.obj, 
       palette = "Set 2"), alpha_bootstrap = 1, text_to_show = NULL, 
       cex_text = 5, col_text = "black", colour_bucket = FALSE, 
       line_width = 0.5, sim_test = FALSE, no_sim_test = 1000, 
       col_sim_test = gray(0.7), alpha_sim_test = 0.1, seed_test = 1234)

model_cent_bucket(x, ..., type = c("tail", "central"), weights = NULL, 
       no_bootstrap = 99, col_bootstrap = hcl.colors(length.obj, 
       palette = "Set 2"), alpha_bootstrap = 1, text_to_show = NULL, 
       cex_text = 5, col_text = "black", colour_bucket = FALSE, 
       line_width = 0.5, sim_test = FALSE, no_sim_test = 1000, 
       col_sim_test = gray(0.7), alpha_sim_test = 0.1, seed_test = 1234)


centile_bucket_wrap(x, ..., type = c("tail", "central"), weights = NULL, 
      xvar = NULL, n_inter = 4, no_bootstrap = 99, 
      col_bootstrap = hcl.colors(length.obj, palette = "Set 2"), 
      alpha_bootstrap = 1, text_to_show = NULL, check_overlap_text = FALSE, 
      cex_text = 5, col_text = "black", colour_bucket = FALSE, 
      line_width = 0.5, sim_test = FALSE, no_sim_test = 1000, 
      col_sim_test = gray(0.7), alpha_sim_test = 0.1, seed_test = 1234)       
       
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x should be a continuous vector of a GAMLSS fitted model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for more that one continuous vectors or fitted models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>whether "tail" of "central" skewness and kurtosis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>if priors weights are needed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_bootstrap</code></td>
<td>
<p>the number of bootstrap samples for the cloud around the point of skewness and kurtosis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_bootstrap</code></td>
<td>
<p>The colour of the bootstrap samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_bootstrap</code></td>
<td>
<p>The transparency parameter of the bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_to_show</code></td>
<td>
<p>what text to show in the plots, default the names of vectors or models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex_text</code></td>
<td>
<p>the character size of the text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_text</code></td>
<td>
<p>the colour of the text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colour_bucket</code></td>
<td>
<p>whether colour or gray lines in the bucket</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line_width</code></td>
<td>
<p>the line width</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_test</code></td>
<td>
<p>whether to Monde Carlo simulation is needed to check the null hypothesis that there is no centile skewness and transformed centile kurtosis in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_sim_test</code></td>
<td>
<p>The number of simulation for the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_sim_test</code></td>
<td>
<p>the colour used for displaying the Monde Carlo test values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_sim_test</code></td>
<td>
<p>The transparency parameter of the Monde Carlo samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed_test</code></td>
<td>
<p>A seed value for the Monde Carlo simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>the x term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_inter</code></td>
<td>
<p>how many intervals needed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_overlap_text</code></td>
<td>
<p>whether to check overlapping text</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>More details about centile bucket plots is given in De Bastiani <em>et al.</em> (2022)
</p>


<h3>Value</h3>

<p>A plot displaying the centile skewness and  transformed centile kurtosis of the sample or residual of a model.
</p>


<h3>Note</h3>

<p>The  bucket plot provides an additional residual diagnostic tool that can be used for fitted model checking, alongside other diagnostic tools, for example   worm plots, and Q (and Z) statistics.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>De Bastiani, F.,   Stasinopoulos, D. M., Rigby, R. A., Heller, G. Z., and Lucas A. (2022) Bucket Plot: A Visual Tool for Skewness and Kurtosis Comparisons. To be  published.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>
An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://doi.org/10.18637/jss.v023.i07">doi:10.18637/jss.v023.i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>Stasinopoulos, M. D., Rigby, R. A., and De Bastiani F., (2018) GAMLSS: a distributional regression approach, <em>Statistical Modelling</em>, Vol. <b>18</b>, pp, 248-273, SAGE Publications Sage India: New Delhi, India.
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code>wp, Q.stats</code></p>


<h3>Examples</h3>

<pre><code class="language-R">m1 &lt;- gamlss(R~pb(Fl)+pb(A), data=rent, family=GA)
centile_bucket(m1)

centile_bucket_wrap(m1, xvar=rent$A)

</code></pre>


</div>