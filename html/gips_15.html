<div class="container">

<table style="width: 100%;"><tr>
<td>log_posteriori_of_gips</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A log of a posteriori that the covariance matrix is invariant under permutation</h2>

<h3>Description</h3>

<p>More precisely, it is the logarithm of an unnormalized
posterior probability. It is the goal function for
optimization algorithms in the <code>find_MAP()</code> function.
The <code>perm_proposal</code> that maximizes this function is
the Maximum A Posteriori (MAP) Estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">log_posteriori_of_gips(g)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>An object of a <code>gips</code> class.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>It is calculated using
<a href="https://arxiv.org/abs/2004.03503">formulas (33) and (27) from references</a>.
</p>
<p>If <code>Inf</code> or <code>NaN</code> is reached, it produces a warning.
</p>


<h3>Value</h3>

<p>Returns a value of
the logarithm of an unnormalized A Posteriori.
</p>


<h3>References</h3>

<p>Piotr Graczyk, Hideyuki Ishi, Bartosz Kołodziejek, Hélène Massam.
"Model selection in the space of Gaussian models invariant by symmetry."
The Annals of Statistics, 50(3) 1747-1774 June 2022.
<a href="https://arxiv.org/abs/2004.03503">arXiv link</a>;
<a href="https://doi.org/10.1214/22-AOS2174">doi:10.1214/22-AOS2174</a>
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>calculate_gamma_function()</code> - The function that calculates
the value needed for <code>log_posteriori_of_gips()</code>.
</p>
</li>
<li> <p><code>get_structure_constants()</code> - The function that calculates
the structure constants needed for <code>log_posteriori_of_gips()</code>.
</p>
</li>
<li> <p><code>find_MAP()</code> - The function that optimizes
the <code>log_posteriori_of_gips</code> function.
</p>
</li>
<li> <p><code>compare_posteriories_of_perms()</code> - Uses <code>log_posteriori_of_gips()</code>
to compare a posteriori of two permutations.
</p>
</li>
<li> <p><code>vignette("Theory", package = "gips")</code> or its
<a href="https://przechoj.github.io/gips/articles/Theory.html">pkgdown page</a> -
A place to learn more about the math behind the <code>gips</code> package.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># In the space with p = 2, there is only 2 permutations:
perm1 &lt;- permutations::as.cycle("(1)(2)")
perm2 &lt;- permutations::as.cycle("(1,2)")
S1 &lt;- matrix(c(1, 0.5, 0.5, 2), nrow = 2, byrow = TRUE)
g1 &lt;- gips(S1, 100, perm = perm1)
g2 &lt;- gips(S1, 100, perm = perm2)
log_posteriori_of_gips(g1) # -134.1615, this is the MAP Estimator
log_posteriori_of_gips(g2) # -138.1695

exp(log_posteriori_of_gips(g1) - log_posteriori_of_gips(g2)) # 55.0
# g1 is 55 times more likely than g2.
# This is the expected outcome because S[1,1] significantly differs from S[2,2].

compare_posteriories_of_perms(g1, g2)
# The same result, but presented in a more pleasant way

# ========================================================================

S2 &lt;- matrix(c(1, 0.5, 0.5, 1.1), nrow = 2, byrow = TRUE)
g1 &lt;- gips(S2, 100, perm = perm1)
g2 &lt;- gips(S2, 100, perm = perm2)
log_posteriori_of_gips(g1) # -98.40984
log_posteriori_of_gips(g2) # -95.92039, this is the MAP Estimator

exp(log_posteriori_of_gips(g2) - log_posteriori_of_gips(g1)) # 12.05
# g2 is 12 times more likely than g1.
# This is the expected outcome because S[1,1] is very close to S[2,2].

compare_posteriories_of_perms(g2, g1)
# The same result, but presented in a more pleasant way
</code></pre>


</div>