<div class="container">

<table style="width: 100%;"><tr>
<td>NegBinomGLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized linear model with negative binomial distribution</h2>

<h3>Description</h3>

<p>This class represents a generalized linear model with negative
binomial distribution. It inherits from GLM and implements its functions
that, for example, evaluate the conditional density and distribution
functions.
</p>


<h3>Super classes</h3>

<p><code>gofreg::ParamRegrModel</code> -&gt; <code>gofreg::GLM</code> -&gt; <code>NegBinomGLM</code>
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-NegBinomGLM-fit"><code>NegBinomGLM$fit()</code></a>
</p>
</li>
<li> <p><a href="#method-NegBinomGLM-f_yx"><code>NegBinomGLM$f_yx()</code></a>
</p>
</li>
<li> <p><a href="#method-NegBinomGLM-F_yx"><code>NegBinomGLM$F_yx()</code></a>
</p>
</li>
<li> <p><a href="#method-NegBinomGLM-F1_yx"><code>NegBinomGLM$F1_yx()</code></a>
</p>
</li>
<li> <p><a href="#method-NegBinomGLM-sample_yx"><code>NegBinomGLM$sample_yx()</code></a>
</p>
</li>
<li> <p><a href="#method-NegBinomGLM-clone"><code>NegBinomGLM$clone()</code></a>
</p>
</li>
</ul>
<details open><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="gofreg" data-topic="ParamRegrModel" data-id="get_params"><a href="../../gofreg/html/ParamRegrModel.html#method-ParamRegrModel-get_params"><code>gofreg::ParamRegrModel$get_params()</code></a></span></li>
<li><span class="pkg-link" data-pkg="gofreg" data-topic="ParamRegrModel" data-id="set_params"><a href="../../gofreg/html/ParamRegrModel.html#method-ParamRegrModel-set_params"><code>gofreg::ParamRegrModel$set_params()</code></a></span></li>
<li><span class="pkg-link" data-pkg="gofreg" data-topic="GLM" data-id="initialize"><a href="../../gofreg/html/GLM.html#method-GLM-initialize"><code>gofreg::GLM$initialize()</code></a></span></li>
<li><span class="pkg-link" data-pkg="gofreg" data-topic="GLM" data-id="mean_yx"><a href="../../gofreg/html/GLM.html#method-GLM-mean_yx"><code>gofreg::GLM$mean_yx()</code></a></span></li>
</ul></details><hr>
<a id="method-NegBinomGLM-fit"></a>



<h4>Method <code>fit()</code>
</h4>

<p>Calculates the maximum likelihood estimator for the model
parameters based on given data.
</p>


<h5>Usage</h5>

<div class="r"><pre>NegBinomGLM$fit(
  data,
  params_init = private$params,
  loglik = loglik_xy,
  inplace = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>data</code></dt>
<dd>
<p>tibble containing the data to fit the model to</p>
</dd>
<dt><code>params_init</code></dt>
<dd>
<p>initial value of the model parameters to use for the
optimization (defaults to the fitted parameter values)</p>
</dd>
<dt><code>loglik</code></dt>
<dd>
<p><code style="white-space: pre;">⁠function(data, model, params)⁠</code> defaults to <code>loglik_xy()</code></p>
</dd>
<dt><code>inplace</code></dt>
<dd>
<p><code>logical</code>; if <code>TRUE</code>, default model parameters are set
accordingly and parameter estimator is not returned</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>MLE of the model parameters for the given data, same shape as
<code>params_init</code>
</p>


<hr>
<a id="method-NegBinomGLM-f_yx"></a>



<h4>Method <code>f_yx()</code>
</h4>

<p>Evaluates the conditional density function.
</p>


<h5>Usage</h5>

<div class="r"><pre>NegBinomGLM$f_yx(t, x, params = private$params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>t</code></dt>
<dd>
<p>value(s) at which the conditional density shall be evaluated</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>matrix of covariates, each row representing one sample</p>
</dd>
<dt><code>params</code></dt>
<dd>
<p>model parameters to use (<code>list()</code> with tags beta and shape),
defaults to the fitted parameter values</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>value(s) of the conditional density function, same shape as <code>t</code>
</p>


<hr>
<a id="method-NegBinomGLM-F_yx"></a>



<h4>Method <code>F_yx()</code>
</h4>

<p>Evaluates the conditional distribution function.
</p>


<h5>Usage</h5>

<div class="r"><pre>NegBinomGLM$F_yx(t, x, params = private$params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>t</code></dt>
<dd>
<p>value(s) at which the conditional distribution shall be
evaluated</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>matrix of covariates, each row representing one sample</p>
</dd>
<dt><code>params</code></dt>
<dd>
<p>model parameters to use (<code>list()</code> with tags beta and shape),
defaults to the fitted parameter values</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>value(s) of the conditional distribution function,  same shape as
<code>t</code>
</p>


<hr>
<a id="method-NegBinomGLM-F1_yx"></a>



<h4>Method <code>F1_yx()</code>
</h4>

<p>Evaluates the conditional quantile function.
</p>


<h5>Usage</h5>

<div class="r"><pre>NegBinomGLM$F1_yx(t, x, params = private$params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>t</code></dt>
<dd>
<p>value(s) at which the conditional quantile function shall be
evaluated</p>
</dd>
<dt><code>x</code></dt>
<dd>
<p>matrix of covariates, each row representing one sample</p>
</dd>
<dt><code>params</code></dt>
<dd>
<p>model parameters to use (<code>list()</code> with tags beta and shape),
defaults to the fitted parameter values</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>value(s) of the conditional quantile function, same shape as
<code>t</code>
</p>


<hr>
<a id="method-NegBinomGLM-sample_yx"></a>



<h4>Method <code>sample_yx()</code>
</h4>

<p>Generates a new sample of response variables with the same
conditional distribution.
</p>


<h5>Usage</h5>

<div class="r"><pre>NegBinomGLM$sample_yx(x, params = private$params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>matrix of covariates, each row representing one sample</p>
</dd>
<dt><code>params</code></dt>
<dd>
<p>model parameters to use (<code>list()</code> with tags beta and shape),
defaults to the fitted parameter values</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>vector of sampled response variables, same length as <code>nrow(x)</code>
</p>


<hr>
<a id="method-NegBinomGLM-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>NegBinomGLM$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R"># Use the built-in cars dataset
x &lt;- datasets::cars$speed
y &lt;- datasets::cars$dist
data &lt;- dplyr::tibble(x=x, y=y)

# Create an instance of a NegBinomGLM
model &lt;- NegBinomGLM$new()

# Fit a Negative Binomial GLM to the cars dataset
model$fit(data, params_init = list(beta=3, shape=2), inplace=TRUE)
params_opt &lt;- model$get_params()

# Plot the resulting regression function
plot(datasets::cars)
abline(a = 0, b = params_opt$beta)

# Generate a sample for y for given x following the same distribution
x.new &lt;- seq(min(x), max(x), by=2)
y.smpl &lt;- model$sample_yx(x.new)
points(x.new, y.smpl, col="red")

# Evaluate the conditional density, distribution, quantile and regression
# function at given values
model$f_yx(y.smpl, x.new)
model$F_yx(y.smpl, x.new)
model$F1_yx(y.smpl, x.new)
y.pred &lt;- model$mean_yx(x.new)
points(x.new, y.pred, col="blue")
</code></pre>


</div>