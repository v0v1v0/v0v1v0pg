<div class="container">

<table style="width: 100%;"><tr>
<td>fit_spline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Exponential Growth Model with Smoothing Spline</h2>

<h3>Description</h3>

<p>Determine maximum growth rates from the first derivative of a smoothing spline.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_spline(time, y, optgrid = length(time), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>vector of independent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of dependent variable (concentration of organisms).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optgrid</code></td>
<td>
<p>number of steps on the x-axis used for the optimum search .
algorithm. The default should work in most cases, as long as the data are equally spaced.
A smaller number may lead to non-detectable speed-up, but has the risk that
the search gets trapped in a local minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed to <code>smooth.spline</code>, see details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method was inspired by an algorithm of Kahm et al. (2010),
with different settings and assumptions. In the moment, spline fitting
is always done with log-transformed data, assuming exponential growth
at the time point of the maximum of the first derivative of the spline fit.
</p>
<p>All the hard work is done by function <code>smooth.spline</code> from package
<span class="pkg">stats</span>, that is highly user configurable. Normally, smoothness is
automatically determined via cross-validation. This works well in many cases,
whereas manual adjustment is required otherwise, e.g. by setting <code>spar</code>
to a fixed value <code class="reqn">[0, 1]</code> that also disables cross-validation.
</p>


<h3>Value</h3>

<p>object with parameters of the fit
</p>


<h3>References</h3>

<p>Kahm, M., Hasenbrink, G., Lichtenberg-Frate, H., Ludwig, J., Kschischo, M.
2010. grofit: Fitting Biological Growth Curves with R.
Journal of Statistical Software, 33(7), 1-21,
<a href="https://doi.org/10.18637/jss.v033.i07">doi:10.18637/jss.v033.i07</a>
</p>


<h3>See Also</h3>

<p>Other fitting functions: 
<code>all_easylinear()</code>,
<code>all_growthmodels()</code>,
<code>all_splines()</code>,
<code>fit_easylinear()</code>,
<code>fit_growthmodel()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(bactgrowth)
splitted.data &lt;- multisplit(bactgrowth, c("strain", "conc", "replicate"))

dat &lt;- splitted.data[[2]]
time &lt;- dat$time
y    &lt;- dat$value

## automatic smoothing with cv
res &lt;- fit_spline(time, y)

plot(res, log="y")
plot(res)
coef(res)

## a more difficult data set
dat &lt;- splitted.data[[56]]
time &lt;- dat$time
y &lt;- dat$value

## default parameters
res &lt;- fit_spline(time, y)
plot(res, log="y")

## small optgrid, trapped in local minimum
res &lt;- fit_spline(time, y, optgrid=5)
plot(res, log="y")

## manually selected smoothing parameter
res &lt;- fit_spline(time, y, spar=.5)
plot(res, log="y")
plot(res, ylim=c(0.005, 0.03))


</code></pre>


</div>