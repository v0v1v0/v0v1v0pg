<div class="container">

<table style="width: 100%;"><tr>
<td>glmmboot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Linear Models with fixed effects grouping</h2>

<h3>Description</h3>

<p>Fits grouped GLMs with fixed group effects. The significance of the
grouping is tested by simulation, with a bootstrap approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glmmboot(formula, family = binomial, data, cluster, weights, subset, na.action,
offset, contrasts = NULL, start.coef = NULL,
control = list(epsilon = 1e-08, maxit = 200, trace = FALSE), boot = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fit. The details of
model specification are given below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Currently, the only valid values are <code>binomial</code> and
<code>poisson</code>. The binomial family allows for the <code>logit</code> and
<code>cloglog</code> links.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from
‘environment(formula)’, typically the environment from which
‘glmmML’ is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Factor indicating which items are correlated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Case weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>See glm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an a priori known component to be
included in the linear predictor during fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list. See the 'contrasts.arg' of 'model.matrix.default'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.coef</code></td>
<td>
<p>starting values for the parameters in the linear predictor.
Defaults to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Controls the convergence criteria. See
<code>glm.control</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>number of bootstrap replicates. If equal to zero, no test
of significance of the grouping factor is performed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simulation is performed by 
simulating new response vectors from the fitted probabilities without
clustering, and comparing the maximized log likelihoods. The
maximizations are performed by profiling out the grouping factor. It is
a very fast procedure, compared to <code>glm</code>, when the grouping
factor has many levels.</p>


<h3>Value</h3>

<p>The return value is a list, an object of class 'glmmboot'.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Estimated regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the max log likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.null.deviance</code></td>
<td>
<p>Deviance without the clustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frail</code></td>
<td>
<p>The estimated cluster effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootLog</code></td>
<td>
<p>The logLik values from the bootstrap samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootP</code></td>
<td>
<p>Bootstrap p value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>Variance covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Standard error of regression parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot_rep</code></td>
<td>
<p>No. of bootstrap replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixed</code></td>
<td>
<p>Logical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>Deviance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>Its degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AIC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Logical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The function call</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>There is no overall intercept for this model; each cluster has its
own intercept. See <code>frail</code></p>


<h3>Author(s)</h3>

<p>G\"oran Brostr\"om and Henrik Holmberg</p>


<h3>References</h3>

<p>Brostr\"om, G. and Holmberg, H. (2011). Generalized linear models with
clustered data: Fixed and random effects models. Computational
Statistics and Data Analysis 55:3123-3134.</p>


<h3>See Also</h3>

<p><code>link{glmmML}</code>, <code>optim</code>,
<code>lmer</code> in <code>Matrix</code>, and 
<code>glmmPQL</code> in <code>MASS</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run:
id &lt;- factor(rep(1:20, rep(5, 20)))
y &lt;- rbinom(100, prob = rep(runif(20), rep(5, 20)), size = 1)
x &lt;- rnorm(100)
dat &lt;- data.frame(y = y, x = x, id = id)
res &lt;- glmmboot(y ~ x, cluster = id, data = dat, boot = 5000)
## End(Not run)
##system.time(res.glm &lt;- glm(y ~ x + id, family = binomial))
</code></pre>


</div>