<div class="container">

<table style="width: 100%;"><tr>
<td>gqz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Schur decomposition</h2>

<h3>Description</h3>

<p>Computes the generalized eigenvalues and Schur form of a pair of matrices.</p>


<h3>Usage</h3>

<pre><code class="language-R">gqz(A, B, sort=c("N","-","+","S","B","R"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>left hand side matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>right hand side matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>how to sort the generalized eigenvalues. See ‘Details’.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Both matrices must be square.
This function provides the solution to the generalized eigenvalue problem defined by
</p>
<p style="text-align: center;"><code class="reqn">A x = \lambda Bx</code>
</p>

<p>If either one of the matrices is complex the other matrix is coerced to be complex.
</p>
<p>The <code>sort</code> argument specifies how to order the eigenvalues on the
diagonal of the generalized Schur form, where it is noted that non-finite eigenvalues never
satisfy any ordering condition (even in the case of a complex infinity).
Eigenvalues that are placed in the leading block of the Schur form
satisfy
</p>

<dl>
<dt><code>N</code></dt>
<dd>
<p>unordered.</p>
</dd>
<dt><code>-</code></dt>
<dd>
<p>negative real part.</p>
</dd>
<dt><code>+</code></dt>
<dd>
<p>positive real part.</p>
</dd>
<dt><code>S</code></dt>
<dd>
<p>absolute value &lt; 1.</p>
</dd>
<dt><code>B</code></dt>
<dd>
<p>absolute value &gt; 1.</p>
</dd>
<dt><code>R</code></dt>
<dd>
<p>imaginary part identical to 0 with a tolerance of 100*machine_precision as determined by Lapack.</p>
</dd>
</dl>
<h3>Value</h3>

<p>The generalized Schur form for <em>numeric</em> matrices is
</p>
<p style="text-align: center;"><code class="reqn"> (A,B) = (Q S Z^T, Q T Z^T)</code>
</p>

<p>The matrices <code class="reqn">Q</code> and <code class="reqn">Z</code> are orthogonal. The matrix <code class="reqn">S</code> is quasi-upper triangular and
the matrix <code class="reqn">T</code> is upper triangular.
The return value is a list containing the following components
</p>

<dl>
<dt><code>S</code></dt>
<dd>
<p>generalized Schur form of A.</p>
</dd>
<dt><code>T</code></dt>
<dd>
<p>generalized Schur form of B.</p>
</dd>
<dt><code>sdim</code></dt>
<dd>
<p>the number of eigenvalues (after sorting) for which the sorting condition is true.</p>
</dd>
<dt><code>alphar</code></dt>
<dd>
<p>numerator of the real parts of the eigenvalues (numeric).</p>
</dd>
<dt><code>alphai</code></dt>
<dd>
<p>numerator of the imaginary parts of the eigenvalues (numeric).</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>denominator of the expression for the eigenvalues (numeric).</p>
</dd>
<dt><code>Q</code></dt>
<dd>
<p>matrix of left Schur vectors (matrix Q).</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>matrix of right Schur vectors (matrix Z).</p>
</dd>
</dl>
<p>The generalized Schur form for <em>complex</em> matrices is
</p>
<p style="text-align: center;"><code class="reqn">(A,B) = (Q S Z^H, Q T Z^H)</code>
</p>

<p>The matrices <code class="reqn">Q</code> and <code class="reqn">Z</code> are unitary and the matrices <code class="reqn">S</code> and
<code class="reqn">T</code> are upper triangular.
The return value is a list containing the following components
</p>

<dl>
<dt><code>S</code></dt>
<dd>
<p>generalized Schur form of A.</p>
</dd>
<dt><code>T</code></dt>
<dd>
<p>generalized Schur form of B.</p>
</dd>
<dt><code>sdim</code></dt>
<dd>
<p>the number of eigenvalues. (after sorting) for which the sorting condition is true.</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>numerator of the eigenvalues (complex).</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>denominator of the eigenvalues (complex).</p>
</dd>
<dt><code>Q</code></dt>
<dd>
<p>matrix of left Schur vectors (matrix Q).</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>matrix of right Schur vectors (matrix Z).</p>
</dd>
</dl>
<p>The generalized eigenvalues can be computed by calling function <code>gevalues</code>.
</p>


<h3>Source</h3>

<p><code>gqz</code> uses the LAPACK routines <code>DGGES</code> and <code>ZGGES</code>.
LAPACK is from <a href="http://www.netlib.org/lapack">http://www.netlib.org/lapack</a>.
The complex routines used by the package come from LAPACK 3.8.0.
</p>


<h3>References</h3>

<p>Anderson. E. and ten others (1999)
<em>LAPACK Users' Guide</em>.  Third Edition.  SIAM.<br>
Available on-line at
<a href="http://www.netlib.org/lapack/lug/lapack_lug.html">http://www.netlib.org/lapack/lug/lapack_lug.html</a>.
See the section <em>Eigenvalues, Eigenvectors and Generalized Schur Decomposition</em>
(<a href="http://www.netlib.org/lapack/lug/node56.html">http://www.netlib.org/lapack/lug/node56.html</a>).
</p>


<h3>See Also</h3>

<p><code>geigen</code>, <code>gevalues</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Real matrices
# example from NAG: http://www.nag.com/lapack-ex/node116.html
# Find the generalized Schur decomposition with the real eigenvalues ordered to come first

A &lt;- matrix(c(  3.9, 12.5,-34.5,-0.5,
                4.3, 21.5,-47.5, 7.5,
                4.3, 21.5,-43.5, 3.5,
                4.4, 26.0,-46.0, 6.0), nrow=4, byrow=TRUE)

B &lt;- matrix(c( 1.0, 2.0, -3.0, 1.0,
               1.0, 3.0, -5.0, 4.0,
               1.0, 3.0, -4.0, 3.0,
               1.0, 3.0, -4.0, 4.0), nrow=4, byrow=TRUE)

z &lt;- gqz(A, B,"R")
z

# complexify
A &lt;- A+0i
B &lt;- B+0i
z &lt;- gqz(A, B,"R")
z
</code></pre>


</div>