<div class="container">

<table style="width: 100%;"><tr>
<td>elem-flmfr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariate, error, and kernel of a functional linear model
with functional response</h2>

<h3>Description</h3>

<p>Simulation of <code class="reqn">X</code>, a random variable in the Hilbert space
of square-integrable functions in <code class="reqn">[a, b]</code>, <code class="reqn">L^2([a, b])</code>, and
<code class="reqn">\varepsilon</code>, a random variable in <code class="reqn">L^2([c, d])</code>.
Together with the bivariate kernel <code class="reqn">\beta</code>, they are the necessary
elements for sampling a Functional Linear Model with  Functional Response
(FLMFR):
</p>
<p style="text-align: center;"><code class="reqn">Y(t) = \int_a^b X(s) \beta(s,t) ds + \varepsilon(t).</code>
</p>

<p>The next functions sample <code class="reqn">X</code> and <code class="reqn">\varepsilon</code>, and
construct <code class="reqn">\beta</code>, using different proposals in the literature:
</p>

<ul>
<li>
<p><code>r_cm2013_flmfr</code> is based on the numerical example given in
Section 3 of Crambes and Mas (2013). Termed as S1 in Section 2 of
García-Portugués et al. (2021).
</p>
</li>
<li>
<p><code>r_ik2018_flmfr</code> is based on the numerical example given in
Section 4 of Imaizumi and Kato (2018), but zeroing the first Functional
Principal Components (FPC) coefficients of <code class="reqn">\beta</code> (so the first FPC
are not adequate for estimation). S3 in Section 2 of
García-Portugués et al. (2021).
</p>
</li>
<li>
<p><code>r_gof2021_flmfr</code> gives a numerical example in Section 2
of García-Portugués et al. (2021), denoted therein as S2.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">r_cm2013_flmfr(n, s = seq(0, 1, len = 101), t = seq(0, 1, len = 101),
  std_error = 0.15, n_fpc = 50, concurrent = FALSE)

r_ik2018_flmfr(n, s = seq(0, 1, l = 101), t = seq(0, 1, l = 101),
  std_error = 1.5, parameters = c(1.75, 0.8, 2.4, 0.25), n_fpc = 50,
  concurrent = FALSE)

r_gof2021_flmfr(n, s = seq(0, 1, len = 101), t = seq(0, 1, len = 101),
  std_error = 0.35, concurrent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of trajectories to sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s, t</code></td>
<td>
<p>grid points where functional covariates and responses are valued,
respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std_error</code></td>
<td>
<p>standard deviation of the random variables
involved in the generation of the functional error <code>error_fdata</code>.
Defaults to <code>0.15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_fpc</code></td>
<td>
<p>number of FPC to be taken into account for the data generation.
Must be greater than <code>4</code> when <code>r_ik2018_flmfr</code> is applied, since
the first <code class="reqn">4</code> FPC are null. Defaults to <code>50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concurrent</code></td>
<td>
<p>flag to consider a concurrent FLMFR (degenerate case).
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>vector of parameters, only required for
<code>r_ik2018_flmfr</code>. Defaults to<br><code>c(1.75, 0.8, 2.4, 0.25)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Descriptions of the processes <code class="reqn">X</code> and <code class="reqn">\varepsilon</code>,
and of <code class="reqn">\beta</code> can be seen in the references.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X_fdata</code></td>
<td>
<p>functional covariates, an
<code>fdata</code> object of length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_fdata</code></td>
<td>
<p>functional errors, an
<code>fdata</code> object of length <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>either the matrix with <code class="reqn">\beta(s, t)</code> evaluated at
the <code>argvals</code> of <code>X_fdata</code> and <code>Y_fdata</code> (if
<code>concurrent = FALSE</code>) or a vector with <code class="reqn">\beta(t)</code>
evaluated at the <code>argvals</code> of <code>X_fdata</code> (if
<code>concurrent = TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Javier Álvarez-Liébana.
</p>


<h3>References</h3>

<p>Cardot, H. and Mas, A. (2013). Asymptotics of prediction in functional linear
regression with functional outputs. <em>Bernoulli</em>, 19(5B):2627–2651.
<a href="https://doi.org/10.3150/12-BEJ469">doi:10.3150/12-BEJ469</a>
</p>
<p>Imaizumi, M. and Kato, K. (2018). PCA-based estimation for functional linear
regression with functional responses. <em>Journal of Multivariate
Analysis</em>, 163:15–36. <a href="https://doi.org/10.1016/j.jmva.2017.10.001">doi:10.1016/j.jmva.2017.10.001</a>
</p>
<p>García-Portugués, E., Álvarez-Liébana, J., Álvarez-Pérez, G. and
Gonzalez-Manteiga, W. (2021). A goodness-of-fit test for the functional
linear model with functional response. <em>Scandinavian Journal of
Statistics</em>, 48(2):502–528. <a href="https://doi.org/10.1111/sjos.12486">doi:10.1111/sjos.12486</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># FLMFR based on Imaizumi and Kato (2018) adopting different Hilbert spaces
s &lt;- seq(0, 1, l = 201)
t &lt;- seq(2, 4, l = 301)
r_ik2018 &lt;- r_ik2018_flmfr(n = 50, s = s, t = t, std_error = 1.5,
                           parameters = c(1.75, 0.8, 2.4, 0.25), n_fpc = 50)
plot(r_ik2018$X_fdata)
plot(r_ik2018$error_fdata)
image(x = s, y = t, z = r_ik2018$beta, col = viridisLite::viridis(20))

# FLMFR based on Cardot and Mas (2013) adopting different Hilbert spaces
r_cm2013 &lt;- r_cm2013_flmfr(n = 50, s = s, t = t, std_error = 0.15,
                           n_fpc = 50)
plot(r_cm2013$X_fdata)
plot(r_cm2013$error_fdata)
image(x = s, y = t, z = r_cm2013$beta, col = viridisLite::viridis(20))

# FLMFR in García-Portugués et al. (2021) adopting different Hilbert spaces
r_gof2021 &lt;- r_gof2021_flmfr(n = 50, s = s, t = t, std_error = 0.35,
                             concurrent = FALSE)
plot(r_gof2021$X_fdata)
plot(r_gof2021$error_fdata)
image(x = s, y = t, z = r_gof2021$beta, col = viridisLite::viridis(20))

# Concurrent model in García-Portugués et al. (2021)
r_gof2021 &lt;- r_gof2021_flmfr(n = 50, s = s, t = s, std_error = 0.35,
                             concurrent = TRUE)
plot(r_gof2021$X_fdata)
plot(r_gof2021$error_fdata)
plot(r_gof2021$beta)
</code></pre>


</div>