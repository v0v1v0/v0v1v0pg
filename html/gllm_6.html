<div class="container">

<table style="width: 100%;"><tr>
<td>gllm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Generalized log-linear modelling </h2>

<h3>Description</h3>

<p>Fits log-linear models for incomplete contingency tables,
including some latent class models, via EM and Fisher scoring approaches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gllm(y,s,X,method="hybrid",em.maxit=1,tol=0.00001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>is the observed contingency table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>is a vector of indices, one for each cell of the full (unobserved) 
contingency table, representing the appropriate cell of <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>is the design matrix, or a formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>chooses the EM, Fisher scoring or a hybrid (EM then scoring)
method for fitting the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.maxit</code></td>
<td>
<p>is the number of EM iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>is the convergence criterion for the LR criterion.</p>
</td>
</tr>
</table>
<h3>Details</h3>

 
<p>The generalized log-linear model allows for modelling of incomplete
contingency tables, that is tables where one or more dimensions have
been collapsed over.  These include situations where imprecise
measures have been calibrated using a "perfect" gold standard, and the
true association between imperfectly measured variables is to be
estimated; where data is missing for a subsample of the population;
latent variable models where latent variables are "errorless" functions
of observed variables - eg ML gene frequency estimation from counts of
observed phenotypes; specialised measurement models eg where observed
counts are mixtures due to perfect measures and error prone measures;
standard latent class analysis; symmetry and quasi-symmetry models for
square tables.
</p>
<p>The general framework underlying these models is summarised by Espeland
(1986), and Espeland &amp; Hui (1987), and is originally due to Thompson &amp;
Baker (1981).  An observed contingency table <code class="reqn">y</code>, which will be
treated as a vector, is modelled as arising from an underlying complete
table <code class="reqn">z</code>, where observed count <code class="reqn">y_j</code> is the sum of a number of
elements of <code class="reqn">z</code>, such that each <code class="reqn">z_i</code> contributes to no more
than one <code class="reqn">y_j</code>. Therefore one can write <code class="reqn">y=F'z</code>, where <code class="reqn">F</code>
is made up of orthogonal columns of ones and zeros.
</p>
<p>We then specify a loglinear model for <code class="reqn">z</code>, so that
<code class="reqn">log(E(z))=X'b</code>, where <code class="reqn">X</code> is a design matrix, and <code class="reqn">b</code> a
vector of loglinear parameters.  The loglinear model for <code class="reqn">z</code> and
thus <code class="reqn">y</code>, can be fitted using two methods, both of which are
available in <code>gllm</code>.  The first was presented as AS207 by Michael
Haber (1984) and combines an iterative proportional fitting algorithm
for <code class="reqn">b</code> and <code class="reqn">z</code>, with an EM fitting for <code class="reqn">y</code>, <code class="reqn">z</code> and
<code class="reqn">b</code>.  The second is a Fisher scoring approach, presented in Espeland
(1986).
</p>
<p>The <code>gllm</code> function is actually a simple wrapper for <code>scoregllm()</code>.
</p>


<h3>Value</h3>

 
<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of scoring iterations until convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>the final model deviance (-2 log likelihood)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the model degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the model parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the standard errors for the model parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>the variance-covariance matrix for the model parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observed.values</code></td>
<td>
<p>the observed counts in <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the expected counts under the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Pearsonian residuals under the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.table</code></td>
<td>
<p>the expected counts for the full (unobserved) table.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Espeland MA (1986).  A general class of models for discrete multivariate
data. <em>Commun. Statist.-Simula</em> 15:405-424.
</p>
<p>Espeland MA, Hui SL (1987).  A general approach to analyzing epidemiologic
data that contains misclassification errors.  <em>Biometrics</em>
43:1001-1012.
</p>
<p>Haber M (1984).  AS207: Fitting a general log-linear model.  <em>Appl
Statist</em> 33:358-362.
</p>
<p>Thompson R, Baker RJ (1981).  Composite link functions in generalized
linear models.  <em>Appl Statist</em> 30: 125-131.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
#
# latent class analysis: two latent classes
#
# Data matrix 2x2x2x2x2 table of responses to five binary items
# (items 11-15 of sections 6-7 of the Law School Admission Test)
#
y&lt;-c( 3,   6,   2,   11,   1,   1,   3,    4,
      1,   8,   0,   16,   0,   3,   2,   15,
     10,  29,  14,   81,   3,  28,  15,   80,
     16,  56,  21,  173,  11,  61,  28,  298)
#
# Scatter matrix: full table is 2x2x2x2x2x2
#
s&lt;-  c(1:32,1:32)
#
# Design matrix: x is the latent variable (2 levels), 
# a-e are the observed variables
#
x&lt;-as.integer(gl(2,32,64))-1
a&lt;-as.integer(gl(2,16,64))-1
b&lt;-as.integer(gl(2,8 ,64))-1
c&lt;-as.integer(gl(2,4 ,64))-1
d&lt;-as.integer(gl(2,2 ,64))-1
e&lt;-as.integer(gl(2,1 ,64))-1

res1&lt;-gllm(y,s,~x*(a+b+c+d+e),method="em",tol=0.01)
res1
#
# An example of model fitting: gametic association between two diallelic loci
#
# Data matrix
#
y&lt;-c( 187,386,156,
      352,310,20,
      136,0  ,0)
#
# Scatter matrix
#
s&lt;-  c( 1, 2, 2, 3,
        4, 5, 5, 6,
        4, 5, 5, 6,
        7, 8, 8, 9)
#
# Design matrix
#
X&lt;-  matrix(c( 1,0,0,0,0,0,1,
               1,0,1,0,0,0,0,
               1,0,1,0,0,0,0,
               1,0,2,0,1,0,0,
               1,1,0,0,0,0,0,
               1,1,1,0,0,1,0,
               1,1,1,0,0,0,1,
               1,1,2,0,1,1,1,
               1,1,0,0,0,0,0,
               1,1,1,0,0,0,1,
               1,1,1,0,0,1,0,
               1,1,2,0,1,1,1,
               1,2,0,1,0,0,0,
               1,2,1,1,0,1,1,
               1,2,1,1,0,1,1,
               1,2,2,1,1,2,2), byrow=TRUE, ncol=7) 

colnames(X)&lt;-c("Intercept", "A", "B", "P1", "P2", "Delta", "Epsilon")
res2&lt;-gllm(y,s,X[,c(1:6)],method="hybrid",em.maxit=1,tol=0.00001)
res2
#

</code></pre>


</div>