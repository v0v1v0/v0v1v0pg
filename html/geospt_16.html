<div class="container">

<table style="width: 100%;"><tr>
<td>graph.rbf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Graph that describes the behavior of the optimized <em>eta</em> and <em>rho</em> parameters, associated with a radial basis function
</h2>

<h3>Description</h3>

<p>Function for plotting the RMSPE for several values of the smoothing parameter
eta with the same dataset. A curve is fitted to the points, and
then the optimal eta that provides the smallest
RMSPE is determined from the curve, by the <code>optimize</code> function from the <code>stats</code>
package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">graph.rbf(formula, data, eta.opt, rho.opt, n.neigh, func, np, x0, eta.dmax,
rho.dmax, P.T, iter, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula that defines the dependent variable as a linear model of independent variables; suppose the dependent variable has name <em>z</em>, for a <em>rbf</em> detrended use <em>z~1</em>; for a <em>rbf</em> with trend, suppose <em>z</em> is linearly dependent on <em>x</em> and <em>y</em>, use the formula <em>z~x+y</em> (linear trend).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>SpatialPointsDataFrame: should contain the dependent variable, independent variables, and coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.opt</code></td>
<td>
<p>logical, indicating whether the parameter <em>eta</em> should be regarded as fixed (eta.opt = FALSE) or should be estimated (eta.opt = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.opt</code></td>
<td>
<p>logical, indicating whether the parameter <em>rho</em> should be regarded as fixed (rho.opt = FALSE) or should be estimated (rho.opt = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.neigh</code></td>
<td>
<p>number of nearest observations that should be used for a <em>rbf</em> prediction, where nearest is defined in terms of the spatial locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>function to be optimized. The following radial basis function model types are currently available: gaussian "GAU", exponential "EXPON", trigonometric "TRI", thin plate spline "TPS", completely regularized spline "CRS", spline with tension "ST", inverse multiquadratic "IM", and multiquadratic "M", are currently available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>number of points, where the radial basis function is calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>starting point for searching the optimum. Defaults to c(0.5, 0.5), <em>eta</em> and <em>rho</em> respectively. Use this statement only if eta and rho are equal to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.dmax</code></td>
<td>
<p>maximum value of the range of the <em>eta</em> parameter that will be evaluated by the <code>optimize</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.dmax</code></td>
<td>
<p>maximum value of the range of the <em>rho</em> parameter that will be evaluated by the <code>optimize</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.T</code></td>
<td>
<p>logical. Print Table (TRUE) or not (FALSE). Default P.T=NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The maximum allowed number of function evaluations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters to be passed to the minimization functions <code>optimize</code> or <code>bobyqa</code>, typically arguments of the type control() which control the behavior of the minimization algorithm. See documentation about the selected minimization function for further details.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a graph that describes the behavior of the optimized <em>eta</em> or <em>rho</em> parameter, and a table of values associated with the graph including optimal smoothing <em>eta</em> or <em>rho</em> parameters. If both <em>eta</em> and <em>rho</em> are FALSE simultaneously, then the function returns a list with; the best value obtained from the combinations smoothing <em>eta</em> and <em>rho</em> parameters and a lattice plot of class "trellis" with RMSPE pixel values associated with combinations of <em>eta</em> and <em>rho</em> parameters. Finally if both <em>eta</em> and <em>rho</em> are TRUE, the function will return a list with the best combination of values of the smoothing <em>eta</em> or <em>rho</em> parameters and the RMSPE associated with these. 
</p>


<h3>References</h3>

<p>Johnston, K., Ver, J., Krivoruchko, K., Lucas, N. 2001. <em>Using ArcGIS Geostatistical Analysis</em>. ESRI.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(preci)
## Not run: 
coordinates(preci)&lt;-~x+y
# optimizing eta
graph.rbf(prec~1, preci, eta.opt=TRUE, rho.opt=FALSE, n.neigh=9, func="TPS", 
    np=40, eta.dmax=0.2, P.T=TRUE)
# optimizing rho
graph.rbf(prec~x+y, preci, eta.opt=FALSE, rho.opt=TRUE, n.neigh=9, func="M", 
    np=20, rho.dmax=2, P.T=TRUE)
# optimizing eta and rho
tps.lo &lt;- graph.rbf(prec~1, preci, eta.opt=TRUE, rho.opt=TRUE, n.neigh=9, func="TPS", 
    eta.dmax=2, rho.dmax=2, x0=c(0.1,0.1), iter=40)
tps.lo$Opt  # best combination of eta and rho obtained
# other optimization options
opt.u &lt;- uobyqa(c(0.1,0.1), rbf.cv1, control = list(maxfun=40), formula=prec~1, data=preci, 
                n.neigh=9, func="TPS")
opt.n &lt;- newuoa(c(0.1,0.1), rbf.cv1, control = list(maxfun=40), formula=prec~1, data=preci, 
                n.neigh=9, func="TPS")
# lattice of RMSPE values associated with a range of eta and rho, without optimization
tps.l &lt;- graph.rbf(prec~1, preci, eta.opt=FALSE, rho.opt=FALSE, n.neigh=9, func="TPS", 
    np=10, eta.dmax=2, rho.dmax=2)
tps.l$opt.table  # best combination of eta and rho obtained from lattice
tps.ls$pplot     # lattice of RMSPE

## End(Not run)
</code></pre>


</div>