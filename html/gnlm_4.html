<div class="container">

<table style="width: 100%;"><tr>
<td>gnlr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Nonlinear Regression Models for One and Two Parameter
Distributions</h2>

<h3>Description</h3>

<p><code>gnlr</code> fits user-specified nonlinear regression equations to one or
both parameters of the common one and two parameter distributions. A
user-specified -log likelihood can also be supplied for the distribution.
Most distributions allow data to be left, right, and/or interval censored.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gnlr(y = NULL, distribution = "normal", pmu = NULL, pshape = NULL,
  mu = NULL, shape = NULL, linear = NULL, exact = FALSE, wt = 1,
  delta = 1, shfn = FALSE, common = FALSE, envir = parent.frame(),
  print.level = 0, typsize = abs(p), ndigit = 10, gradtol = 1e-05,
  stepmax = 10 * sqrt(p %*% p), steptol = 1e-05, iterlim = 100,
  fscale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A response vector for uncensored data, a two column matrix for
binomial data or censored data, with the second column being the censoring
indicator (1: uncensored, 0: right censored, -1: left censored), or an
object of class, <code>response</code> (created by <code>restovec</code>)
or <code>repeated</code> (created by <code>rmna</code> or
<code>lvna</code>). If the <code>repeated</code> data object contains
more than one response variable, give that object in <code>envir</code> and give
the name of the response variable to be used here. The beta, simplex, and
two-sided power distributions for proportions do not allow left or right
censoring (only interval censoring).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>Either a character string containing the name of the
distribution or a function giving the -log likelihood. (In the latter case,
all initial parameter estimates are supplied in <code>pmu</code>.)
</p>
<p>Distributions are binomial, beta binomial, double binomial, mult(iplicative)
binomial, Poisson, negative binomial, double Poisson, mult(iplicative)
Poisson, gamma count, Consul generalized Poisson, logarithmic series,
geometric, normal, inverse Gauss, logistic, exponential, gamma, Weibull,
extreme value, Cauchy, Pareto, Laplace, Levy, beta, simplex, and two-sided
power. All but the binomial-based distributions and the beta, simplex, and
two-sided power distributions may be right and/or left censored. (For
definitions of distributions, see the corresponding [dpqr]distribution
help.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmu</code></td>
<td>
<p>Vector of initial estimates for the location parameters. If
<code>mu</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list. If <code>distribution</code> is a user-supplied -log likelihood function,
all initial estimates must be supplied here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pshape</code></td>
<td>
<p>Vector of initial estimates for the shape parameters. If
<code>shape</code> is a formula with unknown parameters, their estimates must be
supplied either in their order of appearance in the expression or in a named
list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A user-specified function of <code>pmu</code>, and possibly
<code>linear</code>, giving the regression equation for the location. This may
contain a linear part as the second argument to the function. It may also be
a formula beginning with ~, specifying either a linear regression function
for the location parameter in the Wilkinson and Rogers notation or a general
function with named unknown parameters. If it contains unknown parameters,
the keyword <code>linear</code> may be used to specify a linear part. If nothing
is supplied, the location is taken to be constant unless the linear argument
is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>A user-specified function of <code>pshape</code>, and possibly
<code>linear</code> and/or <code>mu</code>, giving the regression equation for the
dispersion or shape parameter. This may contain a linear part as the second
argument to the function and the location function as last argument (in
which case <code>shfn</code> must be set to TRUE). It may also be a formula
beginning with ~, specifying either a linear regression function for the
shape parameter in the Wilkinson and Rogers notation or a general function
with named unknown parameters. If it contains unknown parameters, the
keyword <code>linear</code> may be used to specify a linear part and the keyword
<code>mu</code> to specify a function of the location parameter. If nothing is
supplied, this parameter is taken to be constant unless the linear argument
is given. This parameter is the logarithm of the usual one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear</code></td>
<td>
<p>A formula beginning with ~ in W&amp;R notation, specifying the
linear part of the regression function for the location parameter or list of
two such expressions for the location and/or shape parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>If TRUE, fits the exact likelihood function for continuous data
by integration over intervals of observation given in <code>delta</code>, i.e.
interval censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>Weight vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Scalar or vector giving the unit of measurement (always one for
discrete data) for each response value, set to unity by default. For
example, if a response is measured to two decimals, <code>delta=0.01</code>. If
the response is transformed, this must be multiplied by the Jacobian. The
transformation cannot contain unknown parameters. For example, with a log
transformation, <code>delta=1/y</code>. (The delta values for the censored
response are ignored.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shfn</code></td>
<td>
<p>If true, the supplied shape function depends on the location
(function). The name of this location function must be the last argument of
the shape function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>common</code></td>
<td>
<p>If TRUE, <code>mu</code> and <code>shape</code> must both be either
functions with, as argument, a vector of parameters having some or all
elements in common between them so that indexing is in common between them
or formulae with unknowns. All parameter estimates must be supplied in
<code>pmu</code>. If FALSE, parameters are distinct between the two functions and
indexing starts at one in each function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typsize</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndigit</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradtol</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepmax</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steptol</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterlim</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fscale</code></td>
<td>
<p>Arguments controlling <code>nlm</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Nonlinear regression models can be supplied as formulae where parameters are
unknowns in which case factor variables cannot be used and parameters must
be scalars. (See <code>finterp</code>.)
</p>
<p>The printed output includes the -log likelihood (not the deviance), the
corresponding AIC, the maximum likelihood estimates, standard errors, and
correlations.
</p>


<h3>Value</h3>

<p>A list of class <code>gnlm</code> is returned that contains all of the
relevant information calculated, including error codes.
</p>


<h3>Author(s)</h3>

<p>J.K. Lindsey
</p>


<h3>See Also</h3>

<p><code>finterp</code>, <code>fmr</code>,
<code>glm</code>, <code>gnlmix</code>,
<code>glmm</code>, <code>gnlmm</code>,
<code>gnlr3</code>, <code>lm</code>, <code>nlr</code>,
<code>nls</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
sex &lt;- c(rep(0,10),rep(1,10))
sexf &lt;- gl(2,10)
age &lt;- c(8,10,12,12,8,7,16,7,9,11,8,9,14,12,12,11,7,7,7,12)
y &lt;- cbind(c(9.2, 7.3,13.0, 6.9, 3.9,14.9,17.8, 4.8, 6.4, 3.3,17.2,
	14.4,17.0, 5.0,17.3, 3.8,19.4, 5.0, 2.0,19.0),
	c(0,1,0,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1))
# y &lt;- cbind(rweibull(20,2,2+2*sex+age),rbinom(20,1,0.7))
# linear regression with inverse Gauss distribution
mu &lt;- function(p) p[1]+p[2]*sex+p[3]*age
gnlr(y, dist="inverse Gauss", mu=mu, pmu=c(3,0,0), pshape=1)
# or equivalently
gnlr(y, dist="inverse Gauss", mu=~sexf+age, pmu=c(3,0,0), pshape=1)
# or
gnlr(y, dist="inverse Gauss", linear=~sexf+age, pmu=c(3,0,0), pshape=1)
# or
gnlr(y, dist="inverse Gauss", mu=~b0+b1*sex+b2*age,
	pmu=list(b0=3,b1=0,b2=0), pshape=1)
#
# nonlinear regression with inverse Gauss distribution
mu &lt;- function(p, linear) exp(linear)
gnlr(y, dist="inverse Gauss", mu=mu, linear=~sexf+age, pmu=c(3,0,0),
	pshape=-1)
# or equivalently
gnlr(y, dist="inverse Gauss", mu=~exp(b0+b1*sex+b2*age),
	pmu=list(b0=3,b1=0,b2=0), pshape=-1)
# or
gnlr(y, dist="inverse Gauss", mu=~exp(linear), linear=~sexf+age,
	pmu=c(3,0,0), pshape=-1)
#
# include regression for the shape parameter with same mu function
shape &lt;- function(p) p[1]+p[2]*sex+p[3]*age
gnlr(y, dist="inverse Gauss", mu=mu, linear=~sexf+age, shape=shape,
	pmu=c(3,0,0), pshape=c(3,0,0))
# or equivalently
gnlr(y, dist="inverse Gauss", mu=mu, linear=~sexf+age,
	shape=~sexf+age, pmu=c(3,0,0), pshape=c(3,0,0))
# or
gnlr(y, dist="inverse Gauss", mu=mu, linear=list(~sex+age,~sex+age),
	pmu=c(3,0,0),pshape=c(3,0,0))
# or
gnlr(y, dist="inverse Gauss", mu=mu, linear=~sex+age,
	shape=~c0+c1*sex+c2*age, pmu=c(3,0,0),
	pshape=list(c0=3,c1=0,c2=0))
#
# shape as a function of the location
shape &lt;- function(p, mu) p[1]+p[2]*sex+p[3]*mu
gnlr(y, dist="inverse Gauss", mu=~age, shape=shape, pmu=c(3,0),
	pshape=c(3,0,0), shfn=TRUE)
# or
gnlr(y, dist="inverse Gauss", mu=~age, shape=~a+b*sex+c*mu, pmu=c(3,0),
	pshape=c(3,0,0), shfn=TRUE)
#
# common parameter in location and shape functions for age
mu &lt;- function(p) exp(p[1]+p[2]*age)
shape &lt;- function(p, mu) p[3]+p[4]*sex+p[2]*age
gnlr(y, dist="inverse Gauss", mu=mu, shape=shape, pmu=c(3,0,1,0),
	common=TRUE)
# or
gnlr(y, dist="inverse Gauss", mu=~exp(a+b*age), shape=~c+d*sex+b*age,
	pmu=c(3,0,1,0), common=TRUE)
#
# user-supplied -log likelihood function
y &lt;- rnorm(20,2+3*sex,2)
dist &lt;- function(p)-sum(dnorm(y,p[1]+p[2]*sex,p[3],log=TRUE))
gnlr(y, dist=dist,pmu=1:3)
dist &lt;- ~-sum(dnorm(y,a+b*sex,v,log=TRUE))
gnlr(y, dist=dist,pmu=1:3)

</code></pre>


</div>