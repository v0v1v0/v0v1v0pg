<div class="container">

<table style="width: 100%;"><tr>
<td>specresponse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Species response curves</h2>

<h3>Description</h3>

<p>This function fits species response curves to visualize species responses to environmental gradients or ordination axes.
It is based on Logistic Regression (binomial family) using Generalized Linear Models (GLMs) or Generalized Additive Models (GAMs) with integrated smoothness estimation.
The function can draw response curves for single or multiple species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">specresponse(
  species,
  var,
  main,
  xlab,
  model = "auto",
  method = "env",
  axis = 1,
  points = FALSE,
  bw = FALSE,
  lwd = NULL,
  na.action = na.omit
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>Species data (either a community matrix object with samples in rows and species in columns - response curves are drawn for all (selected) columns; or a single vector containing species abundances per plot).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Vector containing environmental variable (per plot) <strong>OR</strong> <code>vegan</code> ordination result object if <code>method = "ord"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Optional: Main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Optional: Label of x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Defining the assumed species response: Default <code>model = "auto"</code> selects the model automatically based on AIC. Other methods are <code>model = "linear"</code> (linear response), <code>model = "unimodal"</code> (unimodal response), <code>model = "bimodal"</code> (bimodal response) and <code>model = "gam"</code> (using GAM with regression smoother).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method defining the type of variable. Default <code>method = "env"</code> fits a response curve to environmental variables. Alternatively <code>method = "ord"</code> fits a response along ordination axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis</code></td>
<td>
<p>Ordination axis (only if <code>method = "ord"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>If set on <code>TRUE</code> the species occurrences are shown as transparent points (the darker the point the more samples at this x-value). To avoid overlapping they are shown with vertical offset when multiple species are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>If set on <code>TRUE</code> the lines will be drawn in black/white with different line types instead of colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Optional: Graphical parameter defining the line width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Optional: a function which indicates what should happen when the data contain NAs. The default is 'na.omit' (removes incomplete cases).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an (invisible) list with results for all calculated models. This list can be stored by assigning the result.
For each model short information on type, parameters, explained deviance and corresponding p-value (based on chi-squared test) are printed.
</p>


<h3>Details</h3>

<p>For response curves based on environmental gradients the argument <code>var</code> takes a single vector containing the variable corresponding to the species abundances.
</p>
<p>For a response to ordination axis (<code>method = "ord"</code>) the argument <code>var</code> requires a <code>vegan</code> ordination result object (e.g. from <code>decorana</code>, <code>cca</code> or <code>metaMDS</code>).
First axis is used as default.
</p>
<p>By default the response curves are drawn with automatic GLM model selection based on AIC out of GLMs with 1 - 3 polynomial degrees (thus excluding bimodal responses which must be manually defined). The GAM model is more flexible and chooses automatically between an upper limit of 3 - 6 degrees of freedom for the regression smoother.
</p>
<p>Available information about species is reduced to presence-absence as species abundances can contain much noise (being affected by complex factors) and the results of Logistic Regression are easier to interpret showing the "probabilities of occurrence".
Be aware that response curves are only a simplification of reality (model) and their shape is strongly dependent on the available dataset.
</p>


<h3>Author(s)</h3>

<p>Friedemann von Lampe (<a href="mailto:fvonlampe@uni-goettingen.de">fvonlampe@uni-goettingen.de</a>)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Draw species response curve for one species on environmental variable
## with points of occurrences
specresponse(schedenveg$ArrElat, schedenenv$soil_depth, points = TRUE)

## Draw species response curve on environmental variable with custom labels
specresponse(schedenveg$ArrElat, schedenenv$soil_depth, points = TRUE,
       main = "Arrhenatherum elatius", xlab = "Soil depth")

## Draw species response curve on ordination axes
## First calculate DCA
library(vegan)
scheden.dca &lt;- decorana(schedenveg)

# Using a linear model on first axis
specresponse(schedenveg$ArrElat, scheden.dca, method = "ord", model = "linear")
# Using an unimodal model on second axis
specresponse(schedenveg$ArrElat, scheden.dca, method = "ord", axis = 2, model = "unimodal")

## Community data: species (columns) need to be selected; call names() to get column numbers
names(schedenveg)
## Draw multiple species response curves on variable in black/white and store the results
res &lt;- specresponse(schedenveg[ ,c(9,18,14,19)], schedenenv$height_herb, bw = TRUE)
# Call the results for Anthoxanthum odoratum
summary(res$AntOdor)

## Draw the same curves based on GAM
specresponse(schedenveg[ ,c(9,18,14,19)], schedenenv$height_herb, bw = TRUE, model = "gam")

## Draw multiple species response curves on variable with
## custom x-axis label and points of occurrences
specresponse(schedenveg[ ,c(9,18,14,19)], schedenenv$height_herb,
    xlab = "Height of herb layer (cm)", points = TRUE)

## Draw multiple species response curves on ordination axes
specresponse(schedenveg[ ,c(9,18,14,19)], scheden.dca, method = "ord")
specresponse(schedenveg[ ,c(9,18,14,19)], scheden.dca, method = "ord", axis = 2)

</code></pre>


</div>