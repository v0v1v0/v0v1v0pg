<div class="container">

<table style="width: 100%;"><tr>
<td>gSlc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generalized additive mixed model analysis via slice sampling
</h2>

<h3>Description</h3>

<p>Use slice sampling-based Markov chain Monte Carlo
to fit a generalized additive mixed model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gSlc(formula, data = NULL, random = NULL, family, control = gSlc.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula describing the generalized additive mixed model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing the input data. This argument is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>List describing random effects structure.This argument is optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Distribution family of the response variable. The options are "binomial" and "poisson".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Control options specified by gSlc.control.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A Bayesian generalized additive mixed model is fitted to the input data according to specified formula. Such models are special cases of the general design generalized linear mixed models of Zhao, Staudenmayer, Coull and Wand (2003). Markov chain Monte Carlo, with slice sampling for the fixed and random effects, is used to obtain samples from the posterior distributions of the model parameters. Full details of the sampling scheme are in the appendix of Pham and Wand (2018). 
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"gScl"</code>. The functions <code>summary()</code> and <code>plot()</code> are used to obtain a summary and plot of the fits. The object is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Matrix containing Markov chain Monte Carlo samples of the entire nu=(beta,u) vector. The rows correspond to Markov chain Monte Carlo replicates and the columns correspond to entries of the nu=(beta,u) vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Matrix containing Markov chain Monte Carlo samples of the beta vector corresponding to the linear components of the model. The rows correspond to Markov chain Monte Carlo replicates and the columns correspond to entries of the beta vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaSquared</code></td>
<td>
<p>Matrix containing Markov chain Monte Carlo samples of the entire sigma squared vector. The rows correspond to Markov chain Monte Carlo replicates and the columns correspond to entries of the sigmaSquared vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response data vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XlinPreds</code></td>
<td>
<p>Matrix containing predictors that are purely linear components of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linPredNames</code></td>
<td>
<p>Names of <code>XlinPreds</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XsplPreds</code></td>
<td>
<p>Matrix containing predictors that are penalised spline components of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splPredNames</code></td>
<td>
<p>Names of <code>XsplPreds</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zspl</code></td>
<td>
<p>Horizontal concatenation of each of the spline basis "Z" matrices used for smooth function components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncZspl</code></td>
<td>
<p>Vector giving the numbers of columns in the horizontal partition of <code>Zspl</code> corresponding to each smooth function component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.x.list</code></td>
<td>
<p>List containing values of the <code>range.x</code> input to the internal <code>ZOSull()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intKnots.list</code></td>
<td>
<p>List containing values of the <code>intKnots</code> input to the internal <code>ZOSull()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Character string indicating the family of the fitted model; either "binomial" or "poisson".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelType</code></td>
<td>
<p>Charater string indicating the type of model fitted.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tung Pham <a href="mailto:tungstats@gmail.com">tungstats@gmail.com</a> and Matt Wand <a href="mailto:matt.wand@uts.edu.au">matt.wand@uts.edu.au</a>
</p>


<h3>References</h3>

<p>Neal, R.M. (2003).<br>
Slice sampling (with discussion).<br><em>The Annals of Statistics</em>, <b>31</b>, 705-767.
</p>
<p>Pham, T. and Wand, M.P. (2018).<br>
Generalized additive mixed model analysis via <code>gammSlice</code>.<br><em>Australian and New Zealand Journal of Statistics</em>, <b>60</b>, 279-300.
</p>
<p>Zhao, Y., Staudenmayer, J., Coull, B.A. and Wand, M.P. (2003).<br>
General design Bayesian generalized linear mixed models.<br><em>Statistical Science</em>, <b>21</b>, 35-51.
</p>


<h3>See Also</h3>

<p><code>gSlc.control</code>, <code>plot.gSlc</code>, <code>summary.gSlc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# Example 1 of Pham &amp; Wand (2018):

set.seed(39402)
m &lt;- 100 ; n &lt;- 2
beta0True &lt;- 0.5 ; betaxTrue &lt;- 1.7 
sigsqTrue &lt;- 0.8 ; idnum &lt;- rep(1:m,each=n)
x &lt;- runif(m*n)
U &lt;- rep(rnorm(m,0,sqrt(sigsqTrue)),each=n)
mu &lt;- 1/(1+exp(-(beta0True+betaxTrue*x+U)))
y &lt;- rbinom((m*n),1,mu)
fit1 &lt;- gSlc(y ~ x,random = list(idnum = ~1),family = "binomial")
summary(fit1)

## End(Not run)

## Not run: 
# Example 2 of Pham &amp; Wand (2018):

set.seed(53902)
n &lt;- 400 ; x &lt;- runif(n)
fTrue &lt;- function(x) return(cos(4*pi*x) + 2*x - 1)
mu &lt;- exp(fTrue(x)) ; y &lt;- rpois(n,mu)
fit2 &lt;- gSlc(y~s(x),family="poisson")
summary(fit2)
plot(fit2)

## End(Not run)

## Not run: 
# Example 3 of Pham &amp; Wand (2018):

set.seed(981127)
n &lt;- 500 ; betax1True &lt;- 0.5;  x1 &lt;- sample(c(0,1),n,replace=TRUE) 
x2 &lt;- runif(n) ; fTrue &lt;- function(x) return(sin(2*pi*x))
mu &lt;- 1/(1+exp(-(betax1True*x1+fTrue(x2)))) ; y &lt;- rpois(n,mu)
y &lt;- rbinom(n,1,mu)
fit3 &lt;- gSlc(y ~ x1 + s(x2),family="binomial")
summary(fit3)
plot(fit3)

## End(Not run)

## Not run: 
# Example 4 of Pham &amp; Wand (2018):

set.seed(2966703)
m &lt;- 100 ; n &lt;- 10;  x1 &lt;- runif(m*n);   x2 &lt;- runif(m*n)
idnum &lt;- rep(1:m,each=n) ; sigsqTrue &lt;- 1
U &lt;- rep(rnorm(m,0,sqrt(sigsqTrue)),each=n)
mu &lt;- exp(U + cos(4*pi*x1) + 2*x1 + sin(2*pi*x2^2)) ; y &lt;- rpois(m*n,mu)
fit4 &lt;- gSlc(y ~ s(x1) + s(x2),random = list(idnum=~1),family = "poisson")
summary(fit4)
plot(fit4)

## End(Not run)
</code></pre>


</div>