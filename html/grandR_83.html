<div class="container">

<table style="width: 100%;"><tr>
<td>GetContrasts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a contrast matrix</h2>

<h3>Description</h3>

<p>Each column of a contrast matrix represents a pairwise comparison of all samples or cells of
a grandR object (or a column annotation table). Elements being 1 are contrasted vs. elements being -1
(and all 0 are irrelevant for this comparison).
</p>


<h3>Usage</h3>

<pre><code class="language-R">GetContrasts(x, ...)

## S3 method for class 'grandR'
GetContrasts(
  x,
  contrast = "Condition",
  no4sU = FALSE,
  columns = NULL,
  group = NULL,
  name.format = NULL,
  ...
)

## Default S3 method:
GetContrasts(
  x,
  contrast,
  columns = NULL,
  group = NULL,
  name.format = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A grandR object or a column annotation table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>A vector describing what should be contrasted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no4sU</code></td>
<td>
<p>Use no4sU columns (TRUE) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns</code></td>
<td>
<p>logical vector of which columns (samples or cells) to use (or NULL: use all); for grandR objects, see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Split the samples or cells according to this column of the column annotation table (and adapt the of the output table)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name.format</code></td>
<td>
<p>Format string for generating the column from the contrast vector (see details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To compare one specific factor level <em>A</em> against another level <em>B</em> in
a particular column <em>COL</em> of the column annotation table, specify contrast=c("COL","A","B")
</p>
<p>To compare all levels against a specific level <em>A</em> in
a particular column <em>COL</em> of the column annotation table, specify contrast=c("COL","A")
</p>
<p>To perform all pairwise comparisons of all levels from
a particular column <em>COL</em> of the column annotation table, specify contrast=c("COL")
</p>
<p>If the column <em>COL</em> only has two levels, all three are equivalent.
</p>
<p>In all cases, if groups is not NULL, the columns annotation table is first split and contrasts are applied within all samples or cells
with the same <em>group</em> factor level.
</p>
<p>The format string specifies the column name in the generated contrast matrix (which is used as the <em>Analysis</em> name when calling
<code>ApplyContrasts</code>, <code>LFC</code>, <code>PairwiseDESeq2</code>, etc.). The keywords <em>$GRP</em>, <em>$COL</em>, <em>$A</em> and <em>$B</em> are substituted
by the respective elements of the contrast vector or the group this comparison refers to. By default, it is "$A vs $B" if group is NULL, and "$A vs $B.$GRP" otherwise.
</p>
<p>The method for grandR objects simply calls the general method
</p>
<p>For grandR objects, columns can be given as a logical, integer or character vector representing a selection of the columns (samples or cells).
The expression is evaluated in an environment having the <code>Coldata</code>, i.e. you can use names of <code>Coldata</code> as variables to
conveniently build a logical vector (e.g., columns=Condition="x").
</p>


<h3>Value</h3>

<p>A data frame representig a contrast matrix to be used in <code>ApplyContrasts</code>, <code>LFC</code>, <code>PairwiseDESeq2</code>
</p>


<h3>See Also</h3>

<p><code>ApplyContrasts</code>, <code>LFC</code>, <code>PairwiseDESeq2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sars &lt;- ReadGRAND(system.file("extdata", "sars.tsv.gz", package = "grandR"),
                  design=c("Condition","Time",Design$Replicate))

GetContrasts(sars,contrast="Condition")
# Compare all Mock vs. all SARS
GetContrasts(sars,contrast=c("Condition","SARS","Mock"))
# This direction of the comparison is more reasonable
GetContrasts(sars,contrast=c("Condition","SARS","Mock"),group="Time")
# Compare SARS vs Mock per time point
GetContrasts(sars,contrast=c("Time.original","no4sU"), group="Condition",no4sU=TRUE,
                                                name.format="$A vs $B ($GRP)")
# Compare each sample against the respective no4sU sample

# See the differential-expression vignette for more examples!
</code></pre>


</div>