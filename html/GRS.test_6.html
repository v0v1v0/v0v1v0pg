<div class="container">

<table style="width: 100%;"><tr>
<td>GRS.optimalbootweight</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Weighted Optimal Level of Significance for the GRS test: Bootstrapping
</h2>

<h3>Description</h3>

<p>The optimal level is calculated by minimizing expected loss from hypothesis testing
</p>
<p>The bootstrap is used to calculate the power.
</p>
<p>The non-centrality paramter is estimated and its bootstrap distribution is obtained. 
</p>
<p>9 percentiles from this distribution is used to caculate the power and the optimal level. 
</p>
<p>These optimal levesl ared weighted using the weights from the density of the bootstrap distribution of lambda. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">GRS.optimalbootweight(ret.mat,factor.mat,p=0.5,k=1,nboot=3000,wild=FALSE,Graph=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ret.mat</code></td>
<td>
<p> portfolio return matrix, T by N </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor.mat</code></td>
<td>
<p> matrix of risk factors, T by K </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> prior probability for H0, default is p = 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> relative loss, k = L2/L1, default is k = 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p> the number of bootstrap iterations, the default is 3000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wild</code></td>
<td>
<p> if TRUE, wild bootsrap is conducted; if FALSE  (default), bootstrap is based on iid residual resampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Graph</code></td>
<td>
<p> show graph if TRUE (default). No graph otherwise </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Power is calculated based on the bootstrap
</p>
<p>The plot shows the bootstrap distribution of lambda (non-centrality parameter)
</p>
<p>See Kim and Choi, 2017, Choosing the Level of Significance: A Decision-theoretic Approach
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>opt.sig </code></td>
<td>
<p>Optimal level of significance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.crit </code></td>
<td>
<p>Critical value corresponding to opt.sig</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The example below sets nboot=500 for faster execution, but a higher number is recommended. 
</p>


<h3>Author(s)</h3>

<p>Jae H. Kim
</p>


<h3>References</h3>

<p>Leamer, E. 1978, Specification Searches: Ad Hoc Inference with Nonexperimental Data, Wiley, New York.
</p>
<p>Kim, JH and Ji, P. 2015, Significance Testing in Empirical Finance: A Critical Review and Assessment, Journal of Empirical Finance 34, 1-14.
&lt;DOI:http://dx.doi.org/10.1016/j.jempfin.2015.08.006&gt;
</p>
<p>Gibbons, Ross, Shanken, 1989. A test of the efficiency of a given portfolio, Econometrica, 57,1121-1152.
&lt;DOI:10.2307/1913625&gt;
</p>
<p>Kim and Shamsuddin, 2017, Empirical Validity of Asset-pricing Models: Application of Optimal Significance Level and Equal Probability Test
</p>


<h3>See Also</h3>

<p>Kim and Choi, 2017, Choosing the Level of Significance: A Decision-theoretic Approach
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data)
n=60; m1=nrow(data)-n+1; m2=nrow(data)   # Choose the last n observations from the data set
factor.mat = data[m1:m2,2:6]            # Fama-French 5-factors
ret.mat = data[m1:m2,8:ncol(data)]      # 25 size-BM portfolio returns
GRS.optimalboot(ret.mat,factor.mat,p=0.5,k=1,nboot=500,wild=TRUE,Graph=TRUE)

</code></pre>


</div>