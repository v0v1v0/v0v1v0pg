<div class="container">

<table style="width: 100%;"><tr>
<td>gcm.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for Conditional Independence Based on the Generalized Covariance Measure (GCM)</h2>

<h3>Description</h3>

<p>Test for Conditional Independence Based on the Generalized Covariance Measure (GCM)
</p>


<h3>Usage</h3>

<pre><code class="language-R">gcm.test(X, Y, Z = NULL, alpha = 0.05, regr.method = "xgboost",
  regr.pars = list(), plot.residuals = FALSE, nsim = 499L,
  resid.XonZ = NULL, resid.YonZ = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A (nxp)-dimensional matrix (or data frame) with n observations of p variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A (nxp)-dimensional matrix (or data frame) with n observations of p variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>A (nxp)-dimensional matrix (or data frame) with n observations of p variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regr.method</code></td>
<td>
<p>A string indicating the regression method that is used. Currently implemented are 
"gam", "xgboost", "kernel.ridge". The regression is performed only if 
not both resid.XonZ and resid.YonZ are set to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regr.pars</code></td>
<td>
<p>Some regression methods require a list of additional options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.residuals</code></td>
<td>
<p>A Boolean indicating whether some plots should be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>An integer indicating the number of bootstrap samples used to approximate the null distribution of the
test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.XonZ</code></td>
<td>
<p>It is possible to directly provide the residuals instead of performing a regression. 
If set to NULL, the regression method specified in regr.method is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid.YonZ</code></td>
<td>
<p>It is possible to directly provide the residuals instead of performing a regression. 
If set to NULL, the regression method specified in regr.method is used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function tests whether X is conditionally independent of Y given Z. The output is a list containing
</p>

<ul>
<li> <p><code>p.value</code>: P-value of the test. 
</p>
</li>
<li> <p><code>test.statistic</code>: Test statistic of the test.
</p>
</li>
<li> <p><code>reject</code>: Boolean that is true iff p.value &lt; alpha.
</p>
</li>
</ul>
<h3>References</h3>

<p>Please cite the following paper.
Rajen D. Shah, Jonas Peters: 
"The Hardness of Conditional Independence Testing and the Generalised Covariance Measure"
<a href="https://arxiv.org/abs/1804.07203">https://arxiv.org/abs/1804.07203</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n &lt;- 250 
Z &lt;- 4*rnorm(n) 
X &lt;- 2*sin(Z) + rnorm(n)
Y &lt;- 2*sin(Z) + rnorm(n)
Y2 &lt;- 2*sin(Z) + X + rnorm(n)
gcm.test(X, Y, Z, regr.method = "gam")
gcm.test(X, Y2, Z, regr.method = "gam")

</code></pre>


</div>