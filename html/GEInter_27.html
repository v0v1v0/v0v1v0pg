<div class="container">

<table style="width: 100%;"><tr>
<td>QPCorr.pval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>P-values of the "QPCorr.matrix" obtained using a permutation approach</h2>

<h3>Description</h3>

<p>P-values of the <code>"QPCorr.matrix "</code> obtained using a permutation approach, the
interactions with smaller p-values are regarded as more important.
</p>


<h3>Usage</h3>

<pre><code class="language-R">QPCorr.pval(
  G,
  E,
  Y,
  tau,
  w = NULL,
  permutation_t = 1000,
  family = c("continuous", "survival")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Input matrix of <code>p</code> genetic (G) measurements consisting of <code>n</code> rows. Each row is an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Input matrix of <code>q</code> environmental (E) risk factors, each row is an observation
vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Response variable. A quantitative vector for <code>family="continuous"</code>. For
<code>family="survival"</code>, <code>Y</code> should be a two-column matrix with the first column being
the log(survival time) and the second column being the censoring indicator. The indicator is a
binary variable, with "1" indicating dead, and "0" indicating right censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Weight for accommodating censoring if <code>family="survival"</code>. Default is NULL and a
Kaplan-Meier estimator-based weight is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutation_t</code></td>
<td>
<p>Number of permutation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Response type of <code>Y</code> (see above).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Matrix of p-value, with the element in the <code>i</code>th row and the <code>j</code> column
represents the p-value of the (censored) quantile partial correlation corresponding to the
<code>i</code>th E and the <code>j</code>th G.
</p>


<h3>References</h3>

<p>Yaqing Xu, Mengyun Wu, Qingzhao Zhang, and Shuangge Ma.
<em>Robust identification of gene-environment interactions for prognosis using a quantile
partial correlation approach. Genomics, 111(5):1115-1123, 2019.</em>
</p>


<h3>See Also</h3>

<p><code>QPCorr.matrix </code> method.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n=50
alpha=matrix(0,5,1)
alpha[1:2]=1
beta=matrix(0,6,20)
beta[1,1:4]=1
beta[2:3,1:4]=2
sigmaG&lt;-AR(rho=0.3,20)
sigmaE&lt;-AR(rho=0.3,5)
G&lt;-MASS::mvrnorm(n,rep(0,20),sigmaG)
E&lt;-MASS::mvrnorm(n,rep(0,5),sigmaE)
e1&lt;-rnorm(n*.05,50,1);e2&lt;-rnorm(n*.05,-50,1);e3&lt;-rnorm((n-length(e1)-length(e2)))
e&lt;-c(e1,e2,e3)


# continuous
y1=simulated_data(G=G,E=E,alpha=alpha,beta=beta,error=e,family="continuous")
cpqcorr_pvalue1&lt;-QPCorr.pval(G,E,y1,tau=0.5,permutation_t=500,family="continuous")

# survival
y2=simulated_data(G,E,alpha,beta,rnorm(n,0,1),family="survival",0.7,0.9)
cpqcorr_pvalue2&lt;-QPCorr.pval(G,E,y2,tau=0.5,permutation_t=500,family="survival")

</code></pre>


</div>