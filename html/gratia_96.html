<div class="container">

<table style="width: 100%;"><tr>
<td>draw.smooth_samples</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot posterior smooths</h2>

<h3>Description</h3>

<p>Plot posterior smooths
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'smooth_samples'
draw(
  object,
  select = NULL,
  n_samples = NULL,
  seed = NULL,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  subtitle = NULL,
  caption = NULL,
  alpha = 1,
  colour = "black",
  contour = FALSE,
  contour_col = "black",
  n_contour = NULL,
  scales = c("free", "fixed"),
  rug = TRUE,
  partial_match = FALSE,
  angle = NULL,
  ncol = NULL,
  nrow = NULL,
  guides = "keep",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted GAM, the result of a call to <code>mgcv::gam()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>character, logical, or numeric; which smooths to plot. If
<code>NULL</code>, the default, then all model smooths are drawn. Numeric <code>select</code>
indexes the smooths in the order they are specified in the formula and
stored in <code>object</code>. Character <code>select</code> matches the labels for smooths
as shown for example in the output from <code>summary(object)</code>. Logical
<code>select</code> operates as per numeric <code>select</code> in the order that smooths are
stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_samples</code></td>
<td>
<p>numeric; if not <code>NULL</code>, sample <code>n_samples</code> from the
posterior draws for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>numeric; random seed to be used to if sampling draws.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>character or expression; the label for the x axis. If not
supplied, a suitable label will be generated from <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>character or expression; the label for the y axis. If not
supplied, a suitable label will be generated from <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>character or expression; the title for the plot. See
<code>ggplot2::labs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p>character or expression; the subtitle for the plot. See
<code>ggplot2::labs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>character or expression; the plot caption. See
<code>ggplot2::labs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric; alpha transparency for confidence or simultaneous
interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colour</code></td>
<td>
<p>The colour to use to draw the posterior smooths. Passed to
<code>ggplot2::geom_line()</code> as argument <code>colour</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour</code></td>
<td>
<p>logical; should contour lines be added to smooth surfaces?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour_col</code></td>
<td>
<p>colour specification for contour lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_contour</code></td>
<td>
<p>numeric; the number of contour bins. Will result in
<code>n_contour - 1</code> contour lines being drawn. See <code>ggplot2::geom_contour()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>character; should all univariate smooths be plotted with the
same y-axis scale? If <code>scales = "free"</code>, the default, each univariate
smooth has its own y-axis scale. If <code>scales = "fixed"</code>, a common y axis
scale is used for all univariate smooths.
</p>
<p>Currently does not affect the y-axis scale of plots of the parametric
terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>logical; draw a rug plot at the bottom of each plot for 1-D
smooths or plot locations of data for higher dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial_match</code></td>
<td>
<p>logical; should smooths be selected by partial matches
with <code>select</code>? If <code>TRUE</code>, <code>select</code> can only be a single string to match
against.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>numeric; the angle at which the x axis tick labels are to be
drawn passed to the <code>angle</code> argument of <code>ggplot2::guide_axis()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol, nrow</code></td>
<td>
<p>numeric; the numbers of rows and columns over which to
spread the plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guides</code></td>
<td>
<p>character; one of <code>"keep"</code> (the default), <code>"collect"</code>, or
<code>"auto"</code>. Passed to <code>patchwork::plot_layout()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to <code>patchwork::wrap_plots()</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>Examples</h3>

<pre><code class="language-R">load_mgcv()
dat1 &lt;- data_sim("eg1", n = 400, dist = "normal", scale = 1, seed = 1)
## a single smooth GAM
m1 &lt;- gam(y ~ s(x0) + s(x1) + s(x2) + s(x3), data = dat1, method = "REML")
## posterior smooths from m1
sm1 &lt;- smooth_samples(m1, n = 15, seed = 23478)
## plot
draw(sm1, alpha = 0.7)
## plot only 5 randomly smapled draws
draw(sm1, n_samples = 5, alpha = 0.7)

## A factor-by smooth example
dat2 &lt;- data_sim("eg4", n = 400, dist = "normal", scale = 1, seed = 1)
## a multi-smooth GAM with a factor-by smooth
m2 &lt;- gam(y ~ fac + s(x2, by = fac) + s(x0), data = dat2, method = "REML")
## posterior smooths from m1
sm2 &lt;- smooth_samples(m2, n = 15, seed = 23478)
## plot, this time selecting only the factor-by smooth
draw(sm2, select = "s(x2)", partial_match = TRUE, alpha = 0.7)


## A 2D smooth example
dat3 &lt;- data_sim("eg2", n = 400, dist = "normal", scale = 1, seed = 1)
## fit a 2D smooth
m3 &lt;- gam(y ~ te(x, z), data = dat3, method = "REML")
## get samples
sm3 &lt;- smooth_samples(m3, n = 10)
## plot just 6 of the draws, with contour line overlays
draw(sm3, n_samples = 6, contour = TRUE, seed = 42)

</code></pre>


</div>