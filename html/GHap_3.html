<div class="container">

<table style="width: 100%;"><tr>
<td>ghap.ancplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Barplot of predictions of ancestry proportions
</h2>

<h3>Description</h3>

<p>Given smoothed ancestry predictions obtained with the <code>ghap.ancsmooth</code> function, an admixture barplot is generated.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> ghap.ancplot(ancsmooth, labels = TRUE,
              pop.ang = 45, group.ang = 0,
              colors = NULL, pop.order = NULL,
              sortby = NULL, use.unk = FALSE,
              legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ancsmooth</code></td>
<td>

<p>A list containing smoothed ancestry classifications, such as supplied by the <code>ghap.ancsmooth</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>A logic value indicating if population labels should be plotted (default = TRUE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.ang</code></td>
<td>

<p>A numeric value representing the rotation of population labels in degrees (default = 45).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.ang</code></td>
<td>

<p>A numeric value representing the rotation of group labels in degrees (default = 0).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>

<p>A character vector of colors to use for each ancestry label.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.order</code></td>
<td>

<p>A single character vector or a list of character vectors specifying the order of populations to plot (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortby</code></td>
<td>

<p>A character value indicating the ancestry label to use for sorting individuals within populations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.unk</code></td>
<td>

<p>A logical value indicating if the plot should be generated using missing values (default = TRUE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>

<p>A logical value indicating if a legend should be included to the plot (default = TRUE).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes smoothed ancestry classifications provided by the <code>ghap.ancsmooth</code> function and generates a traditional admixture/structure barplot. The argument pop.order allows the user to organize the displaying order of populations through a vector or a list. If a vector is provided, the populations are plotted following the order of elements within the vector. Otherwise, if a named list of vectors is provided, populations are first grouped by list elements and then displayed in the order they appear within their respective group vector.
</p>
<p>The same data could be used to generate a circular barplot, for example with the <span class="pkg">BITE</span> package. 
</p>


<h3>Author(s)</h3>

<p>Yuri Tani Utsunomiya &lt;ytutsunomiya@gmail.com&gt;
</p>


<h3>References</h3>

<p>Milanesi, M., Capomaccio, S., Vajana, E., Bomba, L., Garcia, J.F., Ajmone-Marsan, P., Colli, L., 2017. BITE: an R package for biodiversity analyses. bioRxiv 181610. https://doi.org/10.1101/181610
</p>
<p>Y.T. Utsunomiya et al. Unsupervised detection of ancestry tracks with the GHap R package. Methods in Ecology and Evolution. 2020. 11:1448â€“54.
</p>


<h3>See Also</h3>

<p><code>ghap.ancsmooth</code>, <code>ghap.ancmark</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# #### DO NOT RUN IF NOT NECESSARY ###
# 
# # Copy phase data in the current working directory
# exfiles &lt;- ghap.makefile(dataset = "example",
#                          format = "phase",
#                          verbose = TRUE)
# file.copy(from = exfiles, to = "./")
# 
# # Load phase data
# 
# phase &lt;- ghap.loadphase("example")
# 
# ### RUN ###
# 
# # Calculate marker density
# mrkdist &lt;- diff(phase$bp)
# mrkdist &lt;- mrkdist[which(mrkdist &gt; 0)]
# density &lt;- mean(mrkdist)
# 
# # Generate blocks for admixture events up to g = 10 generations in the past
# # Assuming mean block size in Morgans of 1/(2*g)
# # Approximating 1 Morgan ~ 100 Mbp
# g &lt;- 10
# window &lt;- (100e+6)/(2*g)
# window &lt;- ceiling(window/density)
# step &lt;- ceiling(window/4)
# blocks &lt;- ghap.blockgen(phase, windowsize = window,
#                         slide = step, unit = "marker")
# 
# # BestK analysis
# bestK &lt;- ghap.anctrain(object = phase, K = 5, tune = TRUE)
# plot(bestK$ssq, type = "b", xlab = "K",
#      ylab = "Within-cluster sum of squares")
# 
# # Unsupervised analysis with best K
# prototypes &lt;- ghap.anctrain(object = phase, K = 2)
# hapadmix &lt;- ghap.anctest(object = phase,
#                          blocks = blocks,
#                          prototypes = prototypes,
#                          test = unique(phase$id))
# anctracks &lt;- ghap.ancsmooth(object = phase, admix = hapadmix)
# ghap.ancplot(ancsmooth = anctracks)
# 
# # Supervised analysis
# train &lt;- unique(phase$id[which(phase$pop != "Cross")])
# prototypes &lt;- ghap.anctrain(object = phase, train = train,
#                             method = "supervised")
# hapadmix &lt;- ghap.anctest(object = phase,
#                          blocks = blocks,
#                          prototypes = prototypes,
#                          test = unique(phase$id))
# anctracks &lt;- ghap.ancsmooth(object = phase, admix = hapadmix)
# ghap.ancplot(ancsmooth = anctracks)

</code></pre>


</div>