<div class="container">

<table style="width: 100%;"><tr>
<td>linear_IRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate linear impulse response function based on a single regime of a structural GMVAR,
StMVAR, or G-StMVAR model.</h2>

<h3>Description</h3>

<p><code>linear_IRF</code> estimates linear impulse response function based on a single regime
of a structural GMVAR, StMVAR, or G-StMVAR model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">linear_IRF(
  gsmvar,
  N = 30,
  regime = 1,
  which_cumulative = numeric(0),
  scale = NULL,
  ci = NULL,
  bootstrap_reps = 100,
  ncores = 2,
  ncalls = 1,
  seeds = NULL,
  ...
)

## S3 method for class 'irf'
plot(x, shocks_to_plot, ...)

## S3 method for class 'irf'
print(x, ..., digits = 2, N_to_print, shocks_to_print)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gsmvar</code></td>
<td>
<p>an object of class <code>'gsmvar'</code> defining a structural or reduced form
GSMVAR model. For a reduced form model, the shocks are automatically identified by
the lower triangular Cholesky decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>a positive integer specifying the horizon how far ahead should the
linear impulse responses be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regime</code></td>
<td>
<p>Based on which regime the linear IRF should be calculated?
An integer in <code class="reqn">1,...,M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_cumulative</code></td>
<td>
<p>a numeric vector with values in <code class="reqn">1,...,d</code>
(<code>d=ncol(data)</code>) specifying which the variables for which the linear impulse
responses should be cumulative. Default is none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>should the linear IRFs to some of the shocks be scaled so that they
correspond to a specific instantaneous response of some specific
variable? Provide a length three vector where the shock of interest
is given in the first element (an integer in <code class="reqn">1,...,d</code>), the variable of
interest is given in the second element (an integer in <code class="reqn">1,...,d</code>), and
its instantaneous response in the third element (a non-zero real number).
If the linear IRFs of multiple shocks should be scaled, provide a matrix which has one
column for each of the shocks with the columns being the length three vectors described above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>a real number in <code class="reqn">(0, 1)</code> specifying the confidence level of the
confidence intervals calculated via a fixed-design wild residual bootstrap method.
Available only for models that impose linear autoregressive dynamics
(excluding changes in the volatility regime).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap_reps</code></td>
<td>
<p>the number of bootstrap repetitions for estimating confidence bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>the number of CPU cores to be used in parallel computing when bootstrapping confidence bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncalls</code></td>
<td>
<p>on how many estimation rounds should each bootstrap estimation be based on?
Does not have to be very large since initial estimates used are based on the initially fitted model.
Larger number of rounds gives more reliable results but is computationally more demanding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seeds</code></td>
<td>
<p>a numeric vector of length <code>bootstrap_reps</code> initializing the seed for the random
generator for each bootstrap replication.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>'irf'</code> generated by the function <code>linear_IRF</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shocks_to_plot</code></td>
<td>
<p>IRFs of which shocks should be plotted? A numeric vector
with elements in <code>1,...,d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of decimals to print</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_to_print</code></td>
<td>
<p>an integer specifying the horizon how far to print the estimates and
confidence intervals. The default is that all the values are printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shocks_to_print</code></td>
<td>
<p>the responses to which should should be printed?
A numeric vector with elements in <code>1,...,d</code>. The default is that responses to
all the shocks are printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model DOES NOT need to be structural in order for this function to be
applicable. When an identified structural GMVAR, StMVAR, or G-StMVAR model is
provided in the argument <code>gsmvar</code>, the identification imposed by the model
is used. When a reduced form model is provided in the argument <code>gsmvar</code>,
lower triangular Cholesky identification is used to identify the shocks.
</p>
<p>If the autoregressive dynamics of the model are linear (i.e., either M == 1 or mean and AR parameters
are constrained identical across the regimes), confidence bounds can be calculated based on a type of fixed-design
wild residual bootstrap method. See Virolainen (forthcoming) for a related discussion. We employ the method described
in Herwartz and L端tkepohl (2014); see also the relevant chapters in Kilian and L端tkepohl (2017).
</p>


<h3>Value</h3>

<p>Returns a class <code>'irf'</code> list with the following elements:
</p>

<dl>
<dt>
<code>$point_est</code>:</dt>
<dd>
<p>a 3D array <code>[variables, shock, horizon]</code> containing the point estimates of the IRFs.
Note that the first slice is for the impact responses and the slice i+1 for the period i. The response of the
variable 'i1' to the shock 'i2' is subsetted as <code>$point_est[i1, i2, ]</code>.</p>
</dd>
<dt>
<code>$conf_ints</code>:</dt>
<dd>
<p>bootstrapped confidence intervals for the IRFs in a <code>[variables, shock, horizon, bound]</code>
4D array. The lower bound is obtained as <code>$conf_ints[, , , 1]</code>, and similarly the upper bound as
<code>$conf_ints[, , , 2]</code>. The subsetted 3D array is then the bound in a form similar to <code>$point_est</code>.</p>
</dd>
<dt>
<code>$all_bootstrap_reps</code>:</dt>
<dd>
<p>IRFs from all of the bootstrap replications in a <code>[variables, shock, horizon, rep]</code>.
4D array. The IRF from replication i1 is obtained as <code>$all_bootstrap_reps[, , , i1]</code>, and the subsetted 3D array
is then the in a form similar to <code>$point_est</code>.</p>
</dd>
<dt>Other elements:</dt>
<dd>
<p>contains some of the arguments the <code>linear_IRF</code> was called with.</p>
</dd>
</dl>
<h3>Functions</h3>


<ul>
<li> <p><code>plot(irf)</code>: plot method
</p>
</li>
<li> <p><code>print(irf)</code>: print method
</p>
</li>
</ul>
<h3>References</h3>


<ul>
<li>
<p> Herwartz H. and L端tkepohl H. 2014. Structural vector autoregressions with Markov switching:
Combining conventional with statistical identification of shocks. <em>Journal of Econometrics</em>,
183, pp. 104-116.
</p>
</li>
<li>
<p> Kilian L. and L端tkepohl H. 2017. Structural Vectors Autoregressive Analysis.
<em>Cambridge University Press</em>, Cambridge.
</p>
</li>
<li>
<p> Virolainen S. (forthcoming). A statistically identified structural vector autoregression with endogenously
switching volatility regime. <em>Journal of Business &amp; Economic Statistics</em>.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>GIRF</code>, <code>GFEVD</code>, <code>fitGSMVAR</code>, <code>GSMVAR</code>,
<code>gsmvar_to_sgsmvar</code>, <code>reorder_W_columns</code>, <code>swap_W_signs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  
 # These are long running examples that take a few minutes to run

 ## GMVAR, p=5, M=2, d=2 model with linear AR dynamics.
 # recursive identification, IRF based on the first regime:
 params52cm &lt;- c(0.788, 0.559, 0.277, 0.038, -0.061, 0.463, 0.286, 0,
               0.035, 0.161, -0.112, 0.031, -0.313, 0.183, 0.103, 0.014,
               0.002, 0.143, -0.089, -0.013, 0.182, -0.04, 1.3, 0.008,
               0.139, 0.277, -0.005, 0.032, 0.118)
 mod52cm &lt;- GSMVAR(data=gdpdef, p=5, M=2, params=params52cm,
                   constraints=rbind(diag(5*2^2), diag(5*2^2)),
                   same_means=list(1:2), parametrization="mean")
 irf1 &lt;- linear_IRF(mod52cm, regime=1, N=20, scale=cbind(c(1, 1, 1), c(2, 2, 1)))
 print(irf1, digits=3)
 plot(irf1)

 # Identification by heteroskedasticity, bootstrapped confidence intervals and
 # and scaled instantaneous effects of the shocks. Note that in actual
 # empirical application, a larger number of bootstrap reps should be used.
 mod52cms &lt;- gsmvar_to_sgsmvar(mod52cm)
 irf2 &lt;- linear_IRF(mod52cms, regime=1, N=20, ci=0.68, bootstrap_reps=10,
                    ncalls=1, seeds=1:10, ncores=1)
 plot(irf2)
 
</code></pre>


</div>