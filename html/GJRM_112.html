<div class="container">

<table style="width: 100%;"><tr>
<td>hiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>HIV Zambian data</h2>

<h3>Description</h3>

<p>HIV Zambian data by region, together with polygons describing the regions' shapes.</p>


<h3>Usage</h3>

<pre><code class="language-R">data(hiv)
data(hiv.polys)
</code></pre>


<h3>Format</h3>

 <p><code>hiv</code> is a 6416 row data frame with the following columns 
</p>

<dl>
<dt>hivconsent</dt>
<dd>
<p>binary variable indicating consent to test for HIV.</p>
</dd>
<dt>hiv</dt>
<dd>
<p>binary variable indicating whether an individual is HIV positive.</p>
</dd>
<dt>age</dt>
<dd>
<p>age in years.</p>
</dd>
<dt>education</dt>
<dd>
<p>years of education.</p>
</dd>
<dt>region</dt>
<dd>
<p>code identifying region, and matching <code>names(hiv.polys)</code>. It can take nine possible values: 1 central, 2 copperbelt, 3 eastern, 
4 luapula, 5 lusaka, 6 northwestern, 7 northern, 8 southern, 9 western.</p>
</dd>
<dt>marital</dt>
<dd>
<p>never married, currently married, formerly married.</p>
</dd>
<dt>std</dt>
<dd>
<p>had a sexually transmitted disease.</p>
</dd>
<dt>highhiv</dt>
<dd>
<p>had high risk sex.</p>
</dd>
<dt>condom</dt>
<dd>
<p>used condom during last intercourse.</p>
</dd>
<dt>aidscare</dt>
<dd>
<p>equal to 1 if would care for an HIV-infected relative.</p>
</dd>
<dt>knowsdiedofaids</dt>
<dd>
<p>equal to 1 if know someone who died of HIV.</p>
</dd>
<dt>evertestedHIV</dt>
<dd>
<p>equal to 1 if previously tested for HIV.</p>
</dd>           
<dt>smoke</dt>
<dd>
<p>smoker.</p>
</dd>         
<dt>ethnicity</dt>
<dd>
<p>bemba, lunda (luapula), lala, ushi, lamba, tonga, luvale,
lunda (northwestern), mbunda, kaonde, lozi, chewa, nsenga,
ngoni, mambwe, namwanga, tumbuka, other.</p>
</dd>              
<dt>language</dt>
<dd>
<p>English, Bemba, Lozi, Nyanja, Tonga, other.</p>
</dd>                     
<dt>interviewerID</dt>
<dd>
<p>interviewer identifier.</p>
</dd>                        
<dt>sw</dt>
<dd>
<p>survey weights.</p>
</dd>  
</dl>
<p><code>hiv.polys</code> contains the polygons defining the areas in the format described below.
</p>


<h3>Details</h3>

<p>The data frame <code>hiv</code> relates to the regions whose boundaries are coded in <code>hiv.polys</code>.
<code>hiv.polys[[i]]</code> is a 2 column matrix, containing the vertices of the polygons defining the boundary of the ith 
region. <code>names(hiv.polys)</code> matches <code>hiv$region</code> (order unimportant).
</p>


<h3>Source</h3>

<p>The data have been produced as described in: 
</p>
<p>McGovern M.E., Barnighausen T., Marra G. and Radice R. (2015), On the Assumption of Joint Normality in Selection Models: A Copula Approach Applied to Estimating HIV Prevalence. <em>Epidemiology</em>, 26(2), 229-237.
</p>


<h3>References</h3>

<p>Marra G., Radice R., Barnighausen T., Wood S.N. and McGovern M.E. (2017), A Simultaneous Equation Approach to Estimating HIV Prevalence with Non-Ignorable Missing Responses. <em>Journal of the American Statistical Association</em>, 112(518), 484-496.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run:  

#########################################################
#########################################################

library("GJRM")

data("hiv", package = "GJRM")        
data("hiv.polys", package = "GJRM")  

#########################################################
#########################################################
## The stuff below is useful if the user wishes to employ  
## a Markov Random Field (MRF) smoother. It provides
## the instructions to set up polygons automatically
## and the dataset variable needed to fit a model with 
## MRF.
#########################################################
#########################################################
#
# ## hiv.polys was already created and
# ## made available via the call 
# ## data("hiv.polys", package = "GJRM") 
# ## hiv.polys was created using the code below
#
# obj &lt;- readRDS("ZMB_adm1.rds") 
# ## RDS Zambian Level 1 file obtained from 
# ## http://www.gadm.org. 
#
# pol &lt;- polys.setup(obj)
#
# hiv.polys &lt;- pol$polys   
# name &lt;- cbind(names(hiv.polys), pol$names1)
# name
#
## last step was to create a factor variable with range
## range(name[,1]) where the numerical values were linked   
## to the regions in name[, 2]. This is what was done in 
## the hiv dataset; see hiv$region. Specifically,
## the procedure used was
##
# reg &lt;- NULL
# 
# for(i in 1:dim(hiv)[1]){
# 
# if(hiv$region[i] == "Central")       reg[i] &lt;- 1
# if(hiv$region[i] == "Copperbelt")    reg[i] &lt;- 2
# if(hiv$region[i] == "Eastern")       reg[i] &lt;- 3
# if(hiv$region[i] == "Luapula")       reg[i] &lt;- 4
# if(hiv$region[i] == "Lusaka")        reg[i] &lt;- 5
# if(hiv$region[i] == "North-Western") reg[i] &lt;- 6
# if(hiv$region[i] == "Northern")      reg[i] &lt;- 7
# if(hiv$region[i] == "Southern")      reg[i] &lt;- 8
# if(hiv$region[i] == "Western")       reg[i] &lt;- 9
# 
# }
# 
# hiv$region &lt;- as.factor(reg)
# 
# 
#########################################################
#########################################################

xt &lt;- list(polys = hiv.polys) 

# neighbourhood structure info for MRF  
# to use in model specification

#########################################################
# Bivariate brobit model with non-random sample selection
#########################################################          
     
sel.eq &lt;- hivconsent ~ s(age) + s(education) + s(wealth) + 
                       s(region, bs = "mrf", xt = xt, k = 7) + 
                       marital + std + age1sex_cat + highhiv + 
                       partner + condom + aidscare + 
                       knowsdiedofaids + evertestedHIV + 
                       smoke + religion + ethnicity + 
                       language + s(interviewerID, bs = "re")
 
out.eq &lt;- hiv        ~ s(age) + s(education) + s(wealth) + 
                       s(region, bs = "mrf", xt = xt, k = 7) + 
                       marital + std + age1sex_cat + highhiv + 
                       partner + condom + aidscare + 
                       knowsdiedofaids + evertestedHIV + 
                       smoke + religion + ethnicity + 
                       language      

theta.eq &lt;-          ~ s(region, bs = "mrf", xt = xt, k = 7)                       
    
fl &lt;- list(sel.eq, out.eq, theta.eq)    
     
# the above model specification is fairly
# complex and it serves to illustrate the 
# flexibility of the modelling approach
     
bss &lt;- gjrm(fl, data = hiv, copula = "J90", model = "BSS",
            margins = c("probit", "probit"))

conv.check(bss)

set.seed(1)
sb &lt;- summary(bss)
sb

plot(bss, eq = 1, seWithMean = TRUE, scheme = 1,   
     scale = 0, pages = 1, jit = TRUE)
                    
plot(bss, eq = 2, seWithMean = TRUE, scheme = 1,
     scale = 0, pages = 1, jit = TRUE)


prev(bss, sw = hiv$sw, type = "naive") 

set.seed(1)
prev(bss, sw = hiv$sw, type = "univariate") 

prev(bss, sw = hiv$sw) 


lr &lt;- length(hiv.polys) 
prevBYreg  &lt;- matrix(NA, lr, 2)
thetaBYreg &lt;- NA

for(i in 1:lr) {
prevBYreg[i,1] &lt;- prev(bss, sw = hiv$sw, ind = hiv$region==i, 
                       type = "univariate")$res[2]
prevBYreg[i,2] &lt;- prev(bss, sw = hiv$sw, ind = hiv$region==i)$res[2]
thetaBYreg[i]  &lt;- bss$theta[hiv$region==i][1]
}


zlim &lt;- range(prevBYreg)  # to establish a common prevalence range

par(mfrow = c(1, 3), cex.axis = 1.3)

polys.map(hiv.polys, prevBYreg[,1], zlim = zlim, lab = "",  
          cex.lab = 1.5, cex.main = 1.5, 
          main = "HIV - Imputation Model")
          
polys.map(hiv.polys, prevBYreg[,2], zlim = zlim, cex.main = 1.5, 
          main = "HIV - Selection Model")
          
polys.map(hiv.polys, thetaBYreg, rev.col = FALSE, cex.main = 1.7, 
          main = expression(paste("Copula parameter (",hat(theta),")")))
          
sb$CItheta[1,]

## End(Not run)

#

</code></pre>


</div>