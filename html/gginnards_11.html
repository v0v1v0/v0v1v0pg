<div class="container">

<table style="width: 100%;"><tr>
<td>delete_layers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Layer manipulation.</h2>

<h3>Description</h3>

<p>Delete, move or append one or more layers in a ggplot object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">delete_layers(x, match_type = NULL, idx = NULL)

append_layers(x, object, position = "top")

move_layers(x, match_type = NULL, position = "top", idx = NULL)

shift_layers(x, match_type = NULL, idx = NULL, shift = 1L)

which_layers(x, match_type = NULL, idx = NULL)

extract_layers(x, match_type = NULL, idx = NULL)

top_layer(x)

bottom_layer(x)

num_layers(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>gg</code> to be operated upon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match_type</code></td>
<td>
<p>The name of the ggproto object class for the geom(s),
position(s) or stat(s) matching that of the layers to be operated upon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>
<p>integer vector Index into the list of layers used to select the
layers to be operated upon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a ggplot layer created by a <code>geom_</code> or <code>stat_</code>
function or a list of such layers or an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position</code></td>
<td>
<p>character or interger, the position of the layer immediately
above of which to move or append the moved or appended layers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>integer.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions must be used with care as they select all layers
matching the provided geom, position or stat ggproto object class. Layers
added with a stat do use a geom, and vice versa.
</p>
<p>One and only one of <code>match_type</code> and <code>idx</code> must be passed a
non-null argument.
</p>
<p>In plots with several layers, it is possible that more than one layer
matches the class name passed to <code>match_type</code>. It is also possible to
pass a numeric vector with multiple indexes through parameter <code>idx</code>.
In both cases multiple layers will be operated upon, but their relative
positions will remain unchanged.
</p>
<p>If a numeric vector with multiple position indexes is supplied as argument
for <code>position</code>, the topmost position will be used. As indexing in R
starts at 1, passing 0 or <code>"bottom"</code> as argument for <code>position</code>
puts the moved or appended layer(s) behind all other layers (prepends the
layer).
</p>


<h3>Value</h3>

<p>An edited copy of <code>x</code> for <code>delete_layers</code>,
<code>append_layers</code> and <code>move_layers</code>. An integer vector of indexes
giving the positions of the matching layers in the list of layers contained
in <code>x</code> in the case of <code>which_layers</code>.
</p>


<h3>Note</h3>

<p>The functions described here are not expected to be useful in everyday
plotting as one can more easily change the order in which layers are added
to a ggplot. However, if one uses high level methods or functions that
automatically produce a full plot using 'ggplot2' internally, one may need
to add, move or delete layers so as to profit from such canned methods and
retain enough flexibility.
</p>


<h3>References</h3>

<p><a href="https://stackoverflow.com/questions/13407236/remove-a-layer-from-a-ggplot2-chart">https://stackoverflow.com/questions/13407236/remove-a-layer-from-a-ggplot2-chart</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">df &lt;- data.frame(
  gp = factor(rep(letters[1:3], each = 10)),
  y = rnorm(30)
)
p &lt;- ggplot(df, aes(gp, y)) +
       geom_point() +
       stat_summary(fun.data = "mean_se", colour = "red")
p
delete_layers(p, "GeomPoint")
delete_layers(p, "StatSummary")
move_layers(p, "GeomPoint", position = "top")
move_layers(p, "GeomPointrange", position = "bottom")
move_layers(p, "StatSummary", position = "bottom")
move_layers(p, "GeomPointrange", position = 1L)
append_layers(p, geom_line(colour = "orange"), position = "bottom")
append_layers(p, geom_line(colour = "orange"), position = 1L)
extract_layers(p, "GeomPoint")
ggplot(df, aes(gp, y)) + extract_layers(p, "GeomPoint")
which_layers(p, "GeomPoint")
num_layers(p)
top_layer(p)
bottom_layer(p)
num_layers(ggplot())
top_layer(ggplot())
bottom_layer(ggplot())

if (requireNamespace("sf", quietly = TRUE)) {
  nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)
  nc_3857 &lt;- sf::st_transform(nc, 3857)

  p.sf1 &lt;- ggplot() +
           geom_sf(data = nc)
  p.sf1
  num_layers(p.sf1)
  top_layer(p.sf1)

  append_layers(p.sf1,
                geom_sf(data = nc_3857, colour = "red", fill = NA),
                position = "top")

  p.sf2 &lt;- ggplot() +
           geom_sf(data = nc) +
           geom_sf(data = nc_3857, colour = "red", fill = NA)
  p.sf2
  num_layers(p.sf2)
  top_layer(p.sf2)
  delete_layers(p.sf2, idx = 2L)

  extract_layers(p.sf2, "GeomSf")
  extract_layers(p.sf2, "StatSf")
  extract_layers(p.sf2, idx = 1L)
  p.sf1 + extract_layers(p.sf2, idx = 2L)

  # beware that Coords are not extracted!
  ggplot() + extract_layers(p.sf2, idx = 2L) + coord_sf()
}

</code></pre>


</div>