<div class="container">

<table style="width: 100%;"><tr>
<td>GeoVariogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical semi-variogram estimation</h2>

<h3>Description</h3>

<p>The function returns an empirical estimate of the  semi-variogram  for spatio (temporal)  and bivariate 
random fields. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">GeoVariogram(data, coordx, coordy=NULL, coordt=NULL, 
coordx_dyn=NULL,cloud=FALSE, distance="Eucl",
              grid=FALSE, maxdist=NULL,neighb=NULL,
              maxtime=NULL, numbins=NULL, 
              radius=6371, type='variogram',bivariate=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector (a single spatial realisation) or a (<code class="reqn">n \times d</code>)-matrix
(<code class="reqn">n</code> iid spatial realisations) or a (<code class="reqn">d \times d</code>)-matrix (a single spatial realisation on regular grid)
or an (<code class="reqn">d \times d \times n</code>)-array (<code class="reqn">n</code> iid spatial realisations on regular grid) or a
(<code class="reqn">t \times d</code>)-matrix (a single spatial-temporal realisation) or an (<code class="reqn">t \times d \times n </code>)-array
(<code class="reqn">n</code> iid spatial-temporal realisations) or or an (<code class="reqn">d \times d \times t \times n </code>)-array
(a single spatial-temporal realisation on regular grid) or an (<code class="reqn">d \times d \times t \times n </code>)-array
(<code class="reqn">n</code> iid spatial-temporal realisations on regular grid). See <code>GeoFit</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx</code></td>
<td>
<p>A numeric (<code class="reqn">d \times 2</code>)-matrix (where
<code>d</code> is the number of spatial sites) assigning 2-dimensions of spatial coordinates or a numeric <code class="reqn">d</code>-dimensional vector assigning
1-dimension of spatial coordinates.  Coordinates on a sphere for a  fixed radius <code>radius</code> 
are passed in lon/lat format expressed in decimal degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordy</code></td>
<td>
<p>A numeric vector assigning 1-dimension of
spatial coordinates; <code>coordy</code> is interpreted only if <code>coordx</code> is a numeric
vector or <code>grid=TRUE</code> otherwise it will be ignored. Optional argument, the default is <code>NULL</code> then <code>coordx</code> is expected to
be numeric a (<code class="reqn">d \times 2</code>)-matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordt</code></td>
<td>
<p>A numeric vector assigning 1-dimension of
temporal coordinates. Optional argument, the default is <code>NULL</code> then a spatial random field is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx_dyn</code></td>
<td>
<p>A list of <code class="reqn">m</code> numeric (<code class="reqn">d_t \times 2</code>)-matrices
containing dynamical (in time) spatial coordinates. Optional argument, the default is <code>NULL</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cloud</code></td>
<td>
<p>Logical; if <code>TRUE</code> the semivariogram cloud is computed,
otherwise if <code>FALSE</code> (the default) the empirical (binned)
semivariogram is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>String; the name of the spatial distance. The default
is <code>Eucl</code>, the euclidean distance. See the Section
<b>Details</b> of <code>GeoFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical; if <code>FALSE</code> (the default) the data
are interpreted as spatial or spatial-temporal realisations on a set of 
non-equispaced spatial sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>A numeric value denoting the spatial maximum distance,
see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighb</code></td>
<td>
<p>Numeric; an optional positive integer indicating the 
order of neighborhood. See the Section <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>A numeric value denoting the temporal maximum distance,
see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numbins</code></td>
<td>
<p>A numeric value denoting the numbers of bins, see the
Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Numeric; a value indicating  the radius of the sphere when 
using the great circle distance. Default value is the radius of the earth in Km (i.e. 6371)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A String denoting the type of semivariogram. The option
available is : <code>variogram</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bivariate</code></td>
<td>
<p>Logical; if <code>FALSE</code> (the default) the data
are interpreted as univariate spatial or spatial-temporal realisations. 
Otherwise they are intrepreted as a a realization from a bivariate field.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We briefly report the definitions of semi-variogram used for the spatial case. It can be easily extended 
to the space-time or spatial bivariate case.
In the case of a spatial Gaussian random field
the sample semivariogram estimator is defined by
</p>
<p style="text-align: center;"><code class="reqn">\hat{\gamma}(h) = 0.5 \sum_{x_i, x_j \in N(h)} (Z(x_i) - Z(x_j))^2 / |N(h)|</code>
</p>

<p>where <code class="reqn">N(h)</code> is the set of all the sample pairs whose distances fall into a tolerance region with size <code class="reqn">h</code>
(equispaced intervalls are considered).
</p>
<p>The  <code>numbins</code> parameter indicates the number of adjacent
intervals to consider in order to grouped distances with which to
compute the (weighted) lest squares.
</p>
<p>The <code>maxdist</code> parameter indicates the maximum spatial distance below which
the shorter distances will be considered in the calculation of
the semivariogram.
</p>
<p>The <code>maxdist</code> parameter can be coupled with the <code>neighb</code> parameter. This is useful when handling large dataset.
</p>
<p>The <code>maxtime</code> parameter indicates the maximum temporal distance below which
the shorter distances will be considered in the calculation of
the spatio-temoral semivariogram.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>Variogram</code>.
An object of class <code>Variogram</code> is a list containing
at most the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>Adjacent intervals of grouped spatial distances if
<code>cloud=FALSE</code>. Otherwise if <code>cloud=TRUE</code> all the spatial pairwise distances;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bint</code></td>
<td>
<p>Adjacent intervals of grouped temporal distances if
<code>cloud=FALSE</code>. Otherwise if <code>cloud=TRUE</code> all the temporal pairwise distances;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cloud</code></td>
<td>
<p>If the variogram cloud is returned (<code>TRUE</code>) or the
empirical variogram (<code>FALSE</code>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>The centers of the spatial bins;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The type of spatial distance;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lenbins</code></td>
<td>
<p>The number of pairs in each spatial bin;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lenbinst</code></td>
<td>
<p>The number of pairs in each spatial-temporal bin;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lenbint</code></td>
<td>
<p>The number of pairs in each temporal bin;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>The maximum spatial distance used for the calculation of the variogram.
If no spatial distance is specified then it is NULL;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>The maximum temporal distance used for the calculation of the variogram.
If no temporal distance is specified then it is NULL;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacetime_dyn</code></td>
<td>
<p>If the space-time variogram is obtained using dynamical coordinates
then it is(<code>TRUE</code>).   </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variograms</code></td>
<td>
<p>The empirical spatial variogram;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variogramst</code></td>
<td>
<p>The empirical spatial-temporal variogram;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variogramt</code></td>
<td>
<p>The empirical temporal variogram;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of estimated variogram</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Moreno Bevilacqua, <a href="mailto:moreno.bevilacqua89@gmail.com">moreno.bevilacqua89@gmail.com</a>,<a href="https://sites.google.com/view/moreno-bevilacqua/home">https://sites.google.com/view/moreno-bevilacqua/home</a>,
Víctor Morales Oñate, <a href="mailto:victor.morales@uv.cl">victor.morales@uv.cl</a>, <a href="https://sites.google.com/site/moralesonatevictor/">https://sites.google.com/site/moralesonatevictor/</a>,
Christian", Caamaño-Carrillo, <a href="mailto:chcaaman@ubiobio.cl">chcaaman@ubiobio.cl</a>,<a href="https://www.researchgate.net/profile/Christian-Caamano">https://www.researchgate.net/profile/Christian-Caamano</a>
</p>


<h3>References</h3>

<p>Cressie, N. A. C. (1993) <em>Statistics for Spatial Data</em>. New York: Wiley.
</p>
<p>Gaetan, C. and Guyon, X. (2010) <em>Spatial Statistics and Modelling</em>.
Spring Verlang, New York.
</p>


<h3>See Also</h3>

<p><code>GeoFit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(GeoModels)

################################################################
###
### Example 1. Empirical estimation of the semi-variogram from a
### spatial Gaussian random field with exponential correlation.
###
###############################################################
set.seed(514)
# Set the coordinates of the sites:
x = runif(200, 0, 1)
y = runif(200, 0, 1)
coords = cbind(x,y)
# Set the model's parameters:
corrmodel = "Exponential"
mean = 0
sill = 1
nugget = 0
scale = 0.3/3

# Simulation of the spatial Gaussian random field:
data = GeoSim(coordx=coords, corrmodel=corrmodel, param=list(mean=mean,
              sill=sill, nugget=nugget, scale=scale))$data

# Empirical spatial semi-variogram estimation:
vario = GeoVariogram(coordx=coords,data=data,maxdist=0.6)

plot(vario,pch=20,ylim=c(0,1),ylab="Semivariogram",xlab="Distance")


################################################################
###
### Example 2. Empirical estimation of the variogram from a
### spatio-temporal Gaussian random fields with Gneiting
### correlation function.
###
###############################################################

set.seed(331)
# Define the temporal sequence:
# Set the coordinates of the sites:
x = runif(200, 0, 1)
y = runif(200, 0, 1)
coords = cbind(x,y)
times = seq(1,10,1)

# Simulation of a spatio-temporal Gaussian random field:
data = GeoSim(coordx=coords, coordt=times, corrmodel="gneiting",
              param=list(mean=0,scale_s=0.08,scale_t=0.4,sill=1,
              nugget=0,power_s=1,power_t=1,sep=0.5))$data

# Empirical spatio-temporal semi-variogram estimation:
vario_st = GeoVariogram(data=data, coordx=coords, coordt=times, maxtime=7,maxdist=0.5)

plot(vario_st)
      
################################################################
###
### Example 3. Empirical estimation of the (cross) semivariograms 
### from a bivariate Gaussian random fields with Matern
### correlation function.
###
###############################################################
# Simulation of a bivariate spatial Gaussian random field:
set.seed(293)
# Define the spatial-coordinates of the points:
x = runif(400, 0, 1)
y = runif(400, 0, 1)
coords=cbind(x,y)

# Simulation of a bivariate Gaussian Random field 
# with matern (cross)  covariance function
param=list(mean_1=0,mean_2=0,scale_1=0.1/3,scale_2=0.15/3,scale_12=0.15/3,
           sill_1=1,sill_2=1,nugget_1=0,nugget_2=0,
           smooth_1=0.5,smooth_12=0.5,smooth_2=0.5,pcol=0.3)  
data = GeoSim(coordx=coords, corrmodel="Bi_matern", param=param)$data

# Empirical  semi-(cross)variogram estimation:
biv_vario=GeoVariogram(data,coordx=coords, bivariate=TRUE,maxdist=0.5)  

plot(biv_vario,pch=20)
      
</code></pre>


</div>