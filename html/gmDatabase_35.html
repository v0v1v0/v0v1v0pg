<div class="container">

<table style="width: 100%;"><tr>
<td>gmConnectServer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Geometallurgy Database connection</h2>

<h3>Description</h3>

<p>A geometallurgy database is a database on a relational database
server. It can handle very general and recursive information for
the transparent access to whole projects from a statistical analysis
software.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">gmConnectServer(..., server="localhost", dbuser, asDefault=TRUE)
gmDisconnectServer(db=getOption("gmDB"))
gmCreateDB(..., dbName="gmDatabase", admin=NULL, adminPwd=NULL)
gmListVariables(pattern="%",db=getOption("gmDB"))
gmListVariableTypes(db=getOption("gmDB"))
gmDBSummary(db=getOption("gmDB"))
gmEscapeStrings(s,db=getOption("gmDB"))
gmRequest(fun, parameters, db)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to <code>dbConnect</code> from RMySQL to contact the
database server.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asDefault</code></td>
<td>
<p>Logical indicating whether being used as default connection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>A database connection object as returned by <code>gmConnectServer</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>server</code></td>
<td>
<p>The address of the server, where the R server.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbuser</code></td>
<td>
<p>A list giving the <code>login</code> and <code>password</code> of the user working in the geometallurgical database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbName</code></td>
<td>
<p>String stating the name for the database to-be.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>admin</code></td>
<td>
<p>The login for the administrator/the first database user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adminPwd</code></td>
<td>
<p>The password for the administrator/the database user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>An SQL-regular expression (for LIKE) to specify the
variable names to be listed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>A character vector of strings to be escaped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>A function name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A list of parameters for the function <code>fun</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The geometallurgy database provides an abstraction layer to a
relational database storage of many eventually differently structured
datasets, which might contain datasets recursively. Only in this very
complex structure it is possible to respresent the data needed for
typical statistical tasks of geometallurgy.
</p>
<p>The data storage starts from a common root object "root", which
contains a variable set variable "project". 
</p>
<p>The Database connection is handled by <code>gmConnectServer</code> and <code>gmDisconnectServer</code>. In order to assure a proper rights management, the 
user does not directly connect to the database. We implemented a two level security system. The first level represents the connection to the 
database server. Therefore a general user on the server is needed, who is provided with the required rights to access and manipulate the database 
itself. The corresponding credentials are compiled in <code>...</code> and will be forwarded to dbConnect from the package RMySQL.
Data access happens on the second level, where the <code>dbuser</code> is involved. His credentials are checked against the information stored in the 
database. Everytime some information is queried from the database, the result is given according to the rights this user owns on this particular
data. If no user is explicitly given during the function call, i.e. <code>dbuser</code> is missing, <code>gmConnectServer</code> will start a dialog to access
the (db)user's credentials. Same is true, if information on the general database server user is omitted.
</p>
<p>In order to create a compatible database, you may <code>gmCreateDB</code>. A connection to the given MySQL-server is established and a new database of
the given <code>dbName</code> is created. Furthermore first variables to realise the user/rights management are provided. Additonally a first 
user/admin is added to the database with the given username and password, so that this user is able to login to the database afterwards. If no 
MySQL login, MySQL password or MySQL host is given, a shiny app requests these information. Same happens if no login or password is given for the 
first user/admin.
</p>
<p>This package can be used in a client - server approach. Then <code>gmConnectServer</code> will not return a database connection, but a socket
connection. It will be used to send the commands to an R server. The actual translation from R into SQL is then done on the server. Again only 
the accessible data according to the user's rights will be returned. In order to activate the client-server mode, use the argument <code>server</code> 
to state the server you want to access. By default <code>server</code> is set to <code>localhost</code>.
</p>
<p><code>gmRequest</code> is an internal function. It should not be called directly. Depending on the class of database connection used, it decides if the
<code>fun</code> is evaluated locally or handed over to the server.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gmConnectServer</code></td>
<td>
<p>Returns a server connection to be used in subsequent calls. It is assigned to the hidden variable <code>.gmDB</code>.
If <code>server</code> ist set to localhost, it will be a database connection instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmDisconnectServer</code></td>
<td>
<p>Returns the same as <code>gmDisconnectDB</code>. Additionally <code>.gmDB</code> is set to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmCreateDB</code></td>
<td>
<p>No return value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmListVariables</code></td>
<td>
<p>Returns a dataframe describing the variables
defined in the geometallurgy database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmListVariableTypes</code></td>
<td>
<p>Returns a dataframe describing the variable
types defined in the geometallurgy database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmDBSummary</code></td>
<td>
<p>Returns a dataframe giving variable name,
variable type and number of objects 
for each variable.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>K. Gerald van den Boogaart, S. Matos Camacho</p>


<h3>See Also</h3>

<p><code>MySQLConnection-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
gmCreateDB(MySQL(), user="mysqlUser", password="mysqlPassword", host="mysqlServer", 
  dbName="myDB", admin="admin",adminPwd="myAdminPassword")
gmConnectServer(MySQL(), group="test", server="localhost")
gmListVariables(pattern=".*",db=.gmDB)
gmListVariableTypes(db=.gmDB)
gmDBSummary(db=.gmDB)
gmDisconnectServer()


## End(Not run)
</code></pre>


</div>