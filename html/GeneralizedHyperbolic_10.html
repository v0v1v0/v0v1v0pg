<div class="container">

<table style="width: 100%;"><tr>
<td>Generalized Inverse Gaussian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Inverse Gaussian Distribution</h2>

<h3>Description</h3>

<p>Density function, cumulative distribution function, quantile function
and random number generation for the generalized inverse Gaussian
distribution with parameter vector <code>param</code>. Utility routines are
included for the derivative of the density function and to find
suitable break points for use in determining the distribution function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgig(x, chi = 1, psi = 1, lambda = 1,
     param = c(chi, psi, lambda), KOmega = NULL)
pgig(q, chi = 1, psi = 1, lambda = 1,
     param = c(chi,psi,lambda), lower.tail = TRUE,
     ibfTol = .Machine$double.eps^(0.85), nmax = 200)
qgig(p, chi = 1, psi = 1, lambda = 1,
     param = c(chi, psi, lambda), lower.tail = TRUE,
     method = c("spline", "integrate"),
     nInterpol = 501, uniTol = 10^(-7),
     ibfTol = .Machine$double.eps^(0.85), nmax =200, ...)
rgig(n, chi = 1, psi = 1, lambda = 1,
     param = c(chi, psi, lambda))
rgig1(n, chi = 1, psi = 1, param = c(chi, psi))
ddgig(x, chi = 1, psi = 1, lambda = 1,
      param = c(chi, psi, lambda), KOmega = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>Vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi</code></td>
<td>
<p>A shape parameter that by default holds a value of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>Another shape parameter that is set to 1 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Shape parameter of the GIG distribution. Common to all
forms of parameterization. By default this is set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Parameter vector taking the form <code>c(chi, psi, lambda)</code>
for <code>rgig</code>, or <code>c(chi, psi)</code> for <code>rgig1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character. If <code>"spline"</code> quantiles are found from a
spline approximation to the distribution function. If
<code>"integrate"</code>, the distribution function used is always obtained
by integration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>Logical. If <code>TRUE</code>, probabilities are
<code class="reqn">P(X\leq x)</code>, otherwise as <code class="reqn">P(X&gt;x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KOmega</code></td>
<td>
<p>Sets the value of the Bessel function in the density or
derivative of the density. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ibfTol</code></td>
<td>
<p>Value of tolerance to be passed to
<code>incompleteBesselK</code> by <code>pgig</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>Value of maximum order of the approximating series to be
passed to <code>incompleteBesselK</code> by <code>pgig</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nInterpol</code></td>
<td>
<p>The number of points used in qgig for cubic spline
interpolation (see <code>splinefun</code>) of the distribution function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniTol</code></td>
<td>
<p>Value of <code>tol</code> in
calls to <code>uniroot</code>. See <code>uniroot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passes arguments to <code>uniroot</code>.  See <b>Details</b>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The generalized inverse Gaussian distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{(\psi/\chi)^{\frac{\lambda}{2}}}%
    {2K_\lambda(\sqrt{\psi\chi})}x^{\lambda-1}%
    e^{-\frac{1}{2}\left(\chi x^{-1}+\psi x\right)}</code>
</p>

<p>for <code class="reqn">x&gt;0</code>, where <code class="reqn">K_\lambda()</code> is the
modified Bessel function of the third kind with order
<code class="reqn">\lambda</code>.
</p>
<p>The generalized inverse Gaussian distribution is investigated in
detail in Jörgensen (1982).
</p>
<p>Use <code>gigChangePars</code> to convert from the
<code class="reqn">(\delta,\gamma)</code>,
<code class="reqn">(\alpha,\beta)</code>, or
<code class="reqn">(\omega,\eta)</code> parameterizations to the
<code class="reqn">(\chi,\psi)</code>, parameterization used above.
</p>
<p><code>pgig</code> calls the function
<code>incompleteBesselK</code> from the package
<span class="pkg">DistributionUtils</span> to integrate the density function
<code>dgig</code>. This can be expected to be accurate to about 13 decimal
places on a 32-bit computer, often more accurate. The algorithm used
is due to Slavinsky and Safouhi (2010).
</p>
<p>Calculation of quantiles using <code>qgig</code> permits the use of two
different methods. Both methods use <code>uniroot</code> to find the value
of <code class="reqn">x</code> for which a given <code class="reqn">q</code> is equal <code class="reqn">F(x)</code> where <code class="reqn">F</code>
denotes the cumulative distribution function. The difference is in how
the numerical approximation to <code class="reqn">F</code> is obtained. The obvious
and more accurate method is to calculate the value of <code class="reqn">F(x)</code>
whenever it is required using a call to <code>pghyp</code>. This is what
is done if the method is specified as <code>"integrate"</code>. It is clear
that the time required for this approach is roughly linear in the
number of quantiles being calculated. A Q-Q plot of a large data set
will clearly take some time. The alternative (and default) method is
that for the major part of the distribution a spline approximation to
<code class="reqn">F(x)</code> is calculated and quantiles found using <code>uniroot</code> with
this approximation. For extreme values (for which the tail probability
is less than <code class="reqn">10^{-7}</code>), the integration method is still
used even when the method specifed is <code>"spline"</code>.
</p>
<p>If accurate probabilities or quantiles are required, tolerances
(<code>intTol</code> and <code>uniTol</code>) should be set to small values, say
<code class="reqn">10^{-10}</code> or <code class="reqn">10^{-12}</code> with <code>method
  = "integrate"</code>. Generally then accuracy might be expected to be at
least <code class="reqn">10^{-9}</code>. If the default values of the functions
are used, accuracy can only be expected to be around
<code class="reqn">10^{-4}</code>. Note that on 32-bit systems
<code>.Machine$double.eps^0.25 = 0.0001220703</code> is a typical value.
</p>
<p>Generalized inverse Gaussian observations are obtained via the
algorithm of Dagpunar (1989).
</p>


<h3>Value</h3>

<p><code>dgig</code> gives the density, <code>pgig</code> gives the distribution
function, <code>qgig</code> gives the quantile function, and <code>rgig</code>
generates random variates. <code>rgig1</code> generates random variates in
the special case where <code class="reqn">\lambda = 1</code>.
</p>
<p><code>ddgig</code> gives the derivative of <code>dgig</code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Richard Trendall,
and Melanie Luen.</p>


<h3>References</h3>

<p>Dagpunar, J.S. (1989). An easily implemented generalised inverse
Gaussian generator. <em>Commun. Statist. -Simula.</em>, <b>18</b>,
703–710.
</p>
<p>Jörgensen, B. (1982). <em>Statistical Properties of
the Generalized Inverse Gaussian Distribution</em>. Lecture Notes in
Statistics, Vol. 9, Springer-Verlag, New York.
</p>
<p>Slevinsky, Richard M., and Safouhi, Hassan (2010) A recursive
algorithm for the G transformation and accurate computation of
incomplete Bessel functions. <em>Appl. Numer. Math.</em>, In press.
</p>


<h3>See Also</h3>

<p><code>safeIntegrate</code>,
<code>integrate</code> for its shortfalls, <code>splinefun</code>,
<code>uniroot</code> and <code>gigChangePars</code> for changing
parameters to the <code class="reqn">(\chi,\psi)</code> parameterization,
<code>dghyp</code> for the generalized hyperbolic distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R">param &lt;- c(2, 3, 1)
gigRange &lt;- gigCalcRange(param = param, tol = 10^(-3))
par(mfrow = c(1, 2))
curve(dgig(x, param = param), from = gigRange[1], to = gigRange[2],
      n = 1000)
title("Density of the\n Generalized Inverse Gaussian")
curve(pgig(x, param = param), from = gigRange[1], to = gigRange[2],
      n = 1000)
title("Distribution Function of the\n Generalized Inverse Gaussian")
dataVector &lt;- rgig(500, param = param)
curve(dgig(x, param = param), range(dataVector)[1], range(dataVector)[2],
      n = 500)
hist(dataVector, freq = FALSE, add = TRUE)
title("Density and Histogram\n of the Generalized Inverse Gaussian")
DistributionUtils::logHist(dataVector, main =
        "Log-Density and Log-Histogram\n of the Generalized Inverse Gaussian")
curve(log(dgig(x, param = param)), add = TRUE,
      range(dataVector)[1], range(dataVector)[2], n = 500)
par(mfrow = c(2, 1))
curve(dgig(x, param = param), from = gigRange[1], to = gigRange[2],
      n = 1000)
title("Density of the\n Generalized Inverse Gaussian")
curve(ddgig(x, param = param), from = gigRange[1], to = gigRange[2],
      n = 1000)
title("Derivative of the Density\n of the Generalized Inverse Gaussian")
</code></pre>


</div>