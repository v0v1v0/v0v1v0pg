<div class="container">

<table style="width: 100%;"><tr>
<td>vgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical variogram</h2>

<h3>Description</h3>

<p><code>vgram</code> calculates an empirical variogram.  Note that, by convention,
the empirical variogram actually estimates the semivariogram, not the
theoretical variogram (which is twice the semivariogram).
</p>


<h3>Usage</h3>

<pre><code class="language-R">vgram(
  formula,
  data,
  coordnames = NULL,
  nbins = 10,
  maxd = NULL,
  angle = 0,
  ndir = 1,
  type = "standard",
  npmin = 2,
  longlat = FALSE,
  verbose = TRUE,
  coords = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula describing the relationship between the response and any covariates of interest, e.g., response ~ 1.  The variogram is computed for the residuals of the linear model <code>lm(formula, data)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code>, <code>SpatialPointsDataFrame</code>, <code>SpatialPixelsDataFrame</code>, or <code>SpatialGridDataFrame</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordnames</code></td>
<td>
<p>The columns of <code>data</code> containing the spatial coordinates,
provided as a formula (e.g., ~ x + y),
column numbers (e.g., c(1, 2)), or column names (e.g., c("x", "y")).
The default is NULL, but this must be specified if <code>data</code> is of class <code>data.frame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>The number of bins (tolerance regions) to use when estimating the sample semivariogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxd</code></td>
<td>
<p>The maximum distance used when calculating the semivariogram.  Default is NULL, in which case half the maximum distance between coordinates is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>A single value (in degrees) indicating the starting direction for a directional variogram.  The default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndir</code></td>
<td>
<p>The number of directions for which to calculate a sample semivariogram.  The default is 1, meaning calculate an omnidirection semivariogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The name of the estimator to use in the estimation process.  The default is "standard", the typical method-of-moments estimator.  Other options include "cressie" for the robust Cressie-Hawkins estimator, and "cloud" for a semivariogram cloud based on the standard estimator.  If "cloud" is specified, the <code>nbins</code> argument is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npmin</code></td>
<td>
<p>The minimum number of pairs of points to use in the semivariogram estimator.  For any bins with fewer points, the estimate for that bin is dropped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>A logical indicating whether Euclidean (<code>FALSE</code>) or Great Circle distance (WGS84 ellipsoid) (<code>longlat = TRUE</code>) should be used.  Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print computation information.  Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>A deprecated argument.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the directions may be different from other packages
(e.g., <code>gstat</code> or <code>geoR</code> packages) because those
packages calculate angles clockwise from the y-axis, which is
a convention frequently seen in geostatistics
(e.g., the GSLIB software library).
</p>
<p>Additionally, note that calculating the empirical variogram for
the residuals of lm(response ~ 1) will produce identical results
to simply computing the sample semivariogram from the original response.
However, if a trend is specified (the righthand side of ~ has non-trival
covariates), then the empirical variogram of the residuals will differ
from that of the original response.  A trend should be specified when
the mean is non-stationary over the spatial domain.
</p>


<h3>Value</h3>

<p>Returns an <code>evgram</code> object with components:
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(co)
v = vgram(Al ~ 1, co, ~ easting + northing)
plot(v)
v2 = vgram(Al ~ 1, co, c("easting", "northing"), angle = 22.5, ndir = 4)
plot(v2)
</code></pre>


</div>