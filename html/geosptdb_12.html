<div class="container">

<table style="width: 100%;"><tr>
<td>graph.rbfST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Graph that describes the behavior of the optimized <em>eta</em> and <em>rho</em> parameters, associated with a spatio-temporal radial basis function.
</h2>

<h3>Description</h3>

<p>Function for plotting the RMSPE for several values of the smoothing parameter
<em>eta</em> with the same dataset. A curve is fitted to the points, and
then the optimal <em>eta</em> that provides the smallest RMSPE is determined from the
curve, by the <code>optimize</code> function from the <code>stats</code>
package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">graph.rbfST(formula, data, eta.opt, rho.opt, n.neigh, func, np, xo, eta.dmax,
rho.dmax, P.T, iter, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula that defines the dependent variable as a linear model of independent variables (covariates or the principal coordinates); suppose the dependent variable has name <code class="reqn">z_{st}</code>, for a <em>rbfST</em> detrended use <code class="reqn">z_{st}</code><code>~1</code>, for a <em>rbfST</em> with trend, suppose <code class="reqn">z_{st}</code> is linearly dependent on <code>x</code> and <code>y</code>, use the formula <code class="reqn">z_{st}</code><code>~x+y</code> (linear trend).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.opt</code></td>
<td>
<p>logical, indicating whether the parameter <em>eta</em> should be regarded as fixed (eta.opt = FALSE) or should be estimated (eta.opt = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.opt</code></td>
<td>
<p>logical, indicating whether the parameter <em>rho</em> should be regarded as fixed (rho.opt = FALSE) or should be estimated (rho.opt = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.neigh</code></td>
<td>
<p>number of nearest observations that should be used for a <em>rbfST</em>
prediction, where nearest is defined in terms of the spatio-temporal locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>function to be optimized. The following radial basis function spatio-temporal model types are currently available: gaussian "GAU", exponential "EXPON", trigonometric "TRI", thin plate spline "TPS", completely regularized spline "CRS", spline with tension "ST", inverse multiquadratic "IM", and multiquadratic "M", are currently available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>number of points, where the radial basis function spatio-temporal is calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xo</code></td>
<td>
<p>starting point for searching the optimum. Defaults to c(0.5, 0.5), <em>eta</em> and <em>rho</em> respectively. Use this statement only if <em>eta</em> and <em>rho</em> are equal to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.dmax</code></td>
<td>
<p>maximum value of the range of the <em>eta</em> parameter that will be evaluated by the <code>optimize</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.dmax</code></td>
<td>
<p>maximum value of the range of the <em>rho</em> parameter that will be evaluated by the <code>optimize</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.T</code></td>
<td>
<p>logical. Print table (TRUE) or not (FALSE). Default P.T=NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The maximum allowed number of function evaluations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters to be passed to the minimization functions <code>optimize</code> or <code>bobyqa</code>, typically arguments of the type control() which control the behavior of the minimization algorithm. See documentation about the selected minimization function for further details.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a graph that describes the behavior of the optimized <em>eta</em> or <em>rho</em> parameters and a table of values associated with the graph including optimal smoothing <em>eta</em> or <em>rho</em> parameters. If both <em>eta</em> and <em>rho</em> are FALSE simultaneously then the function returns a list with the best value obtained from the combinations smoothing <em>eta</em> and <em>rho</em> parameters and a lattice plot of class "trellis" with RMSPE pixel values associated with combinations of <em>eta</em> and <em>rho</em> parameters. Finally, if both <em>eta</em> and <em>rho</em> are TRUE, the function will return a list with the best combination of values of the smoothing <em>eta</em> or <em>rho</em> parameters and the RMSPE associated with these.
</p>


<h3>References</h3>

<p>Johnston, K., Ver, J., Krivoruchko, K., Lucas, N. (2001). <em>Using ArcGIS Geostatistical Analysis</em>. ESRI.
</p>
<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con
aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a>
</p>


<h3>See Also</h3>

<p><code>rbfST</code>, <code>rbfST.cv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(croatiadb)
coordinates(croatiadb)&lt;-~x+y
# optimizing eta
graph.rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb, eta.opt=TRUE,
             rho.opt=FALSE, n.neigh=30, func="TPS", np=40,  eta.dmax=2, P.T=TRUE)
# optimizing rho
graph.rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb, eta.opt=FALSE,
             rho.opt=TRUE, n.neigh=30, func="M", np=20, rho.dmax=2, P.T=TRUE)
# optimizing eta and rho
tps.lo &lt;- graph.rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb,
       eta.opt=TRUE,rho.opt=TRUE, n.neigh=25, func="TPS",  eta.dmax=0.2,
       rho.dmax=0.2, xo=c(0.1,0.1), iter=50)
tps.lo  # best combination of eta and rho obtained
# lattice of RMSPE values associated with a range of eta and rho, without optimization
tps.la &lt;- graph.rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb,
       eta.opt=FALSE, rho.opt=FALSE, n.neigh=30,  func="TPS", np=10,  eta.dmax=0.2,
       rho.dmax=0.2)
tps.l$table  # best combination of eta and rho obtained
tps.l$spplot  # lattice of RMSPE

## End(Not run)
</code></pre>


</div>