<div class="container">

<table style="width: 100%;"><tr>
<td>GT.wrapper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multiple testing procedure for the grouped hypothesis
</h2>

<h3>Description</h3>

<p>This function is the main function to perform the two-stage testing
for the grouped hypotheses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GT.wrapper(TestStatistic, alpha = 0.05, eta = alpha, pi1.ini = 0.7,
pi2.1.ini = 0.4, L = 2, muL.ini = c(-1, 1), sigmaL.ini = c(1, 1),
cL.ini = c(0.5, 0.5), DELTA = 0.001, sigma.KNOWN=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TestStatistic</code></td>
<td>
<p> An array of list. Each list of the array
corresponds to one group, containing the test statistic, stored
as X, and the group size, stored as mg.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> the targeted FDR level. By default, it is chosen as 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p> the targeted FDR level within each group. The default and
recommended choice is alpha. By default, it is chosen as <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi1.ini</code></td>
<td>
<p> Initial value: the probability that a group is
significant. By default, it is chosen as 0.7
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi2.1.ini</code></td>
<td>
<p> Initial value: the probability that an individual
null hypothesis is false given that the group is significant. By
default, it is chosen as 0.4.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p> The number of Gaussian component under the alternative
hypothesis. By default, it is chosen as 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muL.ini</code></td>
<td>
<p> Initial value: a vector of means for all the
components of the Gaussian mixture. By default, is is chosen as -1
and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmaL.ini</code></td>
<td>
<p> Initial value: a vector of standard deviation of
all the components of the Gaussian mixture. By default, it is chosen
as 1 and 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cL.ini</code></td>
<td>
<p> Initial value: a vector of the probability for all the
components of the Gaussian mixture. By default, it is chosen as 50% and 50%.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DELTA</code></td>
<td>
<p> The criteria to stop the EM algorithm. In this
algorithm, we calcualte the maximum of absolution difference of the
current estiamted value and its previous value for the
parameters. By default, it is chosen as 0.0001.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.KNOWN</code></td>
<td>
<p> The boolean variable, indicating whether the
variance is known. Be default, it is chosen as FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a TSGroupTest object. It contains
</p>
<table>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p> this is a list, consisting of estimated parameters
based on the EM algorithm. The elements are <code class="reqn">\pi_1</code>,
<code class="reqn">\pi_{2|1}</code>, <code class="reqn">c_l</code>, <code class="reqn">\mu_l</code>, <code class="reqn">\sigma_l</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TSGroupTest[[g]]</code></td>
<td>
<p> all the quntities regarding the g-th group,
including the test statistic within this group, the individual
conditional local fdr score (<code class="reqn"> P(\theta_{gj}=0|x,
      \theta_{g}=1)</code>), the group-wise local fdr score
(<code class="reqn">P(\theta_g=0|x)</code>), between-group decision, within-group decision</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(GroupTest_simulate)

GT.Test &lt;- GT.wrapper( GroupTest_simulate, alpha=0.05, eta=alpha,
pi1.ini=0.7, pi2.1.ini=0.4, L=2, muL.ini=c(-1,1), sigmaL.ini=c(1,2),
cL.ini=c(0.4,0.6), DELTA=0.001, sigma.KNOWN=FALSE )

</code></pre>


</div>