<div class="container">

<table style="width: 100%;"><tr>
<td>expand_spline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expand feature matrix using basis splines</h2>

<h3>Description</h3>

<p>Performs a basis expansion for many features at once, returning output that is compatible
for use with the <code>grpreg()</code> function. Returns an expanded matrix along with a vector
that describes its grouping.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expand_spline(x, df = 3, degree = 3, type = c("ns", "bs"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Features to be expanded (numeric matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom (numeric; default = 3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>Degree of the piecewise polynomial (integer; default = 3 (cubic splines)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of spline, either B-spline (<code>"bs"</code>) or natural cubic spline (<code>"ns"</code>; default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>expand_spline()</code> uses the function <code>splines::bs()</code> or <code>splines::ns()</code> to generate a basis
matrix for each column of <code>x</code>. These matrices represent the spline basis for piecewise
polynomials with specified degree evaluated separately for each original column of <code>x</code>.
These matrices are then column-bound to form a single grouped matrix of derived features. A vector
that describes the grouping present in the resulting matrix is also generated. The resulting
object can be passed to <code>grpreg()</code>.
</p>
<p>This methodology was originally proposed by Ravikumar et al. (2009), who named it SPAM (SParse Additive Modeling).
</p>


<h3>Value</h3>

<p>An object of class <code>expandedMatrix</code> consisting of:
</p>

<ul>
<li> <p><code>X</code>: A matrix of dimension <code>nrow(x)</code> by <code>df*ncol(x)</code>
</p>
</li>
<li> <p><code>group</code>: A vector of length <code>df*ncol(x)</code> that describes the grouping structure
</p>
</li>
<li>
<p> Additional metadata on the splines, such as knot locations, required in order to evaluate spline at new feature values (e.g., for prediction)
</p>
</li>
</ul>
<h3>References</h3>


<ul><li>
<p> Ravikumar P, Lafferty J, Liu H and Wasserman L (2009). Sparse additive models. <em>Journal of the Royal Statistical Society Series B</em>, <strong>71</strong>: 1009-1030.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>plot_spline()</code> to visualize the resulting nonlinear fits
</p>


<h3>Examples</h3>

<pre><code class="language-R">
Data &lt;- gen_nonlinear_data(n=1000)
X &lt;- expand_spline(Data$X)
fit &lt;- grpreg(X, Data$y)
plot_spline(fit, "V02", lambda = 0.03)
</code></pre>


</div>