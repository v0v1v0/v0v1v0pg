<div class="container">

<table style="width: 100%;"><tr>
<td>GeoFit2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Max-Likelihood-Based Fitting of Gaussian and non Gaussian RFs.</h2>

<h3>Description</h3>

<p>Maximum weighted composite-likelihood fitting for Gaussian  and some Non-Gaussian  
univariate spatial, spatio-temporal and bivariate spatial RFs.
A first preliminary estimation is performed using independence composite-likelihood for the 
marginal parameters of the model. The estimates are then used as starting values in the second 
final estimation step.
The function allows to fix any of the parameters and setting upper/lower bound in the optimization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GeoFit2(data, coordx, coordy=NULL, coordt=NULL, coordx_dyn=NULL,
  copula=NULL,corrmodel,distance="Eucl",fixed=NULL,
     anisopars=NULL,est.aniso=c(FALSE,FALSE),GPU=NULL, 
     grid=FALSE, likelihood='Marginal',
     local=c(1,1),  lower=NULL,maxdist=Inf,neighb=NULL,
      maxtime=Inf, memdist=TRUE,method="cholesky", 
      model='Gaussian',n=1, onlyvar=FALSE ,
      optimizer='Nelder-Mead', parallel=FALSE, 
      radius=6371,  sensitivity=FALSE,sparse=FALSE,
       start=NULL, taper=NULL, tapsep=NULL, 
      type='Pairwise', upper=NULL, varest=FALSE, 
      vartype='SubSamp', weighted=FALSE, winconst=NULL, winstp=NULL, 
      winconst_t=NULL, winstp_t=NULL,X=NULL,nosym=FALSE,spobj=NULL,spdata=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector (a single spatial realisation)  or a (<code class="reqn">d \times d</code>)-matrix (a single spatial realisation on regular grid)
or a
(<code class="reqn">t \times d</code>)-matrix (a single spatial-temporal realisation)   or an (<code class="reqn">d \times d \times t \times n </code>)-array
(a single spatial-temporal realisation on regular grid).
For the description see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx</code></td>
<td>
<p>A numeric (<code class="reqn">d \times 2</code>)-matrix (where
<code>d</code> is the number of spatial sites) assigning 2-dimensions of spatial coordinates or a numeric <code class="reqn">d</code>-dimensional vector assigning
1-dimension of spatial coordinates.  Coordinates on a sphere for a  fixed radius <code>radius</code> 
are passed in lon/lat format expressed in decimal degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordy</code></td>
<td>
<p>A numeric vector assigning 1-dimension of
spatial coordinates; <code>coordy</code> is interpreted only if <code>coordx</code> is a numeric
vector or <code>grid=TRUE</code> otherwise it will be ignored. Optional argument, the default is <code>NULL</code> then <code>coordx</code> is expected to
be numeric a (<code class="reqn">d \times 2</code>)-matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordt</code></td>
<td>
<p>A numeric vector assigning 1-dimension of
temporal coordinates.  Optional argument, the default is <code>NULL</code>
then a spatial RF is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx_dyn</code></td>
<td>
<p>A list of <code class="reqn">m</code> numeric (<code class="reqn">d_t \times 2</code>)-matrices
containing dynamical (in time) spatial coordinates. Optional argument, the default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>String; the type of copula. It can be "Clayton" or "Gaussian"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrmodel</code></td>
<td>
<p>String; the name of a correlation model, for the
description see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>String; the name of the spatial distance. The default is <code>Eucl</code>, the euclidean distance.
See the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>An optional named list giving the values of the parameters that
will be considered as known values. The listed parameters for a
given correlation function will be not estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anisopars</code></td>
<td>
<p> A list of two elements: "angle" and "ratio" i.e. the anisotropy angle and the anisotropy ratio, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.aniso</code></td>
<td>
<p> A bivariate logical vector  providing which anisotropic parameters must be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GPU</code></td>
<td>
<p>Numeric; if <code>NULL</code> (the default) 
no OpenCL computation is performed. The user can choose the device to be used. Use <code>DeviceInfo()</code> function to see available devices, only double precision devices are allowed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Logical; if <code>FALSE</code> (the default) the data
are interpreted as spatial or spatial-temporal realisations on a set
of non-equispaced spatial sites (irregular grid).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>String; the configuration of the composite
likelihood. <code>Marginal</code> is the default, see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local</code></td>
<td>
<p>Numeric; number of local work-items of the OpenCL setup</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>An optional named list giving the values  for the lower bound of the space parameter
when the optimizer is  <code>L-BFGS-B</code> or <code>nlminb</code>   or <code>optimize</code>. The 
names of the list must be the same of the names in the   <code>start</code> list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>Numeric; an optional positive value indicating the maximum
spatial distance considered in the composite or tapered likelihood
computation. See the Section <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighb</code></td>
<td>
<p>Numeric; an optional positive integer indicating the 
order of neighborhood  in the composite likelihood
computation. See the Section <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>Numeric; an optional positive integer indicating the 
order of temporal neighborhood  in the composite likelihood
computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memdist</code></td>
<td>
<p> Logical; if <code>TRUE</code> then  all  the distances  useful in the  composite likelihood 
estimation are computed before  the optimization. <code>FALSE</code> is deprecated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String; the type of matrix decomposition used in the simulation. Default is cholesky.
The other possible choices is <code>svd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>String; the type of RF and therefore the densities associated to the likelihood
objects. <code>Gaussian</code> is the default, see the Section
<b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Numeric; number of trials in a binomial RF; number of successes in a negative binomial RF </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyvar</code></td>
<td>
<p>Logical; if <code>TRUE</code>  (and varest is  <code>TRUE</code>) only the variance covariance matrix is computed
without optimizing. <code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>String; the optimization algorithm
(see <code>optim</code> for details). <code>Nelder-Mead</code> is the
default. Other possible choices are <code>nlm</code>, <code>BFGS</code>, <code>SANN</code>,  <code>L-BFGS-B</code> and <code>nlminb</code>. 
In these last two cases upper and lower bounds can be passed by the user. In the case
of one-dimensional optimization, the function <code>optimize</code> is used.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical; if <code>TRUE</code> optmization is performed using optimParallel using the maximum number of cores,  when optimizer is  <code>L-BFGS-B</code>.<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>Numeric; the radius of the sphere in the case of lon-lat coordinates.
The default is 6371, the radius of the earth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensitivity</code></td>
<td>
<p>Logical; if <code>TRUE</code> then  the sensitivy  matrix is computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>Logical; if <code>TRUE</code> then  maximum likelihood is computed
using sparse matrices algorithms (spam packake).It should be used
with compactly supported covariance models.<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>An optional named list with the initial values of the
parameters that are used by the numerical routines in maximization
procedure. <code>NULL</code> is the default (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taper</code></td>
<td>
<p>String; the name of the type of covariance matrix.
It can be <code>Standard</code> (the default value) or
<code>Tapering</code> for taperd covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tapsep</code></td>
<td>
<p>Numeric; an optional  value indicating the separabe parameter in the 
space time adaptive taper (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String; the type of the likelihood objects. If <code>Pairwise</code> (the
default) then the marginal composite likelihood is formed by
pairwise marginal likelihoods (see <b>Details</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>An optional named list giving the values  for the upper bound 
of the space parameter when the optimizer is or <code>L-BFGS-B</code> or  <code>nlminb</code> or <code>optimize</code>. 
The names of the list must be the same of the names in the   <code>start</code> list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest</code></td>
<td>
<p>Logical; if <code>TRUE</code> the estimates' variances and
standard errors are returned. For composite likelihood estimation it is deprecated.
Use sensitivity TRUE and update the object using the function <code>GeoVarestbootstrap</code>
<code>FALSE</code> is the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vartype</code></td>
<td>
<p>String; (<code>SubSamp</code> the default) the type of
method used for computing
the estimates' variances, see the Section <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Logical; if <code>TRUE</code> the likelihood objects are
weighted, see the Section <b>Details</b>. If <code>FALSE</code> (the
default) the composite likelihood is not weighted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winconst</code></td>
<td>
<p>Numeric; a bivariate positive vector for computing the spatial  sub-window
in the sub-sampling procedure. See <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winstp</code></td>
<td>
<p>Numeric; a value in <code class="reqn">(0,1]</code> for defining the the proportion of 
overlapping in the spatial  sub-sampling procedure. The case <code class="reqn">1</code> 
correspond to no overlapping. See <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winconst_t</code></td>
<td>
<p>Numeric; a positive value for computing the temporal sub-window
in the sub-sampling procedure. See <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winstp_t</code></td>
<td>
<p>Numeric; a value in <code class="reqn">(0,1]</code> for defining the the proportion of 
overlapping in the temporal  sub-sampling procedure. The case <code class="reqn">1</code> 
correspond to no overlapping. See <b>Details</b> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric; Matrix of spatio(temporal)covariates in the linear mean specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosym</code></td>
<td>
<p>Logical; if TRUE simmetric weights are not considered. This allows a faster but less efficient CL estimation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spobj</code></td>
<td>
<p>An object of class sp or spacetime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spdata</code></td>
<td>
<p>Character:The name of data in the sp or spacetime object</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>GeoFit2</code> is similar to the  function <code>GeoFit</code>.
However <code>GeoFit2</code>  performs a preliminary estimation  using maximum   indenpendence composite likelihood 
of the marginal parameters of the model and then use the obtained estimates as starting value in the global
weighted composite likelihood estimation (that includes marginal and dependence parameters).
This allows to obtain "good" starting values in the optimization algorithm for the marginal parameters.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>GeoFit</code>.
An object of class <code>GeoFit</code> is a list containing
at most the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bivariate</code></td>
<td>
<p>Logical:<code>TRUE</code> if the Gaussian RF is bivariate, otherwise  <code>FALSE</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clic</code></td>
<td>
<p>The composite information criterion, if the full
likelihood is considered then it coincides with the Akaike information
criterion;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordy</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordt</code></td>
<td>
<p>A <code class="reqn">t</code>-dimensional vector of temporal coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordx_dyn</code></td>
<td>
<p>A  list of dynamical (in time) spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>Confidence intervals for  standard maximum likelihood estimation;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>A string that denotes if convergence is reached;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>The type of copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrmodel</code></td>
<td>
<p>The correlation model;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The vector or matrix or array of data;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The type of spatial distance;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A list of the  fixed parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>The number of iteration used by the numerical routine;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>The configuration of the composite likelihood;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logCompLik</code></td>
<td>
<p>The value of the log composite-likelihood at the maximum;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>The maximum spatial distance used in the weigthed composite likelihood. 
If no spatial distance is specified then it is NULL;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtime</code></td>
<td>
<p>The maximum temporal distance  used in the weigthed composite likelihood.
If no spatial distance is specified then it is NULL;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>Extra message passed from the numerical routines;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The density associated to the likelihood objects;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missp</code></td>
<td>
<p>True if a misspecified  Gaussian model is ued in  the composite likelihhod;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of trials in a binominal RF;the number of successes in a  negative Binomial RFs;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighb</code></td>
<td>
<p>The 
order of spatial neighborhood  in the composite likelihood
computation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>The number of (different) location sites in the bivariate case;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nozero</code></td>
<td>
<p>In the case of tapered likelihood  the percentage of non zero values in the covariance matrix.
Otherwise is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numcoord</code></td>
<td>
<p>The number of spatial coordinates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numtime</code></td>
<td>
<p>The number of the temporal realisations of the RF;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A list of the  parameters' estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>The radius of the sphere in the case of great  circle distance;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderr</code></td>
<td>
<p>The vector of standard errors for  standard maximum likelihood estimation;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensmat</code></td>
<td>
<p>The sensitivity matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>
<p>The matrix of the variance-covariance of the estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varimat</code></td>
<td>
<p>The variability matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vartype</code></td>
<td>
<p>The method used to compute the variance of the estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of the likelihood objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winconst</code></td>
<td>
<p>The constant used to compute the window size in the
spatial sub-sampling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winstp</code></td>
<td>
<p>The step used for moving the window in the spatial sub-sampling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winconst_t</code></td>
<td>
<p>The constant used to compute the window size in the
spatio-temporal sub-sampling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winstp_</code></td>
<td>
<p>The step used for moving the window in the spatio-temporal sub-sampling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The matrix of covariates;</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Moreno Bevilacqua, <a href="mailto:moreno.bevilacqua89@gmail.com">moreno.bevilacqua89@gmail.com</a>,<a href="https://sites.google.com/view/moreno-bevilacqua/home">https://sites.google.com/view/moreno-bevilacqua/home</a>,
Víctor Morales Oñate, <a href="mailto:victor.morales@uv.cl">victor.morales@uv.cl</a>, <a href="https://sites.google.com/site/moralesonatevictor/">https://sites.google.com/site/moralesonatevictor/</a>,
Christian", Caamaño-Carrillo, <a href="mailto:chcaaman@ubiobio.cl">chcaaman@ubiobio.cl</a>,<a href="https://www.researchgate.net/profile/Christian-Caamano">https://www.researchgate.net/profile/Christian-Caamano</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(GeoModels)


###############################################################
############ Examples of spatial Gaussian RFs ################
###############################################################

################################################################
###
### Example 1 : Maximum pairwise conditional likelihood fitting 
###  of a Gaussian RF with Matern correlation
###
###############################################################
model="Gaussian"
# Define the spatial-coordinates of the points:
set.seed(3)
N=400  # number of location sites
x &lt;- runif(N, 0, 1)
set.seed(6)
y &lt;- runif(N, 0, 1)
coords &lt;- cbind(x,y)

# Define spatial matrix covariates
X=cbind(rep(1,N),runif(N))

# Set the covariance model's parameters:
corrmodel &lt;- "Matern"
mean &lt;- 0.2
mean1 &lt;- -0.5
sill &lt;- 1
nugget &lt;- 0
scale &lt;- 0.2/3
smooth=0.5
param&lt;-list(mean=mean,mean1=mean1,sill=sill,nugget=nugget,scale=scale,smooth=smooth)

# Simulation of the spatial Gaussian RF:
data &lt;- GeoSim(coordx=coords,model=model,corrmodel=corrmodel, param=param,X=X)$data

fixed&lt;-list(nugget=nugget,smooth=smooth)
start&lt;-list(mean=mean,mean1=mean1,scale=scale,sill=sill)

################################################################
###
### Maximum pairwise likelihood fitting of
### Gaussian RFs with exponential correlation.
### 
###############################################################
fit1 &lt;- GeoFit2(data=data,coordx=coords,corrmodel=corrmodel, 
                    optimizer="BFGS",neighb=3,likelihood="Conditional",
                    type="Pairwise", start=start,fixed=fixed,X=X)
print(fit1)




###############################################################
############ Examples of spatial non-Gaussian RFs #############
###############################################################


################################################################
###
### Example 2. Maximum pairwise likelihood fitting of 
### a LogGaussian  RF with Generalized Wendland correlation
### 
###############################################################
set.seed(524)
# Define the spatial-coordinates of the points:
N=500
x &lt;- runif(N, 0, 1)
y &lt;- runif(N, 0, 1)
coords &lt;- cbind(x,y)
X=cbind(rep(1,N),runif(N))
mean=1; mean1=2 # regression parameters
nugget=0
sill=0.5
scale=0.2
smooth=0

model="LogGaussian"
corrmodel="GenWend"
param=list(mean=mean,mean1=mean1,sill=sill,scale=scale,
                    nugget=nugget,power2=4,smooth=smooth)
# Simulation of a  non stationary LogGaussian RF:
data &lt;- GeoSim(coordx=coords, corrmodel=corrmodel,model=model,X=X,
           param=param)$data

fixed&lt;-list(nugget=nugget,power2=4,smooth=smooth)
start&lt;-list(mean=mean,mean1=mean1,scale=scale,sill=sill)
I=Inf
lower&lt;-list(mean=-I,mean1=-I,scale=0,sill=0)
upper&lt;-list(mean= I,mean1= I,scale=I,sill=I)

# Maximum pairwise composite-likelihood fitting of the RF:
fit &lt;- GeoFit2(data=data,coordx=coords,corrmodel=corrmodel, model=model,
                    neighb=3,likelihood="Conditional",type="Pairwise",X=X,
                    optimizer="nlminb",lower=lower,upper=upper,
                    start=start,fixed=fixed)
print(unlist(fit$param))


################################################################
###
### Example 3. Maximum pairwise likelihood fitting of
### SinhAsinh   RFs with Wendland0 correlation
###
###############################################################
set.seed(261)
model="SinhAsinh"
# Define the spatial-coordinates of the points:
x &lt;- runif(500, 0, 1)
y &lt;- runif(500, 0, 1)
coords &lt;- cbind(x,y)

corrmodel="Wend0"
mean=0;nugget=0
sill=1
skew=-0.5
tail=1.5
power2=4
c_supp=0.2

# model parameters
param=list(power2=power2,skew=skew,tail=tail,
             mean=mean,sill=sill,scale=c_supp,nugget=nugget)
data &lt;- GeoSim(coordx=coords, corrmodel=corrmodel,model=model, param=param)$data

plot(density(data))
fixed=list(power2=power2,nugget=nugget)
start=list(scale=c_supp,skew=skew,tail=tail,mean=mean,sill=sill)
# Maximum pairwise likelihood:
fit1 &lt;- GeoFit2(data=data,coordx=coords,corrmodel=corrmodel, model=model,
                    neighb=3,likelihood="Marginal",type="Pairwise",
                    start=start,fixed=fixed)
print(unlist(fit1$param))



</code></pre>


</div>