<div class="container">

<table style="width: 100%;"><tr>
<td>gwbr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Geographically Weighted  Beta Regression</h2>

<h3>Description</h3>

<p>Fits a local regression model for each location using the beta distribution, recommended for rates and proportions, using a parametrization with mean (transformed by the link function) and precision parameter (called phi). For more details see Da Silva and Lima (2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gwbr(
  yvar,
  xvar,
  lat,
  long,
  h,
  data,
  xglobal = NA_character_,
  grid = data.frame(),
  method = c("fixed_g", "fixed_bsq", "adaptative_bsq"),
  link = c("logit", "probit", "loglog", "cloglog"),
  distancekm = TRUE,
  global = FALSE,
  maxint = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>
<p>A vector with the response variable name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>A vector with descriptive variable(s) name(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>A vector with the latitude variable name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>A vector with the longitude variable name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>The bandwidth parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data set object with <code>yvar</code> and <code>xvar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xglobal</code></td>
<td>
<p>A vector with descriptive variable(s) name(s) with global effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>A data set with the location variables. Only used when the location variable are in another data set, different from data set used in parameter <code>data</code>. Variable name <code>"lat"</code> is expected for latitude and <code>"long"</code> for longitude.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The kernel function used. The options are: <code>"fixed_g"</code>, <code>"fixed_bsq"</code> or <code>"adaptive_bsq"</code>. The default is <code>"fixed_g"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>The link function used in modeling. The options are: <code>"logit"</code>, <code>"probit"</code>, <code>"loglog"</code> or <code>"cloglog"</code>. The default is <code>"logit"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distancekm</code></td>
<td>
<p>Logical. If <code>TRUE</code> use the distance in kilometers otherwise, use the Euclidean distance. The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global</code></td>
<td>
<p>Logical. If <code>TRUE</code> return to global model, giving the results from <code>betareg_gwbr</code> function. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxint</code></td>
<td>
<p>A maximum number of iterations to numerically maximize the log-likelihood function in search of the parameter estimates. The default is <code>maxint=100</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list that contains:
</p>

<ul>
<li> <p><code>parameter_estimates_qtls</code> - Parameter estimates quartiles and interquartile range.
</p>
</li>
<li> <p><code>parameter_estimates_desc</code> - Parameter estimates mean, minimum and maximum.
</p>
</li>
<li> <p><code>std_qtls</code> - Standard deviation quartiles and interquartile range.
</p>
</li>
<li> <p><code>std_desc</code> - Standard deviation mean, minimum and maximum.
</p>
</li>
<li> <p><code>est_n_parameters</code> - Number of parameters.
</p>
</li>
<li> <p><code>est_gwr_parameters</code> - Effective number of parameters in the local model.
</p>
</li>
<li> <p><code>phi</code> - Vector of precision parameter estimates.
</p>
</li>
<li> <p><code>global_parameter</code> - Global parameter estimates, when existing.
</p>
</li>
<li> <p><code>global_phi</code> - Global scale parameter estimate, when existing.
</p>
</li>
<li> <p><code>global_parameter_tab</code> - Global parameter estimates table, when existing.
</p>
</li>
<li> <p><code>residuals</code> - Table with observed values (<code>y</code>), estimated values (<code>yhat</code>), the link function applied in the estimated values (<code>eta</code>), pure residual (<code>res</code>), standardized residual (<code>resstd</code>), standardized weighted residual 2 (<code>resstd2</code>), residual deviance (<code>resdeviance</code>), Cooks distance (<code>cookD</code>), generalized leverage (<code>glbp</code>) and number of iterations (<code>iteration</code>).
</p>
</li>
<li> <p><code>log_likelihood</code> - Log-likelihood of the fitted model.
</p>
</li>
<li> <p><code>aicc</code> - Corrected Akaike information criterion.
</p>
</li>
<li> <p><code>r2</code> - Pseudo R2 and adjusted pseudo R2 statistics.
</p>
</li>
<li> <p><code>bp_test</code> - Breusch-Pagan test for heteroscedasticity.
</p>
</li>
<li> <p><code>w</code> - Matrix of weights.
</p>
</li>
<li> <p><code>parameters</code> - Table with parameter estimates of each model.
</p>
</li>
<li> <p><code>significance</code> - Significance level of each model.
</p>
</li>
<li> <p><code>bandwidth</code> - Bandwidth used.
</p>
</li>
<li> <p><code>link_function</code> - The link function used in modeling.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
data(saopaulo)
output_list=gwbr("prop_landline",c("prop_urb", "prop_poor"),"y","x",116.3647,saopaulo)

## Descriptive statistics of the parameter estimates
output_list$parameter_estimates_desc

## Table with all parameter estimates and your respective statistics
output_list$parameters

</code></pre>


</div>