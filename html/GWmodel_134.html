<div class="container">

<table style="width: 100%;"><tr>
<td>gwss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Geographically weighted summary statistics (GWSS)</h2>

<h3>Description</h3>

<p>This function calculates basic and robust GWSS.  This includes geographically weighted means, standard deviations and skew. Robust alternatives include geographically weighted medians, inter-quartile ranges and quantile imbalances. This function also calculates basic geographically weighted covariances together with basic and robust
geographically weighted correlations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gwss(data, summary.locat,vars,kernel="bisquare",adaptive=FALSE, bw,p=2, 
            theta=0, longlat=F,dMat,quantile=FALSE)
## S3 method for class 'gwss'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a Spatial*DataFrame, i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame as defined in package <span class="pkg">sp</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.locat</code></td>
<td>
<p>a Spatial*DataFrame object for providing summary locations, 
i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame 
as defined in package <span class="pkg">sp</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>a vector of variable names to be summarized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>bandwidth used in the weighting function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>function chosen as follows:
</p>
<p>gaussian: wgt = exp(-.5*(vdist/bw)^2);
</p>
<p>exponential: wgt = exp(-vdist/bw);
</p>
<p>bisquare: wgt = (1-(vdist/bw)^2)^2 if vdist &lt; bw, wgt=0 otherwise;
</p>
<p>tricube: wgt = (1-(vdist/bw)^3)^3 if vdist &lt; bw, wgt=0 otherwise; 
</p>
<p>boxcar: wgt=1 if dist &lt; bw, wgt=0 otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive</code></td>
<td>
<p>if TRUE calculate an adaptive kernel where the bandwidth (bw) corresponds to the number of nearest neighbours (i.e. adaptive distance); default is FALSE, where a fixed kernel is found (bandwidth is a fixed distance)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the power of the Minkowski distance, default is 2, i.e. the Euclidean distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>an angle in radians to rotate the coordinate system, default is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>
<p>if TRUE, great circle distances will be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dMat</code></td>
<td>
<p>a pre-specified distance matrix, it can be calculated by the function <code>gw.dist</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>if TRUE, median, interquartile range, quantile imbalance will be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class “gwss”, returned by the function gwss</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed through (unused)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of class “lss”:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>SDF</code></td>
<td>
<p>a SpatialPointsDataFrame (may be gridded) or 
SpatialPolygonsDataFrame object (see package “sp”)
with local means,local standard deviations,local variance,
local skew,local coefficients of variation, local covariances, 
local correlations (Pearson's), local correlations (Spearman's),
local medians, local interquartile ranges, local quantile imbalances and coordinates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other information for reporting</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Binbin Lu <a href="mailto:binbinlu@whu.edu.cn">binbinlu@whu.edu.cn</a></p>


<h3>References</h3>

<p>Fotheringham S, Brunsdon, C, and Charlton, M (2002),
Geographically Weighted Regression: The Analysis of Spatially Varying Relationships, Chichester: Wiley.
</p>
<p>Brunsdon C, Fotheringham AS, Charlton ME (2002) Geographically weighted summary statistics - a framework for localised exploratory data analysis. Computers, Environment and Urban Systems 26:501-524
</p>
<p>Harris P, Clarke A, Juggins S, Brunsdon C, Charlton M (2014) Geographically 
weighted methods and their use in network re-designs for environmental monitoring. 
Stochastic Environmental Research and Risk Assessment 28: 1869-1887
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(EWHP)
data(EWOutline)
head(ewhp)
houses.spdf &lt;- SpatialPointsDataFrame(ewhp[, 1:2], ewhp)
localstats1 &lt;- gwss(houses.spdf, vars = c("PurPrice", "FlrArea"), bw = 50000)
head(data.frame(localstats1$SDF))
localstats1
##A function for mapping data
if(require("RColorBrewer"))
{
   quick.map &lt;- function(spdf,var,legend.title,main.title) 
   {
     x &lt;- spdf@data[,var]
     cut.vals &lt;- pretty(x)
     x.cut &lt;- cut(x,cut.vals)
     cut.levels &lt;- levels(x.cut)
     cut.band &lt;- match(x.cut,cut.levels)
     colors &lt;- brewer.pal(length(cut.levels), "YlOrRd")
     colors &lt;- rev(colors)
     par(mar=c(1,1,1,1))
     plot(ewoutline,col="olivedrab",bg="lightblue1")
     title(main.title)
     plot(spdf,add=TRUE,col=colors[cut.band],pch=16)
     legend("topleft",cut.levels,col=colors,pch=16,bty="n",title=legend.title)
  }
  quick.map(localstats1$SDF, "PurPrice_LM", "1000's Uk Pounds", 
  "Geographically Weighted Mean")
  par(mfrow = c(1, 2))
  quick.map(localstats1$SDF, "PurPrice_LSKe", "Skewness Level", "Local Skewness")
  quick.map(localstats1$SDF, "PurPrice_LSD", "1000's Pounds", "Local Standard Deviation")
  #Exploring Non-Stationarity of Relationships
  quick.map(localstats1$SDF, "Corr_PurPrice.FlrArea", expression(rho), 
  "Geographically Weighted Pearson Correlation")
  #Robust, Quantile Based Local Summary Statistics
  localstats2 &lt;- gwss(houses.spdf, vars = c("PurPrice", "FlrArea"), 
  bw = 50000, quantile = TRUE)
  quick.map(localstats2$SDF, "PurPrice_Median", "1000 UK Pounds", 
  "Geographically Weighted Median House Price")
}

## End(Not run)
</code></pre>


</div>